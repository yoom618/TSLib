Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.861733436584473
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.629 Vali Acc: 0.232 Test Loss: 1.629 Test Acc: 0.232
Validation loss decreased (inf --> -0.231923).  Saving model ...
Epoch: 2 cost time: 4.228355884552002
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.629 Vali Acc: 0.232 Test Loss: 1.629 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.233922719955444
Epoch: 3, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.500 Vali Acc: 0.259 Test Loss: 1.500 Test Acc: 0.259
Validation loss decreased (-0.231923 --> -0.258540).  Saving model ...
Epoch: 4 cost time: 4.924673557281494
Epoch: 4, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.584 Vali Acc: 0.262 Test Loss: 1.584 Test Acc: 0.262
Validation loss decreased (-0.258540 --> -0.262342).  Saving model ...
Epoch: 5 cost time: 5.022033929824829
Epoch: 5, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.863 Vali Acc: 0.255 Test Loss: 1.863 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.143361806869507
Epoch: 6, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.648 Vali Acc: 0.266 Test Loss: 1.648 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266143).  Saving model ...
Epoch: 7 cost time: 5.334573745727539
Epoch: 7, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.841 Vali Acc: 0.240 Test Loss: 1.841 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.867883205413818
Epoch: 8, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.694 Vali Acc: 0.255 Test Loss: 1.694 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.379875183105469
Epoch: 9, Steps: 17 | Train Loss: 1.053 Vali Loss: 2.002 Vali Acc: 0.240 Test Loss: 2.002 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.7387871742248535
Epoch: 10, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.036 Vali Acc: 0.247 Test Loss: 2.036 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.4499828815460205
Epoch: 11, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.096 Vali Acc: 0.240 Test Loss: 2.096 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.320160388946533
Epoch: 12, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.573 Vali Acc: 0.243 Test Loss: 2.573 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.574331760406494
Epoch: 13, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.553 Vali Acc: 0.240 Test Loss: 2.553 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.593479633331299
Epoch: 14, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.082 Vali Acc: 0.221 Test Loss: 2.082 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.60633659362793
Epoch: 15, Steps: 17 | Train Loss: 0.648 Vali Loss: 4.100 Vali Acc: 0.259 Test Loss: 4.100 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.873056888580322
Epoch: 16, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.797 Vali Acc: 0.247 Test Loss: 1.797 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 44302084
model size : 183.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.893817186355591
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.441 Vali Acc: 0.251 Test Loss: 1.441 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.8676087856292725
Epoch: 2, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.514 Vali Acc: 0.270 Test Loss: 1.514 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 3.6014034748077393
Epoch: 3, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.531 Vali Acc: 0.266 Test Loss: 1.531 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.030580997467041
Epoch: 4, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.527 Vali Acc: 0.236 Test Loss: 1.527 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0767147541046143
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.500 Vali Acc: 0.236 Test Loss: 1.500 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4812099933624268
Epoch: 6, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.604 Vali Acc: 0.243 Test Loss: 1.604 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.886014223098755
Epoch: 7, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.081 Vali Acc: 0.228 Test Loss: 2.081 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1515259742736816
Epoch: 8, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.780 Vali Acc: 0.259 Test Loss: 1.780 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.754178762435913
Epoch: 9, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273748).  Saving model ...
Epoch: 10 cost time: 3.83284330368042
Epoch: 10, Steps: 17 | Train Loss: 0.987 Vali Loss: 2.089 Vali Acc: 0.221 Test Loss: 2.089 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8405067920684814
Epoch: 11, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.876 Vali Acc: 0.247 Test Loss: 1.876 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4593911170959473
Epoch: 12, Steps: 17 | Train Loss: 0.967 Vali Loss: 2.413 Vali Acc: 0.247 Test Loss: 2.413 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5963847637176514
Epoch: 13, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.955 Vali Acc: 0.205 Test Loss: 1.955 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9286611080169678
Epoch: 14, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.242 Vali Acc: 0.213 Test Loss: 2.242 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.721386671066284
Epoch: 15, Steps: 17 | Train Loss: 1.077 Vali Loss: 2.014 Vali Acc: 0.221 Test Loss: 2.014 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.437338352203369
Epoch: 16, Steps: 17 | Train Loss: 0.829 Vali Loss: 2.550 Vali Acc: 0.243 Test Loss: 2.550 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1050219535827637
Epoch: 17, Steps: 17 | Train Loss: 0.691 Vali Loss: 2.411 Vali Acc: 0.266 Test Loss: 2.411 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.832003355026245
Epoch: 18, Steps: 17 | Train Loss: 0.705 Vali Loss: 3.489 Vali Acc: 0.221 Test Loss: 3.489 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0848748683929443
Epoch: 19, Steps: 17 | Train Loss: 0.778 Vali Loss: 3.287 Vali Acc: 0.236 Test Loss: 3.287 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44085508
model size : 182.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.739763975143433
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.482 Vali Acc: 0.224 Test Loss: 1.482 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 2.5362091064453125
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.460 Vali Acc: 0.232 Test Loss: 1.460 Test Acc: 0.232
Validation loss decreased (-0.224320 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 3.0562920570373535
Epoch: 3, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.439 Vali Acc: 0.236 Test Loss: 1.439 Test Acc: 0.236
Validation loss decreased (-0.231925 --> -0.235727).  Saving model ...
Epoch: 4 cost time: 2.933490514755249
Epoch: 4, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.478 Vali Acc: 0.247 Test Loss: 1.478 Test Acc: 0.247
Validation loss decreased (-0.235727 --> -0.247134).  Saving model ...
Epoch: 5 cost time: 2.4727039337158203
Epoch: 5, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.520 Vali Acc: 0.240 Test Loss: 1.520 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.790400981903076
Epoch: 6, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.563 Vali Acc: 0.255 Test Loss: 1.563 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254737).  Saving model ...
Epoch: 7 cost time: 1.7478184700012207
Epoch: 7, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.577 Vali Acc: 0.262 Test Loss: 1.577 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262342).  Saving model ...
Epoch: 8 cost time: 2.5968806743621826
Epoch: 8, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.650 Vali Acc: 0.217 Test Loss: 1.650 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5864980220794678
Epoch: 9, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.967 Vali Acc: 0.228 Test Loss: 1.967 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.620112180709839
Epoch: 10, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.709 Vali Acc: 0.236 Test Loss: 1.709 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7121829986572266
Epoch: 11, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.910 Vali Acc: 0.243 Test Loss: 1.910 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.903259515762329
Epoch: 12, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.923 Vali Acc: 0.236 Test Loss: 1.923 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.779348611831665
Epoch: 13, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.069 Vali Acc: 0.217 Test Loss: 2.069 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.758007526397705
Epoch: 14, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.700 Vali Acc: 0.251 Test Loss: 1.700 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8350427150726318
Epoch: 15, Steps: 17 | Train Loss: 0.929 Vali Loss: 2.030 Vali Acc: 0.247 Test Loss: 2.030 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.131991147994995
Epoch: 16, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.995 Vali Acc: 0.236 Test Loss: 1.995 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9217145442962646
Epoch: 17, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.459 Vali Acc: 0.224 Test Loss: 2.459 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 43979524
model size : 182.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps73_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.3599693775177
Epoch: 1, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.618 Vali Acc: 0.251 Test Loss: 1.618 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 4.275852680206299
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.495 Vali Acc: 0.281 Test Loss: 1.495 Test Acc: 0.281
Validation loss decreased (-0.250934 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 4.196970701217651
Epoch: 3, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.588 Vali Acc: 0.266 Test Loss: 1.588 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.4035608768463135
Epoch: 4, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.726 Vali Acc: 0.251 Test Loss: 1.726 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.386031866073608
Epoch: 5, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.914 Vali Acc: 0.262 Test Loss: 1.914 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.003478765487671
Epoch: 6, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.749 Vali Acc: 0.236 Test Loss: 1.749 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.524874210357666
Epoch: 7, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.935 Vali Acc: 0.221 Test Loss: 1.935 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.796244144439697
Epoch: 8, Steps: 17 | Train Loss: 1.052 Vali Loss: 2.004 Vali Acc: 0.255 Test Loss: 2.004 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.900629043579102
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 2.107 Vali Acc: 0.255 Test Loss: 2.107 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.394344091415405
Epoch: 10, Steps: 17 | Train Loss: 0.912 Vali Loss: 2.531 Vali Acc: 0.255 Test Loss: 2.531 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.311165809631348
Epoch: 11, Steps: 17 | Train Loss: 0.923 Vali Loss: 2.003 Vali Acc: 0.247 Test Loss: 2.003 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.078902721405029
Epoch: 12, Steps: 17 | Train Loss: 0.886 Vali Loss: 2.288 Vali Acc: 0.255 Test Loss: 2.288 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps73_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44292868
model size : 183.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps73_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.782474756240845
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.432 Vali Acc: 0.274 Test Loss: 1.432 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 3.1089634895324707
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.505 Vali Acc: 0.274 Test Loss: 1.505 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1769964694976807
Epoch: 3, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.483 Vali Acc: 0.255 Test Loss: 1.483 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.328357696533203
Epoch: 4, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.485 Vali Acc: 0.251 Test Loss: 1.485 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.864171266555786
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.521 Vali Acc: 0.262 Test Loss: 1.521 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9315314292907715
Epoch: 6, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.706 Vali Acc: 0.232 Test Loss: 1.706 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2128915786743164
Epoch: 7, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.778 Vali Acc: 0.259 Test Loss: 1.778 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0647876262664795
Epoch: 8, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.661 Vali Acc: 0.224 Test Loss: 1.661 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.271564245223999
Epoch: 9, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.833 Vali Acc: 0.232 Test Loss: 1.833 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5393388271331787
Epoch: 10, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.806 Vali Acc: 0.217 Test Loss: 1.806 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.444643259048462
Epoch: 11, Steps: 17 | Train Loss: 0.959 Vali Loss: 2.275 Vali Acc: 0.255 Test Loss: 2.275 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps73_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44094724
model size : 182.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps73_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.364680290222168
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.451 Vali Acc: 0.270 Test Loss: 1.451 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 3.331153154373169
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.428290367126465
Epoch: 3, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.501 Vali Acc: 0.281 Test Loss: 1.501 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 3.2361207008361816
Epoch: 4, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.470 Vali Acc: 0.240 Test Loss: 1.470 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8062164783477783
Epoch: 5, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.531 Vali Acc: 0.255 Test Loss: 1.531 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3074865341186523
Epoch: 6, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.657 Vali Acc: 0.262 Test Loss: 1.657 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8587124347686768
Epoch: 7, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.557 Vali Acc: 0.236 Test Loss: 1.557 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.331956624984741
Epoch: 8, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.780 Vali Acc: 0.243 Test Loss: 1.780 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8703670501708984
Epoch: 9, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.821 Vali Acc: 0.262 Test Loss: 1.821 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9603567123413086
Epoch: 10, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.260 Vali Acc: 0.259 Test Loss: 2.260 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.874641180038452
Epoch: 11, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.888 Vali Acc: 0.232 Test Loss: 1.888 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7013697624206543
Epoch: 12, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.834 Vali Acc: 0.255 Test Loss: 1.834 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.367436170578003
Epoch: 13, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.843 Vali Acc: 0.243 Test Loss: 1.843 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps73_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 43988740
model size : 182.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.941058397293091
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.600 Vali Acc: 0.255 Test Loss: 1.600 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 4.1514458656311035
Epoch: 2, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.485 Vali Acc: 0.232 Test Loss: 1.485 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7258594036102295
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 2.082 Vali Acc: 0.247 Test Loss: 2.082 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.047053337097168
Epoch: 4, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.624 Vali Acc: 0.274 Test Loss: 1.624 Test Acc: 0.274
Validation loss decreased (-0.254737 --> -0.273748).  Saving model ...
Epoch: 5 cost time: 3.900805711746216
Epoch: 5, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.737 Vali Acc: 0.259 Test Loss: 1.737 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.458203077316284
Epoch: 6, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.607 Vali Acc: 0.255 Test Loss: 1.607 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.24663782119751
Epoch: 7, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.833 Vali Acc: 0.224 Test Loss: 1.833 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.4274210929870605
Epoch: 8, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.788 Vali Acc: 0.255 Test Loss: 1.788 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8042051792144775
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 2.208 Vali Acc: 0.270 Test Loss: 2.208 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0188138484954834
Epoch: 10, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.983 Vali Acc: 0.259 Test Loss: 1.983 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.228902816772461
Epoch: 11, Steps: 17 | Train Loss: 0.877 Vali Loss: 2.254 Vali Acc: 0.266 Test Loss: 2.254 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.416559219360352
Epoch: 12, Steps: 17 | Train Loss: 0.840 Vali Loss: 2.946 Vali Acc: 0.259 Test Loss: 2.946 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.94997239112854
Epoch: 13, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.260 Vali Acc: 0.247 Test Loss: 2.260 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.0760111808776855
Epoch: 14, Steps: 17 | Train Loss: 0.663 Vali Loss: 3.629 Vali Acc: 0.262 Test Loss: 3.629 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44297476
model size : 183.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.649482011795044
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.097347974777222
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.575 Vali Acc: 0.232 Test Loss: 1.575 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.212216377258301
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.523 Vali Acc: 0.270 Test Loss: 1.523 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 4.059046983718872
Epoch: 4, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.563 Vali Acc: 0.266 Test Loss: 1.563 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.155339956283569
Epoch: 5, Steps: 17 | Train Loss: 1.197 Vali Loss: 2.018 Vali Acc: 0.266 Test Loss: 2.018 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7641966342926025
Epoch: 6, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.780 Vali Acc: 0.236 Test Loss: 1.780 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9922537803649902
Epoch: 7, Steps: 17 | Train Loss: 1.104 Vali Loss: 2.188 Vali Acc: 0.236 Test Loss: 2.188 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6285104751586914
Epoch: 8, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.672 Vali Acc: 0.255 Test Loss: 1.672 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.338050365447998
Epoch: 9, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.687 Vali Acc: 0.236 Test Loss: 1.687 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.072387933731079
Epoch: 10, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.836 Vali Acc: 0.232 Test Loss: 1.836 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.156975269317627
Epoch: 11, Steps: 17 | Train Loss: 1.069 Vali Loss: 2.378 Vali Acc: 0.266 Test Loss: 2.378 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.495786190032959
Epoch: 12, Steps: 17 | Train Loss: 1.044 Vali Loss: 2.130 Vali Acc: 0.240 Test Loss: 2.130 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0582170486450195
Epoch: 13, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.812 Vali Acc: 0.278 Test Loss: 1.812 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277548).  Saving model ...
Epoch: 14 cost time: 3.691335678100586
Epoch: 14, Steps: 17 | Train Loss: 0.814 Vali Loss: 2.710 Vali Acc: 0.228 Test Loss: 2.710 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8780875205993652
Epoch: 15, Steps: 17 | Train Loss: 1.294 Vali Loss: 2.053 Vali Acc: 0.240 Test Loss: 2.053 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8030190467834473
Epoch: 16, Steps: 17 | Train Loss: 0.975 Vali Loss: 2.188 Vali Acc: 0.243 Test Loss: 2.188 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.880324602127075
Epoch: 17, Steps: 17 | Train Loss: 0.854 Vali Loss: 2.465 Vali Acc: 0.259 Test Loss: 2.465 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6280946731567383
Epoch: 18, Steps: 17 | Train Loss: 0.761 Vali Loss: 3.138 Vali Acc: 0.270 Test Loss: 3.138 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.089104652404785
Epoch: 19, Steps: 17 | Train Loss: 0.769 Vali Loss: 2.557 Vali Acc: 0.209 Test Loss: 2.557 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1205837726593018
Epoch: 20, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.624 Vali Acc: 0.262 Test Loss: 2.624 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.2328171730041504
Epoch: 21, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.763 Vali Acc: 0.240 Test Loss: 2.763 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9999818801879883
Epoch: 22, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.597 Vali Acc: 0.224 Test Loss: 2.597 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.6669297218322754
Epoch: 23, Steps: 17 | Train Loss: 0.668 Vali Loss: 2.767 Vali Acc: 0.236 Test Loss: 2.767 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 44108548
model size : 182.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.066776752471924
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.491 Vali Acc: 0.259 Test Loss: 1.491 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 2.2169110774993896
Epoch: 2, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.513 Vali Acc: 0.274 Test Loss: 1.513 Test Acc: 0.274
Validation loss decreased (-0.258540 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 1.5046072006225586
Epoch: 3, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.887892723083496
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.447 Vali Acc: 0.281 Test Loss: 1.447 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 1.9810948371887207
Epoch: 5, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.481 Vali Acc: 0.247 Test Loss: 1.481 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.388073682785034
Epoch: 6, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.530 Vali Acc: 0.243 Test Loss: 1.530 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3034651279449463
Epoch: 7, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.666 Vali Acc: 0.228 Test Loss: 1.666 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5044467449188232
Epoch: 8, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.720 Vali Acc: 0.209 Test Loss: 1.720 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3367526531219482
Epoch: 9, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.844 Vali Acc: 0.247 Test Loss: 1.844 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2428698539733887
Epoch: 10, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.793 Vali Acc: 0.236 Test Loss: 1.793 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3652467727661133
Epoch: 11, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.925 Vali Acc: 0.209 Test Loss: 1.925 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3746423721313477
Epoch: 12, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.924 Vali Acc: 0.274 Test Loss: 1.924 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3650341033935547
Epoch: 13, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.963 Vali Acc: 0.240 Test Loss: 1.963 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.603447198867798
Epoch: 14, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.007 Vali Acc: 0.247 Test Loss: 2.007 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44011780
model size : 182.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.3224427700042725
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.711 Vali Acc: 0.247 Test Loss: 1.711 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 2.8054747581481934
Epoch: 2, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.463 Vali Acc: 0.247 Test Loss: 1.463 Test Acc: 0.247
Validation loss decreased (-0.247131 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 3.6643104553222656
Epoch: 3, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.550 Vali Acc: 0.278 Test Loss: 1.550 Test Acc: 0.278
Validation loss decreased (-0.247134 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 3.1270534992218018
Epoch: 4, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.524 Vali Acc: 0.259 Test Loss: 1.524 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8943898677825928
Epoch: 5, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.935 Vali Acc: 0.232 Test Loss: 1.935 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.009527921676636
Epoch: 6, Steps: 17 | Train Loss: 1.147 Vali Loss: 2.093 Vali Acc: 0.262 Test Loss: 2.093 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.570056438446045
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.667 Vali Acc: 0.240 Test Loss: 1.667 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2221274375915527
Epoch: 8, Steps: 17 | Train Loss: 1.042 Vali Loss: 2.445 Vali Acc: 0.251 Test Loss: 2.445 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.552067756652832
Epoch: 9, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.844 Vali Acc: 0.266 Test Loss: 1.844 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.021467685699463
Epoch: 10, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.086 Vali Acc: 0.243 Test Loss: 2.086 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3206536769866943
Epoch: 11, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.336 Vali Acc: 0.259 Test Loss: 2.336 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.6865732669830322
Epoch: 12, Steps: 17 | Train Loss: 0.935 Vali Loss: 3.031 Vali Acc: 0.240 Test Loss: 3.031 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.713107109069824
Epoch: 13, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.210 Vali Acc: 0.243 Test Loss: 2.210 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 44318212
model size : 183.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.818597316741943
Epoch: 1, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.445 Vali Acc: 0.293 Test Loss: 1.445 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 3.059859275817871
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.436 Vali Acc: 0.285 Test Loss: 1.436 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.757706880569458
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.426 Vali Acc: 0.266 Test Loss: 1.426 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7039437294006348
Epoch: 4, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.511 Vali Acc: 0.247 Test Loss: 1.511 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9394893646240234
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.668 Vali Acc: 0.247 Test Loss: 1.668 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.574375629425049
Epoch: 6, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.619 Vali Acc: 0.221 Test Loss: 1.619 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0236291885375977
Epoch: 7, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.585 Vali Acc: 0.259 Test Loss: 1.585 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8212530612945557
Epoch: 8, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.841 Vali Acc: 0.232 Test Loss: 1.841 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8860244750976562
Epoch: 9, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.819 Vali Acc: 0.247 Test Loss: 1.819 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.743868589401245
Epoch: 10, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.843 Vali Acc: 0.270 Test Loss: 1.843 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.670387029647827
Epoch: 11, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.981 Vali Acc: 0.240 Test Loss: 1.981 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 44124676
model size : 183.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.584339380264282
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.416 Vali Acc: 0.270 Test Loss: 1.416 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 2.2667407989501953
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.435 Vali Acc: 0.270 Test Loss: 1.435 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7892353534698486
Epoch: 3, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.577 Vali Acc: 0.259 Test Loss: 1.577 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9903621673583984
Epoch: 4, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.688 Vali Acc: 0.274 Test Loss: 1.688 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273747).  Saving model ...
Epoch: 5 cost time: 3.127964973449707
Epoch: 5, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.565 Vali Acc: 0.221 Test Loss: 1.565 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.473045825958252
Epoch: 6, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.646 Vali Acc: 0.266 Test Loss: 1.646 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6346850395202637
Epoch: 7, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.601 Vali Acc: 0.221 Test Loss: 1.601 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.952820062637329
Epoch: 8, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.605 Vali Acc: 0.240 Test Loss: 1.605 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6972780227661133
Epoch: 9, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.813 Vali Acc: 0.236 Test Loss: 1.813 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7495710849761963
Epoch: 10, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.692 Vali Acc: 0.232 Test Loss: 1.692 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.013392448425293
Epoch: 11, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.270 Vali Acc: 0.236 Test Loss: 2.270 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2164270877838135
Epoch: 12, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.806 Vali Acc: 0.251 Test Loss: 1.806 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2198703289031982
Epoch: 13, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.834 Vali Acc: 0.224 Test Loss: 1.834 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1493232250213623
Epoch: 14, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.963 Vali Acc: 0.236 Test Loss: 1.963 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44027908
model size : 182.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps84_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.717261791229248
Epoch: 1, Steps: 17 | Train Loss: 1.549 Vali Loss: 1.450 Vali Acc: 0.240 Test Loss: 1.450 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 3.515803575515747
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.477 Vali Acc: 0.247 Test Loss: 1.477 Test Acc: 0.247
Validation loss decreased (-0.239529 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 3.7508583068847656
Epoch: 3, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.799 Vali Acc: 0.270 Test Loss: 1.799 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269944).  Saving model ...
Epoch: 4 cost time: 4.025948762893677
Epoch: 4, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.563 Vali Acc: 0.240 Test Loss: 1.563 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.520711421966553
Epoch: 5, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.588 Vali Acc: 0.259 Test Loss: 1.588 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.2234437465667725
Epoch: 6, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.889 Vali Acc: 0.217 Test Loss: 1.889 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.878999948501587
Epoch: 7, Steps: 17 | Train Loss: 1.148 Vali Loss: 2.596 Vali Acc: 0.270 Test Loss: 2.596 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.052158355712891
Epoch: 8, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.694 Vali Acc: 0.247 Test Loss: 1.694 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.304518699645996
Epoch: 9, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.171 Vali Acc: 0.228 Test Loss: 2.171 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.604498863220215
Epoch: 10, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.036 Vali Acc: 0.228 Test Loss: 2.036 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.194082498550415
Epoch: 11, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.767 Vali Acc: 0.243 Test Loss: 1.767 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.276609182357788
Epoch: 12, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.925 Vali Acc: 0.274 Test Loss: 2.925 Test Acc: 0.274
Validation loss decreased (-0.269944 --> -0.273735).  Saving model ...
Epoch: 13 cost time: 3.5357820987701416
Epoch: 13, Steps: 17 | Train Loss: 0.788 Vali Loss: 2.408 Vali Acc: 0.266 Test Loss: 2.408 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1558053493499756
Epoch: 14, Steps: 17 | Train Loss: 0.734 Vali Loss: 2.426 Vali Acc: 0.232 Test Loss: 2.426 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.610987901687622
Epoch: 15, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.935 Vali Acc: 0.221 Test Loss: 2.935 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.289957046508789
Epoch: 16, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.902 Vali Acc: 0.255 Test Loss: 2.902 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8343231678009033
Epoch: 17, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.458 Vali Acc: 0.259 Test Loss: 2.458 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.529477834701538
Epoch: 18, Steps: 17 | Train Loss: 0.693 Vali Loss: 2.843 Vali Acc: 0.262 Test Loss: 2.843 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.302489757537842
Epoch: 19, Steps: 17 | Train Loss: 0.539 Vali Loss: 3.968 Vali Acc: 0.270 Test Loss: 3.968 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.054226875305176
Epoch: 20, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.679 Vali Acc: 0.266 Test Loss: 2.679 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7950706481933594
Epoch: 21, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.910 Vali Acc: 0.240 Test Loss: 2.910 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.650648593902588
Epoch: 22, Steps: 17 | Train Loss: 0.470 Vali Loss: 4.287 Vali Acc: 0.232 Test Loss: 4.287 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps84_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44327428
model size : 183.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps84_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.71867036819458
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.488 Vali Acc: 0.247 Test Loss: 1.488 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 1.9987552165985107
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.526 Vali Acc: 0.262 Test Loss: 1.526 Test Acc: 0.262
Validation loss decreased (-0.247133 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 1.733426570892334
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.520 Vali Acc: 0.262 Test Loss: 1.520 Test Acc: 0.262
Validation loss decreased (-0.262342 --> -0.262342).  Saving model ...
Epoch: 4 cost time: 2.732194185256958
Epoch: 4, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.511 Vali Acc: 0.247 Test Loss: 1.511 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4225494861602783
Epoch: 5, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.773 Vali Acc: 0.243 Test Loss: 1.773 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7117397785186768
Epoch: 6, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.676 Vali Acc: 0.232 Test Loss: 1.676 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1776719093322754
Epoch: 7, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.750 Vali Acc: 0.205 Test Loss: 1.750 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.578289031982422
Epoch: 8, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.687 Vali Acc: 0.255 Test Loss: 1.687 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.137148380279541
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.158 Vali Acc: 0.232 Test Loss: 2.158 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.3244128227233887
Epoch: 10, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.747 Vali Acc: 0.243 Test Loss: 1.747 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.957170009613037
Epoch: 11, Steps: 17 | Train Loss: 0.921 Vali Loss: 2.173 Vali Acc: 0.236 Test Loss: 2.173 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1199560165405273
Epoch: 12, Steps: 17 | Train Loss: 0.880 Vali Loss: 2.223 Vali Acc: 0.236 Test Loss: 2.223 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.476461887359619
Epoch: 13, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.292 Vali Acc: 0.232 Test Loss: 2.292 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps84_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 44143108
model size : 183.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps84_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8105804920196533
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.409 Vali Acc: 0.259 Test Loss: 1.409 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.0894970893859863
Epoch: 2, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.438 Vali Acc: 0.259 Test Loss: 1.438 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.883662462234497
Epoch: 3, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.539 Vali Acc: 0.281 Test Loss: 1.539 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281353).  Saving model ...
Epoch: 4 cost time: 1.8423271179199219
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0223114490509033
Epoch: 5, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.494 Vali Acc: 0.255 Test Loss: 1.494 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5180535316467285
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.747448444366455
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.658 Vali Acc: 0.247 Test Loss: 1.658 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4520761966705322
Epoch: 8, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.655 Vali Acc: 0.247 Test Loss: 1.655 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6860239505767822
Epoch: 9, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.690 Vali Acc: 0.259 Test Loss: 1.690 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8758628368377686
Epoch: 10, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.702 Vali Acc: 0.247 Test Loss: 1.702 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5481386184692383
Epoch: 11, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.976 Vali Acc: 0.236 Test Loss: 1.976 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6188085079193115
Epoch: 12, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.884 Vali Acc: 0.270 Test Loss: 1.884 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4696376323699951
Epoch: 13, Steps: 17 | Train Loss: 0.978 Vali Loss: 2.267 Vali Acc: 0.255 Test Loss: 2.267 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps84_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44050948
model size : 182.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps88_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.5265257358551025
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.693 Vali Acc: 0.255 Test Loss: 1.693 Test Acc: 0.255
Validation loss decreased (inf --> -0.254736).  Saving model ...
Epoch: 2 cost time: 3.8425514698028564
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.523 Vali Acc: 0.259 Test Loss: 1.523 Test Acc: 0.259
Validation loss decreased (-0.254736 --> -0.258540).  Saving model ...
Epoch: 3 cost time: 4.1558308601379395
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.787 Vali Acc: 0.243 Test Loss: 1.787 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6097373962402344
Epoch: 4, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.568 Vali Acc: 0.251 Test Loss: 1.568 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.297582149505615
Epoch: 5, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.605 Vali Acc: 0.228 Test Loss: 1.605 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.902817726135254
Epoch: 6, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.677 Vali Acc: 0.247 Test Loss: 1.677 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9783058166503906
Epoch: 7, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.746 Vali Acc: 0.228 Test Loss: 1.746 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.4959990978240967
Epoch: 8, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.868 Vali Acc: 0.259 Test Loss: 1.868 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.486285924911499
Epoch: 9, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.737 Vali Acc: 0.232 Test Loss: 1.737 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7779524326324463
Epoch: 10, Steps: 17 | Train Loss: 1.040 Vali Loss: 2.019 Vali Acc: 0.255 Test Loss: 2.019 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.9249885082244873
Epoch: 11, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.531 Vali Acc: 0.270 Test Loss: 2.531 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269937).  Saving model ...
Epoch: 12 cost time: 4.031984329223633
Epoch: 12, Steps: 17 | Train Loss: 1.068 Vali Loss: 2.073 Vali Acc: 0.186 Test Loss: 2.073 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.418382167816162
Epoch: 13, Steps: 17 | Train Loss: 0.959 Vali Loss: 2.268 Vali Acc: 0.247 Test Loss: 2.268 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.20173716545105
Epoch: 14, Steps: 17 | Train Loss: 0.798 Vali Loss: 2.907 Vali Acc: 0.240 Test Loss: 2.907 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2871482372283936
Epoch: 15, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.994 Vali Acc: 0.240 Test Loss: 1.994 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3721437454223633
Epoch: 16, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.607 Vali Acc: 0.247 Test Loss: 2.607 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.568042755126953
Epoch: 17, Steps: 17 | Train Loss: 0.687 Vali Loss: 2.456 Vali Acc: 0.232 Test Loss: 2.456 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3781309127807617
Epoch: 18, Steps: 17 | Train Loss: 0.709 Vali Loss: 3.755 Vali Acc: 0.221 Test Loss: 3.755 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.50212025642395
Epoch: 19, Steps: 17 | Train Loss: 0.778 Vali Loss: 2.936 Vali Acc: 0.221 Test Loss: 2.936 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.598806381225586
Epoch: 20, Steps: 17 | Train Loss: 0.498 Vali Loss: 3.572 Vali Acc: 0.232 Test Loss: 3.572 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.1893463134765625
Epoch: 21, Steps: 17 | Train Loss: 0.750 Vali Loss: 3.207 Vali Acc: 0.228 Test Loss: 3.207 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps88_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 44336644
model size : 183.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.148497581481934
Epoch: 1, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.465 Vali Acc: 0.266 Test Loss: 1.465 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 2.779226779937744
Epoch: 2, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.462 Vali Acc: 0.255 Test Loss: 1.462 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7347774505615234
Epoch: 3, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.496 Vali Acc: 0.236 Test Loss: 1.496 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7282280921936035
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.559 Vali Acc: 0.217 Test Loss: 1.559 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6830191612243652
Epoch: 5, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.587 Vali Acc: 0.240 Test Loss: 1.587 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2628281116485596
Epoch: 6, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.683 Vali Acc: 0.251 Test Loss: 1.683 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5233139991760254
Epoch: 7, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.689 Vali Acc: 0.240 Test Loss: 1.689 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9402053356170654
Epoch: 8, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.902 Vali Acc: 0.247 Test Loss: 1.902 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.025391101837158
Epoch: 9, Steps: 17 | Train Loss: 0.969 Vali Loss: 2.042 Vali Acc: 0.236 Test Loss: 2.042 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.036012649536133
Epoch: 10, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.151 Vali Acc: 0.236 Test Loss: 2.151 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.0053517818450928
Epoch: 11, Steps: 17 | Train Loss: 0.967 Vali Loss: 2.347 Vali Acc: 0.240 Test Loss: 2.347 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 44161540
model size : 183.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps88_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.481440544128418
Epoch: 1, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.429 Vali Acc: 0.221 Test Loss: 1.429 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 3.566920280456543
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.579 Vali Acc: 0.270 Test Loss: 1.579 Test Acc: 0.270
Validation loss decreased (-0.220518 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 2.547424077987671
Epoch: 3, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.459 Vali Acc: 0.224 Test Loss: 1.459 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9573395252227783
Epoch: 4, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.538607120513916
Epoch: 5, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.495 Vali Acc: 0.240 Test Loss: 1.495 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8137755393981934
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.747 Vali Acc: 0.236 Test Loss: 1.747 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.219341278076172
Epoch: 7, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.533 Vali Acc: 0.228 Test Loss: 1.533 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.11899995803833
Epoch: 8, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.721 Vali Acc: 0.236 Test Loss: 1.721 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.323068380355835
Epoch: 9, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.845 Vali Acc: 0.243 Test Loss: 1.845 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.397610902786255
Epoch: 10, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.599 Vali Acc: 0.266 Test Loss: 1.599 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8325085639953613
Epoch: 11, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.868 Vali Acc: 0.228 Test Loss: 1.868 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8002963066101074
Epoch: 12, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.009 Vali Acc: 0.217 Test Loss: 2.009 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps88_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 44073988
model size : 182.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.1210737228393555
Epoch: 1, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.529 Vali Acc: 0.281 Test Loss: 1.529 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 3.3099515438079834
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.555 Vali Acc: 0.243 Test Loss: 1.555 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.277458429336548
Epoch: 3, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.814 Vali Acc: 0.247 Test Loss: 1.814 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5306994915008545
Epoch: 4, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.565 Vali Acc: 0.274 Test Loss: 1.565 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5433130264282227
Epoch: 5, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.804 Vali Acc: 0.243 Test Loss: 1.804 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.526858568191528
Epoch: 6, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.616 Vali Acc: 0.243 Test Loss: 1.616 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.6170220375061035
Epoch: 7, Steps: 17 | Train Loss: 0.953 Vali Loss: 2.304 Vali Acc: 0.255 Test Loss: 2.304 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.347620487213135
Epoch: 8, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.878 Vali Acc: 0.243 Test Loss: 1.878 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.950366258621216
Epoch: 9, Steps: 17 | Train Loss: 0.904 Vali Loss: 2.067 Vali Acc: 0.259 Test Loss: 2.067 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.0556817054748535
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 2.105 Vali Acc: 0.232 Test Loss: 2.105 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.08918833732605
Epoch: 11, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.324 Vali Acc: 0.243 Test Loss: 2.324 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44343556
model size : 183.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.2004005908966064
Epoch: 1, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.723 Vali Acc: 0.243 Test Loss: 1.723 Test Acc: 0.243
Validation loss decreased (inf --> -0.243329).  Saving model ...
Epoch: 2 cost time: 3.3298025131225586
Epoch: 2, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.469 Vali Acc: 0.281 Test Loss: 1.469 Test Acc: 0.281
Validation loss decreased (-0.243329 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 3.3044562339782715
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7979190349578857
Epoch: 4, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.670 Vali Acc: 0.232 Test Loss: 1.670 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1227807998657227
Epoch: 5, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.456 Vali Acc: 0.262 Test Loss: 1.456 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.416578531265259
Epoch: 6, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.591 Vali Acc: 0.274 Test Loss: 1.591 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.205354928970337
Epoch: 7, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.256225824356079
Epoch: 8, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.617 Vali Acc: 0.255 Test Loss: 1.617 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7699942588806152
Epoch: 9, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.731 Vali Acc: 0.251 Test Loss: 1.731 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.5350067615509033
Epoch: 10, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.684 Vali Acc: 0.247 Test Loss: 1.684 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.6453449726104736
Epoch: 11, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.997 Vali Acc: 0.247 Test Loss: 1.997 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.342203378677368
Epoch: 12, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.969 Vali Acc: 0.278 Test Loss: 1.969 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44186884
model size : 183.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.309372663497925
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.466 Vali Acc: 0.251 Test Loss: 1.466 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.099134922027588
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.7961909770965576
Epoch: 3, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.478 Vali Acc: 0.247 Test Loss: 1.478 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.019965648651123
Epoch: 4, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.502 Vali Acc: 0.281 Test Loss: 1.502 Test Acc: 0.281
Validation loss decreased (-0.254738 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 2.7019193172454834
Epoch: 5, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.496 Vali Acc: 0.270 Test Loss: 1.496 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9864797592163086
Epoch: 6, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.584 Vali Acc: 0.243 Test Loss: 1.584 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.174832820892334
Epoch: 7, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.735 Vali Acc: 0.247 Test Loss: 1.735 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.711231231689453
Epoch: 8, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.672 Vali Acc: 0.251 Test Loss: 1.672 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5957868099212646
Epoch: 9, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.635 Vali Acc: 0.259 Test Loss: 1.635 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5092504024505615
Epoch: 10, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.630 Vali Acc: 0.224 Test Loss: 1.630 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.56840443611145
Epoch: 11, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.748 Vali Acc: 0.274 Test Loss: 1.748 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5199100971221924
Epoch: 12, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.041 Vali Acc: 0.232 Test Loss: 2.041 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.5468344688415527
Epoch: 13, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.881 Vali Acc: 0.266 Test Loss: 1.881 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5236170291900635
Epoch: 14, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.116 Vali Acc: 0.247 Test Loss: 2.116 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44103940
model size : 182.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps98_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.562865972518921
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.497 Vali Acc: 0.274 Test Loss: 1.497 Test Acc: 0.274
Validation loss decreased (inf --> -0.273749).  Saving model ...
Epoch: 2 cost time: 4.361429452896118
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.609 Vali Acc: 0.274 Test Loss: 1.609 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.08233380317688
Epoch: 3, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.512 Vali Acc: 0.236 Test Loss: 1.512 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.061050176620483
Epoch: 4, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.688 Vali Acc: 0.270 Test Loss: 1.688 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.365211248397827
Epoch: 5, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.662 Vali Acc: 0.266 Test Loss: 1.662 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.43060827255249
Epoch: 6, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.769 Vali Acc: 0.247 Test Loss: 1.769 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.172823905944824
Epoch: 7, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.687 Vali Acc: 0.247 Test Loss: 1.687 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.607244491577148
Epoch: 8, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.960 Vali Acc: 0.243 Test Loss: 1.960 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.282566785812378
Epoch: 9, Steps: 17 | Train Loss: 1.056 Vali Loss: 2.173 Vali Acc: 0.262 Test Loss: 2.173 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.909397840499878
Epoch: 10, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.043 Vali Acc: 0.255 Test Loss: 2.043 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.225295543670654
Epoch: 11, Steps: 17 | Train Loss: 1.057 Vali Loss: 2.150 Vali Acc: 0.251 Test Loss: 2.150 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps98_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44364292
model size : 183.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps98_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.930173873901367
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 3.267723560333252
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.471 Vali Acc: 0.278 Test Loss: 1.471 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 3.084199905395508
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.634 Vali Acc: 0.259 Test Loss: 1.634 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4777069091796875
Epoch: 4, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.667 Vali Acc: 0.262 Test Loss: 1.667 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9925618171691895
Epoch: 5, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.766 Vali Acc: 0.243 Test Loss: 1.766 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1432931423187256
Epoch: 6, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.160 Vali Acc: 0.228 Test Loss: 2.160 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.66031813621521
Epoch: 7, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.601 Vali Acc: 0.270 Test Loss: 1.601 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.4012296199798584
Epoch: 8, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.639 Vali Acc: 0.236 Test Loss: 1.639 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.5433290004730225
Epoch: 9, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.909 Vali Acc: 0.236 Test Loss: 1.909 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6841394901275635
Epoch: 10, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.635 Vali Acc: 0.205 Test Loss: 1.635 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.84688401222229
Epoch: 11, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.876 Vali Acc: 0.278 Test Loss: 1.876 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.867790937423706
Epoch: 12, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.012 Vali Acc: 0.300 Test Loss: 2.012 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300360).  Saving model ...
Epoch: 13 cost time: 2.6704277992248535
Epoch: 13, Steps: 17 | Train Loss: 1.112 Vali Loss: 2.193 Vali Acc: 0.243 Test Loss: 2.193 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0537939071655273
Epoch: 14, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.788 Vali Acc: 0.266 Test Loss: 1.788 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9292964935302734
Epoch: 15, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.424 Vali Acc: 0.232 Test Loss: 2.424 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.678372621536255
Epoch: 16, Steps: 17 | Train Loss: 0.912 Vali Loss: 2.759 Vali Acc: 0.243 Test Loss: 2.759 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.029731512069702
Epoch: 17, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.128 Vali Acc: 0.224 Test Loss: 2.128 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.963294267654419
Epoch: 18, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.404 Vali Acc: 0.289 Test Loss: 2.404 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3662335872650146
Epoch: 19, Steps: 17 | Train Loss: 0.754 Vali Loss: 2.563 Vali Acc: 0.247 Test Loss: 2.563 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1283693313598633
Epoch: 20, Steps: 17 | Train Loss: 0.861 Vali Loss: 2.660 Vali Acc: 0.243 Test Loss: 2.660 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.47916579246521
Epoch: 21, Steps: 17 | Train Loss: 0.697 Vali Loss: 2.690 Vali Acc: 0.228 Test Loss: 2.690 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.977998733520508
Epoch: 22, Steps: 17 | Train Loss: 0.631 Vali Loss: 2.891 Vali Acc: 0.251 Test Loss: 2.891 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps98_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 44212228
model size : 183.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps98_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.438032150268555
Epoch: 1, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.435 Vali Acc: 0.285 Test Loss: 1.435 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 2.985032320022583
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.431 Vali Acc: 0.262 Test Loss: 1.431 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.543816089630127
Epoch: 3, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.617 Vali Acc: 0.232 Test Loss: 1.617 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.079570770263672
Epoch: 4, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.466 Vali Acc: 0.259 Test Loss: 1.466 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9448039531707764
Epoch: 5, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.870846748352051
Epoch: 6, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.059420347213745
Epoch: 7, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.590 Vali Acc: 0.247 Test Loss: 1.590 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2349398136138916
Epoch: 8, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.615 Vali Acc: 0.259 Test Loss: 1.615 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0738518238067627
Epoch: 9, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.694 Vali Acc: 0.240 Test Loss: 1.694 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.829214572906494
Epoch: 10, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.836 Vali Acc: 0.243 Test Loss: 1.836 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.8352749347686768
Epoch: 11, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.669 Vali Acc: 0.259 Test Loss: 1.669 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps98_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 44133892
model size : 183.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps103_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.5939953327178955
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.456 Vali Acc: 0.255 Test Loss: 1.456 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 5.31280779838562
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 4.953927278518677
Epoch: 3, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.476 Vali Acc: 0.255 Test Loss: 1.476 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.804069519042969
Epoch: 4, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.603 Vali Acc: 0.255 Test Loss: 1.603 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8753013610839844
Epoch: 5, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.606 Vali Acc: 0.224 Test Loss: 1.606 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.316681623458862
Epoch: 6, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.595 Vali Acc: 0.228 Test Loss: 1.595 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.448585510253906
Epoch: 7, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.733 Vali Acc: 0.224 Test Loss: 1.733 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.354507684707642
Epoch: 8, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.787 Vali Acc: 0.255 Test Loss: 1.787 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.815073013305664
Epoch: 9, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.791 Vali Acc: 0.217 Test Loss: 1.791 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8258376121520996
Epoch: 10, Steps: 17 | Train Loss: 0.940 Vali Loss: 2.170 Vali Acc: 0.228 Test Loss: 2.170 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.8897480964660645
Epoch: 11, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.893 Vali Acc: 0.270 Test Loss: 1.893 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.6264965534210205
Epoch: 12, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.001 Vali Acc: 0.221 Test Loss: 2.001 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps103_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 44385028
model size : 183.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps103_str52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.739205598831177
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.453 Vali Acc: 0.251 Test Loss: 1.453 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 2.730652332305908
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.505 Vali Acc: 0.232 Test Loss: 1.505 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9032046794891357
Epoch: 3, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.521 Vali Acc: 0.247 Test Loss: 1.521 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.424412965774536
Epoch: 4, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.493 Vali Acc: 0.217 Test Loss: 1.493 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8719255924224854
Epoch: 5, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.609 Vali Acc: 0.236 Test Loss: 1.609 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9284908771514893
Epoch: 6, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5016281604766846
Epoch: 7, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.882 Vali Acc: 0.221 Test Loss: 1.882 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0344371795654297
Epoch: 8, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.604 Vali Acc: 0.255 Test Loss: 1.604 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254737).  Saving model ...
Epoch: 9 cost time: 3.643850088119507
Epoch: 9, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.838 Vali Acc: 0.224 Test Loss: 1.838 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5316169261932373
Epoch: 10, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.017 Vali Acc: 0.270 Test Loss: 2.017 Test Acc: 0.270
Validation loss decreased (-0.254737 --> -0.269942).  Saving model ...
Epoch: 11 cost time: 2.746864080429077
Epoch: 11, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.635 Vali Acc: 0.243 Test Loss: 1.635 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6169283390045166
Epoch: 12, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.643 Vali Acc: 0.259 Test Loss: 1.643 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.134188652038574
Epoch: 13, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.916 Vali Acc: 0.228 Test Loss: 1.916 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.647019624710083
Epoch: 14, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.267 Vali Acc: 0.262 Test Loss: 2.267 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6839840412139893
Epoch: 15, Steps: 17 | Train Loss: 0.934 Vali Loss: 2.147 Vali Acc: 0.255 Test Loss: 2.147 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.351768970489502
Epoch: 16, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.166 Vali Acc: 0.232 Test Loss: 2.166 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.739034414291382
Epoch: 17, Steps: 17 | Train Loss: 0.954 Vali Loss: 2.085 Vali Acc: 0.205 Test Loss: 2.085 Test Acc: 0.205
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.996778726577759
Epoch: 18, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.106 Vali Acc: 0.251 Test Loss: 2.106 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.186824321746826
Epoch: 19, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.734 Vali Acc: 0.236 Test Loss: 2.734 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2844152450561523
Epoch: 20, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.332 Vali Acc: 0.259 Test Loss: 2.332 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps103_str52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 44237572
model size : 183.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps103_str103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.7697601318359375
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.416 Vali Acc: 0.236 Test Loss: 1.416 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 2.4459800720214844
Epoch: 2, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.509 Vali Acc: 0.232 Test Loss: 1.509 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9550414085388184
Epoch: 3, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.556 Vali Acc: 0.259 Test Loss: 1.556 Test Acc: 0.259
Validation loss decreased (-0.235727 --> -0.258540).  Saving model ...
Epoch: 4 cost time: 2.437899112701416
Epoch: 4, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.517 Vali Acc: 0.266 Test Loss: 1.517 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 2.38403058052063
Epoch: 5, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.496 Vali Acc: 0.266 Test Loss: 1.496 Test Acc: 0.266
Validation loss decreased (-0.266145 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 2.4848341941833496
Epoch: 6, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.585 Vali Acc: 0.240 Test Loss: 1.585 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5406887531280518
Epoch: 7, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.630 Vali Acc: 0.232 Test Loss: 1.630 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7530577182769775
Epoch: 8, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.752 Vali Acc: 0.232 Test Loss: 1.752 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.022390365600586
Epoch: 9, Steps: 17 | Train Loss: 1.138 Vali Loss: 2.055 Vali Acc: 0.228 Test Loss: 2.055 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2563061714172363
Epoch: 10, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.730 Vali Acc: 0.251 Test Loss: 1.730 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1153037548065186
Epoch: 11, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.913 Vali Acc: 0.232 Test Loss: 1.913 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.043833017349243
Epoch: 12, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.982 Vali Acc: 0.243 Test Loss: 1.982 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.554417610168457
Epoch: 13, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.054 Vali Acc: 0.224 Test Loss: 2.054 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2682929039001465
Epoch: 14, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.313 Vali Acc: 0.247 Test Loss: 2.313 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4816346168518066
Epoch: 15, Steps: 17 | Train Loss: 0.921 Vali Loss: 2.044 Vali Acc: 0.221 Test Loss: 2.044 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps103_str103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 44168452
model size : 183.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps110_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.190797567367554
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.499 Vali Acc: 0.270 Test Loss: 1.499 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 5.122499704360962
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.464 Vali Acc: 0.281 Test Loss: 1.464 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 3.964707374572754
Epoch: 3, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.684 Vali Acc: 0.240 Test Loss: 1.684 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9971041679382324
Epoch: 4, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.641 Vali Acc: 0.255 Test Loss: 1.641 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.045706510543823
Epoch: 5, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.692 Vali Acc: 0.262 Test Loss: 1.692 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.564054727554321
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.875 Vali Acc: 0.255 Test Loss: 1.875 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.482675313949585
Epoch: 7, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.829 Vali Acc: 0.281 Test Loss: 1.829 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.518843650817871
Epoch: 8, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.897 Vali Acc: 0.270 Test Loss: 1.897 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.295251131057739
Epoch: 9, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.756 Vali Acc: 0.278 Test Loss: 1.756 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.155719518661499
Epoch: 10, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.954 Vali Acc: 0.236 Test Loss: 1.954 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.6662497520446777
Epoch: 11, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.125 Vali Acc: 0.259 Test Loss: 2.125 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.358996629714966
Epoch: 12, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.008 Vali Acc: 0.289 Test Loss: 2.008 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288953).  Saving model ...
Epoch: 13 cost time: 4.4444286823272705
Epoch: 13, Steps: 17 | Train Loss: 0.969 Vali Loss: 2.074 Vali Acc: 0.221 Test Loss: 2.074 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.009495258331299
Epoch: 14, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.617 Vali Acc: 0.255 Test Loss: 2.617 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.116194486618042
Epoch: 15, Steps: 17 | Train Loss: 0.814 Vali Loss: 2.754 Vali Acc: 0.251 Test Loss: 2.754 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.233375072479248
Epoch: 16, Steps: 17 | Train Loss: 0.876 Vali Loss: 2.641 Vali Acc: 0.247 Test Loss: 2.641 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.477989673614502
Epoch: 17, Steps: 17 | Train Loss: 0.693 Vali Loss: 2.957 Vali Acc: 0.251 Test Loss: 2.957 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.195337772369385
Epoch: 18, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.500 Vali Acc: 0.240 Test Loss: 2.500 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.040684461593628
Epoch: 19, Steps: 17 | Train Loss: 0.753 Vali Loss: 2.939 Vali Acc: 0.255 Test Loss: 2.939 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.080054998397827
Epoch: 20, Steps: 17 | Train Loss: 0.816 Vali Loss: 2.863 Vali Acc: 0.255 Test Loss: 2.863 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.230913877487183
Epoch: 21, Steps: 17 | Train Loss: 0.769 Vali Loss: 2.484 Vali Acc: 0.266 Test Loss: 2.484 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.55005955696106
Epoch: 22, Steps: 17 | Train Loss: 0.584 Vali Loss: 3.419 Vali Acc: 0.232 Test Loss: 3.419 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps110_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 44410372
model size : 184.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps110_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.8137781620025635
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.469 Vali Acc: 0.266 Test Loss: 1.469 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 2.931300163269043
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.497 Vali Acc: 0.262 Test Loss: 1.497 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7825043201446533
Epoch: 3, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.618 Vali Acc: 0.247 Test Loss: 1.618 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4163503646850586
Epoch: 4, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.654 Vali Acc: 0.266 Test Loss: 1.654 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.557152032852173
Epoch: 5, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.505 Vali Acc: 0.217 Test Loss: 1.505 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.821993589401245
Epoch: 6, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.853 Vali Acc: 0.243 Test Loss: 1.853 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.460909366607666
Epoch: 7, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.669 Vali Acc: 0.243 Test Loss: 1.669 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6871531009674072
Epoch: 8, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.829 Vali Acc: 0.266 Test Loss: 1.829 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.143603563308716
Epoch: 9, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.593 Vali Acc: 0.232 Test Loss: 1.593 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.0334880352020264
Epoch: 10, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.141 Vali Acc: 0.251 Test Loss: 2.141 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7738900184631348
Epoch: 11, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.773 Vali Acc: 0.255 Test Loss: 1.773 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps110_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 44276740
model size : 183.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps110_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.317209243774414
Epoch: 1, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.447 Vali Acc: 0.247 Test Loss: 1.447 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 2.7820849418640137
Epoch: 2, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.525 Vali Acc: 0.251 Test Loss: 1.525 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250935).  Saving model ...
Epoch: 3 cost time: 2.2603466510772705
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.497 Vali Acc: 0.285 Test Loss: 1.497 Test Acc: 0.285
Validation loss decreased (-0.250935 --> -0.285156).  Saving model ...
Epoch: 4 cost time: 2.7053062915802
Epoch: 4, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.499 Vali Acc: 0.274 Test Loss: 1.499 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6492490768432617
Epoch: 5, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.482 Vali Acc: 0.247 Test Loss: 1.482 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0279340744018555
Epoch: 6, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.537 Vali Acc: 0.285 Test Loss: 1.537 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3889944553375244
Epoch: 7, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.556 Vali Acc: 0.232 Test Loss: 1.556 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.160576820373535
Epoch: 8, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.657 Vali Acc: 0.255 Test Loss: 1.657 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.549283981323242
Epoch: 9, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.743 Vali Acc: 0.259 Test Loss: 1.743 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3784055709838867
Epoch: 10, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.786 Vali Acc: 0.262 Test Loss: 1.786 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.443539619445801
Epoch: 11, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.656 Vali Acc: 0.236 Test Loss: 1.656 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9866042137145996
Epoch: 12, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.933 Vali Acc: 0.262 Test Loss: 1.933 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1475207805633545
Epoch: 13, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.775 Vali Acc: 0.228 Test Loss: 1.775 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps110_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 44207620
model size : 183.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps117_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.046625852584839
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.563 Vali Acc: 0.255 Test Loss: 1.563 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 3.566354274749756
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.505 Vali Acc: 0.262 Test Loss: 1.505 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 3.0771093368530273
Epoch: 3, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.25395393371582
Epoch: 4, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.727 Vali Acc: 0.262 Test Loss: 1.727 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5327517986297607
Epoch: 5, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.718 Vali Acc: 0.247 Test Loss: 1.718 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5847654342651367
Epoch: 6, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.584 Vali Acc: 0.240 Test Loss: 1.584 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.44636607170105
Epoch: 7, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.556 Vali Acc: 0.240 Test Loss: 1.556 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9351625442504883
Epoch: 8, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.972 Vali Acc: 0.236 Test Loss: 1.972 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9065189361572266
Epoch: 9, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.690 Vali Acc: 0.240 Test Loss: 1.690 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7505431175231934
Epoch: 10, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.823 Vali Acc: 0.270 Test Loss: 1.823 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269944).  Saving model ...
Epoch: 11 cost time: 3.2719175815582275
Epoch: 11, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.647 Vali Acc: 0.232 Test Loss: 1.647 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5455093383789062
Epoch: 12, Steps: 17 | Train Loss: 0.967 Vali Loss: 2.068 Vali Acc: 0.270 Test Loss: 2.068 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.590360641479492
Epoch: 13, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.135 Vali Acc: 0.259 Test Loss: 2.135 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.9828104972839355
Epoch: 14, Steps: 17 | Train Loss: 0.998 Vali Loss: 2.073 Vali Acc: 0.259 Test Loss: 2.073 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9243712425231934
Epoch: 15, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.895 Vali Acc: 0.285 Test Loss: 1.895 Test Acc: 0.285
Validation loss decreased (-0.269944 --> -0.285152).  Saving model ...
Epoch: 16 cost time: 4.537383079528809
Epoch: 16, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.473 Vali Acc: 0.232 Test Loss: 2.473 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.4061548709869385
Epoch: 17, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.215 Vali Acc: 0.232 Test Loss: 2.215 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.414954662322998
Epoch: 18, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.773 Vali Acc: 0.266 Test Loss: 2.773 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.382791519165039
Epoch: 19, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.424 Vali Acc: 0.255 Test Loss: 2.424 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.499030828475952
Epoch: 20, Steps: 17 | Train Loss: 0.850 Vali Loss: 2.353 Vali Acc: 0.243 Test Loss: 2.353 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.2677247524261475
Epoch: 21, Steps: 17 | Train Loss: 0.755 Vali Loss: 3.394 Vali Acc: 0.259 Test Loss: 3.394 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.96990966796875
Epoch: 22, Steps: 17 | Train Loss: 0.790 Vali Loss: 3.151 Vali Acc: 0.232 Test Loss: 3.151 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.661863327026367
Epoch: 23, Steps: 17 | Train Loss: 0.776 Vali Loss: 3.370 Vali Acc: 0.251 Test Loss: 3.370 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.193090200424194
Epoch: 24, Steps: 17 | Train Loss: 0.582 Vali Loss: 2.700 Vali Acc: 0.281 Test Loss: 2.700 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.525404214859009
Epoch: 25, Steps: 17 | Train Loss: 0.520 Vali Loss: 3.570 Vali Acc: 0.251 Test Loss: 3.570 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps117_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 44440324
model size : 184.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps117_str59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.642474174499512
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.492 Vali Acc: 0.259 Test Loss: 1.492 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 2.5096242427825928
Epoch: 2, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.435 Vali Acc: 0.304 Test Loss: 1.435 Test Acc: 0.304
Validation loss decreased (-0.258540 --> -0.304168).  Saving model ...
Epoch: 3 cost time: 2.235071897506714
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.510 Vali Acc: 0.251 Test Loss: 1.510 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2176473140716553
Epoch: 4, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.514 Vali Acc: 0.243 Test Loss: 1.514 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6502740383148193
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.476 Vali Acc: 0.232 Test Loss: 1.476 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5574865341186523
Epoch: 6, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.538 Vali Acc: 0.247 Test Loss: 1.538 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4812772274017334
Epoch: 7, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.534 Vali Acc: 0.240 Test Loss: 1.534 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1792452335357666
Epoch: 8, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.952 Vali Acc: 0.270 Test Loss: 1.952 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.786041736602783
Epoch: 9, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.919 Vali Acc: 0.255 Test Loss: 1.919 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6725668907165527
Epoch: 10, Steps: 17 | Train Loss: 0.981 Vali Loss: 2.266 Vali Acc: 0.278 Test Loss: 2.266 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4847145080566406
Epoch: 11, Steps: 17 | Train Loss: 1.174 Vali Loss: 2.002 Vali Acc: 0.270 Test Loss: 2.002 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8147766590118408
Epoch: 12, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.173 Vali Acc: 0.247 Test Loss: 2.173 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps117_str59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 44315908
model size : 183.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps117_str117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6584184169769287
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.422 Vali Acc: 0.297 Test Loss: 1.422 Test Acc: 0.297
Validation loss decreased (inf --> -0.296564).  Saving model ...
Epoch: 2 cost time: 2.0701122283935547
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.446 Vali Acc: 0.224 Test Loss: 1.446 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.980837345123291
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.433 Vali Acc: 0.274 Test Loss: 1.433 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.073662519454956
Epoch: 4, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.531 Vali Acc: 0.259 Test Loss: 1.531 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1851613521575928
Epoch: 5, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.432 Vali Acc: 0.251 Test Loss: 1.432 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.560332775115967
Epoch: 6, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.489 Vali Acc: 0.247 Test Loss: 1.489 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2981510162353516
Epoch: 7, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.826 Vali Acc: 0.247 Test Loss: 1.826 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9594311714172363
Epoch: 8, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.653 Vali Acc: 0.259 Test Loss: 1.653 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2122414112091064
Epoch: 9, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.805 Vali Acc: 0.251 Test Loss: 1.805 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0880186557769775
Epoch: 10, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.796 Vali Acc: 0.270 Test Loss: 1.796 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2261600494384766
Epoch: 11, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.592 Vali Acc: 0.262 Test Loss: 1.592 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps117_str117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 44251396
model size : 183.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps126_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.984245538711548
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.631 Vali Acc: 0.259 Test Loss: 1.631 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 4.004948377609253
Epoch: 2, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.522 Vali Acc: 0.278 Test Loss: 1.522 Test Acc: 0.278
Validation loss decreased (-0.258539 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 4.368244647979736
Epoch: 3, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.583 Vali Acc: 0.247 Test Loss: 1.583 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9393043518066406
Epoch: 4, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.513 Vali Acc: 0.270 Test Loss: 1.513 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.161489725112915
Epoch: 5, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.470 Vali Acc: 0.266 Test Loss: 1.470 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.139736652374268
Epoch: 6, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.997 Vali Acc: 0.255 Test Loss: 1.997 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.892843723297119
Epoch: 7, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.561 Vali Acc: 0.247 Test Loss: 1.561 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2262325286865234
Epoch: 8, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.807 Vali Acc: 0.224 Test Loss: 1.807 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.5018796920776367
Epoch: 9, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.977 Vali Acc: 0.240 Test Loss: 1.977 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.633739709854126
Epoch: 10, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.034 Vali Acc: 0.236 Test Loss: 2.034 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0183353424072266
Epoch: 11, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.494 Vali Acc: 0.293 Test Loss: 1.494 Test Acc: 0.293
Validation loss decreased (-0.277551 --> -0.292761).  Saving model ...
Epoch: 12 cost time: 3.6797266006469727
Epoch: 12, Steps: 17 | Train Loss: 1.036 Vali Loss: 2.272 Vali Acc: 0.217 Test Loss: 2.272 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1318390369415283
Epoch: 13, Steps: 17 | Train Loss: 1.029 Vali Loss: 2.083 Vali Acc: 0.266 Test Loss: 2.083 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3630728721618652
Epoch: 14, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.660 Vali Acc: 0.224 Test Loss: 2.660 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.266932249069214
Epoch: 15, Steps: 17 | Train Loss: 0.855 Vali Loss: 2.135 Vali Acc: 0.278 Test Loss: 2.135 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8724515438079834
Epoch: 16, Steps: 17 | Train Loss: 1.068 Vali Loss: 2.168 Vali Acc: 0.240 Test Loss: 2.168 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.754373788833618
Epoch: 17, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.405 Vali Acc: 0.255 Test Loss: 2.405 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.893573760986328
Epoch: 18, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.053 Vali Acc: 0.262 Test Loss: 2.053 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.158075332641602
Epoch: 19, Steps: 17 | Train Loss: 0.771 Vali Loss: 2.804 Vali Acc: 0.221 Test Loss: 2.804 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2469544410705566
Epoch: 20, Steps: 17 | Train Loss: 0.683 Vali Loss: 3.412 Vali Acc: 0.251 Test Loss: 3.412 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.2449018955230713
Epoch: 21, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.864 Vali Acc: 0.243 Test Loss: 2.864 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps126_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 44484100
model size : 184.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps126_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.7068305015563965
Epoch: 1, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.410 Vali Acc: 0.240 Test Loss: 1.410 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 2.7891581058502197
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.447 Vali Acc: 0.281 Test Loss: 1.447 Test Acc: 0.281
Validation loss decreased (-0.239530 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 2.6515555381774902
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.484 Vali Acc: 0.270 Test Loss: 1.484 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6274163722991943
Epoch: 4, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.706 Vali Acc: 0.270 Test Loss: 1.706 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2180821895599365
Epoch: 5, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.507 Vali Acc: 0.236 Test Loss: 1.507 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1977126598358154
Epoch: 6, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.620 Vali Acc: 0.232 Test Loss: 1.620 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.353498935699463
Epoch: 7, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.671 Vali Acc: 0.232 Test Loss: 1.671 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.597367763519287
Epoch: 8, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.623 Vali Acc: 0.209 Test Loss: 1.623 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.133983612060547
Epoch: 9, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.986 Vali Acc: 0.247 Test Loss: 1.986 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3296403884887695
Epoch: 10, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.897 Vali Acc: 0.259 Test Loss: 1.897 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5933454036712646
Epoch: 11, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.828 Vali Acc: 0.240 Test Loss: 1.828 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2186713218688965
Epoch: 12, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.013 Vali Acc: 0.255 Test Loss: 2.013 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps126_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44368900
model size : 183.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps126_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2065210342407227
Epoch: 1, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.442 Vali Acc: 0.259 Test Loss: 1.442 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.7629241943359375
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.616 Vali Acc: 0.232 Test Loss: 1.616 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.549879789352417
Epoch: 3, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5275566577911377
Epoch: 4, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.460 Vali Acc: 0.251 Test Loss: 1.460 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.627354383468628
Epoch: 5, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.485 Vali Acc: 0.213 Test Loss: 1.485 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.626101016998291
Epoch: 6, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.528 Vali Acc: 0.232 Test Loss: 1.528 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6509795188903809
Epoch: 7, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.567 Vali Acc: 0.213 Test Loss: 1.567 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5548701286315918
Epoch: 8, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.538 Vali Acc: 0.247 Test Loss: 1.538 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7307476997375488
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.643 Vali Acc: 0.243 Test Loss: 1.643 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5327904224395752
Epoch: 10, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.734 Vali Acc: 0.255 Test Loss: 1.734 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.757978916168213
Epoch: 11, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.572 Vali Acc: 0.266 Test Loss: 1.572 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266144).  Saving model ...
Epoch: 12 cost time: 1.8002309799194336
Epoch: 12, Steps: 17 | Train Loss: 0.962 Vali Loss: 2.085 Vali Acc: 0.262 Test Loss: 2.085 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.191208600997925
Epoch: 13, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.702 Vali Acc: 0.240 Test Loss: 1.702 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.316404104232788
Epoch: 14, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.901 Vali Acc: 0.205 Test Loss: 1.901 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.979950189590454
Epoch: 15, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.065 Vali Acc: 0.236 Test Loss: 2.065 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5805976390838623
Epoch: 16, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.037 Vali Acc: 0.232 Test Loss: 2.037 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7619273662567139
Epoch: 17, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.772 Vali Acc: 0.232 Test Loss: 1.772 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9107964038848877
Epoch: 18, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.276 Vali Acc: 0.236 Test Loss: 2.276 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0336856842041016
Epoch: 19, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.433 Vali Acc: 0.236 Test Loss: 2.433 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7022697925567627
Epoch: 20, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.943 Vali Acc: 0.232 Test Loss: 1.943 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0920615196228027
Epoch: 21, Steps: 17 | Train Loss: 0.799 Vali Loss: 2.187 Vali Acc: 0.232 Test Loss: 2.187 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps126_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 44308996
model size : 183.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps135_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.309428453445435
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 3.95825457572937
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.538 Vali Acc: 0.262 Test Loss: 1.538 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.62935471534729
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.543 Vali Acc: 0.228 Test Loss: 1.543 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5340895652770996
Epoch: 4, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.510 Vali Acc: 0.259 Test Loss: 1.510 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5622665882110596
Epoch: 5, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.674 Vali Acc: 0.251 Test Loss: 1.674 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3879282474517822
Epoch: 6, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.568 Vali Acc: 0.247 Test Loss: 1.568 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.769310712814331
Epoch: 7, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.760 Vali Acc: 0.221 Test Loss: 1.760 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.567965507507324
Epoch: 8, Steps: 17 | Train Loss: 0.986 Vali Loss: 2.093 Vali Acc: 0.228 Test Loss: 2.093 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.573652267456055
Epoch: 9, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.806 Vali Acc: 0.266 Test Loss: 1.806 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266142).  Saving model ...
Epoch: 10 cost time: 4.333716630935669
Epoch: 10, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.941 Vali Acc: 0.251 Test Loss: 1.941 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9014933109283447
Epoch: 11, Steps: 17 | Train Loss: 0.899 Vali Loss: 2.668 Vali Acc: 0.274 Test Loss: 2.668 Test Acc: 0.274
Validation loss decreased (-0.266142 --> -0.273738).  Saving model ...
Epoch: 12 cost time: 3.132770538330078
Epoch: 12, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.629 Vali Acc: 0.251 Test Loss: 2.629 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3140039443969727
Epoch: 13, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.682 Vali Acc: 0.243 Test Loss: 1.682 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4788734912872314
Epoch: 14, Steps: 17 | Train Loss: 0.958 Vali Loss: 2.662 Vali Acc: 0.266 Test Loss: 2.662 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4690191745758057
Epoch: 15, Steps: 17 | Train Loss: 0.909 Vali Loss: 2.655 Vali Acc: 0.240 Test Loss: 2.655 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.026052236557007
Epoch: 16, Steps: 17 | Train Loss: 1.051 Vali Loss: 2.103 Vali Acc: 0.228 Test Loss: 2.103 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.368291139602661
Epoch: 17, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.438 Vali Acc: 0.232 Test Loss: 2.438 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.688338041305542
Epoch: 18, Steps: 17 | Train Loss: 0.727 Vali Loss: 2.897 Vali Acc: 0.228 Test Loss: 2.897 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0440075397491455
Epoch: 19, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.744 Vali Acc: 0.232 Test Loss: 2.744 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.444493293762207
Epoch: 20, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.969 Vali Acc: 0.243 Test Loss: 2.969 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.869594097137451
Epoch: 21, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.718 Vali Acc: 0.232 Test Loss: 2.718 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps135_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44532484
model size : 184.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.768407344818115
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.466 Vali Acc: 0.266 Test Loss: 1.466 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 3.269845485687256
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.516 Vali Acc: 0.255 Test Loss: 1.516 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5541932582855225
Epoch: 3, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.481 Vali Acc: 0.316 Test Loss: 1.481 Test Acc: 0.316
Validation loss decreased (-0.266145 --> -0.315575).  Saving model ...
Epoch: 4 cost time: 2.6612167358398438
Epoch: 4, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.853 Vali Acc: 0.259 Test Loss: 1.853 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.832312822341919
Epoch: 5, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.542 Vali Acc: 0.274 Test Loss: 1.542 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2753851413726807
Epoch: 6, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.810 Vali Acc: 0.224 Test Loss: 1.810 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.709027051925659
Epoch: 7, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.722 Vali Acc: 0.247 Test Loss: 1.722 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.415504217147827
Epoch: 8, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.673 Vali Acc: 0.228 Test Loss: 1.673 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0581328868865967
Epoch: 9, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.692 Vali Acc: 0.259 Test Loss: 1.692 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2561938762664795
Epoch: 10, Steps: 17 | Train Loss: 1.052 Vali Loss: 2.206 Vali Acc: 0.236 Test Loss: 2.206 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.010193347930908
Epoch: 11, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.977 Vali Acc: 0.240 Test Loss: 1.977 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9129798412323
Epoch: 12, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.982 Vali Acc: 0.228 Test Loss: 1.982 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9163737297058105
Epoch: 13, Steps: 17 | Train Loss: 0.986 Vali Loss: 2.005 Vali Acc: 0.259 Test Loss: 2.005 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 44421892
model size : 184.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps135_str135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.179661273956299
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.429 Vali Acc: 0.274 Test Loss: 1.429 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.8298656940460205
Epoch: 2, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.522 Vali Acc: 0.278 Test Loss: 1.522 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 1.8868446350097656
Epoch: 3, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.427 Vali Acc: 0.281 Test Loss: 1.427 Test Acc: 0.281
Validation loss decreased (-0.277551 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 2.0719921588897705
Epoch: 4, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6439321041107178
Epoch: 5, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.493 Vali Acc: 0.262 Test Loss: 1.493 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5784034729003906
Epoch: 6, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.499 Vali Acc: 0.259 Test Loss: 1.499 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.126960277557373
Epoch: 7, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.602 Vali Acc: 0.236 Test Loss: 1.602 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6159720420837402
Epoch: 8, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.741 Vali Acc: 0.247 Test Loss: 1.741 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.885446548461914
Epoch: 9, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.781 Vali Acc: 0.202 Test Loss: 1.781 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.544679880142212
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.657 Vali Acc: 0.224 Test Loss: 1.657 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.267094612121582
Epoch: 11, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.677 Vali Acc: 0.240 Test Loss: 1.677 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7489137649536133
Epoch: 12, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.028 Vali Acc: 0.240 Test Loss: 2.028 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3065621852874756
Epoch: 13, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.946 Vali Acc: 0.247 Test Loss: 1.946 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps135_str135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44366596
model size : 183.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps146_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.349521160125732
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.583 Vali Acc: 0.243 Test Loss: 1.583 Test Acc: 0.243
Validation loss decreased (inf --> -0.243330).  Saving model ...
Epoch: 2 cost time: 3.3100783824920654
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.517 Vali Acc: 0.266 Test Loss: 1.517 Test Acc: 0.266
Validation loss decreased (-0.243330 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.8057277202606201
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.452 Vali Acc: 0.251 Test Loss: 1.452 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6699321269989014
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.515 Vali Acc: 0.232 Test Loss: 1.515 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8413429260253906
Epoch: 5, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.598 Vali Acc: 0.255 Test Loss: 1.598 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8323824405670166
Epoch: 6, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.641 Vali Acc: 0.251 Test Loss: 1.641 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3726799488067627
Epoch: 7, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.910 Vali Acc: 0.251 Test Loss: 1.910 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.352196216583252
Epoch: 8, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.789 Vali Acc: 0.251 Test Loss: 1.789 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0107922554016113
Epoch: 9, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.942 Vali Acc: 0.251 Test Loss: 1.942 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.730889081954956
Epoch: 10, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.747 Vali Acc: 0.224 Test Loss: 1.747 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.6520087718963623
Epoch: 11, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.849 Vali Acc: 0.247 Test Loss: 1.849 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.915310859680176
Epoch: 12, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.028 Vali Acc: 0.270 Test Loss: 2.028 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269942).  Saving model ...
Epoch: 13 cost time: 3.550490379333496
Epoch: 13, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.783 Vali Acc: 0.255 Test Loss: 1.783 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.0158257484436035
Epoch: 14, Steps: 17 | Train Loss: 0.899 Vali Loss: 2.303 Vali Acc: 0.251 Test Loss: 2.303 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.107689619064331
Epoch: 15, Steps: 17 | Train Loss: 0.746 Vali Loss: 2.888 Vali Acc: 0.247 Test Loss: 2.888 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4035487174987793
Epoch: 16, Steps: 17 | Train Loss: 0.858 Vali Loss: 2.125 Vali Acc: 0.228 Test Loss: 2.125 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.489591360092163
Epoch: 17, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.768 Vali Acc: 0.278 Test Loss: 2.768 Test Acc: 0.278
Validation loss decreased (-0.269942 --> -0.277539).  Saving model ...
Epoch: 18 cost time: 3.684849739074707
Epoch: 18, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.426 Vali Acc: 0.217 Test Loss: 2.426 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.055997371673584
Epoch: 19, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.996 Vali Acc: 0.259 Test Loss: 1.996 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7604198455810547
Epoch: 20, Steps: 17 | Train Loss: 0.792 Vali Loss: 2.604 Vali Acc: 0.243 Test Loss: 2.604 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.6571218967437744
Epoch: 21, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.643 Vali Acc: 0.198 Test Loss: 2.643 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.814478874206543
Epoch: 22, Steps: 17 | Train Loss: 0.801 Vali Loss: 2.500 Vali Acc: 0.247 Test Loss: 2.500 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.99019455909729
Epoch: 23, Steps: 17 | Train Loss: 0.687 Vali Loss: 2.653 Vali Acc: 0.221 Test Loss: 2.653 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.318243980407715
Epoch: 24, Steps: 17 | Train Loss: 0.678 Vali Loss: 2.920 Vali Acc: 0.228 Test Loss: 2.920 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4890222549438477
Epoch: 25, Steps: 17 | Train Loss: 0.780 Vali Loss: 2.305 Vali Acc: 0.255 Test Loss: 2.305 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.395148515701294
Epoch: 26, Steps: 17 | Train Loss: 0.605 Vali Loss: 3.444 Vali Acc: 0.213 Test Loss: 3.444 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.0639514923095703
Epoch: 27, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.936 Vali Acc: 0.205 Test Loss: 2.936 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps146_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 44590084
model size : 184.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps146_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.228320360183716
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.529 Vali Acc: 0.255 Test Loss: 1.529 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 2.4626576900482178
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.580 Vali Acc: 0.251 Test Loss: 1.580 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.783630847930908
Epoch: 3, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.593 Vali Acc: 0.251 Test Loss: 1.593 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0541269779205322
Epoch: 4, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.483 Vali Acc: 0.259 Test Loss: 1.483 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 2.705420732498169
Epoch: 5, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.477 Vali Acc: 0.243 Test Loss: 1.477 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.245159387588501
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.535 Vali Acc: 0.281 Test Loss: 1.535 Test Acc: 0.281
Validation loss decreased (-0.258540 --> -0.281353).  Saving model ...
Epoch: 7 cost time: 2.775926351547241
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.563 Vali Acc: 0.247 Test Loss: 1.563 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5260486602783203
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.610 Vali Acc: 0.240 Test Loss: 1.610 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5008814334869385
Epoch: 9, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.662 Vali Acc: 0.224 Test Loss: 1.662 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1173765659332275
Epoch: 10, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.702 Vali Acc: 0.228 Test Loss: 1.702 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.930548667907715
Epoch: 11, Steps: 17 | Train Loss: 0.948 Vali Loss: 2.114 Vali Acc: 0.251 Test Loss: 2.114 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8711302280426025
Epoch: 12, Steps: 17 | Train Loss: 1.070 Vali Loss: 2.049 Vali Acc: 0.236 Test Loss: 2.049 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.536478281021118
Epoch: 13, Steps: 17 | Train Loss: 0.989 Vali Loss: 2.050 Vali Acc: 0.251 Test Loss: 2.050 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.3018243312835693
Epoch: 14, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.992 Vali Acc: 0.236 Test Loss: 1.992 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.780811309814453
Epoch: 15, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.115 Vali Acc: 0.236 Test Loss: 2.115 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0947837829589844
Epoch: 16, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.386 Vali Acc: 0.243 Test Loss: 2.386 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps146_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44488708
model size : 184.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps146_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4629311561584473
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.453 Vali Acc: 0.243 Test Loss: 1.453 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.9197919368743896
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.491 Vali Acc: 0.247 Test Loss: 1.491 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247133).  Saving model ...
Epoch: 3 cost time: 1.7320630550384521
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.519 Vali Acc: 0.270 Test Loss: 1.519 Test Acc: 0.270
Validation loss decreased (-0.247133 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 1.8592779636383057
Epoch: 4, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.575 Vali Acc: 0.247 Test Loss: 1.575 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0503644943237305
Epoch: 5, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.584 Vali Acc: 0.281 Test Loss: 1.584 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281353).  Saving model ...
Epoch: 6 cost time: 1.9189801216125488
Epoch: 6, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.647 Vali Acc: 0.278 Test Loss: 1.647 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.020873785018921
Epoch: 7, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.561 Vali Acc: 0.251 Test Loss: 1.561 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7301721572875977
Epoch: 8, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.573 Vali Acc: 0.205 Test Loss: 1.573 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6075184345245361
Epoch: 9, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.778 Vali Acc: 0.209 Test Loss: 1.778 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4814085960388184
Epoch: 10, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.795 Vali Acc: 0.198 Test Loss: 1.795 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.668799638748169
Epoch: 11, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.712 Vali Acc: 0.217 Test Loss: 1.712 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3599653244018555
Epoch: 12, Steps: 17 | Train Loss: 0.986 Vali Loss: 2.326 Vali Acc: 0.243 Test Loss: 2.326 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.057811737060547
Epoch: 13, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.679 Vali Acc: 0.247 Test Loss: 1.679 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6799330711364746
Epoch: 14, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.860 Vali Acc: 0.243 Test Loss: 1.860 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7871758937835693
Epoch: 15, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.139 Vali Acc: 0.232 Test Loss: 2.139 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps146_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44438020
model size : 184.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps160_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.59466814994812
Epoch: 1, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.558 Vali Acc: 0.262 Test Loss: 1.558 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 3.6260783672332764
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.444 Vali Acc: 0.247 Test Loss: 1.444 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.169344425201416
Epoch: 3, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.533 Vali Acc: 0.266 Test Loss: 1.533 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266144).  Saving model ...
Epoch: 4 cost time: 4.201921463012695
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.503 Vali Acc: 0.259 Test Loss: 1.503 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.155224084854126
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.662 Vali Acc: 0.262 Test Loss: 1.662 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.356924772262573
Epoch: 6, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.515 Vali Acc: 0.270 Test Loss: 1.515 Test Acc: 0.270
Validation loss decreased (-0.266144 --> -0.269947).  Saving model ...
Epoch: 7 cost time: 4.046001672744751
Epoch: 7, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.579 Vali Acc: 0.266 Test Loss: 1.579 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.689702987670898
Epoch: 8, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.537 Vali Acc: 0.285 Test Loss: 1.537 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 4.00138521194458
Epoch: 9, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.746 Vali Acc: 0.228 Test Loss: 1.746 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.154494524002075
Epoch: 10, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.815 Vali Acc: 0.259 Test Loss: 1.815 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.250420093536377
Epoch: 11, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.253 Vali Acc: 0.278 Test Loss: 2.253 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6803441047668457
Epoch: 12, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.932 Vali Acc: 0.243 Test Loss: 1.932 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.7069334983825684
Epoch: 13, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.908 Vali Acc: 0.247 Test Loss: 1.908 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5437891483306885
Epoch: 14, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.760 Vali Acc: 0.247 Test Loss: 1.760 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1544313430786133
Epoch: 15, Steps: 17 | Train Loss: 0.850 Vali Loss: 2.300 Vali Acc: 0.259 Test Loss: 2.300 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.736487865447998
Epoch: 16, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.427 Vali Acc: 0.259 Test Loss: 2.427 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.526252269744873
Epoch: 17, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.374 Vali Acc: 0.247 Test Loss: 2.374 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1873457431793213
Epoch: 18, Steps: 17 | Train Loss: 0.795 Vali Loss: 2.721 Vali Acc: 0.213 Test Loss: 2.721 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps160_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 44668420
model size : 185.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.565910577774048
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.475 Vali Acc: 0.266 Test Loss: 1.475 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 3.182983636856079
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.431 Vali Acc: 0.217 Test Loss: 1.431 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0172507762908936
Epoch: 3, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.556 Vali Acc: 0.217 Test Loss: 1.556 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.518159866333008
Epoch: 4, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.520 Vali Acc: 0.251 Test Loss: 1.520 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9647347927093506
Epoch: 5, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.659 Vali Acc: 0.224 Test Loss: 1.659 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.263181686401367
Epoch: 6, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.758 Vali Acc: 0.243 Test Loss: 1.758 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1770567893981934
Epoch: 7, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.749 Vali Acc: 0.262 Test Loss: 1.749 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6756584644317627
Epoch: 8, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.714 Vali Acc: 0.293 Test Loss: 1.714 Test Acc: 0.293
Validation loss decreased (-0.266145 --> -0.292759).  Saving model ...
Epoch: 9 cost time: 2.792184829711914
Epoch: 9, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.903 Vali Acc: 0.251 Test Loss: 1.903 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1892383098602295
Epoch: 10, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.769 Vali Acc: 0.255 Test Loss: 1.769 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4156312942504883
Epoch: 11, Steps: 17 | Train Loss: 1.121 Vali Loss: 2.038 Vali Acc: 0.243 Test Loss: 2.038 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6785693168640137
Epoch: 12, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.940 Vali Acc: 0.262 Test Loss: 1.940 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0378127098083496
Epoch: 13, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.972 Vali Acc: 0.209 Test Loss: 1.972 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7652130126953125
Epoch: 14, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.833 Vali Acc: 0.217 Test Loss: 1.833 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8944625854492188
Epoch: 15, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.935 Vali Acc: 0.247 Test Loss: 1.935 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9114913940429688
Epoch: 16, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.121 Vali Acc: 0.247 Test Loss: 2.121 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.614147901535034
Epoch: 17, Steps: 17 | Train Loss: 0.929 Vali Loss: 2.336 Vali Acc: 0.266 Test Loss: 2.336 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0725719928741455
Epoch: 18, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.218 Vali Acc: 0.228 Test Loss: 2.218 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 44576260
model size : 184.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps160_str160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.037376403808594
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.415 Vali Acc: 0.262 Test Loss: 1.415 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.19543719291687
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266144).  Saving model ...
Epoch: 3 cost time: 1.9941718578338623
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.437 Vali Acc: 0.274 Test Loss: 1.437 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 2.1608476638793945
Epoch: 4, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.458 Vali Acc: 0.247 Test Loss: 1.458 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8427419662475586
Epoch: 5, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.760 Vali Acc: 0.217 Test Loss: 1.760 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6121289730072021
Epoch: 6, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.500 Vali Acc: 0.240 Test Loss: 1.500 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.238926410675049
Epoch: 7, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.707 Vali Acc: 0.255 Test Loss: 1.707 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5456616878509521
Epoch: 8, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.616 Vali Acc: 0.228 Test Loss: 1.616 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9271197319030762
Epoch: 9, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.690 Vali Acc: 0.262 Test Loss: 1.690 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6060969829559326
Epoch: 10, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.686 Vali Acc: 0.240 Test Loss: 1.686 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5867981910705566
Epoch: 11, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.774 Vali Acc: 0.255 Test Loss: 1.774 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6286816596984863
Epoch: 12, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.841 Vali Acc: 0.228 Test Loss: 1.841 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3981707096099854
Epoch: 13, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.807 Vali Acc: 0.262 Test Loss: 1.807 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps160_str160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 44530180
model size : 184.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps176_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.156717777252197
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.611 Vali Acc: 0.262 Test Loss: 1.611 Test Acc: 0.262
Validation loss decreased (inf --> -0.262341).  Saving model ...
Epoch: 2 cost time: 3.0305356979370117
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.470 Vali Acc: 0.266 Test Loss: 1.470 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 2.6952836513519287
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.693843364715576
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.728 Vali Acc: 0.251 Test Loss: 1.728 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9194464683532715
Epoch: 5, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.568 Vali Acc: 0.221 Test Loss: 1.568 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9666767120361328
Epoch: 6, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.614 Vali Acc: 0.247 Test Loss: 1.614 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.741898775100708
Epoch: 7, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.679 Vali Acc: 0.259 Test Loss: 1.679 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6221141815185547
Epoch: 8, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.876 Vali Acc: 0.232 Test Loss: 1.876 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1029977798461914
Epoch: 9, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.678 Vali Acc: 0.255 Test Loss: 1.678 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7973718643188477
Epoch: 10, Steps: 17 | Train Loss: 1.108 Vali Loss: 2.073 Vali Acc: 0.217 Test Loss: 2.073 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.719951629638672
Epoch: 11, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.673 Vali Acc: 0.243 Test Loss: 1.673 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.136930465698242
Epoch: 12, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.882 Vali Acc: 0.251 Test Loss: 1.882 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps176_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 44760580
model size : 185.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.763052701950073
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.476 Vali Acc: 0.255 Test Loss: 1.476 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.077721118927002
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.408 Vali Acc: 0.240 Test Loss: 1.408 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3094592094421387
Epoch: 3, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.542 Vali Acc: 0.270 Test Loss: 1.542 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 2.271010637283325
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.649 Vali Acc: 0.251 Test Loss: 1.649 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.758251667022705
Epoch: 5, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.536 Vali Acc: 0.247 Test Loss: 1.536 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4496960639953613
Epoch: 6, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.554 Vali Acc: 0.259 Test Loss: 1.554 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.844820499420166
Epoch: 7, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.609 Vali Acc: 0.232 Test Loss: 1.609 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0384302139282227
Epoch: 8, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.800 Vali Acc: 0.224 Test Loss: 1.800 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.76942777633667
Epoch: 9, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.699 Vali Acc: 0.255 Test Loss: 1.699 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.319286346435547
Epoch: 10, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.865 Vali Acc: 0.240 Test Loss: 1.865 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2295217514038086
Epoch: 11, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.674 Vali Acc: 0.251 Test Loss: 1.674 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9239795207977295
Epoch: 12, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.923 Vali Acc: 0.270 Test Loss: 1.923 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8243467807769775
Epoch: 13, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.743 Vali Acc: 0.251 Test Loss: 1.743 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 44677636
model size : 185.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps176_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.516844272613525
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.431 Vali Acc: 0.240 Test Loss: 1.431 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 2.269334316253662
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.419 Vali Acc: 0.255 Test Loss: 1.419 Test Acc: 0.255
Validation loss decreased (-0.239529 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 1.939255714416504
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.523 Vali Acc: 0.243 Test Loss: 1.523 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.814962387084961
Epoch: 4, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.503 Vali Acc: 0.255 Test Loss: 1.503 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1228687763214111
Epoch: 5, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.689 Vali Acc: 0.255 Test Loss: 1.689 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3937764167785645
Epoch: 6, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.652 Vali Acc: 0.285 Test Loss: 1.652 Test Acc: 0.285
Validation loss decreased (-0.254739 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 1.6376779079437256
Epoch: 7, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.547 Vali Acc: 0.251 Test Loss: 1.547 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5787646770477295
Epoch: 8, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.593 Vali Acc: 0.255 Test Loss: 1.593 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5891506671905518
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.831 Vali Acc: 0.278 Test Loss: 1.831 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8124973773956299
Epoch: 10, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.647 Vali Acc: 0.251 Test Loss: 1.647 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.609602689743042
Epoch: 11, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.714 Vali Acc: 0.251 Test Loss: 1.714 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6293632984161377
Epoch: 12, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.854 Vali Acc: 0.228 Test Loss: 1.854 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7589137554168701
Epoch: 13, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.706 Vali Acc: 0.243 Test Loss: 1.706 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.884781837463379
Epoch: 14, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.933 Vali Acc: 0.243 Test Loss: 1.933 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6070713996887207
Epoch: 15, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.730 Vali Acc: 0.251 Test Loss: 1.730 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4696934223175049
Epoch: 16, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.909 Vali Acc: 0.232 Test Loss: 1.909 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps176_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 44636164
model size : 184.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps195_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.254958629608154
Epoch: 1, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.419 Vali Acc: 0.281 Test Loss: 1.419 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 2.681342601776123
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.494 Vali Acc: 0.243 Test Loss: 1.494 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3995373249053955
Epoch: 3, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.423 Vali Acc: 0.221 Test Loss: 1.423 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6916089057922363
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.531 Vali Acc: 0.262 Test Loss: 1.531 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8799188137054443
Epoch: 5, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.473 Vali Acc: 0.247 Test Loss: 1.473 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7357308864593506
Epoch: 6, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.496 Vali Acc: 0.236 Test Loss: 1.496 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8236501216888428
Epoch: 7, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.620 Vali Acc: 0.281 Test Loss: 1.620 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0949623584747314
Epoch: 8, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.772 Vali Acc: 0.259 Test Loss: 1.772 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.857818841934204
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.950 Vali Acc: 0.240 Test Loss: 1.950 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.0066397190093994
Epoch: 10, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.724 Vali Acc: 0.236 Test Loss: 1.724 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.96089506149292
Epoch: 11, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.689 Vali Acc: 0.266 Test Loss: 1.689 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps195_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44873476
model size : 185.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps195_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.930586814880371
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.452 Vali Acc: 0.251 Test Loss: 1.452 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.004451274871826
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.461 Vali Acc: 0.247 Test Loss: 1.461 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.843966245651245
Epoch: 3, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.497 Vali Acc: 0.270 Test Loss: 1.497 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 2.8629918098449707
Epoch: 4, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.422 Vali Acc: 0.281 Test Loss: 1.422 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281355).  Saving model ...
Epoch: 5 cost time: 2.8888590335845947
Epoch: 5, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.479 Vali Acc: 0.262 Test Loss: 1.479 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0927841663360596
Epoch: 6, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.517 Vali Acc: 0.262 Test Loss: 1.517 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.604288101196289
Epoch: 7, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.512 Vali Acc: 0.274 Test Loss: 1.512 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9375991821289062
Epoch: 8, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.511 Vali Acc: 0.243 Test Loss: 1.511 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1104319095611572
Epoch: 9, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.865 Vali Acc: 0.228 Test Loss: 1.865 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4524102210998535
Epoch: 10, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.613 Vali Acc: 0.274 Test Loss: 1.613 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7430405616760254
Epoch: 11, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.748 Vali Acc: 0.270 Test Loss: 1.748 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9367105960845947
Epoch: 12, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.697 Vali Acc: 0.255 Test Loss: 1.697 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.4505536556243896
Epoch: 13, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.616 Vali Acc: 0.217 Test Loss: 1.616 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.961690664291382
Epoch: 14, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.768 Vali Acc: 0.232 Test Loss: 1.768 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps195_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44799748
model size : 185.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps195_str195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7846052646636963
Epoch: 1, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.436 Vali Acc: 0.251 Test Loss: 1.436 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.7126898765563965
Epoch: 2, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.446 Vali Acc: 0.243 Test Loss: 1.446 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8222448825836182
Epoch: 3, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.984161376953125
Epoch: 4, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.471 Vali Acc: 0.243 Test Loss: 1.471 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8180923461914062
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.478 Vali Acc: 0.266 Test Loss: 1.478 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 1.8223059177398682
Epoch: 6, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.498 Vali Acc: 0.221 Test Loss: 1.498 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7595038414001465
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.523 Vali Acc: 0.243 Test Loss: 1.523 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.822082281112671
Epoch: 8, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.723 Vali Acc: 0.247 Test Loss: 1.723 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8652896881103516
Epoch: 9, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.599 Vali Acc: 0.262 Test Loss: 1.599 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8017914295196533
Epoch: 10, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.639 Vali Acc: 0.236 Test Loss: 1.639 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7642111778259277
Epoch: 11, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.713 Vali Acc: 0.251 Test Loss: 1.713 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7831952571868896
Epoch: 12, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.798 Vali Acc: 0.255 Test Loss: 1.798 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8561923503875732
Epoch: 13, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.700 Vali Acc: 0.281 Test Loss: 1.700 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281352).  Saving model ...
Epoch: 14 cost time: 2.0415096282958984
Epoch: 14, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.179 Vali Acc: 0.240 Test Loss: 2.179 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9294359683990479
Epoch: 15, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.907 Vali Acc: 0.236 Test Loss: 1.907 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7682974338531494
Epoch: 16, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.857 Vali Acc: 0.224 Test Loss: 1.857 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6663997173309326
Epoch: 17, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.922 Vali Acc: 0.232 Test Loss: 1.922 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.027449607849121
Epoch: 18, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.688 Vali Acc: 0.247 Test Loss: 1.688 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8710827827453613
Epoch: 19, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.211 Vali Acc: 0.243 Test Loss: 2.211 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8880698680877686
Epoch: 20, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.973 Vali Acc: 0.240 Test Loss: 1.973 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9811210632324219
Epoch: 21, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.006 Vali Acc: 0.228 Test Loss: 2.006 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.727346420288086
Epoch: 22, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.035 Vali Acc: 0.228 Test Loss: 2.035 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4369256496429443
Epoch: 23, Steps: 17 | Train Loss: 0.770 Vali Loss: 2.311 Vali Acc: 0.247 Test Loss: 2.311 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps195_str195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 44762884
model size : 185.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps219_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.943556308746338
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.414 Vali Acc: 0.247 Test Loss: 1.414 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 2.8368782997131348
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.473 Vali Acc: 0.270 Test Loss: 1.473 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 3.292592763900757
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.508 Vali Acc: 0.259 Test Loss: 1.508 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.618344306945801
Epoch: 4, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.524 Vali Acc: 0.293 Test Loss: 1.524 Test Acc: 0.293
Validation loss decreased (-0.269947 --> -0.292760).  Saving model ...
Epoch: 5 cost time: 2.186504602432251
Epoch: 5, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.611 Vali Acc: 0.266 Test Loss: 1.611 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2395808696746826
Epoch: 6, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.815 Vali Acc: 0.266 Test Loss: 1.815 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.07818341255188
Epoch: 7, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.768 Vali Acc: 0.255 Test Loss: 1.768 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2580292224884033
Epoch: 8, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.706 Vali Acc: 0.240 Test Loss: 1.706 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7027299404144287
Epoch: 9, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.704 Vali Acc: 0.251 Test Loss: 1.704 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.561699628829956
Epoch: 10, Steps: 17 | Train Loss: 1.054 Vali Loss: 2.146 Vali Acc: 0.255 Test Loss: 2.146 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5981621742248535
Epoch: 11, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.812 Vali Acc: 0.281 Test Loss: 1.812 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.337116241455078
Epoch: 12, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.996 Vali Acc: 0.221 Test Loss: 1.996 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1864230632781982
Epoch: 13, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.379 Vali Acc: 0.274 Test Loss: 2.379 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8402936458587646
Epoch: 14, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.769 Vali Acc: 0.224 Test Loss: 1.769 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps219_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 45020932
model size : 186.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps219_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.48389744758606
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.423 Vali Acc: 0.240 Test Loss: 1.423 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.9668080806732178
Epoch: 2, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
Validation loss decreased (-0.239529 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 1.608473300933838
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.053231716156006
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.465 Vali Acc: 0.285 Test Loss: 1.465 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285156).  Saving model ...
Epoch: 5 cost time: 2.181600570678711
Epoch: 5, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.486 Vali Acc: 0.281 Test Loss: 1.486 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9888126850128174
Epoch: 6, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.593 Vali Acc: 0.266 Test Loss: 1.593 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1938135623931885
Epoch: 7, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7015249729156494
Epoch: 8, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.597 Vali Acc: 0.228 Test Loss: 1.597 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.997549057006836
Epoch: 9, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.648 Vali Acc: 0.236 Test Loss: 1.648 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.945326805114746
Epoch: 10, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.636 Vali Acc: 0.251 Test Loss: 1.636 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0608038902282715
Epoch: 11, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.925 Vali Acc: 0.232 Test Loss: 1.925 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5343022346496582
Epoch: 12, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.800 Vali Acc: 0.224 Test Loss: 1.800 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3878424167633057
Epoch: 13, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.731 Vali Acc: 0.251 Test Loss: 1.731 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.479853868484497
Epoch: 14, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.946 Vali Acc: 0.240 Test Loss: 1.946 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps219_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 44956420
model size : 186.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps219_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2716126441955566
Epoch: 1, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.442 Vali Acc: 0.304 Test Loss: 1.442 Test Acc: 0.304
Validation loss decreased (inf --> -0.304168).  Saving model ...
Epoch: 2 cost time: 1.3883490562438965
Epoch: 2, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.457 Vali Acc: 0.240 Test Loss: 1.457 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4008064270019531
Epoch: 3, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.443 Vali Acc: 0.251 Test Loss: 1.443 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3978896141052246
Epoch: 4, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.445 Vali Acc: 0.232 Test Loss: 1.445 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8726515769958496
Epoch: 5, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.616 Vali Acc: 0.247 Test Loss: 1.616 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7593839168548584
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.549 Vali Acc: 0.243 Test Loss: 1.549 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3731403350830078
Epoch: 7, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.703 Vali Acc: 0.236 Test Loss: 1.703 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3573365211486816
Epoch: 8, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.683 Vali Acc: 0.266 Test Loss: 1.683 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4590022563934326
Epoch: 9, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.574 Vali Acc: 0.251 Test Loss: 1.574 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4808895587921143
Epoch: 10, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.713 Vali Acc: 0.251 Test Loss: 1.713 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5008881092071533
Epoch: 11, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.707 Vali Acc: 0.236 Test Loss: 1.707 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps219_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 44924164
model size : 186.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps251_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.284236192703247
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.2000021934509277
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.436 Vali Acc: 0.232 Test Loss: 1.436 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0318334102630615
Epoch: 3, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.611 Vali Acc: 0.259 Test Loss: 1.611 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258539).  Saving model ...
Epoch: 4 cost time: 2.3446359634399414
Epoch: 4, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.581 Vali Acc: 0.240 Test Loss: 1.581 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9882168769836426
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.493 Vali Acc: 0.259 Test Loss: 1.493 Test Acc: 0.259
Validation loss decreased (-0.258539 --> -0.258540).  Saving model ...
Epoch: 6 cost time: 4.1257851123809814
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.603 Vali Acc: 0.251 Test Loss: 1.603 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6023776531219482
Epoch: 7, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.481 Vali Acc: 0.255 Test Loss: 1.481 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8781023025512695
Epoch: 8, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.702 Vali Acc: 0.278 Test Loss: 1.702 Test Acc: 0.278
Validation loss decreased (-0.258540 --> -0.277550).  Saving model ...
Epoch: 9 cost time: 2.258263111114502
Epoch: 9, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.624 Vali Acc: 0.202 Test Loss: 1.624 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6621296405792236
Epoch: 10, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.869 Vali Acc: 0.247 Test Loss: 1.869 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7000808715820312
Epoch: 11, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.747 Vali Acc: 0.236 Test Loss: 1.747 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.835080862045288
Epoch: 12, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.857 Vali Acc: 0.240 Test Loss: 1.857 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4216549396514893
Epoch: 13, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.696 Vali Acc: 0.217 Test Loss: 1.696 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1990511417388916
Epoch: 14, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.934 Vali Acc: 0.224 Test Loss: 1.934 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5915489196777344
Epoch: 15, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.074 Vali Acc: 0.236 Test Loss: 2.074 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.829582452774048
Epoch: 16, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.663 Vali Acc: 0.251 Test Loss: 2.663 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.280926465988159
Epoch: 17, Steps: 17 | Train Loss: 0.928 Vali Loss: 2.052 Vali Acc: 0.228 Test Loss: 2.052 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8543214797973633
Epoch: 18, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.243 Vali Acc: 0.228 Test Loss: 2.243 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps251_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 45223684
model size : 187.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps251_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9793035984039307
Epoch: 1, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.481 Vali Acc: 0.259 Test Loss: 1.481 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 2.1662380695343018
Epoch: 2, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.438 Vali Acc: 0.278 Test Loss: 1.438 Test Acc: 0.278
Validation loss decreased (-0.258540 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 2.3378262519836426
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.433 Vali Acc: 0.243 Test Loss: 1.433 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4983487129211426
Epoch: 4, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.602 Vali Acc: 0.243 Test Loss: 1.602 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.430760383605957
Epoch: 5, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.867 Vali Acc: 0.247 Test Loss: 1.867 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1709749698638916
Epoch: 6, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.642 Vali Acc: 0.247 Test Loss: 1.642 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7468457221984863
Epoch: 7, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.791 Vali Acc: 0.262 Test Loss: 1.791 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4401051998138428
Epoch: 8, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.557 Vali Acc: 0.243 Test Loss: 1.557 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6249310970306396
Epoch: 9, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.795 Vali Acc: 0.251 Test Loss: 1.795 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8002448081970215
Epoch: 10, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.649 Vali Acc: 0.217 Test Loss: 1.649 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1526901721954346
Epoch: 11, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.805 Vali Acc: 0.255 Test Loss: 1.805 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0272371768951416
Epoch: 12, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.046 Vali Acc: 0.274 Test Loss: 2.046 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps251_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 45168388
model size : 186.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps251_str251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.048416614532471
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.410 Vali Acc: 0.266 Test Loss: 1.410 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.7949378490447998
Epoch: 2, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.446 Vali Acc: 0.228 Test Loss: 1.446 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5421040058135986
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.507 Vali Acc: 0.240 Test Loss: 1.507 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4931554794311523
Epoch: 4, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6410975456237793
Epoch: 5, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.638 Vali Acc: 0.236 Test Loss: 1.638 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5007057189941406
Epoch: 6, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.555 Vali Acc: 0.251 Test Loss: 1.555 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5096287727355957
Epoch: 7, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.553 Vali Acc: 0.262 Test Loss: 1.553 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.225762128829956
Epoch: 8, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.582 Vali Acc: 0.232 Test Loss: 1.582 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6432554721832275
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.774 Vali Acc: 0.217 Test Loss: 1.774 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6617870330810547
Epoch: 10, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.565 Vali Acc: 0.251 Test Loss: 1.565 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3905625343322754
Epoch: 11, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.616 Vali Acc: 0.213 Test Loss: 1.616 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps251_str251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 45140740
model size : 186.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps292_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.657449722290039
Epoch: 1, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.451 Vali Acc: 0.285 Test Loss: 1.451 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 3.2787978649139404
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.428 Vali Acc: 0.232 Test Loss: 1.428 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.788275718688965
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.457 Vali Acc: 0.270 Test Loss: 1.457 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.354871988296509
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.479 Vali Acc: 0.232 Test Loss: 1.479 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.606889009475708
Epoch: 5, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.576 Vali Acc: 0.251 Test Loss: 1.576 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.356231212615967
Epoch: 6, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.651 Vali Acc: 0.224 Test Loss: 1.651 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.136643886566162
Epoch: 7, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.596 Vali Acc: 0.228 Test Loss: 1.596 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.496752977371216
Epoch: 8, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.746 Vali Acc: 0.243 Test Loss: 1.746 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5181655883789062
Epoch: 9, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.986 Vali Acc: 0.228 Test Loss: 1.986 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.0246853828430176
Epoch: 10, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.643 Vali Acc: 0.236 Test Loss: 1.643 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1449196338653564
Epoch: 11, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.921 Vali Acc: 0.232 Test Loss: 1.921 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps292_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 45488644
model size : 188.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps292_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.9314751625061035
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.430 Vali Acc: 0.259 Test Loss: 1.430 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.1268067359924316
Epoch: 2, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.464 Vali Acc: 0.255 Test Loss: 1.464 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3551177978515625
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.518 Vali Acc: 0.221 Test Loss: 1.518 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.386624336242676
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.511 Vali Acc: 0.236 Test Loss: 1.511 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.214872360229492
Epoch: 5, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.498 Vali Acc: 0.251 Test Loss: 1.498 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0988221168518066
Epoch: 6, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.645 Vali Acc: 0.205 Test Loss: 1.645 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.068617582321167
Epoch: 7, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.813 Vali Acc: 0.224 Test Loss: 1.813 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.125244617462158
Epoch: 8, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.828 Vali Acc: 0.228 Test Loss: 1.828 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4789280891418457
Epoch: 9, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.677 Vali Acc: 0.221 Test Loss: 1.677 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.350107431411743
Epoch: 10, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.655 Vali Acc: 0.228 Test Loss: 1.655 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0791540145874023
Epoch: 11, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.558 Vali Acc: 0.236 Test Loss: 1.558 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps292_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 45442564
model size : 188.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps292_str292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.598567247390747
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.490 Vali Acc: 0.224 Test Loss: 1.490 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 1.673640251159668
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
Validation loss decreased (-0.224320 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.562713384628296
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.407 Vali Acc: 0.247 Test Loss: 1.407 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7274410724639893
Epoch: 4, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6927523612976074
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.513 Vali Acc: 0.240 Test Loss: 1.513 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6507859230041504
Epoch: 6, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.638 Vali Acc: 0.243 Test Loss: 1.638 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.544708490371704
Epoch: 7, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.490 Vali Acc: 0.224 Test Loss: 1.490 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4137701988220215
Epoch: 8, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4242959022521973
Epoch: 9, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.605 Vali Acc: 0.297 Test Loss: 1.605 Test Acc: 0.297
Validation loss decreased (-0.254738 --> -0.296562).  Saving model ...
Epoch: 10 cost time: 1.3684208393096924
Epoch: 10, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.797 Vali Acc: 0.224 Test Loss: 1.797 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7141077518463135
Epoch: 11, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.719 Vali Acc: 0.251 Test Loss: 1.719 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5377733707427979
Epoch: 12, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.880 Vali Acc: 0.266 Test Loss: 1.880 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.407625436782837
Epoch: 13, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.878 Vali Acc: 0.247 Test Loss: 1.878 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7044970989227295
Epoch: 14, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.610 Vali Acc: 0.236 Test Loss: 1.610 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8330886363983154
Epoch: 15, Steps: 17 | Train Loss: 0.969 Vali Loss: 2.028 Vali Acc: 0.247 Test Loss: 2.028 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5541298389434814
Epoch: 16, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.693 Vali Acc: 0.228 Test Loss: 1.693 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.327836036682129
Epoch: 17, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.930 Vali Acc: 0.217 Test Loss: 1.930 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.452240228652954
Epoch: 18, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.914 Vali Acc: 0.243 Test Loss: 1.914 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.036872148513794
Epoch: 19, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.885 Vali Acc: 0.224 Test Loss: 1.885 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps292_str292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 45419524
model size : 187.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps351_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.469997406005859
Epoch: 1, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.456 Vali Acc: 0.259 Test Loss: 1.456 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.3590197563171387
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.495 Vali Acc: 0.259 Test Loss: 1.495 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1224141120910645
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.565 Vali Acc: 0.240 Test Loss: 1.565 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.271827459335327
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.426 Vali Acc: 0.247 Test Loss: 1.426 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.702336311340332
Epoch: 5, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.477 Vali Acc: 0.266 Test Loss: 1.477 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 6 cost time: 3.740403413772583
Epoch: 6, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.469 Vali Acc: 0.259 Test Loss: 1.469 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.661953926086426
Epoch: 7, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.691 Vali Acc: 0.255 Test Loss: 1.691 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.691988468170166
Epoch: 8, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.587 Vali Acc: 0.259 Test Loss: 1.587 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.142075777053833
Epoch: 9, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.687 Vali Acc: 0.274 Test Loss: 1.687 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273747).  Saving model ...
Epoch: 10 cost time: 2.814124345779419
Epoch: 10, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.743 Vali Acc: 0.247 Test Loss: 1.743 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3141369819641113
Epoch: 11, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.714 Vali Acc: 0.205 Test Loss: 1.714 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6971266269683838
Epoch: 12, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.877 Vali Acc: 0.202 Test Loss: 1.877 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5829429626464844
Epoch: 13, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.823 Vali Acc: 0.240 Test Loss: 1.823 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.019850254058838
Epoch: 14, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.831 Vali Acc: 0.240 Test Loss: 1.831 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.758622407913208
Epoch: 15, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.031 Vali Acc: 0.243 Test Loss: 2.031 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8082926273345947
Epoch: 16, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.989 Vali Acc: 0.262 Test Loss: 1.989 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0927674770355225
Epoch: 17, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.942 Vali Acc: 0.240 Test Loss: 1.942 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3068792819976807
Epoch: 18, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.964 Vali Acc: 0.228 Test Loss: 1.964 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.908174753189087
Epoch: 19, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.047 Vali Acc: 0.251 Test Loss: 2.047 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps351_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 45878020
model size : 189.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.266362905502319
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.421 Vali Acc: 0.243 Test Loss: 1.421 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.6431949138641357
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.405 Vali Acc: 0.281 Test Loss: 1.405 Test Acc: 0.281
Validation loss decreased (-0.243332 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.384406328201294
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.428 Vali Acc: 0.278 Test Loss: 1.428 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.852301836013794
Epoch: 4, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.460 Vali Acc: 0.251 Test Loss: 1.460 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.117420196533203
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7307133674621582
Epoch: 6, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.527 Vali Acc: 0.236 Test Loss: 1.527 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5656323432922363
Epoch: 7, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.506 Vali Acc: 0.251 Test Loss: 1.506 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.689751386642456
Epoch: 8, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.675 Vali Acc: 0.232 Test Loss: 1.675 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.488663911819458
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.877528190612793
Epoch: 10, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.744 Vali Acc: 0.251 Test Loss: 1.744 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7606651782989502
Epoch: 11, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.962 Vali Acc: 0.236 Test Loss: 1.962 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.786910057067871
Epoch: 12, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.787 Vali Acc: 0.247 Test Loss: 1.787 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 45841156
model size : 189.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps351_str351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.700545310974121
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.409 Vali Acc: 0.278 Test Loss: 1.409 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.681128740310669
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.457 Vali Acc: 0.259 Test Loss: 1.457 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3358466625213623
Epoch: 3, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.541 Vali Acc: 0.281 Test Loss: 1.541 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281353).  Saving model ...
Epoch: 4 cost time: 1.3181817531585693
Epoch: 4, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.481 Vali Acc: 0.281 Test Loss: 1.481 Test Acc: 0.281
Validation loss decreased (-0.281353 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 2.0977895259857178
Epoch: 5, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.448 Vali Acc: 0.228 Test Loss: 1.448 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.713505506515503
Epoch: 6, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.619 Vali Acc: 0.259 Test Loss: 1.619 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6000051498413086
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.560 Vali Acc: 0.240 Test Loss: 1.560 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2612125873565674
Epoch: 8, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.466 Vali Acc: 0.259 Test Loss: 1.466 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6954457759857178
Epoch: 9, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.539 Vali Acc: 0.255 Test Loss: 1.539 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6090326309204102
Epoch: 10, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.631 Vali Acc: 0.224 Test Loss: 1.631 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.242253541946411
Epoch: 11, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.519 Vali Acc: 0.251 Test Loss: 1.519 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6738049983978271
Epoch: 12, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.686 Vali Acc: 0.236 Test Loss: 1.686 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7443840503692627
Epoch: 13, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.677 Vali Acc: 0.259 Test Loss: 1.677 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4472556114196777
Epoch: 14, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.749 Vali Acc: 0.243 Test Loss: 1.749 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el6_dm768_df768_ps351_str351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 45822724
model size : 189.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.388755798339844
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.573 Vali Acc: 0.240 Test Loss: 1.573 Test Acc: 0.240
Validation loss decreased (inf --> -0.239528).  Saving model ...
Epoch: 2 cost time: 3.6886847019195557
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.643 Vali Acc: 0.251 Test Loss: 1.643 Test Acc: 0.251
Validation loss decreased (-0.239528 --> -0.250934).  Saving model ...
Epoch: 3 cost time: 3.5602779388427734
Epoch: 3, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.557 Vali Acc: 0.281 Test Loss: 1.557 Test Acc: 0.281
Validation loss decreased (-0.250934 --> -0.281353).  Saving model ...
Epoch: 4 cost time: 3.9762368202209473
Epoch: 4, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.550 Vali Acc: 0.255 Test Loss: 1.550 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.185781002044678
Epoch: 5, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.956 Vali Acc: 0.255 Test Loss: 1.956 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.057828187942505
Epoch: 6, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.645 Vali Acc: 0.262 Test Loss: 1.645 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7637717723846436
Epoch: 7, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.788 Vali Acc: 0.236 Test Loss: 1.788 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5136661529541016
Epoch: 8, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.996 Vali Acc: 0.251 Test Loss: 1.996 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.141124725341797
Epoch: 9, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.961 Vali Acc: 0.259 Test Loss: 1.961 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.242851734161377
Epoch: 10, Steps: 17 | Train Loss: 0.954 Vali Loss: 2.159 Vali Acc: 0.243 Test Loss: 2.159 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.5413849353790283
Epoch: 11, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.014 Vali Acc: 0.270 Test Loss: 2.014 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.380149841308594
Epoch: 12, Steps: 17 | Train Loss: 0.850 Vali Loss: 2.832 Vali Acc: 0.251 Test Loss: 2.832 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.5734236240386963
Epoch: 13, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.937 Vali Acc: 0.236 Test Loss: 2.937 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 37214212
model size : 156.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.185144662857056
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.432 Vali Acc: 0.255 Test Loss: 1.432 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 2.7453298568725586
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.496 Vali Acc: 0.262 Test Loss: 1.496 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 2.3460636138916016
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.599 Vali Acc: 0.266 Test Loss: 1.599 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266144).  Saving model ...
Epoch: 4 cost time: 3.134097099304199
Epoch: 4, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.536 Vali Acc: 0.247 Test Loss: 1.536 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4816017150878906
Epoch: 5, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.465 Vali Acc: 0.232 Test Loss: 1.465 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6504037380218506
Epoch: 6, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.572 Vali Acc: 0.243 Test Loss: 1.572 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6250112056732178
Epoch: 7, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.066 Vali Acc: 0.243 Test Loss: 2.066 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6694369316101074
Epoch: 8, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.799 Vali Acc: 0.224 Test Loss: 1.799 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.323280096054077
Epoch: 9, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.542 Vali Acc: 0.259 Test Loss: 1.542 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8820102214813232
Epoch: 10, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.960 Vali Acc: 0.224 Test Loss: 1.960 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.682100772857666
Epoch: 11, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.899 Vali Acc: 0.274 Test Loss: 1.899 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273745).  Saving model ...
Epoch: 12 cost time: 2.86352801322937
Epoch: 12, Steps: 17 | Train Loss: 0.959 Vali Loss: 2.253 Vali Acc: 0.251 Test Loss: 2.253 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8489484786987305
Epoch: 13, Steps: 17 | Train Loss: 0.920 Vali Loss: 2.041 Vali Acc: 0.232 Test Loss: 2.041 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.310410737991333
Epoch: 14, Steps: 17 | Train Loss: 0.777 Vali Loss: 2.609 Vali Acc: 0.209 Test Loss: 2.609 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1353206634521484
Epoch: 15, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.948 Vali Acc: 0.213 Test Loss: 1.948 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9885599613189697
Epoch: 16, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.912 Vali Acc: 0.243 Test Loss: 2.912 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6326394081115723
Epoch: 17, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.716 Vali Acc: 0.232 Test Loss: 2.716 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4638490676879883
Epoch: 18, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.698 Vali Acc: 0.243 Test Loss: 2.698 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9791109561920166
Epoch: 19, Steps: 17 | Train Loss: 0.802 Vali Loss: 3.061 Vali Acc: 0.205 Test Loss: 3.061 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.317798376083374
Epoch: 20, Steps: 17 | Train Loss: 0.743 Vali Loss: 2.866 Vali Acc: 0.251 Test Loss: 2.866 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2846121788024902
Epoch: 21, Steps: 17 | Train Loss: 0.581 Vali Loss: 3.854 Vali Acc: 0.217 Test Loss: 3.854 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 36997636
model size : 155.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.4556169509887695
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.477 Vali Acc: 0.228 Test Loss: 1.477 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 2.300654888153076
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.450 Vali Acc: 0.232 Test Loss: 1.450 Test Acc: 0.232
Validation loss decreased (-0.228122 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 2.5682668685913086
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.434 Vali Acc: 0.217 Test Loss: 1.434 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5485482215881348
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.471 Vali Acc: 0.266 Test Loss: 1.471 Test Acc: 0.266
Validation loss decreased (-0.231925 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 1.986375093460083
Epoch: 5, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.507 Vali Acc: 0.247 Test Loss: 1.507 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6135478019714355
Epoch: 6, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.537 Vali Acc: 0.255 Test Loss: 1.537 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.447331666946411
Epoch: 7, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.611 Vali Acc: 0.243 Test Loss: 1.611 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.201808452606201
Epoch: 8, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.585 Vali Acc: 0.243 Test Loss: 1.585 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2069644927978516
Epoch: 9, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.767 Vali Acc: 0.255 Test Loss: 1.767 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.766289234161377
Epoch: 10, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.694 Vali Acc: 0.217 Test Loss: 1.694 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.992182731628418
Epoch: 11, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.976 Vali Acc: 0.232 Test Loss: 1.976 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5049779415130615
Epoch: 12, Steps: 17 | Train Loss: 1.037 Vali Loss: 2.047 Vali Acc: 0.274 Test Loss: 2.047 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273744).  Saving model ...
Epoch: 13 cost time: 1.6877110004425049
Epoch: 13, Steps: 17 | Train Loss: 0.953 Vali Loss: 2.070 Vali Acc: 0.243 Test Loss: 2.070 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9844796657562256
Epoch: 14, Steps: 17 | Train Loss: 1.031 Vali Loss: 2.351 Vali Acc: 0.243 Test Loss: 2.351 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8541195392608643
Epoch: 15, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.230 Vali Acc: 0.232 Test Loss: 2.230 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9846317768096924
Epoch: 16, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.326 Vali Acc: 0.259 Test Loss: 2.326 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1592164039611816
Epoch: 17, Steps: 17 | Train Loss: 0.867 Vali Loss: 2.560 Vali Acc: 0.240 Test Loss: 2.560 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6950562000274658
Epoch: 18, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.364 Vali Acc: 0.262 Test Loss: 2.364 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.738607406616211
Epoch: 19, Steps: 17 | Train Loss: 0.720 Vali Loss: 2.309 Vali Acc: 0.255 Test Loss: 2.309 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5981378555297852
Epoch: 20, Steps: 17 | Train Loss: 0.744 Vali Loss: 2.287 Vali Acc: 0.236 Test Loss: 2.287 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7060298919677734
Epoch: 21, Steps: 17 | Train Loss: 0.668 Vali Loss: 2.677 Vali Acc: 0.251 Test Loss: 2.677 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8675258159637451
Epoch: 22, Steps: 17 | Train Loss: 0.798 Vali Loss: 2.331 Vali Acc: 0.232 Test Loss: 2.331 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 36891652
model size : 155.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps73_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.2435832023620605
Epoch: 1, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.597 Vali Acc: 0.232 Test Loss: 1.597 Test Acc: 0.232
Validation loss decreased (inf --> -0.231923).  Saving model ...
Epoch: 2 cost time: 2.6492884159088135
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.508 Vali Acc: 0.278 Test Loss: 1.508 Test Acc: 0.278
Validation loss decreased (-0.231923 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 3.253655195236206
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.556 Vali Acc: 0.266 Test Loss: 1.556 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0444231033325195
Epoch: 4, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5466389656066895
Epoch: 5, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.829 Vali Acc: 0.240 Test Loss: 1.829 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9061896800994873
Epoch: 6, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.700 Vali Acc: 0.221 Test Loss: 1.700 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2306466102600098
Epoch: 7, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.834 Vali Acc: 0.236 Test Loss: 1.834 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9312660694122314
Epoch: 8, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.778 Vali Acc: 0.251 Test Loss: 1.778 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.933096170425415
Epoch: 9, Steps: 17 | Train Loss: 1.063 Vali Loss: 2.269 Vali Acc: 0.262 Test Loss: 2.269 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6617064476013184
Epoch: 10, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.539 Vali Acc: 0.278 Test Loss: 2.539 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.277707099914551
Epoch: 11, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.985 Vali Acc: 0.247 Test Loss: 1.985 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.167078495025635
Epoch: 12, Steps: 17 | Train Loss: 0.902 Vali Loss: 2.518 Vali Acc: 0.224 Test Loss: 2.518 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps73_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 37204996
model size : 156.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps73_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.972617864608765
Epoch: 1, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.426 Vali Acc: 0.247 Test Loss: 1.426 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 2.6684372425079346
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.535 Vali Acc: 0.266 Test Loss: 1.535 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266144).  Saving model ...
Epoch: 3 cost time: 2.104886770248413
Epoch: 3, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.477 Vali Acc: 0.274 Test Loss: 1.477 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 2.6899778842926025
Epoch: 4, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.501 Vali Acc: 0.278 Test Loss: 1.501 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 2.7059483528137207
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.577 Vali Acc: 0.255 Test Loss: 1.577 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.896106719970703
Epoch: 6, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.816 Vali Acc: 0.247 Test Loss: 1.816 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0306153297424316
Epoch: 7, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.672 Vali Acc: 0.247 Test Loss: 1.672 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.759500741958618
Epoch: 8, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.747 Vali Acc: 0.262 Test Loss: 1.747 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.283644914627075
Epoch: 9, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.848 Vali Acc: 0.224 Test Loss: 1.848 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2905805110931396
Epoch: 10, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.932 Vali Acc: 0.243 Test Loss: 1.932 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2636897563934326
Epoch: 11, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.082 Vali Acc: 0.232 Test Loss: 2.082 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.169618606567383
Epoch: 12, Steps: 17 | Train Loss: 0.903 Vali Loss: 2.023 Vali Acc: 0.240 Test Loss: 2.023 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.175414800643921
Epoch: 13, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.242 Vali Acc: 0.270 Test Loss: 2.242 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8947620391845703
Epoch: 14, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.648 Vali Acc: 0.300 Test Loss: 2.648 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300354).  Saving model ...
Epoch: 15 cost time: 2.832169771194458
Epoch: 15, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.440 Vali Acc: 0.266 Test Loss: 2.440 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.147627830505371
Epoch: 16, Steps: 17 | Train Loss: 0.844 Vali Loss: 2.335 Vali Acc: 0.262 Test Loss: 2.335 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.972801685333252
Epoch: 17, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.621 Vali Acc: 0.247 Test Loss: 2.621 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.296846389770508
Epoch: 18, Steps: 17 | Train Loss: 0.668 Vali Loss: 2.481 Vali Acc: 0.251 Test Loss: 2.481 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.022289752960205
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.644 Vali Acc: 0.255 Test Loss: 2.644 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.580002546310425
Epoch: 20, Steps: 17 | Train Loss: 0.886 Vali Loss: 2.549 Vali Acc: 0.243 Test Loss: 2.549 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.250706911087036
Epoch: 21, Steps: 17 | Train Loss: 0.740 Vali Loss: 3.095 Vali Acc: 0.255 Test Loss: 3.095 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.85369873046875
Epoch: 22, Steps: 17 | Train Loss: 0.582 Vali Loss: 3.271 Vali Acc: 0.247 Test Loss: 3.271 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8264379501342773
Epoch: 23, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.871 Vali Acc: 0.274 Test Loss: 2.871 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.0489425659179688
Epoch: 24, Steps: 17 | Train Loss: 0.485 Vali Loss: 3.877 Vali Acc: 0.232 Test Loss: 3.877 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps73_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 37006852
model size : 155.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps73_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.388914585113525
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.449 Vali Acc: 0.255 Test Loss: 1.449 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.0385024547576904
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.524 Vali Acc: 0.251 Test Loss: 1.524 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.730586290359497
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.540 Vali Acc: 0.270 Test Loss: 1.540 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 2.4319257736206055
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.457 Vali Acc: 0.232 Test Loss: 1.457 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0600552558898926
Epoch: 5, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2425074577331543
Epoch: 6, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.645 Vali Acc: 0.274 Test Loss: 1.645 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273748).  Saving model ...
Epoch: 7 cost time: 1.6355032920837402
Epoch: 7, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.566 Vali Acc: 0.240 Test Loss: 1.566 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.352168560028076
Epoch: 8, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.572 Vali Acc: 0.243 Test Loss: 1.572 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.660757541656494
Epoch: 9, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.831 Vali Acc: 0.247 Test Loss: 1.831 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0070528984069824
Epoch: 10, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.935 Vali Acc: 0.259 Test Loss: 1.935 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.208336591720581
Epoch: 11, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.955 Vali Acc: 0.247 Test Loss: 1.955 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.145498514175415
Epoch: 12, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.993 Vali Acc: 0.243 Test Loss: 1.993 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4060256481170654
Epoch: 13, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.122 Vali Acc: 0.255 Test Loss: 2.122 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.164473533630371
Epoch: 14, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.946 Vali Acc: 0.232 Test Loss: 1.946 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.398350238800049
Epoch: 15, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.141 Vali Acc: 0.262 Test Loss: 2.141 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7875492572784424
Epoch: 16, Steps: 17 | Train Loss: 0.845 Vali Loss: 2.019 Vali Acc: 0.209 Test Loss: 2.019 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps73_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 36900868
model size : 155.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.094278812408447
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
Validation loss decreased (inf --> -0.254736).  Saving model ...
Epoch: 2 cost time: 3.9010531902313232
Epoch: 2, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.485 Vali Acc: 0.259 Test Loss: 1.485 Test Acc: 0.259
Validation loss decreased (-0.254736 --> -0.258540).  Saving model ...
Epoch: 3 cost time: 4.0278074741363525
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 2.168 Vali Acc: 0.251 Test Loss: 2.168 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.7829015254974365
Epoch: 4, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.614 Vali Acc: 0.247 Test Loss: 1.614 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3414306640625
Epoch: 5, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.704 Vali Acc: 0.259 Test Loss: 1.704 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.463557243347168
Epoch: 6, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.630 Vali Acc: 0.232 Test Loss: 1.630 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.4282538890838623
Epoch: 7, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.722 Vali Acc: 0.232 Test Loss: 1.722 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.333510637283325
Epoch: 8, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.845 Vali Acc: 0.247 Test Loss: 1.845 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.689940929412842
Epoch: 9, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.889 Vali Acc: 0.266 Test Loss: 1.889 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266141).  Saving model ...
Epoch: 10 cost time: 4.269207715988159
Epoch: 10, Steps: 17 | Train Loss: 0.912 Vali Loss: 2.131 Vali Acc: 0.236 Test Loss: 2.131 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.197553873062134
Epoch: 11, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.212 Vali Acc: 0.232 Test Loss: 2.212 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.033143758773804
Epoch: 12, Steps: 17 | Train Loss: 0.804 Vali Loss: 2.405 Vali Acc: 0.262 Test Loss: 2.405 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.482830762863159
Epoch: 13, Steps: 17 | Train Loss: 0.721 Vali Loss: 2.739 Vali Acc: 0.236 Test Loss: 2.739 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.45845365524292
Epoch: 14, Steps: 17 | Train Loss: 0.624 Vali Loss: 3.010 Vali Acc: 0.251 Test Loss: 3.010 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7904675006866455
Epoch: 15, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.599 Vali Acc: 0.259 Test Loss: 2.599 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.719244956970215
Epoch: 16, Steps: 17 | Train Loss: 0.617 Vali Loss: 3.609 Vali Acc: 0.213 Test Loss: 3.609 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6981375217437744
Epoch: 17, Steps: 17 | Train Loss: 0.670 Vali Loss: 3.616 Vali Acc: 0.259 Test Loss: 3.616 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.554737091064453
Epoch: 18, Steps: 17 | Train Loss: 0.672 Vali Loss: 3.199 Vali Acc: 0.232 Test Loss: 3.199 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5860607624053955
Epoch: 19, Steps: 17 | Train Loss: 0.519 Vali Loss: 3.376 Vali Acc: 0.240 Test Loss: 3.376 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37209604
model size : 156.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.367257356643677
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.474 Vali Acc: 0.262 Test Loss: 1.474 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.7499659061431885
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.580 Vali Acc: 0.255 Test Loss: 1.580 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6348369121551514
Epoch: 3, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.480 Vali Acc: 0.240 Test Loss: 1.480 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.791046619415283
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.660 Vali Acc: 0.259 Test Loss: 1.660 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4166300296783447
Epoch: 5, Steps: 17 | Train Loss: 1.172 Vali Loss: 2.042 Vali Acc: 0.240 Test Loss: 2.042 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.453604221343994
Epoch: 6, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.845 Vali Acc: 0.221 Test Loss: 1.845 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7352867126464844
Epoch: 7, Steps: 17 | Train Loss: 1.122 Vali Loss: 2.154 Vali Acc: 0.243 Test Loss: 2.154 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.9571614265441895
Epoch: 8, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.736 Vali Acc: 0.251 Test Loss: 1.736 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.512848377227783
Epoch: 9, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.731 Vali Acc: 0.243 Test Loss: 1.731 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.578216314315796
Epoch: 10, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.902 Vali Acc: 0.270 Test Loss: 1.902 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269943).  Saving model ...
Epoch: 11 cost time: 2.2001185417175293
Epoch: 11, Steps: 17 | Train Loss: 1.050 Vali Loss: 2.200 Vali Acc: 0.232 Test Loss: 2.200 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9093952178955078
Epoch: 12, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.866 Vali Acc: 0.232 Test Loss: 1.866 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8239707946777344
Epoch: 13, Steps: 17 | Train Loss: 0.821 Vali Loss: 2.430 Vali Acc: 0.274 Test Loss: 2.430 Test Acc: 0.274
Validation loss decreased (-0.269943 --> -0.273740).  Saving model ...
Epoch: 14 cost time: 3.2844040393829346
Epoch: 14, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.377 Vali Acc: 0.281 Test Loss: 2.377 Test Acc: 0.281
Validation loss decreased (-0.273740 --> -0.281345).  Saving model ...
Epoch: 15 cost time: 4.0101847648620605
Epoch: 15, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.313 Vali Acc: 0.236 Test Loss: 2.313 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.288612365722656
Epoch: 16, Steps: 17 | Train Loss: 0.834 Vali Loss: 2.692 Vali Acc: 0.259 Test Loss: 2.692 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.945044755935669
Epoch: 17, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.503 Vali Acc: 0.274 Test Loss: 2.503 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7761993408203125
Epoch: 18, Steps: 17 | Train Loss: 0.809 Vali Loss: 3.216 Vali Acc: 0.236 Test Loss: 3.216 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9071319103240967
Epoch: 19, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.312 Vali Acc: 0.285 Test Loss: 2.312 Test Acc: 0.285
Validation loss decreased (-0.281345 --> -0.285148).  Saving model ...
Epoch: 20 cost time: 2.994685411453247
Epoch: 20, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.590 Vali Acc: 0.270 Test Loss: 2.590 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4113271236419678
Epoch: 21, Steps: 17 | Train Loss: 0.720 Vali Loss: 2.977 Vali Acc: 0.247 Test Loss: 2.977 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.436894655227661
Epoch: 22, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.844 Vali Acc: 0.243 Test Loss: 2.844 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.839481830596924
Epoch: 23, Steps: 17 | Train Loss: 0.620 Vali Loss: 3.020 Vali Acc: 0.281 Test Loss: 3.020 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3250598907470703
Epoch: 24, Steps: 17 | Train Loss: 0.574 Vali Loss: 2.824 Vali Acc: 0.247 Test Loss: 2.824 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.6715829372406006
Epoch: 25, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.673 Vali Acc: 0.274 Test Loss: 2.673 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.5016567707061768
Epoch: 26, Steps: 17 | Train Loss: 0.591 Vali Loss: 3.124 Vali Acc: 0.259 Test Loss: 3.124 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8327476978302
Epoch: 27, Steps: 17 | Train Loss: 0.523 Vali Loss: 3.527 Vali Acc: 0.266 Test Loss: 3.527 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.438917398452759
Epoch: 28, Steps: 17 | Train Loss: 0.477 Vali Loss: 4.133 Vali Acc: 0.224 Test Loss: 4.133 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3401613235473633
Epoch: 29, Steps: 17 | Train Loss: 0.724 Vali Loss: 3.204 Vali Acc: 0.262 Test Loss: 3.204 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37020676
model size : 155.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.2092671394348145
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 2.282355785369873
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.584 Vali Acc: 0.270 Test Loss: 1.584 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 2.7141785621643066
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.603 Vali Acc: 0.236 Test Loss: 1.603 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.701866865158081
Epoch: 4, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.477 Vali Acc: 0.278 Test Loss: 1.477 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 2.234527349472046
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.524 Vali Acc: 0.228 Test Loss: 1.524 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.555100679397583
Epoch: 6, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.570 Vali Acc: 0.278 Test Loss: 1.570 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.200625419616699
Epoch: 7, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.698 Vali Acc: 0.240 Test Loss: 1.698 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9625086784362793
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.643 Vali Acc: 0.255 Test Loss: 1.643 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.790492057800293
Epoch: 9, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.987 Vali Acc: 0.221 Test Loss: 1.987 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9070565700531006
Epoch: 10, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.801 Vali Acc: 0.232 Test Loss: 1.801 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8064100742340088
Epoch: 11, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.879 Vali Acc: 0.262 Test Loss: 1.879 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.889937400817871
Epoch: 12, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.961 Vali Acc: 0.232 Test Loss: 1.961 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.208944082260132
Epoch: 13, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.980 Vali Acc: 0.247 Test Loss: 1.980 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.54135799407959
Epoch: 14, Steps: 17 | Train Loss: 0.846 Vali Loss: 2.396 Vali Acc: 0.259 Test Loss: 2.396 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 36923908
model size : 155.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.002920866012573
Epoch: 1, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.672 Vali Acc: 0.262 Test Loss: 1.672 Test Acc: 0.262
Validation loss decreased (inf --> -0.262341).  Saving model ...
Epoch: 2 cost time: 3.2239537239074707
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.448 Vali Acc: 0.251 Test Loss: 1.448 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1913633346557617
Epoch: 3, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.560 Vali Acc: 0.247 Test Loss: 1.560 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.192840576171875
Epoch: 4, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.510 Vali Acc: 0.255 Test Loss: 1.510 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5873374938964844
Epoch: 5, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.590 Vali Acc: 0.259 Test Loss: 1.590 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3668649196624756
Epoch: 6, Steps: 17 | Train Loss: 1.112 Vali Loss: 2.134 Vali Acc: 0.274 Test Loss: 2.134 Test Acc: 0.274
Validation loss decreased (-0.262341 --> -0.273743).  Saving model ...
Epoch: 7 cost time: 2.991929292678833
Epoch: 7, Steps: 17 | Train Loss: 1.138 Vali Loss: 2.242 Vali Acc: 0.278 Test Loss: 2.242 Test Acc: 0.278
Validation loss decreased (-0.273743 --> -0.277544).  Saving model ...
Epoch: 8 cost time: 2.7383463382720947
Epoch: 8, Steps: 17 | Train Loss: 1.140 Vali Loss: 2.065 Vali Acc: 0.247 Test Loss: 2.065 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.851731538772583
Epoch: 9, Steps: 17 | Train Loss: 1.026 Vali Loss: 2.104 Vali Acc: 0.274 Test Loss: 2.104 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.130582332611084
Epoch: 10, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.355 Vali Acc: 0.240 Test Loss: 2.355 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0924463272094727
Epoch: 11, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.847 Vali Acc: 0.270 Test Loss: 1.847 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.327200412750244
Epoch: 12, Steps: 17 | Train Loss: 0.901 Vali Loss: 3.380 Vali Acc: 0.251 Test Loss: 3.380 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4798502922058105
Epoch: 13, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.509 Vali Acc: 0.259 Test Loss: 2.509 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7934069633483887
Epoch: 14, Steps: 17 | Train Loss: 0.912 Vali Loss: 2.517 Vali Acc: 0.259 Test Loss: 2.517 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.34100079536438
Epoch: 15, Steps: 17 | Train Loss: 0.780 Vali Loss: 2.774 Vali Acc: 0.243 Test Loss: 2.774 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4878904819488525
Epoch: 16, Steps: 17 | Train Loss: 0.656 Vali Loss: 3.599 Vali Acc: 0.243 Test Loss: 3.599 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.45930552482605
Epoch: 17, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.918 Vali Acc: 0.224 Test Loss: 2.918 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 37230340
model size : 156.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.849181890487671
Epoch: 1, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.444 Vali Acc: 0.281 Test Loss: 1.444 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 3.3185811042785645
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.426 Vali Acc: 0.293 Test Loss: 1.426 Test Acc: 0.293
Validation loss decreased (-0.281354 --> -0.292761).  Saving model ...
Epoch: 3 cost time: 3.7830636501312256
Epoch: 3, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.420 Vali Acc: 0.266 Test Loss: 1.420 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2962424755096436
Epoch: 4, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.513 Vali Acc: 0.217 Test Loss: 1.513 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.169304370880127
Epoch: 5, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.676 Vali Acc: 0.243 Test Loss: 1.676 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.483931541442871
Epoch: 6, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.782 Vali Acc: 0.240 Test Loss: 1.782 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9948976039886475
Epoch: 7, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.587 Vali Acc: 0.209 Test Loss: 1.587 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9462733268737793
Epoch: 8, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.899 Vali Acc: 0.209 Test Loss: 1.899 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3324179649353027
Epoch: 9, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.678 Vali Acc: 0.228 Test Loss: 1.678 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.933696985244751
Epoch: 10, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.789 Vali Acc: 0.259 Test Loss: 1.789 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1742122173309326
Epoch: 11, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.895 Vali Acc: 0.217 Test Loss: 1.895 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.148481845855713
Epoch: 12, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.988 Vali Acc: 0.232 Test Loss: 1.988 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 37036804
model size : 155.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.442334413528442
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.416 Vali Acc: 0.251 Test Loss: 1.416 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.9550492763519287
Epoch: 2, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.446117401123047
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.565 Vali Acc: 0.255 Test Loss: 1.565 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 2.0300397872924805
Epoch: 4, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.613 Vali Acc: 0.270 Test Loss: 1.613 Test Acc: 0.270
Validation loss decreased (-0.254737 --> -0.269946).  Saving model ...
Epoch: 5 cost time: 2.5998213291168213
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.528 Vali Acc: 0.247 Test Loss: 1.528 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.928642988204956
Epoch: 6, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.648 Vali Acc: 0.278 Test Loss: 1.648 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277550).  Saving model ...
Epoch: 7 cost time: 2.6185688972473145
Epoch: 7, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.534 Vali Acc: 0.240 Test Loss: 1.534 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5173046588897705
Epoch: 8, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.644 Vali Acc: 0.228 Test Loss: 1.644 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.038749933242798
Epoch: 9, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.685 Vali Acc: 0.228 Test Loss: 1.685 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1815168857574463
Epoch: 10, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.631 Vali Acc: 0.232 Test Loss: 1.631 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3937854766845703
Epoch: 11, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.517 Vali Acc: 0.236 Test Loss: 2.517 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7766027450561523
Epoch: 12, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.079 Vali Acc: 0.266 Test Loss: 2.079 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.1914608478546143
Epoch: 13, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.806 Vali Acc: 0.251 Test Loss: 1.806 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.243011713027954
Epoch: 14, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.970 Vali Acc: 0.221 Test Loss: 1.970 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.2092742919921875
Epoch: 15, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.997 Vali Acc: 0.266 Test Loss: 1.997 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.728818655014038
Epoch: 16, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.149 Vali Acc: 0.255 Test Loss: 2.149 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 36940036
model size : 155.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps84_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.776684045791626
Epoch: 1, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 2.929258108139038
Epoch: 2, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.429 Vali Acc: 0.274 Test Loss: 1.429 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 4.074811220169067
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.656 Vali Acc: 0.266 Test Loss: 1.656 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9320719242095947
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.548 Vali Acc: 0.243 Test Loss: 1.548 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.00704026222229
Epoch: 5, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.624 Vali Acc: 0.228 Test Loss: 1.624 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.559565305709839
Epoch: 6, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.923 Vali Acc: 0.243 Test Loss: 1.923 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7755305767059326
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.735 Vali Acc: 0.221 Test Loss: 1.735 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.132565259933472
Epoch: 8, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.639 Vali Acc: 0.274 Test Loss: 1.639 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.853184700012207
Epoch: 9, Steps: 17 | Train Loss: 1.122 Vali Loss: 2.103 Vali Acc: 0.247 Test Loss: 2.103 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8993091583251953
Epoch: 10, Steps: 17 | Train Loss: 1.130 Vali Loss: 2.293 Vali Acc: 0.270 Test Loss: 2.293 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.030099153518677
Epoch: 11, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.683 Vali Acc: 0.270 Test Loss: 1.683 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8801095485687256
Epoch: 12, Steps: 17 | Train Loss: 0.921 Vali Loss: 2.328 Vali Acc: 0.232 Test Loss: 2.328 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps84_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 37239556
model size : 156.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps84_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.966949701309204
Epoch: 1, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.475 Vali Acc: 0.251 Test Loss: 1.475 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.0553090572357178
Epoch: 2, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.528 Vali Acc: 0.255 Test Loss: 1.528 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 2.7197818756103516
Epoch: 3, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.529057025909424
Epoch: 4, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.532 Vali Acc: 0.270 Test Loss: 1.532 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269947).  Saving model ...
Epoch: 5 cost time: 2.070399522781372
Epoch: 5, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.634 Vali Acc: 0.243 Test Loss: 1.634 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9246604442596436
Epoch: 6, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.596 Vali Acc: 0.281 Test Loss: 1.596 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281353).  Saving model ...
Epoch: 7 cost time: 3.8520684242248535
Epoch: 7, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.755 Vali Acc: 0.247 Test Loss: 1.755 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2425825595855713
Epoch: 8, Steps: 17 | Train Loss: 1.066 Vali Loss: 2.099 Vali Acc: 0.228 Test Loss: 2.099 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3581418991088867
Epoch: 9, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.886 Vali Acc: 0.251 Test Loss: 1.886 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.324749708175659
Epoch: 10, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.984 Vali Acc: 0.221 Test Loss: 1.984 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.9519784450531006
Epoch: 11, Steps: 17 | Train Loss: 0.940 Vali Loss: 2.011 Vali Acc: 0.236 Test Loss: 2.011 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.92688250541687
Epoch: 12, Steps: 17 | Train Loss: 0.922 Vali Loss: 2.013 Vali Acc: 0.243 Test Loss: 2.013 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.002152919769287
Epoch: 13, Steps: 17 | Train Loss: 0.873 Vali Loss: 2.979 Vali Acc: 0.240 Test Loss: 2.979 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.5746426582336426
Epoch: 14, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.074 Vali Acc: 0.236 Test Loss: 2.074 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.572802543640137
Epoch: 15, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.359 Vali Acc: 0.236 Test Loss: 2.359 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6753523349761963
Epoch: 16, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.760 Vali Acc: 0.202 Test Loss: 2.760 Test Acc: 0.202
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps84_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 37055236
model size : 156.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps84_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.167368650436401
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.418 Vali Acc: 0.236 Test Loss: 1.418 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 3.214620590209961
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
Validation loss decreased (-0.235727 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 3.8111655712127686
Epoch: 3, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.540 Vali Acc: 0.266 Test Loss: 1.540 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266144).  Saving model ...
Epoch: 4 cost time: 3.4012999534606934
Epoch: 4, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.550 Vali Acc: 0.278 Test Loss: 1.550 Test Acc: 0.278
Validation loss decreased (-0.266144 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 2.279801607131958
Epoch: 5, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.464 Vali Acc: 0.266 Test Loss: 1.464 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6269748210906982
Epoch: 6, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.558 Vali Acc: 0.266 Test Loss: 1.558 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5017201900482178
Epoch: 7, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.666 Vali Acc: 0.274 Test Loss: 1.666 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.277644157409668
Epoch: 8, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.572 Vali Acc: 0.251 Test Loss: 1.572 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1316146850585938
Epoch: 9, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.613 Vali Acc: 0.274 Test Loss: 1.613 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.786898136138916
Epoch: 10, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.690 Vali Acc: 0.251 Test Loss: 1.690 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.79799485206604
Epoch: 11, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.930 Vali Acc: 0.262 Test Loss: 1.930 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4244539737701416
Epoch: 12, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.753 Vali Acc: 0.228 Test Loss: 1.753 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.316521406173706
Epoch: 13, Steps: 17 | Train Loss: 1.083 Vali Loss: 2.070 Vali Acc: 0.251 Test Loss: 2.070 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9476370811462402
Epoch: 14, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.970 Vali Acc: 0.232 Test Loss: 1.970 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps84_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 36963076
model size : 155.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps88_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.696465015411377
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.684 Vali Acc: 0.259 Test Loss: 1.684 Test Acc: 0.259
Validation loss decreased (inf --> -0.258538).  Saving model ...
Epoch: 2 cost time: 3.6811697483062744
Epoch: 2, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.509 Vali Acc: 0.259 Test Loss: 1.509 Test Acc: 0.259
Validation loss decreased (-0.258538 --> -0.258540).  Saving model ...
Epoch: 3 cost time: 4.381722927093506
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.810 Vali Acc: 0.266 Test Loss: 1.810 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266142).  Saving model ...
Epoch: 4 cost time: 4.249575138092041
Epoch: 4, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.578 Vali Acc: 0.262 Test Loss: 1.578 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.552099943161011
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.642 Vali Acc: 0.221 Test Loss: 1.642 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.036352157592773
Epoch: 6, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.701 Vali Acc: 0.259 Test Loss: 1.701 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.681248903274536
Epoch: 7, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.695 Vali Acc: 0.266 Test Loss: 1.695 Test Acc: 0.266
Validation loss decreased (-0.266142 --> -0.266143).  Saving model ...
Epoch: 8 cost time: 4.159345626831055
Epoch: 8, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.782 Vali Acc: 0.251 Test Loss: 1.782 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.8676347732543945
Epoch: 9, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.679 Vali Acc: 0.209 Test Loss: 1.679 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.3008692264556885
Epoch: 10, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.068 Vali Acc: 0.251 Test Loss: 2.068 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.073790788650513
Epoch: 11, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.941 Vali Acc: 0.209 Test Loss: 1.941 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.7275402545928955
Epoch: 12, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.272 Vali Acc: 0.236 Test Loss: 2.272 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.588915586471558
Epoch: 13, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.954 Vali Acc: 0.251 Test Loss: 1.954 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.629034042358398
Epoch: 14, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.369 Vali Acc: 0.247 Test Loss: 2.369 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.784257173538208
Epoch: 15, Steps: 17 | Train Loss: 0.696 Vali Loss: 2.683 Vali Acc: 0.202 Test Loss: 2.683 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9050798416137695
Epoch: 16, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.431 Vali Acc: 0.251 Test Loss: 2.431 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.087012529373169
Epoch: 17, Steps: 17 | Train Loss: 0.744 Vali Loss: 2.992 Vali Acc: 0.251 Test Loss: 2.992 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps88_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37248772
model size : 156.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.396080732345581
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.507 Vali Acc: 0.240 Test Loss: 1.507 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 2.218764543533325
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.449 Vali Acc: 0.259 Test Loss: 1.449 Test Acc: 0.259
Validation loss decreased (-0.239529 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 2.355369806289673
Epoch: 3, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.506 Vali Acc: 0.232 Test Loss: 1.506 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.603614330291748
Epoch: 4, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.565 Vali Acc: 0.228 Test Loss: 1.565 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8523197174072266
Epoch: 5, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.574 Vali Acc: 0.228 Test Loss: 1.574 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9181344509124756
Epoch: 6, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.728 Vali Acc: 0.259 Test Loss: 1.728 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7290782928466797
Epoch: 7, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.703 Vali Acc: 0.247 Test Loss: 1.703 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9804794788360596
Epoch: 8, Steps: 17 | Train Loss: 1.078 Vali Loss: 2.111 Vali Acc: 0.232 Test Loss: 2.111 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3237969875335693
Epoch: 9, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.960 Vali Acc: 0.243 Test Loss: 1.960 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.830193042755127
Epoch: 10, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.105 Vali Acc: 0.255 Test Loss: 2.105 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1009681224823
Epoch: 11, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.985 Vali Acc: 0.251 Test Loss: 1.985 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.132706880569458
Epoch: 12, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.844 Vali Acc: 0.224 Test Loss: 1.844 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 37073668
model size : 156.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps88_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.503865480422974
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.434 Vali Acc: 0.247 Test Loss: 1.434 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 3.742353677749634
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.602 Vali Acc: 0.274 Test Loss: 1.602 Test Acc: 0.274
Validation loss decreased (-0.247134 --> -0.273748).  Saving model ...
Epoch: 3 cost time: 2.8623404502868652
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.460 Vali Acc: 0.228 Test Loss: 1.460 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2521719932556152
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.457 Vali Acc: 0.255 Test Loss: 1.457 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.229962110519409
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.500 Vali Acc: 0.240 Test Loss: 1.500 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.976482629776001
Epoch: 6, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.755 Vali Acc: 0.251 Test Loss: 1.755 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.290764093399048
Epoch: 7, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.532 Vali Acc: 0.232 Test Loss: 1.532 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7646470069885254
Epoch: 8, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.763 Vali Acc: 0.247 Test Loss: 1.763 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9362261295318604
Epoch: 9, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.805 Vali Acc: 0.251 Test Loss: 1.805 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7151339054107666
Epoch: 10, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.674 Vali Acc: 0.232 Test Loss: 1.674 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.898897171020508
Epoch: 11, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.938 Vali Acc: 0.224 Test Loss: 1.938 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.963395357131958
Epoch: 12, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.886 Vali Acc: 0.232 Test Loss: 1.886 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps88_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 36986116
model size : 155.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.470646858215332
Epoch: 1, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.509 Vali Acc: 0.262 Test Loss: 1.509 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 4.274317741394043
Epoch: 2, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.571 Vali Acc: 0.243 Test Loss: 1.571 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3902242183685303
Epoch: 3, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.711 Vali Acc: 0.224 Test Loss: 1.711 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2292933464050293
Epoch: 4, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.530 Vali Acc: 0.217 Test Loss: 1.530 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.263916492462158
Epoch: 5, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.774 Vali Acc: 0.247 Test Loss: 1.774 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.058616876602173
Epoch: 6, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.591 Vali Acc: 0.247 Test Loss: 1.591 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.099645614624023
Epoch: 7, Steps: 17 | Train Loss: 1.022 Vali Loss: 2.252 Vali Acc: 0.285 Test Loss: 2.252 Test Acc: 0.285
Validation loss decreased (-0.262342 --> -0.285149).  Saving model ...
Epoch: 8 cost time: 5.145053148269653
Epoch: 8, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.847 Vali Acc: 0.243 Test Loss: 1.847 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.179488658905029
Epoch: 9, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.852 Vali Acc: 0.217 Test Loss: 1.852 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.162485361099243
Epoch: 10, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.314 Vali Acc: 0.259 Test Loss: 2.314 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6797657012939453
Epoch: 11, Steps: 17 | Train Loss: 0.880 Vali Loss: 2.435 Vali Acc: 0.259 Test Loss: 2.435 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.3631374835968018
Epoch: 12, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.761 Vali Acc: 0.240 Test Loss: 2.761 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.512134790420532
Epoch: 13, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.201 Vali Acc: 0.213 Test Loss: 2.201 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.196227073669434
Epoch: 14, Steps: 17 | Train Loss: 0.794 Vali Loss: 2.726 Vali Acc: 0.251 Test Loss: 2.726 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.082109689712524
Epoch: 15, Steps: 17 | Train Loss: 0.831 Vali Loss: 2.609 Vali Acc: 0.281 Test Loss: 2.609 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.4546732902526855
Epoch: 16, Steps: 17 | Train Loss: 0.735 Vali Loss: 3.316 Vali Acc: 0.262 Test Loss: 3.316 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.772816896438599
Epoch: 17, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.192 Vali Acc: 0.236 Test Loss: 2.192 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37255684
model size : 156.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.123968124389648
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.756 Vali Acc: 0.243 Test Loss: 1.756 Test Acc: 0.243
Validation loss decreased (inf --> -0.243328).  Saving model ...
Epoch: 2 cost time: 3.6346933841705322
Epoch: 2, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.459 Vali Acc: 0.274 Test Loss: 1.459 Test Acc: 0.274
Validation loss decreased (-0.243328 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 3.366037368774414
Epoch: 3, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.454 Vali Acc: 0.224 Test Loss: 1.454 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.564485549926758
Epoch: 4, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.696 Vali Acc: 0.243 Test Loss: 1.696 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3698368072509766
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.536 Vali Acc: 0.281 Test Loss: 1.536 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281353).  Saving model ...
Epoch: 6 cost time: 3.4829213619232178
Epoch: 6, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.590 Vali Acc: 0.270 Test Loss: 1.590 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5001466274261475
Epoch: 7, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.773 Vali Acc: 0.240 Test Loss: 1.773 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.642735242843628
Epoch: 8, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.694 Vali Acc: 0.251 Test Loss: 1.694 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9376323223114014
Epoch: 9, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.932 Vali Acc: 0.266 Test Loss: 1.932 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.796926259994507
Epoch: 10, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.016 Vali Acc: 0.243 Test Loss: 2.016 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3246586322784424
Epoch: 11, Steps: 17 | Train Loss: 1.085 Vali Loss: 2.002 Vali Acc: 0.285 Test Loss: 2.002 Test Acc: 0.285
Validation loss decreased (-0.281353 --> -0.285151).  Saving model ...
Epoch: 12 cost time: 3.7608706951141357
Epoch: 12, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.903 Vali Acc: 0.236 Test Loss: 1.903 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8759701251983643
Epoch: 13, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.973 Vali Acc: 0.217 Test Loss: 1.973 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.208632469177246
Epoch: 14, Steps: 17 | Train Loss: 0.823 Vali Loss: 2.295 Vali Acc: 0.243 Test Loss: 2.295 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7982749938964844
Epoch: 15, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.498 Vali Acc: 0.255 Test Loss: 2.498 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8692243099212646
Epoch: 16, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.465 Vali Acc: 0.270 Test Loss: 2.465 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.626783847808838
Epoch: 17, Steps: 17 | Train Loss: 0.860 Vali Loss: 2.406 Vali Acc: 0.255 Test Loss: 2.406 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8515818119049072
Epoch: 18, Steps: 17 | Train Loss: 0.777 Vali Loss: 2.873 Vali Acc: 0.217 Test Loss: 2.873 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5461740493774414
Epoch: 19, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.371 Vali Acc: 0.278 Test Loss: 2.371 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3546876907348633
Epoch: 20, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.939 Vali Acc: 0.240 Test Loss: 2.939 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.7671048641204834
Epoch: 21, Steps: 17 | Train Loss: 0.651 Vali Loss: 2.985 Vali Acc: 0.259 Test Loss: 2.985 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37099012
model size : 156.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.93164587020874
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.457 Vali Acc: 0.278 Test Loss: 1.457 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 2.8987956047058105
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.477 Vali Acc: 0.259 Test Loss: 1.477 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1790504455566406
Epoch: 3, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.497 Vali Acc: 0.224 Test Loss: 1.497 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8689181804656982
Epoch: 4, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.486 Vali Acc: 0.243 Test Loss: 1.486 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9509670734405518
Epoch: 5, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.499 Vali Acc: 0.262 Test Loss: 1.499 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4469995498657227
Epoch: 6, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.596 Vali Acc: 0.262 Test Loss: 1.596 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.416476011276245
Epoch: 7, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.637 Vali Acc: 0.262 Test Loss: 1.637 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.566075325012207
Epoch: 8, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.756 Vali Acc: 0.285 Test Loss: 1.756 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285154).  Saving model ...
Epoch: 9 cost time: 3.469935417175293
Epoch: 9, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.758 Vali Acc: 0.224 Test Loss: 1.758 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4459402561187744
Epoch: 10, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.601 Vali Acc: 0.240 Test Loss: 1.601 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.963839292526245
Epoch: 11, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.782 Vali Acc: 0.243 Test Loss: 1.782 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5736851692199707
Epoch: 12, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.104 Vali Acc: 0.232 Test Loss: 2.104 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.268507480621338
Epoch: 13, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.788 Vali Acc: 0.240 Test Loss: 1.788 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.8437867164611816
Epoch: 14, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.194 Vali Acc: 0.247 Test Loss: 2.194 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1715245246887207
Epoch: 15, Steps: 17 | Train Loss: 1.096 Vali Loss: 2.106 Vali Acc: 0.217 Test Loss: 2.106 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.884734869003296
Epoch: 16, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.276 Vali Acc: 0.266 Test Loss: 2.276 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2076337337493896
Epoch: 17, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.259 Vali Acc: 0.221 Test Loss: 2.259 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.0324292182922363
Epoch: 18, Steps: 17 | Train Loss: 0.776 Vali Loss: 2.025 Vali Acc: 0.209 Test Loss: 2.025 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37016068
model size : 155.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps98_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.678242921829224
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.517 Vali Acc: 0.270 Test Loss: 1.517 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 4.306037664413452
Epoch: 2, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.584 Vali Acc: 0.251 Test Loss: 1.584 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.318739175796509
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.516 Vali Acc: 0.281 Test Loss: 1.516 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 4.5313239097595215
Epoch: 4, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.650 Vali Acc: 0.262 Test Loss: 1.650 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6102192401885986
Epoch: 5, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.843 Vali Acc: 0.270 Test Loss: 1.843 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.291799545288086
Epoch: 6, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.733869314193726
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.616 Vali Acc: 0.285 Test Loss: 1.616 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 8 cost time: 4.914828300476074
Epoch: 8, Steps: 17 | Train Loss: 1.192 Vali Loss: 2.226 Vali Acc: 0.228 Test Loss: 2.226 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.364733695983887
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.666 Vali Acc: 0.259 Test Loss: 1.666 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.043837308883667
Epoch: 10, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.814 Vali Acc: 0.251 Test Loss: 1.814 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.4380881786346436
Epoch: 11, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.688 Vali Acc: 0.247 Test Loss: 1.688 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.970057487487793
Epoch: 12, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.479 Vali Acc: 0.236 Test Loss: 2.479 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.70539927482605
Epoch: 13, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.911 Vali Acc: 0.217 Test Loss: 1.911 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8896303176879883
Epoch: 14, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.108 Vali Acc: 0.217 Test Loss: 2.108 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.4681315422058105
Epoch: 15, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.731 Vali Acc: 0.281 Test Loss: 2.731 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.2502076625823975
Epoch: 16, Steps: 17 | Train Loss: 0.903 Vali Loss: 2.317 Vali Acc: 0.232 Test Loss: 2.317 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.85768723487854
Epoch: 17, Steps: 17 | Train Loss: 0.686 Vali Loss: 2.791 Vali Acc: 0.221 Test Loss: 2.791 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps98_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37276420
model size : 156.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps98_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.8188934326171875
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.479 Vali Acc: 0.266 Test Loss: 1.479 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 3.2855663299560547
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.498 Vali Acc: 0.262 Test Loss: 1.498 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1151301860809326
Epoch: 3, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.607 Vali Acc: 0.259 Test Loss: 1.607 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.31060528755188
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.706 Vali Acc: 0.243 Test Loss: 1.706 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7352638244628906
Epoch: 5, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.670 Vali Acc: 0.228 Test Loss: 1.670 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7086167335510254
Epoch: 6, Steps: 17 | Train Loss: 1.309 Vali Loss: 2.015 Vali Acc: 0.232 Test Loss: 2.015 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.467869758605957
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.582 Vali Acc: 0.262 Test Loss: 1.582 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5498545169830322
Epoch: 8, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.564 Vali Acc: 0.251 Test Loss: 1.564 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.456638813018799
Epoch: 9, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.778 Vali Acc: 0.243 Test Loss: 1.778 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.2197940349578857
Epoch: 10, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.828 Vali Acc: 0.217 Test Loss: 1.828 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.419384002685547
Epoch: 11, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.830 Vali Acc: 0.243 Test Loss: 1.830 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps98_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37124356
model size : 156.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps98_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.512317180633545
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.430 Vali Acc: 0.289 Test Loss: 1.430 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 3.576669692993164
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.455 Vali Acc: 0.278 Test Loss: 1.455 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4856889247894287
Epoch: 3, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.638 Vali Acc: 0.228 Test Loss: 1.638 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.507992744445801
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.450 Vali Acc: 0.262 Test Loss: 1.450 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2668325901031494
Epoch: 5, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.574 Vali Acc: 0.274 Test Loss: 1.574 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3418471813201904
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.589 Vali Acc: 0.236 Test Loss: 1.589 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5206832885742188
Epoch: 7, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.544 Vali Acc: 0.247 Test Loss: 1.544 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.927574872970581
Epoch: 8, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.552 Vali Acc: 0.266 Test Loss: 1.552 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6456592082977295
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.870 Vali Acc: 0.228 Test Loss: 1.870 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2956187725067139
Epoch: 10, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.004 Vali Acc: 0.247 Test Loss: 2.004 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3013710975646973
Epoch: 11, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.724 Vali Acc: 0.270 Test Loss: 1.724 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps98_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 37046020
model size : 155.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps103_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.258695125579834
Epoch: 1, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.460 Vali Acc: 0.270 Test Loss: 1.460 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 4.969842910766602
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.473 Vali Acc: 0.270 Test Loss: 1.473 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.863515615463257
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.553 Vali Acc: 0.251 Test Loss: 1.553 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.301719903945923
Epoch: 4, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.662 Vali Acc: 0.236 Test Loss: 1.662 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.238217353820801
Epoch: 5, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.549 Vali Acc: 0.213 Test Loss: 1.549 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.1947407722473145
Epoch: 6, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.669 Vali Acc: 0.251 Test Loss: 1.669 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.531981945037842
Epoch: 7, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.657 Vali Acc: 0.240 Test Loss: 1.657 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.535795450210571
Epoch: 8, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.703 Vali Acc: 0.236 Test Loss: 1.703 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.517496347427368
Epoch: 9, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.877 Vali Acc: 0.251 Test Loss: 1.877 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.055285453796387
Epoch: 10, Steps: 17 | Train Loss: 0.960 Vali Loss: 2.181 Vali Acc: 0.243 Test Loss: 2.181 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.80017614364624
Epoch: 11, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.723 Vali Acc: 0.274 Test Loss: 1.723 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273747).  Saving model ...
Epoch: 12 cost time: 3.8602700233459473
Epoch: 12, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.141 Vali Acc: 0.217 Test Loss: 2.141 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.162787914276123
Epoch: 13, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.286 Vali Acc: 0.247 Test Loss: 2.286 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9520838260650635
Epoch: 14, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.924 Vali Acc: 0.232 Test Loss: 1.924 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.615075349807739
Epoch: 15, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.421 Vali Acc: 0.236 Test Loss: 2.421 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.834044933319092
Epoch: 16, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.654 Vali Acc: 0.232 Test Loss: 2.654 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.77734375
Epoch: 17, Steps: 17 | Train Loss: 0.831 Vali Loss: 2.579 Vali Acc: 0.247 Test Loss: 2.579 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.246067047119141
Epoch: 18, Steps: 17 | Train Loss: 0.792 Vali Loss: 2.668 Vali Acc: 0.255 Test Loss: 2.668 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.49138069152832
Epoch: 19, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.903 Vali Acc: 0.243 Test Loss: 2.903 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.415937900543213
Epoch: 20, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.340 Vali Acc: 0.266 Test Loss: 2.340 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.9017186164855957
Epoch: 21, Steps: 17 | Train Loss: 0.725 Vali Loss: 3.984 Vali Acc: 0.224 Test Loss: 3.984 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps103_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 37297156
model size : 156.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps103_str52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.646237134933472
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.459 Vali Acc: 0.243 Test Loss: 1.459 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 2.723723888397217
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.538 Vali Acc: 0.247 Test Loss: 1.538 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247133).  Saving model ...
Epoch: 3 cost time: 3.8172731399536133
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.584 Vali Acc: 0.259 Test Loss: 1.584 Test Acc: 0.259
Validation loss decreased (-0.247133 --> -0.258539).  Saving model ...
Epoch: 4 cost time: 4.083889007568359
Epoch: 4, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.462 Vali Acc: 0.221 Test Loss: 1.462 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7568938732147217
Epoch: 5, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.625 Vali Acc: 0.259 Test Loss: 1.625 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.292004108428955
Epoch: 6, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.629 Vali Acc: 0.224 Test Loss: 1.629 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6756229400634766
Epoch: 7, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.804 Vali Acc: 0.270 Test Loss: 1.804 Test Acc: 0.270
Validation loss decreased (-0.258539 --> -0.269944).  Saving model ...
Epoch: 8 cost time: 3.125870943069458
Epoch: 8, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.595 Vali Acc: 0.209 Test Loss: 1.595 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8666832447052
Epoch: 9, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.784 Vali Acc: 0.217 Test Loss: 1.784 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.643399953842163
Epoch: 10, Steps: 17 | Train Loss: 1.076 Vali Loss: 2.225 Vali Acc: 0.228 Test Loss: 2.225 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.06219220161438
Epoch: 11, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.786 Vali Acc: 0.221 Test Loss: 1.786 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.4730522632598877
Epoch: 12, Steps: 17 | Train Loss: 0.960 Vali Loss: 2.050 Vali Acc: 0.247 Test Loss: 2.050 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6545774936676025
Epoch: 13, Steps: 17 | Train Loss: 0.855 Vali Loss: 2.208 Vali Acc: 0.236 Test Loss: 2.208 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7500717639923096
Epoch: 14, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.498 Vali Acc: 0.274 Test Loss: 2.498 Test Acc: 0.274
Validation loss decreased (-0.269944 --> -0.273739).  Saving model ...
Epoch: 15 cost time: 3.097371816635132
Epoch: 15, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.164 Vali Acc: 0.224 Test Loss: 2.164 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3281009197235107
Epoch: 16, Steps: 17 | Train Loss: 0.734 Vali Loss: 2.465 Vali Acc: 0.190 Test Loss: 2.465 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.791193723678589
Epoch: 17, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.466 Vali Acc: 0.236 Test Loss: 2.466 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2708754539489746
Epoch: 18, Steps: 17 | Train Loss: 0.716 Vali Loss: 2.506 Vali Acc: 0.255 Test Loss: 2.506 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7270095348358154
Epoch: 19, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.778 Vali Acc: 0.228 Test Loss: 2.778 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4621927738189697
Epoch: 20, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.206 Vali Acc: 0.236 Test Loss: 2.206 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.899536371231079
Epoch: 21, Steps: 17 | Train Loss: 0.681 Vali Loss: 2.724 Vali Acc: 0.221 Test Loss: 2.724 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7894036769866943
Epoch: 22, Steps: 17 | Train Loss: 0.716 Vali Loss: 2.370 Vali Acc: 0.198 Test Loss: 2.370 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.0157406330108643
Epoch: 23, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.773 Vali Acc: 0.243 Test Loss: 2.773 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.9422101974487305
Epoch: 24, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.640 Vali Acc: 0.270 Test Loss: 2.640 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps103_str52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 37149700
model size : 156.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps103_str103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.575132369995117
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.416 Vali Acc: 0.232 Test Loss: 1.416 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 3.1106865406036377
Epoch: 2, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.518 Vali Acc: 0.232 Test Loss: 1.518 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8806416988372803
Epoch: 3, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.530 Vali Acc: 0.255 Test Loss: 1.530 Test Acc: 0.255
Validation loss decreased (-0.231925 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 2.924593925476074
Epoch: 4, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.540 Vali Acc: 0.228 Test Loss: 1.540 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8026366233825684
Epoch: 5, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.487 Vali Acc: 0.228 Test Loss: 1.487 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7271828651428223
Epoch: 6, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.633 Vali Acc: 0.240 Test Loss: 1.633 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6919703483581543
Epoch: 7, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.636 Vali Acc: 0.232 Test Loss: 1.636 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.392853021621704
Epoch: 8, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.868 Vali Acc: 0.240 Test Loss: 1.868 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.344388961791992
Epoch: 9, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.895 Vali Acc: 0.186 Test Loss: 1.895 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.766885757446289
Epoch: 10, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.760 Vali Acc: 0.228 Test Loss: 1.760 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7655937671661377
Epoch: 11, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.766 Vali Acc: 0.209 Test Loss: 1.766 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.559572219848633
Epoch: 12, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.182 Vali Acc: 0.228 Test Loss: 2.182 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.955519676208496
Epoch: 13, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.056 Vali Acc: 0.217 Test Loss: 2.056 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps103_str103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.25475285171102663
model parameter : 37080580
model size : 156.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps110_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.55119776725769
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.550 Vali Acc: 0.255 Test Loss: 1.550 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 5.924481153488159
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (-0.254737 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 5.481027841567993
Epoch: 3, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.647 Vali Acc: 0.232 Test Loss: 1.647 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.208161115646362
Epoch: 4, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.793 Vali Acc: 0.247 Test Loss: 1.793 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.701844215393066
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.484 Vali Acc: 0.289 Test Loss: 1.484 Test Acc: 0.289
Validation loss decreased (-0.266145 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 4.783288955688477
Epoch: 6, Steps: 17 | Train Loss: 1.323 Vali Loss: 2.010 Vali Acc: 0.240 Test Loss: 2.010 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.899557113647461
Epoch: 7, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.858 Vali Acc: 0.228 Test Loss: 1.858 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.0806474685668945
Epoch: 8, Steps: 17 | Train Loss: 1.233 Vali Loss: 2.214 Vali Acc: 0.243 Test Loss: 2.214 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.025100231170654
Epoch: 9, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.877 Vali Acc: 0.255 Test Loss: 1.877 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.319338321685791
Epoch: 10, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.891 Vali Acc: 0.274 Test Loss: 1.891 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.5868213176727295
Epoch: 11, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.825 Vali Acc: 0.285 Test Loss: 1.825 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.906784772872925
Epoch: 12, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.888 Vali Acc: 0.259 Test Loss: 1.888 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2840182781219482
Epoch: 13, Steps: 17 | Train Loss: 0.909 Vali Loss: 2.161 Vali Acc: 0.259 Test Loss: 2.161 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5272839069366455
Epoch: 14, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.552 Vali Acc: 0.228 Test Loss: 2.552 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.9445066452026367
Epoch: 15, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.438 Vali Acc: 0.262 Test Loss: 2.438 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps110_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 37322500
model size : 157.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps110_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7870752811431885
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.439 Vali Acc: 0.297 Test Loss: 1.439 Test Acc: 0.297
Validation loss decreased (inf --> -0.296564).  Saving model ...
Epoch: 2 cost time: 1.6831080913543701
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.466 Vali Acc: 0.293 Test Loss: 1.466 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.817864179611206
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.671 Vali Acc: 0.255 Test Loss: 1.671 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.733405351638794
Epoch: 4, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.687 Vali Acc: 0.255 Test Loss: 1.687 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6182663440704346
Epoch: 5, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.535 Vali Acc: 0.243 Test Loss: 1.535 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.535949230194092
Epoch: 6, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.911 Vali Acc: 0.243 Test Loss: 1.911 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7734696865081787
Epoch: 7, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.814 Vali Acc: 0.266 Test Loss: 1.814 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.585705280303955
Epoch: 8, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.766 Vali Acc: 0.262 Test Loss: 1.766 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.987731695175171
Epoch: 9, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.824 Vali Acc: 0.240 Test Loss: 1.824 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.727666139602661
Epoch: 10, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.848 Vali Acc: 0.232 Test Loss: 1.848 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4016952514648438
Epoch: 11, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.881 Vali Acc: 0.259 Test Loss: 1.881 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps110_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 37188868
model size : 156.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps110_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.071501970291138
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.436 Vali Acc: 0.259 Test Loss: 1.436 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.685520648956299
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.557 Vali Acc: 0.262 Test Loss: 1.557 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 2.3355631828308105
Epoch: 3, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.521 Vali Acc: 0.281 Test Loss: 1.521 Test Acc: 0.281
Validation loss decreased (-0.262342 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 2.428523302078247
Epoch: 4, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.511 Vali Acc: 0.255 Test Loss: 1.511 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.248274087905884
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.460 Vali Acc: 0.247 Test Loss: 1.460 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6826865673065186
Epoch: 6, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.566 Vali Acc: 0.240 Test Loss: 1.566 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5372369289398193
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.546 Vali Acc: 0.236 Test Loss: 1.546 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.793161153793335
Epoch: 8, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.636 Vali Acc: 0.247 Test Loss: 1.636 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5804846286773682
Epoch: 9, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.845 Vali Acc: 0.251 Test Loss: 1.845 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3550047874450684
Epoch: 10, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.766 Vali Acc: 0.266 Test Loss: 1.766 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1152477264404297
Epoch: 11, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.800 Vali Acc: 0.243 Test Loss: 1.800 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7750163078308105
Epoch: 12, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.771 Vali Acc: 0.274 Test Loss: 1.771 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.642216444015503
Epoch: 13, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.647 Vali Acc: 0.259 Test Loss: 1.647 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps110_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 37119748
model size : 156.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps117_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.3629677295684814
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.581 Vali Acc: 0.251 Test Loss: 1.581 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 4.016941547393799
Epoch: 2, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.487 Vali Acc: 0.232 Test Loss: 1.487 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.099468231201172
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.517 Vali Acc: 0.255 Test Loss: 1.517 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 4.5410778522491455
Epoch: 4, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.852 Vali Acc: 0.259 Test Loss: 1.852 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258537).  Saving model ...
Epoch: 5 cost time: 4.3474133014678955
Epoch: 5, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.664 Vali Acc: 0.243 Test Loss: 1.664 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.393721580505371
Epoch: 6, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.553 Vali Acc: 0.262 Test Loss: 1.553 Test Acc: 0.262
Validation loss decreased (-0.258537 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 3.842357873916626
Epoch: 7, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.641 Vali Acc: 0.232 Test Loss: 1.641 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5134658813476562
Epoch: 8, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.204 Vali Acc: 0.228 Test Loss: 2.204 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5475757122039795
Epoch: 9, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.684 Vali Acc: 0.270 Test Loss: 1.684 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269945).  Saving model ...
Epoch: 10 cost time: 2.5057432651519775
Epoch: 10, Steps: 17 | Train Loss: 1.043 Vali Loss: 2.139 Vali Acc: 0.270 Test Loss: 2.139 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8423244953155518
Epoch: 11, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.598 Vali Acc: 0.274 Test Loss: 1.598 Test Acc: 0.274
Validation loss decreased (-0.269945 --> -0.273748).  Saving model ...
Epoch: 12 cost time: 3.7372994422912598
Epoch: 12, Steps: 17 | Train Loss: 0.886 Vali Loss: 2.326 Vali Acc: 0.240 Test Loss: 2.326 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6627838611602783
Epoch: 13, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.489 Vali Acc: 0.297 Test Loss: 1.489 Test Acc: 0.297
Validation loss decreased (-0.273748 --> -0.296563).  Saving model ...
Epoch: 14 cost time: 3.8611366748809814
Epoch: 14, Steps: 17 | Train Loss: 0.992 Vali Loss: 2.032 Vali Acc: 0.266 Test Loss: 2.032 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1971330642700195
Epoch: 15, Steps: 17 | Train Loss: 0.964 Vali Loss: 2.082 Vali Acc: 0.251 Test Loss: 2.082 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1281356811523438
Epoch: 16, Steps: 17 | Train Loss: 0.806 Vali Loss: 3.067 Vali Acc: 0.243 Test Loss: 3.067 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.718813419342041
Epoch: 17, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.969 Vali Acc: 0.247 Test Loss: 1.969 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.154987573623657
Epoch: 18, Steps: 17 | Train Loss: 0.816 Vali Loss: 2.511 Vali Acc: 0.240 Test Loss: 2.511 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.605790376663208
Epoch: 19, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.686 Vali Acc: 0.243 Test Loss: 2.686 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7605841159820557
Epoch: 20, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.782 Vali Acc: 0.259 Test Loss: 2.782 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.9824001789093018
Epoch: 21, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.631 Vali Acc: 0.240 Test Loss: 2.631 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.552337408065796
Epoch: 22, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.698 Vali Acc: 0.236 Test Loss: 2.698 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.663021564483643
Epoch: 23, Steps: 17 | Train Loss: 0.632 Vali Loss: 3.426 Vali Acc: 0.251 Test Loss: 3.426 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps117_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 37352452
model size : 157.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps117_str59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.238572359085083
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.448 Vali Acc: 0.285 Test Loss: 1.448 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 2.5146303176879883
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.414 Vali Acc: 0.281 Test Loss: 1.414 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.02160382270813
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.719254732131958
Epoch: 4, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.517 Vali Acc: 0.228 Test Loss: 1.517 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7867655754089355
Epoch: 5, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.511 Vali Acc: 0.232 Test Loss: 1.511 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9303407669067383
Epoch: 6, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.536 Vali Acc: 0.221 Test Loss: 1.536 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4933533668518066
Epoch: 7, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.638 Vali Acc: 0.262 Test Loss: 1.638 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1218910217285156
Epoch: 8, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.797 Vali Acc: 0.278 Test Loss: 1.797 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7026333808898926
Epoch: 9, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.888 Vali Acc: 0.247 Test Loss: 1.888 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5935609340667725
Epoch: 10, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.964 Vali Acc: 0.217 Test Loss: 1.964 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.3472514152526855
Epoch: 11, Steps: 17 | Train Loss: 1.091 Vali Loss: 2.071 Vali Acc: 0.224 Test Loss: 2.071 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps117_str59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 37228036
model size : 156.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps117_str117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.2573230266571045
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.412 Vali Acc: 0.266 Test Loss: 1.412 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.389324426651001
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.425 Vali Acc: 0.278 Test Loss: 1.425 Test Acc: 0.278
Validation loss decreased (-0.266146 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.829089641571045
Epoch: 3, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.420 Vali Acc: 0.274 Test Loss: 1.420 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7016165256500244
Epoch: 4, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.511 Vali Acc: 0.270 Test Loss: 1.511 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0008151531219482
Epoch: 5, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8176963329315186
Epoch: 6, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.508 Vali Acc: 0.289 Test Loss: 1.508 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288958).  Saving model ...
Epoch: 7 cost time: 2.05446457862854
Epoch: 7, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.650 Vali Acc: 0.266 Test Loss: 1.650 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4316654205322266
Epoch: 8, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.518 Vali Acc: 0.259 Test Loss: 1.518 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4983599185943604
Epoch: 9, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.785 Vali Acc: 0.247 Test Loss: 1.785 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5896384716033936
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.746 Vali Acc: 0.243 Test Loss: 1.746 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6102066040039062
Epoch: 11, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.644 Vali Acc: 0.281 Test Loss: 1.644 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4239037036895752
Epoch: 12, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.119 Vali Acc: 0.255 Test Loss: 2.119 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.476841926574707
Epoch: 13, Steps: 17 | Train Loss: 1.024 Vali Loss: 2.143 Vali Acc: 0.255 Test Loss: 2.143 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7125599384307861
Epoch: 14, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.594 Vali Acc: 0.236 Test Loss: 1.594 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3710989952087402
Epoch: 15, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.735 Vali Acc: 0.259 Test Loss: 1.735 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0735092163085938
Epoch: 16, Steps: 17 | Train Loss: 0.855 Vali Loss: 2.079 Vali Acc: 0.209 Test Loss: 2.079 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps117_str117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 37163524
model size : 156.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps126_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.3847479820251465
Epoch: 1, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.623 Vali Acc: 0.266 Test Loss: 1.623 Test Acc: 0.266
Validation loss decreased (inf --> -0.266143).  Saving model ...
Epoch: 2 cost time: 3.5025620460510254
Epoch: 2, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.558 Vali Acc: 0.270 Test Loss: 1.558 Test Acc: 0.270
Validation loss decreased (-0.266143 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 1.798074722290039
Epoch: 3, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4014716148376465
Epoch: 4, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.521 Vali Acc: 0.262 Test Loss: 1.521 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3070154190063477
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.507 Vali Acc: 0.240 Test Loss: 1.507 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.397390127182007
Epoch: 6, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.997 Vali Acc: 0.255 Test Loss: 1.997 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.922307252883911
Epoch: 7, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.552 Vali Acc: 0.232 Test Loss: 1.552 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7427940368652344
Epoch: 8, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.606 Vali Acc: 0.255 Test Loss: 1.606 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.630368709564209
Epoch: 9, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.913 Vali Acc: 0.198 Test Loss: 1.913 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.4661941528320312
Epoch: 10, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.927 Vali Acc: 0.262 Test Loss: 1.927 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.477850914001465
Epoch: 11, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.932 Vali Acc: 0.251 Test Loss: 1.932 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.667285919189453
Epoch: 12, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.596 Vali Acc: 0.228 Test Loss: 2.596 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps126_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 37396228
model size : 157.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps126_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.547132968902588
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.406 Vali Acc: 0.243 Test Loss: 1.406 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 2.4115254878997803
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.482 Vali Acc: 0.251 Test Loss: 1.482 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 2.5635766983032227
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.535 Vali Acc: 0.259 Test Loss: 1.535 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258540).  Saving model ...
Epoch: 4 cost time: 2.344148874282837
Epoch: 4, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.638 Vali Acc: 0.274 Test Loss: 1.638 Test Acc: 0.274
Validation loss decreased (-0.258540 --> -0.273748).  Saving model ...
Epoch: 5 cost time: 2.590554714202881
Epoch: 5, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.485 Vali Acc: 0.262 Test Loss: 1.485 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.614328384399414
Epoch: 6, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.587 Vali Acc: 0.247 Test Loss: 1.587 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7573752403259277
Epoch: 7, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.684 Vali Acc: 0.228 Test Loss: 1.684 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2519776821136475
Epoch: 8, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.531 Vali Acc: 0.259 Test Loss: 1.531 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.921149253845215
Epoch: 9, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.840 Vali Acc: 0.224 Test Loss: 1.840 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.398277521133423
Epoch: 10, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.973 Vali Acc: 0.247 Test Loss: 1.973 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0950534343719482
Epoch: 11, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.079 Vali Acc: 0.236 Test Loss: 2.079 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.225531816482544
Epoch: 12, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.763 Vali Acc: 0.232 Test Loss: 1.763 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.086721420288086
Epoch: 13, Steps: 17 | Train Loss: 0.894 Vali Loss: 2.213 Vali Acc: 0.251 Test Loss: 2.213 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1283984184265137
Epoch: 14, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.079 Vali Acc: 0.240 Test Loss: 2.079 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps126_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 37281028
model size : 156.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps126_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7951276302337646
Epoch: 1, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.437 Vali Acc: 0.259 Test Loss: 1.437 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.6604740619659424
Epoch: 2, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.599 Vali Acc: 0.236 Test Loss: 1.599 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6268725395202637
Epoch: 3, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.455 Vali Acc: 0.247 Test Loss: 1.455 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5239183902740479
Epoch: 4, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.446 Vali Acc: 0.236 Test Loss: 1.446 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9280929565429688
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.505 Vali Acc: 0.217 Test Loss: 1.505 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7423171997070312
Epoch: 6, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.506 Vali Acc: 0.232 Test Loss: 1.506 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.930384635925293
Epoch: 7, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.640 Vali Acc: 0.243 Test Loss: 1.640 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6250014305114746
Epoch: 8, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.570 Vali Acc: 0.243 Test Loss: 1.570 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.851590633392334
Epoch: 9, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.705 Vali Acc: 0.262 Test Loss: 1.705 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262340).  Saving model ...
Epoch: 10 cost time: 1.8625235557556152
Epoch: 10, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.625 Vali Acc: 0.266 Test Loss: 1.625 Test Acc: 0.266
Validation loss decreased (-0.262340 --> -0.266143).  Saving model ...
Epoch: 11 cost time: 1.8146474361419678
Epoch: 11, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.720 Vali Acc: 0.243 Test Loss: 1.720 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8213317394256592
Epoch: 12, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.758 Vali Acc: 0.240 Test Loss: 1.758 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.665816068649292
Epoch: 13, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.910 Vali Acc: 0.247 Test Loss: 1.910 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.927332878112793
Epoch: 14, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.820 Vali Acc: 0.243 Test Loss: 1.820 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.864192247390747
Epoch: 15, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.866 Vali Acc: 0.255 Test Loss: 1.866 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9240267276763916
Epoch: 16, Steps: 17 | Train Loss: 0.872 Vali Loss: 2.468 Vali Acc: 0.247 Test Loss: 2.468 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8666338920593262
Epoch: 17, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.882 Vali Acc: 0.224 Test Loss: 1.882 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.016944169998169
Epoch: 18, Steps: 17 | Train Loss: 0.925 Vali Loss: 2.575 Vali Acc: 0.247 Test Loss: 2.575 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8065996170043945
Epoch: 19, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.099 Vali Acc: 0.251 Test Loss: 2.099 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7633967399597168
Epoch: 20, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.425 Vali Acc: 0.251 Test Loss: 2.425 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps126_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37221124
model size : 156.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps135_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.802644491195679
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.431 Vali Acc: 0.270 Test Loss: 1.431 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 2.9130232334136963
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.491 Vali Acc: 0.259 Test Loss: 1.491 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4369871616363525
Epoch: 3, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.464 Vali Acc: 0.236 Test Loss: 1.464 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6326489448547363
Epoch: 4, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.574 Vali Acc: 0.259 Test Loss: 1.574 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.210625410079956
Epoch: 5, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.597 Vali Acc: 0.255 Test Loss: 1.597 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7904410362243652
Epoch: 6, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.604 Vali Acc: 0.224 Test Loss: 1.604 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.680346727371216
Epoch: 7, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.581 Vali Acc: 0.243 Test Loss: 1.581 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.025995969772339
Epoch: 8, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.761 Vali Acc: 0.259 Test Loss: 1.761 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.65041446685791
Epoch: 9, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.771 Vali Acc: 0.281 Test Loss: 1.771 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281351).  Saving model ...
Epoch: 10 cost time: 3.2745893001556396
Epoch: 10, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.769 Vali Acc: 0.255 Test Loss: 1.769 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6114978790283203
Epoch: 11, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.274 Vali Acc: 0.232 Test Loss: 2.274 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.176340103149414
Epoch: 12, Steps: 17 | Train Loss: 1.039 Vali Loss: 2.237 Vali Acc: 0.243 Test Loss: 2.237 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.253575325012207
Epoch: 13, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.941 Vali Acc: 0.236 Test Loss: 1.941 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4796288013458252
Epoch: 14, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.187 Vali Acc: 0.213 Test Loss: 2.187 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1977734565734863
Epoch: 15, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.967 Vali Acc: 0.247 Test Loss: 1.967 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3953254222869873
Epoch: 16, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.790 Vali Acc: 0.228 Test Loss: 2.790 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5505576133728027
Epoch: 17, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.953 Vali Acc: 0.251 Test Loss: 2.953 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.5893898010253906
Epoch: 18, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.315 Vali Acc: 0.232 Test Loss: 2.315 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.874643325805664
Epoch: 19, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.677 Vali Acc: 0.236 Test Loss: 2.677 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps135_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 37444612
model size : 157.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.790341377258301
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.483 Vali Acc: 0.262 Test Loss: 1.483 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.3241488933563232
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.530 Vali Acc: 0.259 Test Loss: 1.530 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7474923133850098
Epoch: 3, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.499 Vali Acc: 0.266 Test Loss: 1.499 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 3.0582315921783447
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.742 Vali Acc: 0.255 Test Loss: 1.742 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0048229694366455
Epoch: 5, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3392622470855713
Epoch: 6, Steps: 17 | Train Loss: 1.199 Vali Loss: 2.015 Vali Acc: 0.232 Test Loss: 2.015 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8829782009124756
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.540428638458252
Epoch: 8, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.650 Vali Acc: 0.247 Test Loss: 1.650 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5251877307891846
Epoch: 9, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.655 Vali Acc: 0.224 Test Loss: 1.655 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.259810209274292
Epoch: 10, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.282 Vali Acc: 0.240 Test Loss: 2.282 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1203150749206543
Epoch: 11, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.722 Vali Acc: 0.224 Test Loss: 1.722 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8850271701812744
Epoch: 12, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.907 Vali Acc: 0.247 Test Loss: 1.907 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8488707542419434
Epoch: 13, Steps: 17 | Train Loss: 1.036 Vali Loss: 2.000 Vali Acc: 0.251 Test Loss: 2.000 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37334020
model size : 157.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps135_str135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.2653703689575195
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.447 Vali Acc: 0.266 Test Loss: 1.447 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 1.7167003154754639
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.475 Vali Acc: 0.281 Test Loss: 1.475 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 1.808396816253662
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.436 Vali Acc: 0.281 Test Loss: 1.436 Test Acc: 0.281
Validation loss decreased (-0.281354 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.8947443962097168
Epoch: 4, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5759387016296387
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2815566062927246
Epoch: 6, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.518 Vali Acc: 0.270 Test Loss: 1.518 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.706805944442749
Epoch: 7, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.610 Vali Acc: 0.232 Test Loss: 1.610 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4332199096679688
Epoch: 8, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.015 Vali Acc: 0.224 Test Loss: 2.015 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7203102111816406
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.682 Vali Acc: 0.259 Test Loss: 1.682 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4676403999328613
Epoch: 10, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.621 Vali Acc: 0.247 Test Loss: 1.621 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0382678508758545
Epoch: 11, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.789 Vali Acc: 0.243 Test Loss: 1.789 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5722084045410156
Epoch: 12, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.901 Vali Acc: 0.270 Test Loss: 1.901 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4153029918670654
Epoch: 13, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.841 Vali Acc: 0.240 Test Loss: 1.841 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps135_str135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 37278724
model size : 156.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps146_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.153077602386475
Epoch: 1, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.578 Vali Acc: 0.240 Test Loss: 1.578 Test Acc: 0.240
Validation loss decreased (inf --> -0.239528).  Saving model ...
Epoch: 2 cost time: 3.5146777629852295
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.499 Vali Acc: 0.255 Test Loss: 1.499 Test Acc: 0.255
Validation loss decreased (-0.239528 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 2.863349676132202
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
Validation loss decreased (-0.254738 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 2.3515965938568115
Epoch: 4, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.527 Vali Acc: 0.232 Test Loss: 1.527 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.31585693359375
Epoch: 5, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.634 Vali Acc: 0.262 Test Loss: 1.634 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262341).  Saving model ...
Epoch: 6 cost time: 3.0091075897216797
Epoch: 6, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.649 Vali Acc: 0.243 Test Loss: 1.649 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1270101070404053
Epoch: 7, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.833 Vali Acc: 0.243 Test Loss: 1.833 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5250182151794434
Epoch: 8, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.674 Vali Acc: 0.251 Test Loss: 1.674 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3413665294647217
Epoch: 9, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.671 Vali Acc: 0.266 Test Loss: 1.671 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266143).  Saving model ...
Epoch: 10 cost time: 3.452850818634033
Epoch: 10, Steps: 17 | Train Loss: 1.000 Vali Loss: 2.004 Vali Acc: 0.247 Test Loss: 2.004 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7996866703033447
Epoch: 11, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.957 Vali Acc: 0.240 Test Loss: 1.957 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.136015176773071
Epoch: 12, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.879 Vali Acc: 0.251 Test Loss: 1.879 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4792582988739014
Epoch: 13, Steps: 17 | Train Loss: 0.867 Vali Loss: 2.240 Vali Acc: 0.224 Test Loss: 2.240 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.014877796173096
Epoch: 14, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.032 Vali Acc: 0.251 Test Loss: 2.032 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2677674293518066
Epoch: 15, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.524 Vali Acc: 0.232 Test Loss: 2.524 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.7089130878448486
Epoch: 16, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.124 Vali Acc: 0.217 Test Loss: 2.124 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5804998874664307
Epoch: 17, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.491 Vali Acc: 0.243 Test Loss: 2.491 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.820122241973877
Epoch: 18, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.511 Vali Acc: 0.262 Test Loss: 2.511 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.889082908630371
Epoch: 19, Steps: 17 | Train Loss: 0.779 Vali Loss: 2.445 Vali Acc: 0.251 Test Loss: 2.445 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps146_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37502212
model size : 157.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps146_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.317310571670532
Epoch: 1, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.501 Vali Acc: 0.247 Test Loss: 1.501 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 2.629232883453369
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.539 Vali Acc: 0.262 Test Loss: 1.539 Test Acc: 0.262
Validation loss decreased (-0.247133 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 2.702080011367798
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.576 Vali Acc: 0.259 Test Loss: 1.576 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5017333030700684
Epoch: 4, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.467 Vali Acc: 0.228 Test Loss: 1.467 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.421710252761841
Epoch: 5, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.532 Vali Acc: 0.221 Test Loss: 1.532 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1890392303466797
Epoch: 6, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.507 Vali Acc: 0.262 Test Loss: 1.507 Test Acc: 0.262
Validation loss decreased (-0.262342 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 2.421645402908325
Epoch: 7, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.564 Vali Acc: 0.266 Test Loss: 1.564 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266144).  Saving model ...
Epoch: 8 cost time: 2.7661690711975098
Epoch: 8, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.556 Vali Acc: 0.224 Test Loss: 1.556 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.556960344314575
Epoch: 9, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.725 Vali Acc: 0.236 Test Loss: 1.725 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8428211212158203
Epoch: 10, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.817 Vali Acc: 0.243 Test Loss: 1.817 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4109981060028076
Epoch: 11, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.751 Vali Acc: 0.202 Test Loss: 1.751 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.324038028717041
Epoch: 12, Steps: 17 | Train Loss: 0.930 Vali Loss: 2.015 Vali Acc: 0.232 Test Loss: 2.015 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5025694370269775
Epoch: 13, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.102 Vali Acc: 0.262 Test Loss: 2.102 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3353307247161865
Epoch: 14, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.037 Vali Acc: 0.262 Test Loss: 2.037 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.290489673614502
Epoch: 15, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.965 Vali Acc: 0.232 Test Loss: 1.965 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.074254035949707
Epoch: 16, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.260 Vali Acc: 0.221 Test Loss: 2.260 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9454751014709473
Epoch: 17, Steps: 17 | Train Loss: 0.849 Vali Loss: 2.202 Vali Acc: 0.259 Test Loss: 2.202 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps146_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37400836
model size : 157.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps146_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.319103479385376
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.447 Vali Acc: 0.240 Test Loss: 1.447 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.7397644519805908
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.491 Vali Acc: 0.251 Test Loss: 1.491 Test Acc: 0.251
Validation loss decreased (-0.239529 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.9075567722320557
Epoch: 3, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.518 Vali Acc: 0.270 Test Loss: 1.518 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 1.6143312454223633
Epoch: 4, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.645 Vali Acc: 0.224 Test Loss: 1.645 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9938459396362305
Epoch: 5, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.688 Vali Acc: 0.274 Test Loss: 1.688 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273747).  Saving model ...
Epoch: 6 cost time: 2.1789331436157227
Epoch: 6, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.682 Vali Acc: 0.274 Test Loss: 1.682 Test Acc: 0.274
Validation loss decreased (-0.273747 --> -0.273747).  Saving model ...
Epoch: 7 cost time: 2.0153119564056396
Epoch: 7, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.744 Vali Acc: 0.262 Test Loss: 1.744 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6966311931610107
Epoch: 8, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.660 Vali Acc: 0.243 Test Loss: 1.660 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.940927505493164
Epoch: 9, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.737 Vali Acc: 0.202 Test Loss: 1.737 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.271019458770752
Epoch: 10, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.762 Vali Acc: 0.221 Test Loss: 1.762 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4898662567138672
Epoch: 11, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.785 Vali Acc: 0.221 Test Loss: 1.785 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9635827541351318
Epoch: 12, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.380 Vali Acc: 0.221 Test Loss: 2.380 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9515883922576904
Epoch: 13, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.962 Vali Acc: 0.217 Test Loss: 1.962 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8455479145050049
Epoch: 14, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.890 Vali Acc: 0.232 Test Loss: 1.890 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.340226411819458
Epoch: 15, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.911 Vali Acc: 0.259 Test Loss: 1.911 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0746989250183105
Epoch: 16, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.270 Vali Acc: 0.247 Test Loss: 2.270 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps146_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 37350148
model size : 157.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps160_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.2524542808532715
Epoch: 1, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.549 Vali Acc: 0.247 Test Loss: 1.549 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 3.266019582748413
Epoch: 2, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.453 Vali Acc: 0.262 Test Loss: 1.453 Test Acc: 0.262
Validation loss decreased (-0.247133 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 3.3926382064819336
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.522 Vali Acc: 0.255 Test Loss: 1.522 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.208636522293091
Epoch: 4, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.497 Vali Acc: 0.262 Test Loss: 1.497 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9957990646362305
Epoch: 5, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.526 Vali Acc: 0.240 Test Loss: 1.526 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0565640926361084
Epoch: 6, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.554 Vali Acc: 0.270 Test Loss: 1.554 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269946).  Saving model ...
Epoch: 7 cost time: 3.2817578315734863
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.844 Vali Acc: 0.236 Test Loss: 1.844 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7248616218566895
Epoch: 8, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.728 Vali Acc: 0.243 Test Loss: 1.728 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.482868194580078
Epoch: 9, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.667 Vali Acc: 0.243 Test Loss: 1.667 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6564340591430664
Epoch: 10, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.934 Vali Acc: 0.262 Test Loss: 1.934 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.462811231613159
Epoch: 11, Steps: 17 | Train Loss: 1.002 Vali Loss: 2.113 Vali Acc: 0.217 Test Loss: 2.113 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7915303707122803
Epoch: 12, Steps: 17 | Train Loss: 1.052 Vali Loss: 2.281 Vali Acc: 0.243 Test Loss: 2.281 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.117060661315918
Epoch: 13, Steps: 17 | Train Loss: 1.058 Vali Loss: 2.507 Vali Acc: 0.221 Test Loss: 2.507 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.453094959259033
Epoch: 14, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.970 Vali Acc: 0.232 Test Loss: 1.970 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.461458683013916
Epoch: 15, Steps: 17 | Train Loss: 1.066 Vali Loss: 2.014 Vali Acc: 0.243 Test Loss: 2.014 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6555850505828857
Epoch: 16, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.710 Vali Acc: 0.232 Test Loss: 2.710 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps160_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 37580548
model size : 158.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.240460157394409
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.470 Vali Acc: 0.259 Test Loss: 1.470 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 3.092820882797241
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.464 Vali Acc: 0.255 Test Loss: 1.464 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.000276803970337
Epoch: 3, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.548 Vali Acc: 0.270 Test Loss: 1.548 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 2.568295955657959
Epoch: 4, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.512 Vali Acc: 0.221 Test Loss: 1.512 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.47507643699646
Epoch: 5, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.634 Vali Acc: 0.221 Test Loss: 1.634 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1051483154296875
Epoch: 6, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.691 Vali Acc: 0.255 Test Loss: 1.691 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5727052688598633
Epoch: 7, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.674 Vali Acc: 0.274 Test Loss: 1.674 Test Acc: 0.274
Validation loss decreased (-0.269946 --> -0.273748).  Saving model ...
Epoch: 8 cost time: 2.165766954421997
Epoch: 8, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.711 Vali Acc: 0.274 Test Loss: 1.711 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3454859256744385
Epoch: 9, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.802 Vali Acc: 0.247 Test Loss: 1.802 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.104290723800659
Epoch: 10, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.695 Vali Acc: 0.255 Test Loss: 1.695 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4114818572998047
Epoch: 11, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.669 Vali Acc: 0.209 Test Loss: 1.669 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.282076120376587
Epoch: 12, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.001 Vali Acc: 0.243 Test Loss: 2.001 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1783862113952637
Epoch: 13, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.988 Vali Acc: 0.232 Test Loss: 1.988 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3118276596069336
Epoch: 14, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.719 Vali Acc: 0.243 Test Loss: 1.719 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5960006713867188
Epoch: 15, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.885 Vali Acc: 0.251 Test Loss: 1.885 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4856348037719727
Epoch: 16, Steps: 17 | Train Loss: 0.847 Vali Loss: 2.028 Vali Acc: 0.236 Test Loss: 2.028 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.060760736465454
Epoch: 17, Steps: 17 | Train Loss: 0.981 Vali Loss: 2.826 Vali Acc: 0.240 Test Loss: 2.826 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 37488388
model size : 157.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps160_str160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.458580255508423
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.414 Vali Acc: 0.255 Test Loss: 1.414 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.5228817462921143
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.520 Vali Acc: 0.278 Test Loss: 1.520 Test Acc: 0.278
Validation loss decreased (-0.254739 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 1.6101477146148682
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.432 Vali Acc: 0.228 Test Loss: 1.432 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7726707458496094
Epoch: 4, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.475 Vali Acc: 0.259 Test Loss: 1.475 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8106625080108643
Epoch: 5, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.822 Vali Acc: 0.209 Test Loss: 1.822 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8335816860198975
Epoch: 6, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.481 Vali Acc: 0.243 Test Loss: 1.481 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7837183475494385
Epoch: 7, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.603 Vali Acc: 0.209 Test Loss: 1.603 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.686218023300171
Epoch: 8, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.639 Vali Acc: 0.232 Test Loss: 1.639 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7264184951782227
Epoch: 9, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.685 Vali Acc: 0.236 Test Loss: 1.685 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.730553388595581
Epoch: 10, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.637 Vali Acc: 0.236 Test Loss: 1.637 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5745344161987305
Epoch: 11, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.875 Vali Acc: 0.255 Test Loss: 1.875 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.367663860321045
Epoch: 12, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.953 Vali Acc: 0.198 Test Loss: 1.953 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps160_str160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 37442308
model size : 157.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps176_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.637417316436768
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.745 Vali Acc: 0.255 Test Loss: 1.745 Test Acc: 0.255
Validation loss decreased (inf --> -0.254735).  Saving model ...
Epoch: 2 cost time: 2.5853679180145264
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.459 Vali Acc: 0.259 Test Loss: 1.459 Test Acc: 0.259
Validation loss decreased (-0.254735 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 2.917065143585205
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.471 Vali Acc: 0.266 Test Loss: 1.471 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 2.6765315532684326
Epoch: 4, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.830 Vali Acc: 0.240 Test Loss: 1.830 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6212542057037354
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.692 Vali Acc: 0.232 Test Loss: 1.692 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8710136413574219
Epoch: 6, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.636 Vali Acc: 0.270 Test Loss: 1.636 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269946).  Saving model ...
Epoch: 7 cost time: 2.855348587036133
Epoch: 7, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.751 Vali Acc: 0.255 Test Loss: 1.751 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4013476371765137
Epoch: 8, Steps: 17 | Train Loss: 1.053 Vali Loss: 2.125 Vali Acc: 0.270 Test Loss: 2.125 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5419788360595703
Epoch: 9, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.958 Vali Acc: 0.251 Test Loss: 1.958 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.114757537841797
Epoch: 10, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.839 Vali Acc: 0.228 Test Loss: 1.839 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.733696460723877
Epoch: 11, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.757 Vali Acc: 0.259 Test Loss: 1.757 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.550295829772949
Epoch: 12, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.900 Vali Acc: 0.240 Test Loss: 1.900 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8291149139404297
Epoch: 13, Steps: 17 | Train Loss: 1.038 Vali Loss: 2.706 Vali Acc: 0.240 Test Loss: 2.706 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8917315006256104
Epoch: 14, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.942 Vali Acc: 0.251 Test Loss: 1.942 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7260613441467285
Epoch: 15, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.867 Vali Acc: 0.266 Test Loss: 1.867 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2636466026306152
Epoch: 16, Steps: 17 | Train Loss: 0.967 Vali Loss: 2.214 Vali Acc: 0.243 Test Loss: 2.214 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps176_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 37672708
model size : 158.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.0409369468688965
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.493 Vali Acc: 0.247 Test Loss: 1.493 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 2.279710292816162
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.405 Vali Acc: 0.236 Test Loss: 1.405 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3937039375305176
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.575 Vali Acc: 0.224 Test Loss: 1.575 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.048886775970459
Epoch: 4, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.707 Vali Acc: 0.247 Test Loss: 1.707 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.123690366744995
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.585 Vali Acc: 0.228 Test Loss: 1.585 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.136823892593384
Epoch: 6, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.713 Vali Acc: 0.240 Test Loss: 1.713 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9479148387908936
Epoch: 7, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.611 Vali Acc: 0.240 Test Loss: 1.611 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5097949504852295
Epoch: 8, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.675 Vali Acc: 0.251 Test Loss: 1.675 Test Acc: 0.251
Validation loss decreased (-0.247133 --> -0.250934).  Saving model ...
Epoch: 9 cost time: 2.3704395294189453
Epoch: 9, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.849 Vali Acc: 0.240 Test Loss: 1.849 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8999896049499512
Epoch: 10, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.805 Vali Acc: 0.251 Test Loss: 1.805 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.77003812789917
Epoch: 11, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.899 Vali Acc: 0.278 Test Loss: 1.899 Test Acc: 0.278
Validation loss decreased (-0.250934 --> -0.277548).  Saving model ...
Epoch: 12 cost time: 1.672919511795044
Epoch: 12, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.847 Vali Acc: 0.285 Test Loss: 1.847 Test Acc: 0.285
Validation loss decreased (-0.277548 --> -0.285153).  Saving model ...
Epoch: 13 cost time: 1.4847192764282227
Epoch: 13, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.923 Vali Acc: 0.236 Test Loss: 1.923 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1133337020874023
Epoch: 14, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.040 Vali Acc: 0.224 Test Loss: 2.040 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5750701427459717
Epoch: 15, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.812 Vali Acc: 0.297 Test Loss: 1.812 Test Acc: 0.297
Validation loss decreased (-0.285153 --> -0.296560).  Saving model ...
Epoch: 16 cost time: 2.5793490409851074
Epoch: 16, Steps: 17 | Train Loss: 1.028 Vali Loss: 2.004 Vali Acc: 0.243 Test Loss: 2.004 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.478286027908325
Epoch: 17, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.932 Vali Acc: 0.255 Test Loss: 1.932 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1733903884887695
Epoch: 18, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.137 Vali Acc: 0.236 Test Loss: 2.137 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8504209518432617
Epoch: 19, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.279 Vali Acc: 0.240 Test Loss: 2.279 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9947426319122314
Epoch: 20, Steps: 17 | Train Loss: 0.844 Vali Loss: 2.001 Vali Acc: 0.243 Test Loss: 2.001 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.389364242553711
Epoch: 21, Steps: 17 | Train Loss: 0.788 Vali Loss: 2.180 Vali Acc: 0.274 Test Loss: 2.180 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0368762016296387
Epoch: 22, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.052 Vali Acc: 0.247 Test Loss: 2.052 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2277307510375977
Epoch: 23, Steps: 17 | Train Loss: 0.716 Vali Loss: 2.472 Vali Acc: 0.240 Test Loss: 2.472 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3461310863494873
Epoch: 24, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.612 Vali Acc: 0.247 Test Loss: 2.612 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1137497425079346
Epoch: 25, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.469 Vali Acc: 0.228 Test Loss: 2.469 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 37589764
model size : 158.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps176_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9884557723999023
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.427 Vali Acc: 0.236 Test Loss: 1.427 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.4889729022979736
Epoch: 2, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.415 Vali Acc: 0.266 Test Loss: 1.415 Test Acc: 0.266
Validation loss decreased (-0.235727 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 1.604370355606079
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.528 Vali Acc: 0.247 Test Loss: 1.528 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6031897068023682
Epoch: 4, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.487 Vali Acc: 0.266 Test Loss: 1.487 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.759030818939209
Epoch: 5, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.764 Vali Acc: 0.266 Test Loss: 1.764 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8573250770568848
Epoch: 6, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.638 Vali Acc: 0.262 Test Loss: 1.638 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.487173318862915
Epoch: 7, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2897846698760986
Epoch: 8, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.714 Vali Acc: 0.232 Test Loss: 1.714 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5367486476898193
Epoch: 9, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.829 Vali Acc: 0.240 Test Loss: 1.829 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6856610774993896
Epoch: 10, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.579 Vali Acc: 0.205 Test Loss: 1.579 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6966123580932617
Epoch: 11, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.872 Vali Acc: 0.255 Test Loss: 1.872 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.568157434463501
Epoch: 12, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.838 Vali Acc: 0.240 Test Loss: 1.838 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps176_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 37548292
model size : 157.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps195_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.812232494354248
Epoch: 1, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.434 Vali Acc: 0.281 Test Loss: 1.434 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 2.9606101512908936
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5911641120910645
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.378812789916992
Epoch: 4, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.524 Vali Acc: 0.251 Test Loss: 1.524 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.398932456970215
Epoch: 5, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.477 Vali Acc: 0.240 Test Loss: 1.477 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.427387237548828
Epoch: 6, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.446 Vali Acc: 0.266 Test Loss: 1.446 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7986445426940918
Epoch: 7, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.534 Vali Acc: 0.262 Test Loss: 1.534 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1553568840026855
Epoch: 8, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.640 Vali Acc: 0.236 Test Loss: 1.640 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6021554470062256
Epoch: 9, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.694 Vali Acc: 0.236 Test Loss: 1.694 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2004008293151855
Epoch: 10, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.818 Vali Acc: 0.270 Test Loss: 1.818 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9129455089569092
Epoch: 11, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.969 Vali Acc: 0.251 Test Loss: 1.969 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps195_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 37785604
model size : 158.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps195_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.386781930923462
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.452 Vali Acc: 0.255 Test Loss: 1.452 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 2.099817991256714
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.467 Vali Acc: 0.270 Test Loss: 1.467 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 1.6093227863311768
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.441 Vali Acc: 0.281 Test Loss: 1.441 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.580895185470581
Epoch: 4, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.428 Vali Acc: 0.236 Test Loss: 1.428 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3508269786834717
Epoch: 5, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.496 Vali Acc: 0.251 Test Loss: 1.496 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7325224876403809
Epoch: 6, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.439 Vali Acc: 0.270 Test Loss: 1.439 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.126223087310791
Epoch: 7, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.522 Vali Acc: 0.255 Test Loss: 1.522 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9356720447540283
Epoch: 8, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.498 Vali Acc: 0.255 Test Loss: 1.498 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3744089603424072
Epoch: 9, Steps: 17 | Train Loss: 1.081 Vali Loss: 2.010 Vali Acc: 0.255 Test Loss: 2.010 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.050657033920288
Epoch: 10, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.535 Vali Acc: 0.240 Test Loss: 1.535 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.823746681213379
Epoch: 11, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.620 Vali Acc: 0.281 Test Loss: 1.620 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.910275936126709
Epoch: 12, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.931 Vali Acc: 0.232 Test Loss: 1.931 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5429039001464844
Epoch: 13, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.721 Vali Acc: 0.251 Test Loss: 1.721 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps195_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 37711876
model size : 158.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps195_str195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.153569221496582
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.432 Vali Acc: 0.247 Test Loss: 1.432 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.6245243549346924
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.443 Vali Acc: 0.236 Test Loss: 1.443 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6348702907562256
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.432 Vali Acc: 0.213 Test Loss: 1.432 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5266742706298828
Epoch: 4, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.484 Vali Acc: 0.251 Test Loss: 1.484 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250936).  Saving model ...
Epoch: 5 cost time: 1.676682710647583
Epoch: 5, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.608 Vali Acc: 0.274 Test Loss: 1.608 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273748).  Saving model ...
Epoch: 6 cost time: 1.6598453521728516
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.545 Vali Acc: 0.251 Test Loss: 1.545 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5824434757232666
Epoch: 7, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.531 Vali Acc: 0.240 Test Loss: 1.531 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7823657989501953
Epoch: 8, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6977357864379883
Epoch: 9, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.629 Vali Acc: 0.259 Test Loss: 1.629 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6291334629058838
Epoch: 10, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.603 Vali Acc: 0.255 Test Loss: 1.603 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6454253196716309
Epoch: 11, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.804 Vali Acc: 0.243 Test Loss: 1.804 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5977740287780762
Epoch: 12, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.713 Vali Acc: 0.251 Test Loss: 1.713 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.985365867614746
Epoch: 13, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.832 Vali Acc: 0.240 Test Loss: 1.832 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0130722522735596
Epoch: 14, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.710 Vali Acc: 0.266 Test Loss: 1.710 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1992506980895996
Epoch: 15, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.950 Vali Acc: 0.240 Test Loss: 1.950 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps195_str195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 37675012
model size : 158.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps219_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.844844341278076
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 2.1358394622802734
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.459 Vali Acc: 0.243 Test Loss: 1.459 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6023263931274414
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.579 Vali Acc: 0.274 Test Loss: 1.579 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273748).  Saving model ...
Epoch: 4 cost time: 1.7699534893035889
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.616 Vali Acc: 0.266 Test Loss: 1.616 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8086225986480713
Epoch: 5, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.677 Vali Acc: 0.232 Test Loss: 1.677 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2993571758270264
Epoch: 6, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.695 Vali Acc: 0.278 Test Loss: 1.695 Test Acc: 0.278
Validation loss decreased (-0.273748 --> -0.277550).  Saving model ...
Epoch: 7 cost time: 2.090862512588501
Epoch: 7, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.823 Vali Acc: 0.259 Test Loss: 1.823 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.320343494415283
Epoch: 8, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.652 Vali Acc: 0.228 Test Loss: 1.652 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0713303089141846
Epoch: 9, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.759 Vali Acc: 0.255 Test Loss: 1.759 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.82388973236084
Epoch: 10, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.828 Vali Acc: 0.243 Test Loss: 1.828 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2143354415893555
Epoch: 11, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.793 Vali Acc: 0.228 Test Loss: 1.793 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.312487840652466
Epoch: 12, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.994 Vali Acc: 0.259 Test Loss: 1.994 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9940085411071777
Epoch: 13, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.188 Vali Acc: 0.243 Test Loss: 2.188 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5661158561706543
Epoch: 14, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.972 Vali Acc: 0.224 Test Loss: 1.972 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5727570056915283
Epoch: 15, Steps: 17 | Train Loss: 0.960 Vali Loss: 2.070 Vali Acc: 0.255 Test Loss: 2.070 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3793041706085205
Epoch: 16, Steps: 17 | Train Loss: 0.826 Vali Loss: 2.194 Vali Acc: 0.247 Test Loss: 2.194 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps219_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 37933060
model size : 159.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps219_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.516102313995361
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.424 Vali Acc: 0.262 Test Loss: 1.424 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.9447615146636963
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.501 Vali Acc: 0.270 Test Loss: 1.501 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 1.9319195747375488
Epoch: 3, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.432 Vali Acc: 0.266 Test Loss: 1.432 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9956939220428467
Epoch: 4, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.467 Vali Acc: 0.304 Test Loss: 1.467 Test Acc: 0.304
Validation loss decreased (-0.269947 --> -0.304168).  Saving model ...
Epoch: 5 cost time: 2.2157721519470215
Epoch: 5, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.551 Vali Acc: 0.274 Test Loss: 1.551 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.184478282928467
Epoch: 6, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.636 Vali Acc: 0.274 Test Loss: 1.636 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2173972129821777
Epoch: 7, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.633 Vali Acc: 0.270 Test Loss: 1.633 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8995709419250488
Epoch: 8, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.605 Vali Acc: 0.236 Test Loss: 1.605 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.678156852722168
Epoch: 9, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.692 Vali Acc: 0.247 Test Loss: 1.692 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9910829067230225
Epoch: 10, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.823 Vali Acc: 0.243 Test Loss: 1.823 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0935139656066895
Epoch: 11, Steps: 17 | Train Loss: 1.063 Vali Loss: 2.156 Vali Acc: 0.243 Test Loss: 2.156 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9644079208374023
Epoch: 12, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.755 Vali Acc: 0.205 Test Loss: 1.755 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8014965057373047
Epoch: 13, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.687 Vali Acc: 0.259 Test Loss: 1.687 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9525797367095947
Epoch: 14, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.986 Vali Acc: 0.228 Test Loss: 1.986 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps219_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 37868548
model size : 159.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps219_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.709266185760498
Epoch: 1, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.439 Vali Acc: 0.274 Test Loss: 1.439 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.750922679901123
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.461 Vali Acc: 0.259 Test Loss: 1.461 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4502172470092773
Epoch: 3, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.452 Vali Acc: 0.278 Test Loss: 1.452 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.3200066089630127
Epoch: 4, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.464 Vali Acc: 0.243 Test Loss: 1.464 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.370337963104248
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.662 Vali Acc: 0.243 Test Loss: 1.662 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5436444282531738
Epoch: 6, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.514 Vali Acc: 0.259 Test Loss: 1.514 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2075998783111572
Epoch: 7, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.547 Vali Acc: 0.251 Test Loss: 1.547 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.423227071762085
Epoch: 8, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.750 Vali Acc: 0.259 Test Loss: 1.750 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6509735584259033
Epoch: 9, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.660 Vali Acc: 0.243 Test Loss: 1.660 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7446866035461426
Epoch: 10, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.803 Vali Acc: 0.243 Test Loss: 1.803 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4473683834075928
Epoch: 11, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.743 Vali Acc: 0.221 Test Loss: 1.743 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.863121509552002
Epoch: 12, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.018 Vali Acc: 0.224 Test Loss: 2.018 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7595012187957764
Epoch: 13, Steps: 17 | Train Loss: 1.064 Vali Loss: 2.013 Vali Acc: 0.217 Test Loss: 2.013 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps219_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 37836292
model size : 159.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps251_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.687811851501465
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.437 Vali Acc: 0.255 Test Loss: 1.437 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 2.2026941776275635
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.473 Vali Acc: 0.232 Test Loss: 1.473 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1709346771240234
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.556 Vali Acc: 0.270 Test Loss: 1.556 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 1.9371864795684814
Epoch: 4, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.504 Vali Acc: 0.209 Test Loss: 1.504 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.273481607437134
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.450 Vali Acc: 0.217 Test Loss: 1.450 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.195262908935547
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.713 Vali Acc: 0.247 Test Loss: 1.713 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.369542360305786
Epoch: 7, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.482 Vali Acc: 0.259 Test Loss: 1.482 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2444968223571777
Epoch: 8, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.868 Vali Acc: 0.266 Test Loss: 1.868 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1744744777679443
Epoch: 9, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.660 Vali Acc: 0.228 Test Loss: 1.660 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2262516021728516
Epoch: 10, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.993 Vali Acc: 0.266 Test Loss: 1.993 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5492358207702637
Epoch: 11, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.802 Vali Acc: 0.259 Test Loss: 1.802 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.504336357116699
Epoch: 12, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.749 Vali Acc: 0.209 Test Loss: 1.749 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9256532192230225
Epoch: 13, Steps: 17 | Train Loss: 1.040 Vali Loss: 2.061 Vali Acc: 0.243 Test Loss: 2.061 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps251_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 38135812
model size : 160.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps251_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.084237337112427
Epoch: 1, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.473 Vali Acc: 0.262 Test Loss: 1.473 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.91695237159729
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.449 Vali Acc: 0.243 Test Loss: 1.449 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9812142848968506
Epoch: 3, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.457 Vali Acc: 0.262 Test Loss: 1.457 Test Acc: 0.262
Validation loss decreased (-0.262343 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.924079418182373
Epoch: 4, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.586 Vali Acc: 0.278 Test Loss: 1.586 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 2.1855597496032715
Epoch: 5, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.966 Vali Acc: 0.224 Test Loss: 1.966 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0171852111816406
Epoch: 6, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.640 Vali Acc: 0.247 Test Loss: 1.640 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.042825222015381
Epoch: 7, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.729 Vali Acc: 0.259 Test Loss: 1.729 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7258579730987549
Epoch: 8, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.564 Vali Acc: 0.262 Test Loss: 1.564 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.530684232711792
Epoch: 9, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.925 Vali Acc: 0.255 Test Loss: 1.925 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5199060440063477
Epoch: 10, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.555 Vali Acc: 0.232 Test Loss: 1.555 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.871201753616333
Epoch: 11, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.923 Vali Acc: 0.243 Test Loss: 1.923 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8090837001800537
Epoch: 12, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.857 Vali Acc: 0.278 Test Loss: 1.857 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9460549354553223
Epoch: 13, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.157 Vali Acc: 0.262 Test Loss: 2.157 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8819444179534912
Epoch: 14, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.763 Vali Acc: 0.232 Test Loss: 1.763 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps251_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 38080516
model size : 159.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps251_str251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.475830078125
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.3988802433013916
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.473 Vali Acc: 0.228 Test Loss: 1.473 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.476940393447876
Epoch: 3, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.554 Vali Acc: 0.251 Test Loss: 1.554 Test Acc: 0.251
Validation loss decreased (-0.243332 --> -0.250935).  Saving model ...
Epoch: 4 cost time: 1.626152753829956
Epoch: 4, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.485 Vali Acc: 0.217 Test Loss: 1.485 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6580097675323486
Epoch: 5, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.639 Vali Acc: 0.232 Test Loss: 1.639 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.544862985610962
Epoch: 6, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.575 Vali Acc: 0.243 Test Loss: 1.575 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8983592987060547
Epoch: 7, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.655 Vali Acc: 0.251 Test Loss: 1.655 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4937877655029297
Epoch: 8, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.628 Vali Acc: 0.217 Test Loss: 1.628 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4067847728729248
Epoch: 9, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.637 Vali Acc: 0.232 Test Loss: 1.637 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.406236171722412
Epoch: 10, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.554 Vali Acc: 0.247 Test Loss: 1.554 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4770536422729492
Epoch: 11, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.593 Vali Acc: 0.213 Test Loss: 1.593 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.492020845413208
Epoch: 12, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.584 Vali Acc: 0.262 Test Loss: 1.584 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262342).  Saving model ...
Epoch: 13 cost time: 1.696016550064087
Epoch: 13, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.805 Vali Acc: 0.262 Test Loss: 1.805 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4601712226867676
Epoch: 14, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.958 Vali Acc: 0.255 Test Loss: 1.958 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.48348069190979
Epoch: 15, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.773 Vali Acc: 0.236 Test Loss: 1.773 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5104100704193115
Epoch: 16, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.848 Vali Acc: 0.251 Test Loss: 1.848 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6348440647125244
Epoch: 17, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.874 Vali Acc: 0.243 Test Loss: 1.874 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.640110969543457
Epoch: 18, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.079 Vali Acc: 0.251 Test Loss: 2.079 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3748338222503662
Epoch: 19, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.887 Vali Acc: 0.247 Test Loss: 1.887 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2876124382019043
Epoch: 20, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.691 Vali Acc: 0.240 Test Loss: 1.691 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6520776748657227
Epoch: 21, Steps: 17 | Train Loss: 0.851 Vali Loss: 1.977 Vali Acc: 0.232 Test Loss: 1.977 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3534343242645264
Epoch: 22, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.773 Vali Acc: 0.232 Test Loss: 1.773 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps251_str251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 38052868
model size : 159.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps292_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.9432291984558105
Epoch: 1, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.451 Vali Acc: 0.300 Test Loss: 1.451 Test Acc: 0.300
Validation loss decreased (inf --> -0.300366).  Saving model ...
Epoch: 2 cost time: 1.2756342887878418
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.434 Vali Acc: 0.221 Test Loss: 1.434 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4112658500671387
Epoch: 3, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.496 Vali Acc: 0.270 Test Loss: 1.496 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5021443367004395
Epoch: 4, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.462 Vali Acc: 0.213 Test Loss: 1.462 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.836956739425659
Epoch: 5, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.578 Vali Acc: 0.259 Test Loss: 1.578 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4959709644317627
Epoch: 6, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.680 Vali Acc: 0.232 Test Loss: 1.680 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.171658992767334
Epoch: 7, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.624 Vali Acc: 0.232 Test Loss: 1.624 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.029493570327759
Epoch: 8, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.977 Vali Acc: 0.255 Test Loss: 1.977 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.511852979660034
Epoch: 9, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.774 Vali Acc: 0.243 Test Loss: 1.774 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.9924871921539307
Epoch: 10, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.670 Vali Acc: 0.232 Test Loss: 1.670 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.049628257751465
Epoch: 11, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.888 Vali Acc: 0.247 Test Loss: 1.888 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps292_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 38400772
model size : 161.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps292_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.0429816246032715
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.439 Vali Acc: 0.262 Test Loss: 1.439 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.9998574256896973
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.438 Vali Acc: 0.274 Test Loss: 1.438 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.9258143901824951
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.499 Vali Acc: 0.202 Test Loss: 1.499 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9119291305541992
Epoch: 4, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.589 Vali Acc: 0.262 Test Loss: 1.589 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.888434886932373
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.638 Vali Acc: 0.251 Test Loss: 1.638 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0365962982177734
Epoch: 6, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.583 Vali Acc: 0.240 Test Loss: 1.583 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9042305946350098
Epoch: 7, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.787 Vali Acc: 0.221 Test Loss: 1.787 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6675539016723633
Epoch: 8, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.786 Vali Acc: 0.228 Test Loss: 1.786 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5915844440460205
Epoch: 9, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.601 Vali Acc: 0.221 Test Loss: 1.601 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.433370590209961
Epoch: 10, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.610 Vali Acc: 0.266 Test Loss: 1.610 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4290776252746582
Epoch: 11, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.589 Vali Acc: 0.266 Test Loss: 1.589 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5099809169769287
Epoch: 12, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.821 Vali Acc: 0.236 Test Loss: 1.821 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps292_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 38354692
model size : 160.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps292_str292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3766047954559326
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.479 Vali Acc: 0.221 Test Loss: 1.479 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 1.2554755210876465
Epoch: 2, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.451 Vali Acc: 0.240 Test Loss: 1.451 Test Acc: 0.240
Validation loss decreased (-0.220518 --> -0.239529).  Saving model ...
Epoch: 3 cost time: 1.1674683094024658
Epoch: 3, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.471 Vali Acc: 0.251 Test Loss: 1.471 Test Acc: 0.251
Validation loss decreased (-0.239529 --> -0.250936).  Saving model ...
Epoch: 4 cost time: 1.197761058807373
Epoch: 4, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.540 Vali Acc: 0.236 Test Loss: 1.540 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5176973342895508
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.542 Vali Acc: 0.217 Test Loss: 1.542 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5011274814605713
Epoch: 6, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.594 Vali Acc: 0.243 Test Loss: 1.594 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4579739570617676
Epoch: 7, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.809 Vali Acc: 0.259 Test Loss: 1.809 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258537).  Saving model ...
Epoch: 8 cost time: 1.391007661819458
Epoch: 8, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.633 Vali Acc: 0.240 Test Loss: 1.633 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.421473503112793
Epoch: 9, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.645 Vali Acc: 0.278 Test Loss: 1.645 Test Acc: 0.278
Validation loss decreased (-0.258537 --> -0.277550).  Saving model ...
Epoch: 10 cost time: 1.4654293060302734
Epoch: 10, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.886 Vali Acc: 0.266 Test Loss: 1.886 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3720746040344238
Epoch: 11, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.860 Vali Acc: 0.251 Test Loss: 1.860 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4338207244873047
Epoch: 12, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.779 Vali Acc: 0.262 Test Loss: 1.779 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.621263027191162
Epoch: 13, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.786 Vali Acc: 0.251 Test Loss: 1.786 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6434338092803955
Epoch: 14, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.664 Vali Acc: 0.236 Test Loss: 1.664 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5639381408691406
Epoch: 15, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.938 Vali Acc: 0.247 Test Loss: 1.938 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5726995468139648
Epoch: 16, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.824 Vali Acc: 0.236 Test Loss: 1.824 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2045316696166992
Epoch: 17, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.841 Vali Acc: 0.266 Test Loss: 1.841 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7384216785430908
Epoch: 18, Steps: 17 | Train Loss: 0.793 Vali Loss: 1.909 Vali Acc: 0.255 Test Loss: 1.909 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.331648588180542
Epoch: 19, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.158 Vali Acc: 0.247 Test Loss: 2.158 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps292_str292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 38331652
model size : 160.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps351_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.543420314788818
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.426 Vali Acc: 0.266 Test Loss: 1.426 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 2.7779130935668945
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.528 Vali Acc: 0.240 Test Loss: 1.528 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0425636768341064
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.563 Vali Acc: 0.240 Test Loss: 1.563 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3313376903533936
Epoch: 4, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.426 Vali Acc: 0.274 Test Loss: 1.426 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 3.503469705581665
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.508 Vali Acc: 0.251 Test Loss: 1.508 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8299453258514404
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.478 Vali Acc: 0.281 Test Loss: 1.478 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 7 cost time: 3.128100633621216
Epoch: 7, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.728163480758667
Epoch: 8, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.824 Vali Acc: 0.262 Test Loss: 1.824 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5102250576019287
Epoch: 9, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.738 Vali Acc: 0.274 Test Loss: 1.738 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9531922340393066
Epoch: 10, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.677 Vali Acc: 0.255 Test Loss: 1.677 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.144615411758423
Epoch: 11, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.750 Vali Acc: 0.251 Test Loss: 1.750 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.984020233154297
Epoch: 12, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.910 Vali Acc: 0.270 Test Loss: 1.910 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.274172306060791
Epoch: 13, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.903 Vali Acc: 0.259 Test Loss: 1.903 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.4362666606903076
Epoch: 14, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.948 Vali Acc: 0.240 Test Loss: 1.948 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.822598695755005
Epoch: 15, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.938 Vali Acc: 0.205 Test Loss: 1.938 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.3560662269592285
Epoch: 16, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.938 Vali Acc: 0.266 Test Loss: 1.938 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps351_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 38790148
model size : 162.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.427941083908081
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.493156909942627
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
Validation loss decreased (-0.243332 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.5409584045410156
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.387033224105835
Epoch: 4, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.681227207183838
Epoch: 5, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.439 Vali Acc: 0.251 Test Loss: 1.439 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7907884120941162
Epoch: 6, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.481 Vali Acc: 0.232 Test Loss: 1.481 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6339530944824219
Epoch: 7, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.497 Vali Acc: 0.221 Test Loss: 1.497 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6396141052246094
Epoch: 8, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.631 Vali Acc: 0.251 Test Loss: 1.631 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.758284568786621
Epoch: 9, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.539 Vali Acc: 0.270 Test Loss: 1.539 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 10 cost time: 2.025752544403076
Epoch: 10, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.900 Vali Acc: 0.240 Test Loss: 1.900 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.002701997756958
Epoch: 11, Steps: 17 | Train Loss: 1.142 Vali Loss: 2.081 Vali Acc: 0.262 Test Loss: 2.081 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.122981071472168
Epoch: 12, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.884 Vali Acc: 0.266 Test Loss: 1.884 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6407787799835205
Epoch: 13, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.688 Vali Acc: 0.251 Test Loss: 1.688 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.516150951385498
Epoch: 14, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.980 Vali Acc: 0.262 Test Loss: 1.980 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8234026432037354
Epoch: 15, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.656 Vali Acc: 0.224 Test Loss: 1.656 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7266778945922852
Epoch: 16, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.902 Vali Acc: 0.236 Test Loss: 1.902 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7942311763763428
Epoch: 17, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.971 Vali Acc: 0.224 Test Loss: 2.971 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5521092414855957
Epoch: 18, Steps: 17 | Train Loss: 1.091 Vali Loss: 2.310 Vali Acc: 0.251 Test Loss: 2.310 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5097088813781738
Epoch: 19, Steps: 17 | Train Loss: 0.956 Vali Loss: 2.303 Vali Acc: 0.194 Test Loss: 2.303 Test Acc: 0.194
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 38753284
model size : 162.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps351_str351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5338730812072754
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.636901617050171
Epoch: 2, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.454 Vali Acc: 0.259 Test Loss: 1.454 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5449042320251465
Epoch: 3, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.515 Vali Acc: 0.274 Test Loss: 1.515 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 1.3324449062347412
Epoch: 4, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9248108863830566
Epoch: 5, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.470 Vali Acc: 0.243 Test Loss: 1.470 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7257513999938965
Epoch: 6, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.613 Vali Acc: 0.255 Test Loss: 1.613 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5547764301300049
Epoch: 7, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.537 Vali Acc: 0.224 Test Loss: 1.537 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.83819580078125
Epoch: 8, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.541 Vali Acc: 0.266 Test Loss: 1.541 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.95849609375
Epoch: 9, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.604 Vali Acc: 0.217 Test Loss: 1.604 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.869955062866211
Epoch: 10, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.638 Vali Acc: 0.240 Test Loss: 1.638 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9056549072265625
Epoch: 11, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.541 Vali Acc: 0.240 Test Loss: 1.541 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8806257247924805
Epoch: 12, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.659 Vali Acc: 0.217 Test Loss: 1.659 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.907392978668213
Epoch: 13, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.637 Vali Acc: 0.262 Test Loss: 1.637 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el5_dm768_df768_ps351_str351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 38734852
model size : 162.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.778359651565552
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.654 Vali Acc: 0.228 Test Loss: 1.654 Test Acc: 0.228
Validation loss decreased (inf --> -0.228120).  Saving model ...
Epoch: 2 cost time: 2.972599744796753
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.687 Vali Acc: 0.240 Test Loss: 1.687 Test Acc: 0.240
Validation loss decreased (-0.228120 --> -0.239527).  Saving model ...
Epoch: 3 cost time: 2.921097755432129
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.552 Vali Acc: 0.251 Test Loss: 1.552 Test Acc: 0.251
Validation loss decreased (-0.239527 --> -0.250935).  Saving model ...
Epoch: 4 cost time: 3.054658889770508
Epoch: 4, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.516268491744995
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.934 Vali Acc: 0.255 Test Loss: 1.934 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254734).  Saving model ...
Epoch: 6 cost time: 3.0250966548919678
Epoch: 6, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.655 Vali Acc: 0.266 Test Loss: 1.655 Test Acc: 0.266
Validation loss decreased (-0.254734 --> -0.266143).  Saving model ...
Epoch: 7 cost time: 2.7370898723602295
Epoch: 7, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.993 Vali Acc: 0.240 Test Loss: 1.993 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.022047281265259
Epoch: 8, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.880 Vali Acc: 0.255 Test Loss: 1.880 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.314302444458008
Epoch: 9, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.844 Vali Acc: 0.270 Test Loss: 1.844 Test Acc: 0.270
Validation loss decreased (-0.266143 --> -0.269944).  Saving model ...
Epoch: 10 cost time: 3.4547019004821777
Epoch: 10, Steps: 17 | Train Loss: 0.877 Vali Loss: 2.636 Vali Acc: 0.232 Test Loss: 2.636 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2065987586975098
Epoch: 11, Steps: 17 | Train Loss: 1.042 Vali Loss: 2.005 Vali Acc: 0.224 Test Loss: 2.005 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6472818851470947
Epoch: 12, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.511 Vali Acc: 0.262 Test Loss: 2.511 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7898361682891846
Epoch: 13, Steps: 17 | Train Loss: 0.846 Vali Loss: 2.386 Vali Acc: 0.213 Test Loss: 2.386 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8770530223846436
Epoch: 14, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.355 Vali Acc: 0.213 Test Loss: 2.355 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.1026978492736816
Epoch: 15, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.832 Vali Acc: 0.236 Test Loss: 2.832 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.769040584564209
Epoch: 16, Steps: 17 | Train Loss: 0.824 Vali Loss: 2.513 Vali Acc: 0.262 Test Loss: 2.513 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6450393199920654
Epoch: 17, Steps: 17 | Train Loss: 0.766 Vali Loss: 2.644 Vali Acc: 0.262 Test Loss: 2.644 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.3744609355926514
Epoch: 18, Steps: 17 | Train Loss: 0.567 Vali Loss: 3.506 Vali Acc: 0.221 Test Loss: 3.506 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.360037326812744
Epoch: 19, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.854 Vali Acc: 0.228 Test Loss: 2.854 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30126340
model size : 129.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.785567760467529
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.433 Vali Acc: 0.255 Test Loss: 1.433 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 2.3654773235321045
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.493 Vali Acc: 0.270 Test Loss: 1.493 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 2.4804880619049072
Epoch: 3, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.510 Vali Acc: 0.259 Test Loss: 1.510 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7896571159362793
Epoch: 4, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.661 Vali Acc: 0.232 Test Loss: 1.661 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6870436668395996
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.511 Vali Acc: 0.236 Test Loss: 1.511 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.010770559310913
Epoch: 6, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.608 Vali Acc: 0.236 Test Loss: 1.608 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7203283309936523
Epoch: 7, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.842 Vali Acc: 0.255 Test Loss: 1.842 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0491180419921875
Epoch: 8, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.645 Vali Acc: 0.236 Test Loss: 1.645 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9151203632354736
Epoch: 9, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.599 Vali Acc: 0.274 Test Loss: 1.599 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273748).  Saving model ...
Epoch: 10 cost time: 2.45158052444458
Epoch: 10, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.911 Vali Acc: 0.228 Test Loss: 1.911 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3517966270446777
Epoch: 11, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.917 Vali Acc: 0.228 Test Loss: 1.917 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.461362361907959
Epoch: 12, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.495 Vali Acc: 0.262 Test Loss: 2.495 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4488840103149414
Epoch: 13, Steps: 17 | Train Loss: 0.889 Vali Loss: 2.092 Vali Acc: 0.232 Test Loss: 2.092 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.598386764526367
Epoch: 14, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.967 Vali Acc: 0.228 Test Loss: 1.967 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6454362869262695
Epoch: 15, Steps: 17 | Train Loss: 0.997 Vali Loss: 2.205 Vali Acc: 0.224 Test Loss: 2.205 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3380956649780273
Epoch: 16, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.526 Vali Acc: 0.232 Test Loss: 2.526 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3093912601470947
Epoch: 17, Steps: 17 | Train Loss: 0.729 Vali Loss: 3.084 Vali Acc: 0.266 Test Loss: 3.084 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0770227909088135
Epoch: 18, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.376 Vali Acc: 0.243 Test Loss: 2.376 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6819241046905518
Epoch: 19, Steps: 17 | Train Loss: 0.626 Vali Loss: 3.420 Vali Acc: 0.255 Test Loss: 3.420 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 29909764
model size : 128.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.244416236877441
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.490 Vali Acc: 0.243 Test Loss: 1.490 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 2.2237842082977295
Epoch: 2, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.462 Vali Acc: 0.251 Test Loss: 1.462 Test Acc: 0.251
Validation loss decreased (-0.243331 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 2.361884117126465
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.440 Vali Acc: 0.251 Test Loss: 1.440 Test Acc: 0.251
Validation loss decreased (-0.250936 --> -0.250936).  Saving model ...
Epoch: 4 cost time: 2.230746030807495
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.465 Vali Acc: 0.224 Test Loss: 1.465 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9313702583312988
Epoch: 5, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.512 Vali Acc: 0.236 Test Loss: 1.512 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.138117551803589
Epoch: 6, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.539 Vali Acc: 0.266 Test Loss: 1.539 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266144).  Saving model ...
Epoch: 7 cost time: 2.0536720752716064
Epoch: 7, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.572 Vali Acc: 0.270 Test Loss: 1.572 Test Acc: 0.270
Validation loss decreased (-0.266144 --> -0.269946).  Saving model ...
Epoch: 8 cost time: 1.7353737354278564
Epoch: 8, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.594 Vali Acc: 0.228 Test Loss: 1.594 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9572975635528564
Epoch: 9, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.689 Vali Acc: 0.224 Test Loss: 1.689 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8711521625518799
Epoch: 10, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.898 Vali Acc: 0.228 Test Loss: 1.898 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2603516578674316
Epoch: 11, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.806 Vali Acc: 0.240 Test Loss: 1.806 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.046773910522461
Epoch: 12, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.912 Vali Acc: 0.221 Test Loss: 1.912 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3595268726348877
Epoch: 13, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.933 Vali Acc: 0.251 Test Loss: 1.933 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.895308256149292
Epoch: 14, Steps: 17 | Train Loss: 0.964 Vali Loss: 2.337 Vali Acc: 0.243 Test Loss: 2.337 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5110204219818115
Epoch: 15, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.314 Vali Acc: 0.240 Test Loss: 2.314 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.113757610321045
Epoch: 16, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.908 Vali Acc: 0.224 Test Loss: 1.908 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.192373037338257
Epoch: 17, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.329 Vali Acc: 0.262 Test Loss: 2.329 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 29803780
model size : 128.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps73_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.42123007774353
Epoch: 1, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.572 Vali Acc: 0.285 Test Loss: 1.572 Test Acc: 0.285
Validation loss decreased (inf --> -0.285155).  Saving model ...
Epoch: 2 cost time: 2.585763692855835
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.524 Vali Acc: 0.266 Test Loss: 1.524 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.429882526397705
Epoch: 3, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.586 Vali Acc: 0.262 Test Loss: 1.586 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.726867437362671
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.647 Vali Acc: 0.255 Test Loss: 1.647 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.641753673553467
Epoch: 5, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.773 Vali Acc: 0.262 Test Loss: 1.773 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4903573989868164
Epoch: 6, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.819 Vali Acc: 0.221 Test Loss: 1.819 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.252720832824707
Epoch: 7, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.915 Vali Acc: 0.224 Test Loss: 1.915 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.431173801422119
Epoch: 8, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.796 Vali Acc: 0.232 Test Loss: 1.796 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.48732852935791
Epoch: 9, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.835 Vali Acc: 0.262 Test Loss: 1.835 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7496402263641357
Epoch: 10, Steps: 17 | Train Loss: 0.923 Vali Loss: 2.176 Vali Acc: 0.232 Test Loss: 2.176 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6039068698883057
Epoch: 11, Steps: 17 | Train Loss: 0.835 Vali Loss: 2.239 Vali Acc: 0.262 Test Loss: 2.239 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps73_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 30117124
model size : 129.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps73_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.810962677001953
Epoch: 1, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.442 Vali Acc: 0.293 Test Loss: 1.442 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 2.5010557174682617
Epoch: 2, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.564 Vali Acc: 0.259 Test Loss: 1.564 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.34071683883667
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.467 Vali Acc: 0.266 Test Loss: 1.467 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.239586591720581
Epoch: 4, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.494 Vali Acc: 0.255 Test Loss: 1.494 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8055641651153564
Epoch: 5, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.605 Vali Acc: 0.266 Test Loss: 1.605 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2959740161895752
Epoch: 6, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.754 Vali Acc: 0.262 Test Loss: 1.754 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7253198623657227
Epoch: 7, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.634 Vali Acc: 0.262 Test Loss: 1.634 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5111942291259766
Epoch: 8, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.748 Vali Acc: 0.243 Test Loss: 1.748 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2636725902557373
Epoch: 9, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.120 Vali Acc: 0.236 Test Loss: 2.120 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2559773921966553
Epoch: 10, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.971 Vali Acc: 0.247 Test Loss: 1.971 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.544908285140991
Epoch: 11, Steps: 17 | Train Loss: 0.993 Vali Loss: 2.084 Vali Acc: 0.232 Test Loss: 2.084 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps73_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 29918980
model size : 128.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps73_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8389816284179688
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.434 Vali Acc: 0.236 Test Loss: 1.434 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 2.2935423851013184
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.509 Vali Acc: 0.262 Test Loss: 1.509 Test Acc: 0.262
Validation loss decreased (-0.235727 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 1.77193284034729
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.545 Vali Acc: 0.262 Test Loss: 1.545 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3918380737304688
Epoch: 4, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.450 Vali Acc: 0.266 Test Loss: 1.450 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 2.541168689727783
Epoch: 5, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.561 Vali Acc: 0.266 Test Loss: 1.561 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7959611415863037
Epoch: 6, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.635 Vali Acc: 0.255 Test Loss: 1.635 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5817768573760986
Epoch: 7, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.791 Vali Acc: 0.228 Test Loss: 1.791 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9211716651916504
Epoch: 8, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.828 Vali Acc: 0.240 Test Loss: 1.828 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4618709087371826
Epoch: 9, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.760 Vali Acc: 0.240 Test Loss: 1.760 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.499864101409912
Epoch: 10, Steps: 17 | Train Loss: 1.064 Vali Loss: 2.007 Vali Acc: 0.236 Test Loss: 2.007 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.605924367904663
Epoch: 11, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.936 Vali Acc: 0.251 Test Loss: 1.936 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.883497953414917
Epoch: 12, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.076 Vali Acc: 0.228 Test Loss: 2.076 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.480973720550537
Epoch: 13, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.775 Vali Acc: 0.255 Test Loss: 1.775 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4620373249053955
Epoch: 14, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.190 Vali Acc: 0.213 Test Loss: 2.190 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps73_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 29812996
model size : 128.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.343111753463745
Epoch: 1, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.634 Vali Acc: 0.266 Test Loss: 1.634 Test Acc: 0.266
Validation loss decreased (inf --> -0.266143).  Saving model ...
Epoch: 2 cost time: 2.8156135082244873
Epoch: 2, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.525 Vali Acc: 0.236 Test Loss: 1.525 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7680442333221436
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.986 Vali Acc: 0.255 Test Loss: 1.986 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8665904998779297
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.589 Vali Acc: 0.240 Test Loss: 1.589 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.592332363128662
Epoch: 5, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.654 Vali Acc: 0.255 Test Loss: 1.654 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6905624866485596
Epoch: 6, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.787 Vali Acc: 0.278 Test Loss: 1.787 Test Acc: 0.278
Validation loss decreased (-0.266143 --> -0.277549).  Saving model ...
Epoch: 7 cost time: 2.257499933242798
Epoch: 7, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.653 Vali Acc: 0.243 Test Loss: 1.653 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9233479499816895
Epoch: 8, Steps: 17 | Train Loss: 0.979 Vali Loss: 2.044 Vali Acc: 0.251 Test Loss: 2.044 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9906227588653564
Epoch: 9, Steps: 17 | Train Loss: 1.051 Vali Loss: 2.659 Vali Acc: 0.259 Test Loss: 2.659 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.447174310684204
Epoch: 10, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.892 Vali Acc: 0.243 Test Loss: 1.892 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.434821844100952
Epoch: 11, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.324 Vali Acc: 0.202 Test Loss: 2.324 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7900238037109375
Epoch: 12, Steps: 17 | Train Loss: 0.827 Vali Loss: 2.567 Vali Acc: 0.243 Test Loss: 2.567 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.352572202682495
Epoch: 13, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.126 Vali Acc: 0.247 Test Loss: 2.126 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.076294422149658
Epoch: 14, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.159 Vali Acc: 0.266 Test Loss: 2.159 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.755702257156372
Epoch: 15, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.934 Vali Acc: 0.213 Test Loss: 2.934 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.330939531326294
Epoch: 16, Steps: 17 | Train Loss: 0.642 Vali Loss: 2.740 Vali Acc: 0.228 Test Loss: 2.740 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 30121732
model size : 129.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.153902292251587
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.483 Vali Acc: 0.247 Test Loss: 1.483 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 3.1213741302490234
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.622 Vali Acc: 0.266 Test Loss: 1.622 Test Acc: 0.266
Validation loss decreased (-0.247133 --> -0.266143).  Saving model ...
Epoch: 3 cost time: 2.908923625946045
Epoch: 3, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.510 Vali Acc: 0.243 Test Loss: 1.510 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7896220684051514
Epoch: 4, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.593 Vali Acc: 0.240 Test Loss: 1.593 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4961791038513184
Epoch: 5, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.881 Vali Acc: 0.262 Test Loss: 1.881 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8012049198150635
Epoch: 6, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.765 Vali Acc: 0.243 Test Loss: 1.765 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9027135372161865
Epoch: 7, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.157 Vali Acc: 0.251 Test Loss: 2.157 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.453718662261963
Epoch: 8, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.640 Vali Acc: 0.255 Test Loss: 1.640 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7283966541290283
Epoch: 9, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.850 Vali Acc: 0.232 Test Loss: 1.850 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0352470874786377
Epoch: 10, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.845 Vali Acc: 0.243 Test Loss: 1.845 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5655508041381836
Epoch: 11, Steps: 17 | Train Loss: 1.032 Vali Loss: 2.006 Vali Acc: 0.266 Test Loss: 2.006 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.491124153137207
Epoch: 12, Steps: 17 | Train Loss: 0.873 Vali Loss: 2.029 Vali Acc: 0.243 Test Loss: 2.029 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 29932804
model size : 128.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.3876190185546875
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.502 Vali Acc: 0.251 Test Loss: 1.502 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.7663850784301758
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.581 Vali Acc: 0.278 Test Loss: 1.581 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 1.7271666526794434
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.538 Vali Acc: 0.240 Test Loss: 1.538 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.450261116027832
Epoch: 4, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.456 Vali Acc: 0.255 Test Loss: 1.456 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6609344482421875
Epoch: 5, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.507 Vali Acc: 0.262 Test Loss: 1.507 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.075918436050415
Epoch: 6, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.554 Vali Acc: 0.251 Test Loss: 1.554 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7235631942749023
Epoch: 7, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.740 Vali Acc: 0.236 Test Loss: 1.740 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4646642208099365
Epoch: 8, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.672 Vali Acc: 0.243 Test Loss: 1.672 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.132645845413208
Epoch: 9, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.890 Vali Acc: 0.240 Test Loss: 1.890 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.409921169281006
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.850 Vali Acc: 0.247 Test Loss: 1.850 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.56719970703125
Epoch: 11, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.938 Vali Acc: 0.255 Test Loss: 1.938 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.605029821395874
Epoch: 12, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.985 Vali Acc: 0.243 Test Loss: 1.985 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 29836036
model size : 128.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.5935585498809814
Epoch: 1, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.712 Vali Acc: 0.251 Test Loss: 1.712 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 3.766418695449829
Epoch: 2, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.457 Vali Acc: 0.270 Test Loss: 1.457 Test Acc: 0.270
Validation loss decreased (-0.250933 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 3.2795019149780273
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.616 Vali Acc: 0.262 Test Loss: 1.616 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7664237022399902
Epoch: 4, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.481 Vali Acc: 0.232 Test Loss: 1.481 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.565173625946045
Epoch: 5, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.923398971557617
Epoch: 6, Steps: 17 | Train Loss: 1.163 Vali Loss: 2.084 Vali Acc: 0.266 Test Loss: 2.084 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9954493045806885
Epoch: 7, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.585 Vali Acc: 0.247 Test Loss: 1.585 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.130763292312622
Epoch: 8, Steps: 17 | Train Loss: 1.065 Vali Loss: 2.161 Vali Acc: 0.221 Test Loss: 2.161 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8344309329986572
Epoch: 9, Steps: 17 | Train Loss: 0.998 Vali Loss: 2.024 Vali Acc: 0.240 Test Loss: 2.024 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.059006452560425
Epoch: 10, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.076 Vali Acc: 0.240 Test Loss: 2.076 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.4497313499450684
Epoch: 11, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.114 Vali Acc: 0.243 Test Loss: 2.114 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5175929069519043
Epoch: 12, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.978 Vali Acc: 0.259 Test Loss: 1.978 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30142468
model size : 129.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.1906492710113525
Epoch: 1, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.456 Vali Acc: 0.285 Test Loss: 1.456 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 2.6881320476531982
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.444 Vali Acc: 0.300 Test Loss: 1.444 Test Acc: 0.300
Validation loss decreased (-0.285157 --> -0.300366).  Saving model ...
Epoch: 3 cost time: 2.3385910987854004
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.436 Vali Acc: 0.274 Test Loss: 1.436 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5862758159637451
Epoch: 4, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.528 Vali Acc: 0.255 Test Loss: 1.528 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9056673049926758
Epoch: 5, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.620 Vali Acc: 0.251 Test Loss: 1.620 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6216955184936523
Epoch: 6, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.658 Vali Acc: 0.240 Test Loss: 1.658 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9651110172271729
Epoch: 7, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.557 Vali Acc: 0.240 Test Loss: 1.557 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.343683958053589
Epoch: 8, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.831 Vali Acc: 0.236 Test Loss: 1.831 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.122844696044922
Epoch: 9, Steps: 17 | Train Loss: 1.155 Vali Loss: 2.198 Vali Acc: 0.236 Test Loss: 2.198 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0116307735443115
Epoch: 10, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.583 Vali Acc: 0.262 Test Loss: 1.583 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5960800647735596
Epoch: 11, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.351 Vali Acc: 0.259 Test Loss: 2.351 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.687816858291626
Epoch: 12, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.912 Vali Acc: 0.251 Test Loss: 1.912 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 29948932
model size : 128.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.359137773513794
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.423 Vali Acc: 0.232 Test Loss: 1.423 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.5500690937042236
Epoch: 2, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.430 Vali Acc: 0.259 Test Loss: 1.430 Test Acc: 0.259
Validation loss decreased (-0.231925 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.7868895530700684
Epoch: 3, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.608 Vali Acc: 0.247 Test Loss: 1.608 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2579729557037354
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.651 Vali Acc: 0.259 Test Loss: 1.651 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9785540103912354
Epoch: 5, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.522 Vali Acc: 0.236 Test Loss: 1.522 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9678473472595215
Epoch: 6, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.678 Vali Acc: 0.243 Test Loss: 1.678 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0327277183532715
Epoch: 7, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.573 Vali Acc: 0.217 Test Loss: 1.573 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7545435428619385
Epoch: 8, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.604 Vali Acc: 0.240 Test Loss: 1.604 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4211044311523438
Epoch: 9, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.697 Vali Acc: 0.217 Test Loss: 1.697 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4475889205932617
Epoch: 10, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.676 Vali Acc: 0.236 Test Loss: 1.676 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8755884170532227
Epoch: 11, Steps: 17 | Train Loss: 1.022 Vali Loss: 2.178 Vali Acc: 0.240 Test Loss: 2.178 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4345014095306396
Epoch: 12, Steps: 17 | Train Loss: 1.128 Vali Loss: 2.170 Vali Acc: 0.266 Test Loss: 2.170 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266138).  Saving model ...
Epoch: 13 cost time: 2.48710298538208
Epoch: 13, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.880 Vali Acc: 0.205 Test Loss: 1.880 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.714191198348999
Epoch: 14, Steps: 17 | Train Loss: 0.944 Vali Loss: 1.861 Vali Acc: 0.217 Test Loss: 1.861 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2269833087921143
Epoch: 15, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.253 Vali Acc: 0.228 Test Loss: 2.253 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.585078716278076
Epoch: 16, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.122 Vali Acc: 0.255 Test Loss: 2.122 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.204468250274658
Epoch: 17, Steps: 17 | Train Loss: 0.850 Vali Loss: 2.507 Vali Acc: 0.236 Test Loss: 2.507 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.934412717819214
Epoch: 18, Steps: 17 | Train Loss: 0.936 Vali Loss: 2.153 Vali Acc: 0.262 Test Loss: 2.153 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.730003595352173
Epoch: 19, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.060 Vali Acc: 0.240 Test Loss: 2.060 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4682204723358154
Epoch: 20, Steps: 17 | Train Loss: 0.813 Vali Loss: 2.292 Vali Acc: 0.236 Test Loss: 2.292 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8624823093414307
Epoch: 21, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.295 Vali Acc: 0.228 Test Loss: 2.295 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8445024490356445
Epoch: 22, Steps: 17 | Train Loss: 0.756 Vali Loss: 2.403 Vali Acc: 0.240 Test Loss: 2.403 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 29852164
model size : 128.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps84_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.691984176635742
Epoch: 1, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.443 Vali Acc: 0.262 Test Loss: 1.443 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.8388113975524902
Epoch: 2, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.484 Vali Acc: 0.255 Test Loss: 1.484 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6510002613067627
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.896 Vali Acc: 0.266 Test Loss: 1.896 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266141).  Saving model ...
Epoch: 4 cost time: 2.5913383960723877
Epoch: 4, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.672 Vali Acc: 0.259 Test Loss: 1.672 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7485573291778564
Epoch: 5, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.535 Vali Acc: 0.221 Test Loss: 1.535 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7998156547546387
Epoch: 6, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.806 Vali Acc: 0.240 Test Loss: 1.806 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7444565296173096
Epoch: 7, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.709 Vali Acc: 0.251 Test Loss: 1.709 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6358425617218018
Epoch: 8, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.960 Vali Acc: 0.255 Test Loss: 1.960 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8570187091827393
Epoch: 9, Steps: 17 | Train Loss: 1.156 Vali Loss: 2.542 Vali Acc: 0.243 Test Loss: 2.542 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.680609703063965
Epoch: 10, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.955 Vali Acc: 0.297 Test Loss: 1.955 Test Acc: 0.297
Validation loss decreased (-0.266141 --> -0.296558).  Saving model ...
Epoch: 11 cost time: 2.9738986492156982
Epoch: 11, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.756 Vali Acc: 0.262 Test Loss: 1.756 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3418407440185547
Epoch: 12, Steps: 17 | Train Loss: 0.934 Vali Loss: 2.929 Vali Acc: 0.259 Test Loss: 2.929 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.042747974395752
Epoch: 13, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.152 Vali Acc: 0.262 Test Loss: 2.152 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.379173994064331
Epoch: 14, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.920 Vali Acc: 0.270 Test Loss: 2.920 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.509237289428711
Epoch: 15, Steps: 17 | Train Loss: 0.922 Vali Loss: 2.617 Vali Acc: 0.259 Test Loss: 2.617 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8477792739868164
Epoch: 16, Steps: 17 | Train Loss: 0.808 Vali Loss: 2.568 Vali Acc: 0.221 Test Loss: 2.568 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.480778694152832
Epoch: 17, Steps: 17 | Train Loss: 0.644 Vali Loss: 3.423 Vali Acc: 0.247 Test Loss: 3.423 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.0721678733825684
Epoch: 18, Steps: 17 | Train Loss: 0.813 Vali Loss: 2.692 Vali Acc: 0.232 Test Loss: 2.692 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.958261489868164
Epoch: 19, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.156 Vali Acc: 0.255 Test Loss: 3.156 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.5097649097442627
Epoch: 20, Steps: 17 | Train Loss: 1.183 Vali Loss: 3.330 Vali Acc: 0.285 Test Loss: 3.330 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps84_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 30151684
model size : 129.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps84_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.590123891830444
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.474 Vali Acc: 0.255 Test Loss: 1.474 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 2.52451229095459
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.500 Vali Acc: 0.274 Test Loss: 1.500 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 3.2060983180999756
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.274765729904175
Epoch: 4, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.522 Vali Acc: 0.278 Test Loss: 1.522 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 2.5954389572143555
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.678 Vali Acc: 0.232 Test Loss: 1.678 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6624298095703125
Epoch: 6, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.763 Vali Acc: 0.247 Test Loss: 1.763 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1455917358398438
Epoch: 7, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.782 Vali Acc: 0.251 Test Loss: 1.782 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5359132289886475
Epoch: 8, Steps: 17 | Train Loss: 1.057 Vali Loss: 2.002 Vali Acc: 0.221 Test Loss: 2.002 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.117812395095825
Epoch: 9, Steps: 17 | Train Loss: 1.064 Vali Loss: 2.126 Vali Acc: 0.255 Test Loss: 2.126 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7392139434814453
Epoch: 10, Steps: 17 | Train Loss: 1.010 Vali Loss: 2.029 Vali Acc: 0.232 Test Loss: 2.029 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.59455943107605
Epoch: 11, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.994 Vali Acc: 0.243 Test Loss: 1.994 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3259568214416504
Epoch: 12, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.664 Vali Acc: 0.247 Test Loss: 2.664 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.511699676513672
Epoch: 13, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.379 Vali Acc: 0.198 Test Loss: 2.379 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0893430709838867
Epoch: 14, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.140 Vali Acc: 0.251 Test Loss: 2.140 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps84_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 29967364
model size : 128.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps84_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.900819301605225
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.639122724533081
Epoch: 2, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.436 Vali Acc: 0.281 Test Loss: 1.436 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 1.936155080795288
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.488 Vali Acc: 0.293 Test Loss: 1.488 Test Acc: 0.293
Validation loss decreased (-0.281354 --> -0.292761).  Saving model ...
Epoch: 4 cost time: 1.6314113140106201
Epoch: 4, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.529 Vali Acc: 0.274 Test Loss: 1.529 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7168257236480713
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.449 Vali Acc: 0.240 Test Loss: 1.449 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.026726722717285
Epoch: 6, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.571 Vali Acc: 0.255 Test Loss: 1.571 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5854640007019043
Epoch: 7, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.769 Vali Acc: 0.243 Test Loss: 1.769 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.889220952987671
Epoch: 8, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.696 Vali Acc: 0.251 Test Loss: 1.696 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.133230447769165
Epoch: 9, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.766 Vali Acc: 0.262 Test Loss: 1.766 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.427431344985962
Epoch: 10, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.843 Vali Acc: 0.251 Test Loss: 1.843 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9596471786499023
Epoch: 11, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.741 Vali Acc: 0.243 Test Loss: 1.741 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1926681995391846
Epoch: 12, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.838 Vali Acc: 0.259 Test Loss: 1.838 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6738789081573486
Epoch: 13, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.109 Vali Acc: 0.243 Test Loss: 2.109 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps84_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 29875204
model size : 128.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps88_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.664106369018555
Epoch: 1, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.668 Vali Acc: 0.259 Test Loss: 1.668 Test Acc: 0.259
Validation loss decreased (inf --> -0.258538).  Saving model ...
Epoch: 2 cost time: 2.9094667434692383
Epoch: 2, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.493 Vali Acc: 0.255 Test Loss: 1.493 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1696691513061523
Epoch: 3, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.804 Vali Acc: 0.259 Test Loss: 1.804 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.523145914077759
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.551 Vali Acc: 0.270 Test Loss: 1.551 Test Acc: 0.270
Validation loss decreased (-0.258538 --> -0.269946).  Saving model ...
Epoch: 5 cost time: 3.2314555644989014
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.628 Vali Acc: 0.232 Test Loss: 1.628 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6697041988372803
Epoch: 6, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.786 Vali Acc: 0.262 Test Loss: 1.786 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3271617889404297
Epoch: 7, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.674 Vali Acc: 0.281 Test Loss: 1.674 Test Acc: 0.281
Validation loss decreased (-0.269946 --> -0.281352).  Saving model ...
Epoch: 8 cost time: 2.9128363132476807
Epoch: 8, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.819 Vali Acc: 0.243 Test Loss: 1.819 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3350942134857178
Epoch: 9, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.652 Vali Acc: 0.247 Test Loss: 1.652 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5487172603607178
Epoch: 10, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.877 Vali Acc: 0.213 Test Loss: 1.877 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.348811388015747
Epoch: 11, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.831 Vali Acc: 0.240 Test Loss: 1.831 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.531845808029175
Epoch: 12, Steps: 17 | Train Loss: 0.949 Vali Loss: 3.370 Vali Acc: 0.247 Test Loss: 3.370 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.412684917449951
Epoch: 13, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.703 Vali Acc: 0.243 Test Loss: 1.703 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.823075771331787
Epoch: 14, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.902 Vali Acc: 0.247 Test Loss: 1.902 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.65472149848938
Epoch: 15, Steps: 17 | Train Loss: 0.786 Vali Loss: 3.207 Vali Acc: 0.224 Test Loss: 3.207 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7362594604492188
Epoch: 16, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.247 Vali Acc: 0.259 Test Loss: 2.247 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9478139877319336
Epoch: 17, Steps: 17 | Train Loss: 0.792 Vali Loss: 2.954 Vali Acc: 0.213 Test Loss: 2.954 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps88_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30160900
model size : 129.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.712544679641724
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.474 Vali Acc: 0.259 Test Loss: 1.474 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 2.06864595413208
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.462 Vali Acc: 0.240 Test Loss: 1.462 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9330027103424072
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.491 Vali Acc: 0.228 Test Loss: 1.491 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.004356861114502
Epoch: 4, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.537 Vali Acc: 0.243 Test Loss: 1.537 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3368918895721436
Epoch: 5, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.592 Vali Acc: 0.243 Test Loss: 1.592 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8019044399261475
Epoch: 6, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.657 Vali Acc: 0.228 Test Loss: 1.657 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1114091873168945
Epoch: 7, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.883 Vali Acc: 0.240 Test Loss: 1.883 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7158939838409424
Epoch: 8, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.959 Vali Acc: 0.266 Test Loss: 1.959 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266140).  Saving model ...
Epoch: 9 cost time: 2.4937572479248047
Epoch: 9, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.185 Vali Acc: 0.251 Test Loss: 2.185 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8876209259033203
Epoch: 10, Steps: 17 | Train Loss: 1.038 Vali Loss: 2.144 Vali Acc: 0.232 Test Loss: 2.144 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.482597827911377
Epoch: 11, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.625 Vali Acc: 0.259 Test Loss: 2.625 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.223106861114502
Epoch: 12, Steps: 17 | Train Loss: 0.930 Vali Loss: 2.123 Vali Acc: 0.251 Test Loss: 2.123 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.631560802459717
Epoch: 13, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.799 Vali Acc: 0.232 Test Loss: 1.799 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7169055938720703
Epoch: 14, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.289 Vali Acc: 0.228 Test Loss: 2.289 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.850858688354492
Epoch: 15, Steps: 17 | Train Loss: 0.940 Vali Loss: 2.097 Vali Acc: 0.224 Test Loss: 2.097 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9517552852630615
Epoch: 16, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.526 Vali Acc: 0.243 Test Loss: 2.526 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8285999298095703
Epoch: 17, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.183 Vali Acc: 0.217 Test Loss: 2.183 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7893788814544678
Epoch: 18, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.502 Vali Acc: 0.259 Test Loss: 2.502 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 29985796
model size : 129.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps88_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.580590009689331
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.422 Vali Acc: 0.255 Test Loss: 1.422 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.8665943145751953
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.611 Vali Acc: 0.259 Test Loss: 1.611 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 2.1105847358703613
Epoch: 3, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.466 Vali Acc: 0.240 Test Loss: 1.466 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1932361125946045
Epoch: 4, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
Validation loss decreased (-0.258539 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 2.089378595352173
Epoch: 5, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.489 Vali Acc: 0.255 Test Loss: 1.489 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.04414439201355
Epoch: 6, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.715 Vali Acc: 0.278 Test Loss: 1.715 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277549).  Saving model ...
Epoch: 7 cost time: 2.1715359687805176
Epoch: 7, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.588 Vali Acc: 0.278 Test Loss: 1.588 Test Acc: 0.278
Validation loss decreased (-0.277549 --> -0.277551).  Saving model ...
Epoch: 8 cost time: 2.2553396224975586
Epoch: 8, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.940 Vali Acc: 0.243 Test Loss: 1.940 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.192643642425537
Epoch: 9, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.891 Vali Acc: 0.243 Test Loss: 1.891 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7820508480072021
Epoch: 10, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.749 Vali Acc: 0.232 Test Loss: 1.749 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8947837352752686
Epoch: 11, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.743 Vali Acc: 0.236 Test Loss: 1.743 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.091414213180542
Epoch: 12, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.927 Vali Acc: 0.255 Test Loss: 1.927 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4075734615325928
Epoch: 13, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.076 Vali Acc: 0.209 Test Loss: 2.076 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2586092948913574
Epoch: 14, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.878 Vali Acc: 0.236 Test Loss: 1.878 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.084472894668579
Epoch: 15, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.766 Vali Acc: 0.259 Test Loss: 1.766 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.747760534286499
Epoch: 16, Steps: 17 | Train Loss: 0.852 Vali Loss: 2.041 Vali Acc: 0.224 Test Loss: 2.041 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.300597906112671
Epoch: 17, Steps: 17 | Train Loss: 0.779 Vali Loss: 2.010 Vali Acc: 0.236 Test Loss: 2.010 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps88_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 29898244
model size : 128.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.328399658203125
Epoch: 1, Steps: 17 | Train Loss: 1.550 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 3.4568557739257812
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.628 Vali Acc: 0.266 Test Loss: 1.628 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266143).  Saving model ...
Epoch: 3 cost time: 3.891327142715454
Epoch: 3, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.771 Vali Acc: 0.232 Test Loss: 1.771 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8487322330474854
Epoch: 4, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.531 Vali Acc: 0.251 Test Loss: 1.531 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5067591667175293
Epoch: 5, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.714 Vali Acc: 0.236 Test Loss: 1.714 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0929319858551025
Epoch: 6, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.546 Vali Acc: 0.232 Test Loss: 1.546 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0303854942321777
Epoch: 7, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.904 Vali Acc: 0.240 Test Loss: 1.904 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8283138275146484
Epoch: 8, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.961 Vali Acc: 0.243 Test Loss: 1.961 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.618053674697876
Epoch: 9, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.958 Vali Acc: 0.259 Test Loss: 1.958 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7547109127044678
Epoch: 10, Steps: 17 | Train Loss: 1.141 Vali Loss: 2.285 Vali Acc: 0.259 Test Loss: 2.285 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.4348690509796143
Epoch: 11, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.123 Vali Acc: 0.236 Test Loss: 2.123 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.321364641189575
Epoch: 12, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.841 Vali Acc: 0.259 Test Loss: 2.841 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 30167812
model size : 129.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.633840799331665
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.797 Vali Acc: 0.247 Test Loss: 1.797 Test Acc: 0.247
Validation loss decreased (inf --> -0.247130).  Saving model ...
Epoch: 2 cost time: 2.4935686588287354
Epoch: 2, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
Validation loss decreased (-0.247130 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 2.189546585083008
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.437 Vali Acc: 0.243 Test Loss: 1.437 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9602868556976318
Epoch: 4, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.638 Vali Acc: 0.228 Test Loss: 1.638 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8529565334320068
Epoch: 5, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.482 Vali Acc: 0.262 Test Loss: 1.482 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9290251731872559
Epoch: 6, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.642 Vali Acc: 0.270 Test Loss: 1.642 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3899292945861816
Epoch: 7, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.620 Vali Acc: 0.205 Test Loss: 1.620 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.630080461502075
Epoch: 8, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.679 Vali Acc: 0.221 Test Loss: 1.679 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.639004945755005
Epoch: 9, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.868 Vali Acc: 0.247 Test Loss: 1.868 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0617477893829346
Epoch: 10, Steps: 17 | Train Loss: 1.049 Vali Loss: 2.076 Vali Acc: 0.266 Test Loss: 2.076 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2142715454101562
Epoch: 11, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.445 Vali Acc: 0.251 Test Loss: 2.445 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2997078895568848
Epoch: 12, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.803 Vali Acc: 0.243 Test Loss: 1.803 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30011140
model size : 129.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.228400707244873
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.444 Vali Acc: 0.255 Test Loss: 1.444 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.936194896697998
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.477 Vali Acc: 0.289 Test Loss: 1.477 Test Acc: 0.289
Validation loss decreased (-0.254738 --> -0.288959).  Saving model ...
Epoch: 3 cost time: 2.3082945346832275
Epoch: 3, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.451 Vali Acc: 0.266 Test Loss: 1.451 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4910287857055664
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.454 Vali Acc: 0.293 Test Loss: 1.454 Test Acc: 0.293
Validation loss decreased (-0.288959 --> -0.292761).  Saving model ...
Epoch: 5 cost time: 2.177922487258911
Epoch: 5, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.504 Vali Acc: 0.266 Test Loss: 1.504 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2226758003234863
Epoch: 6, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.513 Vali Acc: 0.247 Test Loss: 1.513 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.94297194480896
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.691 Vali Acc: 0.259 Test Loss: 1.691 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4637482166290283
Epoch: 8, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.759 Vali Acc: 0.270 Test Loss: 1.759 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3759002685546875
Epoch: 9, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.810 Vali Acc: 0.251 Test Loss: 1.810 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2885375022888184
Epoch: 10, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.791 Vali Acc: 0.255 Test Loss: 1.791 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8675642013549805
Epoch: 11, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.765 Vali Acc: 0.243 Test Loss: 1.765 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.306692600250244
Epoch: 12, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.022 Vali Acc: 0.236 Test Loss: 2.022 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.454636335372925
Epoch: 13, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.840 Vali Acc: 0.247 Test Loss: 1.840 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1317508220672607
Epoch: 14, Steps: 17 | Train Loss: 1.038 Vali Loss: 2.200 Vali Acc: 0.224 Test Loss: 2.200 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 29928196
model size : 128.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps98_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.506234407424927
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.496 Vali Acc: 0.266 Test Loss: 1.496 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 3.563385248184204
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.572 Vali Acc: 0.247 Test Loss: 1.572 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.147980213165283
Epoch: 3, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.511 Vali Acc: 0.255 Test Loss: 1.511 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2808539867401123
Epoch: 4, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.708 Vali Acc: 0.259 Test Loss: 1.708 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.703577756881714
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.596 Vali Acc: 0.255 Test Loss: 1.596 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8972253799438477
Epoch: 6, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.818 Vali Acc: 0.247 Test Loss: 1.818 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.215592622756958
Epoch: 7, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.774 Vali Acc: 0.259 Test Loss: 1.774 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.326324701309204
Epoch: 8, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.961 Vali Acc: 0.221 Test Loss: 1.961 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.366243839263916
Epoch: 9, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.985 Vali Acc: 0.266 Test Loss: 1.985 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.341358184814453
Epoch: 10, Steps: 17 | Train Loss: 1.137 Vali Loss: 2.048 Vali Acc: 0.281 Test Loss: 2.048 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281348).  Saving model ...
Epoch: 11 cost time: 3.152592897415161
Epoch: 11, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.860 Vali Acc: 0.243 Test Loss: 1.860 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3520474433898926
Epoch: 12, Steps: 17 | Train Loss: 0.945 Vali Loss: 2.396 Vali Acc: 0.243 Test Loss: 2.396 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6856448650360107
Epoch: 13, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.222 Vali Acc: 0.255 Test Loss: 2.222 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.17037034034729
Epoch: 14, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.865 Vali Acc: 0.240 Test Loss: 1.865 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.983463764190674
Epoch: 15, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.793 Vali Acc: 0.228 Test Loss: 2.793 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.487161159515381
Epoch: 16, Steps: 17 | Train Loss: 0.844 Vali Loss: 2.197 Vali Acc: 0.262 Test Loss: 2.197 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1635756492614746
Epoch: 17, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.391 Vali Acc: 0.251 Test Loss: 2.391 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4187140464782715
Epoch: 18, Steps: 17 | Train Loss: 0.720 Vali Loss: 3.917 Vali Acc: 0.266 Test Loss: 3.917 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2756857872009277
Epoch: 19, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.533 Vali Acc: 0.262 Test Loss: 2.533 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5480129718780518
Epoch: 20, Steps: 17 | Train Loss: 0.680 Vali Loss: 2.752 Vali Acc: 0.236 Test Loss: 2.752 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps98_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30188548
model size : 129.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps98_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.185699462890625
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.474 Vali Acc: 0.270 Test Loss: 1.474 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 2.1871509552001953
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.476 Vali Acc: 0.240 Test Loss: 1.476 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.282927989959717
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.745 Vali Acc: 0.255 Test Loss: 1.745 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3086097240448
Epoch: 4, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.696 Vali Acc: 0.251 Test Loss: 1.696 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.314030885696411
Epoch: 5, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.807 Vali Acc: 0.251 Test Loss: 1.807 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3916280269622803
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.888 Vali Acc: 0.262 Test Loss: 1.888 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7197470664978027
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.475 Vali Acc: 0.289 Test Loss: 1.475 Test Acc: 0.289
Validation loss decreased (-0.269947 --> -0.288959).  Saving model ...
Epoch: 8 cost time: 2.421213388442993
Epoch: 8, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.954 Vali Acc: 0.255 Test Loss: 1.954 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5173442363739014
Epoch: 9, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.918 Vali Acc: 0.236 Test Loss: 1.918 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.265258550643921
Epoch: 10, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.804 Vali Acc: 0.255 Test Loss: 1.804 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.269620418548584
Epoch: 11, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.987 Vali Acc: 0.247 Test Loss: 1.987 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7113547325134277
Epoch: 12, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.953 Vali Acc: 0.236 Test Loss: 1.953 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0093350410461426
Epoch: 13, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.848 Vali Acc: 0.259 Test Loss: 1.848 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.163184642791748
Epoch: 14, Steps: 17 | Train Loss: 0.921 Vali Loss: 2.143 Vali Acc: 0.259 Test Loss: 2.143 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.096072196960449
Epoch: 15, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.217 Vali Acc: 0.224 Test Loss: 2.217 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8907067775726318
Epoch: 16, Steps: 17 | Train Loss: 0.987 Vali Loss: 2.492 Vali Acc: 0.259 Test Loss: 2.492 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.22117018699646
Epoch: 17, Steps: 17 | Train Loss: 0.808 Vali Loss: 2.701 Vali Acc: 0.281 Test Loss: 2.701 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps98_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 30036484
model size : 129.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps98_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.153403282165527
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.429 Vali Acc: 0.285 Test Loss: 1.429 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.9261937141418457
Epoch: 2, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.435 Vali Acc: 0.259 Test Loss: 1.435 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1339669227600098
Epoch: 3, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.601 Vali Acc: 0.232 Test Loss: 1.601 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8107311725616455
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.505 Vali Acc: 0.278 Test Loss: 1.505 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8404443264007568
Epoch: 5, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.479 Vali Acc: 0.266 Test Loss: 1.479 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.064155340194702
Epoch: 6, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.601 Vali Acc: 0.259 Test Loss: 1.601 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8266746997833252
Epoch: 7, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.515 Vali Acc: 0.259 Test Loss: 1.515 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4972786903381348
Epoch: 8, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.750 Vali Acc: 0.255 Test Loss: 1.750 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7538180351257324
Epoch: 9, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.635 Vali Acc: 0.247 Test Loss: 1.635 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.736532211303711
Epoch: 10, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8299050331115723
Epoch: 11, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.676 Vali Acc: 0.270 Test Loss: 1.676 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps98_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 29958148
model size : 128.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps103_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.2011964321136475
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.491 Vali Acc: 0.247 Test Loss: 1.491 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 2.6559481620788574
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.453 Vali Acc: 0.259 Test Loss: 1.453 Test Acc: 0.259
Validation loss decreased (-0.247133 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 3.01898193359375
Epoch: 3, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.466 Vali Acc: 0.243 Test Loss: 1.466 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.032297134399414
Epoch: 4, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.566 Vali Acc: 0.228 Test Loss: 1.566 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.322359085083008
Epoch: 5, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.584 Vali Acc: 0.236 Test Loss: 1.584 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2674427032470703
Epoch: 6, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.649 Vali Acc: 0.224 Test Loss: 1.649 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3168816566467285
Epoch: 7, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.697 Vali Acc: 0.247 Test Loss: 1.697 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8504860401153564
Epoch: 8, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.795 Vali Acc: 0.247 Test Loss: 1.795 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.744338035583496
Epoch: 9, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.863 Vali Acc: 0.232 Test Loss: 1.863 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.821769952774048
Epoch: 10, Steps: 17 | Train Loss: 1.027 Vali Loss: 2.062 Vali Acc: 0.255 Test Loss: 2.062 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.354501485824585
Epoch: 11, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.767 Vali Acc: 0.243 Test Loss: 1.767 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.2481250762939453
Epoch: 12, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.759 Vali Acc: 0.243 Test Loss: 1.759 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps103_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 30209284
model size : 129.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps103_str52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.23354172706604
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.448 Vali Acc: 0.240 Test Loss: 1.448 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 2.055490255355835
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.514 Vali Acc: 0.243 Test Loss: 1.514 Test Acc: 0.243
Validation loss decreased (-0.239529 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 2.622587203979492
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
Validation loss decreased (-0.243331 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 2.312687397003174
Epoch: 4, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.489 Vali Acc: 0.251 Test Loss: 1.489 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3714699745178223
Epoch: 5, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.649 Vali Acc: 0.251 Test Loss: 1.649 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9519495964050293
Epoch: 6, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.540 Vali Acc: 0.243 Test Loss: 1.540 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3387136459350586
Epoch: 7, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.941 Vali Acc: 0.270 Test Loss: 1.941 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269943).  Saving model ...
Epoch: 8 cost time: 1.4923651218414307
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.639 Vali Acc: 0.247 Test Loss: 1.639 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8050119876861572
Epoch: 9, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.804 Vali Acc: 0.232 Test Loss: 1.804 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5601108074188232
Epoch: 10, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.997 Vali Acc: 0.217 Test Loss: 1.997 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5847272872924805
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.832 Vali Acc: 0.251 Test Loss: 1.832 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8686325550079346
Epoch: 12, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.697 Vali Acc: 0.247 Test Loss: 1.697 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7252507209777832
Epoch: 13, Steps: 17 | Train Loss: 0.889 Vali Loss: 2.048 Vali Acc: 0.240 Test Loss: 2.048 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3194491863250732
Epoch: 14, Steps: 17 | Train Loss: 0.911 Vali Loss: 2.215 Vali Acc: 0.278 Test Loss: 2.215 Test Acc: 0.278
Validation loss decreased (-0.269943 --> -0.277544).  Saving model ...
Epoch: 15 cost time: 1.8521881103515625
Epoch: 15, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.604 Vali Acc: 0.281 Test Loss: 1.604 Test Acc: 0.281
Validation loss decreased (-0.277544 --> -0.281353).  Saving model ...
Epoch: 16 cost time: 2.2537412643432617
Epoch: 16, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.285 Vali Acc: 0.255 Test Loss: 2.285 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4658071994781494
Epoch: 17, Steps: 17 | Train Loss: 0.879 Vali Loss: 2.112 Vali Acc: 0.236 Test Loss: 2.112 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.204679489135742
Epoch: 18, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.496 Vali Acc: 0.217 Test Loss: 2.496 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6508958339691162
Epoch: 19, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.833 Vali Acc: 0.232 Test Loss: 2.833 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7937445640563965
Epoch: 20, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.977 Vali Acc: 0.251 Test Loss: 1.977 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1748340129852295
Epoch: 21, Steps: 17 | Train Loss: 0.716 Vali Loss: 2.652 Vali Acc: 0.243 Test Loss: 2.652 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.262129545211792
Epoch: 22, Steps: 17 | Train Loss: 0.769 Vali Loss: 2.717 Vali Acc: 0.221 Test Loss: 2.717 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.015385389328003
Epoch: 23, Steps: 17 | Train Loss: 0.742 Vali Loss: 2.696 Vali Acc: 0.232 Test Loss: 2.696 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.391894578933716
Epoch: 24, Steps: 17 | Train Loss: 0.893 Vali Loss: 3.094 Vali Acc: 0.213 Test Loss: 3.094 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.32708740234375
Epoch: 25, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.572 Vali Acc: 0.224 Test Loss: 2.572 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps103_str52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30061828
model size : 129.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps103_str103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.189417123794556
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.422 Vali Acc: 0.232 Test Loss: 1.422 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 2.321624279022217
Epoch: 2, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.504 Vali Acc: 0.232 Test Loss: 1.504 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.192680597305298
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.544 Vali Acc: 0.274 Test Loss: 1.544 Test Acc: 0.274
Validation loss decreased (-0.231925 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 2.3249592781066895
Epoch: 4, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.552 Vali Acc: 0.278 Test Loss: 1.552 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 1.9189250469207764
Epoch: 5, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.475 Vali Acc: 0.285 Test Loss: 1.475 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 1.8496148586273193
Epoch: 6, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.642 Vali Acc: 0.228 Test Loss: 1.642 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4749822616577148
Epoch: 7, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.719 Vali Acc: 0.259 Test Loss: 1.719 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.834817886352539
Epoch: 8, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.924 Vali Acc: 0.236 Test Loss: 1.924 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.783158779144287
Epoch: 9, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.878 Vali Acc: 0.209 Test Loss: 1.878 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.437967300415039
Epoch: 10, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.811 Vali Acc: 0.240 Test Loss: 1.811 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.516577959060669
Epoch: 11, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.721 Vali Acc: 0.217 Test Loss: 1.721 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7460343837738037
Epoch: 12, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.937 Vali Acc: 0.228 Test Loss: 1.937 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.984560489654541
Epoch: 13, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.897 Vali Acc: 0.221 Test Loss: 1.897 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.842336654663086
Epoch: 14, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.953 Vali Acc: 0.221 Test Loss: 1.953 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.809128761291504
Epoch: 15, Steps: 17 | Train Loss: 0.834 Vali Loss: 2.004 Vali Acc: 0.224 Test Loss: 2.004 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps103_str103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 29992708
model size : 129.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps110_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.048903226852417
Epoch: 1, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.514 Vali Acc: 0.266 Test Loss: 1.514 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 2.2967569828033447
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.460 Vali Acc: 0.281 Test Loss: 1.460 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 2.867842197418213
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.722 Vali Acc: 0.240 Test Loss: 1.722 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5611381530761719
Epoch: 4, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.737 Vali Acc: 0.236 Test Loss: 1.737 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6058502197265625
Epoch: 5, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.548 Vali Acc: 0.259 Test Loss: 1.548 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5942652225494385
Epoch: 6, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.879 Vali Acc: 0.251 Test Loss: 1.879 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9621238708496094
Epoch: 7, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.579 Vali Acc: 0.255 Test Loss: 1.579 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6609885692596436
Epoch: 8, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.999 Vali Acc: 0.232 Test Loss: 1.999 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5604019165039062
Epoch: 9, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.812 Vali Acc: 0.247 Test Loss: 1.812 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.298177480697632
Epoch: 10, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.985 Vali Acc: 0.251 Test Loss: 1.985 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.850900888442993
Epoch: 11, Steps: 17 | Train Loss: 1.032 Vali Loss: 2.135 Vali Acc: 0.236 Test Loss: 2.135 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.864487409591675
Epoch: 12, Steps: 17 | Train Loss: 1.002 Vali Loss: 2.222 Vali Acc: 0.293 Test Loss: 2.222 Test Acc: 0.293
Validation loss decreased (-0.281354 --> -0.292753).  Saving model ...
Epoch: 13 cost time: 2.9114627838134766
Epoch: 13, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.795 Vali Acc: 0.274 Test Loss: 1.795 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.162114381790161
Epoch: 14, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.327 Vali Acc: 0.247 Test Loss: 2.327 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7518560886383057
Epoch: 15, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.105 Vali Acc: 0.232 Test Loss: 2.105 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.177988052368164
Epoch: 16, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.477 Vali Acc: 0.259 Test Loss: 2.477 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.534043550491333
Epoch: 17, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.627 Vali Acc: 0.255 Test Loss: 2.627 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4457345008850098
Epoch: 18, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.752 Vali Acc: 0.228 Test Loss: 2.752 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.928252935409546
Epoch: 19, Steps: 17 | Train Loss: 0.804 Vali Loss: 3.015 Vali Acc: 0.274 Test Loss: 3.015 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7225699424743652
Epoch: 20, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.629 Vali Acc: 0.255 Test Loss: 2.629 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9578816890716553
Epoch: 21, Steps: 17 | Train Loss: 0.628 Vali Loss: 3.065 Vali Acc: 0.259 Test Loss: 3.065 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6661226749420166
Epoch: 22, Steps: 17 | Train Loss: 0.710 Vali Loss: 3.167 Vali Acc: 0.266 Test Loss: 3.167 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps110_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 30234628
model size : 130.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps110_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.000666379928589
Epoch: 1, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.441 Vali Acc: 0.281 Test Loss: 1.441 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 2.188603401184082
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.451 Vali Acc: 0.262 Test Loss: 1.451 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6952688694000244
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.609 Vali Acc: 0.266 Test Loss: 1.609 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1775236129760742
Epoch: 4, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.683 Vali Acc: 0.255 Test Loss: 1.683 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3915455341339111
Epoch: 5, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.474 Vali Acc: 0.221 Test Loss: 1.474 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9122200012207031
Epoch: 6, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.809 Vali Acc: 0.240 Test Loss: 1.809 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0534067153930664
Epoch: 7, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.757 Vali Acc: 0.262 Test Loss: 1.757 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.035039186477661
Epoch: 8, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.687 Vali Acc: 0.259 Test Loss: 1.687 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2346420288085938
Epoch: 9, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.802 Vali Acc: 0.247 Test Loss: 1.802 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8912220001220703
Epoch: 10, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.924 Vali Acc: 0.266 Test Loss: 1.924 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.678272008895874
Epoch: 11, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.074 Vali Acc: 0.266 Test Loss: 2.074 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps110_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30100996
model size : 129.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps110_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.789719581604004
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.464 Vali Acc: 0.247 Test Loss: 1.464 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.7364749908447266
Epoch: 2, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.530 Vali Acc: 0.255 Test Loss: 1.530 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.9268732070922852
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.510 Vali Acc: 0.274 Test Loss: 1.510 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 1.3664381504058838
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.510 Vali Acc: 0.266 Test Loss: 1.510 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.222679853439331
Epoch: 5, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.505 Vali Acc: 0.240 Test Loss: 1.505 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4583170413970947
Epoch: 6, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.541 Vali Acc: 0.281 Test Loss: 1.541 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281353).  Saving model ...
Epoch: 7 cost time: 1.283111572265625
Epoch: 7, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.529 Vali Acc: 0.236 Test Loss: 1.529 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4729869365692139
Epoch: 8, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.613 Vali Acc: 0.270 Test Loss: 1.613 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4692671298980713
Epoch: 9, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.868 Vali Acc: 0.228 Test Loss: 1.868 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7093873023986816
Epoch: 10, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.763 Vali Acc: 0.262 Test Loss: 1.763 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1957409381866455
Epoch: 11, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.856 Vali Acc: 0.243 Test Loss: 1.856 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8979129791259766
Epoch: 12, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.761 Vali Acc: 0.236 Test Loss: 1.761 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.809023380279541
Epoch: 13, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.909 Vali Acc: 0.221 Test Loss: 1.909 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5610170364379883
Epoch: 14, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.024 Vali Acc: 0.266 Test Loss: 2.024 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8726530075073242
Epoch: 15, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.134 Vali Acc: 0.255 Test Loss: 2.134 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7583715915679932
Epoch: 16, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.794 Vali Acc: 0.224 Test Loss: 1.794 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps110_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30031876
model size : 129.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps117_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.649464845657349
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.555 Vali Acc: 0.243 Test Loss: 1.555 Test Acc: 0.243
Validation loss decreased (inf --> -0.243330).  Saving model ...
Epoch: 2 cost time: 2.7117366790771484
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.502 Vali Acc: 0.232 Test Loss: 1.502 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.911280393600464
Epoch: 3, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.517 Vali Acc: 0.278 Test Loss: 1.517 Test Acc: 0.278
Validation loss decreased (-0.243330 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 2.301244020462036
Epoch: 4, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.803 Vali Acc: 0.259 Test Loss: 1.803 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4172708988189697
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.798 Vali Acc: 0.251 Test Loss: 1.798 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.885684013366699
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.563 Vali Acc: 0.259 Test Loss: 1.563 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3995766639709473
Epoch: 7, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.837 Vali Acc: 0.274 Test Loss: 1.837 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.850705623626709
Epoch: 8, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.231 Vali Acc: 0.232 Test Loss: 2.231 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7560789585113525
Epoch: 9, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.557 Vali Acc: 0.240 Test Loss: 1.557 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4979400634765625
Epoch: 10, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.600 Vali Acc: 0.251 Test Loss: 1.600 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5272090435028076
Epoch: 11, Steps: 17 | Train Loss: 1.144 Vali Loss: 2.074 Vali Acc: 0.262 Test Loss: 2.074 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2904858589172363
Epoch: 12, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.991 Vali Acc: 0.228 Test Loss: 1.991 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.728419065475464
Epoch: 13, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.077 Vali Acc: 0.251 Test Loss: 2.077 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps117_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 30264580
model size : 130.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps117_str59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.587756872177124
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.463 Vali Acc: 0.285 Test Loss: 1.463 Test Acc: 0.285
Validation loss decreased (inf --> -0.285156).  Saving model ...
Epoch: 2 cost time: 2.023141860961914
Epoch: 2, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.426 Vali Acc: 0.304 Test Loss: 1.426 Test Acc: 0.304
Validation loss decreased (-0.285156 --> -0.304168).  Saving model ...
Epoch: 3 cost time: 1.6658904552459717
Epoch: 3, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.511 Vali Acc: 0.278 Test Loss: 1.511 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.760653257369995
Epoch: 4, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6271026134490967
Epoch: 5, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.493 Vali Acc: 0.228 Test Loss: 1.493 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.063471794128418
Epoch: 6, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.532 Vali Acc: 0.209 Test Loss: 1.532 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6841628551483154
Epoch: 7, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.657 Vali Acc: 0.274 Test Loss: 1.657 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0655739307403564
Epoch: 8, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.692 Vali Acc: 0.243 Test Loss: 1.692 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.034069061279297
Epoch: 9, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.829 Vali Acc: 0.232 Test Loss: 1.829 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9239983558654785
Epoch: 10, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.867 Vali Acc: 0.228 Test Loss: 1.867 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9088134765625
Epoch: 11, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.670 Vali Acc: 0.259 Test Loss: 1.670 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5118136405944824
Epoch: 12, Steps: 17 | Train Loss: 0.975 Vali Loss: 2.144 Vali Acc: 0.274 Test Loss: 2.144 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps117_str59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 30140164
model size : 129.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps117_str117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9406023025512695
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.421 Vali Acc: 0.300 Test Loss: 1.421 Test Acc: 0.300
Validation loss decreased (inf --> -0.300366).  Saving model ...
Epoch: 2 cost time: 1.7152321338653564
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.232783317565918
Epoch: 3, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.409 Vali Acc: 0.289 Test Loss: 1.409 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8296639919281006
Epoch: 4, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.523 Vali Acc: 0.262 Test Loss: 1.523 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0913891792297363
Epoch: 5, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.416 Vali Acc: 0.278 Test Loss: 1.416 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4139618873596191
Epoch: 6, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.465 Vali Acc: 0.251 Test Loss: 1.465 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5537681579589844
Epoch: 7, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.656 Vali Acc: 0.266 Test Loss: 1.656 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5098111629486084
Epoch: 8, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.532 Vali Acc: 0.247 Test Loss: 1.532 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4903771877288818
Epoch: 9, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.774 Vali Acc: 0.270 Test Loss: 1.774 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5324277877807617
Epoch: 10, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.713 Vali Acc: 0.247 Test Loss: 1.713 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9046685695648193
Epoch: 11, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.663 Vali Acc: 0.255 Test Loss: 1.663 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps117_str117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 30075652
model size : 129.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps126_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.343293190002441
Epoch: 1, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.627 Vali Acc: 0.270 Test Loss: 1.627 Test Acc: 0.270
Validation loss decreased (inf --> -0.269946).  Saving model ...
Epoch: 2 cost time: 2.265007972717285
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.701 Vali Acc: 0.247 Test Loss: 1.701 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6177430152893066
Epoch: 3, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.672 Vali Acc: 0.228 Test Loss: 1.672 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5506508350372314
Epoch: 4, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.536 Vali Acc: 0.243 Test Loss: 1.536 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5117623805999756
Epoch: 5, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.465 Vali Acc: 0.247 Test Loss: 1.465 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.229524612426758
Epoch: 6, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.726 Vali Acc: 0.262 Test Loss: 1.726 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.018981456756592
Epoch: 7, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.617 Vali Acc: 0.255 Test Loss: 1.617 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.701117753982544
Epoch: 8, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.718 Vali Acc: 0.251 Test Loss: 1.718 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4060707092285156
Epoch: 9, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.956 Vali Acc: 0.213 Test Loss: 1.956 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.513012170791626
Epoch: 10, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.365 Vali Acc: 0.236 Test Loss: 2.365 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6304104328155518
Epoch: 11, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.830 Vali Acc: 0.259 Test Loss: 1.830 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps126_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30308356
model size : 130.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps126_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.717946767807007
Epoch: 1, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 2.5825226306915283
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.459 Vali Acc: 0.274 Test Loss: 1.459 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 2.2903518676757812
Epoch: 3, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.445 Vali Acc: 0.255 Test Loss: 1.445 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3505306243896484
Epoch: 4, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.573 Vali Acc: 0.266 Test Loss: 1.573 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.211362600326538
Epoch: 5, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.526 Vali Acc: 0.251 Test Loss: 1.526 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.275437355041504
Epoch: 6, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.599 Vali Acc: 0.228 Test Loss: 1.599 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1392760276794434
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.645 Vali Acc: 0.232 Test Loss: 1.645 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.282837152481079
Epoch: 8, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.615 Vali Acc: 0.247 Test Loss: 1.615 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8923745155334473
Epoch: 9, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.938 Vali Acc: 0.236 Test Loss: 1.938 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9389824867248535
Epoch: 10, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.849 Vali Acc: 0.266 Test Loss: 1.849 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9971492290496826
Epoch: 11, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.067 Vali Acc: 0.228 Test Loss: 2.067 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9315667152404785
Epoch: 12, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.882 Vali Acc: 0.259 Test Loss: 1.882 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps126_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 30193156
model size : 129.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps126_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7302145957946777
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.428 Vali Acc: 0.232 Test Loss: 1.428 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.2126953601837158
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.591 Vali Acc: 0.228 Test Loss: 1.591 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.626699686050415
Epoch: 3, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.438 Vali Acc: 0.262 Test Loss: 1.438 Test Acc: 0.262
Validation loss decreased (-0.231925 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.4121875762939453
Epoch: 4, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.448 Vali Acc: 0.240 Test Loss: 1.448 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5679097175598145
Epoch: 5, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.532 Vali Acc: 0.247 Test Loss: 1.532 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5845801830291748
Epoch: 6, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.490 Vali Acc: 0.243 Test Loss: 1.490 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.534837245941162
Epoch: 7, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.581 Vali Acc: 0.224 Test Loss: 1.581 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8459534645080566
Epoch: 8, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.569 Vali Acc: 0.228 Test Loss: 1.569 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.655562162399292
Epoch: 9, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.715 Vali Acc: 0.217 Test Loss: 1.715 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4117040634155273
Epoch: 10, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.719 Vali Acc: 0.236 Test Loss: 1.719 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.523772954940796
Epoch: 11, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.621 Vali Acc: 0.251 Test Loss: 1.621 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.374220848083496
Epoch: 12, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.070 Vali Acc: 0.251 Test Loss: 2.070 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5925023555755615
Epoch: 13, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.829 Vali Acc: 0.274 Test Loss: 1.829 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273746).  Saving model ...
Epoch: 14 cost time: 1.4575862884521484
Epoch: 14, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.784 Vali Acc: 0.243 Test Loss: 1.784 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6199238300323486
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.934 Vali Acc: 0.243 Test Loss: 1.934 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.638597011566162
Epoch: 16, Steps: 17 | Train Loss: 0.880 Vali Loss: 2.015 Vali Acc: 0.209 Test Loss: 2.015 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6603925228118896
Epoch: 17, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.386 Vali Acc: 0.228 Test Loss: 2.386 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3280634880065918
Epoch: 18, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.863 Vali Acc: 0.255 Test Loss: 1.863 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4269180297851562
Epoch: 19, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.266 Vali Acc: 0.232 Test Loss: 2.266 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.492048740386963
Epoch: 20, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.294 Vali Acc: 0.243 Test Loss: 2.294 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3344652652740479
Epoch: 21, Steps: 17 | Train Loss: 0.847 Vali Loss: 2.116 Vali Acc: 0.213 Test Loss: 2.116 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4139151573181152
Epoch: 22, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.393 Vali Acc: 0.243 Test Loss: 2.393 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.729236364364624
Epoch: 23, Steps: 17 | Train Loss: 0.867 Vali Loss: 2.221 Vali Acc: 0.243 Test Loss: 2.221 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps126_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 30133252
model size : 129.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps135_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.472506523132324
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.425 Vali Acc: 0.266 Test Loss: 1.425 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 3.0611183643341064
Epoch: 2, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.498 Vali Acc: 0.255 Test Loss: 1.498 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3109002113342285
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.517 Vali Acc: 0.228 Test Loss: 1.517 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4768576622009277
Epoch: 4, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.545 Vali Acc: 0.224 Test Loss: 1.545 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9882590770721436
Epoch: 5, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.598 Vali Acc: 0.259 Test Loss: 1.598 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.91670298576355
Epoch: 6, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.716599702835083
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.565 Vali Acc: 0.236 Test Loss: 1.565 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.449989080429077
Epoch: 8, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.730 Vali Acc: 0.259 Test Loss: 1.730 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7831637859344482
Epoch: 9, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.642 Vali Acc: 0.240 Test Loss: 1.642 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.60795259475708
Epoch: 10, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.500 Vali Acc: 0.270 Test Loss: 2.500 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269937).  Saving model ...
Epoch: 11 cost time: 2.395047903060913
Epoch: 11, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.752 Vali Acc: 0.251 Test Loss: 1.752 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.633145332336426
Epoch: 12, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.583 Vali Acc: 0.270 Test Loss: 2.583 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.363865613937378
Epoch: 13, Steps: 17 | Train Loss: 1.107 Vali Loss: 2.158 Vali Acc: 0.262 Test Loss: 2.158 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8255274295806885
Epoch: 14, Steps: 17 | Train Loss: 0.835 Vali Loss: 2.059 Vali Acc: 0.266 Test Loss: 2.059 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.211961030960083
Epoch: 15, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.649 Vali Acc: 0.262 Test Loss: 2.649 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.083724021911621
Epoch: 16, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.744 Vali Acc: 0.217 Test Loss: 2.744 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5000200271606445
Epoch: 17, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.419 Vali Acc: 0.236 Test Loss: 2.419 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.436547040939331
Epoch: 18, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.208 Vali Acc: 0.247 Test Loss: 2.208 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.180995464324951
Epoch: 19, Steps: 17 | Train Loss: 0.763 Vali Loss: 3.200 Vali Acc: 0.224 Test Loss: 3.200 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.467989206314087
Epoch: 20, Steps: 17 | Train Loss: 0.643 Vali Loss: 3.086 Vali Acc: 0.240 Test Loss: 3.086 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps135_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30356740
model size : 130.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8613998889923096
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.446 Vali Acc: 0.274 Test Loss: 1.446 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.541438341140747
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.507 Vali Acc: 0.266 Test Loss: 1.507 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2550718784332275
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.481 Vali Acc: 0.278 Test Loss: 1.481 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.9382669925689697
Epoch: 4, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.580 Vali Acc: 0.270 Test Loss: 1.580 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3793959617614746
Epoch: 5, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.526 Vali Acc: 0.278 Test Loss: 1.526 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.025832414627075
Epoch: 6, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.859 Vali Acc: 0.270 Test Loss: 1.859 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5522081851959229
Epoch: 7, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.570 Vali Acc: 0.251 Test Loss: 1.570 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5251257419586182
Epoch: 8, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.799 Vali Acc: 0.255 Test Loss: 1.799 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.144509792327881
Epoch: 9, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.602 Vali Acc: 0.236 Test Loss: 1.602 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.272202730178833
Epoch: 10, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.561 Vali Acc: 0.270 Test Loss: 1.561 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.316372871398926
Epoch: 11, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.977 Vali Acc: 0.243 Test Loss: 1.977 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.995072603225708
Epoch: 12, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.858 Vali Acc: 0.259 Test Loss: 1.858 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4010708332061768
Epoch: 13, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.951 Vali Acc: 0.266 Test Loss: 1.951 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 30246148
model size : 130.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps135_str135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.091933965682983
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.443 Vali Acc: 0.259 Test Loss: 1.443 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.0006399154663086
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.509 Vali Acc: 0.278 Test Loss: 1.509 Test Acc: 0.278
Validation loss decreased (-0.258541 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 1.562917709350586
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.455 Vali Acc: 0.281 Test Loss: 1.455 Test Acc: 0.281
Validation loss decreased (-0.277551 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.7515747547149658
Epoch: 4, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.453 Vali Acc: 0.289 Test Loss: 1.453 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 1.898125171661377
Epoch: 5, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.469 Vali Acc: 0.274 Test Loss: 1.469 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6746532917022705
Epoch: 6, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.545 Vali Acc: 0.300 Test Loss: 1.545 Test Acc: 0.300
Validation loss decreased (-0.288959 --> -0.300365).  Saving model ...
Epoch: 7 cost time: 1.6476857662200928
Epoch: 7, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.538 Vali Acc: 0.251 Test Loss: 1.538 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4977335929870605
Epoch: 8, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.840 Vali Acc: 0.243 Test Loss: 1.840 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1606388092041016
Epoch: 9, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.826 Vali Acc: 0.243 Test Loss: 1.826 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4371678829193115
Epoch: 10, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.564 Vali Acc: 0.232 Test Loss: 1.564 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5761644840240479
Epoch: 11, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.696 Vali Acc: 0.228 Test Loss: 1.696 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3131484985351562
Epoch: 12, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.811 Vali Acc: 0.247 Test Loss: 1.811 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2807230949401855
Epoch: 13, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.789 Vali Acc: 0.213 Test Loss: 1.789 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6107151508331299
Epoch: 14, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.844 Vali Acc: 0.247 Test Loss: 1.844 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8287975788116455
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.837 Vali Acc: 0.247 Test Loss: 1.837 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8606317043304443
Epoch: 16, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.147 Vali Acc: 0.270 Test Loss: 2.147 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps135_str135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 30190852
model size : 129.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps146_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.329649925231934
Epoch: 1, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.555 Vali Acc: 0.240 Test Loss: 1.555 Test Acc: 0.240
Validation loss decreased (inf --> -0.239528).  Saving model ...
Epoch: 2 cost time: 2.27431058883667
Epoch: 2, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.496 Vali Acc: 0.266 Test Loss: 1.496 Test Acc: 0.266
Validation loss decreased (-0.239528 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 2.4044673442840576
Epoch: 3, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.442 Vali Acc: 0.262 Test Loss: 1.442 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.744861125946045
Epoch: 4, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.588 Vali Acc: 0.217 Test Loss: 1.588 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2470035552978516
Epoch: 5, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.530 Vali Acc: 0.278 Test Loss: 1.530 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277551).  Saving model ...
Epoch: 6 cost time: 2.4181134700775146
Epoch: 6, Steps: 17 | Train Loss: 1.138 Vali Loss: 2.159 Vali Acc: 0.251 Test Loss: 2.159 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.629662275314331
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.725 Vali Acc: 0.240 Test Loss: 1.725 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.375213623046875
Epoch: 8, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.888 Vali Acc: 0.243 Test Loss: 1.888 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.373918294906616
Epoch: 9, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.817 Vali Acc: 0.270 Test Loss: 1.817 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9082648754119873
Epoch: 10, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.601 Vali Acc: 0.224 Test Loss: 1.601 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2267191410064697
Epoch: 11, Steps: 17 | Train Loss: 0.953 Vali Loss: 2.102 Vali Acc: 0.209 Test Loss: 2.102 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8521041870117188
Epoch: 12, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.194 Vali Acc: 0.228 Test Loss: 2.194 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.657310962677002
Epoch: 13, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.848 Vali Acc: 0.251 Test Loss: 1.848 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.6010725498199463
Epoch: 14, Steps: 17 | Train Loss: 0.983 Vali Loss: 2.047 Vali Acc: 0.247 Test Loss: 2.047 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4570581912994385
Epoch: 15, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.112 Vali Acc: 0.240 Test Loss: 2.112 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps146_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 30414340
model size : 130.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps146_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.192579507827759
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.501 Vali Acc: 0.240 Test Loss: 1.501 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 2.3612163066864014
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.517 Vali Acc: 0.255 Test Loss: 1.517 Test Acc: 0.255
Validation loss decreased (-0.239529 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 2.3503222465515137
Epoch: 3, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.530 Vali Acc: 0.259 Test Loss: 1.530 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258540).  Saving model ...
Epoch: 4 cost time: 2.393355131149292
Epoch: 4, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.495 Vali Acc: 0.274 Test Loss: 1.495 Test Acc: 0.274
Validation loss decreased (-0.258540 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 2.4830284118652344
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.502 Vali Acc: 0.228 Test Loss: 1.502 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.093336582183838
Epoch: 6, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.499 Vali Acc: 0.281 Test Loss: 1.499 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281354).  Saving model ...
Epoch: 7 cost time: 2.074833631515503
Epoch: 7, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.608 Vali Acc: 0.274 Test Loss: 1.608 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3538753986358643
Epoch: 8, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.873 Vali Acc: 0.240 Test Loss: 1.873 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3954076766967773
Epoch: 9, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.718 Vali Acc: 0.247 Test Loss: 1.718 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6688153743743896
Epoch: 10, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.741 Vali Acc: 0.228 Test Loss: 1.741 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.508413553237915
Epoch: 11, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.733 Vali Acc: 0.213 Test Loss: 1.733 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8351380825042725
Epoch: 12, Steps: 17 | Train Loss: 0.942 Vali Loss: 2.105 Vali Acc: 0.232 Test Loss: 2.105 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3566997051239014
Epoch: 13, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.722 Vali Acc: 0.255 Test Loss: 1.722 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7630727291107178
Epoch: 14, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.205 Vali Acc: 0.236 Test Loss: 2.205 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6687846183776855
Epoch: 15, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.046 Vali Acc: 0.255 Test Loss: 2.046 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.047024965286255
Epoch: 16, Steps: 17 | Train Loss: 0.836 Vali Loss: 2.129 Vali Acc: 0.232 Test Loss: 2.129 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps146_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30312964
model size : 130.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps146_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4535999298095703
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.461 Vali Acc: 0.240 Test Loss: 1.461 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.2133996486663818
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.512 Vali Acc: 0.259 Test Loss: 1.512 Test Acc: 0.259
Validation loss decreased (-0.239529 --> -0.258540).  Saving model ...
Epoch: 3 cost time: 1.3821110725402832
Epoch: 3, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.557 Vali Acc: 0.270 Test Loss: 1.557 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 1.4457015991210938
Epoch: 4, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.631 Vali Acc: 0.247 Test Loss: 1.631 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0574557781219482
Epoch: 5, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.679 Vali Acc: 0.274 Test Loss: 1.679 Test Acc: 0.274
Validation loss decreased (-0.269946 --> -0.273747).  Saving model ...
Epoch: 6 cost time: 1.3713810443878174
Epoch: 6, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.653 Vali Acc: 0.270 Test Loss: 1.653 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4514508247375488
Epoch: 7, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.587 Vali Acc: 0.255 Test Loss: 1.587 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4319729804992676
Epoch: 8, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.506 Vali Acc: 0.243 Test Loss: 1.506 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2428686618804932
Epoch: 9, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.884 Vali Acc: 0.221 Test Loss: 1.884 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3186023235321045
Epoch: 10, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.858 Vali Acc: 0.217 Test Loss: 1.858 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.227172613143921
Epoch: 11, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.732 Vali Acc: 0.240 Test Loss: 1.732 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4562158584594727
Epoch: 12, Steps: 17 | Train Loss: 0.942 Vali Loss: 2.334 Vali Acc: 0.224 Test Loss: 2.334 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6648609638214111
Epoch: 13, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.913 Vali Acc: 0.209 Test Loss: 1.913 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5610272884368896
Epoch: 14, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.105 Vali Acc: 0.247 Test Loss: 2.105 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4817709922790527
Epoch: 15, Steps: 17 | Train Loss: 0.997 Vali Loss: 2.046 Vali Acc: 0.236 Test Loss: 2.046 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps146_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 30262276
model size : 130.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps160_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.7813286781311035
Epoch: 1, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.572 Vali Acc: 0.262 Test Loss: 1.572 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 2.2909812927246094
Epoch: 2, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.458 Vali Acc: 0.262 Test Loss: 1.458 Test Acc: 0.262
Validation loss decreased (-0.262342 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 2.0769407749176025
Epoch: 3, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 2.47727370262146
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.577 Vali Acc: 0.255 Test Loss: 1.577 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.400347948074341
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.528 Vali Acc: 0.228 Test Loss: 1.528 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9793412685394287
Epoch: 6, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.681 Vali Acc: 0.270 Test Loss: 1.681 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269945).  Saving model ...
Epoch: 7 cost time: 2.1117680072784424
Epoch: 7, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.671 Vali Acc: 0.232 Test Loss: 1.671 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6346888542175293
Epoch: 8, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.675 Vali Acc: 0.259 Test Loss: 1.675 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9943337440490723
Epoch: 9, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.829 Vali Acc: 0.217 Test Loss: 1.829 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2885985374450684
Epoch: 10, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.867 Vali Acc: 0.240 Test Loss: 1.867 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.388730764389038
Epoch: 11, Steps: 17 | Train Loss: 1.013 Vali Loss: 2.245 Vali Acc: 0.259 Test Loss: 2.245 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0232717990875244
Epoch: 12, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.300 Vali Acc: 0.232 Test Loss: 2.300 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2808971405029297
Epoch: 13, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.412 Vali Acc: 0.247 Test Loss: 2.412 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0878994464874268
Epoch: 14, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.808 Vali Acc: 0.228 Test Loss: 1.808 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7776238918304443
Epoch: 15, Steps: 17 | Train Loss: 0.902 Vali Loss: 2.653 Vali Acc: 0.262 Test Loss: 2.653 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.738940954208374
Epoch: 16, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.982 Vali Acc: 0.224 Test Loss: 1.982 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps160_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30492676
model size : 130.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.244426012039185
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.469 Vali Acc: 0.262 Test Loss: 1.469 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.1961069107055664
Epoch: 2, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.458 Vali Acc: 0.232 Test Loss: 1.458 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7456388473510742
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.558 Vali Acc: 0.221 Test Loss: 1.558 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.640580415725708
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.546 Vali Acc: 0.232 Test Loss: 1.546 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5800666809082031
Epoch: 5, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.644 Vali Acc: 0.236 Test Loss: 1.644 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5881922245025635
Epoch: 6, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.689 Vali Acc: 0.259 Test Loss: 1.689 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7488760948181152
Epoch: 7, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.671 Vali Acc: 0.236 Test Loss: 1.671 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0075747966766357
Epoch: 8, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.944 Vali Acc: 0.300 Test Loss: 1.944 Test Acc: 0.300
Validation loss decreased (-0.262343 --> -0.300361).  Saving model ...
Epoch: 9 cost time: 2.0879740715026855
Epoch: 9, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.952 Vali Acc: 0.247 Test Loss: 1.952 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1200637817382812
Epoch: 10, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.548 Vali Acc: 0.243 Test Loss: 1.548 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8167388439178467
Epoch: 11, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.903 Vali Acc: 0.255 Test Loss: 1.903 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9686579704284668
Epoch: 12, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.856 Vali Acc: 0.262 Test Loss: 1.856 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5288314819335938
Epoch: 13, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.016 Vali Acc: 0.232 Test Loss: 2.016 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.694356918334961
Epoch: 14, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.805 Vali Acc: 0.255 Test Loss: 1.805 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.13899827003479
Epoch: 15, Steps: 17 | Train Loss: 0.928 Vali Loss: 2.028 Vali Acc: 0.289 Test Loss: 2.028 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.054717779159546
Epoch: 16, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.029 Vali Acc: 0.232 Test Loss: 2.029 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4757885932922363
Epoch: 17, Steps: 17 | Train Loss: 0.795 Vali Loss: 2.456 Vali Acc: 0.236 Test Loss: 2.456 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.115321636199951
Epoch: 18, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.908 Vali Acc: 0.251 Test Loss: 1.908 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 30400516
model size : 130.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps160_str160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8793368339538574
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.698974370956421
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.545 Vali Acc: 0.266 Test Loss: 1.545 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5922420024871826
Epoch: 3, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.430 Vali Acc: 0.236 Test Loss: 1.430 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.565124273300171
Epoch: 4, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.481 Vali Acc: 0.221 Test Loss: 1.481 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2135052680969238
Epoch: 5, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.835 Vali Acc: 0.217 Test Loss: 1.835 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6641933917999268
Epoch: 6, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.489 Vali Acc: 0.221 Test Loss: 1.489 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3532352447509766
Epoch: 7, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.667 Vali Acc: 0.270 Test Loss: 1.667 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2945995330810547
Epoch: 8, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.663 Vali Acc: 0.202 Test Loss: 1.663 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3109536170959473
Epoch: 9, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.633 Vali Acc: 0.266 Test Loss: 1.633 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2251200675964355
Epoch: 10, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.667 Vali Acc: 0.221 Test Loss: 1.667 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4605774879455566
Epoch: 11, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.842 Vali Acc: 0.270 Test Loss: 1.842 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps160_str160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30354436
model size : 130.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps176_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.056472539901733
Epoch: 1, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.700 Vali Acc: 0.247 Test Loss: 1.700 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 1.5375158786773682
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.489 Vali Acc: 0.251 Test Loss: 1.489 Test Acc: 0.251
Validation loss decreased (-0.247131 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 2.397810459136963
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.487 Vali Acc: 0.236 Test Loss: 1.487 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.076700448989868
Epoch: 4, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.663 Vali Acc: 0.262 Test Loss: 1.663 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262341).  Saving model ...
Epoch: 5 cost time: 2.4791722297668457
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.547 Vali Acc: 0.251 Test Loss: 1.547 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3978216648101807
Epoch: 6, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.690 Vali Acc: 0.243 Test Loss: 1.690 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3568272590637207
Epoch: 7, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.602 Vali Acc: 0.228 Test Loss: 1.602 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5546274185180664
Epoch: 8, Steps: 17 | Train Loss: 1.064 Vali Loss: 2.059 Vali Acc: 0.281 Test Loss: 2.059 Test Acc: 0.281
Validation loss decreased (-0.262341 --> -0.281348).  Saving model ...
Epoch: 9 cost time: 2.252013921737671
Epoch: 9, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.712 Vali Acc: 0.255 Test Loss: 1.712 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.187450647354126
Epoch: 10, Steps: 17 | Train Loss: 1.116 Vali Loss: 2.051 Vali Acc: 0.255 Test Loss: 2.051 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8335423469543457
Epoch: 11, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.834 Vali Acc: 0.270 Test Loss: 1.834 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8007688522338867
Epoch: 12, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.235 Vali Acc: 0.247 Test Loss: 2.235 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.068566083908081
Epoch: 13, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.951 Vali Acc: 0.255 Test Loss: 1.951 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.992999792098999
Epoch: 14, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.940 Vali Acc: 0.213 Test Loss: 1.940 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0348615646362305
Epoch: 15, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.886 Vali Acc: 0.247 Test Loss: 1.886 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.136826515197754
Epoch: 16, Steps: 17 | Train Loss: 0.903 Vali Loss: 2.267 Vali Acc: 0.209 Test Loss: 2.267 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.382265090942383
Epoch: 17, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.527 Vali Acc: 0.274 Test Loss: 2.527 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.606639862060547
Epoch: 18, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.884 Vali Acc: 0.224 Test Loss: 1.884 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps176_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30584836
model size : 131.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3278183937072754
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.461 Vali Acc: 0.255 Test Loss: 1.461 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.895909309387207
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.5976462364196777
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.571 Vali Acc: 0.251 Test Loss: 1.571 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0100812911987305
Epoch: 4, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.581 Vali Acc: 0.278 Test Loss: 1.581 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 2.1607377529144287
Epoch: 5, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.497 Vali Acc: 0.255 Test Loss: 1.497 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.925529956817627
Epoch: 6, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.532 Vali Acc: 0.228 Test Loss: 1.532 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7817401885986328
Epoch: 7, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.577 Vali Acc: 0.255 Test Loss: 1.577 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.075265645980835
Epoch: 8, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.709 Vali Acc: 0.247 Test Loss: 1.709 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7015190124511719
Epoch: 9, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.658 Vali Acc: 0.251 Test Loss: 1.658 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.329129695892334
Epoch: 10, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.747 Vali Acc: 0.270 Test Loss: 1.747 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.008402109146118
Epoch: 11, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.885380506515503
Epoch: 12, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.691 Vali Acc: 0.213 Test Loss: 1.691 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.354496955871582
Epoch: 13, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.900 Vali Acc: 0.255 Test Loss: 1.900 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.440648078918457
Epoch: 14, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.174 Vali Acc: 0.221 Test Loss: 2.174 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 30501892
model size : 131.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps176_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8422434329986572
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.431 Vali Acc: 0.251 Test Loss: 1.431 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.579765796661377
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.427 Vali Acc: 0.278 Test Loss: 1.427 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.4135205745697021
Epoch: 3, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.471 Vali Acc: 0.247 Test Loss: 1.471 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.574596643447876
Epoch: 4, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.468 Vali Acc: 0.281 Test Loss: 1.468 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 1.7413265705108643
Epoch: 5, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.663 Vali Acc: 0.247 Test Loss: 1.663 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5352375507354736
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.689 Vali Acc: 0.224 Test Loss: 1.689 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.631066083908081
Epoch: 7, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.530 Vali Acc: 0.255 Test Loss: 1.530 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4308044910430908
Epoch: 8, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.545 Vali Acc: 0.243 Test Loss: 1.545 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4250223636627197
Epoch: 9, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.718 Vali Acc: 0.247 Test Loss: 1.718 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5891759395599365
Epoch: 10, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.679 Vali Acc: 0.270 Test Loss: 1.679 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.655531644821167
Epoch: 11, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.784 Vali Acc: 0.224 Test Loss: 1.784 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.287719964981079
Epoch: 12, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.758 Vali Acc: 0.251 Test Loss: 1.758 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2930331230163574
Epoch: 13, Steps: 17 | Train Loss: 0.963 Vali Loss: 1.684 Vali Acc: 0.247 Test Loss: 1.684 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.486318588256836
Epoch: 14, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.770 Vali Acc: 0.259 Test Loss: 1.770 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps176_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30460420
model size : 130.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps195_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.246392011642456
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.443 Vali Acc: 0.285 Test Loss: 1.443 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 2.9524285793304443
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.470 Vali Acc: 0.270 Test Loss: 1.470 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0488903522491455
Epoch: 3, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.415 Vali Acc: 0.209 Test Loss: 1.415 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2847142219543457
Epoch: 4, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.541 Vali Acc: 0.259 Test Loss: 1.541 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.285546064376831
Epoch: 5, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.491 Vali Acc: 0.247 Test Loss: 1.491 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3152949810028076
Epoch: 6, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.483 Vali Acc: 0.243 Test Loss: 1.483 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5364573001861572
Epoch: 7, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.587 Vali Acc: 0.266 Test Loss: 1.587 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.025965929031372
Epoch: 8, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.688 Vali Acc: 0.255 Test Loss: 1.688 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.168980836868286
Epoch: 9, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.569 Vali Acc: 0.232 Test Loss: 1.569 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8660850524902344
Epoch: 10, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.855 Vali Acc: 0.247 Test Loss: 1.855 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.814835786819458
Epoch: 11, Steps: 17 | Train Loss: 1.019 Vali Loss: 2.201 Vali Acc: 0.243 Test Loss: 2.201 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps195_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 30697732
model size : 131.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps195_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.443052053451538
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.448 Vali Acc: 0.262 Test Loss: 1.448 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.974438190460205
Epoch: 2, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9514362812042236
Epoch: 3, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.505 Vali Acc: 0.259 Test Loss: 1.505 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0553810596466064
Epoch: 4, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 2.096660614013672
Epoch: 5, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.500 Vali Acc: 0.255 Test Loss: 1.500 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7750744819641113
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.484 Vali Acc: 0.236 Test Loss: 1.484 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3969154357910156
Epoch: 7, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9375967979431152
Epoch: 8, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.76945161819458
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.131 Vali Acc: 0.247 Test Loss: 2.131 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.313408851623535
Epoch: 10, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.520 Vali Acc: 0.270 Test Loss: 1.520 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.139881134033203
Epoch: 11, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.690 Vali Acc: 0.247 Test Loss: 1.690 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9059453010559082
Epoch: 12, Steps: 17 | Train Loss: 1.045 Vali Loss: 2.349 Vali Acc: 0.259 Test Loss: 2.349 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.290942430496216
Epoch: 13, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.638 Vali Acc: 0.243 Test Loss: 1.638 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2077083587646484
Epoch: 14, Steps: 17 | Train Loss: 0.903 Vali Loss: 2.175 Vali Acc: 0.266 Test Loss: 2.175 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps195_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 30624004
model size : 131.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps195_str195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7759103775024414
Epoch: 1, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.431 Vali Acc: 0.232 Test Loss: 1.431 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 1.3674261569976807
Epoch: 2, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.437 Vali Acc: 0.209 Test Loss: 1.437 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6882414817810059
Epoch: 3, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.427 Vali Acc: 0.232 Test Loss: 1.427 Test Acc: 0.232
Validation loss decreased (-0.231925 --> -0.231925).  Saving model ...
Epoch: 4 cost time: 1.898503303527832
Epoch: 4, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.497 Vali Acc: 0.247 Test Loss: 1.497 Test Acc: 0.247
Validation loss decreased (-0.231925 --> -0.247133).  Saving model ...
Epoch: 5 cost time: 1.8432066440582275
Epoch: 5, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.529 Vali Acc: 0.251 Test Loss: 1.529 Test Acc: 0.251
Validation loss decreased (-0.247133 --> -0.250935).  Saving model ...
Epoch: 6 cost time: 1.8097867965698242
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.495 Vali Acc: 0.251 Test Loss: 1.495 Test Acc: 0.251
Validation loss decreased (-0.250935 --> -0.250936).  Saving model ...
Epoch: 7 cost time: 1.5932328701019287
Epoch: 7, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.516 Vali Acc: 0.236 Test Loss: 1.516 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5902717113494873
Epoch: 8, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.617 Vali Acc: 0.259 Test Loss: 1.617 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258539).  Saving model ...
Epoch: 9 cost time: 1.4224333763122559
Epoch: 9, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.706 Vali Acc: 0.243 Test Loss: 1.706 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6966965198516846
Epoch: 10, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.693 Vali Acc: 0.209 Test Loss: 1.693 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6180529594421387
Epoch: 11, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.792 Vali Acc: 0.247 Test Loss: 1.792 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5053889751434326
Epoch: 12, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.780 Vali Acc: 0.217 Test Loss: 1.780 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.568671464920044
Epoch: 13, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.727 Vali Acc: 0.224 Test Loss: 1.727 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2871029376983643
Epoch: 14, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.828 Vali Acc: 0.232 Test Loss: 1.828 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4782850742340088
Epoch: 15, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.129 Vali Acc: 0.236 Test Loss: 2.129 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3836216926574707
Epoch: 16, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.174 Vali Acc: 0.228 Test Loss: 2.174 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3014743328094482
Epoch: 17, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.085 Vali Acc: 0.217 Test Loss: 2.085 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.154583215713501
Epoch: 18, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.780 Vali Acc: 0.251 Test Loss: 1.780 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps195_str195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 30587140
model size : 131.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps219_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4745864868164062
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.406 Vali Acc: 0.262 Test Loss: 1.406 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.7463181018829346
Epoch: 2, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.486 Vali Acc: 0.262 Test Loss: 1.486 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9877853393554688
Epoch: 3, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.554 Vali Acc: 0.232 Test Loss: 1.554 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.667172908782959
Epoch: 4, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.655 Vali Acc: 0.285 Test Loss: 1.655 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285155).  Saving model ...
Epoch: 5 cost time: 1.788956642150879
Epoch: 5, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.606 Vali Acc: 0.205 Test Loss: 1.606 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.378037691116333
Epoch: 6, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.834 Vali Acc: 0.259 Test Loss: 1.834 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4373323917388916
Epoch: 7, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.831 Vali Acc: 0.228 Test Loss: 1.831 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9041054248809814
Epoch: 8, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.836 Vali Acc: 0.232 Test Loss: 1.836 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8289403915405273
Epoch: 9, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.602 Vali Acc: 0.262 Test Loss: 1.602 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.845975399017334
Epoch: 10, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.940 Vali Acc: 0.255 Test Loss: 1.940 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9696166515350342
Epoch: 11, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.919 Vali Acc: 0.240 Test Loss: 1.919 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.256159543991089
Epoch: 12, Steps: 17 | Train Loss: 1.023 Vali Loss: 2.251 Vali Acc: 0.205 Test Loss: 2.251 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9474725723266602
Epoch: 13, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.272 Vali Acc: 0.228 Test Loss: 2.272 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6480329036712646
Epoch: 14, Steps: 17 | Train Loss: 0.910 Vali Loss: 2.068 Vali Acc: 0.224 Test Loss: 2.068 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps219_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 30845188
model size : 132.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps219_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3481433391571045
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.427 Vali Acc: 0.262 Test Loss: 1.427 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.6425325870513916
Epoch: 2, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.490 Vali Acc: 0.240 Test Loss: 1.490 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9722833633422852
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.445 Vali Acc: 0.251 Test Loss: 1.445 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7854259014129639
Epoch: 4, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.457 Vali Acc: 0.247 Test Loss: 1.457 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7424712181091309
Epoch: 5, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.492 Vali Acc: 0.259 Test Loss: 1.492 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7155556678771973
Epoch: 6, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.624 Vali Acc: 0.285 Test Loss: 1.624 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 1.74934720993042
Epoch: 7, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.625 Vali Acc: 0.278 Test Loss: 1.625 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9878969192504883
Epoch: 8, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.652 Vali Acc: 0.251 Test Loss: 1.652 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6045246124267578
Epoch: 9, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8280036449432373
Epoch: 10, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.582 Vali Acc: 0.224 Test Loss: 1.582 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0650129318237305
Epoch: 11, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.759 Vali Acc: 0.205 Test Loss: 1.759 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.135977029800415
Epoch: 12, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.712 Vali Acc: 0.232 Test Loss: 1.712 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.010268449783325
Epoch: 13, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.765 Vali Acc: 0.221 Test Loss: 1.765 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.937859296798706
Epoch: 14, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.061 Vali Acc: 0.240 Test Loss: 2.061 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.761113166809082
Epoch: 15, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.788 Vali Acc: 0.228 Test Loss: 1.788 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6875383853912354
Epoch: 16, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.904 Vali Acc: 0.224 Test Loss: 1.904 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps219_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 30780676
model size : 132.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps219_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3092703819274902
Epoch: 1, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.439 Vali Acc: 0.266 Test Loss: 1.439 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 1.2551941871643066
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.453 Vali Acc: 0.259 Test Loss: 1.453 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.212190866470337
Epoch: 3, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.440 Vali Acc: 0.247 Test Loss: 1.440 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5955555438995361
Epoch: 4, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.428 Vali Acc: 0.247 Test Loss: 1.428 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2971172332763672
Epoch: 5, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.630 Vali Acc: 0.247 Test Loss: 1.630 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5406403541564941
Epoch: 6, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.500 Vali Acc: 0.221 Test Loss: 1.500 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.330667495727539
Epoch: 7, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.638 Vali Acc: 0.228 Test Loss: 1.638 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2210814952850342
Epoch: 8, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.724 Vali Acc: 0.255 Test Loss: 1.724 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.12495756149292
Epoch: 9, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.525963544845581
Epoch: 10, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.693 Vali Acc: 0.255 Test Loss: 1.693 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.173731803894043
Epoch: 11, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.662 Vali Acc: 0.247 Test Loss: 1.662 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps219_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 30748420
model size : 131.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps251_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.855363130569458
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.442 Vali Acc: 0.240 Test Loss: 1.442 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.4761919975280762
Epoch: 2, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.463 Vali Acc: 0.236 Test Loss: 1.463 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9327969551086426
Epoch: 3, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.534 Vali Acc: 0.270 Test Loss: 1.534 Test Acc: 0.270
Validation loss decreased (-0.239529 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 1.624678373336792
Epoch: 4, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.487 Vali Acc: 0.232 Test Loss: 1.487 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.990161657333374
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.473 Vali Acc: 0.224 Test Loss: 1.473 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7436256408691406
Epoch: 6, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.693 Vali Acc: 0.232 Test Loss: 1.693 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.348980188369751
Epoch: 7, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.618 Vali Acc: 0.236 Test Loss: 1.618 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2059035301208496
Epoch: 8, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.821 Vali Acc: 0.270 Test Loss: 1.821 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.406785488128662
Epoch: 9, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.868 Vali Acc: 0.243 Test Loss: 1.868 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6025893688201904
Epoch: 10, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.731 Vali Acc: 0.240 Test Loss: 1.731 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6538944244384766
Epoch: 11, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.859 Vali Acc: 0.259 Test Loss: 1.859 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6591098308563232
Epoch: 12, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.887 Vali Acc: 0.255 Test Loss: 1.887 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0598785877227783
Epoch: 13, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.276 Vali Acc: 0.228 Test Loss: 2.276 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps251_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 31047940
model size : 133.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps251_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3054428100585938
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.494 Vali Acc: 0.262 Test Loss: 1.494 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 1.7613074779510498
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.463 Vali Acc: 0.251 Test Loss: 1.463 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6475179195404053
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.470 Vali Acc: 0.281 Test Loss: 1.470 Test Acc: 0.281
Validation loss decreased (-0.262342 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.7351391315460205
Epoch: 4, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.564 Vali Acc: 0.236 Test Loss: 1.564 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6005151271820068
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.906 Vali Acc: 0.224 Test Loss: 1.906 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.602809190750122
Epoch: 6, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.638 Vali Acc: 0.259 Test Loss: 1.638 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5401771068572998
Epoch: 7, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.680 Vali Acc: 0.247 Test Loss: 1.680 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.771576166152954
Epoch: 8, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.609 Vali Acc: 0.228 Test Loss: 1.609 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4662904739379883
Epoch: 9, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.843 Vali Acc: 0.243 Test Loss: 1.843 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3526015281677246
Epoch: 10, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.604 Vali Acc: 0.278 Test Loss: 1.604 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3549036979675293
Epoch: 11, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.854 Vali Acc: 0.240 Test Loss: 1.854 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2704436779022217
Epoch: 12, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.065 Vali Acc: 0.274 Test Loss: 2.065 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3489606380462646
Epoch: 13, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.137 Vali Acc: 0.262 Test Loss: 2.137 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps251_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 30992644
model size : 132.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps251_str251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8318710327148438
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.414 Vali Acc: 0.262 Test Loss: 1.414 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.4807610511779785
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.467 Vali Acc: 0.251 Test Loss: 1.467 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3127520084381104
Epoch: 3, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.519 Vali Acc: 0.259 Test Loss: 1.519 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3593730926513672
Epoch: 4, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.581 Vali Acc: 0.236 Test Loss: 1.581 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3251864910125732
Epoch: 5, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.581 Vali Acc: 0.240 Test Loss: 1.581 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.059556484222412
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.533 Vali Acc: 0.259 Test Loss: 1.533 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.063544750213623
Epoch: 7, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.560 Vali Acc: 0.259 Test Loss: 1.560 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4214322566986084
Epoch: 8, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.681 Vali Acc: 0.240 Test Loss: 1.681 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.259232521057129
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.669 Vali Acc: 0.213 Test Loss: 1.669 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2427515983581543
Epoch: 10, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.721 Vali Acc: 0.262 Test Loss: 1.721 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6097822189331055
Epoch: 11, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.668 Vali Acc: 0.217 Test Loss: 1.668 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps251_str251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 30964996
model size : 132.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps292_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.009484052658081
Epoch: 1, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.453 Vali Acc: 0.270 Test Loss: 1.453 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 2.1697542667388916
Epoch: 2, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9184291362762451
Epoch: 3, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.446 Vali Acc: 0.270 Test Loss: 1.446 Test Acc: 0.270
Validation loss decreased (-0.269947 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.9264330863952637
Epoch: 4, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.520 Vali Acc: 0.213 Test Loss: 1.520 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.248687267303467
Epoch: 5, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.598 Vali Acc: 0.251 Test Loss: 1.598 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.472090005874634
Epoch: 6, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.907 Vali Acc: 0.274 Test Loss: 1.907 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273745).  Saving model ...
Epoch: 7 cost time: 2.111058473587036
Epoch: 7, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.624 Vali Acc: 0.236 Test Loss: 1.624 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4211204051971436
Epoch: 8, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.833 Vali Acc: 0.259 Test Loss: 1.833 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.783515214920044
Epoch: 9, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.932 Vali Acc: 0.255 Test Loss: 1.932 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7329463958740234
Epoch: 10, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.716 Vali Acc: 0.278 Test Loss: 1.716 Test Acc: 0.278
Validation loss decreased (-0.273745 --> -0.277549).  Saving model ...
Epoch: 11 cost time: 2.967120409011841
Epoch: 11, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.806 Vali Acc: 0.224 Test Loss: 1.806 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.945223569869995
Epoch: 12, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.308 Vali Acc: 0.259 Test Loss: 2.308 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3346400260925293
Epoch: 13, Steps: 17 | Train Loss: 0.993 Vali Loss: 3.081 Vali Acc: 0.224 Test Loss: 3.081 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1415791511535645
Epoch: 14, Steps: 17 | Train Loss: 0.975 Vali Loss: 2.193 Vali Acc: 0.262 Test Loss: 2.193 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.233454704284668
Epoch: 15, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.016 Vali Acc: 0.236 Test Loss: 2.016 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1389710903167725
Epoch: 16, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.978 Vali Acc: 0.202 Test Loss: 1.978 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2809712886810303
Epoch: 17, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.387 Vali Acc: 0.270 Test Loss: 2.387 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2496395111083984
Epoch: 18, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.057 Vali Acc: 0.224 Test Loss: 2.057 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.224780559539795
Epoch: 19, Steps: 17 | Train Loss: 0.819 Vali Loss: 2.161 Vali Acc: 0.251 Test Loss: 2.161 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1349613666534424
Epoch: 20, Steps: 17 | Train Loss: 0.638 Vali Loss: 3.602 Vali Acc: 0.228 Test Loss: 3.602 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps292_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 31312900
model size : 134.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps292_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6012415885925293
Epoch: 1, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.431 Vali Acc: 0.262 Test Loss: 1.431 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.41499924659729
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.408 Vali Acc: 0.232 Test Loss: 1.408 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4170758724212646
Epoch: 3, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.510 Vali Acc: 0.228 Test Loss: 1.510 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2961153984069824
Epoch: 4, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.441 Vali Acc: 0.232 Test Loss: 1.441 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1954879760742188
Epoch: 5, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.783 Vali Acc: 0.247 Test Loss: 1.783 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3125669956207275
Epoch: 6, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.521 Vali Acc: 0.232 Test Loss: 1.521 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1059634685516357
Epoch: 7, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.949 Vali Acc: 0.251 Test Loss: 1.949 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.032120943069458
Epoch: 8, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.647 Vali Acc: 0.240 Test Loss: 1.647 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4321894645690918
Epoch: 9, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.682 Vali Acc: 0.240 Test Loss: 1.682 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3440303802490234
Epoch: 10, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.623 Vali Acc: 0.251 Test Loss: 1.623 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2308902740478516
Epoch: 11, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.631 Vali Acc: 0.262 Test Loss: 1.631 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps292_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 31266820
model size : 133.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps292_str292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7348217964172363
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.483 Vali Acc: 0.224 Test Loss: 1.483 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 1.050478458404541
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.447 Vali Acc: 0.240 Test Loss: 1.447 Test Acc: 0.240
Validation loss decreased (-0.224320 --> -0.239529).  Saving model ...
Epoch: 3 cost time: 1.323470115661621
Epoch: 3, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.453 Vali Acc: 0.251 Test Loss: 1.453 Test Acc: 0.251
Validation loss decreased (-0.239529 --> -0.250936).  Saving model ...
Epoch: 4 cost time: 1.1730530261993408
Epoch: 4, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.567 Vali Acc: 0.221 Test Loss: 1.567 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1320431232452393
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.497 Vali Acc: 0.255 Test Loss: 1.497 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254738).  Saving model ...
Epoch: 6 cost time: 1.1567084789276123
Epoch: 6, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.14387845993042
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.590 Vali Acc: 0.259 Test Loss: 1.590 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258539).  Saving model ...
Epoch: 8 cost time: 1.2420883178710938
Epoch: 8, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.655 Vali Acc: 0.262 Test Loss: 1.655 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262341).  Saving model ...
Epoch: 9 cost time: 1.4977798461914062
Epoch: 9, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.597 Vali Acc: 0.281 Test Loss: 1.597 Test Acc: 0.281
Validation loss decreased (-0.262341 --> -0.281353).  Saving model ...
Epoch: 10 cost time: 1.4496090412139893
Epoch: 10, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.748 Vali Acc: 0.255 Test Loss: 1.748 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2524850368499756
Epoch: 11, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.941 Vali Acc: 0.262 Test Loss: 1.941 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.280683994293213
Epoch: 12, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.822 Vali Acc: 0.259 Test Loss: 1.822 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6255970001220703
Epoch: 13, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.730 Vali Acc: 0.232 Test Loss: 1.730 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.356152057647705
Epoch: 14, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.636 Vali Acc: 0.251 Test Loss: 1.636 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8150837421417236
Epoch: 15, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.982 Vali Acc: 0.247 Test Loss: 1.982 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6636099815368652
Epoch: 16, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.796 Vali Acc: 0.224 Test Loss: 1.796 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4826788902282715
Epoch: 17, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.757 Vali Acc: 0.232 Test Loss: 1.757 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.677671194076538
Epoch: 18, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.047 Vali Acc: 0.236 Test Loss: 2.047 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3035688400268555
Epoch: 19, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.952 Vali Acc: 0.228 Test Loss: 1.952 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps292_str292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 31243780
model size : 133.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps351_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.04617714881897
Epoch: 1, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.430 Vali Acc: 0.278 Test Loss: 1.430 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.5681304931640625
Epoch: 2, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.474 Vali Acc: 0.297 Test Loss: 1.474 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296563).  Saving model ...
Epoch: 3 cost time: 1.6470816135406494
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.523 Vali Acc: 0.251 Test Loss: 1.523 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6600112915039062
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.420 Vali Acc: 0.278 Test Loss: 1.420 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4289088249206543
Epoch: 5, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.460 Vali Acc: 0.247 Test Loss: 1.460 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.303743839263916
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.416 Vali Acc: 0.255 Test Loss: 1.416 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.260200262069702
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.586 Vali Acc: 0.255 Test Loss: 1.586 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9005227088928223
Epoch: 8, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.567 Vali Acc: 0.262 Test Loss: 1.567 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9114930629730225
Epoch: 9, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.615 Vali Acc: 0.270 Test Loss: 1.615 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.379680871963501
Epoch: 10, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.552 Vali Acc: 0.255 Test Loss: 1.552 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0845229625701904
Epoch: 11, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.517 Vali Acc: 0.205 Test Loss: 1.517 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.262585163116455
Epoch: 12, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.888 Vali Acc: 0.224 Test Loss: 1.888 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps351_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 31702276
model size : 135.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.179518938064575
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.423 Vali Acc: 0.217 Test Loss: 1.423 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 1.3382468223571777
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.446 Vali Acc: 0.259 Test Loss: 1.446 Test Acc: 0.259
Validation loss decreased (-0.216716 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 1.4104936122894287
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.519 Vali Acc: 0.262 Test Loss: 1.519 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262342).  Saving model ...
Epoch: 4 cost time: 1.2721116542816162
Epoch: 4, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.545 Vali Acc: 0.236 Test Loss: 1.545 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3509891033172607
Epoch: 5, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.466 Vali Acc: 0.255 Test Loss: 1.466 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1622145175933838
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.622 Vali Acc: 0.224 Test Loss: 1.622 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1205823421478271
Epoch: 7, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.541 Vali Acc: 0.232 Test Loss: 1.541 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6192398071289062
Epoch: 8, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.735 Vali Acc: 0.255 Test Loss: 1.735 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6807708740234375
Epoch: 9, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.689 Vali Acc: 0.293 Test Loss: 1.689 Test Acc: 0.293
Validation loss decreased (-0.262342 --> -0.292759).  Saving model ...
Epoch: 10 cost time: 1.9061145782470703
Epoch: 10, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.855 Vali Acc: 0.243 Test Loss: 1.855 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.599536657333374
Epoch: 11, Steps: 17 | Train Loss: 1.127 Vali Loss: 2.194 Vali Acc: 0.240 Test Loss: 2.194 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4402530193328857
Epoch: 12, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.867 Vali Acc: 0.236 Test Loss: 1.867 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3311715126037598
Epoch: 13, Steps: 17 | Train Loss: 1.009 Vali Loss: 2.119 Vali Acc: 0.224 Test Loss: 2.119 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3486618995666504
Epoch: 14, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.957 Vali Acc: 0.236 Test Loss: 1.957 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4293851852416992
Epoch: 15, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.854 Vali Acc: 0.274 Test Loss: 1.854 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7622687816619873
Epoch: 16, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.002 Vali Acc: 0.236 Test Loss: 2.002 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.298473834991455
Epoch: 17, Steps: 17 | Train Loss: 0.840 Vali Loss: 3.230 Vali Acc: 0.240 Test Loss: 3.230 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4295876026153564
Epoch: 18, Steps: 17 | Train Loss: 1.146 Vali Loss: 2.063 Vali Acc: 0.228 Test Loss: 2.063 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.505169153213501
Epoch: 19, Steps: 17 | Train Loss: 0.954 Vali Loss: 2.430 Vali Acc: 0.228 Test Loss: 2.430 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 31665412
model size : 135.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps351_str351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6325883865356445
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.419 Vali Acc: 0.293 Test Loss: 1.419 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 1.3482487201690674
Epoch: 2, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.248490333557129
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.462 Vali Acc: 0.285 Test Loss: 1.462 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.583150863647461
Epoch: 4, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.446 Vali Acc: 0.304 Test Loss: 1.446 Test Acc: 0.304
Validation loss decreased (-0.292761 --> -0.304168).  Saving model ...
Epoch: 5 cost time: 1.601853609085083
Epoch: 5, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.460 Vali Acc: 0.270 Test Loss: 1.460 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2842249870300293
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.597 Vali Acc: 0.243 Test Loss: 1.597 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4287114143371582
Epoch: 7, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.557 Vali Acc: 0.228 Test Loss: 1.557 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.226057529449463
Epoch: 8, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.504 Vali Acc: 0.251 Test Loss: 1.504 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.292445182800293
Epoch: 9, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.548 Vali Acc: 0.221 Test Loss: 1.548 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1981663703918457
Epoch: 10, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.696 Vali Acc: 0.217 Test Loss: 1.696 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3061487674713135
Epoch: 11, Steps: 17 | Train Loss: 1.022 Vali Loss: 1.627 Vali Acc: 0.224 Test Loss: 1.627 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2777912616729736
Epoch: 12, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.692 Vali Acc: 0.232 Test Loss: 1.692 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3222308158874512
Epoch: 13, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.684 Vali Acc: 0.243 Test Loss: 1.684 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.229010820388794
Epoch: 14, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.844 Vali Acc: 0.243 Test Loss: 1.844 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el4_dm768_df768_ps351_str351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 31646980
model size : 135.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.613811016082764
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.588 Vali Acc: 0.213 Test Loss: 1.588 Test Acc: 0.213
Validation loss decreased (inf --> -0.212912).  Saving model ...
Epoch: 2 cost time: 1.8893547058105469
Epoch: 2, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.693 Vali Acc: 0.243 Test Loss: 1.693 Test Acc: 0.243
Validation loss decreased (-0.212912 --> -0.243329).  Saving model ...
Epoch: 3 cost time: 2.054046392440796
Epoch: 3, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.549 Vali Acc: 0.278 Test Loss: 1.549 Test Acc: 0.278
Validation loss decreased (-0.243329 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 2.271744966506958
Epoch: 4, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.599 Vali Acc: 0.247 Test Loss: 1.599 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.112044334411621
Epoch: 5, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.760 Vali Acc: 0.255 Test Loss: 1.760 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2829716205596924
Epoch: 6, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.583 Vali Acc: 0.285 Test Loss: 1.583 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 1.9942915439605713
Epoch: 7, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.819 Vali Acc: 0.259 Test Loss: 1.819 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8627073764801025
Epoch: 8, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.879 Vali Acc: 0.232 Test Loss: 1.879 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.660517930984497
Epoch: 9, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.766 Vali Acc: 0.255 Test Loss: 1.766 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9471495151519775
Epoch: 10, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.940 Vali Acc: 0.278 Test Loss: 1.940 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4786484241485596
Epoch: 11, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.885 Vali Acc: 0.255 Test Loss: 1.885 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3090529441833496
Epoch: 12, Steps: 17 | Train Loss: 0.908 Vali Loss: 2.148 Vali Acc: 0.251 Test Loss: 2.148 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2065024375915527
Epoch: 13, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.822 Vali Acc: 0.247 Test Loss: 1.822 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3788862228393555
Epoch: 14, Steps: 17 | Train Loss: 0.924 Vali Loss: 2.658 Vali Acc: 0.228 Test Loss: 2.658 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0597455501556396
Epoch: 15, Steps: 17 | Train Loss: 0.858 Vali Loss: 2.251 Vali Acc: 0.247 Test Loss: 2.251 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.553173780441284
Epoch: 16, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.744 Vali Acc: 0.240 Test Loss: 2.744 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 23038468
model size : 102.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.488959789276123
Epoch: 1, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.440 Vali Acc: 0.259 Test Loss: 1.440 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.3592000007629395
Epoch: 2, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.523 Vali Acc: 0.266 Test Loss: 1.523 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266144).  Saving model ...
Epoch: 3 cost time: 1.8147001266479492
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.604 Vali Acc: 0.274 Test Loss: 1.604 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273748).  Saving model ...
Epoch: 4 cost time: 1.5366368293762207
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.491 Vali Acc: 0.232 Test Loss: 1.491 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6916534900665283
Epoch: 5, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.487 Vali Acc: 0.232 Test Loss: 1.487 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.695134162902832
Epoch: 6, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.516 Vali Acc: 0.240 Test Loss: 1.516 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.958721399307251
Epoch: 7, Steps: 17 | Train Loss: 1.126 Vali Loss: 2.129 Vali Acc: 0.236 Test Loss: 2.129 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.869866132736206
Epoch: 8, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.819 Vali Acc: 0.232 Test Loss: 1.819 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7935805320739746
Epoch: 9, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.536 Vali Acc: 0.262 Test Loss: 1.536 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.422396659851074
Epoch: 10, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.843 Vali Acc: 0.217 Test Loss: 1.843 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.19572114944458
Epoch: 11, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.796 Vali Acc: 0.262 Test Loss: 1.796 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0046160221099854
Epoch: 12, Steps: 17 | Train Loss: 1.043 Vali Loss: 3.070 Vali Acc: 0.247 Test Loss: 3.070 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8006160259246826
Epoch: 13, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.695 Vali Acc: 0.251 Test Loss: 1.695 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 22821892
model size : 101.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6340010166168213
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.495 Vali Acc: 0.205 Test Loss: 1.495 Test Acc: 0.205
Validation loss decreased (inf --> -0.205308).  Saving model ...
Epoch: 2 cost time: 1.575758695602417
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.469 Vali Acc: 0.243 Test Loss: 1.469 Test Acc: 0.243
Validation loss decreased (-0.205308 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 1.4007833003997803
Epoch: 3, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.442 Vali Acc: 0.251 Test Loss: 1.442 Test Acc: 0.251
Validation loss decreased (-0.243331 --> -0.250936).  Saving model ...
Epoch: 4 cost time: 1.5566825866699219
Epoch: 4, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.456 Vali Acc: 0.251 Test Loss: 1.456 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8257689476013184
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.514 Vali Acc: 0.262 Test Loss: 1.514 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262342).  Saving model ...
Epoch: 6 cost time: 2.0666942596435547
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.502 Vali Acc: 0.247 Test Loss: 1.502 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1693217754364014
Epoch: 7, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.551 Vali Acc: 0.293 Test Loss: 1.551 Test Acc: 0.293
Validation loss decreased (-0.262342 --> -0.292760).  Saving model ...
Epoch: 8 cost time: 2.0513179302215576
Epoch: 8, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.553 Vali Acc: 0.266 Test Loss: 1.553 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.822693109512329
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.710 Vali Acc: 0.236 Test Loss: 1.710 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1186676025390625
Epoch: 10, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.916 Vali Acc: 0.243 Test Loss: 1.916 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0287222862243652
Epoch: 11, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.883 Vali Acc: 0.255 Test Loss: 1.883 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4936940670013428
Epoch: 12, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.811 Vali Acc: 0.228 Test Loss: 1.811 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.732210397720337
Epoch: 13, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.169 Vali Acc: 0.232 Test Loss: 2.169 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2197935581207275
Epoch: 14, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.876 Vali Acc: 0.240 Test Loss: 1.876 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9283456802368164
Epoch: 15, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.552 Vali Acc: 0.224 Test Loss: 2.552 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5895566940307617
Epoch: 16, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.964 Vali Acc: 0.243 Test Loss: 1.964 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8198363780975342
Epoch: 17, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.473 Vali Acc: 0.236 Test Loss: 2.473 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 22715908
model size : 101.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps73_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.167364597320557
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.571 Vali Acc: 0.266 Test Loss: 1.571 Test Acc: 0.266
Validation loss decreased (inf --> -0.266144).  Saving model ...
Epoch: 2 cost time: 1.616410255432129
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.465 Vali Acc: 0.232 Test Loss: 1.465 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9664504528045654
Epoch: 3, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.609 Vali Acc: 0.297 Test Loss: 1.609 Test Acc: 0.297
Validation loss decreased (-0.266144 --> -0.296562).  Saving model ...
Epoch: 4 cost time: 2.353943347930908
Epoch: 4, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.811 Vali Acc: 0.243 Test Loss: 1.811 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0423660278320312
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.722 Vali Acc: 0.259 Test Loss: 1.722 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.044745683670044
Epoch: 6, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.685 Vali Acc: 0.251 Test Loss: 1.685 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.785895586013794
Epoch: 7, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.851 Vali Acc: 0.255 Test Loss: 1.851 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8658447265625
Epoch: 8, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.978 Vali Acc: 0.251 Test Loss: 1.978 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.167846202850342
Epoch: 9, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.170 Vali Acc: 0.232 Test Loss: 2.170 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1939985752105713
Epoch: 10, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.369 Vali Acc: 0.240 Test Loss: 2.369 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0017096996307373
Epoch: 11, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.086 Vali Acc: 0.266 Test Loss: 2.086 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7729461193084717
Epoch: 12, Steps: 17 | Train Loss: 0.833 Vali Loss: 2.679 Vali Acc: 0.251 Test Loss: 2.679 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.9236562252044678
Epoch: 13, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.548 Vali Acc: 0.247 Test Loss: 2.548 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps73_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 23029252
model size : 102.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps73_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7594645023345947
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.439 Vali Acc: 0.262 Test Loss: 1.439 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.3639838695526123
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.530 Vali Acc: 0.270 Test Loss: 1.530 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 2.375014066696167
Epoch: 3, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.462 Vali Acc: 0.274 Test Loss: 1.462 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 2.475214958190918
Epoch: 4, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.509 Vali Acc: 0.262 Test Loss: 1.509 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.876291036605835
Epoch: 5, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.566 Vali Acc: 0.251 Test Loss: 1.566 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4860756397247314
Epoch: 6, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.651 Vali Acc: 0.251 Test Loss: 1.651 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.93135666847229
Epoch: 7, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.618 Vali Acc: 0.232 Test Loss: 1.618 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9917402267456055
Epoch: 8, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.756 Vali Acc: 0.232 Test Loss: 1.756 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2454800605773926
Epoch: 9, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.270 Vali Acc: 0.236 Test Loss: 2.270 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4295196533203125
Epoch: 10, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.666 Vali Acc: 0.259 Test Loss: 1.666 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.155000925064087
Epoch: 11, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.276 Vali Acc: 0.213 Test Loss: 2.276 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8911213874816895
Epoch: 12, Steps: 17 | Train Loss: 0.958 Vali Loss: 2.490 Vali Acc: 0.243 Test Loss: 2.490 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.278032064437866
Epoch: 13, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.400 Vali Acc: 0.251 Test Loss: 2.400 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps73_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 22831108
model size : 101.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps73_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.356236696243286
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.442 Vali Acc: 0.259 Test Loss: 1.442 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.7059359550476074
Epoch: 2, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.524 Vali Acc: 0.262 Test Loss: 1.524 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 1.3946492671966553
Epoch: 3, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 2.0499579906463623
Epoch: 4, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.448 Vali Acc: 0.266 Test Loss: 1.448 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7656431198120117
Epoch: 5, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.528 Vali Acc: 0.274 Test Loss: 1.528 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273749).  Saving model ...
Epoch: 6 cost time: 1.911384105682373
Epoch: 6, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.667 Vali Acc: 0.255 Test Loss: 1.667 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4703707695007324
Epoch: 7, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.606 Vali Acc: 0.243 Test Loss: 1.606 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5190353393554688
Epoch: 8, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.677 Vali Acc: 0.255 Test Loss: 1.677 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4839246273040771
Epoch: 9, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.924 Vali Acc: 0.243 Test Loss: 1.924 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9357318878173828
Epoch: 10, Steps: 17 | Train Loss: 1.016 Vali Loss: 2.174 Vali Acc: 0.243 Test Loss: 2.174 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4907207489013672
Epoch: 11, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.981 Vali Acc: 0.251 Test Loss: 1.981 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5728425979614258
Epoch: 12, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.926 Vali Acc: 0.232 Test Loss: 1.926 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4740934371948242
Epoch: 13, Steps: 17 | Train Loss: 0.953 Vali Loss: 2.050 Vali Acc: 0.262 Test Loss: 2.050 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2865173816680908
Epoch: 14, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.917 Vali Acc: 0.236 Test Loss: 1.917 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.468935251235962
Epoch: 15, Steps: 17 | Train Loss: 0.929 Vali Loss: 2.287 Vali Acc: 0.236 Test Loss: 2.287 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps73_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 22725124
model size : 101.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.759038209915161
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.677 Vali Acc: 0.255 Test Loss: 1.677 Test Acc: 0.255
Validation loss decreased (inf --> -0.254736).  Saving model ...
Epoch: 2 cost time: 2.114593029022217
Epoch: 2, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.535 Vali Acc: 0.262 Test Loss: 1.535 Test Acc: 0.262
Validation loss decreased (-0.254736 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 1.9446353912353516
Epoch: 3, Steps: 17 | Train Loss: 1.382 Vali Loss: 2.008 Vali Acc: 0.255 Test Loss: 2.008 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7208876609802246
Epoch: 4, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.556 Vali Acc: 0.251 Test Loss: 1.556 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.162036180496216
Epoch: 5, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.750 Vali Acc: 0.262 Test Loss: 1.750 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2113616466522217
Epoch: 6, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.771 Vali Acc: 0.266 Test Loss: 1.771 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266142).  Saving model ...
Epoch: 7 cost time: 1.8931784629821777
Epoch: 7, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.633 Vali Acc: 0.243 Test Loss: 1.633 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2941715717315674
Epoch: 8, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.071 Vali Acc: 0.255 Test Loss: 2.071 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3824257850646973
Epoch: 9, Steps: 17 | Train Loss: 1.241 Vali Loss: 2.342 Vali Acc: 0.243 Test Loss: 2.342 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3739302158355713
Epoch: 10, Steps: 17 | Train Loss: 1.202 Vali Loss: 2.137 Vali Acc: 0.266 Test Loss: 2.137 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8301517963409424
Epoch: 11, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.982 Vali Acc: 0.232 Test Loss: 1.982 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8857197761535645
Epoch: 12, Steps: 17 | Train Loss: 1.167 Vali Loss: 2.335 Vali Acc: 0.262 Test Loss: 2.335 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.950392723083496
Epoch: 13, Steps: 17 | Train Loss: 0.945 Vali Loss: 2.412 Vali Acc: 0.274 Test Loss: 2.412 Test Acc: 0.274
Validation loss decreased (-0.266142 --> -0.273740).  Saving model ...
Epoch: 14 cost time: 2.6790449619293213
Epoch: 14, Steps: 17 | Train Loss: 0.826 Vali Loss: 2.656 Vali Acc: 0.266 Test Loss: 2.656 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1174569129943848
Epoch: 15, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.306 Vali Acc: 0.247 Test Loss: 2.306 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1191611289978027
Epoch: 16, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.501 Vali Acc: 0.224 Test Loss: 2.501 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8489928245544434
Epoch: 17, Steps: 17 | Train Loss: 0.765 Vali Loss: 2.696 Vali Acc: 0.240 Test Loss: 2.696 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7554304599761963
Epoch: 18, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.790 Vali Acc: 0.281 Test Loss: 2.790 Test Acc: 0.281
Validation loss decreased (-0.273740 --> -0.281341).  Saving model ...
Epoch: 19 cost time: 2.846144676208496
Epoch: 19, Steps: 17 | Train Loss: 0.792 Vali Loss: 3.249 Vali Acc: 0.243 Test Loss: 3.249 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4492695331573486
Epoch: 20, Steps: 17 | Train Loss: 0.538 Vali Loss: 3.712 Vali Acc: 0.247 Test Loss: 3.712 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4568960666656494
Epoch: 21, Steps: 17 | Train Loss: 0.653 Vali Loss: 4.203 Vali Acc: 0.247 Test Loss: 4.203 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.123865842819214
Epoch: 22, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.679 Vali Acc: 0.243 Test Loss: 2.679 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.117319345474243
Epoch: 23, Steps: 17 | Train Loss: 0.560 Vali Loss: 4.229 Vali Acc: 0.247 Test Loss: 4.229 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.354475259780884
Epoch: 24, Steps: 17 | Train Loss: 0.565 Vali Loss: 5.000 Vali Acc: 0.217 Test Loss: 5.000 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9208667278289795
Epoch: 25, Steps: 17 | Train Loss: 0.563 Vali Loss: 4.151 Vali Acc: 0.247 Test Loss: 4.151 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2382004261016846
Epoch: 26, Steps: 17 | Train Loss: 0.604 Vali Loss: 4.233 Vali Acc: 0.259 Test Loss: 4.233 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.550657272338867
Epoch: 27, Steps: 17 | Train Loss: 0.617 Vali Loss: 4.741 Vali Acc: 0.266 Test Loss: 4.741 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9339361190795898
Epoch: 28, Steps: 17 | Train Loss: 0.401 Vali Loss: 4.001 Vali Acc: 0.255 Test Loss: 4.001 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 23033860
model size : 102.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2665953636169434
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.459 Vali Acc: 0.266 Test Loss: 1.459 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 1.1864445209503174
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.555 Vali Acc: 0.236 Test Loss: 1.555 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8720345497131348
Epoch: 3, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.502 Vali Acc: 0.278 Test Loss: 1.502 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.6167888641357422
Epoch: 4, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.698 Vali Acc: 0.259 Test Loss: 1.698 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5661160945892334
Epoch: 5, Steps: 17 | Train Loss: 1.188 Vali Loss: 2.049 Vali Acc: 0.255 Test Loss: 2.049 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.757371187210083
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.839 Vali Acc: 0.255 Test Loss: 1.839 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.657092571258545
Epoch: 7, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.920 Vali Acc: 0.247 Test Loss: 1.920 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6296634674072266
Epoch: 8, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.731 Vali Acc: 0.243 Test Loss: 1.731 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5640642642974854
Epoch: 9, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6397323608398438
Epoch: 10, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.935 Vali Acc: 0.213 Test Loss: 1.935 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5558934211730957
Epoch: 11, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.994 Vali Acc: 0.247 Test Loss: 1.994 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4018373489379883
Epoch: 12, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.918 Vali Acc: 0.236 Test Loss: 1.918 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8928308486938477
Epoch: 13, Steps: 17 | Train Loss: 0.850 Vali Loss: 2.906 Vali Acc: 0.247 Test Loss: 2.906 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 22844932
model size : 101.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.603001356124878
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.518 Vali Acc: 0.281 Test Loss: 1.518 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 1.5431599617004395
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.558 Vali Acc: 0.262 Test Loss: 1.558 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3371787071228027
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.558 Vali Acc: 0.243 Test Loss: 1.558 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6363615989685059
Epoch: 4, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.463 Vali Acc: 0.262 Test Loss: 1.463 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.524667501449585
Epoch: 5, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.506 Vali Acc: 0.236 Test Loss: 1.506 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3115463256835938
Epoch: 6, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.534 Vali Acc: 0.262 Test Loss: 1.534 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.735745906829834
Epoch: 7, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.681 Vali Acc: 0.205 Test Loss: 1.681 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9989750385284424
Epoch: 8, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.551 Vali Acc: 0.259 Test Loss: 1.551 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.298851728439331
Epoch: 9, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.942 Vali Acc: 0.247 Test Loss: 1.942 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.725416898727417
Epoch: 10, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.771 Vali Acc: 0.240 Test Loss: 1.771 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7822258472442627
Epoch: 11, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.906 Vali Acc: 0.259 Test Loss: 1.906 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 22748164
model size : 101.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.763408660888672
Epoch: 1, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.839 Vali Acc: 0.251 Test Loss: 1.839 Test Acc: 0.251
Validation loss decreased (inf --> -0.250932).  Saving model ...
Epoch: 2 cost time: 2.5094776153564453
Epoch: 2, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (-0.250932 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 2.4207887649536133
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.648 Vali Acc: 0.251 Test Loss: 1.648 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6269335746765137
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9031927585601807
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.500 Vali Acc: 0.236 Test Loss: 1.500 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.666764736175537
Epoch: 6, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.811 Vali Acc: 0.266 Test Loss: 1.811 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.991443395614624
Epoch: 7, Steps: 17 | Train Loss: 1.171 Vali Loss: 2.141 Vali Acc: 0.270 Test Loss: 2.141 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269941).  Saving model ...
Epoch: 8 cost time: 1.9921658039093018
Epoch: 8, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.984 Vali Acc: 0.240 Test Loss: 1.984 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4577832221984863
Epoch: 9, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.948 Vali Acc: 0.247 Test Loss: 1.948 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4301512241363525
Epoch: 10, Steps: 17 | Train Loss: 0.962 Vali Loss: 2.182 Vali Acc: 0.251 Test Loss: 2.182 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.111057996749878
Epoch: 11, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.272 Vali Acc: 0.262 Test Loss: 2.272 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.813636302947998
Epoch: 12, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.440 Vali Acc: 0.232 Test Loss: 2.440 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9689052104949951
Epoch: 13, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.370 Vali Acc: 0.262 Test Loss: 2.370 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5201902389526367
Epoch: 14, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.498 Vali Acc: 0.232 Test Loss: 2.498 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7603936195373535
Epoch: 15, Steps: 17 | Train Loss: 0.705 Vali Loss: 3.403 Vali Acc: 0.236 Test Loss: 3.403 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7681005001068115
Epoch: 16, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.921 Vali Acc: 0.243 Test Loss: 2.921 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6032657623291016
Epoch: 17, Steps: 17 | Train Loss: 0.693 Vali Loss: 2.529 Vali Acc: 0.262 Test Loss: 2.529 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 23054596
model size : 102.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9245574474334717
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.461 Vali Acc: 0.293 Test Loss: 1.461 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 2.3934199810028076
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.433 Vali Acc: 0.323 Test Loss: 1.433 Test Acc: 0.323
Validation loss decreased (-0.292761 --> -0.323180).  Saving model ...
Epoch: 3 cost time: 1.4382216930389404
Epoch: 3, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.428 Vali Acc: 0.274 Test Loss: 1.428 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6493263244628906
Epoch: 4, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.483 Vali Acc: 0.262 Test Loss: 1.483 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8528378009796143
Epoch: 5, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.593 Vali Acc: 0.266 Test Loss: 1.593 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9093759059906006
Epoch: 6, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.652 Vali Acc: 0.236 Test Loss: 1.652 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8063695430755615
Epoch: 7, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.516 Vali Acc: 0.221 Test Loss: 1.516 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.629356861114502
Epoch: 8, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.794 Vali Acc: 0.259 Test Loss: 1.794 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8459498882293701
Epoch: 9, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.518 Vali Acc: 0.255 Test Loss: 1.518 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8355185985565186
Epoch: 10, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.874 Vali Acc: 0.259 Test Loss: 1.874 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.845332145690918
Epoch: 11, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.732 Vali Acc: 0.213 Test Loss: 1.732 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.311401605606079
Epoch: 12, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.739 Vali Acc: 0.259 Test Loss: 1.739 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 22861060
model size : 101.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7123031616210938
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.416 Vali Acc: 0.255 Test Loss: 1.416 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.6232821941375732
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.417 Vali Acc: 0.236 Test Loss: 1.417 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0761008262634277
Epoch: 3, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.545 Vali Acc: 0.255 Test Loss: 1.545 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.625227928161621
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.581 Vali Acc: 0.255 Test Loss: 1.581 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5975220203399658
Epoch: 5, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.524 Vali Acc: 0.232 Test Loss: 1.524 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.66062593460083
Epoch: 6, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.671 Vali Acc: 0.274 Test Loss: 1.671 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273748).  Saving model ...
Epoch: 7 cost time: 1.8803074359893799
Epoch: 7, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.569 Vali Acc: 0.221 Test Loss: 1.569 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4947116374969482
Epoch: 8, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.601 Vali Acc: 0.243 Test Loss: 1.601 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.589355707168579
Epoch: 9, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.652 Vali Acc: 0.243 Test Loss: 1.652 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4507181644439697
Epoch: 10, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.783 Vali Acc: 0.232 Test Loss: 1.783 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.687084674835205
Epoch: 11, Steps: 17 | Train Loss: 1.072 Vali Loss: 2.190 Vali Acc: 0.266 Test Loss: 2.190 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0656368732452393
Epoch: 12, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6035888195037842
Epoch: 13, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.847 Vali Acc: 0.232 Test Loss: 1.847 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4541454315185547
Epoch: 14, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.806 Vali Acc: 0.217 Test Loss: 1.806 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1205544471740723
Epoch: 15, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.993 Vali Acc: 0.228 Test Loss: 1.993 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4292182922363281
Epoch: 16, Steps: 17 | Train Loss: 0.842 Vali Loss: 2.101 Vali Acc: 0.217 Test Loss: 2.101 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 22764292
model size : 101.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps84_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.198230981826782
Epoch: 1, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.428 Vali Acc: 0.255 Test Loss: 1.428 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.9698820114135742
Epoch: 2, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.533 Vali Acc: 0.259 Test Loss: 1.533 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258540).  Saving model ...
Epoch: 3 cost time: 2.148563861846924
Epoch: 3, Steps: 17 | Train Loss: 1.360 Vali Loss: 2.097 Vali Acc: 0.266 Test Loss: 2.097 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266139).  Saving model ...
Epoch: 4 cost time: 2.716503381729126
Epoch: 4, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.636 Vali Acc: 0.266 Test Loss: 1.636 Test Acc: 0.266
Validation loss decreased (-0.266139 --> -0.266143).  Saving model ...
Epoch: 5 cost time: 2.398648977279663
Epoch: 5, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.596 Vali Acc: 0.213 Test Loss: 1.596 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.61361026763916
Epoch: 6, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.869 Vali Acc: 0.236 Test Loss: 1.869 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4333455562591553
Epoch: 7, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.576 Vali Acc: 0.259 Test Loss: 1.576 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.187171220779419
Epoch: 8, Steps: 17 | Train Loss: 1.205 Vali Loss: 2.332 Vali Acc: 0.266 Test Loss: 2.332 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.218966245651245
Epoch: 9, Steps: 17 | Train Loss: 1.074 Vali Loss: 2.085 Vali Acc: 0.255 Test Loss: 2.085 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3540706634521484
Epoch: 10, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.016 Vali Acc: 0.251 Test Loss: 2.016 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.44879150390625
Epoch: 11, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.921 Vali Acc: 0.262 Test Loss: 1.921 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1071791648864746
Epoch: 12, Steps: 17 | Train Loss: 0.900 Vali Loss: 2.582 Vali Acc: 0.240 Test Loss: 2.582 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.947380542755127
Epoch: 13, Steps: 17 | Train Loss: 0.917 Vali Loss: 2.342 Vali Acc: 0.221 Test Loss: 2.342 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9344658851623535
Epoch: 14, Steps: 17 | Train Loss: 0.835 Vali Loss: 2.953 Vali Acc: 0.247 Test Loss: 2.953 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps84_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 23063812
model size : 102.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps84_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.497445583343506
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.490 Vali Acc: 0.224 Test Loss: 1.490 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 1.5275392532348633
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.523 Vali Acc: 0.262 Test Loss: 1.523 Test Acc: 0.262
Validation loss decreased (-0.224320 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 1.8128588199615479
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.508 Vali Acc: 0.243 Test Loss: 1.508 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.048081636428833
Epoch: 4, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.547 Vali Acc: 0.259 Test Loss: 1.547 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.721524715423584
Epoch: 5, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.703 Vali Acc: 0.243 Test Loss: 1.703 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7879905700683594
Epoch: 6, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.524 Vali Acc: 0.251 Test Loss: 1.524 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.015164852142334
Epoch: 7, Steps: 17 | Train Loss: 1.168 Vali Loss: 2.017 Vali Acc: 0.255 Test Loss: 2.017 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.113405704498291
Epoch: 8, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.772 Vali Acc: 0.251 Test Loss: 1.772 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7931222915649414
Epoch: 9, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.936 Vali Acc: 0.228 Test Loss: 1.936 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6456663608551025
Epoch: 10, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.877 Vali Acc: 0.224 Test Loss: 1.877 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.834272861480713
Epoch: 11, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.931 Vali Acc: 0.251 Test Loss: 1.931 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7439987659454346
Epoch: 12, Steps: 17 | Train Loss: 1.013 Vali Loss: 2.226 Vali Acc: 0.217 Test Loss: 2.226 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps84_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 22879492
model size : 101.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps84_str84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9518887996673584
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.404 Vali Acc: 0.285 Test Loss: 1.404 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.271134853363037
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.421 Vali Acc: 0.289 Test Loss: 1.421 Test Acc: 0.289
Validation loss decreased (-0.285157 --> -0.288959).  Saving model ...
Epoch: 3 cost time: 1.3371317386627197
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.544 Vali Acc: 0.281 Test Loss: 1.544 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1551759243011475
Epoch: 4, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.510 Vali Acc: 0.266 Test Loss: 1.510 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9658088684082031
Epoch: 5, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.444 Vali Acc: 0.270 Test Loss: 1.444 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.199974536895752
Epoch: 6, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.531 Vali Acc: 0.255 Test Loss: 1.531 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2389605045318604
Epoch: 7, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.656 Vali Acc: 0.270 Test Loss: 1.656 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9821007251739502
Epoch: 8, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.655 Vali Acc: 0.236 Test Loss: 1.655 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0605888366699219
Epoch: 9, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.742 Vali Acc: 0.285 Test Loss: 1.742 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1947505474090576
Epoch: 10, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.797 Vali Acc: 0.247 Test Loss: 1.797 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6824009418487549
Epoch: 11, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.817 Vali Acc: 0.247 Test Loss: 1.817 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0567028522491455
Epoch: 12, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.871 Vali Acc: 0.221 Test Loss: 1.871 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps84_str84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 22787332
model size : 101.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps88_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.518876075744629
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.699 Vali Acc: 0.259 Test Loss: 1.699 Test Acc: 0.259
Validation loss decreased (inf --> -0.258538).  Saving model ...
Epoch: 2 cost time: 1.6680717468261719
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.503 Vali Acc: 0.251 Test Loss: 1.503 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.033324718475342
Epoch: 3, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.859 Vali Acc: 0.251 Test Loss: 1.859 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5949370861053467
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.658 Vali Acc: 0.285 Test Loss: 1.658 Test Acc: 0.285
Validation loss decreased (-0.258538 --> -0.285155).  Saving model ...
Epoch: 5 cost time: 1.998596429824829
Epoch: 5, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.618 Vali Acc: 0.228 Test Loss: 1.618 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.836519479751587
Epoch: 6, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.744 Vali Acc: 0.251 Test Loss: 1.744 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.86159348487854
Epoch: 7, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.813 Vali Acc: 0.224 Test Loss: 1.813 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8251347541809082
Epoch: 8, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.641 Vali Acc: 0.255 Test Loss: 1.641 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.771510124206543
Epoch: 9, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.782 Vali Acc: 0.224 Test Loss: 1.782 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9970779418945312
Epoch: 10, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.919 Vali Acc: 0.240 Test Loss: 1.919 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4465832710266113
Epoch: 11, Steps: 17 | Train Loss: 0.979 Vali Loss: 2.016 Vali Acc: 0.228 Test Loss: 2.016 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7246372699737549
Epoch: 12, Steps: 17 | Train Loss: 0.958 Vali Loss: 2.102 Vali Acc: 0.232 Test Loss: 2.102 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.629385232925415
Epoch: 13, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.826 Vali Acc: 0.243 Test Loss: 1.826 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5347399711608887
Epoch: 14, Steps: 17 | Train Loss: 0.912 Vali Loss: 2.182 Vali Acc: 0.228 Test Loss: 2.182 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps88_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 23073028
model size : 102.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps88_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0965046882629395
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.490 Vali Acc: 0.255 Test Loss: 1.490 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.794600248336792
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.474 Vali Acc: 0.259 Test Loss: 1.474 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258540).  Saving model ...
Epoch: 3 cost time: 2.017378807067871
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.481 Vali Acc: 0.232 Test Loss: 1.481 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5476734638214111
Epoch: 4, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.568 Vali Acc: 0.221 Test Loss: 1.568 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.608879804611206
Epoch: 5, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.563 Vali Acc: 0.221 Test Loss: 1.563 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7221031188964844
Epoch: 6, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.671 Vali Acc: 0.270 Test Loss: 1.671 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269945).  Saving model ...
Epoch: 7 cost time: 2.0044937133789062
Epoch: 7, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.746 Vali Acc: 0.259 Test Loss: 1.746 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1501376628875732
Epoch: 8, Steps: 17 | Train Loss: 1.158 Vali Loss: 2.036 Vali Acc: 0.255 Test Loss: 2.036 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.004028558731079
Epoch: 9, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.892 Vali Acc: 0.236 Test Loss: 1.892 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4783308506011963
Epoch: 10, Steps: 17 | Train Loss: 0.977 Vali Loss: 2.049 Vali Acc: 0.240 Test Loss: 2.049 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7350447177886963
Epoch: 11, Steps: 17 | Train Loss: 0.994 Vali Loss: 2.275 Vali Acc: 0.259 Test Loss: 2.275 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2083094120025635
Epoch: 12, Steps: 17 | Train Loss: 1.009 Vali Loss: 2.229 Vali Acc: 0.251 Test Loss: 2.229 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.279860496520996
Epoch: 13, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.810 Vali Acc: 0.221 Test Loss: 1.810 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9959518909454346
Epoch: 14, Steps: 17 | Train Loss: 0.921 Vali Loss: 2.270 Vali Acc: 0.251 Test Loss: 2.270 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3331925868988037
Epoch: 15, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.909 Vali Acc: 0.236 Test Loss: 1.909 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9982731342315674
Epoch: 16, Steps: 17 | Train Loss: 0.817 Vali Loss: 2.400 Vali Acc: 0.243 Test Loss: 2.400 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps88_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 22897924
model size : 102.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps88_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.602109432220459
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.715590000152588
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.581 Vali Acc: 0.243 Test Loss: 1.581 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8510096073150635
Epoch: 3, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.474 Vali Acc: 0.232 Test Loss: 1.474 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4989941120147705
Epoch: 4, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 1.4063806533813477
Epoch: 5, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.477 Vali Acc: 0.255 Test Loss: 1.477 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.108628511428833
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.697 Vali Acc: 0.266 Test Loss: 1.697 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.254450798034668
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.512 Vali Acc: 0.243 Test Loss: 1.512 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2502882480621338
Epoch: 8, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.683 Vali Acc: 0.259 Test Loss: 1.683 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5864267349243164
Epoch: 9, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8116257190704346
Epoch: 10, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.653 Vali Acc: 0.221 Test Loss: 1.653 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9099078178405762
Epoch: 11, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.693 Vali Acc: 0.247 Test Loss: 1.693 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6856560707092285
Epoch: 12, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.781 Vali Acc: 0.247 Test Loss: 1.781 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9050164222717285
Epoch: 13, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.970 Vali Acc: 0.224 Test Loss: 1.970 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4800817966461182
Epoch: 14, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.811 Vali Acc: 0.255 Test Loss: 1.811 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps88_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 22810372
model size : 101.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.152406454086304
Epoch: 1, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.541 Vali Acc: 0.262 Test Loss: 1.541 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 2.3294973373413086
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.690 Vali Acc: 0.247 Test Loss: 1.690 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.274474859237671
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.610 Vali Acc: 0.278 Test Loss: 1.610 Test Acc: 0.278
Validation loss decreased (-0.262342 --> -0.277550).  Saving model ...
Epoch: 4 cost time: 2.080871820449829
Epoch: 4, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.559 Vali Acc: 0.289 Test Loss: 1.559 Test Acc: 0.289
Validation loss decreased (-0.277550 --> -0.288958).  Saving model ...
Epoch: 5 cost time: 2.1992342472076416
Epoch: 5, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.797 Vali Acc: 0.243 Test Loss: 1.797 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8645033836364746
Epoch: 6, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.562 Vali Acc: 0.217 Test Loss: 1.562 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7796030044555664
Epoch: 7, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.105 Vali Acc: 0.240 Test Loss: 2.105 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9976110458374023
Epoch: 8, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.794 Vali Acc: 0.247 Test Loss: 1.794 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1132712364196777
Epoch: 9, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.541 Vali Acc: 0.266 Test Loss: 2.541 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8889002799987793
Epoch: 10, Steps: 17 | Train Loss: 1.309 Vali Loss: 2.062 Vali Acc: 0.266 Test Loss: 2.062 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9008169174194336
Epoch: 11, Steps: 17 | Train Loss: 0.977 Vali Loss: 2.719 Vali Acc: 0.266 Test Loss: 2.719 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9967403411865234
Epoch: 12, Steps: 17 | Train Loss: 1.072 Vali Loss: 2.147 Vali Acc: 0.228 Test Loss: 2.147 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.681318759918213
Epoch: 13, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.145 Vali Acc: 0.224 Test Loss: 2.145 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6388816833496094
Epoch: 14, Steps: 17 | Train Loss: 1.000 Vali Loss: 2.137 Vali Acc: 0.213 Test Loss: 2.137 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 23079940
model size : 102.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6000304222106934
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.724 Vali Acc: 0.243 Test Loss: 1.724 Test Acc: 0.243
Validation loss decreased (inf --> -0.243329).  Saving model ...
Epoch: 2 cost time: 1.1784424781799316
Epoch: 2, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.448 Vali Acc: 0.270 Test Loss: 1.448 Test Acc: 0.270
Validation loss decreased (-0.243329 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 1.651982069015503
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.479 Vali Acc: 0.259 Test Loss: 1.479 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5728166103363037
Epoch: 4, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.589 Vali Acc: 0.228 Test Loss: 1.589 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9116642475128174
Epoch: 5, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.450 Vali Acc: 0.281 Test Loss: 1.450 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 1.5213584899902344
Epoch: 6, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.638 Vali Acc: 0.266 Test Loss: 1.638 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.517913818359375
Epoch: 7, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.614 Vali Acc: 0.232 Test Loss: 1.614 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.460951328277588
Epoch: 8, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.809 Vali Acc: 0.255 Test Loss: 1.809 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5709199905395508
Epoch: 9, Steps: 17 | Train Loss: 1.129 Vali Loss: 2.042 Vali Acc: 0.243 Test Loss: 2.042 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5565941333770752
Epoch: 10, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.822 Vali Acc: 0.270 Test Loss: 1.822 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.588881492614746
Epoch: 11, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.965 Vali Acc: 0.232 Test Loss: 1.965 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0030319690704346
Epoch: 12, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.931 Vali Acc: 0.255 Test Loss: 1.931 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1267237663269043
Epoch: 13, Steps: 17 | Train Loss: 1.027 Vali Loss: 2.073 Vali Acc: 0.236 Test Loss: 2.073 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6257410049438477
Epoch: 14, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.916 Vali Acc: 0.240 Test Loss: 1.916 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.411738395690918
Epoch: 15, Steps: 17 | Train Loss: 0.904 Vali Loss: 2.196 Vali Acc: 0.259 Test Loss: 2.196 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 22923268
model size : 102.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4039719104766846
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.450 Vali Acc: 0.274 Test Loss: 1.450 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.6514506340026855
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.473 Vali Acc: 0.255 Test Loss: 1.473 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.740858554840088
Epoch: 3, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.482 Vali Acc: 0.217 Test Loss: 1.482 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.418773889541626
Epoch: 4, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.470 Vali Acc: 0.247 Test Loss: 1.470 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5470550060272217
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.485 Vali Acc: 0.270 Test Loss: 1.485 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.405656099319458
Epoch: 6, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.531 Vali Acc: 0.247 Test Loss: 1.531 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1198735237121582
Epoch: 7, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.655 Vali Acc: 0.255 Test Loss: 1.655 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1204886436462402
Epoch: 8, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.702 Vali Acc: 0.266 Test Loss: 1.702 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.265650749206543
Epoch: 9, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.711 Vali Acc: 0.255 Test Loss: 1.711 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5467422008514404
Epoch: 10, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.599 Vali Acc: 0.240 Test Loss: 1.599 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2626428604125977
Epoch: 11, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.879 Vali Acc: 0.228 Test Loss: 1.879 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 22840324
model size : 101.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps98_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.580061912536621
Epoch: 1, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.542 Vali Acc: 0.274 Test Loss: 1.542 Test Acc: 0.274
Validation loss decreased (inf --> -0.273749).  Saving model ...
Epoch: 2 cost time: 1.9200422763824463
Epoch: 2, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.542 Vali Acc: 0.255 Test Loss: 1.542 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8642973899841309
Epoch: 3, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.515 Vali Acc: 0.255 Test Loss: 1.515 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9911177158355713
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.640 Vali Acc: 0.281 Test Loss: 1.640 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281352).  Saving model ...
Epoch: 5 cost time: 2.2232887744903564
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.662 Vali Acc: 0.266 Test Loss: 1.662 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0525460243225098
Epoch: 6, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.847 Vali Acc: 0.240 Test Loss: 1.847 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.974489450454712
Epoch: 7, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.738 Vali Acc: 0.243 Test Loss: 1.738 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1239683628082275
Epoch: 8, Steps: 17 | Train Loss: 1.290 Vali Loss: 2.274 Vali Acc: 0.243 Test Loss: 2.274 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9278838634490967
Epoch: 9, Steps: 17 | Train Loss: 1.182 Vali Loss: 2.070 Vali Acc: 0.255 Test Loss: 2.070 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8346831798553467
Epoch: 10, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.567 Vali Acc: 0.240 Test Loss: 1.567 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.101813793182373
Epoch: 11, Steps: 17 | Train Loss: 1.191 Vali Loss: 2.117 Vali Acc: 0.255 Test Loss: 2.117 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1618454456329346
Epoch: 12, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.965 Vali Acc: 0.243 Test Loss: 1.965 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9637181758880615
Epoch: 13, Steps: 17 | Train Loss: 1.058 Vali Loss: 2.198 Vali Acc: 0.236 Test Loss: 2.198 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1785531044006348
Epoch: 14, Steps: 17 | Train Loss: 1.051 Vali Loss: 2.705 Vali Acc: 0.228 Test Loss: 2.705 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps98_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 23100676
model size : 102.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps98_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.978343963623047
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.456 Vali Acc: 0.262 Test Loss: 1.456 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.5382287502288818
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.8643879890441895
Epoch: 3, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.600 Vali Acc: 0.259 Test Loss: 1.600 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.845017433166504
Epoch: 4, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.692 Vali Acc: 0.243 Test Loss: 1.692 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7002456188201904
Epoch: 5, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.627 Vali Acc: 0.278 Test Loss: 1.627 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277550).  Saving model ...
Epoch: 6 cost time: 2.128760814666748
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.677 Vali Acc: 0.251 Test Loss: 1.677 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8856496810913086
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.495 Vali Acc: 0.259 Test Loss: 1.495 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6955101490020752
Epoch: 8, Steps: 17 | Train Loss: 1.191 Vali Loss: 2.074 Vali Acc: 0.240 Test Loss: 2.074 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5753483772277832
Epoch: 9, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.773 Vali Acc: 0.251 Test Loss: 1.773 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6234102249145508
Epoch: 10, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.585 Vali Acc: 0.232 Test Loss: 1.585 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5861735343933105
Epoch: 11, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.902 Vali Acc: 0.247 Test Loss: 1.902 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6117234230041504
Epoch: 12, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.807 Vali Acc: 0.281 Test Loss: 1.807 Test Acc: 0.281
Validation loss decreased (-0.277550 --> -0.281351).  Saving model ...
Epoch: 13 cost time: 1.3589894771575928
Epoch: 13, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.200 Vali Acc: 0.232 Test Loss: 2.200 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8175806999206543
Epoch: 14, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.890 Vali Acc: 0.266 Test Loss: 1.890 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.457958459854126
Epoch: 15, Steps: 17 | Train Loss: 0.921 Vali Loss: 2.345 Vali Acc: 0.255 Test Loss: 2.345 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.639082431793213
Epoch: 16, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.475 Vali Acc: 0.274 Test Loss: 2.475 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6866247653961182
Epoch: 17, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.459 Vali Acc: 0.243 Test Loss: 2.459 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.603248119354248
Epoch: 18, Steps: 17 | Train Loss: 0.889 Vali Loss: 2.139 Vali Acc: 0.213 Test Loss: 2.139 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.500694751739502
Epoch: 19, Steps: 17 | Train Loss: 0.821 Vali Loss: 2.434 Vali Acc: 0.255 Test Loss: 2.434 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1561498641967773
Epoch: 20, Steps: 17 | Train Loss: 0.827 Vali Loss: 2.538 Vali Acc: 0.224 Test Loss: 2.538 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4033076763153076
Epoch: 21, Steps: 17 | Train Loss: 0.819 Vali Loss: 3.067 Vali Acc: 0.243 Test Loss: 3.067 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2260353565216064
Epoch: 22, Steps: 17 | Train Loss: 0.819 Vali Loss: 2.216 Vali Acc: 0.251 Test Loss: 2.216 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps98_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 22948612
model size : 102.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps98_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.802872896194458
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.411 Vali Acc: 0.266 Test Loss: 1.411 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.4080111980438232
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.420 Vali Acc: 0.243 Test Loss: 1.420 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.474271535873413
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.567 Vali Acc: 0.228 Test Loss: 1.567 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6920948028564453
Epoch: 4, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.463 Vali Acc: 0.259 Test Loss: 1.463 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3938822746276855
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.536 Vali Acc: 0.259 Test Loss: 1.536 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4349079132080078
Epoch: 6, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.549 Vali Acc: 0.232 Test Loss: 1.549 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7182555198669434
Epoch: 7, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.544 Vali Acc: 0.285 Test Loss: 1.544 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285156).  Saving model ...
Epoch: 8 cost time: 1.6390302181243896
Epoch: 8, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.683 Vali Acc: 0.274 Test Loss: 1.683 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6540312767028809
Epoch: 9, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.815 Vali Acc: 0.251 Test Loss: 1.815 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9027175903320312
Epoch: 10, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.851 Vali Acc: 0.243 Test Loss: 1.851 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8816685676574707
Epoch: 11, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.618 Vali Acc: 0.247 Test Loss: 1.618 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0367074012756348
Epoch: 12, Steps: 17 | Train Loss: 1.009 Vali Loss: 2.090 Vali Acc: 0.240 Test Loss: 2.090 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8189353942871094
Epoch: 13, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.792 Vali Acc: 0.228 Test Loss: 1.792 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9046897888183594
Epoch: 14, Steps: 17 | Train Loss: 0.829 Vali Loss: 2.007 Vali Acc: 0.243 Test Loss: 2.007 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9039664268493652
Epoch: 15, Steps: 17 | Train Loss: 0.983 Vali Loss: 2.099 Vali Acc: 0.243 Test Loss: 2.099 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4126763343811035
Epoch: 16, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.776 Vali Acc: 0.236 Test Loss: 1.776 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2782361507415771
Epoch: 17, Steps: 17 | Train Loss: 0.921 Vali Loss: 2.104 Vali Acc: 0.240 Test Loss: 2.104 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps98_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 22870276
model size : 101.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps103_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.369287729263306
Epoch: 1, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 2.244227170944214
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.473 Vali Acc: 0.251 Test Loss: 1.473 Test Acc: 0.251
Validation loss decreased (-0.243331 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 2.072946310043335
Epoch: 3, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 2.2255897521972656
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.555 Vali Acc: 0.221 Test Loss: 1.555 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.407069444656372
Epoch: 5, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.545 Vali Acc: 0.232 Test Loss: 1.545 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6867854595184326
Epoch: 6, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.579 Vali Acc: 0.224 Test Loss: 1.579 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.539550542831421
Epoch: 7, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.856 Vali Acc: 0.228 Test Loss: 1.856 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.058457612991333
Epoch: 8, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.869 Vali Acc: 0.243 Test Loss: 1.869 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.503692150115967
Epoch: 9, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.811 Vali Acc: 0.236 Test Loss: 1.811 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1377944946289062
Epoch: 10, Steps: 17 | Train Loss: 1.016 Vali Loss: 2.032 Vali Acc: 0.259 Test Loss: 2.032 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1828558444976807
Epoch: 11, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.969 Vali Acc: 0.240 Test Loss: 1.969 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.30208158493042
Epoch: 12, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.865 Vali Acc: 0.228 Test Loss: 1.865 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3508808612823486
Epoch: 13, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.333 Vali Acc: 0.236 Test Loss: 2.333 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps103_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2585551330798479
model parameter : 23121412
model size : 102.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps103_str52_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.461146116256714
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.467 Vali Acc: 0.232 Test Loss: 1.467 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 2.012781858444214
Epoch: 2, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.523 Vali Acc: 0.243 Test Loss: 1.523 Test Acc: 0.243
Validation loss decreased (-0.231924 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 1.678898572921753
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.541 Vali Acc: 0.243 Test Loss: 1.541 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8814349174499512
Epoch: 4, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.481 Vali Acc: 0.243 Test Loss: 1.481 Test Acc: 0.243
Validation loss decreased (-0.243331 --> -0.243331).  Saving model ...
Epoch: 5 cost time: 1.6972136497497559
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.602 Vali Acc: 0.255 Test Loss: 1.602 Test Acc: 0.255
Validation loss decreased (-0.243331 --> -0.254737).  Saving model ...
Epoch: 6 cost time: 1.7285709381103516
Epoch: 6, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.589 Vali Acc: 0.240 Test Loss: 1.589 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6770777702331543
Epoch: 7, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.853 Vali Acc: 0.240 Test Loss: 1.853 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6489439010620117
Epoch: 8, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.606 Vali Acc: 0.251 Test Loss: 1.606 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7931077480316162
Epoch: 9, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.822 Vali Acc: 0.236 Test Loss: 1.822 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7527086734771729
Epoch: 10, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.149 Vali Acc: 0.255 Test Loss: 2.149 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5759270191192627
Epoch: 11, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.598 Vali Acc: 0.255 Test Loss: 1.598 Test Acc: 0.255
Validation loss decreased (-0.254737 --> -0.254737).  Saving model ...
Epoch: 12 cost time: 1.8538827896118164
Epoch: 12, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.029 Vali Acc: 0.262 Test Loss: 2.029 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262337).  Saving model ...
Epoch: 13 cost time: 1.862532615661621
Epoch: 13, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.865 Vali Acc: 0.232 Test Loss: 1.865 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7462680339813232
Epoch: 14, Steps: 17 | Train Loss: 1.046 Vali Loss: 2.033 Vali Acc: 0.270 Test Loss: 2.033 Test Acc: 0.270
Validation loss decreased (-0.262337 --> -0.269942).  Saving model ...
Epoch: 15 cost time: 1.7096540927886963
Epoch: 15, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.063 Vali Acc: 0.243 Test Loss: 2.063 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7110497951507568
Epoch: 16, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.133 Vali Acc: 0.232 Test Loss: 2.133 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3223674297332764
Epoch: 17, Steps: 17 | Train Loss: 0.930 Vali Loss: 2.179 Vali Acc: 0.217 Test Loss: 2.179 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5679454803466797
Epoch: 18, Steps: 17 | Train Loss: 0.802 Vali Loss: 2.348 Vali Acc: 0.232 Test Loss: 2.348 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5870935916900635
Epoch: 19, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.787 Vali Acc: 0.255 Test Loss: 2.787 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5986816883087158
Epoch: 20, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.252 Vali Acc: 0.232 Test Loss: 2.252 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6108813285827637
Epoch: 21, Steps: 17 | Train Loss: 0.770 Vali Loss: 2.427 Vali Acc: 0.221 Test Loss: 2.427 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7363603115081787
Epoch: 22, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.711 Vali Acc: 0.209 Test Loss: 2.711 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4869723320007324
Epoch: 23, Steps: 17 | Train Loss: 0.725 Vali Loss: 2.820 Vali Acc: 0.194 Test Loss: 2.820 Test Acc: 0.194
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.506525993347168
Epoch: 24, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.860 Vali Acc: 0.236 Test Loss: 2.860 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps103_str52_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 22973956
model size : 102.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps103_str103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.499906539916992
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.431 Vali Acc: 0.217 Test Loss: 1.431 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 1.8162996768951416
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.539 Vali Acc: 0.236 Test Loss: 1.539 Test Acc: 0.236
Validation loss decreased (-0.216716 --> -0.235726).  Saving model ...
Epoch: 3 cost time: 1.8035988807678223
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
Validation loss decreased (-0.235726 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 1.9853856563568115
Epoch: 4, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.519 Vali Acc: 0.240 Test Loss: 1.519 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5871052742004395
Epoch: 5, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.478 Vali Acc: 0.285 Test Loss: 1.478 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 1.7794907093048096
Epoch: 6, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.580 Vali Acc: 0.240 Test Loss: 1.580 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.741405963897705
Epoch: 7, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.643 Vali Acc: 0.236 Test Loss: 1.643 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7928259372711182
Epoch: 8, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.797 Vali Acc: 0.251 Test Loss: 1.797 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4005756378173828
Epoch: 9, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.894 Vali Acc: 0.202 Test Loss: 1.894 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8559322357177734
Epoch: 10, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.871 Vali Acc: 0.228 Test Loss: 1.871 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0789074897766113
Epoch: 11, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.733 Vali Acc: 0.240 Test Loss: 1.733 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.044796943664551
Epoch: 12, Steps: 17 | Train Loss: 0.999 Vali Loss: 2.079 Vali Acc: 0.243 Test Loss: 2.079 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9227862358093262
Epoch: 13, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.871 Vali Acc: 0.251 Test Loss: 1.871 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5903568267822266
Epoch: 14, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.286 Vali Acc: 0.221 Test Loss: 2.286 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.874135971069336
Epoch: 15, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.887 Vali Acc: 0.232 Test Loss: 1.887 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps103_str103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 22904836
model size : 102.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps110_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.808315992355347
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.532 Vali Acc: 0.251 Test Loss: 1.532 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 2.0779430866241455
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.455 Vali Acc: 0.236 Test Loss: 1.455 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8636937141418457
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.774 Vali Acc: 0.247 Test Loss: 1.774 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.357529640197754
Epoch: 4, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.752 Vali Acc: 0.243 Test Loss: 1.752 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.729532241821289
Epoch: 5, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.781 Vali Acc: 0.266 Test Loss: 1.781 Test Acc: 0.266
Validation loss decreased (-0.250935 --> -0.266142).  Saving model ...
Epoch: 6 cost time: 1.807816982269287
Epoch: 6, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.690 Vali Acc: 0.240 Test Loss: 1.690 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.050258159637451
Epoch: 7, Steps: 17 | Train Loss: 1.136 Vali Loss: 2.105 Vali Acc: 0.278 Test Loss: 2.105 Test Acc: 0.278
Validation loss decreased (-0.266142 --> -0.277545).  Saving model ...
Epoch: 8 cost time: 1.7616233825683594
Epoch: 8, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.928 Vali Acc: 0.259 Test Loss: 1.928 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6544525623321533
Epoch: 9, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.676 Vali Acc: 0.240 Test Loss: 1.676 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0592095851898193
Epoch: 10, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.882 Vali Acc: 0.247 Test Loss: 1.882 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2871346473693848
Epoch: 11, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.964 Vali Acc: 0.251 Test Loss: 1.964 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2903010845184326
Epoch: 12, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.989 Vali Acc: 0.262 Test Loss: 1.989 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.443603277206421
Epoch: 13, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.846 Vali Acc: 0.243 Test Loss: 1.846 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1132545471191406
Epoch: 14, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.230 Vali Acc: 0.236 Test Loss: 2.230 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0800774097442627
Epoch: 15, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.607 Vali Acc: 0.251 Test Loss: 2.607 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1295006275177
Epoch: 16, Steps: 17 | Train Loss: 0.894 Vali Loss: 2.244 Vali Acc: 0.247 Test Loss: 2.244 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.952441692352295
Epoch: 17, Steps: 17 | Train Loss: 0.823 Vali Loss: 2.592 Vali Acc: 0.251 Test Loss: 2.592 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps110_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 23146756
model size : 102.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps110_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.055330038070679
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.464 Vali Acc: 0.247 Test Loss: 1.464 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.6699998378753662
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.487 Vali Acc: 0.266 Test Loss: 1.487 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.444467306137085
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.684 Vali Acc: 0.262 Test Loss: 1.684 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0715532302856445
Epoch: 4, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.689 Vali Acc: 0.255 Test Loss: 1.689 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9947810173034668
Epoch: 5, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.479 Vali Acc: 0.224 Test Loss: 1.479 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2342545986175537
Epoch: 6, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.916 Vali Acc: 0.243 Test Loss: 1.916 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2176759243011475
Epoch: 7, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.659 Vali Acc: 0.262 Test Loss: 1.659 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1266942024230957
Epoch: 8, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.903 Vali Acc: 0.259 Test Loss: 1.903 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.18291974067688
Epoch: 9, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.627 Vali Acc: 0.259 Test Loss: 1.627 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0583431720733643
Epoch: 10, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.902 Vali Acc: 0.224 Test Loss: 1.902 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8514106273651123
Epoch: 11, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.720 Vali Acc: 0.274 Test Loss: 1.720 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273747).  Saving model ...
Epoch: 12 cost time: 1.6478874683380127
Epoch: 12, Steps: 17 | Train Loss: 1.136 Vali Loss: 2.023 Vali Acc: 0.232 Test Loss: 2.023 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7135779857635498
Epoch: 13, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.025 Vali Acc: 0.251 Test Loss: 2.025 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7397291660308838
Epoch: 14, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.811 Vali Acc: 0.236 Test Loss: 1.811 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9150233268737793
Epoch: 15, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.988 Vali Acc: 0.274 Test Loss: 1.988 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9379618167877197
Epoch: 16, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.067 Vali Acc: 0.247 Test Loss: 2.067 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8810322284698486
Epoch: 17, Steps: 17 | Train Loss: 0.904 Vali Loss: 2.157 Vali Acc: 0.255 Test Loss: 2.157 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8531265258789062
Epoch: 18, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.056 Vali Acc: 0.262 Test Loss: 2.056 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.000222682952881
Epoch: 19, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.249 Vali Acc: 0.251 Test Loss: 2.249 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.865842342376709
Epoch: 20, Steps: 17 | Train Loss: 0.959 Vali Loss: 2.284 Vali Acc: 0.247 Test Loss: 2.284 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7554101943969727
Epoch: 21, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.466 Vali Acc: 0.232 Test Loss: 2.466 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps110_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 23013124
model size : 102.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps110_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.993873357772827
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.461 Vali Acc: 0.247 Test Loss: 1.461 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.217179536819458
Epoch: 2, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.526 Vali Acc: 0.255 Test Loss: 1.526 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.1882638931274414
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.485 Vali Acc: 0.278 Test Loss: 1.485 Test Acc: 0.278
Validation loss decreased (-0.254738 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.2338783740997314
Epoch: 4, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.533 Vali Acc: 0.262 Test Loss: 1.533 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4123289585113525
Epoch: 5, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.452 Vali Acc: 0.232 Test Loss: 1.452 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6538522243499756
Epoch: 6, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.528 Vali Acc: 0.262 Test Loss: 1.528 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2211880683898926
Epoch: 7, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.581 Vali Acc: 0.247 Test Loss: 1.581 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2845330238342285
Epoch: 8, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.710 Vali Acc: 0.259 Test Loss: 1.710 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4485623836517334
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.767 Vali Acc: 0.247 Test Loss: 1.767 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3352203369140625
Epoch: 10, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.753 Vali Acc: 0.255 Test Loss: 1.753 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1617045402526855
Epoch: 11, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.717 Vali Acc: 0.259 Test Loss: 1.717 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2557501792907715
Epoch: 12, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.935 Vali Acc: 0.262 Test Loss: 1.935 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2380833625793457
Epoch: 13, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.661 Vali Acc: 0.224 Test Loss: 1.661 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps110_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 22944004
model size : 102.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps117_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.4496910572052
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.541 Vali Acc: 0.255 Test Loss: 1.541 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 1.6309118270874023
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.502 Vali Acc: 0.224 Test Loss: 1.502 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7851831912994385
Epoch: 3, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.507 Vali Acc: 0.255 Test Loss: 1.507 Test Acc: 0.255
Validation loss decreased (-0.254737 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 1.7878751754760742
Epoch: 4, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.821 Vali Acc: 0.251 Test Loss: 1.821 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0439295768737793
Epoch: 5, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.761 Vali Acc: 0.236 Test Loss: 1.761 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.862891435623169
Epoch: 6, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.490 Vali Acc: 0.259 Test Loss: 1.490 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258540).  Saving model ...
Epoch: 7 cost time: 2.2968966960906982
Epoch: 7, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.713 Vali Acc: 0.228 Test Loss: 1.713 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3078396320343018
Epoch: 8, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.803 Vali Acc: 0.240 Test Loss: 1.803 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.611487865447998
Epoch: 9, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.829 Vali Acc: 0.243 Test Loss: 1.829 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.122776508331299
Epoch: 10, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.619 Vali Acc: 0.247 Test Loss: 2.619 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0874016284942627
Epoch: 11, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.758 Vali Acc: 0.247 Test Loss: 1.758 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0060715675354004
Epoch: 12, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.811 Vali Acc: 0.270 Test Loss: 1.811 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269944).  Saving model ...
Epoch: 13 cost time: 2.0840721130371094
Epoch: 13, Steps: 17 | Train Loss: 1.043 Vali Loss: 2.443 Vali Acc: 0.240 Test Loss: 2.443 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2743406295776367
Epoch: 14, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.622 Vali Acc: 0.247 Test Loss: 1.622 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0859596729278564
Epoch: 15, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.334 Vali Acc: 0.255 Test Loss: 2.334 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2998719215393066
Epoch: 16, Steps: 17 | Train Loss: 0.753 Vali Loss: 2.439 Vali Acc: 0.232 Test Loss: 2.439 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1502718925476074
Epoch: 17, Steps: 17 | Train Loss: 0.842 Vali Loss: 2.818 Vali Acc: 0.213 Test Loss: 2.818 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5086236000061035
Epoch: 18, Steps: 17 | Train Loss: 0.954 Vali Loss: 2.384 Vali Acc: 0.266 Test Loss: 2.384 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.235889196395874
Epoch: 19, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.599 Vali Acc: 0.236 Test Loss: 2.599 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.138488531112671
Epoch: 20, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.135 Vali Acc: 0.255 Test Loss: 2.135 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2255570888519287
Epoch: 21, Steps: 17 | Train Loss: 0.799 Vali Loss: 2.462 Vali Acc: 0.251 Test Loss: 2.462 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.487009286880493
Epoch: 22, Steps: 17 | Train Loss: 0.838 Vali Loss: 2.243 Vali Acc: 0.232 Test Loss: 2.243 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps117_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 23176708
model size : 103.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps117_str59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.627492666244507
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.465 Vali Acc: 0.255 Test Loss: 1.465 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.6313774585723877
Epoch: 2, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.419 Vali Acc: 0.293 Test Loss: 1.419 Test Acc: 0.293
Validation loss decreased (-0.254738 --> -0.292761).  Saving model ...
Epoch: 3 cost time: 1.6153297424316406
Epoch: 3, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.510 Vali Acc: 0.266 Test Loss: 1.510 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8394076824188232
Epoch: 4, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.560 Vali Acc: 0.262 Test Loss: 1.560 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4869616031646729
Epoch: 5, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.484 Vali Acc: 0.224 Test Loss: 1.484 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8413946628570557
Epoch: 6, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.508 Vali Acc: 0.224 Test Loss: 1.508 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6413636207580566
Epoch: 7, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.751 Vali Acc: 0.289 Test Loss: 1.751 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8193426132202148
Epoch: 8, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.773 Vali Acc: 0.259 Test Loss: 1.773 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8165264129638672
Epoch: 9, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.814 Vali Acc: 0.228 Test Loss: 1.814 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.426527976989746
Epoch: 10, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.932 Vali Acc: 0.236 Test Loss: 1.932 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.690596103668213
Epoch: 11, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.877 Vali Acc: 0.247 Test Loss: 1.877 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5499796867370605
Epoch: 12, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.860 Vali Acc: 0.221 Test Loss: 1.860 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps117_str59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 23052292
model size : 102.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps117_str117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6041316986083984
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.410 Vali Acc: 0.297 Test Loss: 1.410 Test Acc: 0.297
Validation loss decreased (inf --> -0.296564).  Saving model ...
Epoch: 2 cost time: 1.581050157546997
Epoch: 2, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.422 Vali Acc: 0.259 Test Loss: 1.422 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4163322448730469
Epoch: 3, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.409 Vali Acc: 0.285 Test Loss: 1.409 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1916685104370117
Epoch: 4, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.509 Vali Acc: 0.274 Test Loss: 1.509 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1693027019500732
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.432 Vali Acc: 0.262 Test Loss: 1.432 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1589405536651611
Epoch: 6, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.506 Vali Acc: 0.259 Test Loss: 1.506 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3317115306854248
Epoch: 7, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.622 Vali Acc: 0.259 Test Loss: 1.622 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4114975929260254
Epoch: 8, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.662 Vali Acc: 0.243 Test Loss: 1.662 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2727446556091309
Epoch: 9, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.695 Vali Acc: 0.232 Test Loss: 1.695 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3872084617614746
Epoch: 10, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.598 Vali Acc: 0.262 Test Loss: 1.598 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4382891654968262
Epoch: 11, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.789 Vali Acc: 0.251 Test Loss: 1.789 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps117_str117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 22987780
model size : 102.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps126_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.030524015426636
Epoch: 1, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.604 Vali Acc: 0.270 Test Loss: 1.604 Test Acc: 0.270
Validation loss decreased (inf --> -0.269946).  Saving model ...
Epoch: 2 cost time: 2.27923846244812
Epoch: 2, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.576 Vali Acc: 0.251 Test Loss: 1.576 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1358211040496826
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.576 Vali Acc: 0.251 Test Loss: 1.576 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3968124389648438
Epoch: 4, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.497 Vali Acc: 0.232 Test Loss: 1.497 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.147084951400757
Epoch: 5, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.468 Vali Acc: 0.255 Test Loss: 1.468 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.077707052230835
Epoch: 6, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.867 Vali Acc: 0.262 Test Loss: 1.867 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.089977502822876
Epoch: 7, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.712 Vali Acc: 0.251 Test Loss: 1.712 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.038546562194824
Epoch: 8, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.692 Vali Acc: 0.240 Test Loss: 1.692 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8825030326843262
Epoch: 9, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.875 Vali Acc: 0.243 Test Loss: 1.875 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7743501663208008
Epoch: 10, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.801 Vali Acc: 0.228 Test Loss: 1.801 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9640476703643799
Epoch: 11, Steps: 17 | Train Loss: 1.047 Vali Loss: 2.141 Vali Acc: 0.232 Test Loss: 2.141 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps126_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 23220484
model size : 103.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps126_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8730926513671875
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.412 Vali Acc: 0.255 Test Loss: 1.412 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.9223663806915283
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.453582525253296
Epoch: 3, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.516 Vali Acc: 0.255 Test Loss: 1.516 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.041062355041504
Epoch: 4, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.524 Vali Acc: 0.274 Test Loss: 1.524 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 1.4484515190124512
Epoch: 5, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.579 Vali Acc: 0.270 Test Loss: 1.579 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9201152324676514
Epoch: 6, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.535 Vali Acc: 0.224 Test Loss: 1.535 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7553739547729492
Epoch: 7, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.572 Vali Acc: 0.224 Test Loss: 1.572 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.643066167831421
Epoch: 8, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.554 Vali Acc: 0.224 Test Loss: 1.554 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4165246486663818
Epoch: 9, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.920 Vali Acc: 0.236 Test Loss: 1.920 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3660969734191895
Epoch: 10, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.880 Vali Acc: 0.270 Test Loss: 1.880 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4989845752716064
Epoch: 11, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.801 Vali Acc: 0.236 Test Loss: 1.801 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9244635105133057
Epoch: 12, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.933 Vali Acc: 0.232 Test Loss: 1.933 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.882659912109375
Epoch: 13, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.175 Vali Acc: 0.274 Test Loss: 2.175 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5534255504608154
Epoch: 14, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.862 Vali Acc: 0.262 Test Loss: 1.862 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps126_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 23105284
model size : 102.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps126_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.613807439804077
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.435 Vali Acc: 0.240 Test Loss: 1.435 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.6030285358428955
Epoch: 2, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.624 Vali Acc: 0.232 Test Loss: 1.624 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3584551811218262
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.446 Vali Acc: 0.259 Test Loss: 1.446 Test Acc: 0.259
Validation loss decreased (-0.239529 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 1.4074792861938477
Epoch: 4, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.463 Vali Acc: 0.243 Test Loss: 1.463 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.381608486175537
Epoch: 5, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.509 Vali Acc: 0.228 Test Loss: 1.509 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.314500093460083
Epoch: 6, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.566 Vali Acc: 0.228 Test Loss: 1.566 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4548702239990234
Epoch: 7, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.725 Vali Acc: 0.228 Test Loss: 1.725 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4636170864105225
Epoch: 8, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.555 Vali Acc: 0.217 Test Loss: 1.555 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4022948741912842
Epoch: 9, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.764 Vali Acc: 0.240 Test Loss: 1.764 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3728089332580566
Epoch: 10, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.658 Vali Acc: 0.262 Test Loss: 1.658 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 11 cost time: 1.4520223140716553
Epoch: 11, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.759 Vali Acc: 0.255 Test Loss: 1.759 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7134034633636475
Epoch: 12, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.811 Vali Acc: 0.266 Test Loss: 1.811 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266142).  Saving model ...
Epoch: 13 cost time: 1.450268268585205
Epoch: 13, Steps: 17 | Train Loss: 1.016 Vali Loss: 2.076 Vali Acc: 0.251 Test Loss: 2.076 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7164649963378906
Epoch: 14, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.733 Vali Acc: 0.251 Test Loss: 1.733 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4168787002563477
Epoch: 15, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.920 Vali Acc: 0.228 Test Loss: 1.920 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6855525970458984
Epoch: 16, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.373 Vali Acc: 0.243 Test Loss: 2.373 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.65364408493042
Epoch: 17, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.984 Vali Acc: 0.232 Test Loss: 1.984 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.477940559387207
Epoch: 18, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.876 Vali Acc: 0.262 Test Loss: 1.876 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5150315761566162
Epoch: 19, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.452 Vali Acc: 0.243 Test Loss: 2.452 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8689446449279785
Epoch: 20, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.032 Vali Acc: 0.255 Test Loss: 2.032 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7814297676086426
Epoch: 21, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.361 Vali Acc: 0.247 Test Loss: 2.361 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.508166790008545
Epoch: 22, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.475 Vali Acc: 0.293 Test Loss: 2.475 Test Acc: 0.293
Validation loss decreased (-0.266142 --> -0.292751).  Saving model ...
Epoch: 23 cost time: 1.6283116340637207
Epoch: 23, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.197 Vali Acc: 0.243 Test Loss: 2.197 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3647997379302979
Epoch: 24, Steps: 17 | Train Loss: 0.788 Vali Loss: 2.334 Vali Acc: 0.243 Test Loss: 2.334 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4707672595977783
Epoch: 25, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.375 Vali Acc: 0.217 Test Loss: 2.375 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.458141803741455
Epoch: 26, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.317 Vali Acc: 0.243 Test Loss: 2.317 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.502070426940918
Epoch: 27, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.493 Vali Acc: 0.247 Test Loss: 2.493 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1952877044677734
Epoch: 28, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.478 Vali Acc: 0.228 Test Loss: 2.478 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.46919846534729
Epoch: 29, Steps: 17 | Train Loss: 0.743 Vali Loss: 2.411 Vali Acc: 0.259 Test Loss: 2.411 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3709962368011475
Epoch: 30, Steps: 17 | Train Loss: 0.579 Vali Loss: 2.845 Vali Acc: 0.247 Test Loss: 2.845 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5881872177124023
Epoch: 31, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.282 Vali Acc: 0.270 Test Loss: 2.282 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5530438423156738
Epoch: 32, Steps: 17 | Train Loss: 0.653 Vali Loss: 3.434 Vali Acc: 0.224 Test Loss: 3.434 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps126_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 23045380
model size : 102.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps135_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.3492443561553955
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.433 Vali Acc: 0.270 Test Loss: 1.433 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 2.294395685195923
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.491 Vali Acc: 0.278 Test Loss: 1.491 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 2.169405221939087
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.488 Vali Acc: 0.217 Test Loss: 1.488 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.335315227508545
Epoch: 4, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.612 Vali Acc: 0.262 Test Loss: 1.612 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2236523628234863
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.640 Vali Acc: 0.236 Test Loss: 1.640 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0308845043182373
Epoch: 6, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.569 Vali Acc: 0.243 Test Loss: 1.569 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.39422345161438
Epoch: 7, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.635 Vali Acc: 0.270 Test Loss: 1.635 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.666729688644409
Epoch: 8, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.949 Vali Acc: 0.221 Test Loss: 1.949 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3179471492767334
Epoch: 9, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.607 Vali Acc: 0.293 Test Loss: 1.607 Test Acc: 0.293
Validation loss decreased (-0.277552 --> -0.292760).  Saving model ...
Epoch: 10 cost time: 1.935539722442627
Epoch: 10, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.858 Vali Acc: 0.251 Test Loss: 1.858 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8248343467712402
Epoch: 11, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.594 Vali Acc: 0.213 Test Loss: 2.594 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8954808712005615
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 2.303 Vali Acc: 0.202 Test Loss: 2.303 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9446215629577637
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.860 Vali Acc: 0.262 Test Loss: 1.860 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8197057247161865
Epoch: 14, Steps: 17 | Train Loss: 0.970 Vali Loss: 2.182 Vali Acc: 0.240 Test Loss: 2.182 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7512187957763672
Epoch: 15, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.826 Vali Acc: 0.259 Test Loss: 2.826 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.780263900756836
Epoch: 16, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.026 Vali Acc: 0.259 Test Loss: 2.026 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6505348682403564
Epoch: 17, Steps: 17 | Train Loss: 0.810 Vali Loss: 3.155 Vali Acc: 0.232 Test Loss: 3.155 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8705003261566162
Epoch: 18, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.826 Vali Acc: 0.247 Test Loss: 1.826 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7422511577606201
Epoch: 19, Steps: 17 | Train Loss: 0.802 Vali Loss: 3.179 Vali Acc: 0.270 Test Loss: 3.179 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps135_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 23268868
model size : 103.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.832374334335327
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.474 Vali Acc: 0.278 Test Loss: 1.474 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 2.0817177295684814
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.497 Vali Acc: 0.255 Test Loss: 1.497 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6856367588043213
Epoch: 3, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7957518100738525
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.593 Vali Acc: 0.270 Test Loss: 1.593 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8264236450195312
Epoch: 5, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.534 Vali Acc: 0.274 Test Loss: 1.534 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8863012790679932
Epoch: 6, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.707 Vali Acc: 0.228 Test Loss: 1.707 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.055730104446411
Epoch: 7, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.618 Vali Acc: 0.247 Test Loss: 1.618 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7766849994659424
Epoch: 8, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.528 Vali Acc: 0.232 Test Loss: 1.528 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6765687465667725
Epoch: 9, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.650 Vali Acc: 0.266 Test Loss: 1.650 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5519318580627441
Epoch: 10, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.718 Vali Acc: 0.247 Test Loss: 1.718 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8844404220581055
Epoch: 11, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.288 Vali Acc: 0.247 Test Loss: 2.288 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 23158276
model size : 103.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps135_str135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.846874713897705
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.451 Vali Acc: 0.270 Test Loss: 1.451 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 1.0448815822601318
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.510 Vali Acc: 0.266 Test Loss: 1.510 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.336763620376587
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.480 Vali Acc: 0.293 Test Loss: 1.480 Test Acc: 0.293
Validation loss decreased (-0.269947 --> -0.292761).  Saving model ...
Epoch: 4 cost time: 1.51068115234375
Epoch: 4, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.440 Vali Acc: 0.278 Test Loss: 1.440 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2782511711120605
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4768786430358887
Epoch: 6, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.538 Vali Acc: 0.255 Test Loss: 1.538 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.565138816833496
Epoch: 7, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.599 Vali Acc: 0.251 Test Loss: 1.599 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3327276706695557
Epoch: 8, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.802 Vali Acc: 0.251 Test Loss: 1.802 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3697121143341064
Epoch: 9, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.884 Vali Acc: 0.240 Test Loss: 1.884 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1107540130615234
Epoch: 10, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.651 Vali Acc: 0.270 Test Loss: 1.651 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.218282699584961
Epoch: 11, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.816 Vali Acc: 0.243 Test Loss: 1.816 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.124044418334961
Epoch: 12, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.644 Vali Acc: 0.255 Test Loss: 1.644 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2615268230438232
Epoch: 13, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps135_str135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 23102980
model size : 102.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps146_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.39626145362854
Epoch: 1, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.573 Vali Acc: 0.247 Test Loss: 1.573 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 1.7257192134857178
Epoch: 2, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.524 Vali Acc: 0.255 Test Loss: 1.524 Test Acc: 0.255
Validation loss decreased (-0.247133 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 2.1668307781219482
Epoch: 3, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.427 Vali Acc: 0.255 Test Loss: 1.427 Test Acc: 0.255
Validation loss decreased (-0.254738 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 2.070000410079956
Epoch: 4, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.552 Vali Acc: 0.205 Test Loss: 1.552 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.032668352127075
Epoch: 5, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262342).  Saving model ...
Epoch: 6 cost time: 2.0804169178009033
Epoch: 6, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.542 Vali Acc: 0.270 Test Loss: 1.542 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269947).  Saving model ...
Epoch: 7 cost time: 1.9172320365905762
Epoch: 7, Steps: 17 | Train Loss: 1.214 Vali Loss: 2.013 Vali Acc: 0.251 Test Loss: 2.013 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6659631729125977
Epoch: 8, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.584 Vali Acc: 0.251 Test Loss: 1.584 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7116222381591797
Epoch: 9, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.729 Vali Acc: 0.255 Test Loss: 1.729 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4504399299621582
Epoch: 10, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.737 Vali Acc: 0.255 Test Loss: 1.737 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.256758689880371
Epoch: 11, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.971 Vali Acc: 0.243 Test Loss: 1.971 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.578357458114624
Epoch: 12, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.760 Vali Acc: 0.209 Test Loss: 1.760 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.303168535232544
Epoch: 13, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.163 Vali Acc: 0.217 Test Loss: 2.163 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9341254234313965
Epoch: 14, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.810 Vali Acc: 0.251 Test Loss: 1.810 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1443264484405518
Epoch: 15, Steps: 17 | Train Loss: 1.031 Vali Loss: 2.035 Vali Acc: 0.243 Test Loss: 2.035 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.808497667312622
Epoch: 16, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.444 Vali Acc: 0.247 Test Loss: 2.444 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps146_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 23326468
model size : 103.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps146_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5722692012786865
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.526 Vali Acc: 0.240 Test Loss: 1.526 Test Acc: 0.240
Validation loss decreased (inf --> -0.239528).  Saving model ...
Epoch: 2 cost time: 1.7842347621917725
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.573 Vali Acc: 0.228 Test Loss: 1.573 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8119142055511475
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.512 Vali Acc: 0.251 Test Loss: 1.512 Test Acc: 0.251
Validation loss decreased (-0.239528 --> -0.250935).  Saving model ...
Epoch: 4 cost time: 1.728818416595459
Epoch: 4, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254738).  Saving model ...
Epoch: 5 cost time: 2.081556797027588
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.467 Vali Acc: 0.232 Test Loss: 1.467 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8887653350830078
Epoch: 6, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.509 Vali Acc: 0.262 Test Loss: 1.509 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 2.0792694091796875
Epoch: 7, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.512 Vali Acc: 0.236 Test Loss: 1.512 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0510244369506836
Epoch: 8, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.606 Vali Acc: 0.266 Test Loss: 1.606 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266144).  Saving model ...
Epoch: 9 cost time: 1.818880558013916
Epoch: 9, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.916 Vali Acc: 0.247 Test Loss: 1.916 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.761033535003662
Epoch: 10, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.672 Vali Acc: 0.259 Test Loss: 1.672 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8563785552978516
Epoch: 11, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.822 Vali Acc: 0.236 Test Loss: 1.822 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6228597164154053
Epoch: 12, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.922 Vali Acc: 0.236 Test Loss: 1.922 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8576524257659912
Epoch: 13, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.719 Vali Acc: 0.266 Test Loss: 1.719 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6717205047607422
Epoch: 14, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.258 Vali Acc: 0.251 Test Loss: 2.258 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7790210247039795
Epoch: 15, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.917 Vali Acc: 0.240 Test Loss: 1.917 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7664237022399902
Epoch: 16, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.903 Vali Acc: 0.243 Test Loss: 1.903 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5542407035827637
Epoch: 17, Steps: 17 | Train Loss: 1.043 Vali Loss: 2.105 Vali Acc: 0.259 Test Loss: 2.105 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7165782451629639
Epoch: 18, Steps: 17 | Train Loss: 0.920 Vali Loss: 2.382 Vali Acc: 0.240 Test Loss: 2.382 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps146_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 23225092
model size : 103.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps146_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7169368267059326
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.486 Vali Acc: 0.247 Test Loss: 1.486 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 1.2586705684661865
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.483 Vali Acc: 0.266 Test Loss: 1.483 Test Acc: 0.266
Validation loss decreased (-0.247133 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.361647367477417
Epoch: 3, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.526 Vali Acc: 0.278 Test Loss: 1.526 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 1.1640019416809082
Epoch: 4, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.557 Vali Acc: 0.259 Test Loss: 1.557 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1241304874420166
Epoch: 5, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.695 Vali Acc: 0.262 Test Loss: 1.695 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1397321224212646
Epoch: 6, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.595 Vali Acc: 0.243 Test Loss: 1.595 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2204222679138184
Epoch: 7, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.590 Vali Acc: 0.240 Test Loss: 1.590 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2591304779052734
Epoch: 8, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.509 Vali Acc: 0.221 Test Loss: 1.509 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.203312635421753
Epoch: 9, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.935 Vali Acc: 0.202 Test Loss: 1.935 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2099647521972656
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.910 Vali Acc: 0.236 Test Loss: 1.910 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2030212879180908
Epoch: 11, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.722 Vali Acc: 0.247 Test Loss: 1.722 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2033588886260986
Epoch: 12, Steps: 17 | Train Loss: 1.000 Vali Loss: 2.564 Vali Acc: 0.224 Test Loss: 2.564 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0805027484893799
Epoch: 13, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.683 Vali Acc: 0.217 Test Loss: 1.683 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps146_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 23174404
model size : 103.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps160_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.477327585220337
Epoch: 1, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.567 Vali Acc: 0.262 Test Loss: 1.567 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 1.6640520095825195
Epoch: 2, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9055967330932617
Epoch: 3, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.532 Vali Acc: 0.274 Test Loss: 1.532 Test Acc: 0.274
Validation loss decreased (-0.262342 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 1.715834379196167
Epoch: 4, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.627 Vali Acc: 0.262 Test Loss: 1.627 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.481917142868042
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.547 Vali Acc: 0.281 Test Loss: 1.547 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281353).  Saving model ...
Epoch: 6 cost time: 1.4012231826782227
Epoch: 6, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.650 Vali Acc: 0.236 Test Loss: 1.650 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.862354040145874
Epoch: 7, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.790 Vali Acc: 0.243 Test Loss: 1.790 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.963829517364502
Epoch: 8, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.672 Vali Acc: 0.236 Test Loss: 1.672 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0833871364593506
Epoch: 9, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.739 Vali Acc: 0.251 Test Loss: 1.739 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0643997192382812
Epoch: 10, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.747 Vali Acc: 0.255 Test Loss: 1.747 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1135895252227783
Epoch: 11, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.944 Vali Acc: 0.236 Test Loss: 1.944 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9395556449890137
Epoch: 12, Steps: 17 | Train Loss: 1.027 Vali Loss: 2.019 Vali Acc: 0.243 Test Loss: 2.019 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9429712295532227
Epoch: 13, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.459 Vali Acc: 0.243 Test Loss: 2.459 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9204528331756592
Epoch: 14, Steps: 17 | Train Loss: 1.076 Vali Loss: 2.063 Vali Acc: 0.221 Test Loss: 2.063 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8532299995422363
Epoch: 15, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.460 Vali Acc: 0.240 Test Loss: 2.460 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps160_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 23404804
model size : 103.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps160_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.821552038192749
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.459 Vali Acc: 0.259 Test Loss: 1.459 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.3768868446350098
Epoch: 2, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.452 Vali Acc: 0.270 Test Loss: 1.452 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 1.4217329025268555
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.580 Vali Acc: 0.240 Test Loss: 1.580 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3727703094482422
Epoch: 4, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.541 Vali Acc: 0.236 Test Loss: 1.541 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5672106742858887
Epoch: 5, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.797 Vali Acc: 0.217 Test Loss: 1.797 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.600970983505249
Epoch: 6, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.655 Vali Acc: 0.259 Test Loss: 1.655 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4769067764282227
Epoch: 7, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.694 Vali Acc: 0.259 Test Loss: 1.694 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6597023010253906
Epoch: 8, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.961 Vali Acc: 0.259 Test Loss: 1.961 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5355312824249268
Epoch: 9, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.841 Vali Acc: 0.240 Test Loss: 1.841 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6283659934997559
Epoch: 10, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.594 Vali Acc: 0.240 Test Loss: 1.594 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7053000926971436
Epoch: 11, Steps: 17 | Train Loss: 1.068 Vali Loss: 2.202 Vali Acc: 0.243 Test Loss: 2.202 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6610147953033447
Epoch: 12, Steps: 17 | Train Loss: 1.031 Vali Loss: 2.010 Vali Acc: 0.262 Test Loss: 2.010 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps160_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 23312644
model size : 103.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps160_str160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.267482280731201
Epoch: 1, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.421 Vali Acc: 0.236 Test Loss: 1.421 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 1.2990458011627197
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.498 Vali Acc: 0.274 Test Loss: 1.498 Test Acc: 0.274
Validation loss decreased (-0.235727 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 0.9943833351135254
Epoch: 3, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.086608648300171
Epoch: 4, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.479 Vali Acc: 0.221 Test Loss: 1.479 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0415189266204834
Epoch: 5, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.789 Vali Acc: 0.262 Test Loss: 1.789 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2298011779785156
Epoch: 6, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.494 Vali Acc: 0.217 Test Loss: 1.494 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0915250778198242
Epoch: 7, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.604 Vali Acc: 0.255 Test Loss: 1.604 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1969010829925537
Epoch: 8, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.680 Vali Acc: 0.221 Test Loss: 1.680 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2805414199829102
Epoch: 9, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.705 Vali Acc: 0.266 Test Loss: 1.705 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1856050491333008
Epoch: 10, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.660 Vali Acc: 0.232 Test Loss: 1.660 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3430519104003906
Epoch: 11, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.094 Vali Acc: 0.255 Test Loss: 2.094 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2526893615722656
Epoch: 12, Steps: 17 | Train Loss: 1.070 Vali Loss: 2.068 Vali Acc: 0.255 Test Loss: 2.068 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps160_str160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 23266564
model size : 103.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps176_str44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5300631523132324
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.676 Vali Acc: 0.247 Test Loss: 1.676 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 1.992795705795288
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.482 Vali Acc: 0.308 Test Loss: 1.482 Test Acc: 0.308
Validation loss decreased (-0.247132 --> -0.307970).  Saving model ...
Epoch: 3 cost time: 1.975041389465332
Epoch: 3, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.449 Vali Acc: 0.240 Test Loss: 1.449 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9637465476989746
Epoch: 4, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.761 Vali Acc: 0.247 Test Loss: 1.761 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3125274181365967
Epoch: 5, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.856 Vali Acc: 0.240 Test Loss: 1.856 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.810924768447876
Epoch: 6, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.575 Vali Acc: 0.262 Test Loss: 1.575 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6119420528411865
Epoch: 7, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.710 Vali Acc: 0.259 Test Loss: 1.710 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.051800012588501
Epoch: 8, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.844 Vali Acc: 0.240 Test Loss: 1.844 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0516140460968018
Epoch: 9, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.537 Vali Acc: 0.262 Test Loss: 1.537 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1712381839752197
Epoch: 10, Steps: 17 | Train Loss: 1.141 Vali Loss: 2.140 Vali Acc: 0.255 Test Loss: 2.140 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0639355182647705
Epoch: 11, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.806 Vali Acc: 0.236 Test Loss: 1.806 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0310275554656982
Epoch: 12, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.858 Vali Acc: 0.224 Test Loss: 1.858 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps176_str44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 23496964
model size : 104.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps176_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.343942165374756
Epoch: 1, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.463 Vali Acc: 0.251 Test Loss: 1.463 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.2422254085540771
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.407 Vali Acc: 0.262 Test Loss: 1.407 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 1.432767629623413
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.559 Vali Acc: 0.236 Test Loss: 1.559 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6252434253692627
Epoch: 4, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.694 Vali Acc: 0.274 Test Loss: 1.694 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273747).  Saving model ...
Epoch: 5 cost time: 1.4758987426757812
Epoch: 5, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.502 Vali Acc: 0.270 Test Loss: 1.502 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6087775230407715
Epoch: 6, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.480 Vali Acc: 0.251 Test Loss: 1.480 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4000811576843262
Epoch: 7, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.504 Vali Acc: 0.247 Test Loss: 1.504 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5688793659210205
Epoch: 8, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.795 Vali Acc: 0.255 Test Loss: 1.795 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.460268259048462
Epoch: 9, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.682 Vali Acc: 0.243 Test Loss: 1.682 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.610687255859375
Epoch: 10, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.741 Vali Acc: 0.259 Test Loss: 1.741 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2005295753479004
Epoch: 11, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.843 Vali Acc: 0.262 Test Loss: 1.843 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3360316753387451
Epoch: 12, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.910 Vali Acc: 0.255 Test Loss: 1.910 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.320202350616455
Epoch: 13, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.801 Vali Acc: 0.232 Test Loss: 1.801 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3983545303344727
Epoch: 14, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.884 Vali Acc: 0.228 Test Loss: 1.884 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps176_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 23414020
model size : 103.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps176_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4008848667144775
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.441 Vali Acc: 0.251 Test Loss: 1.441 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.068458080291748
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.422 Vali Acc: 0.285 Test Loss: 1.422 Test Acc: 0.285
Validation loss decreased (-0.250936 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 1.2826049327850342
Epoch: 3, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.457 Vali Acc: 0.251 Test Loss: 1.457 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3004910945892334
Epoch: 4, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.457 Vali Acc: 0.266 Test Loss: 1.457 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.172990083694458
Epoch: 5, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.663 Vali Acc: 0.266 Test Loss: 1.663 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1922175884246826
Epoch: 6, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.612 Vali Acc: 0.243 Test Loss: 1.612 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3763279914855957
Epoch: 7, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.575 Vali Acc: 0.251 Test Loss: 1.575 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.235593557357788
Epoch: 8, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.701 Vali Acc: 0.232 Test Loss: 1.701 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1464903354644775
Epoch: 9, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.802 Vali Acc: 0.262 Test Loss: 1.802 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1104185581207275
Epoch: 10, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.586 Vali Acc: 0.240 Test Loss: 1.586 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.629399299621582
Epoch: 11, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.964 Vali Acc: 0.255 Test Loss: 1.964 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3349876403808594
Epoch: 12, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.945 Vali Acc: 0.240 Test Loss: 1.945 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps176_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 23372548
model size : 103.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps195_str49_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6506264209747314
Epoch: 1, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.444 Vali Acc: 0.289 Test Loss: 1.444 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 1.6244359016418457
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.486 Vali Acc: 0.270 Test Loss: 1.486 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.496565580368042
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6457812786102295
Epoch: 4, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.527 Vali Acc: 0.251 Test Loss: 1.527 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.655456781387329
Epoch: 5, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.500 Vali Acc: 0.221 Test Loss: 1.500 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.749251127243042
Epoch: 6, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.523 Vali Acc: 0.243 Test Loss: 1.523 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7876949310302734
Epoch: 7, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.569 Vali Acc: 0.274 Test Loss: 1.569 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5680482387542725
Epoch: 8, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.713 Vali Acc: 0.251 Test Loss: 1.713 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7403898239135742
Epoch: 9, Steps: 17 | Train Loss: 1.116 Vali Loss: 2.080 Vali Acc: 0.259 Test Loss: 2.080 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.691931962966919
Epoch: 10, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.752 Vali Acc: 0.221 Test Loss: 1.752 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7552170753479004
Epoch: 11, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.764 Vali Acc: 0.262 Test Loss: 1.764 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps195_str49_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 23609860
model size : 104.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps195_str98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6916539669036865
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.448 Vali Acc: 0.228 Test Loss: 1.448 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 1.8683762550354004
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.483 Vali Acc: 0.255 Test Loss: 1.483 Test Acc: 0.255
Validation loss decreased (-0.228122 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 1.7335636615753174
Epoch: 3, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.440 Vali Acc: 0.251 Test Loss: 1.440 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5167078971862793
Epoch: 4, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.453 Vali Acc: 0.266 Test Loss: 1.453 Test Acc: 0.266
Validation loss decreased (-0.254738 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 1.923748254776001
Epoch: 5, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.500 Vali Acc: 0.262 Test Loss: 1.500 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5108776092529297
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.488 Vali Acc: 0.247 Test Loss: 1.488 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.551252841949463
Epoch: 7, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.563 Vali Acc: 0.259 Test Loss: 1.563 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5437169075012207
Epoch: 8, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.517 Vali Acc: 0.262 Test Loss: 1.517 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3466806411743164
Epoch: 9, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.669 Vali Acc: 0.236 Test Loss: 1.669 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.349219799041748
Epoch: 10, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.573 Vali Acc: 0.236 Test Loss: 1.573 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.186034917831421
Epoch: 11, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.600 Vali Acc: 0.251 Test Loss: 1.600 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2882256507873535
Epoch: 12, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.768 Vali Acc: 0.266 Test Loss: 1.768 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2723941802978516
Epoch: 13, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.762 Vali Acc: 0.228 Test Loss: 1.762 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4785852432250977
Epoch: 14, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.953 Vali Acc: 0.240 Test Loss: 1.953 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps195_str98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 23536132
model size : 104.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps195_str195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0810787677764893
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.1383228302001953
Epoch: 2, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.466 Vali Acc: 0.232 Test Loss: 1.466 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0427510738372803
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.436 Vali Acc: 0.217 Test Loss: 1.436 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1402339935302734
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.497 Vali Acc: 0.232 Test Loss: 1.497 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1629984378814697
Epoch: 5, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.514 Vali Acc: 0.259 Test Loss: 1.514 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1645874977111816
Epoch: 6, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.510 Vali Acc: 0.259 Test Loss: 1.510 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1477925777435303
Epoch: 7, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.480 Vali Acc: 0.259 Test Loss: 1.480 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1458756923675537
Epoch: 8, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.713 Vali Acc: 0.247 Test Loss: 1.713 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0262730121612549
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.761 Vali Acc: 0.251 Test Loss: 1.761 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0849602222442627
Epoch: 10, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.586 Vali Acc: 0.251 Test Loss: 1.586 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0182604789733887
Epoch: 11, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.737 Vali Acc: 0.262 Test Loss: 1.737 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps195_str195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 23499268
model size : 104.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps219_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.464301347732544
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.429 Vali Acc: 0.224 Test Loss: 1.429 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 1.502739667892456
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.495 Vali Acc: 0.251 Test Loss: 1.495 Test Acc: 0.251
Validation loss decreased (-0.224320 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 1.0641582012176514
Epoch: 3, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.582 Vali Acc: 0.251 Test Loss: 1.582 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.478785753250122
Epoch: 4, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.644 Vali Acc: 0.285 Test Loss: 1.644 Test Acc: 0.285
Validation loss decreased (-0.250936 --> -0.285155).  Saving model ...
Epoch: 5 cost time: 1.5041680335998535
Epoch: 5, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.765 Vali Acc: 0.221 Test Loss: 1.765 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.579697608947754
Epoch: 6, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.830 Vali Acc: 0.251 Test Loss: 1.830 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.686547040939331
Epoch: 7, Steps: 17 | Train Loss: 1.183 Vali Loss: 2.077 Vali Acc: 0.255 Test Loss: 2.077 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.821699619293213
Epoch: 8, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.701 Vali Acc: 0.236 Test Loss: 1.701 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7145051956176758
Epoch: 9, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.664 Vali Acc: 0.251 Test Loss: 1.664 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8100149631500244
Epoch: 10, Steps: 17 | Train Loss: 1.070 Vali Loss: 2.084 Vali Acc: 0.251 Test Loss: 2.084 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.056826114654541
Epoch: 11, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.850 Vali Acc: 0.232 Test Loss: 1.850 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.141308546066284
Epoch: 12, Steps: 17 | Train Loss: 1.110 Vali Loss: 2.823 Vali Acc: 0.259 Test Loss: 2.823 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2583601474761963
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.001 Vali Acc: 0.266 Test Loss: 2.001 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.27091383934021
Epoch: 14, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.926 Vali Acc: 0.255 Test Loss: 1.926 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps219_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 23757316
model size : 105.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps219_str110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.9928011894226074
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.2310636043548584
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.503 Vali Acc: 0.266 Test Loss: 1.503 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.2732212543487549
Epoch: 3, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.420 Vali Acc: 0.251 Test Loss: 1.420 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4146127700805664
Epoch: 4, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.474 Vali Acc: 0.243 Test Loss: 1.474 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5747950077056885
Epoch: 5, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.491 Vali Acc: 0.274 Test Loss: 1.491 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 6 cost time: 0.9818298816680908
Epoch: 6, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.566 Vali Acc: 0.274 Test Loss: 1.566 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1822054386138916
Epoch: 7, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.647 Vali Acc: 0.281 Test Loss: 1.647 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281352).  Saving model ...
Epoch: 8 cost time: 1.0036020278930664
Epoch: 8, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.530 Vali Acc: 0.255 Test Loss: 1.530 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5450401306152344
Epoch: 9, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.642 Vali Acc: 0.228 Test Loss: 1.642 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.163099765777588
Epoch: 10, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.816 Vali Acc: 0.251 Test Loss: 1.816 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3872928619384766
Epoch: 11, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.258 Vali Acc: 0.259 Test Loss: 2.258 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.349102258682251
Epoch: 12, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.726 Vali Acc: 0.205 Test Loss: 1.726 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.264925241470337
Epoch: 13, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.839 Vali Acc: 0.232 Test Loss: 1.839 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2205157279968262
Epoch: 14, Steps: 17 | Train Loss: 0.935 Vali Loss: 1.832 Vali Acc: 0.236 Test Loss: 1.832 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0010764598846436
Epoch: 15, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.759 Vali Acc: 0.255 Test Loss: 1.759 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4137849807739258
Epoch: 16, Steps: 17 | Train Loss: 0.936 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.111091136932373
Epoch: 17, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.266 Vali Acc: 0.266 Test Loss: 2.266 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps219_str110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 23692804
model size : 105.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps219_str219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.080566883087158
Epoch: 1, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.431 Vali Acc: 0.293 Test Loss: 1.431 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 1.1342740058898926
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.096402883529663
Epoch: 3, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.437 Vali Acc: 0.262 Test Loss: 1.437 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.353959560394287
Epoch: 4, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.467 Vali Acc: 0.262 Test Loss: 1.467 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3107295036315918
Epoch: 5, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.674 Vali Acc: 0.240 Test Loss: 1.674 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1997222900390625
Epoch: 6, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.512 Vali Acc: 0.232 Test Loss: 1.512 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3300235271453857
Epoch: 7, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.621 Vali Acc: 0.243 Test Loss: 1.621 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.074751853942871
Epoch: 8, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.728 Vali Acc: 0.247 Test Loss: 1.728 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0931074619293213
Epoch: 9, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.792 Vali Acc: 0.259 Test Loss: 1.792 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0916481018066406
Epoch: 10, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.809 Vali Acc: 0.232 Test Loss: 1.809 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.126610279083252
Epoch: 11, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.726 Vali Acc: 0.262 Test Loss: 1.726 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps219_str219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 23660548
model size : 104.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps251_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.818096160888672
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.435 Vali Acc: 0.281 Test Loss: 1.435 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 1.4594523906707764
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.460 Vali Acc: 0.236 Test Loss: 1.460 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.698249340057373
Epoch: 3, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.556 Vali Acc: 0.262 Test Loss: 1.556 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5822327136993408
Epoch: 4, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.494 Vali Acc: 0.243 Test Loss: 1.494 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9920198917388916
Epoch: 5, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.485 Vali Acc: 0.251 Test Loss: 1.485 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.307607889175415
Epoch: 6, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.574 Vali Acc: 0.240 Test Loss: 1.574 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3760042190551758
Epoch: 7, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.468 Vali Acc: 0.259 Test Loss: 1.468 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3780806064605713
Epoch: 8, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.852 Vali Acc: 0.285 Test Loss: 1.852 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285153).  Saving model ...
Epoch: 9 cost time: 1.3476629257202148
Epoch: 9, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.745 Vali Acc: 0.243 Test Loss: 1.745 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9487266540527344
Epoch: 10, Steps: 17 | Train Loss: 1.092 Vali Loss: 2.118 Vali Acc: 0.247 Test Loss: 2.118 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9716377258300781
Epoch: 11, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.733 Vali Acc: 0.236 Test Loss: 1.733 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9122869968414307
Epoch: 12, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.783 Vali Acc: 0.281 Test Loss: 1.783 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9979405403137207
Epoch: 13, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.948 Vali Acc: 0.232 Test Loss: 1.948 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6626040935516357
Epoch: 14, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.072 Vali Acc: 0.266 Test Loss: 2.072 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6398532390594482
Epoch: 15, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.858 Vali Acc: 0.251 Test Loss: 1.858 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6097743511199951
Epoch: 16, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.812 Vali Acc: 0.228 Test Loss: 1.812 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6867480278015137
Epoch: 17, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.847 Vali Acc: 0.251 Test Loss: 1.847 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.594757318496704
Epoch: 18, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.256 Vali Acc: 0.240 Test Loss: 2.256 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps251_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 23960068
model size : 106.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps251_str126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.225276470184326
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.492 Vali Acc: 0.243 Test Loss: 1.492 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.4184601306915283
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.451 Vali Acc: 0.274 Test Loss: 1.451 Test Acc: 0.274
Validation loss decreased (-0.243331 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.250157117843628
Epoch: 3, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.453 Vali Acc: 0.281 Test Loss: 1.453 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.4809603691101074
Epoch: 4, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.576 Vali Acc: 0.266 Test Loss: 1.576 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2172882556915283
Epoch: 5, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.839 Vali Acc: 0.224 Test Loss: 1.839 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.487272024154663
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.594 Vali Acc: 0.259 Test Loss: 1.594 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2202355861663818
Epoch: 7, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.788 Vali Acc: 0.259 Test Loss: 1.788 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1949172019958496
Epoch: 8, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.616 Vali Acc: 0.236 Test Loss: 1.616 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.025681972503662
Epoch: 9, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.790 Vali Acc: 0.251 Test Loss: 1.790 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1434202194213867
Epoch: 10, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.594 Vali Acc: 0.236 Test Loss: 1.594 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2221691608428955
Epoch: 11, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.784 Vali Acc: 0.228 Test Loss: 1.784 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5179080963134766
Epoch: 12, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.843 Vali Acc: 0.289 Test Loss: 1.843 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288955).  Saving model ...
Epoch: 13 cost time: 1.316695213317871
Epoch: 13, Steps: 17 | Train Loss: 0.953 Vali Loss: 2.108 Vali Acc: 0.228 Test Loss: 2.108 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2670948505401611
Epoch: 14, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.718 Vali Acc: 0.274 Test Loss: 1.718 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0329644680023193
Epoch: 15, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.099 Vali Acc: 0.247 Test Loss: 2.099 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2148644924163818
Epoch: 16, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.015 Vali Acc: 0.259 Test Loss: 2.015 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.164616346359253
Epoch: 17, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.829 Vali Acc: 0.262 Test Loss: 1.829 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0564484596252441
Epoch: 18, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.355 Vali Acc: 0.281 Test Loss: 2.355 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.28641676902771
Epoch: 19, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.005 Vali Acc: 0.240 Test Loss: 2.005 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3019638061523438
Epoch: 20, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.210 Vali Acc: 0.243 Test Loss: 2.210 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2554523944854736
Epoch: 21, Steps: 17 | Train Loss: 0.829 Vali Loss: 2.160 Vali Acc: 0.266 Test Loss: 2.160 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.274592638015747
Epoch: 22, Steps: 17 | Train Loss: 0.765 Vali Loss: 2.938 Vali Acc: 0.236 Test Loss: 2.938 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps251_str126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 23904772
model size : 105.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps251_str251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3914053440093994
Epoch: 1, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.411 Vali Acc: 0.266 Test Loss: 1.411 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.1555402278900146
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.474 Vali Acc: 0.247 Test Loss: 1.474 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5629088878631592
Epoch: 3, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.540 Vali Acc: 0.259 Test Loss: 1.540 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3107707500457764
Epoch: 4, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.448 Vali Acc: 0.221 Test Loss: 1.448 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0593883991241455
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.643 Vali Acc: 0.243 Test Loss: 1.643 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2361478805541992
Epoch: 6, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.527 Vali Acc: 0.213 Test Loss: 1.527 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6295058727264404
Epoch: 7, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.688 Vali Acc: 0.259 Test Loss: 1.688 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0502936840057373
Epoch: 8, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.679 Vali Acc: 0.300 Test Loss: 1.679 Test Acc: 0.300
Validation loss decreased (-0.266146 --> -0.300363).  Saving model ...
Epoch: 9 cost time: 1.2190909385681152
Epoch: 9, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.650 Vali Acc: 0.251 Test Loss: 1.650 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.274285078048706
Epoch: 10, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.654 Vali Acc: 0.232 Test Loss: 1.654 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1341211795806885
Epoch: 11, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.617 Vali Acc: 0.213 Test Loss: 1.617 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1210527420043945
Epoch: 12, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.627 Vali Acc: 0.224 Test Loss: 1.627 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2691035270690918
Epoch: 13, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.866 Vali Acc: 0.255 Test Loss: 1.866 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4011273384094238
Epoch: 14, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.930 Vali Acc: 0.259 Test Loss: 1.930 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4569621086120605
Epoch: 15, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.829 Vali Acc: 0.221 Test Loss: 1.829 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5463876724243164
Epoch: 16, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.729 Vali Acc: 0.183 Test Loss: 1.729 Test Acc: 0.183
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.195345401763916
Epoch: 17, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.028 Vali Acc: 0.243 Test Loss: 2.028 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2802095413208008
Epoch: 18, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.940 Vali Acc: 0.255 Test Loss: 1.940 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps251_str251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 23877124
model size : 105.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps292_str73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5735645294189453
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.450 Vali Acc: 0.259 Test Loss: 1.450 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.562950611114502
Epoch: 2, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.442 Vali Acc: 0.255 Test Loss: 1.442 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5316245555877686
Epoch: 3, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.473 Vali Acc: 0.262 Test Loss: 1.473 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 1.6188862323760986
Epoch: 4, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.509 Vali Acc: 0.213 Test Loss: 1.509 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1579852104187012
Epoch: 5, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.542 Vali Acc: 0.259 Test Loss: 1.542 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1136813163757324
Epoch: 6, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.102710485458374
Epoch: 7, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.715 Vali Acc: 0.228 Test Loss: 1.715 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0123651027679443
Epoch: 8, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.777 Vali Acc: 0.251 Test Loss: 1.777 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2411439418792725
Epoch: 9, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.773 Vali Acc: 0.243 Test Loss: 1.773 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2886812686920166
Epoch: 10, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.851 Vali Acc: 0.262 Test Loss: 1.851 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3243229389190674
Epoch: 11, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.599 Vali Acc: 0.224 Test Loss: 1.599 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.403839349746704
Epoch: 12, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.099 Vali Acc: 0.255 Test Loss: 2.099 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9884293079376221
Epoch: 13, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.428 Vali Acc: 0.240 Test Loss: 2.428 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps292_str73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 24225028
model size : 107.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps292_str146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.775066614151001
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.1519103050231934
Epoch: 2, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.404 Vali Acc: 0.278 Test Loss: 1.404 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277553).  Saving model ...
Epoch: 3 cost time: 1.0531463623046875
Epoch: 3, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.492 Vali Acc: 0.247 Test Loss: 1.492 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1831741333007812
Epoch: 4, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.452 Vali Acc: 0.240 Test Loss: 1.452 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9641876220703125
Epoch: 5, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.667 Vali Acc: 0.247 Test Loss: 1.667 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.610206127166748
Epoch: 6, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.621 Vali Acc: 0.236 Test Loss: 1.621 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0471200942993164
Epoch: 7, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.921 Vali Acc: 0.205 Test Loss: 1.921 Test Acc: 0.205
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0571916103363037
Epoch: 8, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.837 Vali Acc: 0.228 Test Loss: 1.837 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.053560495376587
Epoch: 9, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.604 Vali Acc: 0.240 Test Loss: 1.604 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2234680652618408
Epoch: 10, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.765 Vali Acc: 0.213 Test Loss: 1.765 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3307404518127441
Epoch: 11, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.617 Vali Acc: 0.240 Test Loss: 1.617 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1465167999267578
Epoch: 12, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.934 Vali Acc: 0.251 Test Loss: 1.934 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps292_str146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 24178948
model size : 106.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps292_str292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8978607654571533
Epoch: 1, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.489 Vali Acc: 0.232 Test Loss: 1.489 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 1.2321817874908447
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.437 Vali Acc: 0.232 Test Loss: 1.437 Test Acc: 0.232
Validation loss decreased (-0.231924 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 1.318211555480957
Epoch: 3, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
Validation loss decreased (-0.231925 --> -0.243332).  Saving model ...
Epoch: 4 cost time: 1.2405896186828613
Epoch: 4, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.576 Vali Acc: 0.240 Test Loss: 1.576 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1262457370758057
Epoch: 5, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.466 Vali Acc: 0.278 Test Loss: 1.466 Test Acc: 0.278
Validation loss decreased (-0.243332 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 1.118901014328003
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.644 Vali Acc: 0.243 Test Loss: 1.644 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1769213676452637
Epoch: 7, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.531 Vali Acc: 0.240 Test Loss: 1.531 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.15626859664917
Epoch: 8, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.600 Vali Acc: 0.240 Test Loss: 1.600 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2550523281097412
Epoch: 9, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.742 Vali Acc: 0.262 Test Loss: 1.742 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2079310417175293
Epoch: 10, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.746 Vali Acc: 0.221 Test Loss: 1.746 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4999659061431885
Epoch: 11, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.779 Vali Acc: 0.247 Test Loss: 1.779 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3195281028747559
Epoch: 12, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.826 Vali Acc: 0.259 Test Loss: 1.826 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1793954372406006
Epoch: 13, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.818 Vali Acc: 0.236 Test Loss: 1.818 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0699348449707031
Epoch: 14, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.696 Vali Acc: 0.236 Test Loss: 1.696 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1587848663330078
Epoch: 15, Steps: 17 | Train Loss: 0.929 Vali Loss: 2.301 Vali Acc: 0.236 Test Loss: 2.301 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps292_str292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 24155908
model size : 106.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps351_str88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2618658542633057
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.430 Vali Acc: 0.278 Test Loss: 1.430 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.1607015132904053
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.443 Vali Acc: 0.278 Test Loss: 1.443 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.135399341583252
Epoch: 3, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.551 Vali Acc: 0.236 Test Loss: 1.551 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4004442691802979
Epoch: 4, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.455 Vali Acc: 0.266 Test Loss: 1.455 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3493108749389648
Epoch: 5, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.480 Vali Acc: 0.255 Test Loss: 1.480 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2025086879730225
Epoch: 6, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.475 Vali Acc: 0.266 Test Loss: 1.475 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.250765323638916
Epoch: 7, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.508 Vali Acc: 0.251 Test Loss: 1.508 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4151010513305664
Epoch: 8, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.739 Vali Acc: 0.270 Test Loss: 1.739 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3151826858520508
Epoch: 9, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.601 Vali Acc: 0.270 Test Loss: 1.601 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.456568717956543
Epoch: 10, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.706 Vali Acc: 0.240 Test Loss: 1.706 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4018030166625977
Epoch: 11, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.795 Vali Acc: 0.221 Test Loss: 1.795 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps351_str88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 24614404
model size : 108.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps351_str176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4101767539978027
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.433 Vali Acc: 0.240 Test Loss: 1.433 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.1941823959350586
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.421 Vali Acc: 0.274 Test Loss: 1.421 Test Acc: 0.274
Validation loss decreased (-0.239529 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.2041571140289307
Epoch: 3, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.472 Vali Acc: 0.243 Test Loss: 1.472 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3089241981506348
Epoch: 4, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.504 Vali Acc: 0.243 Test Loss: 1.504 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1134536266326904
Epoch: 5, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.460 Vali Acc: 0.236 Test Loss: 1.460 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2979624271392822
Epoch: 6, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.668 Vali Acc: 0.243 Test Loss: 1.668 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0311355590820312
Epoch: 7, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.534 Vali Acc: 0.224 Test Loss: 1.534 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.187060832977295
Epoch: 8, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.619 Vali Acc: 0.236 Test Loss: 1.619 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2115371227264404
Epoch: 9, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.546 Vali Acc: 0.243 Test Loss: 1.546 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4147286415100098
Epoch: 10, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.801 Vali Acc: 0.255 Test Loss: 1.801 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5945014953613281
Epoch: 11, Steps: 17 | Train Loss: 1.056 Vali Loss: 2.171 Vali Acc: 0.262 Test Loss: 2.171 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4070301055908203
Epoch: 12, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.933 Vali Acc: 0.259 Test Loss: 1.933 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps351_str176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 24577540
model size : 108.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps351_str351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5947377681732178
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.413 Vali Acc: 0.243 Test Loss: 1.413 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 1.2728750705718994
Epoch: 2, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.467 Vali Acc: 0.247 Test Loss: 1.467 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 1.3374347686767578
Epoch: 3, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.506 Vali Acc: 0.255 Test Loss: 1.506 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 1.2452199459075928
Epoch: 4, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.458 Vali Acc: 0.274 Test Loss: 1.458 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 1.1928741931915283
Epoch: 5, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.451 Vali Acc: 0.255 Test Loss: 1.451 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3236932754516602
Epoch: 6, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.611 Vali Acc: 0.240 Test Loss: 1.611 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3473916053771973
Epoch: 7, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.523 Vali Acc: 0.247 Test Loss: 1.523 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3358089923858643
Epoch: 8, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.568 Vali Acc: 0.274 Test Loss: 1.568 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.28118896484375
Epoch: 9, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.544 Vali Acc: 0.228 Test Loss: 1.544 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4801993370056152
Epoch: 10, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.685 Vali Acc: 0.228 Test Loss: 1.685 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2289490699768066
Epoch: 11, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.603 Vali Acc: 0.232 Test Loss: 1.603 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1511363983154297
Epoch: 12, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.683 Vali Acc: 0.243 Test Loss: 1.683 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4445157051086426
Epoch: 13, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.721 Vali Acc: 0.278 Test Loss: 1.721 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277549).  Saving model ...
Epoch: 14 cost time: 1.318922758102417
Epoch: 14, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.931 Vali Acc: 0.236 Test Loss: 1.931 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1541368961334229
Epoch: 15, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.660 Vali Acc: 0.209 Test Loss: 1.660 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2321555614471436
Epoch: 16, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.708 Vali Acc: 0.243 Test Loss: 1.708 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.506721019744873
Epoch: 17, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.059 Vali Acc: 0.247 Test Loss: 2.059 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.172389030456543
Epoch: 18, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.025 Vali Acc: 0.247 Test Loss: 2.025 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0647761821746826
Epoch: 19, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.946 Vali Acc: 0.232 Test Loss: 1.946 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.442516803741455
Epoch: 20, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.135 Vali Acc: 0.240 Test Loss: 2.135 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4077928066253662
Epoch: 21, Steps: 17 | Train Loss: 0.837 Vali Loss: 1.910 Vali Acc: 0.228 Test Loss: 1.910 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4298195838928223
Epoch: 22, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.938 Vali Acc: 0.236 Test Loss: 1.938 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.256540060043335
Epoch: 23, Steps: 17 | Train Loss: 0.920 Vali Loss: 2.183 Vali Acc: 0.236 Test Loss: 2.183 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_GPT4TS_UEA_ftM_sl1751_ll0_pl0_el3_dm768_df768_ps351_str351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 24559108
model size : 108.35MB
