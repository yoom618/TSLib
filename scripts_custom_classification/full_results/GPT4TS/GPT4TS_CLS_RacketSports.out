Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0724449157714844
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.7943060398101807
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.191 Vali Acc: 0.579 Test Loss: 1.191 Test Acc: 0.579
Validation loss decreased (-0.374987 --> -0.578935).  Saving model ...
Epoch: 3 cost time: 1.2992067337036133
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.044 Vali Acc: 0.599 Test Loss: 1.044 Test Acc: 0.599
Validation loss decreased (-0.578935 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 1.3863630294799805
Epoch: 4, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.867 Vali Acc: 0.737 Test Loss: 0.867 Test Acc: 0.737
Validation loss decreased (-0.598674 --> -0.736833).  Saving model ...
Epoch: 5 cost time: 1.3224716186523438
Epoch: 5, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.4988269805908203
Epoch: 6, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.177490472793579
Epoch: 7, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
Validation loss decreased (-0.756573 --> -0.802626).  Saving model ...
Epoch: 8 cost time: 0.9317569732666016
Epoch: 8, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822363).  Saving model ...
Epoch: 9 cost time: 1.5468120574951172
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.691 Vali Acc: 0.796 Test Loss: 0.691 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.347590684890747
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6768436431884766
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.725 Vali Acc: 0.836 Test Loss: 0.725 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835519).  Saving model ...
Epoch: 12 cost time: 1.3626880645751953
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.782 Vali Acc: 0.829 Test Loss: 0.782 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.580784797668457
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.815 Vali Acc: 0.803 Test Loss: 0.815 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.297149658203125
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.921 Vali Acc: 0.816 Test Loss: 0.921 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3206374645233154
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.880 Vali Acc: 0.836 Test Loss: 0.880 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2824196815490723
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.917 Vali Acc: 0.836 Test Loss: 0.917 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2990531921386719
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.895 Vali Acc: 0.836 Test Loss: 0.895 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.484381914138794
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.904 Vali Acc: 0.822 Test Loss: 0.904 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.247183084487915
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.966 Vali Acc: 0.829 Test Loss: 0.966 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.408357858657837
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.914 Vali Acc: 0.816 Test Loss: 0.914 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4219870567321777
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.822 Test Loss: 0.934 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 43539460
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.469883441925049
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.403 Vali Acc: 0.296 Test Loss: 1.403 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.1407771110534668
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.337 Vali Acc: 0.309 Test Loss: 1.337 Test Acc: 0.309
Validation loss decreased (-0.296039 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.8360545635223389
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.233 Vali Acc: 0.493 Test Loss: 1.233 Test Acc: 0.493
Validation loss decreased (-0.309197 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.1762216091156006
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.119 Vali Acc: 0.566 Test Loss: 1.119 Test Acc: 0.566
Validation loss decreased (-0.493409 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 0.9982376098632812
Epoch: 5, Steps: 10 | Train Loss: 1.021 Vali Loss: 0.968 Vali Acc: 0.612 Test Loss: 0.968 Test Acc: 0.612
Validation loss decreased (-0.565778 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.016570806503296
Epoch: 6, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.797 Vali Acc: 0.704 Test Loss: 0.797 Test Acc: 0.704
Validation loss decreased (-0.611832 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 0.9260354042053223
Epoch: 7, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
Validation loss decreased (-0.703939 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.957550048828125
Epoch: 8, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769732).  Saving model ...
Epoch: 9 cost time: 0.9146068096160889
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
Validation loss decreased (-0.769732 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 0.7527780532836914
Epoch: 10, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8956520557403564
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8152673244476318
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
Validation loss decreased (-0.809205 --> -0.855258).  Saving model ...
Epoch: 13 cost time: 0.8768801689147949
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8709425926208496
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9143204689025879
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.570 Vali Acc: 0.868 Test Loss: 0.570 Test Acc: 0.868
Validation loss decreased (-0.855258 --> -0.868415).  Saving model ...
Epoch: 16 cost time: 0.9293842315673828
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.572 Vali Acc: 0.829 Test Loss: 0.572 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8963446617126465
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.561 Vali Acc: 0.849 Test Loss: 0.561 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9671530723571777
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.607 Vali Acc: 0.842 Test Loss: 0.607 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9126310348510742
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.842 Test Loss: 0.615 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8299362659454346
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.617 Vali Acc: 0.842 Test Loss: 0.617 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9315299987792969
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.855 Test Loss: 0.618 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0513813495635986
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.855 Test Loss: 0.688 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.042456865310669
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.646 Vali Acc: 0.842 Test Loss: 0.646 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.093008041381836
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.836 Test Loss: 0.662 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0968401432037354
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.842 Test Loss: 0.676 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 43474948
model size : 180.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4262139797210693
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.427 Vali Acc: 0.283 Test Loss: 1.427 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.8277933597564697
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
Validation loss decreased (-0.282880 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.5375638008117676
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.078 Vali Acc: 0.632 Test Loss: 1.078 Test Acc: 0.632
Validation loss decreased (-0.499987 --> -0.631568).  Saving model ...
Epoch: 4 cost time: 1.7314050197601318
Epoch: 4, Steps: 10 | Train Loss: 0.949 Vali Loss: 0.910 Vali Acc: 0.691 Test Loss: 0.910 Test Acc: 0.691
Validation loss decreased (-0.631568 --> -0.690780).  Saving model ...
Epoch: 5 cost time: 1.896974802017212
Epoch: 5, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.713 Vali Acc: 0.763 Test Loss: 0.713 Test Acc: 0.763
Validation loss decreased (-0.690780 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 1.4595732688903809
Epoch: 6, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 1.7218518257141113
Epoch: 7, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.57731032371521
Epoch: 8, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 9 cost time: 1.4881200790405273
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.744 Vali Acc: 0.816 Test Loss: 0.744 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815782).  Saving model ...
Epoch: 10 cost time: 1.5798344612121582
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.644 Vali Acc: 0.803 Test Loss: 0.644 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5516924858093262
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4497547149658203
Epoch: 12, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.904 Vali Acc: 0.816 Test Loss: 0.904 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7047455310821533
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.820 Vali Acc: 0.776 Test Loss: 0.820 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7568466663360596
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.825 Vali Acc: 0.783 Test Loss: 0.825 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9130501747131348
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.948 Vali Acc: 0.803 Test Loss: 0.948 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3526794910430908
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.892 Vali Acc: 0.776 Test Loss: 0.892 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7971656322479248
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.979 Vali Acc: 0.803 Test Loss: 0.979 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.622929334640503
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.927 Vali Acc: 0.783 Test Loss: 0.927 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.842853307723999
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.021 Vali Acc: 0.803 Test Loss: 1.021 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 43548676
model size : 180.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.849627733230591
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.371 Vali Acc: 0.316 Test Loss: 1.371 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.0610764026641846
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.268 Vali Acc: 0.493 Test Loss: 1.268 Test Acc: 0.493
Validation loss decreased (-0.315776 --> -0.493408).  Saving model ...
Epoch: 3 cost time: 1.2908167839050293
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.157 Vali Acc: 0.658 Test Loss: 1.157 Test Acc: 0.658
Validation loss decreased (-0.493408 --> -0.657883).  Saving model ...
Epoch: 4 cost time: 1.3224692344665527
Epoch: 4, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.032 Vali Acc: 0.671 Test Loss: 1.032 Test Acc: 0.671
Validation loss decreased (-0.657883 --> -0.671042).  Saving model ...
Epoch: 5 cost time: 1.2133586406707764
Epoch: 5, Steps: 10 | Train Loss: 0.926 Vali Loss: 0.880 Vali Acc: 0.697 Test Loss: 0.880 Test Acc: 0.697
Validation loss decreased (-0.671042 --> -0.697360).  Saving model ...
Epoch: 6 cost time: 0.8442990779876709
Epoch: 6, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
Validation loss decreased (-0.697360 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.2345561981201172
Epoch: 7, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.145900011062622
Epoch: 8, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.2472620010375977
Epoch: 9, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 1.3591201305389404
Epoch: 10, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.1494033336639404
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.643 Vali Acc: 0.816 Test Loss: 0.643 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815783).  Saving model ...
Epoch: 12 cost time: 1.297651767730713
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.536 Vali Acc: 0.829 Test Loss: 0.536 Test Acc: 0.829
Validation loss decreased (-0.815783 --> -0.828942).  Saving model ...
Epoch: 13 cost time: 0.9812192916870117
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.629 Vali Acc: 0.842 Test Loss: 0.629 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842099).  Saving model ...
Epoch: 14 cost time: 1.0566651821136475
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8122241497039795
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.836 Test Loss: 0.665 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2828857898712158
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.147871494293213
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.623 Vali Acc: 0.829 Test Loss: 0.623 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.315077781677246
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.644 Vali Acc: 0.829 Test Loss: 0.644 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1858606338500977
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.717 Vali Acc: 0.829 Test Loss: 0.717 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0541391372680664
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.691 Vali Acc: 0.829 Test Loss: 0.691 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9979455471038818
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.740 Vali Acc: 0.816 Test Loss: 0.740 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8749833106994629
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.712 Vali Acc: 0.829 Test Loss: 0.712 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9683799743652344
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.713 Vali Acc: 0.836 Test Loss: 0.713 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 43484164
model size : 180.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.666829824447632
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.403 Vali Acc: 0.303 Test Loss: 1.403 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.0287365913391113
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.329 Vali Acc: 0.388 Test Loss: 1.329 Test Acc: 0.388
Validation loss decreased (-0.302618 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.0088815689086914
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.388145 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.0746688842773438
Epoch: 4, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.162 Vali Acc: 0.632 Test Loss: 1.162 Test Acc: 0.632
Validation loss decreased (-0.499987 --> -0.631567).  Saving model ...
Epoch: 5 cost time: 1.0393331050872803
Epoch: 5, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.065 Vali Acc: 0.618 Test Loss: 1.065 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0660591125488281
Epoch: 6, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.900 Vali Acc: 0.697 Test Loss: 0.900 Test Acc: 0.697
Validation loss decreased (-0.631567 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 1.052525520324707
Epoch: 7, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.0501470565795898
Epoch: 8, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.580 Vali Acc: 0.730 Test Loss: 0.580 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 0.9188976287841797
Epoch: 9, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763153).  Saving model ...
Epoch: 10 cost time: 0.9816434383392334
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.763153 --> -0.789469).  Saving model ...
Epoch: 11 cost time: 1.0205514430999756
Epoch: 11, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.057286024093628
Epoch: 12, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.286844253540039
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1689882278442383
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.250910758972168
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.640 Vali Acc: 0.822 Test Loss: 0.640 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 16 cost time: 0.9557089805603027
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.642 Vali Acc: 0.829 Test Loss: 0.642 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 17 cost time: 1.1340324878692627
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1556487083435059
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.700 Vali Acc: 0.829 Test Loss: 0.700 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0629961490631104
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.670 Vali Acc: 0.829 Test Loss: 0.670 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2041196823120117
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.682 Vali Acc: 0.842 Test Loss: 0.682 Test Acc: 0.842
Validation loss decreased (-0.828941 --> -0.842098).  Saving model ...
Epoch: 21 cost time: 1.2826581001281738
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.706 Vali Acc: 0.829 Test Loss: 0.706 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.178309679031372
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.711 Vali Acc: 0.836 Test Loss: 0.711 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0876834392547607
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.725 Vali Acc: 0.829 Test Loss: 0.725 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1707289218902588
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.718 Vali Acc: 0.829 Test Loss: 0.718 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9945650100708008
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.818 Vali Acc: 0.822 Test Loss: 0.818 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0046019554138184
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.014051914215088
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.822 Test Loss: 0.789 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0654048919677734
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.782 Vali Acc: 0.829 Test Loss: 0.782 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.220881462097168
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.822 Test Loss: 0.762 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1232845783233643
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.796 Vali Acc: 0.836 Test Loss: 0.796 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 43465732
model size : 180.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.579651117324829
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.315 Vali Acc: 0.322 Test Loss: 1.315 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.8954236507415771
Epoch: 2, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.171 Vali Acc: 0.618 Test Loss: 1.171 Test Acc: 0.618
Validation loss decreased (-0.322355 --> -0.618409).  Saving model ...
Epoch: 3 cost time: 1.7037639617919922
Epoch: 3, Steps: 10 | Train Loss: 1.046 Vali Loss: 0.997 Vali Acc: 0.612 Test Loss: 0.997 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5366644859313965
Epoch: 4, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.795 Vali Acc: 0.737 Test Loss: 0.795 Test Acc: 0.737
Validation loss decreased (-0.618409 --> -0.736834).  Saving model ...
Epoch: 5 cost time: 1.8450706005096436
Epoch: 5, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
Validation loss decreased (-0.736834 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.6115429401397705
Epoch: 6, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7903711795806885
Epoch: 7, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802627).  Saving model ...
Epoch: 8 cost time: 2.0101630687713623
Epoch: 8, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.518 Vali Acc: 0.836 Test Loss: 0.518 Test Acc: 0.836
Validation loss decreased (-0.802627 --> -0.835521).  Saving model ...
Epoch: 9 cost time: 1.9665720462799072
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4597148895263672
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.677 Vali Acc: 0.816 Test Loss: 0.677 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7354323863983154
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.748 Vali Acc: 0.809 Test Loss: 0.748 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4280991554260254
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.712 Vali Acc: 0.842 Test Loss: 0.712 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842098).  Saving model ...
Epoch: 13 cost time: 1.645829439163208
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.090 Vali Acc: 0.822 Test Loss: 1.090 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7220065593719482
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.753 Vali Acc: 0.842 Test Loss: 0.753 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.295180082321167
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.947 Vali Acc: 0.829 Test Loss: 0.947 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.868678092956543
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.835 Vali Acc: 0.836 Test Loss: 0.835 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6072003841400146
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.759 Vali Acc: 0.855 Test Loss: 0.759 Test Acc: 0.855
Validation loss decreased (-0.842098 --> -0.855256).  Saving model ...
Epoch: 18 cost time: 1.5926332473754883
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.046 Vali Acc: 0.829 Test Loss: 1.046 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5787818431854248
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.776 Vali Acc: 0.855 Test Loss: 0.776 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5172836780548096
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.038 Vali Acc: 0.842 Test Loss: 1.038 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4391834735870361
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.822 Vali Acc: 0.855 Test Loss: 0.822 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4770238399505615
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.912 Vali Acc: 0.849 Test Loss: 0.912 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.489452838897705
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.836 Test Loss: 1.021 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5731267929077148
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.836 Test Loss: 0.984 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4694421291351318
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.842 Test Loss: 0.966 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4361469745635986
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.842 Test Loss: 0.995 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3515043258666992
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.849 Test Loss: 0.952 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 43557892
model size : 180.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.439462900161743
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.366 Vali Acc: 0.329 Test Loss: 1.366 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.0188324451446533
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.287 Vali Acc: 0.362 Test Loss: 1.287 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.0171096324920654
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.190 Vali Acc: 0.572 Test Loss: 1.190 Test Acc: 0.572
Validation loss decreased (-0.361829 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 1.0727002620697021
Epoch: 4, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.071 Vali Acc: 0.612 Test Loss: 1.071 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 1.0468628406524658
Epoch: 5, Steps: 10 | Train Loss: 0.945 Vali Loss: 0.930 Vali Acc: 0.599 Test Loss: 0.930 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2399568557739258
Epoch: 6, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.767 Vali Acc: 0.691 Test Loss: 0.767 Test Acc: 0.691
Validation loss decreased (-0.611831 --> -0.690782).  Saving model ...
Epoch: 7 cost time: 0.9937448501586914
Epoch: 7, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
Validation loss decreased (-0.690782 --> -0.736836).  Saving model ...
Epoch: 8 cost time: 1.0881705284118652
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.522 Vali Acc: 0.750 Test Loss: 0.522 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749995).  Saving model ...
Epoch: 9 cost time: 1.2031776905059814
Epoch: 9, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.470 Vali Acc: 0.789 Test Loss: 0.470 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.789469).  Saving model ...
Epoch: 10 cost time: 0.9476675987243652
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 1.0539498329162598
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 12 cost time: 0.8812668323516846
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.164003849029541
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9730982780456543
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8621218204498291
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0097546577453613
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.542 Vali Acc: 0.822 Test Loss: 0.542 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 17 cost time: 1.1037707328796387
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2140965461730957
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.094803810119629
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.036940574645996
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.683 Vali Acc: 0.816 Test Loss: 0.683 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.197892189025879
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0197508335113525
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.816 Test Loss: 0.692 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3097198009490967
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.724 Vali Acc: 0.816 Test Loss: 0.724 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8516294956207275
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0168969631195068
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.759 Vali Acc: 0.816 Test Loss: 0.759 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2569336891174316
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.810 Vali Acc: 0.809 Test Loss: 0.810 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 43497988
model size : 180.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.655881404876709
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.376 Vali Acc: 0.276 Test Loss: 1.376 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 0.9354243278503418
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.324 Vali Acc: 0.349 Test Loss: 1.324 Test Acc: 0.349
Validation loss decreased (-0.276302 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.9679732322692871
Epoch: 3, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.269 Vali Acc: 0.487 Test Loss: 1.269 Test Acc: 0.487
Validation loss decreased (-0.348671 --> -0.486829).  Saving model ...
Epoch: 4 cost time: 0.7498157024383545
Epoch: 4, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.197 Vali Acc: 0.553 Test Loss: 1.197 Test Acc: 0.553
Validation loss decreased (-0.486829 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 0.7674591541290283
Epoch: 5, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.104 Vali Acc: 0.592 Test Loss: 1.104 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 0.8426480293273926
Epoch: 6, Steps: 10 | Train Loss: 0.940 Vali Loss: 0.976 Vali Acc: 0.632 Test Loss: 0.976 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 0.8024275302886963
Epoch: 7, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.812 Vali Acc: 0.711 Test Loss: 0.812 Test Acc: 0.711
Validation loss decreased (-0.631569 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 0.7714860439300537
Epoch: 8, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.678 Vali Acc: 0.743 Test Loss: 0.678 Test Acc: 0.743
Validation loss decreased (-0.710518 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 0.8700430393218994
Epoch: 9, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.9344007968902588
Epoch: 10, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 0.9079523086547852
Epoch: 11, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 0.8912055492401123
Epoch: 12, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.515 Vali Acc: 0.763 Test Loss: 0.515 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8365514278411865
Epoch: 13, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 0.8608577251434326
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8915965557098389
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.883054256439209
Epoch: 16, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8706142902374268
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8633501529693604
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9542291164398193
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8250319957733154
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.915388822555542
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9061803817749023
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9341490268707275
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.672 Vali Acc: 0.796 Test Loss: 0.672 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 43465732
model size : 180.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6308791637420654
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.410 Vali Acc: 0.263 Test Loss: 1.410 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.3322086334228516
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.323 Vali Acc: 0.401 Test Loss: 1.323 Test Acc: 0.401
Validation loss decreased (-0.263144 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 0.9967086315155029
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.224 Vali Acc: 0.533 Test Loss: 1.224 Test Acc: 0.533
Validation loss decreased (-0.401303 --> -0.532882).  Saving model ...
Epoch: 4 cost time: 1.2376887798309326
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.105 Vali Acc: 0.612 Test Loss: 1.105 Test Acc: 0.612
Validation loss decreased (-0.532882 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 0.9873354434967041
Epoch: 5, Steps: 10 | Train Loss: 0.953 Vali Loss: 0.963 Vali Acc: 0.651 Test Loss: 0.963 Test Acc: 0.651
Validation loss decreased (-0.611831 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.1001615524291992
Epoch: 6, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.849 Vali Acc: 0.664 Test Loss: 0.849 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.214040756225586
Epoch: 7, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.722 Vali Acc: 0.717 Test Loss: 0.722 Test Acc: 0.717
Validation loss decreased (-0.664465 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.0609564781188965
Epoch: 8, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.610 Vali Acc: 0.743 Test Loss: 0.610 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.0206902027130127
Epoch: 9, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.0164380073547363
Epoch: 10, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.0788748264312744
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 0.9922106266021729
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0997536182403564
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 14 cost time: 1.0423133373260498
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809204).  Saving model ...
Epoch: 15 cost time: 1.0405325889587402
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.716 Vali Acc: 0.809 Test Loss: 0.716 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0559606552124023
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0697016716003418
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
Validation loss decreased (-0.809204 --> -0.822361).  Saving model ...
Epoch: 18 cost time: 1.1052742004394531
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0378000736236572
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.744 Vali Acc: 0.809 Test Loss: 0.744 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9986507892608643
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0246450901031494
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9685282707214355
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.797 Vali Acc: 0.803 Test Loss: 0.797 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9866325855255127
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.822 Test Loss: 0.790 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.001227855682373
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.787 Vali Acc: 0.829 Test Loss: 0.787 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828939).  Saving model ...
Epoch: 25 cost time: 0.9741785526275635
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.813 Vali Acc: 0.816 Test Loss: 0.813 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0813467502593994
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.809 Test Loss: 0.834 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0979440212249756
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.841 Vali Acc: 0.809 Test Loss: 0.841 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0320169925689697
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.829 Test Loss: 0.830 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2318274974822998
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.873 Vali Acc: 0.803 Test Loss: 0.873 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2516393661499023
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.885 Vali Acc: 0.809 Test Loss: 0.885 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.049729347229004
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.871 Vali Acc: 0.816 Test Loss: 0.871 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2354462146759033
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.908 Vali Acc: 0.809 Test Loss: 0.908 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.214282512664795
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.816 Test Loss: 0.889 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9662051200866699
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.829 Test Loss: 0.868 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 43507204
model size : 180.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7589123249053955
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.390 Vali Acc: 0.283 Test Loss: 1.390 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.103895664215088
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.310 Vali Acc: 0.375 Test Loss: 1.310 Test Acc: 0.375
Validation loss decreased (-0.282881 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.8932363986968994
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.232 Vali Acc: 0.487 Test Loss: 1.232 Test Acc: 0.487
Validation loss decreased (-0.374987 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 0.9954862594604492
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.142 Vali Acc: 0.651 Test Loss: 1.142 Test Acc: 0.651
Validation loss decreased (-0.486830 --> -0.651304).  Saving model ...
Epoch: 5 cost time: 1.0860252380371094
Epoch: 5, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.029 Vali Acc: 0.612 Test Loss: 1.029 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9714152812957764
Epoch: 6, Steps: 10 | Train Loss: 0.887 Vali Loss: 0.901 Vali Acc: 0.678 Test Loss: 0.901 Test Acc: 0.678
Validation loss decreased (-0.651304 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 0.8881900310516357
Epoch: 7, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.738 Vali Acc: 0.684 Test Loss: 0.738 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 8 cost time: 1.2059760093688965
Epoch: 8, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.612 Vali Acc: 0.743 Test Loss: 0.612 Test Acc: 0.743
Validation loss decreased (-0.684203 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.0504138469696045
Epoch: 9, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.1286916732788086
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 0.9149434566497803
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.132850170135498
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.014897346496582
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 1.0496912002563477
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0919883251190186
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9869287014007568
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1324584484100342
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.657 Vali Acc: 0.776 Test Loss: 0.657 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1117775440216064
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.660 Vali Acc: 0.770 Test Loss: 0.660 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0014715194702148
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.681 Vali Acc: 0.776 Test Loss: 0.681 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.036811351776123
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1069018840789795
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.041759729385376
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.770 Vali Acc: 0.789 Test Loss: 0.770 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9478037357330322
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.751 Vali Acc: 0.757 Test Loss: 0.751 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 43488772
model size : 180.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.986780881881714
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.360 Vali Acc: 0.296 Test Loss: 1.360 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.8002533912658691
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.318 Vali Acc: 0.349 Test Loss: 1.318 Test Acc: 0.349
Validation loss decreased (-0.296039 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.0809690952301025
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.254 Vali Acc: 0.513 Test Loss: 1.254 Test Acc: 0.513
Validation loss decreased (-0.348671 --> -0.513145).  Saving model ...
Epoch: 4 cost time: 1.030080795288086
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.183 Vali Acc: 0.572 Test Loss: 1.183 Test Acc: 0.572
Validation loss decreased (-0.513145 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 0.9834089279174805
Epoch: 5, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.103 Vali Acc: 0.592 Test Loss: 1.103 Test Acc: 0.592
Validation loss decreased (-0.572357 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.0066719055175781
Epoch: 6, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
Validation loss decreased (-0.592094 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.8748488426208496
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.901 Vali Acc: 0.664 Test Loss: 0.901 Test Acc: 0.664
Validation loss decreased (-0.624990 --> -0.664465).  Saving model ...
Epoch: 8 cost time: 0.8610074520111084
Epoch: 8, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.765 Vali Acc: 0.651 Test Loss: 0.765 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9607152938842773
Epoch: 9, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.664465 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.1091554164886475
Epoch: 10, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.0882599353790283
Epoch: 11, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.0050652027130127
Epoch: 12, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.1274724006652832
Epoch: 13, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8478536605834961
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 1.0338549613952637
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1053237915039062
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9781908988952637
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0593757629394531
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9696938991546631
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.067903995513916
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0756452083587646
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.640 Vali Acc: 0.776 Test Loss: 0.640 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0693037509918213
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.684 Vali Acc: 0.803 Test Loss: 0.684 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.934689998626709
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9899377822875977
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 43474948
model size : 180.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.011162757873535
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.426 Vali Acc: 0.289 Test Loss: 1.426 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.4105267524719238
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.349 Vali Acc: 0.283 Test Loss: 1.349 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2338554859161377
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.243 Vali Acc: 0.539 Test Loss: 1.243 Test Acc: 0.539
Validation loss decreased (-0.289459 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 1.3846426010131836
Epoch: 4, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.128 Vali Acc: 0.618 Test Loss: 1.128 Test Acc: 0.618
Validation loss decreased (-0.539461 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 1.322272777557373
Epoch: 5, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.028 Vali Acc: 0.599 Test Loss: 1.028 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3030946254730225
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.880 Vali Acc: 0.691 Test Loss: 0.880 Test Acc: 0.691
Validation loss decreased (-0.618410 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.2286345958709717
Epoch: 7, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.682 Vali Acc: 0.770 Test Loss: 0.682 Test Acc: 0.770
Validation loss decreased (-0.690781 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.2278168201446533
Epoch: 8, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.4906868934631348
Epoch: 9, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.007755994796753
Epoch: 10, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.357001543045044
Epoch: 11, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.2730250358581543
Epoch: 12, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.517871618270874
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2292993068695068
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2555127143859863
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 16 cost time: 1.3769021034240723
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.722 Vali Acc: 0.796 Test Loss: 0.722 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3895418643951416
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.477799892425537
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.776 Vali Acc: 0.803 Test Loss: 0.776 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3667752742767334
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.803 Vali Acc: 0.776 Test Loss: 0.803 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.179960012435913
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.831 Vali Acc: 0.776 Test Loss: 0.831 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2627625465393066
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.851 Vali Acc: 0.776 Test Loss: 0.851 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2855243682861328
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.870 Vali Acc: 0.776 Test Loss: 0.870 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0667283535003662
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.887 Vali Acc: 0.776 Test Loss: 0.887 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2224681377410889
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.891 Vali Acc: 0.789 Test Loss: 0.891 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2452356815338135
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.901 Vali Acc: 0.789 Test Loss: 0.901 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 43521028
model size : 180.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9110331535339355
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.423 Vali Acc: 0.270 Test Loss: 1.423 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.8856263160705566
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.341 Vali Acc: 0.336 Test Loss: 1.341 Test Acc: 0.336
Validation loss decreased (-0.269723 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.0104591846466064
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.264 Vali Acc: 0.447 Test Loss: 1.264 Test Acc: 0.447
Validation loss decreased (-0.335513 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 0.920243501663208
Epoch: 4, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.185 Vali Acc: 0.487 Test Loss: 1.185 Test Acc: 0.487
Validation loss decreased (-0.447356 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.0434091091156006
Epoch: 5, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.058 Vali Acc: 0.592 Test Loss: 1.058 Test Acc: 0.592
Validation loss decreased (-0.486830 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.0021743774414062
Epoch: 6, Steps: 10 | Train Loss: 0.929 Vali Loss: 0.912 Vali Acc: 0.618 Test Loss: 0.912 Test Acc: 0.618
Validation loss decreased (-0.592095 --> -0.618412).  Saving model ...
Epoch: 7 cost time: 1.194833517074585
Epoch: 7, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.751 Vali Acc: 0.691 Test Loss: 0.751 Test Acc: 0.691
Validation loss decreased (-0.618412 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.0585532188415527
Epoch: 8, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717099).  Saving model ...
Epoch: 9 cost time: 0.7336459159851074
Epoch: 9, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
Validation loss decreased (-0.717099 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.9249212741851807
Epoch: 10, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
Validation loss decreased (-0.749994 --> -0.815783).  Saving model ...
Epoch: 11 cost time: 1.1782560348510742
Epoch: 11, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9747929573059082
Epoch: 12, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
Validation loss decreased (-0.815783 --> -0.828942).  Saving model ...
Epoch: 13 cost time: 1.1521165370941162
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0120768547058105
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9899961948394775
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0234217643737793
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.175391674041748
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9811065196990967
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8117148876190186
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8232676982879639
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.680 Vali Acc: 0.796 Test Loss: 0.680 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0240368843078613
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8882920742034912
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 43502596
model size : 180.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7053327560424805
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.403 Vali Acc: 0.329 Test Loss: 1.403 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.0307986736297607
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.364 Vali Acc: 0.296 Test Loss: 1.364 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.867379903793335
Epoch: 3, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.309 Vali Acc: 0.454 Test Loss: 1.309 Test Acc: 0.454
Validation loss decreased (-0.328933 --> -0.453934).  Saving model ...
Epoch: 4 cost time: 1.093207597732544
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.245 Vali Acc: 0.546 Test Loss: 1.245 Test Acc: 0.546
Validation loss decreased (-0.453934 --> -0.546040).  Saving model ...
Epoch: 5 cost time: 0.9934036731719971
Epoch: 5, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.173 Vali Acc: 0.586 Test Loss: 1.173 Test Acc: 0.586
Validation loss decreased (-0.546040 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 0.9730405807495117
Epoch: 6, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.085 Vali Acc: 0.618 Test Loss: 1.085 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 1.0332303047180176
Epoch: 7, Steps: 10 | Train Loss: 0.945 Vali Loss: 0.955 Vali Acc: 0.697 Test Loss: 0.955 Test Acc: 0.697
Validation loss decreased (-0.618410 --> -0.697359).  Saving model ...
Epoch: 8 cost time: 0.9901218414306641
Epoch: 8, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.809 Vali Acc: 0.691 Test Loss: 0.809 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0476837158203125
Epoch: 9, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.649 Vali Acc: 0.737 Test Loss: 0.649 Test Acc: 0.737
Validation loss decreased (-0.697359 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.0103144645690918
Epoch: 10, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.736836 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.107025384902954
Epoch: 11, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.502 Vali Acc: 0.822 Test Loss: 0.502 Test Acc: 0.822
Validation loss decreased (-0.782889 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 0.9665441513061523
Epoch: 12, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.934006929397583
Epoch: 13, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.479 Vali Acc: 0.783 Test Loss: 0.479 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0467872619628906
Epoch: 14, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.476 Vali Acc: 0.796 Test Loss: 0.476 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9481956958770752
Epoch: 15, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 16 cost time: 1.1546454429626465
Epoch: 16, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.996098518371582
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1169512271881104
Epoch: 18, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.517 Vali Acc: 0.816 Test Loss: 0.517 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9538421630859375
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.93937087059021
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8790011405944824
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0033607482910156
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.564 Vali Acc: 0.829 Test Loss: 0.564 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9651494026184082
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.98030686378479
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0343482494354248
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 43484164
model size : 180.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.773298501968384
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.6215505599975586
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.182 Vali Acc: 0.592 Test Loss: 1.182 Test Acc: 0.592
Validation loss decreased (-0.374987 --> -0.592093).  Saving model ...
Epoch: 3 cost time: 1.58140230178833
Epoch: 3, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.034 Vali Acc: 0.599 Test Loss: 1.034 Test Acc: 0.599
Validation loss decreased (-0.592093 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 1.9150362014770508
Epoch: 4, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.851 Vali Acc: 0.757 Test Loss: 0.851 Test Acc: 0.757
Validation loss decreased (-0.598674 --> -0.756570).  Saving model ...
Epoch: 5 cost time: 1.8528470993041992
Epoch: 5, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.735 Vali Acc: 0.757 Test Loss: 0.735 Test Acc: 0.757
Validation loss decreased (-0.756570 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 1.654900074005127
Epoch: 6, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.613 Vali Acc: 0.763 Test Loss: 0.613 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.4627869129180908
Epoch: 7, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.8495690822601318
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.5412564277648926
Epoch: 9, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.848 Vali Acc: 0.809 Test Loss: 0.848 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809202).  Saving model ...
Epoch: 10 cost time: 1.6654815673828125
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5676188468933105
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.686 Vali Acc: 0.796 Test Loss: 0.686 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.574436902999878
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.732 Vali Acc: 0.816 Test Loss: 0.732 Test Acc: 0.816
Validation loss decreased (-0.809202 --> -0.815782).  Saving model ...
Epoch: 13 cost time: 1.4470319747924805
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.783 Vali Acc: 0.822 Test Loss: 0.783 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822361).  Saving model ...
Epoch: 14 cost time: 1.4956300258636475
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.828 Vali Acc: 0.829 Test Loss: 0.828 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828939).  Saving model ...
Epoch: 15 cost time: 1.4026050567626953
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.798 Vali Acc: 0.836 Test Loss: 0.798 Test Acc: 0.836
Validation loss decreased (-0.828939 --> -0.835518).  Saving model ...
Epoch: 16 cost time: 1.505124807357788
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.996 Vali Acc: 0.836 Test Loss: 0.996 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4532065391540527
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.878 Vali Acc: 0.816 Test Loss: 0.878 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.474069595336914
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.860 Vali Acc: 0.836 Test Loss: 0.860 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5665314197540283
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.893 Vali Acc: 0.816 Test Loss: 0.893 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5291469097137451
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.949 Vali Acc: 0.809 Test Loss: 0.949 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.485339879989624
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.144 Vali Acc: 0.822 Test Loss: 1.144 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.521791934967041
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.024 Vali Acc: 0.816 Test Loss: 1.024 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4356987476348877
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.049 Vali Acc: 0.829 Test Loss: 1.049 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1759023666381836
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.307 Vali Acc: 0.829 Test Loss: 1.307 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3888227939605713
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.198 Vali Acc: 0.809 Test Loss: 1.198 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 36451588
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.82179856300354
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.402 Vali Acc: 0.322 Test Loss: 1.402 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.1390719413757324
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.336 Vali Acc: 0.303 Test Loss: 1.336 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2421634197235107
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.226 Vali Acc: 0.493 Test Loss: 1.226 Test Acc: 0.493
Validation loss decreased (-0.322354 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.1403496265411377
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.106 Vali Acc: 0.572 Test Loss: 1.106 Test Acc: 0.572
Validation loss decreased (-0.493409 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.1591401100158691
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 0.965 Vali Acc: 0.625 Test Loss: 0.965 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 1.00038480758667
Epoch: 6, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.800 Vali Acc: 0.730 Test Loss: 0.800 Test Acc: 0.730
Validation loss decreased (-0.624990 --> -0.730255).  Saving model ...
Epoch: 7 cost time: 1.078639030456543
Epoch: 7, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.644 Vali Acc: 0.770 Test Loss: 0.644 Test Acc: 0.770
Validation loss decreased (-0.730255 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 0.9932188987731934
Epoch: 8, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.495 Vali Acc: 0.789 Test Loss: 0.495 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789469).  Saving model ...
Epoch: 9 cost time: 1.1797184944152832
Epoch: 9, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.468 Vali Acc: 0.816 Test Loss: 0.468 Test Acc: 0.816
Validation loss decreased (-0.789469 --> -0.815785).  Saving model ...
Epoch: 10 cost time: 1.119884729385376
Epoch: 10, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 1.1949305534362793
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1198456287384033
Epoch: 12, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.495 Vali Acc: 0.842 Test Loss: 0.495 Test Acc: 0.842
Validation loss decreased (-0.822364 --> -0.842100).  Saving model ...
Epoch: 13 cost time: 0.9192938804626465
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9982156753540039
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2246544361114502
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1339011192321777
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1256506443023682
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.836 Test Loss: 0.616 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1177749633789062
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.624 Vali Acc: 0.836 Test Loss: 0.624 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0821738243103027
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.639 Vali Acc: 0.842 Test Loss: 0.639 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1144940853118896
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.648 Vali Acc: 0.842 Test Loss: 0.648 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0210447311401367
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.855 Test Loss: 0.662 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855257).  Saving model ...
Epoch: 22 cost time: 1.0754051208496094
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.668 Vali Acc: 0.836 Test Loss: 0.668 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2060914039611816
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.693 Vali Acc: 0.842 Test Loss: 0.693 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2124121189117432
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.160348892211914
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.842 Test Loss: 0.753 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1389484405517578
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.08089017868042
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.849 Test Loss: 0.689 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1477000713348389
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.680 Vali Acc: 0.836 Test Loss: 0.680 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9506957530975342
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.849 Test Loss: 0.697 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0186331272125244
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.842 Test Loss: 0.697 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1089460849761963
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.842 Test Loss: 0.701 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 36387076
model size : 153.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.531916618347168
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.425 Vali Acc: 0.237 Test Loss: 1.425 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.4588186740875244
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.257 Vali Acc: 0.493 Test Loss: 1.257 Test Acc: 0.493
Validation loss decreased (-0.236828 --> -0.493408).  Saving model ...
Epoch: 3 cost time: 1.5157551765441895
Epoch: 3, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.063 Vali Acc: 0.645 Test Loss: 1.063 Test Acc: 0.645
Validation loss decreased (-0.493408 --> -0.644726).  Saving model ...
Epoch: 4 cost time: 1.7910630702972412
Epoch: 4, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.866 Vali Acc: 0.724 Test Loss: 0.866 Test Acc: 0.724
Validation loss decreased (-0.644726 --> -0.723676).  Saving model ...
Epoch: 5 cost time: 1.5824735164642334
Epoch: 5, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 1.4643139839172363
Epoch: 6, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
Validation loss decreased (-0.730256 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.7108547687530518
Epoch: 7, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.491 Vali Acc: 0.776 Test Loss: 0.491 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5221631526947021
Epoch: 8, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6619093418121338
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4328961372375488
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.796047 --> -0.822362).  Saving model ...
Epoch: 11 cost time: 1.4635870456695557
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4154913425445557
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5887017250061035
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.023 Vali Acc: 0.809 Test Loss: 1.023 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4917712211608887
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.853 Vali Acc: 0.809 Test Loss: 0.853 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3545589447021484
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.980 Vali Acc: 0.822 Test Loss: 0.980 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4799740314483643
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.851 Vali Acc: 0.796 Test Loss: 0.851 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4656245708465576
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.906 Vali Acc: 0.809 Test Loss: 0.906 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4354925155639648
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.910 Vali Acc: 0.803 Test Loss: 0.910 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3095555305480957
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.822 Test Loss: 0.942 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4118144512176514
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.904 Vali Acc: 0.816 Test Loss: 0.904 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 36460804
model size : 153.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.893192768096924
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.373 Vali Acc: 0.289 Test Loss: 1.373 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.8862342834472656
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.289460 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.8364436626434326
Epoch: 3, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.154 Vali Acc: 0.638 Test Loss: 1.154 Test Acc: 0.638
Validation loss decreased (-0.499987 --> -0.638146).  Saving model ...
Epoch: 4 cost time: 1.0806434154510498
Epoch: 4, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.026 Vali Acc: 0.678 Test Loss: 1.026 Test Acc: 0.678
Validation loss decreased (-0.638146 --> -0.677621).  Saving model ...
Epoch: 5 cost time: 1.1089251041412354
Epoch: 5, Steps: 10 | Train Loss: 0.920 Vali Loss: 0.867 Vali Acc: 0.691 Test Loss: 0.867 Test Acc: 0.691
Validation loss decreased (-0.677621 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.1391191482543945
Epoch: 6, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.686 Vali Acc: 0.743 Test Loss: 0.686 Test Acc: 0.743
Validation loss decreased (-0.690781 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.2920517921447754
Epoch: 7, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 0.9136090278625488
Epoch: 8, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 0.9669880867004395
Epoch: 9, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8941359519958496
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 11 cost time: 0.8258094787597656
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.564 Vali Acc: 0.836 Test Loss: 0.564 Test Acc: 0.836
Validation loss decreased (-0.796048 --> -0.835521).  Saving model ...
Epoch: 12 cost time: 0.9603898525238037
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.958763837814331
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.583 Vali Acc: 0.829 Test Loss: 0.583 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9638781547546387
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.584 Vali Acc: 0.849 Test Loss: 0.584 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848678).  Saving model ...
Epoch: 15 cost time: 0.9431006908416748
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
Validation loss decreased (-0.848678 --> -0.855257).  Saving model ...
Epoch: 16 cost time: 1.1212360858917236
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.609 Vali Acc: 0.849 Test Loss: 0.609 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9985284805297852
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.620 Vali Acc: 0.849 Test Loss: 0.620 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0602929592132568
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.623 Vali Acc: 0.862 Test Loss: 0.623 Test Acc: 0.862
Validation loss decreased (-0.855257 --> -0.861836).  Saving model ...
Epoch: 19 cost time: 1.174699068069458
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.862 Test Loss: 0.627 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1808335781097412
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.849 Test Loss: 0.661 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.143200159072876
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.855 Test Loss: 0.648 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.137331247329712
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.855 Test Loss: 0.666 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0641798973083496
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.855 Test Loss: 0.671 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9037826061248779
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.849 Test Loss: 0.698 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2102437019348145
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.849 Test Loss: 0.681 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.173393964767456
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.855 Test Loss: 0.700 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1327221393585205
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.855 Test Loss: 0.704 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1243259906768799
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.692 Vali Acc: 0.829 Test Loss: 0.692 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 36396292
model size : 153.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.794992685317993
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.403 Vali Acc: 0.289 Test Loss: 1.403 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.1504406929016113
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.326 Vali Acc: 0.388 Test Loss: 1.326 Test Acc: 0.388
Validation loss decreased (-0.289460 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 0.9327080249786377
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.388145 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.1977076530456543
Epoch: 4, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.153 Vali Acc: 0.618 Test Loss: 1.153 Test Acc: 0.618
Validation loss decreased (-0.499987 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 1.0260372161865234
Epoch: 5, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.052 Vali Acc: 0.632 Test Loss: 1.052 Test Acc: 0.632
Validation loss decreased (-0.618410 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 0.9991347789764404
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.888 Vali Acc: 0.704 Test Loss: 0.888 Test Acc: 0.704
Validation loss decreased (-0.631568 --> -0.703938).  Saving model ...
Epoch: 7 cost time: 1.08286452293396
Epoch: 7, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.084411859512329
Epoch: 8, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.112008810043335
Epoch: 9, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 1.158623456954956
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
Validation loss decreased (-0.769732 --> -0.815785).  Saving model ...
Epoch: 11 cost time: 1.0490708351135254
Epoch: 11, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2088959217071533
Epoch: 12, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.543 Vali Acc: 0.842 Test Loss: 0.543 Test Acc: 0.842
Validation loss decreased (-0.815785 --> -0.842100).  Saving model ...
Epoch: 13 cost time: 1.0560698509216309
Epoch: 13, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1053588390350342
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.617 Vali Acc: 0.836 Test Loss: 0.617 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2034094333648682
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7876739501953125
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.629 Vali Acc: 0.829 Test Loss: 0.629 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8698782920837402
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7244000434875488
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.647 Vali Acc: 0.842 Test Loss: 0.647 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7339212894439697
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8498244285583496
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.619 Vali Acc: 0.829 Test Loss: 0.619 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8342156410217285
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.676 Vali Acc: 0.836 Test Loss: 0.676 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9695672988891602
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.686 Vali Acc: 0.829 Test Loss: 0.686 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 36377860
model size : 153.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.139707088470459
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.312 Vali Acc: 0.322 Test Loss: 1.312 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.544959545135498
Epoch: 2, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.166 Vali Acc: 0.605 Test Loss: 1.166 Test Acc: 0.605
Validation loss decreased (-0.322355 --> -0.605252).  Saving model ...
Epoch: 3 cost time: 1.027510643005371
Epoch: 3, Steps: 10 | Train Loss: 1.033 Vali Loss: 0.994 Vali Acc: 0.579 Test Loss: 0.994 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3725779056549072
Epoch: 4, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
Validation loss decreased (-0.605252 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 1.2327675819396973
Epoch: 5, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.2005858421325684
Epoch: 6, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
Validation loss decreased (-0.756573 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 1.4832696914672852
Epoch: 7, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
Validation loss decreased (-0.796048 --> -0.822363).  Saving model ...
Epoch: 8 cost time: 1.4761393070220947
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.477 Vali Acc: 0.829 Test Loss: 0.477 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 1.5182325839996338
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5101735591888428
Epoch: 10, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.549 Vali Acc: 0.842 Test Loss: 0.549 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842100).  Saving model ...
Epoch: 11 cost time: 1.8636963367462158
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.575 Vali Acc: 0.829 Test Loss: 0.575 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6427648067474365
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.738 Vali Acc: 0.842 Test Loss: 0.738 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7868664264678955
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.629 Vali Acc: 0.842 Test Loss: 0.629 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3585548400878906
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.646 Vali Acc: 0.842 Test Loss: 0.646 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2702014446258545
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.736 Vali Acc: 0.836 Test Loss: 0.736 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.80159592628479
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.855 Test Loss: 0.712 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855256).  Saving model ...
Epoch: 17 cost time: 1.5259044170379639
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.868 Test Loss: 0.740 Test Acc: 0.868
Validation loss decreased (-0.855256 --> -0.868414).  Saving model ...
Epoch: 18 cost time: 1.8871490955352783
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.814 Vali Acc: 0.842 Test Loss: 0.814 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.47853422164917
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.836 Test Loss: 0.790 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.768310546875
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.842 Test Loss: 0.743 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3541533946990967
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.784 Vali Acc: 0.842 Test Loss: 0.784 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3828206062316895
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.767 Vali Acc: 0.836 Test Loss: 0.767 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7464499473571777
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.842 Test Loss: 0.795 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5478980541229248
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.842 Test Loss: 0.820 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7113423347473145
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.842 Test Loss: 0.823 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5056109428405762
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.849 Test Loss: 0.807 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.545304298400879
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.849 Test Loss: 0.820 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 36470020
model size : 153.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.817328691482544
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.362 Vali Acc: 0.355 Test Loss: 1.362 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.034358263015747
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.276 Vali Acc: 0.368 Test Loss: 1.276 Test Acc: 0.368
Validation loss decreased (-0.355250 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.2247402667999268
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.170 Vali Acc: 0.586 Test Loss: 1.170 Test Acc: 0.586
Validation loss decreased (-0.368408 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.161104440689087
Epoch: 4, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.044 Vali Acc: 0.612 Test Loss: 1.044 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.0534658432006836
Epoch: 5, Steps: 10 | Train Loss: 0.906 Vali Loss: 0.900 Vali Acc: 0.625 Test Loss: 0.900 Test Acc: 0.625
Validation loss decreased (-0.611832 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 0.93410325050354
Epoch: 6, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.746 Vali Acc: 0.684 Test Loss: 0.746 Test Acc: 0.684
Validation loss decreased (-0.624991 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.1636219024658203
Epoch: 7, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.592 Vali Acc: 0.743 Test Loss: 0.592 Test Acc: 0.743
Validation loss decreased (-0.684203 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.1864922046661377
Epoch: 8, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.523 Vali Acc: 0.763 Test Loss: 0.523 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763153).  Saving model ...
Epoch: 9 cost time: 1.0472300052642822
Epoch: 9, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
Validation loss decreased (-0.763153 --> -0.815785).  Saving model ...
Epoch: 10 cost time: 1.1809864044189453
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.056563377380371
Epoch: 11, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 12 cost time: 1.163827657699585
Epoch: 12, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 13 cost time: 1.0240967273712158
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1907947063446045
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1003344058990479
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2479512691497803
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0478134155273438
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1097784042358398
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8951845169067383
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.829 Test Loss: 0.617 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0238792896270752
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.620 Vali Acc: 0.829 Test Loss: 0.620 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1088619232177734
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.829 Test Loss: 0.652 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9328083992004395
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 36410116
model size : 153.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7732455730438232
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.373 Vali Acc: 0.283 Test Loss: 1.373 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.8672540187835693
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.321 Vali Acc: 0.375 Test Loss: 1.321 Test Acc: 0.375
Validation loss decreased (-0.282881 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.921302080154419
Epoch: 3, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.262 Vali Acc: 0.493 Test Loss: 1.262 Test Acc: 0.493
Validation loss decreased (-0.374987 --> -0.493408).  Saving model ...
Epoch: 4 cost time: 0.9146640300750732
Epoch: 4, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.183 Vali Acc: 0.559 Test Loss: 1.183 Test Acc: 0.559
Validation loss decreased (-0.493408 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.087874412536621
Epoch: 5, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.086 Vali Acc: 0.612 Test Loss: 1.086 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 0.9930522441864014
Epoch: 6, Steps: 10 | Train Loss: 0.938 Vali Loss: 0.962 Vali Acc: 0.651 Test Loss: 0.962 Test Acc: 0.651
Validation loss decreased (-0.611831 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 0.8085629940032959
Epoch: 7, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.810 Vali Acc: 0.697 Test Loss: 0.810 Test Acc: 0.697
Validation loss decreased (-0.651306 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 1.0036256313323975
Epoch: 8, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.686 Vali Acc: 0.730 Test Loss: 0.686 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 0.9313504695892334
Epoch: 9, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.9145839214324951
Epoch: 10, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9175059795379639
Epoch: 11, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 0.9295635223388672
Epoch: 12, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9249706268310547
Epoch: 13, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 0.9449574947357178
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8889739513397217
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
Validation loss decreased (-0.796047 --> -0.822363).  Saving model ...
Epoch: 16 cost time: 1.1606838703155518
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.523 Vali Acc: 0.829 Test Loss: 0.523 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 17 cost time: 0.9822337627410889
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8914601802825928
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8006377220153809
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8858230113983154
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8426952362060547
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8581781387329102
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9236223697662354
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8932366371154785
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9411706924438477
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9309597015380859
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 36377860
model size : 153.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7816619873046875
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.415 Vali Acc: 0.263 Test Loss: 1.415 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.0281131267547607
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.320 Vali Acc: 0.428 Test Loss: 1.320 Test Acc: 0.428
Validation loss decreased (-0.263144 --> -0.427618).  Saving model ...
Epoch: 3 cost time: 0.9723725318908691
Epoch: 3, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.218 Vali Acc: 0.533 Test Loss: 1.218 Test Acc: 0.533
Validation loss decreased (-0.427618 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 0.9783635139465332
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.094 Vali Acc: 0.592 Test Loss: 1.094 Test Acc: 0.592
Validation loss decreased (-0.532883 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 0.9854438304901123
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.954 Vali Acc: 0.632 Test Loss: 0.954 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 1.1559484004974365
Epoch: 6, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.826 Vali Acc: 0.664 Test Loss: 0.826 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.013340950012207
Epoch: 7, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.685 Vali Acc: 0.691 Test Loss: 0.685 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690783).  Saving model ...
Epoch: 8 cost time: 1.2339341640472412
Epoch: 8, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.690783 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.0421595573425293
Epoch: 9, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.108508586883545
Epoch: 10, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0637102127075195
Epoch: 11, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.0785961151123047
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1229991912841797
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.730 Vali Acc: 0.822 Test Loss: 0.730 Test Acc: 0.822
Validation loss decreased (-0.789468 --> -0.822361).  Saving model ...
Epoch: 14 cost time: 1.0047600269317627
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0405313968658447
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.718 Vali Acc: 0.816 Test Loss: 0.718 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.192028284072876
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.822361 --> -0.822362).  Saving model ...
Epoch: 17 cost time: 1.1307709217071533
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.733 Vali Acc: 0.816 Test Loss: 0.733 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0813450813293457
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1218929290771484
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.720 Vali Acc: 0.816 Test Loss: 0.720 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.947354793548584
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.736 Vali Acc: 0.822 Test Loss: 0.736 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.185049057006836
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.729 Vali Acc: 0.822 Test Loss: 0.729 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9809038639068604
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.798 Vali Acc: 0.803 Test Loss: 0.798 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.095350980758667
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.769 Vali Acc: 0.816 Test Loss: 0.769 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0476930141448975
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0170071125030518
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.784 Vali Acc: 0.803 Test Loss: 0.784 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0047492980957031
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.796 Test Loss: 0.787 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 36419332
model size : 153.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.434885263442993
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.390 Vali Acc: 0.283 Test Loss: 1.390 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.9155440330505371
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.302 Vali Acc: 0.395 Test Loss: 1.302 Test Acc: 0.395
Validation loss decreased (-0.282881 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 0.8394227027893066
Epoch: 3, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.221 Vali Acc: 0.546 Test Loss: 1.221 Test Acc: 0.546
Validation loss decreased (-0.394724 --> -0.546040).  Saving model ...
Epoch: 4 cost time: 0.9304261207580566
Epoch: 4, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.127 Vali Acc: 0.612 Test Loss: 1.127 Test Acc: 0.612
Validation loss decreased (-0.546040 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 0.7669863700866699
Epoch: 5, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.011 Vali Acc: 0.605 Test Loss: 1.011 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7885324954986572
Epoch: 6, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.863 Vali Acc: 0.664 Test Loss: 0.863 Test Acc: 0.664
Validation loss decreased (-0.611831 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 0.9286956787109375
Epoch: 7, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.707 Vali Acc: 0.697 Test Loss: 0.707 Test Acc: 0.697
Validation loss decreased (-0.664465 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 0.7844619750976562
Epoch: 8, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.597 Vali Acc: 0.724 Test Loss: 0.597 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723678).  Saving model ...
Epoch: 9 cost time: 0.7925443649291992
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
Validation loss decreased (-0.723678 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.8763084411621094
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 0.71994948387146
Epoch: 11, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 0.8623738288879395
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.01399827003479
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 0.897575855255127
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.598 Vali Acc: 0.816 Test Loss: 0.598 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 15 cost time: 0.9035944938659668
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8911499977111816
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8520586490631104
Epoch: 17, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.618 Vali Acc: 0.836 Test Loss: 0.618 Test Acc: 0.836
Validation loss decreased (-0.815783 --> -0.835520).  Saving model ...
Epoch: 18 cost time: 0.9565286636352539
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.005028486251831
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.635 Vali Acc: 0.829 Test Loss: 0.635 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.988316535949707
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.656 Vali Acc: 0.829 Test Loss: 0.656 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9440643787384033
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.669 Vali Acc: 0.829 Test Loss: 0.669 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8641843795776367
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9731519222259521
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.701 Vali Acc: 0.829 Test Loss: 0.701 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8985435962677002
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.687 Vali Acc: 0.829 Test Loss: 0.687 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.776240348815918
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.905226469039917
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.713 Vali Acc: 0.829 Test Loss: 0.713 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8178770542144775
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 36400900
model size : 153.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.702329397201538
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.358 Vali Acc: 0.296 Test Loss: 1.358 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.8881270885467529
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.317 Vali Acc: 0.349 Test Loss: 1.317 Test Acc: 0.349
Validation loss decreased (-0.296039 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.8246254920959473
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.255 Vali Acc: 0.539 Test Loss: 1.255 Test Acc: 0.539
Validation loss decreased (-0.348671 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 0.8716771602630615
Epoch: 4, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.187 Vali Acc: 0.572 Test Loss: 1.187 Test Acc: 0.572
Validation loss decreased (-0.539461 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 0.9325134754180908
Epoch: 5, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.107 Vali Acc: 0.559 Test Loss: 1.107 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.840756893157959
Epoch: 6, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.008 Vali Acc: 0.625 Test Loss: 1.008 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.812384843826294
Epoch: 7, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.892 Vali Acc: 0.658 Test Loss: 0.892 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 8 cost time: 0.9287338256835938
Epoch: 8, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.775 Vali Acc: 0.678 Test Loss: 0.775 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677624).  Saving model ...
Epoch: 9 cost time: 0.8592369556427002
Epoch: 9, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.698 Vali Acc: 0.684 Test Loss: 0.698 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684204).  Saving model ...
Epoch: 10 cost time: 0.8217527866363525
Epoch: 10, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
Validation loss decreased (-0.684204 --> -0.717099).  Saving model ...
Epoch: 11 cost time: 0.8431267738342285
Epoch: 11, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.573 Vali Acc: 0.743 Test Loss: 0.573 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 0.8001081943511963
Epoch: 12, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
Validation loss decreased (-0.743415 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 0.8804831504821777
Epoch: 13, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8064124584197998
Epoch: 14, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.562 Vali Acc: 0.836 Test Loss: 0.562 Test Acc: 0.836
Validation loss decreased (-0.789468 --> -0.835521).  Saving model ...
Epoch: 15 cost time: 0.8290276527404785
Epoch: 15, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8254692554473877
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.550 Vali Acc: 0.836 Test Loss: 0.550 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 17 cost time: 0.8642756938934326
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8887114524841309
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8561832904815674
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0435161590576172
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.591 Vali Acc: 0.829 Test Loss: 0.591 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9622843265533447
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8356084823608398
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.633 Vali Acc: 0.829 Test Loss: 0.633 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7637350559234619
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9364089965820312
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.625 Vali Acc: 0.796 Test Loss: 0.625 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8200080394744873
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8842668533325195
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.660 Vali Acc: 0.816 Test Loss: 0.660 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 36387076
model size : 153.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.962792158126831
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.425 Vali Acc: 0.309 Test Loss: 1.425 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 0.9408125877380371
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.344 Vali Acc: 0.303 Test Loss: 1.344 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0353679656982422
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.234 Vali Acc: 0.546 Test Loss: 1.234 Test Acc: 0.546
Validation loss decreased (-0.309196 --> -0.546040).  Saving model ...
Epoch: 4 cost time: 1.167703628540039
Epoch: 4, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.112 Vali Acc: 0.612 Test Loss: 1.112 Test Acc: 0.612
Validation loss decreased (-0.546040 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 1.0247831344604492
Epoch: 5, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.008 Vali Acc: 0.612 Test Loss: 1.008 Test Acc: 0.612
Validation loss decreased (-0.611831 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 0.9699926376342773
Epoch: 6, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.857 Vali Acc: 0.697 Test Loss: 0.857 Test Acc: 0.697
Validation loss decreased (-0.611832 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.0572717189788818
Epoch: 7, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.667 Vali Acc: 0.770 Test Loss: 0.667 Test Acc: 0.770
Validation loss decreased (-0.697360 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.174407720565796
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0547006130218506
Epoch: 9, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 0.9817531108856201
Epoch: 10, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.190624475479126
Epoch: 11, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
Validation loss decreased (-0.782889 --> -0.815783).  Saving model ...
Epoch: 12 cost time: 0.9666132926940918
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1717686653137207
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0242314338684082
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9884440898895264
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.115649700164795
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.669 Vali Acc: 0.796 Test Loss: 0.669 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9786031246185303
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822361).  Saving model ...
Epoch: 18 cost time: 1.1076254844665527
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1134259700775146
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.711 Vali Acc: 0.822 Test Loss: 0.711 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.141843557357788
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.734 Vali Acc: 0.816 Test Loss: 0.734 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1391618251800537
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.760 Vali Acc: 0.816 Test Loss: 0.760 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0863771438598633
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1986258029937744
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.811 Vali Acc: 0.809 Test Loss: 0.811 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2142505645751953
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.816 Vali Acc: 0.796 Test Loss: 0.816 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9796531200408936
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.819 Vali Acc: 0.803 Test Loss: 0.819 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1786327362060547
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.836 Vali Acc: 0.803 Test Loss: 0.836 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9953756332397461
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 36433156
model size : 153.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9472126960754395
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.427 Vali Acc: 0.263 Test Loss: 1.427 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 0.9489359855651855
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.340 Vali Acc: 0.342 Test Loss: 1.340 Test Acc: 0.342
Validation loss decreased (-0.263144 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 0.8390052318572998
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.266 Vali Acc: 0.421 Test Loss: 1.266 Test Acc: 0.421
Validation loss decreased (-0.342092 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.0069620609283447
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.189 Vali Acc: 0.487 Test Loss: 1.189 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 0.8698880672454834
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.075 Vali Acc: 0.572 Test Loss: 1.075 Test Acc: 0.572
Validation loss decreased (-0.486830 --> -0.572358).  Saving model ...
Epoch: 6 cost time: 0.9664750099182129
Epoch: 6, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.958 Vali Acc: 0.625 Test Loss: 0.958 Test Acc: 0.625
Validation loss decreased (-0.572358 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.9291238784790039
Epoch: 7, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.830 Vali Acc: 0.658 Test Loss: 0.830 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 8 cost time: 0.9468364715576172
Epoch: 8, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
Validation loss decreased (-0.657886 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 0.9176239967346191
Epoch: 9, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.717098 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 0.8323001861572266
Epoch: 10, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
Validation loss decreased (-0.763152 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 0.8840699195861816
Epoch: 11, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0364124774932861
Epoch: 12, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 0.9293253421783447
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0274031162261963
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 0.8268940448760986
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0047435760498047
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0426108837127686
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.631 Vali Acc: 0.816 Test Loss: 0.631 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8370287418365479
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8952245712280273
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.676 Vali Acc: 0.809 Test Loss: 0.676 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9803721904754639
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.676 Vali Acc: 0.809 Test Loss: 0.676 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8865222930908203
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9210622310638428
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.718 Vali Acc: 0.803 Test Loss: 0.718 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0281288623809814
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8238098621368408
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.803 Test Loss: 0.740 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 36414724
model size : 153.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.705325126647949
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.402 Vali Acc: 0.316 Test Loss: 1.402 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 0.878035306930542
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.364 Vali Acc: 0.303 Test Loss: 1.364 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8060693740844727
Epoch: 3, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.311 Vali Acc: 0.441 Test Loss: 1.311 Test Acc: 0.441
Validation loss decreased (-0.315775 --> -0.440776).  Saving model ...
Epoch: 4 cost time: 0.7794504165649414
Epoch: 4, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.245 Vali Acc: 0.559 Test Loss: 1.245 Test Acc: 0.559
Validation loss decreased (-0.440776 --> -0.559198).  Saving model ...
Epoch: 5 cost time: 0.8648195266723633
Epoch: 5, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.171 Vali Acc: 0.586 Test Loss: 1.171 Test Acc: 0.586
Validation loss decreased (-0.559198 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 0.7030801773071289
Epoch: 6, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.084 Vali Acc: 0.618 Test Loss: 1.084 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 0.81256103515625
Epoch: 7, Steps: 10 | Train Loss: 0.949 Vali Loss: 0.966 Vali Acc: 0.684 Test Loss: 0.966 Test Acc: 0.684
Validation loss decreased (-0.618410 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 0.9083104133605957
Epoch: 8, Steps: 10 | Train Loss: 0.861 Vali Loss: 0.874 Vali Acc: 0.678 Test Loss: 0.874 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7765974998474121
Epoch: 9, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.742 Vali Acc: 0.697 Test Loss: 0.742 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 0.8471024036407471
Epoch: 10, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
Validation loss decreased (-0.697361 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 0.9463834762573242
Epoch: 11, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 0.9182782173156738
Epoch: 12, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 1.0282623767852783
Epoch: 13, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9948601722717285
Epoch: 14, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 0.8184640407562256
Epoch: 15, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.450 Vali Acc: 0.816 Test Loss: 0.450 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815785).  Saving model ...
Epoch: 16 cost time: 0.965792179107666
Epoch: 16, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 17 cost time: 0.8910071849822998
Epoch: 17, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9177465438842773
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8535757064819336
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8914334774017334
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9693355560302734
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7619693279266357
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8735349178314209
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8018083572387695
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0026130676269531
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7679426670074463
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 36396292
model size : 153.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3657877445220947
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.332 Vali Acc: 0.388 Test Loss: 1.332 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.4392321109771729
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
Validation loss decreased (-0.388145 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 1.195138692855835
Epoch: 3, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.007 Vali Acc: 0.612 Test Loss: 1.007 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.448936939239502
Epoch: 4, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.624988 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 1.4340853691101074
Epoch: 5, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.385148525238037
Epoch: 6, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.585 Vali Acc: 0.757 Test Loss: 0.585 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.2424030303955078
Epoch: 7, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.5620112419128418
Epoch: 8, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.2973887920379639
Epoch: 9, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.685 Vali Acc: 0.822 Test Loss: 0.685 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822362).  Saving model ...
Epoch: 10 cost time: 1.3084619045257568
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822362).  Saving model ...
Epoch: 11 cost time: 1.1826422214508057
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3232753276824951
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.799 Vali Acc: 0.836 Test Loss: 0.799 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835518).  Saving model ...
Epoch: 13 cost time: 1.2802255153656006
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.732 Vali Acc: 0.836 Test Loss: 0.732 Test Acc: 0.836
Validation loss decreased (-0.835518 --> -0.835519).  Saving model ...
Epoch: 14 cost time: 1.6004633903503418
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.817 Vali Acc: 0.849 Test Loss: 0.817 Test Acc: 0.849
Validation loss decreased (-0.835519 --> -0.848676).  Saving model ...
Epoch: 15 cost time: 1.463428258895874
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.767 Vali Acc: 0.836 Test Loss: 0.767 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2683157920837402
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.836 Test Loss: 0.845 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3518364429473877
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.822 Test Loss: 0.796 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6329879760742188
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.842 Test Loss: 0.854 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3811149597167969
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.855 Test Loss: 0.812 Test Acc: 0.855
Validation loss decreased (-0.848676 --> -0.855255).  Saving model ...
Epoch: 20 cost time: 1.3914833068847656
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.832 Vali Acc: 0.855 Test Loss: 0.832 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.207411289215088
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.842 Test Loss: 0.898 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1607096195220947
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.829 Test Loss: 0.842 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.460620641708374
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.829 Test Loss: 0.857 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3204782009124756
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.842 Test Loss: 0.878 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4455063343048096
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.842 Test Loss: 0.863 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1213431358337402
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.842 Test Loss: 0.870 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5280325412750244
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.877 Vali Acc: 0.855 Test Loss: 0.877 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3361198902130127
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.842 Test Loss: 0.876 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2130146026611328
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.882 Vali Acc: 0.849 Test Loss: 0.882 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 29363716
model size : 126.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.803913116455078
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.407 Vali Acc: 0.309 Test Loss: 1.407 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 0.9106254577636719
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.336 Vali Acc: 0.303 Test Loss: 1.336 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.026407241821289
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.223 Vali Acc: 0.493 Test Loss: 1.223 Test Acc: 0.493
Validation loss decreased (-0.309196 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 0.9370138645172119
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.096 Vali Acc: 0.566 Test Loss: 1.096 Test Acc: 0.566
Validation loss decreased (-0.493409 --> -0.565779).  Saving model ...
Epoch: 5 cost time: 0.962371826171875
Epoch: 5, Steps: 10 | Train Loss: 0.961 Vali Loss: 0.958 Vali Acc: 0.599 Test Loss: 0.958 Test Acc: 0.599
Validation loss decreased (-0.565779 --> -0.598675).  Saving model ...
Epoch: 6 cost time: 1.0975863933563232
Epoch: 6, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.800 Vali Acc: 0.724 Test Loss: 0.800 Test Acc: 0.724
Validation loss decreased (-0.598675 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 0.9013245105743408
Epoch: 7, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 0.9747512340545654
Epoch: 8, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.0950093269348145
Epoch: 9, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 0.949005126953125
Epoch: 10, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.0857820510864258
Epoch: 11, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9898614883422852
Epoch: 12, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.569 Vali Acc: 0.836 Test Loss: 0.569 Test Acc: 0.836
Validation loss decreased (-0.809205 --> -0.835521).  Saving model ...
Epoch: 13 cost time: 1.0905876159667969
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.533 Vali Acc: 0.836 Test Loss: 0.533 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 14 cost time: 1.0100810527801514
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0489602088928223
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1284220218658447
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.633 Vali Acc: 0.836 Test Loss: 0.633 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0532047748565674
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.070988416671753
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9996461868286133
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.613 Vali Acc: 0.829 Test Loss: 0.613 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9054050445556641
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.631 Vali Acc: 0.829 Test Loss: 0.631 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8764948844909668
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.822 Test Loss: 0.630 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8789992332458496
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.829 Test Loss: 0.645 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8912630081176758
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.660 Vali Acc: 0.829 Test Loss: 0.660 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 29299204
model size : 126.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1859734058380127
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.428 Vali Acc: 0.296 Test Loss: 1.428 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.0745866298675537
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.252 Vali Acc: 0.467 Test Loss: 1.252 Test Acc: 0.467
Validation loss decreased (-0.296038 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 0.9147677421569824
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.055 Vali Acc: 0.658 Test Loss: 1.055 Test Acc: 0.658
Validation loss decreased (-0.467093 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 1.1427910327911377
Epoch: 4, Steps: 10 | Train Loss: 0.898 Vali Loss: 0.879 Vali Acc: 0.697 Test Loss: 0.879 Test Acc: 0.697
Validation loss decreased (-0.657884 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 1.0542068481445312
Epoch: 5, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.690 Vali Acc: 0.750 Test Loss: 0.690 Test Acc: 0.750
Validation loss decreased (-0.697360 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.2310149669647217
Epoch: 6, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.5902276039123535
Epoch: 7, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0922954082489014
Epoch: 8, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5750300884246826
Epoch: 9, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.577 Vali Acc: 0.829 Test Loss: 0.577 Test Acc: 0.829
Validation loss decreased (-0.782889 --> -0.828942).  Saving model ...
Epoch: 10 cost time: 1.3387112617492676
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3647041320800781
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2891876697540283
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.737 Vali Acc: 0.816 Test Loss: 0.737 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2802646160125732
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.725 Vali Acc: 0.836 Test Loss: 0.725 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835519).  Saving model ...
Epoch: 14 cost time: 1.4445481300354004
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.726 Vali Acc: 0.829 Test Loss: 0.726 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1880371570587158
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.993 Vali Acc: 0.822 Test Loss: 0.993 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1427991390228271
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.825 Vali Acc: 0.836 Test Loss: 0.825 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4891650676727295
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.953 Vali Acc: 0.829 Test Loss: 0.953 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1963226795196533
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.852 Vali Acc: 0.816 Test Loss: 0.852 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.995539665222168
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.946 Vali Acc: 0.829 Test Loss: 0.946 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5177431106567383
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.822 Test Loss: 0.871 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0758111476898193
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.949 Vali Acc: 0.836 Test Loss: 0.949 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.083953857421875
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.862 Vali Acc: 0.822 Test Loss: 0.862 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1044387817382812
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.836 Test Loss: 0.831 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 29372932
model size : 126.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.02482271194458
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.364 Vali Acc: 0.329 Test Loss: 1.364 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.0489416122436523
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.256 Vali Acc: 0.513 Test Loss: 1.256 Test Acc: 0.513
Validation loss decreased (-0.328934 --> -0.513145).  Saving model ...
Epoch: 3 cost time: 1.0900909900665283
Epoch: 3, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.138 Vali Acc: 0.645 Test Loss: 1.138 Test Acc: 0.645
Validation loss decreased (-0.513145 --> -0.644725).  Saving model ...
Epoch: 4 cost time: 1.077991247177124
Epoch: 4, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.003 Vali Acc: 0.684 Test Loss: 1.003 Test Acc: 0.684
Validation loss decreased (-0.644725 --> -0.684200).  Saving model ...
Epoch: 5 cost time: 1.1997385025024414
Epoch: 5, Steps: 10 | Train Loss: 0.893 Vali Loss: 0.844 Vali Acc: 0.717 Test Loss: 0.844 Test Acc: 0.717
Validation loss decreased (-0.684200 --> -0.717097).  Saving model ...
Epoch: 6 cost time: 1.0103247165679932
Epoch: 6, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.697 Vali Acc: 0.750 Test Loss: 0.697 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.2254469394683838
Epoch: 7, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 0.914588451385498
Epoch: 8, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.119391679763794
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.445 Vali Acc: 0.803 Test Loss: 0.445 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 10 cost time: 0.98089599609375
Epoch: 10, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 0.8776431083679199
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9368672370910645
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.037898302078247
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.585 Vali Acc: 0.829 Test Loss: 0.585 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828942).  Saving model ...
Epoch: 14 cost time: 0.9484870433807373
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.584 Vali Acc: 0.836 Test Loss: 0.584 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835520).  Saving model ...
Epoch: 15 cost time: 1.0375523567199707
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.565 Vali Acc: 0.849 Test Loss: 0.565 Test Acc: 0.849
Validation loss decreased (-0.835520 --> -0.848679).  Saving model ...
Epoch: 16 cost time: 1.1296899318695068
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.593 Vali Acc: 0.849 Test Loss: 0.593 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0051038265228271
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.836 Test Loss: 0.615 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9510385990142822
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.619 Vali Acc: 0.855 Test Loss: 0.619 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855257).  Saving model ...
Epoch: 19 cost time: 0.930290937423706
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.619 Vali Acc: 0.849 Test Loss: 0.619 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1654295921325684
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.673 Vali Acc: 0.849 Test Loss: 0.673 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0135509967803955
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.849 Test Loss: 0.647 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8791420459747314
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.668 Vali Acc: 0.855 Test Loss: 0.668 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0925350189208984
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.628 Vali Acc: 0.849 Test Loss: 0.628 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9595305919647217
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.806 Vali Acc: 0.836 Test Loss: 0.806 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0588915348052979
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.849 Test Loss: 0.682 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9921536445617676
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.734 Vali Acc: 0.849 Test Loss: 0.734 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9372091293334961
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.842 Test Loss: 0.795 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8684253692626953
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.726 Vali Acc: 0.849 Test Loss: 0.726 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 29308420
model size : 126.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.803873300552368
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.403 Vali Acc: 0.283 Test Loss: 1.403 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.8613486289978027
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.327 Vali Acc: 0.388 Test Loss: 1.327 Test Acc: 0.388
Validation loss decreased (-0.282881 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 0.8233375549316406
Epoch: 3, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.251 Vali Acc: 0.539 Test Loss: 1.251 Test Acc: 0.539
Validation loss decreased (-0.388145 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 0.8375041484832764
Epoch: 4, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.157 Vali Acc: 0.572 Test Loss: 1.157 Test Acc: 0.572
Validation loss decreased (-0.539461 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 0.8248927593231201
Epoch: 5, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.054 Vali Acc: 0.612 Test Loss: 1.054 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 0.8724570274353027
Epoch: 6, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.901 Vali Acc: 0.684 Test Loss: 0.901 Test Acc: 0.684
Validation loss decreased (-0.611832 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 0.712632417678833
Epoch: 7, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.744 Vali Acc: 0.711 Test Loss: 0.744 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 0.8406026363372803
Epoch: 8, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
Validation loss decreased (-0.710519 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.0145342350006104
Epoch: 9, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.521 Vali Acc: 0.757 Test Loss: 0.521 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756574).  Saving model ...
Epoch: 10 cost time: 0.7340488433837891
Epoch: 10, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
Validation loss decreased (-0.756574 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 0.8835914134979248
Epoch: 11, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.480 Vali Acc: 0.836 Test Loss: 0.480 Test Acc: 0.836
Validation loss decreased (-0.802627 --> -0.835522).  Saving model ...
Epoch: 12 cost time: 0.7901911735534668
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.485 Vali Acc: 0.836 Test Loss: 0.485 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9907560348510742
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9774806499481201
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9517848491668701
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.835522 --> -0.855258).  Saving model ...
Epoch: 16 cost time: 1.0237109661102295
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.501 Vali Acc: 0.842 Test Loss: 0.501 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0354523658752441
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.518 Vali Acc: 0.842 Test Loss: 0.518 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7839703559875488
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.593 Vali Acc: 0.862 Test Loss: 0.593 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861836).  Saving model ...
Epoch: 19 cost time: 0.8414607048034668
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.554 Vali Acc: 0.836 Test Loss: 0.554 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9806933403015137
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.567 Vali Acc: 0.829 Test Loss: 0.567 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7897806167602539
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.639 Vali Acc: 0.862 Test Loss: 0.639 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0372796058654785
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.582 Vali Acc: 0.836 Test Loss: 0.582 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9931182861328125
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.591 Vali Acc: 0.836 Test Loss: 0.591 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9203817844390869
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.855 Test Loss: 0.640 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.756608247756958
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.597 Vali Acc: 0.829 Test Loss: 0.597 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0180561542510986
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.842 Test Loss: 0.632 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8869318962097168
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.641 Vali Acc: 0.836 Test Loss: 0.641 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9513323307037354
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.829 Test Loss: 0.668 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 29289988
model size : 126.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0283350944519043
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.305 Vali Acc: 0.336 Test Loss: 1.305 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.2526421546936035
Epoch: 2, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.155 Vali Acc: 0.612 Test Loss: 1.155 Test Acc: 0.612
Validation loss decreased (-0.335513 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 1.3634886741638184
Epoch: 3, Steps: 10 | Train Loss: 0.996 Vali Loss: 0.971 Vali Acc: 0.625 Test Loss: 0.971 Test Acc: 0.625
Validation loss decreased (-0.611831 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.4242589473724365
Epoch: 4, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.787 Vali Acc: 0.737 Test Loss: 0.787 Test Acc: 0.737
Validation loss decreased (-0.624990 --> -0.736834).  Saving model ...
Epoch: 5 cost time: 1.1925814151763916
Epoch: 5, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.622 Vali Acc: 0.776 Test Loss: 0.622 Test Acc: 0.776
Validation loss decreased (-0.736834 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 0.9717788696289062
Epoch: 6, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4426167011260986
Epoch: 7, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
Validation loss decreased (-0.776310 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 0.9395442008972168
Epoch: 8, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5064702033996582
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 10 cost time: 1.3346612453460693
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 1.4593567848205566
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.633 Vali Acc: 0.822 Test Loss: 0.633 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9546489715576172
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.724 Vali Acc: 0.849 Test Loss: 0.724 Test Acc: 0.849
Validation loss decreased (-0.822363 --> -0.848677).  Saving model ...
Epoch: 13 cost time: 1.4922633171081543
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.690 Vali Acc: 0.836 Test Loss: 0.690 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.173257827758789
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.829 Test Loss: 0.680 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4343760013580322
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.690 Vali Acc: 0.842 Test Loss: 0.690 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8828890323638916
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.739 Vali Acc: 0.849 Test Loss: 0.739 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9248490333557129
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.842 Test Loss: 0.783 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2333590984344482
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.842 Test Loss: 0.749 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1053006649017334
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.762 Vali Acc: 0.849 Test Loss: 0.762 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0187253952026367
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.853 Vali Acc: 0.842 Test Loss: 0.853 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1821274757385254
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.855 Test Loss: 0.756 Test Acc: 0.855
Validation loss decreased (-0.848677 --> -0.855256).  Saving model ...
Epoch: 22 cost time: 1.1918151378631592
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.864 Vali Acc: 0.842 Test Loss: 0.864 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2489116191864014
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.842 Test Loss: 0.834 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1127831935882568
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.842 Test Loss: 0.838 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3554296493530273
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.842 Test Loss: 0.871 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1046888828277588
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.849 Test Loss: 0.846 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4910094738006592
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.872 Vali Acc: 0.842 Test Loss: 0.872 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2606282234191895
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.855 Test Loss: 0.858 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0962207317352295
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.873 Vali Acc: 0.849 Test Loss: 0.873 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.141113519668579
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.849 Test Loss: 0.888 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1871881484985352
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.855 Test Loss: 0.865 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 29382148
model size : 126.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.237943410873413
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.359 Vali Acc: 0.382 Test Loss: 1.359 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 0.7977173328399658
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.279 Vali Acc: 0.355 Test Loss: 1.279 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7385222911834717
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.162 Vali Acc: 0.566 Test Loss: 1.162 Test Acc: 0.566
Validation loss decreased (-0.381565 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 0.8167910575866699
Epoch: 4, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.046 Vali Acc: 0.618 Test Loss: 1.046 Test Acc: 0.618
Validation loss decreased (-0.565778 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 0.730463981628418
Epoch: 5, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.901 Vali Acc: 0.645 Test Loss: 0.901 Test Acc: 0.645
Validation loss decreased (-0.618411 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 0.8394513130187988
Epoch: 6, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.763 Vali Acc: 0.684 Test Loss: 0.763 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 0.8076236248016357
Epoch: 7, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.614 Vali Acc: 0.730 Test Loss: 0.614 Test Acc: 0.730
Validation loss decreased (-0.684203 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 0.7436304092407227
Epoch: 8, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.536 Vali Acc: 0.757 Test Loss: 0.536 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756574).  Saving model ...
Epoch: 9 cost time: 0.8004846572875977
Epoch: 9, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
Validation loss decreased (-0.756574 --> -0.809206).  Saving model ...
Epoch: 10 cost time: 0.748664140701294
Epoch: 10, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9628992080688477
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 0.7920510768890381
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7520036697387695
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9551489353179932
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0008447170257568
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.589 Vali Acc: 0.829 Test Loss: 0.589 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828941).  Saving model ...
Epoch: 16 cost time: 0.7652266025543213
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.532 Vali Acc: 0.836 Test Loss: 0.532 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835521).  Saving model ...
Epoch: 17 cost time: 0.9588840007781982
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.836 Test Loss: 0.558 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8308749198913574
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.542 Vali Acc: 0.842 Test Loss: 0.542 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 19 cost time: 0.9773364067077637
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.584 Vali Acc: 0.829 Test Loss: 0.584 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8723130226135254
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.591 Vali Acc: 0.836 Test Loss: 0.591 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8359761238098145
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.608 Vali Acc: 0.829 Test Loss: 0.608 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9370789527893066
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8254871368408203
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.653 Vali Acc: 0.829 Test Loss: 0.653 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8478360176086426
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.791501522064209
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.829 Test Loss: 0.666 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.970238208770752
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.816 Test Loss: 0.691 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8281960487365723
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.822 Test Loss: 0.720 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8329715728759766
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 29322244
model size : 126.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.233267068862915
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.369 Vali Acc: 0.296 Test Loss: 1.369 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.8163230419158936
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.315 Vali Acc: 0.355 Test Loss: 1.315 Test Acc: 0.355
Validation loss decreased (-0.296039 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 0.8282155990600586
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.355250 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.9541525840759277
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.176 Vali Acc: 0.559 Test Loss: 1.176 Test Acc: 0.559
Validation loss decreased (-0.499987 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 0.7731106281280518
Epoch: 5, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.078 Vali Acc: 0.645 Test Loss: 1.078 Test Acc: 0.645
Validation loss decreased (-0.559199 --> -0.644726).  Saving model ...
Epoch: 6 cost time: 0.9182479381561279
Epoch: 6, Steps: 10 | Train Loss: 0.917 Vali Loss: 0.954 Vali Acc: 0.651 Test Loss: 0.954 Test Acc: 0.651
Validation loss decreased (-0.644726 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 0.7303624153137207
Epoch: 7, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.816 Vali Acc: 0.678 Test Loss: 0.816 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 8 cost time: 0.6852667331695557
Epoch: 8, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 0.83919358253479
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
Validation loss decreased (-0.710519 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.8025312423706055
Epoch: 10, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7781596183776855
Epoch: 11, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796048).  Saving model ...
Epoch: 12 cost time: 0.8561277389526367
Epoch: 12, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.457 Vali Acc: 0.789 Test Loss: 0.457 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7297356128692627
Epoch: 13, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 0.8918490409851074
Epoch: 14, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8537945747375488
Epoch: 15, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 16 cost time: 0.746931791305542
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7766978740692139
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 18 cost time: 0.6840908527374268
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.770667314529419
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8690807819366455
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.802600622177124
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7849657535552979
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7010724544525146
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7767677307128906
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8395516872406006
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7171578407287598
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8089191913604736
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.618 Vali Acc: 0.816 Test Loss: 0.618 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 29289988
model size : 126.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7874529361724854
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.419 Vali Acc: 0.276 Test Loss: 1.419 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 0.9685232639312744
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.320 Vali Acc: 0.395 Test Loss: 1.320 Test Acc: 0.395
Validation loss decreased (-0.276302 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 0.777557373046875
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.215 Vali Acc: 0.520 Test Loss: 1.215 Test Acc: 0.520
Validation loss decreased (-0.394724 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 0.8614859580993652
Epoch: 4, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.090 Vali Acc: 0.592 Test Loss: 1.090 Test Acc: 0.592
Validation loss decreased (-0.519725 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 0.9283933639526367
Epoch: 5, Steps: 10 | Train Loss: 0.935 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.592094 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.7391648292541504
Epoch: 6, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.848 Vali Acc: 0.664 Test Loss: 0.848 Test Acc: 0.664
Validation loss decreased (-0.624990 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 0.8462285995483398
Epoch: 7, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.734 Vali Acc: 0.691 Test Loss: 0.734 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 0.9659063816070557
Epoch: 8, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.626 Vali Acc: 0.724 Test Loss: 0.626 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723678).  Saving model ...
Epoch: 9 cost time: 0.652508020401001
Epoch: 9, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 0.8897531032562256
Epoch: 10, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 0.8239011764526367
Epoch: 11, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
Validation loss decreased (-0.756573 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 0.9261913299560547
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.599 Vali Acc: 0.796 Test Loss: 0.599 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8109486103057861
Epoch: 13, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9721922874450684
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 0.7961685657501221
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 16 cost time: 0.8264322280883789
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822362).  Saving model ...
Epoch: 17 cost time: 0.8347618579864502
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.667 Vali Acc: 0.842 Test Loss: 0.667 Test Acc: 0.842
Validation loss decreased (-0.822362 --> -0.842099).  Saving model ...
Epoch: 18 cost time: 1.0660507678985596
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.638 Vali Acc: 0.816 Test Loss: 0.638 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8990640640258789
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.678 Vali Acc: 0.829 Test Loss: 0.678 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0344233512878418
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0162017345428467
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.705 Vali Acc: 0.842 Test Loss: 0.705 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7622976303100586
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.836 Test Loss: 0.740 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.870297908782959
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.82466721534729
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.842 Test Loss: 0.727 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.822779655456543
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.836 Test Loss: 0.700 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9796717166900635
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.836 Test Loss: 0.686 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9135081768035889
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.714 Vali Acc: 0.836 Test Loss: 0.714 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 29331460
model size : 126.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.482062816619873
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.390 Vali Acc: 0.263 Test Loss: 1.390 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 0.7215783596038818
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.300 Vali Acc: 0.388 Test Loss: 1.300 Test Acc: 0.388
Validation loss decreased (-0.263144 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 0.7279360294342041
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.212 Vali Acc: 0.539 Test Loss: 1.212 Test Acc: 0.539
Validation loss decreased (-0.388145 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 0.7290008068084717
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.539462 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.7609107494354248
Epoch: 5, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.001 Vali Acc: 0.632 Test Loss: 1.001 Test Acc: 0.632
Validation loss decreased (-0.624989 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 0.6904041767120361
Epoch: 6, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.870 Vali Acc: 0.658 Test Loss: 0.870 Test Acc: 0.658
Validation loss decreased (-0.631569 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 0.7651355266571045
Epoch: 7, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.711 Vali Acc: 0.697 Test Loss: 0.711 Test Acc: 0.697
Validation loss decreased (-0.657886 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 0.7895660400390625
Epoch: 8, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.612 Vali Acc: 0.730 Test Loss: 0.612 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 0.770134687423706
Epoch: 9, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.565 Vali Acc: 0.743 Test Loss: 0.565 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 0.8222935199737549
Epoch: 10, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
Validation loss decreased (-0.743415 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 0.951789379119873
Epoch: 11, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8034682273864746
Epoch: 12, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 0.9695253372192383
Epoch: 13, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6664514541625977
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.587 Vali Acc: 0.836 Test Loss: 0.587 Test Acc: 0.836
Validation loss decreased (-0.796048 --> -0.835520).  Saving model ...
Epoch: 15 cost time: 0.7285785675048828
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8791577816009521
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7548110485076904
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7987406253814697
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.574 Vali Acc: 0.836 Test Loss: 0.574 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835521).  Saving model ...
Epoch: 19 cost time: 0.7802095413208008
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.579 Vali Acc: 0.829 Test Loss: 0.579 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8674230575561523
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.604 Vali Acc: 0.829 Test Loss: 0.604 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7063119411468506
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.78116774559021
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7588014602661133
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.842 Test Loss: 0.657 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842099).  Saving model ...
Epoch: 24 cost time: 0.703211784362793
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.651 Vali Acc: 0.829 Test Loss: 0.651 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8290596008300781
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8403971195220947
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9338808059692383
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8125557899475098
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7675790786743164
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.822 Test Loss: 0.735 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8031477928161621
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.83357834815979
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7346327304840088
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.711 Vali Acc: 0.822 Test Loss: 0.711 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.788813591003418
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.741 Vali Acc: 0.816 Test Loss: 0.741 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 29313028
model size : 126.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.557281255722046
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.356 Vali Acc: 0.296 Test Loss: 1.356 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.7290799617767334
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.310 Vali Acc: 0.362 Test Loss: 1.310 Test Acc: 0.362
Validation loss decreased (-0.296039 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 0.9056971073150635
Epoch: 3, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.242 Vali Acc: 0.533 Test Loss: 1.242 Test Acc: 0.533
Validation loss decreased (-0.361829 --> -0.532882).  Saving model ...
Epoch: 4 cost time: 0.780555009841919
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.171 Vali Acc: 0.566 Test Loss: 1.171 Test Acc: 0.566
Validation loss decreased (-0.532882 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 0.8665909767150879
Epoch: 5, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.095 Vali Acc: 0.566 Test Loss: 1.095 Test Acc: 0.566
Validation loss decreased (-0.565778 --> -0.565779).  Saving model ...
Epoch: 6 cost time: 0.7959921360015869
Epoch: 6, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.013 Vali Acc: 0.625 Test Loss: 1.013 Test Acc: 0.625
Validation loss decreased (-0.565779 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.7534029483795166
Epoch: 7, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.911 Vali Acc: 0.651 Test Loss: 0.911 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 0.8814213275909424
Epoch: 8, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.772 Vali Acc: 0.684 Test Loss: 0.772 Test Acc: 0.684
Validation loss decreased (-0.651307 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 0.7284340858459473
Epoch: 9, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.709 Vali Acc: 0.697 Test Loss: 0.709 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 0.8174068927764893
Epoch: 10, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.697361 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 0.804781436920166
Epoch: 11, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 0.8978683948516846
Epoch: 12, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 0.7838919162750244
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 14 cost time: 0.8262641429901123
Epoch: 14, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.548 Vali Acc: 0.829 Test Loss: 0.548 Test Acc: 0.829
Validation loss decreased (-0.802627 --> -0.828942).  Saving model ...
Epoch: 15 cost time: 0.703636884689331
Epoch: 15, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8735458850860596
Epoch: 16, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.548 Vali Acc: 0.829 Test Loss: 0.548 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 17 cost time: 0.7980108261108398
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8005802631378174
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.790684700012207
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.694272518157959
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7148926258087158
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7850544452667236
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7549488544464111
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7326889038085938
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7989141941070557
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.655 Vali Acc: 0.829 Test Loss: 0.655 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7099363803863525
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 29299204
model size : 126.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4849801063537598
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 0.761866569519043
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.342 Vali Acc: 0.296 Test Loss: 1.342 Test Acc: 0.296
Validation loss decreased (-0.289459 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 0.8064358234405518
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.233 Vali Acc: 0.539 Test Loss: 1.233 Test Acc: 0.539
Validation loss decreased (-0.296039 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 0.8432731628417969
Epoch: 4, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
Validation loss decreased (-0.539461 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.840728759765625
Epoch: 5, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.012 Vali Acc: 0.618 Test Loss: 1.012 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7877469062805176
Epoch: 6, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.875 Vali Acc: 0.684 Test Loss: 0.875 Test Acc: 0.684
Validation loss decreased (-0.624989 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 1.026106357574463
Epoch: 7, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
Validation loss decreased (-0.684202 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 0.99833083152771
Epoch: 8, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 0.9936747550964355
Epoch: 9, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 0.7751100063323975
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9083409309387207
Epoch: 11, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.636 Vali Acc: 0.816 Test Loss: 0.636 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815783).  Saving model ...
Epoch: 12 cost time: 1.0310070514678955
Epoch: 12, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0247390270233154
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8523178100585938
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 15 cost time: 0.8196663856506348
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.647 Vali Acc: 0.842 Test Loss: 0.647 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842099).  Saving model ...
Epoch: 16 cost time: 1.0255212783813477
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8294885158538818
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7892253398895264
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9901599884033203
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.701 Vali Acc: 0.816 Test Loss: 0.701 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8009402751922607
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.689 Vali Acc: 0.796 Test Loss: 0.689 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8896033763885498
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.711 Vali Acc: 0.796 Test Loss: 0.711 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9877042770385742
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8356709480285645
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.770 Vali Acc: 0.816 Test Loss: 0.770 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9548008441925049
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0655970573425293
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.803 Test Loss: 0.801 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 29345284
model size : 126.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.59619140625
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.421 Vali Acc: 0.276 Test Loss: 1.421 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 0.6572277545928955
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.332 Vali Acc: 0.342 Test Loss: 1.332 Test Acc: 0.342
Validation loss decreased (-0.276302 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 0.8178825378417969
Epoch: 3, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.249 Vali Acc: 0.474 Test Loss: 1.249 Test Acc: 0.474
Validation loss decreased (-0.342092 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 0.7195742130279541
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.165 Vali Acc: 0.513 Test Loss: 1.165 Test Acc: 0.513
Validation loss decreased (-0.473672 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 0.9272255897521973
Epoch: 5, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.052 Vali Acc: 0.592 Test Loss: 1.052 Test Acc: 0.592
Validation loss decreased (-0.513146 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 0.777470588684082
Epoch: 6, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.938 Vali Acc: 0.651 Test Loss: 0.938 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 0.8591916561126709
Epoch: 7, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.823 Vali Acc: 0.678 Test Loss: 0.823 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 8 cost time: 0.7378387451171875
Epoch: 8, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.703 Vali Acc: 0.691 Test Loss: 0.703 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 9 cost time: 0.8161618709564209
Epoch: 9, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.690782 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 0.8135471343994141
Epoch: 10, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 0.6814286708831787
Epoch: 11, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802627).  Saving model ...
Epoch: 12 cost time: 0.7446498870849609
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 0.727100133895874
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.550 Vali Acc: 0.829 Test Loss: 0.550 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828942).  Saving model ...
Epoch: 14 cost time: 0.7984650135040283
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.679485559463501
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.681 Vali Acc: 0.829 Test Loss: 0.681 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7584633827209473
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.838414192199707
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6885638236999512
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7849595546722412
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.677 Vali Acc: 0.816 Test Loss: 0.677 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8437914848327637
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8909523487091064
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.703 Vali Acc: 0.816 Test Loss: 0.703 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8277637958526611
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.705 Vali Acc: 0.803 Test Loss: 0.705 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7442197799682617
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 29326852
model size : 126.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.674509048461914
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.405 Vali Acc: 0.309 Test Loss: 1.405 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 0.6703701019287109
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.364 Vali Acc: 0.336 Test Loss: 1.364 Test Acc: 0.336
Validation loss decreased (-0.309196 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.8098845481872559
Epoch: 3, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.310 Vali Acc: 0.428 Test Loss: 1.310 Test Acc: 0.428
Validation loss decreased (-0.335513 --> -0.427618).  Saving model ...
Epoch: 4 cost time: 0.7967288494110107
Epoch: 4, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.245 Vali Acc: 0.539 Test Loss: 1.245 Test Acc: 0.539
Validation loss decreased (-0.427618 --> -0.539461).  Saving model ...
Epoch: 5 cost time: 0.781369686126709
Epoch: 5, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.169 Vali Acc: 0.579 Test Loss: 1.169 Test Acc: 0.579
Validation loss decreased (-0.539461 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 0.7891342639923096
Epoch: 6, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.089 Vali Acc: 0.599 Test Loss: 1.089 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 0.8943426609039307
Epoch: 7, Steps: 10 | Train Loss: 0.946 Vali Loss: 0.978 Vali Acc: 0.645 Test Loss: 0.978 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 0.7568292617797852
Epoch: 8, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.856 Vali Acc: 0.658 Test Loss: 0.856 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 0.7255833148956299
Epoch: 9, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.657886 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 0.7510011196136475
Epoch: 10, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 0.7537636756896973
Epoch: 11, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
Validation loss decreased (-0.756573 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 0.6988189220428467
Epoch: 12, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.729266881942749
Epoch: 13, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 14 cost time: 0.6927549839019775
Epoch: 14, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7322297096252441
Epoch: 15, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.468 Vali Acc: 0.809 Test Loss: 0.468 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 16 cost time: 0.7898590564727783
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7705960273742676
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7682399749755859
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 0.8312101364135742
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7358148097991943
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6774811744689941
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6164555549621582
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7174930572509766
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.755573034286499
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.774742841720581
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8641817569732666
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9818699359893799
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8037266731262207
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.655 Vali Acc: 0.809 Test Loss: 0.655 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 29308420
model size : 126.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6710615158081055
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.322 Vali Acc: 0.408 Test Loss: 1.322 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 1.2721405029296875
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.175 Vali Acc: 0.546 Test Loss: 1.175 Test Acc: 0.546
Validation loss decreased (-0.407882 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 0.9865067005157471
Epoch: 3, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.044 Vali Acc: 0.546 Test Loss: 1.044 Test Acc: 0.546
Validation loss decreased (-0.546041 --> -0.546042).  Saving model ...
Epoch: 4 cost time: 0.9902093410491943
Epoch: 4, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
Validation loss decreased (-0.546042 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.2093751430511475
Epoch: 5, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.761 Vali Acc: 0.743 Test Loss: 0.761 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0288920402526855
Epoch: 6, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.658 Vali Acc: 0.743 Test Loss: 0.658 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9765992164611816
Epoch: 7, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.1804821491241455
Epoch: 8, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 9 cost time: 1.068326711654663
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.560 Vali Acc: 0.842 Test Loss: 0.560 Test Acc: 0.842
Validation loss decreased (-0.809205 --> -0.842100).  Saving model ...
Epoch: 10 cost time: 0.9808416366577148
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.562 Vali Acc: 0.842 Test Loss: 0.562 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2714076042175293
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.077225685119629
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.943 Vali Acc: 0.836 Test Loss: 0.943 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0258023738861084
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3056988716125488
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.790 Vali Acc: 0.849 Test Loss: 0.790 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848676).  Saving model ...
Epoch: 15 cost time: 0.9951319694519043
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.699 Vali Acc: 0.855 Test Loss: 0.699 Test Acc: 0.855
Validation loss decreased (-0.848676 --> -0.855256).  Saving model ...
Epoch: 16 cost time: 1.0306317806243896
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.862 Test Loss: 0.715 Test Acc: 0.862
Validation loss decreased (-0.855256 --> -0.861835).  Saving model ...
Epoch: 17 cost time: 1.3439464569091797
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.862 Test Loss: 0.702 Test Acc: 0.862
Validation loss decreased (-0.861835 --> -0.861835).  Saving model ...
Epoch: 18 cost time: 1.0702197551727295
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.791 Vali Acc: 0.855 Test Loss: 0.791 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2709746360778809
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.855 Test Loss: 0.754 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9324746131896973
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.855 Test Loss: 0.765 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.274385690689087
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.862 Test Loss: 0.785 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0092740058898926
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.855 Test Loss: 0.769 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1518101692199707
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.746 Vali Acc: 0.855 Test Loss: 0.746 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2877418994903564
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.855 Test Loss: 0.770 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1043148040771484
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.849 Test Loss: 0.843 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3014428615570068
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.862 Test Loss: 0.790 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0485196113586426
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.862 Test Loss: 0.810 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 22275844
model size : 99.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4742419719696045
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.9330580234527588
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.341 Vali Acc: 0.316 Test Loss: 1.341 Test Acc: 0.316
Validation loss decreased (-0.269723 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 0.9504909515380859
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.315776 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.976616382598877
Epoch: 4, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.112 Vali Acc: 0.592 Test Loss: 1.112 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 0.9581491947174072
Epoch: 5, Steps: 10 | Train Loss: 0.956 Vali Loss: 0.987 Vali Acc: 0.605 Test Loss: 0.987 Test Acc: 0.605
Validation loss decreased (-0.592094 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 0.8621957302093506
Epoch: 6, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.853 Vali Acc: 0.737 Test Loss: 0.853 Test Acc: 0.737
Validation loss decreased (-0.605253 --> -0.736834).  Saving model ...
Epoch: 7 cost time: 0.9364731311798096
Epoch: 7, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.709 Vali Acc: 0.743 Test Loss: 0.709 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 0.8627245426177979
Epoch: 8, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9557085037231445
Epoch: 9, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.743414 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 0.8511130809783936
Epoch: 10, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.933438777923584
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.484 Vali Acc: 0.783 Test Loss: 0.484 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7787132263183594
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.535 Vali Acc: 0.836 Test Loss: 0.535 Test Acc: 0.836
Validation loss decreased (-0.789468 --> -0.835521).  Saving model ...
Epoch: 13 cost time: 0.8664047718048096
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
Validation loss decreased (-0.835521 --> -0.855259).  Saving model ...
Epoch: 14 cost time: 0.8335568904876709
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.444 Vali Acc: 0.842 Test Loss: 0.444 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9646463394165039
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7651917934417725
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.492 Vali Acc: 0.849 Test Loss: 0.492 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8088889122009277
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.829 Test Loss: 0.498 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7257137298583984
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.513 Vali Acc: 0.836 Test Loss: 0.513 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.796393632888794
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.526 Vali Acc: 0.836 Test Loss: 0.526 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8314611911773682
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.551 Vali Acc: 0.842 Test Loss: 0.551 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7119488716125488
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.522 Vali Acc: 0.836 Test Loss: 0.522 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7931015491485596
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.624 Vali Acc: 0.849 Test Loss: 0.624 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8849701881408691
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.578 Vali Acc: 0.849 Test Loss: 0.578 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 22211332
model size : 99.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.648320198059082
Epoch: 1, Steps: 10 | Train Loss: 1.548 Vali Loss: 1.420 Vali Acc: 0.309 Test Loss: 1.420 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 0.9740333557128906
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.250 Vali Acc: 0.539 Test Loss: 1.250 Test Acc: 0.539
Validation loss decreased (-0.309196 --> -0.539461).  Saving model ...
Epoch: 3 cost time: 1.0033349990844727
Epoch: 3, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.069 Vali Acc: 0.645 Test Loss: 1.069 Test Acc: 0.645
Validation loss decreased (-0.539461 --> -0.644726).  Saving model ...
Epoch: 4 cost time: 0.8648707866668701
Epoch: 4, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.890 Vali Acc: 0.737 Test Loss: 0.890 Test Acc: 0.737
Validation loss decreased (-0.644726 --> -0.736833).  Saving model ...
Epoch: 5 cost time: 1.0409326553344727
Epoch: 5, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.728 Vali Acc: 0.757 Test Loss: 0.728 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 1.0044958591461182
Epoch: 6, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.2938799858093262
Epoch: 7, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.508 Vali Acc: 0.757 Test Loss: 0.508 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0294454097747803
Epoch: 8, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1264691352844238
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.311896800994873
Epoch: 10, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.0319478511810303
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0134093761444092
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.623 Vali Acc: 0.849 Test Loss: 0.623 Test Acc: 0.849
Validation loss decreased (-0.815784 --> -0.848678).  Saving model ...
Epoch: 13 cost time: 1.2179958820343018
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.776 Vali Acc: 0.842 Test Loss: 0.776 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9737370014190674
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3759374618530273
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.701 Vali Acc: 0.836 Test Loss: 0.701 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0545613765716553
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.686 Vali Acc: 0.842 Test Loss: 0.686 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9747867584228516
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.849 Test Loss: 0.731 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.311089277267456
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.803 Vali Acc: 0.849 Test Loss: 0.803 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0769097805023193
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.762 Vali Acc: 0.849 Test Loss: 0.762 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0657808780670166
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.836 Test Loss: 0.724 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9877190589904785
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.849 Test Loss: 0.773 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2839651107788086
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.849 Test Loss: 0.753 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 22285060
model size : 99.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1018447875976562
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.375 Vali Acc: 0.309 Test Loss: 1.375 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 0.9320118427276611
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.260 Vali Acc: 0.461 Test Loss: 1.260 Test Acc: 0.461
Validation loss decreased (-0.309197 --> -0.460514).  Saving model ...
Epoch: 3 cost time: 0.982196569442749
Epoch: 3, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
Validation loss decreased (-0.460514 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 0.7975649833679199
Epoch: 4, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.042 Vali Acc: 0.684 Test Loss: 1.042 Test Acc: 0.684
Validation loss decreased (-0.624988 --> -0.684200).  Saving model ...
Epoch: 5 cost time: 0.9607956409454346
Epoch: 5, Steps: 10 | Train Loss: 0.908 Vali Loss: 0.914 Vali Acc: 0.697 Test Loss: 0.914 Test Acc: 0.697
Validation loss decreased (-0.684200 --> -0.697359).  Saving model ...
Epoch: 6 cost time: 0.7830700874328613
Epoch: 6, Steps: 10 | Train Loss: 0.750 Vali Loss: 0.786 Vali Acc: 0.717 Test Loss: 0.786 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717097).  Saving model ...
Epoch: 7 cost time: 0.9215719699859619
Epoch: 7, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.717097 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 0.8618276119232178
Epoch: 8, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 0.7968285083770752
Epoch: 9, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.451 Vali Acc: 0.789 Test Loss: 0.451 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 10 cost time: 0.920079231262207
Epoch: 10, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809206).  Saving model ...
Epoch: 11 cost time: 0.8505308628082275
Epoch: 11, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.516 Vali Acc: 0.842 Test Loss: 0.516 Test Acc: 0.842
Validation loss decreased (-0.809206 --> -0.842100).  Saving model ...
Epoch: 12 cost time: 0.9534039497375488
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.437 Vali Acc: 0.836 Test Loss: 0.437 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8371415138244629
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.507 Vali Acc: 0.836 Test Loss: 0.507 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9657740592956543
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.497 Vali Acc: 0.842 Test Loss: 0.497 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 15 cost time: 0.8644883632659912
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.551 Vali Acc: 0.842 Test Loss: 0.551 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9276504516601562
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9328854084014893
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.541 Vali Acc: 0.842 Test Loss: 0.541 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8820862770080566
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.570 Vali Acc: 0.829 Test Loss: 0.570 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9378843307495117
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7879955768585205
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.842 Test Loss: 0.609 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0741767883300781
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.829 Test Loss: 0.591 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8671691417694092
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.628 Vali Acc: 0.842 Test Loss: 0.628 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8274250030517578
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.829 Test Loss: 0.613 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0232980251312256
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.842 Test Loss: 0.630 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 22220548
model size : 99.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3353424072265625
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.401 Vali Acc: 0.329 Test Loss: 1.401 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 0.7253665924072266
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.328 Vali Acc: 0.388 Test Loss: 1.328 Test Acc: 0.388
Validation loss decreased (-0.328933 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 0.7808525562286377
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.259 Vali Acc: 0.480 Test Loss: 1.259 Test Acc: 0.480
Validation loss decreased (-0.388145 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 0.7499632835388184
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.168 Vali Acc: 0.592 Test Loss: 1.168 Test Acc: 0.592
Validation loss decreased (-0.480251 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 0.7602138519287109
Epoch: 5, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.079 Vali Acc: 0.625 Test Loss: 1.079 Test Acc: 0.625
Validation loss decreased (-0.592094 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.7596621513366699
Epoch: 6, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.951 Vali Acc: 0.697 Test Loss: 0.951 Test Acc: 0.697
Validation loss decreased (-0.624989 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 0.7810449600219727
Epoch: 7, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.827 Vali Acc: 0.711 Test Loss: 0.827 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 0.840728759765625
Epoch: 8, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.689 Vali Acc: 0.737 Test Loss: 0.689 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 0.8011701107025146
Epoch: 9, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.7822368144989014
Epoch: 10, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.505 Vali Acc: 0.757 Test Loss: 0.505 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7999825477600098
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.469 Vali Acc: 0.796 Test Loss: 0.469 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796048).  Saving model ...
Epoch: 12 cost time: 0.7714014053344727
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.527 Vali Acc: 0.849 Test Loss: 0.527 Test Acc: 0.849
Validation loss decreased (-0.796048 --> -0.848679).  Saving model ...
Epoch: 13 cost time: 0.8603305816650391
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.462 Vali Acc: 0.789 Test Loss: 0.462 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7473115921020508
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.475 Vali Acc: 0.842 Test Loss: 0.475 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7553317546844482
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8100709915161133
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9192602634429932
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.519 Vali Acc: 0.836 Test Loss: 0.519 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.852705717086792
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.565 Vali Acc: 0.829 Test Loss: 0.565 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7745628356933594
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8475933074951172
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.576 Vali Acc: 0.836 Test Loss: 0.576 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.95111083984375
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.573 Vali Acc: 0.829 Test Loss: 0.573 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6963870525360107
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.829 Test Loss: 0.578 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 22202116
model size : 99.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.897611618041992
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.312 Vali Acc: 0.303 Test Loss: 1.312 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.2237038612365723
Epoch: 2, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.160 Vali Acc: 0.612 Test Loss: 1.160 Test Acc: 0.612
Validation loss decreased (-0.302618 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 1.3264544010162354
Epoch: 3, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.014 Vali Acc: 0.572 Test Loss: 1.014 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1170344352722168
Epoch: 4, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.819 Vali Acc: 0.743 Test Loss: 0.819 Test Acc: 0.743
Validation loss decreased (-0.611831 --> -0.743413).  Saving model ...
Epoch: 5 cost time: 1.0147523880004883
Epoch: 5, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 1.3245999813079834
Epoch: 6, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.0308995246887207
Epoch: 7, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809206).  Saving model ...
Epoch: 8 cost time: 1.3502755165100098
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.486 Vali Acc: 0.822 Test Loss: 0.486 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 9 cost time: 1.0378522872924805
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2146923542022705
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9836061000823975
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.589 Vali Acc: 0.849 Test Loss: 0.589 Test Acc: 0.849
Validation loss decreased (-0.822364 --> -0.848678).  Saving model ...
Epoch: 12 cost time: 0.7603087425231934
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.626 Vali Acc: 0.842 Test Loss: 0.626 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1979455947875977
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.687 Vali Acc: 0.842 Test Loss: 0.687 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0966696739196777
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.605 Vali Acc: 0.829 Test Loss: 0.605 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0937373638153076
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.771 Vali Acc: 0.855 Test Loss: 0.771 Test Acc: 0.855
Validation loss decreased (-0.848678 --> -0.855255).  Saving model ...
Epoch: 16 cost time: 0.8916475772857666
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.712 Vali Acc: 0.842 Test Loss: 0.712 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0047595500946045
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.723 Vali Acc: 0.836 Test Loss: 0.723 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9337112903594971
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.829 Vali Acc: 0.836 Test Loss: 0.829 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3102505207061768
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.724 Vali Acc: 0.862 Test Loss: 0.724 Test Acc: 0.862
Validation loss decreased (-0.855255 --> -0.861835).  Saving model ...
Epoch: 20 cost time: 0.7966620922088623
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.776 Vali Acc: 0.842 Test Loss: 0.776 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0565650463104248
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.774 Vali Acc: 0.849 Test Loss: 0.774 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.189727544784546
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.855 Test Loss: 0.734 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9560186862945557
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.849 Test Loss: 0.744 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9710447788238525
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.855 Test Loss: 0.743 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1628148555755615
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.849 Test Loss: 0.754 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8361902236938477
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.855 Test Loss: 0.735 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1290032863616943
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.855 Test Loss: 0.749 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9559726715087891
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.849 Test Loss: 0.780 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0762553215026855
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.849 Test Loss: 0.790 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 22294276
model size : 99.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.784405469894409
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.344 Vali Acc: 0.401 Test Loss: 1.344 Test Acc: 0.401
Validation loss decreased (inf --> -0.401302).  Saving model ...
Epoch: 2 cost time: 0.9175634384155273
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.278 Vali Acc: 0.336 Test Loss: 1.278 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8983683586120605
Epoch: 3, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.163 Vali Acc: 0.579 Test Loss: 1.163 Test Acc: 0.579
Validation loss decreased (-0.401302 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 0.8215205669403076
Epoch: 4, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.044 Vali Acc: 0.625 Test Loss: 1.044 Test Acc: 0.625
Validation loss decreased (-0.578936 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 0.9164607524871826
Epoch: 5, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.934 Vali Acc: 0.599 Test Loss: 0.934 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9679775238037109
Epoch: 6, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.785 Vali Acc: 0.697 Test Loss: 0.785 Test Acc: 0.697
Validation loss decreased (-0.624990 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 0.9571168422698975
Epoch: 7, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.657 Vali Acc: 0.724 Test Loss: 0.657 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723678).  Saving model ...
Epoch: 8 cost time: 0.8074805736541748
Epoch: 8, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.577 Vali Acc: 0.730 Test Loss: 0.577 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 0.8509848117828369
Epoch: 9, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
Validation loss decreased (-0.730257 --> -0.796048).  Saving model ...
Epoch: 10 cost time: 0.8301482200622559
Epoch: 10, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 0.8504123687744141
Epoch: 11, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.457 Vali Acc: 0.816 Test Loss: 0.457 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 12 cost time: 0.8214564323425293
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 13 cost time: 0.8051028251647949
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 14 cost time: 0.8334155082702637
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.565 Vali Acc: 0.842 Test Loss: 0.565 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 15 cost time: 0.8133580684661865
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8216004371643066
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.570 Vali Acc: 0.829 Test Loss: 0.570 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7831454277038574
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8536784648895264
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.598 Vali Acc: 0.829 Test Loss: 0.598 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.819575309753418
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8439512252807617
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8282978534698486
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.89170241355896
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.633 Vali Acc: 0.829 Test Loss: 0.633 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8564164638519287
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.816 Test Loss: 0.655 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8065948486328125
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.816 Test Loss: 0.678 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 22234372
model size : 99.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.655229330062866
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.368 Vali Acc: 0.303 Test Loss: 1.368 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.6729166507720947
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.318 Vali Acc: 0.368 Test Loss: 1.318 Test Acc: 0.368
Validation loss decreased (-0.302618 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 0.7653226852416992
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.258 Vali Acc: 0.513 Test Loss: 1.258 Test Acc: 0.513
Validation loss decreased (-0.368408 --> -0.513145).  Saving model ...
Epoch: 4 cost time: 0.6893010139465332
Epoch: 4, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.182 Vali Acc: 0.559 Test Loss: 1.182 Test Acc: 0.559
Validation loss decreased (-0.513145 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 0.7414488792419434
Epoch: 5, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.094 Vali Acc: 0.632 Test Loss: 1.094 Test Acc: 0.632
Validation loss decreased (-0.559199 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 0.7212252616882324
Epoch: 6, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.000 Vali Acc: 0.632 Test Loss: 1.000 Test Acc: 0.632
Validation loss decreased (-0.631568 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 0.7521092891693115
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.885 Vali Acc: 0.697 Test Loss: 0.885 Test Acc: 0.697
Validation loss decreased (-0.631569 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 0.6811025142669678
Epoch: 8, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.768 Vali Acc: 0.704 Test Loss: 0.768 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703940).  Saving model ...
Epoch: 9 cost time: 0.6975877285003662
Epoch: 9, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.642 Vali Acc: 0.743 Test Loss: 0.642 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 0.6981699466705322
Epoch: 10, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.611 Vali Acc: 0.704 Test Loss: 0.611 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8497016429901123
Epoch: 11, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
Validation loss decreased (-0.743415 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 0.7452113628387451
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.485 Vali Acc: 0.770 Test Loss: 0.485 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8171124458312988
Epoch: 13, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9434823989868164
Epoch: 14, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 0.8455345630645752
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8487715721130371
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7756218910217285
Epoch: 17, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.543 Vali Acc: 0.816 Test Loss: 0.543 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7424817085266113
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7839560508728027
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6700527667999268
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7786412239074707
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7633576393127441
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8331303596496582
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.689218282699585
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 22202116
model size : 99.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.107936143875122
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.422 Vali Acc: 0.263 Test Loss: 1.422 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.0064003467559814
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.329 Vali Acc: 0.408 Test Loss: 1.329 Test Acc: 0.408
Validation loss decreased (-0.263144 --> -0.407881).  Saving model ...
Epoch: 3 cost time: 0.8468270301818848
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.225 Vali Acc: 0.526 Test Loss: 1.225 Test Acc: 0.526
Validation loss decreased (-0.407881 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 0.8813676834106445
Epoch: 4, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.111 Vali Acc: 0.592 Test Loss: 1.111 Test Acc: 0.592
Validation loss decreased (-0.526304 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 1.0022788047790527
Epoch: 5, Steps: 10 | Train Loss: 0.947 Vali Loss: 0.999 Vali Acc: 0.625 Test Loss: 0.999 Test Acc: 0.625
Validation loss decreased (-0.592094 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.8339684009552002
Epoch: 6, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.907 Vali Acc: 0.651 Test Loss: 0.907 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 7 cost time: 0.9608750343322754
Epoch: 7, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.786 Vali Acc: 0.697 Test Loss: 0.786 Test Acc: 0.697
Validation loss decreased (-0.651307 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 0.7891366481781006
Epoch: 8, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.697361 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 0.8890502452850342
Epoch: 9, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.7978711128234863
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.0010817050933838
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.776310 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 0.7261307239532471
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.490 Vali Acc: 0.836 Test Loss: 0.490 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835521).  Saving model ...
Epoch: 13 cost time: 0.8148088455200195
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.695 Vali Acc: 0.842 Test Loss: 0.695 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842098).  Saving model ...
Epoch: 14 cost time: 0.7596690654754639
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9820904731750488
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
Validation loss decreased (-0.842098 --> -0.855257).  Saving model ...
Epoch: 16 cost time: 0.7372848987579346
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9736082553863525
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.725 Vali Acc: 0.849 Test Loss: 0.725 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9802689552307129
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8366806507110596
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.689 Vali Acc: 0.862 Test Loss: 0.689 Test Acc: 0.862
Validation loss decreased (-0.855257 --> -0.861835).  Saving model ...
Epoch: 20 cost time: 0.9513223171234131
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.842 Test Loss: 0.621 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8506684303283691
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.842 Test Loss: 0.663 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8945090770721436
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.829 Test Loss: 0.652 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9944460391998291
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.675 Vali Acc: 0.829 Test Loss: 0.675 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9055564403533936
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.829 Test Loss: 0.690 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.902256965637207
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9043831825256348
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.87221360206604
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8581056594848633
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.822 Test Loss: 0.725 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9684739112854004
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.822 Test Loss: 0.722 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 22243588
model size : 99.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7366344928741455
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.384 Vali Acc: 0.257 Test Loss: 1.384 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.9595205783843994
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.309 Vali Acc: 0.355 Test Loss: 1.309 Test Acc: 0.355
Validation loss decreased (-0.256565 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 0.8115146160125732
Epoch: 3, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.223 Vali Acc: 0.566 Test Loss: 1.223 Test Acc: 0.566
Validation loss decreased (-0.355250 --> -0.565777).  Saving model ...
Epoch: 4 cost time: 0.9986400604248047
Epoch: 4, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
Validation loss decreased (-0.565777 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.9608311653137207
Epoch: 5, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.050 Vali Acc: 0.612 Test Loss: 1.050 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8662335872650146
Epoch: 6, Steps: 10 | Train Loss: 0.893 Vali Loss: 0.940 Vali Acc: 0.651 Test Loss: 0.940 Test Acc: 0.651
Validation loss decreased (-0.624989 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 0.926572322845459
Epoch: 7, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.795 Vali Acc: 0.704 Test Loss: 0.795 Test Acc: 0.704
Validation loss decreased (-0.651306 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 0.9064574241638184
Epoch: 8, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 0.9469735622406006
Epoch: 9, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.584 Vali Acc: 0.730 Test Loss: 0.584 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 10 cost time: 0.8657269477844238
Epoch: 10, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.501 Vali Acc: 0.770 Test Loss: 0.501 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769732).  Saving model ...
Epoch: 11 cost time: 0.865246057510376
Epoch: 11, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 12 cost time: 0.9378609657287598
Epoch: 12, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
Validation loss decreased (-0.782890 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 0.7874765396118164
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.490 Vali Acc: 0.842 Test Loss: 0.490 Test Acc: 0.842
Validation loss decreased (-0.815785 --> -0.842100).  Saving model ...
Epoch: 14 cost time: 0.793616771697998
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.497 Vali Acc: 0.842 Test Loss: 0.497 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7138652801513672
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7426795959472656
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.739513635635376
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8515276908874512
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8700439929962158
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8463344573974609
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.627 Vali Acc: 0.829 Test Loss: 0.627 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.85784912109375
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.603 Vali Acc: 0.809 Test Loss: 0.603 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8086626529693604
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8613381385803223
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 22225156
model size : 99.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0296082496643066
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.359 Vali Acc: 0.303 Test Loss: 1.359 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.8002574443817139
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.317 Vali Acc: 0.362 Test Loss: 1.317 Test Acc: 0.362
Validation loss decreased (-0.302618 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 0.7250301837921143
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.254 Vali Acc: 0.513 Test Loss: 1.254 Test Acc: 0.513
Validation loss decreased (-0.361829 --> -0.513145).  Saving model ...
Epoch: 4 cost time: 0.8353238105773926
Epoch: 4, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.190 Vali Acc: 0.599 Test Loss: 1.190 Test Acc: 0.599
Validation loss decreased (-0.513145 --> -0.598672).  Saving model ...
Epoch: 5 cost time: 0.7665698528289795
Epoch: 5, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.122 Vali Acc: 0.612 Test Loss: 1.122 Test Acc: 0.612
Validation loss decreased (-0.598672 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 0.7218549251556396
Epoch: 6, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.057 Vali Acc: 0.625 Test Loss: 1.057 Test Acc: 0.625
Validation loss decreased (-0.611831 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.7962315082550049
Epoch: 7, Steps: 10 | Train Loss: 0.966 Vali Loss: 0.983 Vali Acc: 0.651 Test Loss: 0.983 Test Acc: 0.651
Validation loss decreased (-0.624989 --> -0.651306).  Saving model ...
Epoch: 8 cost time: 0.6480591297149658
Epoch: 8, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.853 Vali Acc: 0.717 Test Loss: 0.853 Test Acc: 0.717
Validation loss decreased (-0.651306 --> -0.717097).  Saving model ...
Epoch: 9 cost time: 0.8359787464141846
Epoch: 9, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.762 Vali Acc: 0.724 Test Loss: 0.762 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 0.8561477661132812
Epoch: 10, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.653 Vali Acc: 0.724 Test Loss: 0.653 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 11 cost time: 0.9086227416992188
Epoch: 11, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.597 Vali Acc: 0.770 Test Loss: 0.597 Test Acc: 0.770
Validation loss decreased (-0.723678 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 0.7721915245056152
Epoch: 12, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 0.8525581359863281
Epoch: 13, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809206).  Saving model ...
Epoch: 14 cost time: 0.7276344299316406
Epoch: 14, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6283526420593262
Epoch: 15, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.815636157989502
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7640824317932129
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6484174728393555
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7555131912231445
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822363).  Saving model ...
Epoch: 20 cost time: 0.793187141418457
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7521183490753174
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7606613636016846
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8383679389953613
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.598 Vali Acc: 0.816 Test Loss: 0.598 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8355989456176758
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8830516338348389
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8521981239318848
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.816 Test Loss: 0.634 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8743398189544678
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6888763904571533
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7335629463195801
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 22211332
model size : 99.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.941295862197876
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.435 Vali Acc: 0.296 Test Loss: 1.435 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 0.8356578350067139
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.345 Vali Acc: 0.303 Test Loss: 1.345 Test Acc: 0.303
Validation loss decreased (-0.296038 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 0.7379546165466309
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.238 Vali Acc: 0.533 Test Loss: 1.238 Test Acc: 0.533
Validation loss decreased (-0.302618 --> -0.532882).  Saving model ...
Epoch: 4 cost time: 0.8530662059783936
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.127 Vali Acc: 0.618 Test Loss: 1.127 Test Acc: 0.618
Validation loss decreased (-0.532882 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 0.7745814323425293
Epoch: 5, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.019 Vali Acc: 0.592 Test Loss: 1.019 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8130478858947754
Epoch: 6, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.902 Vali Acc: 0.678 Test Loss: 0.902 Test Acc: 0.678
Validation loss decreased (-0.618410 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 0.9910862445831299
Epoch: 7, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.741 Vali Acc: 0.737 Test Loss: 0.741 Test Acc: 0.737
Validation loss decreased (-0.677623 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 0.7270119190216064
Epoch: 8, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 0.8866093158721924
Epoch: 9, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.736836 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 0.7365107536315918
Epoch: 10, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.488 Vali Acc: 0.789 Test Loss: 0.488 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 11 cost time: 0.852515459060669
Epoch: 11, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
Validation loss decreased (-0.789469 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 0.8084762096405029
Epoch: 12, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6639256477355957
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.031646490097046
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9536540508270264
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8529691696166992
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9415514469146729
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.713 Vali Acc: 0.829 Test Loss: 0.713 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828940).  Saving model ...
Epoch: 18 cost time: 0.9396147727966309
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6746242046356201
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.801 Vali Acc: 0.816 Test Loss: 0.801 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8993504047393799
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7991979122161865
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.725 Vali Acc: 0.796 Test Loss: 0.725 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7023229598999023
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.798 Vali Acc: 0.822 Test Loss: 0.798 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8813717365264893
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.796 Test Loss: 0.757 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.779127836227417
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.759 Vali Acc: 0.803 Test Loss: 0.759 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7045590877532959
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.816 Test Loss: 0.799 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8308532238006592
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.803 Vali Acc: 0.809 Test Loss: 0.803 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8325116634368896
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 22257412
model size : 99.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5537774562835693
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.428 Vali Acc: 0.230 Test Loss: 1.428 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 0.7528419494628906
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.340 Vali Acc: 0.349 Test Loss: 1.340 Test Acc: 0.349
Validation loss decreased (-0.230249 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.9131264686584473
Epoch: 3, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.263 Vali Acc: 0.421 Test Loss: 1.263 Test Acc: 0.421
Validation loss decreased (-0.348671 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 0.8439078330993652
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.182 Vali Acc: 0.474 Test Loss: 1.182 Test Acc: 0.474
Validation loss decreased (-0.421040 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 0.7853903770446777
Epoch: 5, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.074 Vali Acc: 0.599 Test Loss: 1.074 Test Acc: 0.599
Validation loss decreased (-0.473672 --> -0.598673).  Saving model ...
Epoch: 6 cost time: 0.8447999954223633
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.965 Vali Acc: 0.638 Test Loss: 0.965 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 0.7751710414886475
Epoch: 7, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.851 Vali Acc: 0.645 Test Loss: 0.851 Test Acc: 0.645
Validation loss decreased (-0.638148 --> -0.644728).  Saving model ...
Epoch: 8 cost time: 0.7357876300811768
Epoch: 8, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
Validation loss decreased (-0.644728 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 0.7760570049285889
Epoch: 9, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
Validation loss decreased (-0.717098 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 0.7028851509094238
Epoch: 10, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 0.6661524772644043
Epoch: 11, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 0.7886099815368652
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 0.7565486431121826
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822362).  Saving model ...
Epoch: 14 cost time: 0.7653803825378418
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8218538761138916
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.651 Vali Acc: 0.836 Test Loss: 0.651 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 16 cost time: 0.880922794342041
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8457753658294678
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.648 Vali Acc: 0.816 Test Loss: 0.648 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7086038589477539
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.650 Vali Acc: 0.816 Test Loss: 0.650 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7643041610717773
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.672 Vali Acc: 0.816 Test Loss: 0.672 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7768826484680176
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.696 Vali Acc: 0.816 Test Loss: 0.696 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7133359909057617
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7739622592926025
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.720 Vali Acc: 0.816 Test Loss: 0.720 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6984162330627441
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.816 Test Loss: 0.736 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7467703819274902
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.743 Vali Acc: 0.816 Test Loss: 0.743 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8368017673492432
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.816 Test Loss: 0.754 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 22238980
model size : 99.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.518238067626953
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.408 Vali Acc: 0.263 Test Loss: 1.408 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 0.7127213478088379
Epoch: 2, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.368 Vali Acc: 0.316 Test Loss: 1.368 Test Acc: 0.316
Validation loss decreased (-0.263144 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 0.66373610496521
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.316 Vali Acc: 0.395 Test Loss: 1.316 Test Acc: 0.395
Validation loss decreased (-0.315776 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 0.8228743076324463
Epoch: 4, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
Validation loss decreased (-0.394724 --> -0.519724).  Saving model ...
Epoch: 5 cost time: 0.8149466514587402
Epoch: 5, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.191 Vali Acc: 0.559 Test Loss: 1.191 Test Acc: 0.559
Validation loss decreased (-0.519724 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 0.857295036315918
Epoch: 6, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.125 Vali Acc: 0.566 Test Loss: 1.125 Test Acc: 0.566
Validation loss decreased (-0.559199 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 0.7900850772857666
Epoch: 7, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.034 Vali Acc: 0.651 Test Loss: 1.034 Test Acc: 0.651
Validation loss decreased (-0.565778 --> -0.651305).  Saving model ...
Epoch: 8 cost time: 0.7898259162902832
Epoch: 8, Steps: 10 | Train Loss: 0.884 Vali Loss: 0.918 Vali Acc: 0.684 Test Loss: 0.918 Test Acc: 0.684
Validation loss decreased (-0.651305 --> -0.684201).  Saving model ...
Epoch: 9 cost time: 0.7035043239593506
Epoch: 9, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.789 Vali Acc: 0.711 Test Loss: 0.789 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 0.820106029510498
Epoch: 10, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 0.8092999458312988
Epoch: 11, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
Validation loss decreased (-0.736836 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 0.7655990123748779
Epoch: 12, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 0.8113465309143066
Epoch: 13, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 0.8212308883666992
Epoch: 14, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.736330509185791
Epoch: 15, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
Validation loss decreased (-0.796048 --> -0.822364).  Saving model ...
Epoch: 16 cost time: 0.7381224632263184
Epoch: 16, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9366333484649658
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9159431457519531
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6978955268859863
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9602851867675781
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9083948135375977
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8218517303466797
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8437247276306152
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8439087867736816
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8222763538360596
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_GPT4TS_UEA_ftM_sl30_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 22220548
model size : 99.43MB
