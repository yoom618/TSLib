Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.639801025390625
Epoch: 1, Steps: 8 | Train Loss: 2.188 Vali Loss: 1.887 Vali Acc: 0.334 Test Loss: 1.887 Test Acc: 0.334
Validation loss decreased (inf --> -0.334356).  Saving model ...
Epoch: 2 cost time: 1.7981581687927246
Epoch: 2, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.273 Vali Acc: 0.688 Test Loss: 1.273 Test Acc: 0.688
Validation loss decreased (-0.334356 --> -0.687487).  Saving model ...
Epoch: 3 cost time: 2.1941161155700684
Epoch: 3, Steps: 8 | Train Loss: 1.030 Vali Loss: 0.784 Vali Acc: 0.781 Test Loss: 0.784 Test Acc: 0.781
Validation loss decreased (-0.687487 --> -0.781242).  Saving model ...
Epoch: 4 cost time: 2.0711934566497803
Epoch: 4, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
Validation loss decreased (-0.781242 --> -0.812494).  Saving model ...
Epoch: 5 cost time: 2.047952175140381
Epoch: 5, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 2.2889082431793213
Epoch: 6, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843744).  Saving model ...
Epoch: 7 cost time: 2.0111992359161377
Epoch: 7, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.740 Vali Acc: 0.834 Test Loss: 0.740 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.156118392944336
Epoch: 8, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.921 Vali Acc: 0.834 Test Loss: 0.921 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0636348724365234
Epoch: 9, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.127 Vali Acc: 0.812 Test Loss: 1.127 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9904751777648926
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.006 Vali Acc: 0.825 Test Loss: 1.006 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.053039789199829
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.520 Vali Acc: 0.806 Test Loss: 1.520 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8940002918243408
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.722 Vali Acc: 0.787 Test Loss: 1.722 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3651831150054932
Epoch: 13, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.731 Vali Acc: 0.831 Test Loss: 1.731 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8116576671600342
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.599 Vali Acc: 0.828 Test Loss: 1.599 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1640501022338867
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.003 Vali Acc: 0.812 Test Loss: 2.003 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1111230850219727
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.776 Vali Acc: 0.828 Test Loss: 1.776 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 44054792
model size : 182.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0954935550689697
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 1.979 Vali Acc: 0.319 Test Loss: 1.979 Test Acc: 0.319
Validation loss decreased (inf --> -0.318730).  Saving model ...
Epoch: 2 cost time: 1.7137277126312256
Epoch: 2, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.551 Vali Acc: 0.681 Test Loss: 1.551 Test Acc: 0.681
Validation loss decreased (-0.318730 --> -0.681234).  Saving model ...
Epoch: 3 cost time: 1.8871464729309082
Epoch: 3, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.097 Vali Acc: 0.762 Test Loss: 1.097 Test Acc: 0.762
Validation loss decreased (-0.681234 --> -0.762489).  Saving model ...
Epoch: 4 cost time: 1.7327368259429932
Epoch: 4, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.746 Vali Acc: 0.816 Test Loss: 0.746 Test Acc: 0.816
Validation loss decreased (-0.762489 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 1.821930170059204
Epoch: 5, Steps: 8 | Train Loss: 0.529 Vali Loss: 0.572 Vali Acc: 0.819 Test Loss: 0.572 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 1.7315773963928223
Epoch: 6, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 1.6032655239105225
Epoch: 7, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.570 Vali Acc: 0.834 Test Loss: 0.570 Test Acc: 0.834
Validation loss decreased (-0.818745 --> -0.834369).  Saving model ...
Epoch: 8 cost time: 1.6272978782653809
Epoch: 8, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.648 Vali Acc: 0.838 Test Loss: 0.648 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 9 cost time: 2.012695550918579
Epoch: 9, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.667 Vali Acc: 0.838 Test Loss: 0.667 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5009350776672363
Epoch: 10, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.136 Vali Acc: 0.819 Test Loss: 1.136 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3656928539276123
Epoch: 11, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.183 Vali Acc: 0.812 Test Loss: 1.183 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2802083492279053
Epoch: 12, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.233 Vali Acc: 0.825 Test Loss: 1.233 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4256479740142822
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.142 Vali Acc: 0.841 Test Loss: 1.142 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840614).  Saving model ...
Epoch: 14 cost time: 1.4958739280700684
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.469 Vali Acc: 0.797 Test Loss: 1.469 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4221179485321045
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.323 Vali Acc: 0.822 Test Loss: 1.323 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.457000732421875
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.234 Vali Acc: 0.844 Test Loss: 1.234 Test Acc: 0.844
Validation loss decreased (-0.840614 --> -0.843738).  Saving model ...
Epoch: 17 cost time: 1.4952630996704102
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.425 Vali Acc: 0.822 Test Loss: 1.425 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3454580307006836
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.508 Vali Acc: 0.816 Test Loss: 1.508 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.605292558670044
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.819 Test Loss: 1.482 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3960938453674316
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.822 Test Loss: 1.421 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.704284906387329
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.825 Test Loss: 1.385 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.667733907699585
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.831 Test Loss: 1.363 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6094706058502197
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.834 Test Loss: 1.379 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6205108165740967
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.838 Test Loss: 1.392 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4994511604309082
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.838 Test Loss: 1.403 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4789376258850098
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.841 Test Loss: 1.407 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 43809032
model size : 181.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0748794078826904
Epoch: 1, Steps: 8 | Train Loss: 2.177 Vali Loss: 2.045 Vali Acc: 0.225 Test Loss: 2.045 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 1.3091211318969727
Epoch: 2, Steps: 8 | Train Loss: 1.946 Vali Loss: 1.752 Vali Acc: 0.547 Test Loss: 1.752 Test Acc: 0.547
Validation loss decreased (-0.224980 --> -0.546857).  Saving model ...
Epoch: 3 cost time: 0.8568754196166992
Epoch: 3, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.371 Vali Acc: 0.731 Test Loss: 1.371 Test Acc: 0.731
Validation loss decreased (-0.546857 --> -0.731236).  Saving model ...
Epoch: 4 cost time: 1.2990100383758545
Epoch: 4, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.012 Vali Acc: 0.775 Test Loss: 1.012 Test Acc: 0.775
Validation loss decreased (-0.731236 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 1.325535535812378
Epoch: 5, Steps: 8 | Train Loss: 0.828 Vali Loss: 0.728 Vali Acc: 0.797 Test Loss: 0.728 Test Acc: 0.797
Validation loss decreased (-0.774990 --> -0.796868).  Saving model ...
Epoch: 6 cost time: 1.7226283550262451
Epoch: 6, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.796868 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 1.5991642475128174
Epoch: 7, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4096086025238037
Epoch: 8, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6657140254974365
Epoch: 9, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.654 Vali Acc: 0.825 Test Loss: 0.654 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3403010368347168
Epoch: 10, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.599 Vali Acc: 0.869 Test Loss: 0.599 Test Acc: 0.869
Validation loss decreased (-0.831245 --> -0.868744).  Saving model ...
Epoch: 11 cost time: 0.6021699905395508
Epoch: 11, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.687 Vali Acc: 0.872 Test Loss: 0.687 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871868).  Saving model ...
Epoch: 12 cost time: 0.6533465385437012
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.950 Vali Acc: 0.812 Test Loss: 0.950 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.376086711883545
Epoch: 13, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.833 Vali Acc: 0.847 Test Loss: 0.833 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3836381435394287
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.763 Vali Acc: 0.878 Test Loss: 0.763 Test Acc: 0.878
Validation loss decreased (-0.871868 --> -0.878117).  Saving model ...
Epoch: 15 cost time: 1.5906507968902588
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.864 Vali Acc: 0.841 Test Loss: 0.864 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5427978038787842
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.875 Vali Acc: 0.850 Test Loss: 0.875 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0536243915557861
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.927 Vali Acc: 0.844 Test Loss: 0.927 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6845753192901611
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.039 Vali Acc: 0.844 Test Loss: 1.039 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.495664119720459
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.960 Vali Acc: 0.853 Test Loss: 0.960 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.373927354812622
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.971 Vali Acc: 0.844 Test Loss: 0.971 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4301161766052246
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.017 Vali Acc: 0.834 Test Loss: 1.017 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1177127361297607
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.061 Vali Acc: 0.844 Test Loss: 1.061 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4307847023010254
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.847 Test Loss: 1.102 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2769842147827148
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.844 Test Loss: 1.034 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 43655432
model size : 181.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4744081497192383
Epoch: 1, Steps: 8 | Train Loss: 2.146 Vali Loss: 1.873 Vali Acc: 0.338 Test Loss: 1.873 Test Acc: 0.338
Validation loss decreased (inf --> -0.337481).  Saving model ...
Epoch: 2 cost time: 1.9336881637573242
Epoch: 2, Steps: 8 | Train Loss: 1.684 Vali Loss: 1.236 Vali Acc: 0.697 Test Loss: 1.236 Test Acc: 0.697
Validation loss decreased (-0.337481 --> -0.696863).  Saving model ...
Epoch: 3 cost time: 1.8572747707366943
Epoch: 3, Steps: 8 | Train Loss: 1.015 Vali Loss: 0.744 Vali Acc: 0.794 Test Loss: 0.744 Test Acc: 0.794
Validation loss decreased (-0.696863 --> -0.793743).  Saving model ...
Epoch: 4 cost time: 1.9920070171356201
Epoch: 4, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812495).  Saving model ...
Epoch: 5 cost time: 2.1584599018096924
Epoch: 5, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
Validation loss decreased (-0.812495 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 2.003917932510376
Epoch: 6, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.915083646774292
Epoch: 7, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.611 Vali Acc: 0.859 Test Loss: 0.611 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 8 cost time: 2.191455125808716
Epoch: 8, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.666 Vali Acc: 0.847 Test Loss: 0.666 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4911816120147705
Epoch: 9, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.836 Vali Acc: 0.838 Test Loss: 0.836 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5627989768981934
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.082 Vali Acc: 0.825 Test Loss: 1.082 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2718698978424072
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.215 Vali Acc: 0.831 Test Loss: 1.215 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5300812721252441
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.390 Vali Acc: 0.828 Test Loss: 1.390 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6361830234527588
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.491 Vali Acc: 0.819 Test Loss: 1.491 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.576197862625122
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.312 Vali Acc: 0.841 Test Loss: 1.312 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.60337233543396
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.310 Vali Acc: 0.850 Test Loss: 1.310 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6020755767822266
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.228 Vali Acc: 0.838 Test Loss: 1.228 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9384784698486328
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.931 Vali Acc: 0.828 Test Loss: 1.931 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 44061704
model size : 182.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3099939823150635
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 1.921 Vali Acc: 0.338 Test Loss: 1.921 Test Acc: 0.338
Validation loss decreased (inf --> -0.337481).  Saving model ...
Epoch: 2 cost time: 1.599595069885254
Epoch: 2, Steps: 8 | Train Loss: 1.780 Vali Loss: 1.448 Vali Acc: 0.709 Test Loss: 1.448 Test Acc: 0.709
Validation loss decreased (-0.337481 --> -0.709361).  Saving model ...
Epoch: 3 cost time: 1.5386481285095215
Epoch: 3, Steps: 8 | Train Loss: 1.261 Vali Loss: 0.961 Vali Acc: 0.791 Test Loss: 0.961 Test Acc: 0.791
Validation loss decreased (-0.709361 --> -0.790615).  Saving model ...
Epoch: 4 cost time: 1.6812841892242432
Epoch: 4, Steps: 8 | Train Loss: 0.820 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.790615 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 1.4174206256866455
Epoch: 5, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.901658296585083
Epoch: 6, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8685846328735352
Epoch: 7, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.573 Vali Acc: 0.859 Test Loss: 0.573 Test Acc: 0.859
Validation loss decreased (-0.849994 --> -0.859369).  Saving model ...
Epoch: 8 cost time: 1.7086803913116455
Epoch: 8, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.719 Vali Acc: 0.819 Test Loss: 0.719 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7291383743286133
Epoch: 9, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.740 Vali Acc: 0.847 Test Loss: 0.740 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6388301849365234
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6428325176239014
Epoch: 11, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.004 Vali Acc: 0.803 Test Loss: 1.004 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6666324138641357
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.999 Vali Acc: 0.834 Test Loss: 0.999 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6543354988098145
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.954 Vali Acc: 0.863 Test Loss: 0.954 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862490).  Saving model ...
Epoch: 14 cost time: 1.8251452445983887
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.973 Vali Acc: 0.859 Test Loss: 0.973 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.940169334411621
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.114 Vali Acc: 0.853 Test Loss: 1.114 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7983174324035645
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.093 Vali Acc: 0.841 Test Loss: 1.093 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9363574981689453
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.019 Vali Acc: 0.850 Test Loss: 1.019 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9729704856872559
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.856 Test Loss: 1.009 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8805274963378906
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.134 Vali Acc: 0.853 Test Loss: 1.134 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3525309562683105
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.325 Vali Acc: 0.834 Test Loss: 1.325 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1074001789093018
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.257 Vali Acc: 0.828 Test Loss: 1.257 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8637521266937256
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.245 Vali Acc: 0.822 Test Loss: 1.245 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2425897121429443
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.335 Vali Acc: 0.825 Test Loss: 1.335 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 43815944
model size : 181.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1057288646698
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 2.001 Vali Acc: 0.269 Test Loss: 2.001 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 1.1947968006134033
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.723 Vali Acc: 0.616 Test Loss: 1.723 Test Acc: 0.616
Validation loss decreased (-0.268730 --> -0.615608).  Saving model ...
Epoch: 3 cost time: 1.36277437210083
Epoch: 3, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.348 Vali Acc: 0.759 Test Loss: 1.348 Test Acc: 0.759
Validation loss decreased (-0.615608 --> -0.759362).  Saving model ...
Epoch: 4 cost time: 1.2049574851989746
Epoch: 4, Steps: 8 | Train Loss: 1.193 Vali Loss: 0.964 Vali Acc: 0.844 Test Loss: 0.964 Test Acc: 0.844
Validation loss decreased (-0.759362 --> -0.843740).  Saving model ...
Epoch: 5 cost time: 1.09663724899292
Epoch: 5, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.665 Vali Acc: 0.822 Test Loss: 0.665 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2735133171081543
Epoch: 6, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1575100421905518
Epoch: 7, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.455 Vali Acc: 0.834 Test Loss: 0.455 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3220305442810059
Epoch: 8, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.493 Vali Acc: 0.831 Test Loss: 0.493 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3042936325073242
Epoch: 9, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.843740 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.2665748596191406
Epoch: 10, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856244).  Saving model ...
Epoch: 11 cost time: 1.409630537033081
Epoch: 11, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.688 Vali Acc: 0.853 Test Loss: 0.688 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3369543552398682
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.661 Vali Acc: 0.847 Test Loss: 0.661 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.294212818145752
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.775 Vali Acc: 0.844 Test Loss: 0.775 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.369297742843628
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.739 Vali Acc: 0.866 Test Loss: 0.739 Test Acc: 0.866
Validation loss decreased (-0.856244 --> -0.865618).  Saving model ...
Epoch: 15 cost time: 1.06998610496521
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.765 Vali Acc: 0.866 Test Loss: 0.765 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9044754505157471
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.839 Vali Acc: 0.841 Test Loss: 0.839 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8926870822906494
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.934 Vali Acc: 0.834 Test Loss: 0.934 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8684017658233643
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.879 Vali Acc: 0.847 Test Loss: 0.879 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0270633697509766
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.094 Vali Acc: 0.816 Test Loss: 1.094 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6247880458831787
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.886 Vali Acc: 0.859 Test Loss: 0.886 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3020837306976318
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.935 Vali Acc: 0.863 Test Loss: 0.935 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5121304988861084
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.941 Vali Acc: 0.859 Test Loss: 0.941 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5872015953063965
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.844 Test Loss: 0.973 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5339934825897217
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.973 Vali Acc: 0.844 Test Loss: 0.973 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 43646984
model size : 181.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4731826782226562
Epoch: 1, Steps: 8 | Train Loss: 2.196 Vali Loss: 1.912 Vali Acc: 0.362 Test Loss: 1.912 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 1.8618507385253906
Epoch: 2, Steps: 8 | Train Loss: 1.676 Vali Loss: 1.287 Vali Acc: 0.781 Test Loss: 1.287 Test Acc: 0.781
Validation loss decreased (-0.362481 --> -0.781237).  Saving model ...
Epoch: 3 cost time: 1.6472077369689941
Epoch: 3, Steps: 8 | Train Loss: 1.060 Vali Loss: 0.776 Vali Acc: 0.819 Test Loss: 0.776 Test Acc: 0.819
Validation loss decreased (-0.781237 --> -0.818742).  Saving model ...
Epoch: 4 cost time: 1.8040945529937744
Epoch: 4, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.818742 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.707082986831665
Epoch: 5, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5148541927337646
Epoch: 6, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 7 cost time: 1.962066650390625
Epoch: 7, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1451754570007324
Epoch: 8, Steps: 8 | Train Loss: 0.192 Vali Loss: 0.753 Vali Acc: 0.847 Test Loss: 0.753 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846867).  Saving model ...
Epoch: 9 cost time: 1.9428272247314453
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.998 Vali Acc: 0.816 Test Loss: 0.998 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5592176914215088
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.317 Vali Acc: 0.809 Test Loss: 1.317 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0884459018707275
Epoch: 11, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.094 Vali Acc: 0.853 Test Loss: 1.094 Test Acc: 0.853
Validation loss decreased (-0.846867 --> -0.853114).  Saving model ...
Epoch: 12 cost time: 1.874725103378296
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.300 Vali Acc: 0.844 Test Loss: 1.300 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.12398362159729
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.085 Vali Acc: 0.841 Test Loss: 1.085 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.070889949798584
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.638 Vali Acc: 0.819 Test Loss: 1.638 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6134963035583496
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.788 Vali Acc: 0.834 Test Loss: 1.788 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3024470806121826
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.198 Vali Acc: 0.772 Test Loss: 2.198 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0209994316101074
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.640 Vali Acc: 0.834 Test Loss: 1.640 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.958099365234375
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.844 Test Loss: 1.779 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9120526313781738
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.998 Vali Acc: 0.850 Test Loss: 1.998 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8699214458465576
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.026 Vali Acc: 0.856 Test Loss: 2.026 Test Acc: 0.856
Validation loss decreased (-0.853114 --> -0.856230).  Saving model ...
Epoch: 21 cost time: 1.7910950183868408
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.847 Test Loss: 1.928 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.849134922027588
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.834 Test Loss: 1.895 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.945619821548462
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.834 Test Loss: 1.839 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7414178848266602
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.841 Test Loss: 1.764 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9794182777404785
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.841 Test Loss: 1.734 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8587324619293213
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.841 Test Loss: 1.732 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9408740997314453
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.841 Test Loss: 1.744 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.148688554763794
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.838 Test Loss: 1.757 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9941580295562744
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.838 Test Loss: 1.767 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7650511264801025
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.834 Test Loss: 1.776 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 44068616
model size : 182.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6484005451202393
Epoch: 1, Steps: 8 | Train Loss: 2.118 Vali Loss: 1.941 Vali Acc: 0.325 Test Loss: 1.941 Test Acc: 0.325
Validation loss decreased (inf --> -0.324981).  Saving model ...
Epoch: 2 cost time: 1.0395963191986084
Epoch: 2, Steps: 8 | Train Loss: 1.847 Vali Loss: 1.547 Vali Acc: 0.672 Test Loss: 1.547 Test Acc: 0.672
Validation loss decreased (-0.324981 --> -0.671860).  Saving model ...
Epoch: 3 cost time: 1.2539246082305908
Epoch: 3, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.097 Vali Acc: 0.794 Test Loss: 1.097 Test Acc: 0.794
Validation loss decreased (-0.671860 --> -0.793739).  Saving model ...
Epoch: 4 cost time: 1.1210007667541504
Epoch: 4, Steps: 8 | Train Loss: 0.923 Vali Loss: 0.720 Vali Acc: 0.825 Test Loss: 0.720 Test Acc: 0.825
Validation loss decreased (-0.793739 --> -0.824993).  Saving model ...
Epoch: 5 cost time: 1.5096940994262695
Epoch: 5, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.1845338344573975
Epoch: 6, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3777565956115723
Epoch: 7, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.530 Vali Acc: 0.841 Test Loss: 0.530 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 1.418858289718628
Epoch: 8, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.772 Vali Acc: 0.812 Test Loss: 0.772 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4540998935699463
Epoch: 9, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.767 Vali Acc: 0.819 Test Loss: 0.767 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3202886581420898
Epoch: 10, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.914 Vali Acc: 0.831 Test Loss: 0.914 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0632691383361816
Epoch: 11, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.947 Vali Acc: 0.834 Test Loss: 0.947 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2854955196380615
Epoch: 12, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.112 Vali Acc: 0.828 Test Loss: 1.112 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2802932262420654
Epoch: 13, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.148 Vali Acc: 0.809 Test Loss: 1.148 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9936885833740234
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.994 Vali Acc: 0.838 Test Loss: 0.994 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.208848476409912
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.985 Vali Acc: 0.838 Test Loss: 0.985 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1083106994628906
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.043 Vali Acc: 0.850 Test Loss: 1.043 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849990).  Saving model ...
Epoch: 17 cost time: 1.0430197715759277
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.108 Vali Acc: 0.847 Test Loss: 1.108 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1744019985198975
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.288 Vali Acc: 0.825 Test Loss: 1.288 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1164748668670654
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.819 Test Loss: 1.376 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3680601119995117
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.831 Test Loss: 1.387 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0978221893310547
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.374 Vali Acc: 0.828 Test Loss: 1.374 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9927787780761719
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.314 Vali Acc: 0.819 Test Loss: 1.314 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.007765531539917
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.237 Vali Acc: 0.822 Test Loss: 1.237 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0160102844238281
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.241 Vali Acc: 0.822 Test Loss: 1.241 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.322075605392456
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.375 Vali Acc: 0.816 Test Loss: 1.375 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0119287967681885
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.803 Test Loss: 1.464 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 43776776
model size : 181.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6417837142944336
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 2.018 Vali Acc: 0.172 Test Loss: 2.018 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 1.3230855464935303
Epoch: 2, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.779 Vali Acc: 0.537 Test Loss: 1.779 Test Acc: 0.537
Validation loss decreased (-0.171855 --> -0.537482).  Saving model ...
Epoch: 3 cost time: 1.1145496368408203
Epoch: 3, Steps: 8 | Train Loss: 1.666 Vali Loss: 1.440 Vali Acc: 0.756 Test Loss: 1.440 Test Acc: 0.756
Validation loss decreased (-0.537482 --> -0.756236).  Saving model ...
Epoch: 4 cost time: 1.2947468757629395
Epoch: 4, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.047 Vali Acc: 0.812 Test Loss: 1.047 Test Acc: 0.812
Validation loss decreased (-0.756236 --> -0.812490).  Saving model ...
Epoch: 5 cost time: 1.245253562927246
Epoch: 5, Steps: 8 | Train Loss: 0.939 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.252579927444458
Epoch: 6, Steps: 8 | Train Loss: 0.650 Vali Loss: 0.517 Vali Acc: 0.847 Test Loss: 0.517 Test Acc: 0.847
Validation loss decreased (-0.812490 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.1296017169952393
Epoch: 7, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.0512330532073975
Epoch: 8, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8999466896057129
Epoch: 9, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8521695137023926
Epoch: 10, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.652 Vali Acc: 0.847 Test Loss: 0.652 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7977168560028076
Epoch: 11, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8486225605010986
Epoch: 12, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.742 Vali Acc: 0.847 Test Loss: 0.742 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8944132328033447
Epoch: 13, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.729 Vali Acc: 0.853 Test Loss: 0.729 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853118).  Saving model ...
Epoch: 14 cost time: 1.1850924491882324
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.693 Vali Acc: 0.863 Test Loss: 0.693 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862493).  Saving model ...
Epoch: 15 cost time: 0.9978139400482178
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.712 Vali Acc: 0.866 Test Loss: 0.712 Test Acc: 0.866
Validation loss decreased (-0.862493 --> -0.865618).  Saving model ...
Epoch: 16 cost time: 1.475259780883789
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.859 Vali Acc: 0.847 Test Loss: 0.859 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.353315830230713
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.871 Vali Acc: 0.853 Test Loss: 0.871 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.541689157485962
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.827 Vali Acc: 0.859 Test Loss: 0.827 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6228652000427246
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.832 Vali Acc: 0.869 Test Loss: 0.832 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868742).  Saving model ...
Epoch: 20 cost time: 1.5765459537506104
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.866 Test Loss: 0.846 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.296431541442871
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.876 Vali Acc: 0.863 Test Loss: 0.876 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4243593215942383
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.866 Test Loss: 0.893 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1357810497283936
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.872 Test Loss: 0.891 Test Acc: 0.872
Validation loss decreased (-0.868742 --> -0.871866).  Saving model ...
Epoch: 24 cost time: 1.0779328346252441
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.872 Test Loss: 0.893 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0555973052978516
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.911 Vali Acc: 0.869 Test Loss: 0.911 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8265562057495117
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.865 Vali Acc: 0.872 Test Loss: 0.865 Test Acc: 0.872
Validation loss decreased (-0.871866 --> -0.871866).  Saving model ...
Epoch: 27 cost time: 1.2567286491394043
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.870 Vali Acc: 0.869 Test Loss: 0.870 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6448540687561035
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.924 Vali Acc: 0.859 Test Loss: 0.924 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6309077739715576
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.863 Test Loss: 0.978 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5867853164672852
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.863 Test Loss: 0.977 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7211227416992188
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.863 Test Loss: 0.987 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5391089916229248
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.863 Test Loss: 1.000 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7380175590515137
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.859 Test Loss: 0.997 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3422904014587402
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.863 Test Loss: 0.969 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6419029235839844
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.952 Vali Acc: 0.866 Test Loss: 0.952 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.8363449573516846
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.872 Test Loss: 0.932 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43646216
model size : 181.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0100042819976807
Epoch: 1, Steps: 8 | Train Loss: 2.097 Vali Loss: 1.855 Vali Acc: 0.391 Test Loss: 1.855 Test Acc: 0.391
Validation loss decreased (inf --> -0.390606).  Saving model ...
Epoch: 2 cost time: 1.6954402923583984
Epoch: 2, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.229 Vali Acc: 0.756 Test Loss: 1.229 Test Acc: 0.756
Validation loss decreased (-0.390606 --> -0.756238).  Saving model ...
Epoch: 3 cost time: 1.67466139793396
Epoch: 3, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.735 Vali Acc: 0.806 Test Loss: 0.735 Test Acc: 0.806
Validation loss decreased (-0.756238 --> -0.806243).  Saving model ...
Epoch: 4 cost time: 1.6120710372924805
Epoch: 4, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.491 Vali Acc: 0.841 Test Loss: 0.491 Test Acc: 0.841
Validation loss decreased (-0.806243 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 1.8755872249603271
Epoch: 5, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 1.8934047222137451
Epoch: 6, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8261332511901855
Epoch: 7, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.874 Vali Acc: 0.819 Test Loss: 0.874 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8489394187927246
Epoch: 8, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.824 Vali Acc: 0.863 Test Loss: 0.824 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862492).  Saving model ...
Epoch: 9 cost time: 1.9698829650878906
Epoch: 9, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.374 Vali Acc: 0.800 Test Loss: 1.374 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6597838401794434
Epoch: 10, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.099 Vali Acc: 0.853 Test Loss: 1.099 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5086851119995117
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.381 Vali Acc: 0.816 Test Loss: 1.381 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.591691017150879
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.417 Vali Acc: 0.803 Test Loss: 1.417 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7759110927581787
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.311 Vali Acc: 0.834 Test Loss: 1.311 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5140719413757324
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.841 Test Loss: 1.377 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7813992500305176
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.303 Vali Acc: 0.853 Test Loss: 1.303 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5508806705474854
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.844 Test Loss: 1.349 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8166890144348145
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.609 Vali Acc: 0.816 Test Loss: 1.609 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5386419296264648
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.416 Vali Acc: 0.841 Test Loss: 1.416 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 44067848
model size : 182.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1332457065582275
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 1.905 Vali Acc: 0.359 Test Loss: 1.905 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 1.3504633903503418
Epoch: 2, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.525 Vali Acc: 0.625 Test Loss: 1.525 Test Acc: 0.625
Validation loss decreased (-0.359356 --> -0.624985).  Saving model ...
Epoch: 3 cost time: 1.3229515552520752
Epoch: 3, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.066 Vali Acc: 0.775 Test Loss: 1.066 Test Acc: 0.775
Validation loss decreased (-0.624985 --> -0.774989).  Saving model ...
Epoch: 4 cost time: 1.2698254585266113
Epoch: 4, Steps: 8 | Train Loss: 0.852 Vali Loss: 0.683 Vali Acc: 0.831 Test Loss: 0.683 Test Acc: 0.831
Validation loss decreased (-0.774989 --> -0.831243).  Saving model ...
Epoch: 5 cost time: 1.2123384475708008
Epoch: 5, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7918665409088135
Epoch: 6, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.548 Vali Acc: 0.819 Test Loss: 0.548 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2335288524627686
Epoch: 7, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.601 Vali Acc: 0.831 Test Loss: 0.601 Test Acc: 0.831
Validation loss decreased (-0.831243 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 1.4125823974609375
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.694 Vali Acc: 0.853 Test Loss: 0.694 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853118).  Saving model ...
Epoch: 9 cost time: 0.8271005153656006
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.889 Vali Acc: 0.809 Test Loss: 0.889 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9741041660308838
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.908 Vali Acc: 0.828 Test Loss: 0.908 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9865732192993164
Epoch: 11, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.918 Vali Acc: 0.822 Test Loss: 0.918 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.995647668838501
Epoch: 12, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.029 Vali Acc: 0.825 Test Loss: 1.029 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3815603256225586
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.928 Vali Acc: 0.859 Test Loss: 0.928 Test Acc: 0.859
Validation loss decreased (-0.853118 --> -0.859366).  Saving model ...
Epoch: 14 cost time: 1.1349937915802002
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.129 Vali Acc: 0.825 Test Loss: 1.129 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8562006950378418
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.221 Vali Acc: 0.831 Test Loss: 1.221 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2666993141174316
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.117 Vali Acc: 0.838 Test Loss: 1.117 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5251758098602295
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.853 Test Loss: 1.099 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.424023151397705
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.866 Test Loss: 1.046 Test Acc: 0.866
Validation loss decreased (-0.859366 --> -0.865615).  Saving model ...
Epoch: 19 cost time: 1.1512820720672607
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.950 Vali Acc: 0.853 Test Loss: 0.950 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9752390384674072
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.189 Vali Acc: 0.844 Test Loss: 1.189 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.245297908782959
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.149 Vali Acc: 0.853 Test Loss: 1.149 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1827046871185303
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.847 Test Loss: 1.083 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2143630981445312
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.859 Test Loss: 1.057 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5437397956848145
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.859 Test Loss: 1.077 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4213314056396484
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.866 Test Loss: 1.069 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.932401180267334
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.863 Test Loss: 1.078 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0470991134643555
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.859 Test Loss: 1.083 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1233015060424805
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.859 Test Loss: 1.093 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 43783688
model size : 181.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.787548065185547
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.012 Vali Acc: 0.219 Test Loss: 2.012 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 1.6571786403656006
Epoch: 2, Steps: 8 | Train Loss: 1.968 Vali Loss: 1.752 Vali Acc: 0.672 Test Loss: 1.752 Test Acc: 0.672
Validation loss decreased (-0.218730 --> -0.671857).  Saving model ...
Epoch: 3 cost time: 1.1797142028808594
Epoch: 3, Steps: 8 | Train Loss: 1.667 Vali Loss: 1.433 Vali Acc: 0.772 Test Loss: 1.433 Test Acc: 0.772
Validation loss decreased (-0.671857 --> -0.771861).  Saving model ...
Epoch: 4 cost time: 1.1721231937408447
Epoch: 4, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.057 Vali Acc: 0.791 Test Loss: 1.057 Test Acc: 0.791
Validation loss decreased (-0.771861 --> -0.790614).  Saving model ...
Epoch: 5 cost time: 1.002084493637085
Epoch: 5, Steps: 8 | Train Loss: 0.938 Vali Loss: 0.728 Vali Acc: 0.828 Test Loss: 0.728 Test Acc: 0.828
Validation loss decreased (-0.790614 --> -0.828118).  Saving model ...
Epoch: 6 cost time: 1.0522150993347168
Epoch: 6, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.524 Vali Acc: 0.828 Test Loss: 0.524 Test Acc: 0.828
Validation loss decreased (-0.828118 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.729942798614502
Epoch: 7, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1215801239013672
Epoch: 8, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.083427906036377
Epoch: 9, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 1.233926773071289
Epoch: 10, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2914326190948486
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.663 Vali Acc: 0.859 Test Loss: 0.663 Test Acc: 0.859
Validation loss decreased (-0.843744 --> -0.859368).  Saving model ...
Epoch: 12 cost time: 1.3789808750152588
Epoch: 12, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.666 Vali Acc: 0.847 Test Loss: 0.666 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.379607915878296
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2279140949249268
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.696 Vali Acc: 0.872 Test Loss: 0.696 Test Acc: 0.872
Validation loss decreased (-0.859368 --> -0.871868).  Saving model ...
Epoch: 15 cost time: 1.179546594619751
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.620 Vali Acc: 0.866 Test Loss: 0.620 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3595199584960938
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.755 Vali Acc: 0.863 Test Loss: 0.755 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1942360401153564
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.753 Vali Acc: 0.853 Test Loss: 0.753 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1605603694915771
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.729 Vali Acc: 0.856 Test Loss: 0.729 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1416749954223633
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.752 Vali Acc: 0.856 Test Loss: 0.752 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2347605228424072
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.859 Test Loss: 0.763 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1321954727172852
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.788 Vali Acc: 0.863 Test Loss: 0.788 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2560031414031982
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.788 Vali Acc: 0.863 Test Loss: 0.788 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8521125316619873
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.872 Test Loss: 0.783 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2173190116882324
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.869 Test Loss: 0.827 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43637768
model size : 181.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.324374198913574
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 1.945 Vali Acc: 0.309 Test Loss: 1.945 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 0.9851984977722168
Epoch: 2, Steps: 8 | Train Loss: 1.779 Vali Loss: 1.418 Vali Acc: 0.719 Test Loss: 1.418 Test Acc: 0.719
Validation loss decreased (-0.309356 --> -0.718736).  Saving model ...
Epoch: 3 cost time: 1.41469144821167
Epoch: 3, Steps: 8 | Train Loss: 1.203 Vali Loss: 0.902 Vali Acc: 0.781 Test Loss: 0.902 Test Acc: 0.781
Validation loss decreased (-0.718736 --> -0.781241).  Saving model ...
Epoch: 4 cost time: 1.4140291213989258
Epoch: 4, Steps: 8 | Train Loss: 0.705 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.781241 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.5372164249420166
Epoch: 5, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
Validation loss decreased (-0.821869 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.572659969329834
Epoch: 6, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3597979545593262
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.346456527709961
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.015 Vali Acc: 0.800 Test Loss: 1.015 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.336221694946289
Epoch: 9, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.878 Vali Acc: 0.859 Test Loss: 0.878 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859366).  Saving model ...
Epoch: 10 cost time: 1.4375531673431396
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.930 Vali Acc: 0.859 Test Loss: 0.930 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4024248123168945
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.334 Vali Acc: 0.784 Test Loss: 1.334 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6372218132019043
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.119 Vali Acc: 0.856 Test Loss: 1.119 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5962247848510742
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.128 Vali Acc: 0.844 Test Loss: 1.128 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6763637065887451
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.301 Vali Acc: 0.831 Test Loss: 1.301 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4026570320129395
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.561 Vali Acc: 0.819 Test Loss: 1.561 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3749561309814453
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.616 Vali Acc: 0.819 Test Loss: 1.616 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5708065032958984
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.834 Test Loss: 1.608 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6324143409729004
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.588 Vali Acc: 0.834 Test Loss: 1.588 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.549534559249878
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.838 Test Loss: 1.536 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 43959560
model size : 182.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5109736919403076
Epoch: 1, Steps: 8 | Train Loss: 2.133 Vali Loss: 1.953 Vali Acc: 0.256 Test Loss: 1.953 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 1.1004257202148438
Epoch: 2, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.608 Vali Acc: 0.647 Test Loss: 1.608 Test Acc: 0.647
Validation loss decreased (-0.256230 --> -0.646859).  Saving model ...
Epoch: 3 cost time: 0.8283357620239258
Epoch: 3, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.166 Vali Acc: 0.747 Test Loss: 1.166 Test Acc: 0.747
Validation loss decreased (-0.646859 --> -0.746863).  Saving model ...
Epoch: 4 cost time: 0.8899853229522705
Epoch: 4, Steps: 8 | Train Loss: 1.006 Vali Loss: 0.757 Vali Acc: 0.812 Test Loss: 0.757 Test Acc: 0.812
Validation loss decreased (-0.746863 --> -0.812492).  Saving model ...
Epoch: 5 cost time: 1.286393165588379
Epoch: 5, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
Validation loss decreased (-0.812492 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 1.056546688079834
Epoch: 6, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.492 Vali Acc: 0.828 Test Loss: 0.492 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 1.25010347366333
Epoch: 7, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 1.0171310901641846
Epoch: 8, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8110744953155518
Epoch: 9, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.592 Vali Acc: 0.869 Test Loss: 0.592 Test Acc: 0.869
Validation loss decreased (-0.843745 --> -0.868744).  Saving model ...
Epoch: 10 cost time: 0.8180077075958252
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9782254695892334
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.741 Vali Acc: 0.853 Test Loss: 0.741 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0109105110168457
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.769 Vali Acc: 0.853 Test Loss: 0.769 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1888337135314941
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.946 Vali Acc: 0.844 Test Loss: 0.946 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.142268419265747
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.953 Vali Acc: 0.834 Test Loss: 0.953 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9318125247955322
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.990 Vali Acc: 0.853 Test Loss: 0.990 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0847620964050293
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.071 Vali Acc: 0.838 Test Loss: 1.071 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0816383361816406
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.043 Vali Acc: 0.831 Test Loss: 1.043 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0186235904693604
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.059 Vali Acc: 0.856 Test Loss: 1.059 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.823958158493042
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.042 Vali Acc: 0.872 Test Loss: 1.042 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871865).  Saving model ...
Epoch: 20 cost time: 1.0086445808410645
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.872 Test Loss: 0.972 Test Acc: 0.872
Validation loss decreased (-0.871865 --> -0.871865).  Saving model ...
Epoch: 21 cost time: 0.9501397609710693
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.856 Test Loss: 1.049 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9658904075622559
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.025 Vali Acc: 0.863 Test Loss: 1.025 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9987235069274902
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.863 Test Loss: 0.984 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8745934963226318
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.863 Test Loss: 0.983 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9661548137664795
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.863 Test Loss: 0.979 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0202481746673584
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.859 Test Loss: 0.983 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9039983749389648
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.115 Vali Acc: 0.859 Test Loss: 1.115 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9749569892883301
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.148 Vali Acc: 0.856 Test Loss: 1.148 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1473870277404785
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.853 Test Loss: 1.077 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0940043926239014
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.850 Test Loss: 1.057 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43759880
model size : 181.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5087363719940186
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 1.979 Vali Acc: 0.169 Test Loss: 1.979 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 1.1946048736572266
Epoch: 2, Steps: 8 | Train Loss: 1.964 Vali Loss: 1.738 Vali Acc: 0.625 Test Loss: 1.738 Test Acc: 0.625
Validation loss decreased (-0.168730 --> -0.624983).  Saving model ...
Epoch: 3 cost time: 1.2180538177490234
Epoch: 3, Steps: 8 | Train Loss: 1.715 Vali Loss: 1.452 Vali Acc: 0.722 Test Loss: 1.452 Test Acc: 0.722
Validation loss decreased (-0.624983 --> -0.721860).  Saving model ...
Epoch: 4 cost time: 1.3051903247833252
Epoch: 4, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.124 Vali Acc: 0.806 Test Loss: 1.124 Test Acc: 0.806
Validation loss decreased (-0.721860 --> -0.806239).  Saving model ...
Epoch: 5 cost time: 1.1891508102416992
Epoch: 5, Steps: 8 | Train Loss: 1.015 Vali Loss: 0.793 Vali Acc: 0.847 Test Loss: 0.793 Test Acc: 0.847
Validation loss decreased (-0.806239 --> -0.846867).  Saving model ...
Epoch: 6 cost time: 0.8385598659515381
Epoch: 6, Steps: 8 | Train Loss: 0.726 Vali Loss: 0.557 Vali Acc: 0.831 Test Loss: 0.557 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.111081600189209
Epoch: 7, Steps: 8 | Train Loss: 0.493 Vali Loss: 0.466 Vali Acc: 0.853 Test Loss: 0.466 Test Acc: 0.853
Validation loss decreased (-0.846867 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 1.0944147109985352
Epoch: 8, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.503 Vali Acc: 0.847 Test Loss: 0.503 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1010925769805908
Epoch: 9, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1347379684448242
Epoch: 10, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.572 Vali Acc: 0.853 Test Loss: 0.572 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4300503730773926
Epoch: 11, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.571 Vali Acc: 0.859 Test Loss: 0.571 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859369).  Saving model ...
Epoch: 12 cost time: 1.216094732284546
Epoch: 12, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.125748634338379
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1920223236083984
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4422881603240967
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.740 Vali Acc: 0.838 Test Loss: 0.740 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0420570373535156
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.863 Test Loss: 0.748 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862493).  Saving model ...
Epoch: 17 cost time: 0.7641379833221436
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8345465660095215
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.800 Vali Acc: 0.844 Test Loss: 0.800 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9135935306549072
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.788 Vali Acc: 0.853 Test Loss: 0.788 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0945689678192139
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.869 Test Loss: 0.751 Test Acc: 0.869
Validation loss decreased (-0.862493 --> -0.868742).  Saving model ...
Epoch: 21 cost time: 0.8350117206573486
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.872 Test Loss: 0.737 Test Acc: 0.872
Validation loss decreased (-0.868742 --> -0.871868).  Saving model ...
Epoch: 22 cost time: 0.9312765598297119
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.863 Test Loss: 0.769 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8713679313659668
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.793 Vali Acc: 0.863 Test Loss: 0.793 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.736199140548706
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.806 Vali Acc: 0.863 Test Loss: 0.806 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8676433563232422
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.863 Test Loss: 0.816 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0815551280975342
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.818 Vali Acc: 0.866 Test Loss: 0.818 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7602019309997559
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.866 Test Loss: 0.814 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9085378646850586
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.869 Test Loss: 0.800 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8358879089355469
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.869 Test Loss: 0.801 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0089378356933594
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.872 Test Loss: 0.807 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6730480194091797
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.872 Test Loss: 0.813 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43637000
model size : 181.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8584189414978027
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 1.840 Vali Acc: 0.441 Test Loss: 1.840 Test Acc: 0.441
Validation loss decreased (inf --> -0.440607).  Saving model ...
Epoch: 2 cost time: 1.2604906558990479
Epoch: 2, Steps: 8 | Train Loss: 1.625 Vali Loss: 1.232 Vali Acc: 0.831 Test Loss: 1.232 Test Acc: 0.831
Validation loss decreased (-0.440607 --> -0.831238).  Saving model ...
Epoch: 3 cost time: 1.3880531787872314
Epoch: 3, Steps: 8 | Train Loss: 1.005 Vali Loss: 0.731 Vali Acc: 0.806 Test Loss: 0.731 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2312779426574707
Epoch: 4, Steps: 8 | Train Loss: 0.619 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.831238 --> -0.853120).  Saving model ...
Epoch: 5 cost time: 1.058439016342163
Epoch: 5, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.499 Vali Acc: 0.841 Test Loss: 0.499 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.17366623878479
Epoch: 6, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.664 Vali Acc: 0.812 Test Loss: 0.664 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5105681419372559
Epoch: 7, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4659698009490967
Epoch: 8, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.886 Vali Acc: 0.822 Test Loss: 0.886 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1778538227081299
Epoch: 9, Steps: 8 | Train Loss: 0.075 Vali Loss: 0.824 Vali Acc: 0.844 Test Loss: 0.824 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.184882640838623
Epoch: 10, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.043 Vali Acc: 0.822 Test Loss: 1.043 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1612539291381836
Epoch: 11, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.147 Vali Acc: 0.812 Test Loss: 1.147 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.177901029586792
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.206 Vali Acc: 0.828 Test Loss: 1.206 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1844794750213623
Epoch: 13, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.332 Vali Acc: 0.822 Test Loss: 1.332 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2022740840911865
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.243 Vali Acc: 0.822 Test Loss: 1.243 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 43966472
model size : 182.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4369354248046875
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 1.920 Vali Acc: 0.316 Test Loss: 1.920 Test Acc: 0.316
Validation loss decreased (inf --> -0.315606).  Saving model ...
Epoch: 2 cost time: 1.1067304611206055
Epoch: 2, Steps: 8 | Train Loss: 1.809 Vali Loss: 1.532 Vali Acc: 0.666 Test Loss: 1.532 Test Acc: 0.666
Validation loss decreased (-0.315606 --> -0.665610).  Saving model ...
Epoch: 3 cost time: 1.1697704792022705
Epoch: 3, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.055 Vali Acc: 0.766 Test Loss: 1.055 Test Acc: 0.766
Validation loss decreased (-0.665610 --> -0.765614).  Saving model ...
Epoch: 4 cost time: 0.8866698741912842
Epoch: 4, Steps: 8 | Train Loss: 0.949 Vali Loss: 0.683 Vali Acc: 0.841 Test Loss: 0.683 Test Acc: 0.841
Validation loss decreased (-0.765614 --> -0.840618).  Saving model ...
Epoch: 5 cost time: 1.122650384902954
Epoch: 5, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.565 Vali Acc: 0.800 Test Loss: 0.565 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2343299388885498
Epoch: 6, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.478 Vali Acc: 0.844 Test Loss: 0.478 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.216383695602417
Epoch: 7, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.657 Vali Acc: 0.816 Test Loss: 0.657 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.354219913482666
Epoch: 8, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.904902458190918
Epoch: 9, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.814 Vali Acc: 0.838 Test Loss: 0.814 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.957585334777832
Epoch: 10, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.833 Vali Acc: 0.822 Test Loss: 0.833 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1150310039520264
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.908 Vali Acc: 0.822 Test Loss: 0.908 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0945630073547363
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.036 Vali Acc: 0.828 Test Loss: 1.036 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0869765281677246
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.958 Vali Acc: 0.834 Test Loss: 0.958 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1747963428497314
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.048 Vali Acc: 0.831 Test Loss: 1.048 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0477001667022705
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.046 Vali Acc: 0.834 Test Loss: 1.046 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9902145862579346
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.046 Vali Acc: 0.841 Test Loss: 1.046 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 43766792
model size : 181.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.60951566696167
Epoch: 1, Steps: 8 | Train Loss: 2.192 Vali Loss: 2.048 Vali Acc: 0.153 Test Loss: 2.048 Test Acc: 0.153
Validation loss decreased (inf --> -0.153105).  Saving model ...
Epoch: 2 cost time: 0.6967868804931641
Epoch: 2, Steps: 8 | Train Loss: 1.942 Vali Loss: 1.807 Vali Acc: 0.544 Test Loss: 1.807 Test Acc: 0.544
Validation loss decreased (-0.153105 --> -0.543732).  Saving model ...
Epoch: 3 cost time: 0.7743055820465088
Epoch: 3, Steps: 8 | Train Loss: 1.691 Vali Loss: 1.498 Vali Acc: 0.672 Test Loss: 1.498 Test Acc: 0.672
Validation loss decreased (-0.543732 --> -0.671860).  Saving model ...
Epoch: 4 cost time: 0.7315263748168945
Epoch: 4, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.137 Vali Acc: 0.775 Test Loss: 1.137 Test Acc: 0.775
Validation loss decreased (-0.671860 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 0.7313022613525391
Epoch: 5, Steps: 8 | Train Loss: 0.958 Vali Loss: 0.792 Vali Acc: 0.825 Test Loss: 0.792 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 0.7246184349060059
Epoch: 6, Steps: 8 | Train Loss: 0.663 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
Validation loss decreased (-0.824992 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 1.066833257675171
Epoch: 7, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1080257892608643
Epoch: 8, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.544 Vali Acc: 0.841 Test Loss: 0.544 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.8398647308349609
Epoch: 9, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.671 Vali Acc: 0.809 Test Loss: 0.671 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1242523193359375
Epoch: 10, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8285501003265381
Epoch: 11, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.759 Vali Acc: 0.819 Test Loss: 0.759 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0913195610046387
Epoch: 12, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.709 Vali Acc: 0.819 Test Loss: 0.709 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8912866115570068
Epoch: 13, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.801 Vali Acc: 0.841 Test Loss: 0.801 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.023571252822876
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.813 Vali Acc: 0.822 Test Loss: 0.813 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0632963180541992
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.833 Vali Acc: 0.834 Test Loss: 0.833 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7370986938476562
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.861 Vali Acc: 0.834 Test Loss: 0.861 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1169648170471191
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.864 Vali Acc: 0.834 Test Loss: 0.864 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9017918109893799
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.874 Vali Acc: 0.847 Test Loss: 0.874 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846866).  Saving model ...
Epoch: 19 cost time: 1.1617577075958252
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.904 Vali Acc: 0.850 Test Loss: 0.904 Test Acc: 0.850
Validation loss decreased (-0.846866 --> -0.849991).  Saving model ...
Epoch: 20 cost time: 1.2744643688201904
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.875 Vali Acc: 0.844 Test Loss: 0.875 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1959784030914307
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.921 Vali Acc: 0.825 Test Loss: 0.921 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.086484670639038
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.906 Vali Acc: 0.838 Test Loss: 0.906 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0901153087615967
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.841 Test Loss: 0.909 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0746607780456543
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.922 Vali Acc: 0.847 Test Loss: 0.922 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2087905406951904
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.932 Vali Acc: 0.847 Test Loss: 0.932 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1537599563598633
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.921 Vali Acc: 0.841 Test Loss: 0.921 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8285620212554932
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.930 Vali Acc: 0.844 Test Loss: 0.930 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6721489429473877
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.956 Vali Acc: 0.841 Test Loss: 0.956 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8076949119567871
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.841 Test Loss: 0.972 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 43636232
model size : 181.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.086151599884033
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 1.965 Vali Acc: 0.269 Test Loss: 1.965 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 1.325594186782837
Epoch: 2, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.399 Vali Acc: 0.647 Test Loss: 1.399 Test Acc: 0.647
Validation loss decreased (-0.268730 --> -0.646861).  Saving model ...
Epoch: 3 cost time: 1.4458038806915283
Epoch: 3, Steps: 8 | Train Loss: 1.271 Vali Loss: 0.910 Vali Acc: 0.794 Test Loss: 0.910 Test Acc: 0.794
Validation loss decreased (-0.646861 --> -0.793741).  Saving model ...
Epoch: 4 cost time: 1.243682622909546
Epoch: 4, Steps: 8 | Train Loss: 0.771 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.793741 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 1.2681865692138672
Epoch: 5, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.4648950099945068
Epoch: 6, Steps: 8 | Train Loss: 0.271 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 1.3213884830474854
Epoch: 7, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.878 Vali Acc: 0.816 Test Loss: 0.878 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3282146453857422
Epoch: 8, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.868 Vali Acc: 0.828 Test Loss: 0.868 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3117458820343018
Epoch: 9, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.084 Vali Acc: 0.831 Test Loss: 1.084 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1742734909057617
Epoch: 10, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.092 Vali Acc: 0.816 Test Loss: 1.092 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1566212177276611
Epoch: 11, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.506 Vali Acc: 0.800 Test Loss: 1.506 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.112748146057129
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.270 Vali Acc: 0.844 Test Loss: 1.270 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843737).  Saving model ...
Epoch: 13 cost time: 1.1239783763885498
Epoch: 13, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.140 Vali Acc: 0.856 Test Loss: 1.140 Test Acc: 0.856
Validation loss decreased (-0.843737 --> -0.856239).  Saving model ...
Epoch: 14 cost time: 1.3057754039764404
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.649 Vali Acc: 0.812 Test Loss: 1.649 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1142122745513916
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.620 Vali Acc: 0.809 Test Loss: 1.620 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1072742938995361
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.491 Vali Acc: 0.806 Test Loss: 1.491 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0809376239776611
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.523 Vali Acc: 0.800 Test Loss: 1.523 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1930065155029297
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.668 Vali Acc: 0.828 Test Loss: 1.668 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4724769592285156
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.814 Vali Acc: 0.828 Test Loss: 1.814 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5410277843475342
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.783 Vali Acc: 0.812 Test Loss: 1.783 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1755316257476807
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.667 Vali Acc: 0.838 Test Loss: 1.667 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.378631830215454
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.146 Vali Acc: 0.794 Test Loss: 2.146 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.396526575088501
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.950 Vali Acc: 0.806 Test Loss: 1.950 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 43973384
model size : 182.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6171319484710693
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 1.947 Vali Acc: 0.309 Test Loss: 1.947 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 1.1667110919952393
Epoch: 2, Steps: 8 | Train Loss: 1.831 Vali Loss: 1.579 Vali Acc: 0.734 Test Loss: 1.579 Test Acc: 0.734
Validation loss decreased (-0.309356 --> -0.734359).  Saving model ...
Epoch: 3 cost time: 1.222888708114624
Epoch: 3, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.164 Vali Acc: 0.772 Test Loss: 1.164 Test Acc: 0.772
Validation loss decreased (-0.734359 --> -0.771863).  Saving model ...
Epoch: 4 cost time: 0.9044945240020752
Epoch: 4, Steps: 8 | Train Loss: 1.001 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
Validation loss decreased (-0.771863 --> -0.809367).  Saving model ...
Epoch: 5 cost time: 0.7386312484741211
Epoch: 5, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.809367 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.8073923587799072
Epoch: 6, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9480640888214111
Epoch: 7, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.584 Vali Acc: 0.819 Test Loss: 0.584 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1415212154388428
Epoch: 8, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.581 Vali Acc: 0.834 Test Loss: 0.581 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0169084072113037
Epoch: 9, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.684 Vali Acc: 0.831 Test Loss: 0.684 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0867400169372559
Epoch: 10, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.715 Vali Acc: 0.838 Test Loss: 0.715 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.230484962463379
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.746 Vali Acc: 0.834 Test Loss: 0.746 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9017796516418457
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.827 Vali Acc: 0.834 Test Loss: 0.827 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0361065864562988
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.866 Vali Acc: 0.834 Test Loss: 0.866 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0942127704620361
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.869 Vali Acc: 0.847 Test Loss: 0.869 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846866).  Saving model ...
Epoch: 15 cost time: 1.257641077041626
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.889 Vali Acc: 0.847 Test Loss: 0.889 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2073938846588135
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.865 Vali Acc: 0.859 Test Loss: 0.865 Test Acc: 0.859
Validation loss decreased (-0.846866 --> -0.859366).  Saving model ...
Epoch: 17 cost time: 1.193868637084961
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.870 Vali Acc: 0.859 Test Loss: 0.870 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1671969890594482
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.850 Test Loss: 0.895 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3297600746154785
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.027 Vali Acc: 0.847 Test Loss: 1.027 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1791315078735352
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.029 Vali Acc: 0.838 Test Loss: 1.029 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.356682538986206
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.825 Test Loss: 1.047 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3328831195831299
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.834 Test Loss: 1.047 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0961947441101074
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.859 Test Loss: 0.958 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4716830253601074
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.853 Test Loss: 0.938 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3105847835540771
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.847 Test Loss: 0.969 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7864336967468262
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.847 Test Loss: 1.025 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 43742984
model size : 181.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.722177028656006
Epoch: 1, Steps: 8 | Train Loss: 2.218 Vali Loss: 2.052 Vali Acc: 0.234 Test Loss: 2.052 Test Acc: 0.234
Validation loss decreased (inf --> -0.234354).  Saving model ...
Epoch: 2 cost time: 1.1670093536376953
Epoch: 2, Steps: 8 | Train Loss: 2.000 Vali Loss: 1.829 Vali Acc: 0.453 Test Loss: 1.829 Test Acc: 0.453
Validation loss decreased (-0.234354 --> -0.453107).  Saving model ...
Epoch: 3 cost time: 0.6493127346038818
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.543 Vali Acc: 0.725 Test Loss: 1.543 Test Acc: 0.725
Validation loss decreased (-0.453107 --> -0.724985).  Saving model ...
Epoch: 4 cost time: 1.2218613624572754
Epoch: 4, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.219 Vali Acc: 0.756 Test Loss: 1.219 Test Acc: 0.756
Validation loss decreased (-0.724985 --> -0.756238).  Saving model ...
Epoch: 5 cost time: 0.9678359031677246
Epoch: 5, Steps: 8 | Train Loss: 1.065 Vali Loss: 0.882 Vali Acc: 0.794 Test Loss: 0.882 Test Acc: 0.794
Validation loss decreased (-0.756238 --> -0.793741).  Saving model ...
Epoch: 6 cost time: 0.8316833972930908
Epoch: 6, Steps: 8 | Train Loss: 0.764 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
Validation loss decreased (-0.793741 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 1.4856784343719482
Epoch: 7, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 1.381047248840332
Epoch: 8, Steps: 8 | Train Loss: 0.309 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.9974532127380371
Epoch: 9, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7397098541259766
Epoch: 10, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.628 Vali Acc: 0.831 Test Loss: 0.628 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1742911338806152
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.724 Vali Acc: 0.825 Test Loss: 0.724 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7724654674530029
Epoch: 12, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2295889854431152
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0830905437469482
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.706 Vali Acc: 0.828 Test Loss: 0.706 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.534869909286499
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.729 Vali Acc: 0.828 Test Loss: 0.729 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4840514659881592
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.761 Vali Acc: 0.834 Test Loss: 0.761 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1594812870025635
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.808 Vali Acc: 0.841 Test Loss: 0.808 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0132923126220703
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.856 Vali Acc: 0.828 Test Loss: 0.856 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 43635464
model size : 181.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.204010248184204
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.897 Vali Acc: 0.362 Test Loss: 1.897 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 1.8743205070495605
Epoch: 2, Steps: 8 | Train Loss: 1.706 Vali Loss: 1.351 Vali Acc: 0.709 Test Loss: 1.351 Test Acc: 0.709
Validation loss decreased (-0.362481 --> -0.709361).  Saving model ...
Epoch: 3 cost time: 1.873006820678711
Epoch: 3, Steps: 8 | Train Loss: 1.147 Vali Loss: 0.782 Vali Acc: 0.853 Test Loss: 0.782 Test Acc: 0.853
Validation loss decreased (-0.709361 --> -0.853117).  Saving model ...
Epoch: 4 cost time: 1.6400485038757324
Epoch: 4, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.420271635055542
Epoch: 5, Steps: 8 | Train Loss: 0.388 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.885213851928711
Epoch: 6, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.607 Vali Acc: 0.838 Test Loss: 0.607 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.337003469467163
Epoch: 7, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.762 Vali Acc: 0.809 Test Loss: 0.762 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9200084209442139
Epoch: 8, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.793 Vali Acc: 0.859 Test Loss: 0.793 Test Acc: 0.859
Validation loss decreased (-0.853117 --> -0.859367).  Saving model ...
Epoch: 9 cost time: 2.046156167984009
Epoch: 9, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.924 Vali Acc: 0.834 Test Loss: 0.924 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7655892372131348
Epoch: 10, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.364 Vali Acc: 0.794 Test Loss: 1.364 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3269283771514893
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.428 Vali Acc: 0.838 Test Loss: 1.428 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1542048454284668
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.246 Vali Acc: 0.856 Test Loss: 1.246 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1002156734466553
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.186 Vali Acc: 0.853 Test Loss: 1.186 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.385117530822754
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.270 Vali Acc: 0.844 Test Loss: 1.270 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4517202377319336
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.622 Vali Acc: 0.847 Test Loss: 1.622 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5776221752166748
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.434 Vali Acc: 0.866 Test Loss: 1.434 Test Acc: 0.866
Validation loss decreased (-0.859367 --> -0.865611).  Saving model ...
Epoch: 17 cost time: 1.9491524696350098
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.571 Vali Acc: 0.834 Test Loss: 1.571 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6718478202819824
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.456 Vali Acc: 0.866 Test Loss: 1.456 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0867969989776611
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.853 Test Loss: 1.527 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7628285884857178
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.555 Vali Acc: 0.844 Test Loss: 1.555 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.481139898300171
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.538 Vali Acc: 0.841 Test Loss: 1.538 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7760334014892578
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.863 Test Loss: 1.511 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7487623691558838
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.859 Test Loss: 1.509 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4164175987243652
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.859 Test Loss: 1.512 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7562854290008545
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.856 Test Loss: 1.525 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5204441547393799
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.856 Test Loss: 1.530 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 43980296
model size : 182.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.498163938522339
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 1.953 Vali Acc: 0.222 Test Loss: 1.953 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 0.896310567855835
Epoch: 2, Steps: 8 | Train Loss: 1.832 Vali Loss: 1.589 Vali Acc: 0.662 Test Loss: 1.589 Test Acc: 0.662
Validation loss decreased (-0.221855 --> -0.662484).  Saving model ...
Epoch: 3 cost time: 0.8337399959564209
Epoch: 3, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.170 Vali Acc: 0.756 Test Loss: 1.170 Test Acc: 0.756
Validation loss decreased (-0.662484 --> -0.756238).  Saving model ...
Epoch: 4 cost time: 1.326826572418213
Epoch: 4, Steps: 8 | Train Loss: 1.021 Vali Loss: 0.791 Vali Acc: 0.838 Test Loss: 0.791 Test Acc: 0.838
Validation loss decreased (-0.756238 --> -0.837492).  Saving model ...
Epoch: 5 cost time: 1.2391397953033447
Epoch: 5, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2207858562469482
Epoch: 6, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.837492 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.1667189598083496
Epoch: 7, Steps: 8 | Train Loss: 0.283 Vali Loss: 0.566 Vali Acc: 0.834 Test Loss: 0.566 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2338178157806396
Epoch: 8, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.620 Vali Acc: 0.828 Test Loss: 0.620 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0085999965667725
Epoch: 9, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.708 Vali Acc: 0.831 Test Loss: 0.708 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8425548076629639
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.850 Vali Acc: 0.828 Test Loss: 0.850 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9305388927459717
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.888 Vali Acc: 0.831 Test Loss: 0.888 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.618835687637329
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.872 Vali Acc: 0.838 Test Loss: 0.872 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2268140316009521
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.085 Vali Acc: 0.819 Test Loss: 1.085 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4686081409454346
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.032 Vali Acc: 0.831 Test Loss: 1.032 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3505539894104004
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.966 Vali Acc: 0.850 Test Loss: 0.966 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849990).  Saving model ...
Epoch: 16 cost time: 0.8637933731079102
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.958 Vali Acc: 0.847 Test Loss: 0.958 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3531365394592285
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.977 Vali Acc: 0.841 Test Loss: 0.977 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3435649871826172
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.002 Vali Acc: 0.866 Test Loss: 1.002 Test Acc: 0.866
Validation loss decreased (-0.849990 --> -0.865615).  Saving model ...
Epoch: 19 cost time: 1.3302440643310547
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.863 Test Loss: 0.936 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0288891792297363
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.024 Vali Acc: 0.850 Test Loss: 1.024 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1716406345367432
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.834 Test Loss: 1.087 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.990760326385498
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.136 Vali Acc: 0.841 Test Loss: 1.136 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5169806480407715
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.157 Vali Acc: 0.844 Test Loss: 1.157 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.13850998878479
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.850 Test Loss: 1.146 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5241384506225586
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.844 Test Loss: 1.141 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3224387168884277
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.844 Test Loss: 1.135 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.472559928894043
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.847 Test Loss: 1.143 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.146026372909546
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.844 Test Loss: 1.137 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 43749896
model size : 181.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6508712768554688
Epoch: 1, Steps: 8 | Train Loss: 2.174 Vali Loss: 2.014 Vali Acc: 0.247 Test Loss: 2.014 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.9286065101623535
Epoch: 2, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.799 Vali Acc: 0.662 Test Loss: 1.799 Test Acc: 0.662
Validation loss decreased (-0.246855 --> -0.662482).  Saving model ...
Epoch: 3 cost time: 0.8073689937591553
Epoch: 3, Steps: 8 | Train Loss: 1.740 Vali Loss: 1.547 Vali Acc: 0.744 Test Loss: 1.547 Test Acc: 0.744
Validation loss decreased (-0.662482 --> -0.743735).  Saving model ...
Epoch: 4 cost time: 0.9093327522277832
Epoch: 4, Steps: 8 | Train Loss: 1.452 Vali Loss: 1.231 Vali Acc: 0.794 Test Loss: 1.231 Test Acc: 0.794
Validation loss decreased (-0.743735 --> -0.793738).  Saving model ...
Epoch: 5 cost time: 0.835888147354126
Epoch: 5, Steps: 8 | Train Loss: 1.135 Vali Loss: 0.883 Vali Acc: 0.791 Test Loss: 0.883 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7684013843536377
Epoch: 6, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.578 Vali Acc: 0.834 Test Loss: 0.578 Test Acc: 0.834
Validation loss decreased (-0.793738 --> -0.834369).  Saving model ...
Epoch: 7 cost time: 0.9085977077484131
Epoch: 7, Steps: 8 | Train Loss: 0.465 Vali Loss: 0.498 Vali Acc: 0.825 Test Loss: 0.498 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0477290153503418
Epoch: 8, Steps: 8 | Train Loss: 0.322 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9405829906463623
Epoch: 9, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0509145259857178
Epoch: 10, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.659 Vali Acc: 0.838 Test Loss: 0.659 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837493).  Saving model ...
Epoch: 11 cost time: 0.8686695098876953
Epoch: 11, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.683 Vali Acc: 0.838 Test Loss: 0.683 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8951938152313232
Epoch: 12, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.791 Vali Acc: 0.847 Test Loss: 0.791 Test Acc: 0.847
Validation loss decreased (-0.837493 --> -0.846867).  Saving model ...
Epoch: 13 cost time: 0.7998406887054443
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.673 Vali Acc: 0.847 Test Loss: 0.673 Test Acc: 0.847
Validation loss decreased (-0.846867 --> -0.846868).  Saving model ...
Epoch: 14 cost time: 0.8820357322692871
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 0.7528989315032959
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.844 Vali Acc: 0.853 Test Loss: 0.844 Test Acc: 0.853
Validation loss decreased (-0.849992 --> -0.853117).  Saving model ...
Epoch: 16 cost time: 0.8722648620605469
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.777 Vali Acc: 0.847 Test Loss: 0.777 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9720430374145508
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.782 Vali Acc: 0.841 Test Loss: 0.782 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.066063642501831
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.799 Vali Acc: 0.847 Test Loss: 0.799 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9068019390106201
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.861 Vali Acc: 0.847 Test Loss: 0.861 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9464516639709473
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.855 Vali Acc: 0.853 Test Loss: 0.855 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7878601551055908
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.820 Vali Acc: 0.869 Test Loss: 0.820 Test Acc: 0.869
Validation loss decreased (-0.853117 --> -0.868742).  Saving model ...
Epoch: 22 cost time: 0.7145307064056396
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.799 Vali Acc: 0.869 Test Loss: 0.799 Test Acc: 0.869
Validation loss decreased (-0.868742 --> -0.868742).  Saving model ...
Epoch: 23 cost time: 0.7848794460296631
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.878 Test Loss: 0.806 Test Acc: 0.878
Validation loss decreased (-0.868742 --> -0.878117).  Saving model ...
Epoch: 24 cost time: 0.6960482597351074
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.826 Vali Acc: 0.872 Test Loss: 0.826 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6827850341796875
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.845 Vali Acc: 0.869 Test Loss: 0.845 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5505294799804688
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.854 Vali Acc: 0.866 Test Loss: 0.854 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5543348789215088
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.862 Vali Acc: 0.869 Test Loss: 0.862 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6307895183563232
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.863 Test Loss: 0.853 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6964404582977295
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.866 Test Loss: 0.855 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7677979469299316
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.872 Test Loss: 0.857 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6886711120605469
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.872 Test Loss: 0.857 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.709660530090332
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.869 Test Loss: 0.874 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7618114948272705
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.869 Test Loss: 0.889 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 43634696
model size : 181.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3649446964263916
Epoch: 1, Steps: 8 | Train Loss: 2.287 Vali Loss: 2.014 Vali Acc: 0.259 Test Loss: 2.014 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 1.0344171524047852
Epoch: 2, Steps: 8 | Train Loss: 1.897 Vali Loss: 1.583 Vali Acc: 0.525 Test Loss: 1.583 Test Acc: 0.525
Validation loss decreased (-0.259355 --> -0.524984).  Saving model ...
Epoch: 3 cost time: 1.0254006385803223
Epoch: 3, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.053 Vali Acc: 0.734 Test Loss: 1.053 Test Acc: 0.734
Validation loss decreased (-0.524984 --> -0.734364).  Saving model ...
Epoch: 4 cost time: 1.3529703617095947
Epoch: 4, Steps: 8 | Train Loss: 0.831 Vali Loss: 0.661 Vali Acc: 0.806 Test Loss: 0.661 Test Acc: 0.806
Validation loss decreased (-0.734364 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 1.32769775390625
Epoch: 5, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.806243 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.9652652740478516
Epoch: 6, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1391842365264893
Epoch: 7, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.646 Vali Acc: 0.863 Test Loss: 0.646 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862494).  Saving model ...
Epoch: 8 cost time: 1.3444576263427734
Epoch: 8, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.799 Vali Acc: 0.856 Test Loss: 0.799 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2173032760620117
Epoch: 9, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.764 Vali Acc: 0.859 Test Loss: 0.764 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3360414505004883
Epoch: 10, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.315 Vali Acc: 0.800 Test Loss: 1.315 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1011810302734375
Epoch: 11, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.147 Vali Acc: 0.838 Test Loss: 1.147 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5680146217346191
Epoch: 12, Steps: 8 | Train Loss: 0.154 Vali Loss: 1.279 Vali Acc: 0.791 Test Loss: 1.279 Test Acc: 0.791
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3337376117706299
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.593 Vali Acc: 0.791 Test Loss: 1.593 Test Acc: 0.791
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.402090072631836
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.440 Vali Acc: 0.816 Test Loss: 1.440 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2076725959777832
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.373 Vali Acc: 0.819 Test Loss: 1.373 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.442387342453003
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.436 Vali Acc: 0.831 Test Loss: 1.436 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3931121826171875
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.844 Test Loss: 1.475 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 43910408
model size : 182.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.250797986984253
Epoch: 1, Steps: 8 | Train Loss: 2.179 Vali Loss: 2.039 Vali Acc: 0.125 Test Loss: 2.039 Test Acc: 0.125
Validation loss decreased (inf --> -0.124980).  Saving model ...
Epoch: 2 cost time: 0.8212800025939941
Epoch: 2, Steps: 8 | Train Loss: 1.968 Vali Loss: 1.730 Vali Acc: 0.506 Test Loss: 1.730 Test Acc: 0.506
Validation loss decreased (-0.124980 --> -0.506233).  Saving model ...
Epoch: 3 cost time: 1.133514165878296
Epoch: 3, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.315 Vali Acc: 0.725 Test Loss: 1.315 Test Acc: 0.725
Validation loss decreased (-0.506233 --> -0.724987).  Saving model ...
Epoch: 4 cost time: 1.0724031925201416
Epoch: 4, Steps: 8 | Train Loss: 1.105 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
Validation loss decreased (-0.724987 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 0.7059316635131836
Epoch: 5, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
Validation loss decreased (-0.774991 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 0.6913435459136963
Epoch: 6, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.516 Vali Acc: 0.834 Test Loss: 0.516 Test Acc: 0.834
Validation loss decreased (-0.818744 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.7027771472930908
Epoch: 7, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.9184548854827881
Epoch: 8, Steps: 8 | Train Loss: 0.220 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0989525318145752
Epoch: 9, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.754 Vali Acc: 0.838 Test Loss: 0.754 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0246505737304688
Epoch: 10, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.690 Vali Acc: 0.853 Test Loss: 0.690 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853118).  Saving model ...
Epoch: 11 cost time: 1.119762897491455
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.982 Vali Acc: 0.831 Test Loss: 0.982 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3074228763580322
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.780 Vali Acc: 0.850 Test Loss: 0.780 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9621307849884033
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.878 Vali Acc: 0.841 Test Loss: 0.878 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2169702053070068
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.945 Vali Acc: 0.847 Test Loss: 0.945 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1659729480743408
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.975 Vali Acc: 0.850 Test Loss: 0.975 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9055981636047363
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.969 Vali Acc: 0.856 Test Loss: 0.969 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856240).  Saving model ...
Epoch: 17 cost time: 1.149343490600586
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.949 Vali Acc: 0.834 Test Loss: 0.949 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1687257289886475
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.954 Vali Acc: 0.850 Test Loss: 0.954 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9197425842285156
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.850 Test Loss: 1.000 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9034569263458252
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.989 Vali Acc: 0.853 Test Loss: 0.989 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.044952392578125
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.009 Vali Acc: 0.853 Test Loss: 1.009 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9746913909912109
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.853 Test Loss: 1.006 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.021601676940918
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.847 Test Loss: 1.012 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0578269958496094
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.850 Test Loss: 1.025 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9109611511230469
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.841 Test Loss: 1.041 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8958203792572021
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.844 Test Loss: 1.042 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 43733768
model size : 181.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5565295219421387
Epoch: 1, Steps: 8 | Train Loss: 2.141 Vali Loss: 2.013 Vali Acc: 0.225 Test Loss: 2.013 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 0.5852065086364746
Epoch: 2, Steps: 8 | Train Loss: 1.917 Vali Loss: 1.819 Vali Acc: 0.547 Test Loss: 1.819 Test Acc: 0.547
Validation loss decreased (-0.224980 --> -0.546857).  Saving model ...
Epoch: 3 cost time: 0.6120498180389404
Epoch: 3, Steps: 8 | Train Loss: 1.717 Vali Loss: 1.545 Vali Acc: 0.719 Test Loss: 1.545 Test Acc: 0.719
Validation loss decreased (-0.546857 --> -0.718735).  Saving model ...
Epoch: 4 cost time: 0.7106888294219971
Epoch: 4, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.229 Vali Acc: 0.747 Test Loss: 1.229 Test Acc: 0.747
Validation loss decreased (-0.718735 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.7025258541107178
Epoch: 5, Steps: 8 | Train Loss: 1.087 Vali Loss: 0.892 Vali Acc: 0.791 Test Loss: 0.892 Test Acc: 0.791
Validation loss decreased (-0.746863 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 0.7430989742279053
Epoch: 6, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
Validation loss decreased (-0.790616 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 0.8861536979675293
Epoch: 7, Steps: 8 | Train Loss: 0.445 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
Validation loss decreased (-0.821869 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.7251307964324951
Epoch: 8, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8699464797973633
Epoch: 9, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
Validation loss decreased (-0.831245 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.8745183944702148
Epoch: 10, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.548 Vali Acc: 0.831 Test Loss: 0.548 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8132021427154541
Epoch: 11, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8839046955108643
Epoch: 12, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7708640098571777
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6431317329406738
Epoch: 14, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.657 Vali Acc: 0.834 Test Loss: 0.657 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7643659114837646
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.714 Vali Acc: 0.847 Test Loss: 0.714 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9920845031738281
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.750 Vali Acc: 0.844 Test Loss: 0.750 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8040139675140381
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.759 Vali Acc: 0.834 Test Loss: 0.759 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0743119716644287
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.745 Vali Acc: 0.834 Test Loss: 0.745 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.619196891784668
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.734 Vali Acc: 0.841 Test Loss: 0.734 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 43641608
model size : 181.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.103391170501709
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 1.919 Vali Acc: 0.284 Test Loss: 1.919 Test Acc: 0.284
Validation loss decreased (inf --> -0.284356).  Saving model ...
Epoch: 2 cost time: 0.9507532119750977
Epoch: 2, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.443 Vali Acc: 0.681 Test Loss: 1.443 Test Acc: 0.681
Validation loss decreased (-0.284356 --> -0.681236).  Saving model ...
Epoch: 3 cost time: 0.9744729995727539
Epoch: 3, Steps: 8 | Train Loss: 1.222 Vali Loss: 0.930 Vali Acc: 0.803 Test Loss: 0.930 Test Acc: 0.803
Validation loss decreased (-0.681236 --> -0.803116).  Saving model ...
Epoch: 4 cost time: 0.9978141784667969
Epoch: 4, Steps: 8 | Train Loss: 0.719 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
Validation loss decreased (-0.803116 --> -0.818744).  Saving model ...
Epoch: 5 cost time: 1.6391723155975342
Epoch: 5, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.818744 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 1.7063426971435547
Epoch: 6, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.344599962234497
Epoch: 7, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.637 Vali Acc: 0.834 Test Loss: 0.637 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4349308013916016
Epoch: 8, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.757 Vali Acc: 0.841 Test Loss: 0.757 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3990776538848877
Epoch: 9, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.755 Vali Acc: 0.822 Test Loss: 0.755 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3306529521942139
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.034 Vali Acc: 0.850 Test Loss: 1.034 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849990).  Saving model ...
Epoch: 11 cost time: 1.0140173435211182
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.190 Vali Acc: 0.816 Test Loss: 1.190 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0193665027618408
Epoch: 12, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.054 Vali Acc: 0.859 Test Loss: 1.054 Test Acc: 0.859
Validation loss decreased (-0.849990 --> -0.859364).  Saving model ...
Epoch: 13 cost time: 1.2972898483276367
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.293 Vali Acc: 0.841 Test Loss: 1.293 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6238183975219727
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.162 Vali Acc: 0.841 Test Loss: 1.162 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8205788135528564
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.127 Vali Acc: 0.859 Test Loss: 1.127 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.129988193511963
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.270 Vali Acc: 0.844 Test Loss: 1.270 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5467407703399658
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.281 Vali Acc: 0.847 Test Loss: 1.281 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4451093673706055
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.284 Vali Acc: 0.850 Test Loss: 1.284 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5846858024597168
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.853 Test Loss: 1.293 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7444710731506348
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.850 Test Loss: 1.300 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2361047267913818
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.305 Vali Acc: 0.841 Test Loss: 1.305 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3438186645507812
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.280 Vali Acc: 0.859 Test Loss: 1.280 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 43916552
model size : 182.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5587689876556396
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 1.999 Vali Acc: 0.206 Test Loss: 1.999 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 1.1385462284088135
Epoch: 2, Steps: 8 | Train Loss: 1.897 Vali Loss: 1.696 Vali Acc: 0.581 Test Loss: 1.696 Test Acc: 0.581
Validation loss decreased (-0.206230 --> -0.581233).  Saving model ...
Epoch: 3 cost time: 0.9087815284729004
Epoch: 3, Steps: 8 | Train Loss: 1.525 Vali Loss: 1.286 Vali Acc: 0.731 Test Loss: 1.286 Test Acc: 0.731
Validation loss decreased (-0.581233 --> -0.731237).  Saving model ...
Epoch: 4 cost time: 1.0369014739990234
Epoch: 4, Steps: 8 | Train Loss: 1.141 Vali Loss: 0.891 Vali Acc: 0.809 Test Loss: 0.891 Test Acc: 0.809
Validation loss decreased (-0.731237 --> -0.809366).  Saving model ...
Epoch: 5 cost time: 1.231278896331787
Epoch: 5, Steps: 8 | Train Loss: 0.708 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
Validation loss decreased (-0.809366 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.1129260063171387
Epoch: 6, Steps: 8 | Train Loss: 0.520 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1076860427856445
Epoch: 7, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
Validation loss decreased (-0.815619 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.22987961769104
Epoch: 8, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.674 Vali Acc: 0.812 Test Loss: 0.674 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9158120155334473
Epoch: 9, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.644 Vali Acc: 0.853 Test Loss: 0.644 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853119).  Saving model ...
Epoch: 10 cost time: 1.0493042469024658
Epoch: 10, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.724 Vali Acc: 0.828 Test Loss: 0.724 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0389647483825684
Epoch: 11, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.734 Vali Acc: 0.828 Test Loss: 0.734 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7999026775360107
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.741 Vali Acc: 0.863 Test Loss: 0.741 Test Acc: 0.863
Validation loss decreased (-0.853119 --> -0.862493).  Saving model ...
Epoch: 13 cost time: 1.1237907409667969
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.917 Vali Acc: 0.828 Test Loss: 0.917 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0966010093688965
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.887 Vali Acc: 0.844 Test Loss: 0.887 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0251150131225586
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.855 Vali Acc: 0.847 Test Loss: 0.855 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9827480316162109
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.854 Vali Acc: 0.850 Test Loss: 0.854 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9063963890075684
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.850 Vali Acc: 0.863 Test Loss: 0.850 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.81992506980896
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.841 Test Loss: 0.924 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8239169120788574
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.922 Vali Acc: 0.831 Test Loss: 0.922 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.86724853515625
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.847 Vali Acc: 0.869 Test Loss: 0.847 Test Acc: 0.869
Validation loss decreased (-0.862493 --> -0.868742).  Saving model ...
Epoch: 21 cost time: 1.4374871253967285
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.869 Vali Acc: 0.869 Test Loss: 0.869 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.23370361328125
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.847 Test Loss: 0.938 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.531202793121338
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.932 Vali Acc: 0.853 Test Loss: 0.932 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1221363544464111
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.856 Test Loss: 0.914 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9811906814575195
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.844 Test Loss: 0.942 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4544405937194824
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.930 Vali Acc: 0.850 Test Loss: 0.930 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9433090686798096
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.853 Test Loss: 0.960 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.265782117843628
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.969 Vali Acc: 0.844 Test Loss: 0.969 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0551354885101318
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.844 Test Loss: 1.032 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1588428020477295
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.850 Test Loss: 1.017 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 43732232
model size : 181.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.378938913345337
Epoch: 1, Steps: 8 | Train Loss: 2.205 Vali Loss: 2.077 Vali Acc: 0.147 Test Loss: 2.077 Test Acc: 0.147
Validation loss decreased (inf --> -0.146854).  Saving model ...
Epoch: 2 cost time: 0.8491199016571045
Epoch: 2, Steps: 8 | Train Loss: 2.042 Vali Loss: 1.864 Vali Acc: 0.522 Test Loss: 1.864 Test Acc: 0.522
Validation loss decreased (-0.146854 --> -0.521856).  Saving model ...
Epoch: 3 cost time: 0.9294676780700684
Epoch: 3, Steps: 8 | Train Loss: 1.778 Vali Loss: 1.602 Vali Acc: 0.728 Test Loss: 1.602 Test Acc: 0.728
Validation loss decreased (-0.521856 --> -0.728109).  Saving model ...
Epoch: 4 cost time: 0.6947479248046875
Epoch: 4, Steps: 8 | Train Loss: 1.481 Vali Loss: 1.265 Vali Acc: 0.787 Test Loss: 1.265 Test Acc: 0.787
Validation loss decreased (-0.728109 --> -0.787487).  Saving model ...
Epoch: 5 cost time: 0.7095317840576172
Epoch: 5, Steps: 8 | Train Loss: 1.127 Vali Loss: 0.909 Vali Acc: 0.816 Test Loss: 0.909 Test Acc: 0.816
Validation loss decreased (-0.787487 --> -0.815616).  Saving model ...
Epoch: 6 cost time: 1.024705171585083
Epoch: 6, Steps: 8 | Train Loss: 0.837 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9549715518951416
Epoch: 7, Steps: 8 | Train Loss: 0.539 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
Validation loss decreased (-0.815616 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.19063401222229
Epoch: 8, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.519 Vali Acc: 0.841 Test Loss: 0.519 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.8564400672912598
Epoch: 9, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.483 Vali Acc: 0.856 Test Loss: 0.483 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.8650777339935303
Epoch: 10, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.536 Vali Acc: 0.847 Test Loss: 0.536 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6221599578857422
Epoch: 11, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.533 Vali Acc: 0.884 Test Loss: 0.533 Test Acc: 0.884
Validation loss decreased (-0.856245 --> -0.884370).  Saving model ...
Epoch: 12 cost time: 0.9212911128997803
Epoch: 12, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.624 Vali Acc: 0.869 Test Loss: 0.624 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8294236660003662
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6709680557250977
Epoch: 14, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.639 Vali Acc: 0.872 Test Loss: 0.639 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7490947246551514
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.686 Vali Acc: 0.881 Test Loss: 0.686 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.848642110824585
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.717 Vali Acc: 0.859 Test Loss: 0.717 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8775608539581299
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.751 Vali Acc: 0.863 Test Loss: 0.751 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8573958873748779
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.766 Vali Acc: 0.859 Test Loss: 0.766 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7093420028686523
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.803 Vali Acc: 0.859 Test Loss: 0.803 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8991875648498535
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.802 Vali Acc: 0.863 Test Loss: 0.802 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.768648624420166
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.803 Vali Acc: 0.863 Test Loss: 0.803 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 43640072
model size : 181.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9165050983428955
Epoch: 1, Steps: 8 | Train Loss: 2.179 Vali Loss: 1.988 Vali Acc: 0.212 Test Loss: 1.988 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.9031074047088623
Epoch: 2, Steps: 8 | Train Loss: 1.805 Vali Loss: 1.527 Vali Acc: 0.722 Test Loss: 1.527 Test Acc: 0.722
Validation loss decreased (-0.212480 --> -0.721860).  Saving model ...
Epoch: 3 cost time: 0.8685977458953857
Epoch: 3, Steps: 8 | Train Loss: 1.332 Vali Loss: 1.038 Vali Acc: 0.784 Test Loss: 1.038 Test Acc: 0.784
Validation loss decreased (-0.721860 --> -0.784365).  Saving model ...
Epoch: 4 cost time: 0.935715913772583
Epoch: 4, Steps: 8 | Train Loss: 0.842 Vali Loss: 0.673 Vali Acc: 0.806 Test Loss: 0.673 Test Acc: 0.806
Validation loss decreased (-0.784365 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 0.9226546287536621
Epoch: 5, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.806243 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.9606795310974121
Epoch: 6, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2069754600524902
Epoch: 7, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.740 Vali Acc: 0.812 Test Loss: 0.740 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5782883167266846
Epoch: 8, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.788 Vali Acc: 0.822 Test Loss: 0.788 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2562460899353027
Epoch: 9, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.737 Vali Acc: 0.872 Test Loss: 0.737 Test Acc: 0.872
Validation loss decreased (-0.843745 --> -0.871868).  Saving model ...
Epoch: 10 cost time: 1.436406135559082
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.903 Vali Acc: 0.856 Test Loss: 0.903 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2192046642303467
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.004 Vali Acc: 0.847 Test Loss: 1.004 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2573578357696533
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.061 Vali Acc: 0.838 Test Loss: 1.061 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3568580150604248
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.035 Vali Acc: 0.850 Test Loss: 1.035 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9945669174194336
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.265 Vali Acc: 0.825 Test Loss: 1.265 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4046452045440674
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.292 Vali Acc: 0.834 Test Loss: 1.292 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1012578010559082
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.257 Vali Acc: 0.850 Test Loss: 1.257 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2063217163085938
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.196 Vali Acc: 0.856 Test Loss: 1.196 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5497658252716064
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.200 Vali Acc: 0.853 Test Loss: 1.200 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9560689926147461
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.231 Vali Acc: 0.838 Test Loss: 1.231 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43876616
model size : 182.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9110851287841797
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 2.058 Vali Acc: 0.188 Test Loss: 2.058 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 0.8188095092773438
Epoch: 2, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.754 Vali Acc: 0.597 Test Loss: 1.754 Test Acc: 0.597
Validation loss decreased (-0.187479 --> -0.596857).  Saving model ...
Epoch: 3 cost time: 0.9058864116668701
Epoch: 3, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.342 Vali Acc: 0.731 Test Loss: 1.342 Test Acc: 0.731
Validation loss decreased (-0.596857 --> -0.731237).  Saving model ...
Epoch: 4 cost time: 1.4379661083221436
Epoch: 4, Steps: 8 | Train Loss: 1.147 Vali Loss: 0.891 Vali Acc: 0.791 Test Loss: 0.891 Test Acc: 0.791
Validation loss decreased (-0.731237 --> -0.790616).  Saving model ...
Epoch: 5 cost time: 1.4448297023773193
Epoch: 5, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.579 Vali Acc: 0.825 Test Loss: 0.579 Test Acc: 0.825
Validation loss decreased (-0.790616 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.3336844444274902
Epoch: 6, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.10133957862854
Epoch: 7, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2048454284667969
Epoch: 8, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.670 Vali Acc: 0.819 Test Loss: 0.670 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1456539630889893
Epoch: 9, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.674 Vali Acc: 0.825 Test Loss: 0.674 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.011383295059204
Epoch: 10, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.735 Vali Acc: 0.825 Test Loss: 0.735 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.139449119567871
Epoch: 11, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.741 Vali Acc: 0.841 Test Loss: 0.741 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840618).  Saving model ...
Epoch: 12 cost time: 0.8924229145050049
Epoch: 12, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.765 Vali Acc: 0.847 Test Loss: 0.765 Test Acc: 0.847
Validation loss decreased (-0.840618 --> -0.846867).  Saving model ...
Epoch: 13 cost time: 0.8440895080566406
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.965 Vali Acc: 0.831 Test Loss: 0.965 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3766179084777832
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.815 Vali Acc: 0.856 Test Loss: 0.815 Test Acc: 0.856
Validation loss decreased (-0.846867 --> -0.856242).  Saving model ...
Epoch: 15 cost time: 0.8971273899078369
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.825 Vali Acc: 0.859 Test Loss: 0.825 Test Acc: 0.859
Validation loss decreased (-0.856242 --> -0.859367).  Saving model ...
Epoch: 16 cost time: 1.3727219104766846
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.928 Vali Acc: 0.847 Test Loss: 0.928 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9971306324005127
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.940 Vali Acc: 0.863 Test Loss: 0.940 Test Acc: 0.863
Validation loss decreased (-0.859367 --> -0.862491).  Saving model ...
Epoch: 18 cost time: 1.2927360534667969
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.900 Vali Acc: 0.863 Test Loss: 0.900 Test Acc: 0.863
Validation loss decreased (-0.862491 --> -0.862491).  Saving model ...
Epoch: 19 cost time: 1.2371790409088135
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.925 Vali Acc: 0.863 Test Loss: 0.925 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0016326904296875
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.853 Test Loss: 0.996 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2019789218902588
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.847 Test Loss: 1.029 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0185034275054932
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.031 Vali Acc: 0.850 Test Loss: 1.031 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0795588493347168
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.028 Vali Acc: 0.850 Test Loss: 1.028 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9610438346862793
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.853 Test Loss: 1.017 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6929831504821777
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.853 Test Loss: 1.031 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6361186504364014
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.853 Test Loss: 1.017 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1542253494262695
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.859 Test Loss: 1.013 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8876800537109375
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.863 Test Loss: 1.012 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 43730696
model size : 181.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7625536918640137
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 2.071 Vali Acc: 0.153 Test Loss: 2.071 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 0.7999312877655029
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.889 Vali Acc: 0.441 Test Loss: 1.889 Test Acc: 0.441
Validation loss decreased (-0.153104 --> -0.440606).  Saving model ...
Epoch: 3 cost time: 0.9364414215087891
Epoch: 3, Steps: 8 | Train Loss: 1.790 Vali Loss: 1.681 Vali Acc: 0.588 Test Loss: 1.681 Test Acc: 0.588
Validation loss decreased (-0.440606 --> -0.587483).  Saving model ...
Epoch: 4 cost time: 1.044189453125
Epoch: 4, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.391 Vali Acc: 0.731 Test Loss: 1.391 Test Acc: 0.731
Validation loss decreased (-0.587483 --> -0.731236).  Saving model ...
Epoch: 5 cost time: 1.0963046550750732
Epoch: 5, Steps: 8 | Train Loss: 1.256 Vali Loss: 1.039 Vali Acc: 0.781 Test Loss: 1.039 Test Acc: 0.781
Validation loss decreased (-0.731236 --> -0.781240).  Saving model ...
Epoch: 6 cost time: 1.087841272354126
Epoch: 6, Steps: 8 | Train Loss: 0.881 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
Validation loss decreased (-0.781240 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 1.1303577423095703
Epoch: 7, Steps: 8 | Train Loss: 0.549 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 0.8988120555877686
Epoch: 8, Steps: 8 | Train Loss: 0.435 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821870).  Saving model ...
Epoch: 9 cost time: 0.7771856784820557
Epoch: 9, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9152641296386719
Epoch: 10, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7895388603210449
Epoch: 11, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.654 Vali Acc: 0.838 Test Loss: 0.654 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837493).  Saving model ...
Epoch: 12 cost time: 0.7883749008178711
Epoch: 12, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.721 Vali Acc: 0.838 Test Loss: 0.721 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6132161617279053
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.662 Vali Acc: 0.847 Test Loss: 0.662 Test Acc: 0.847
Validation loss decreased (-0.837493 --> -0.846868).  Saving model ...
Epoch: 14 cost time: 0.9401421546936035
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.733 Vali Acc: 0.853 Test Loss: 0.733 Test Acc: 0.853
Validation loss decreased (-0.846868 --> -0.853118).  Saving model ...
Epoch: 15 cost time: 0.7765724658966064
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.802 Vali Acc: 0.844 Test Loss: 0.802 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7768332958221436
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.869041919708252
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.776 Vali Acc: 0.853 Test Loss: 0.776 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9056742191314697
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.783 Vali Acc: 0.863 Test Loss: 0.783 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862492).  Saving model ...
Epoch: 19 cost time: 0.8240158557891846
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.826 Vali Acc: 0.859 Test Loss: 0.826 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7837517261505127
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.829 Vali Acc: 0.859 Test Loss: 0.829 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7523245811462402
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.818 Vali Acc: 0.859 Test Loss: 0.818 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8610763549804688
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.863 Test Loss: 0.823 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7536258697509766
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.824 Vali Acc: 0.866 Test Loss: 0.824 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865617).  Saving model ...
Epoch: 24 cost time: 0.8139019012451172
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.848 Vali Acc: 0.859 Test Loss: 0.848 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6760683059692383
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.869 Test Loss: 0.863 Test Acc: 0.869
Validation loss decreased (-0.865617 --> -0.868741).  Saving model ...
Epoch: 26 cost time: 0.8200969696044922
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.874 Vali Acc: 0.872 Test Loss: 0.874 Test Acc: 0.872
Validation loss decreased (-0.868741 --> -0.871866).  Saving model ...
Epoch: 27 cost time: 0.8251502513885498
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.866 Test Loss: 0.873 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8657486438751221
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.870 Vali Acc: 0.866 Test Loss: 0.870 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8121485710144043
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.869 Test Loss: 0.871 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7918171882629395
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.869 Vali Acc: 0.866 Test Loss: 0.869 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8650803565979004
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.877 Vali Acc: 0.866 Test Loss: 0.877 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8710403442382812
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.863 Test Loss: 0.895 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.809211254119873
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.918 Vali Acc: 0.863 Test Loss: 0.918 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0375149250030518
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.918 Vali Acc: 0.866 Test Loss: 0.918 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8998701572418213
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.866 Test Loss: 0.910 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7486953735351562
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.859 Test Loss: 0.898 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43646216
model size : 181.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9263291358947754
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 2.007 Vali Acc: 0.266 Test Loss: 2.007 Test Acc: 0.266
Validation loss decreased (inf --> -0.265605).  Saving model ...
Epoch: 2 cost time: 0.9895608425140381
Epoch: 2, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.568 Vali Acc: 0.519 Test Loss: 1.568 Test Acc: 0.519
Validation loss decreased (-0.265605 --> -0.518734).  Saving model ...
Epoch: 3 cost time: 1.261382818222046
Epoch: 3, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.070 Vali Acc: 0.756 Test Loss: 1.070 Test Acc: 0.756
Validation loss decreased (-0.518734 --> -0.756239).  Saving model ...
Epoch: 4 cost time: 1.2850093841552734
Epoch: 4, Steps: 8 | Train Loss: 0.821 Vali Loss: 0.667 Vali Acc: 0.797 Test Loss: 0.667 Test Acc: 0.797
Validation loss decreased (-0.756239 --> -0.796868).  Saving model ...
Epoch: 5 cost time: 1.2235844135284424
Epoch: 5, Steps: 8 | Train Loss: 0.491 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
Validation loss decreased (-0.796868 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 1.4736762046813965
Epoch: 6, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 1.0973117351531982
Epoch: 7, Steps: 8 | Train Loss: 0.177 Vali Loss: 0.722 Vali Acc: 0.825 Test Loss: 0.722 Test Acc: 0.825
Validation loss decreased (-0.821869 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 1.3358979225158691
Epoch: 8, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.784 Vali Acc: 0.838 Test Loss: 0.784 Test Acc: 0.838
Validation loss decreased (-0.824993 --> -0.837492).  Saving model ...
Epoch: 9 cost time: 1.41434907913208
Epoch: 9, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.772 Vali Acc: 0.866 Test Loss: 0.772 Test Acc: 0.866
Validation loss decreased (-0.837492 --> -0.865617).  Saving model ...
Epoch: 10 cost time: 0.914435863494873
Epoch: 10, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.977 Vali Acc: 0.847 Test Loss: 0.977 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2222533226013184
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.953 Vali Acc: 0.850 Test Loss: 0.953 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.139815092086792
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.986 Vali Acc: 0.844 Test Loss: 0.986 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2989890575408936
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.132 Vali Acc: 0.856 Test Loss: 1.132 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3520071506500244
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.085 Vali Acc: 0.844 Test Loss: 1.085 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.375246524810791
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.420 Vali Acc: 0.838 Test Loss: 1.420 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4708261489868164
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.076 Vali Acc: 0.822 Test Loss: 1.076 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7498631477355957
Epoch: 17, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.248 Vali Acc: 0.844 Test Loss: 1.248 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5486702919006348
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.658 Vali Acc: 0.847 Test Loss: 1.658 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.364743709564209
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.247 Vali Acc: 0.872 Test Loss: 1.247 Test Acc: 0.872
Validation loss decreased (-0.865617 --> -0.871863).  Saving model ...
Epoch: 20 cost time: 0.9626612663269043
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.850 Test Loss: 1.334 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1401383876800537
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.279 Vali Acc: 0.850 Test Loss: 1.279 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6319525241851807
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.844 Test Loss: 1.287 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1656763553619385
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.402 Vali Acc: 0.841 Test Loss: 1.402 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3903894424438477
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.859 Test Loss: 1.481 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4414565563201904
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.859 Test Loss: 1.455 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4229357242584229
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.863 Test Loss: 1.392 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2553915977478027
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.521 Vali Acc: 0.866 Test Loss: 1.521 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.429697036743164
Epoch: 28, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.618 Vali Acc: 0.850 Test Loss: 1.618 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2729134559631348
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.850 Test Loss: 1.512 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43890440
model size : 182.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.713020086288452
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 2.012 Vali Acc: 0.219 Test Loss: 2.012 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.8345949649810791
Epoch: 2, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.733 Vali Acc: 0.556 Test Loss: 1.733 Test Acc: 0.556
Validation loss decreased (-0.218730 --> -0.556233).  Saving model ...
Epoch: 3 cost time: 0.732945442199707
Epoch: 3, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.384 Vali Acc: 0.600 Test Loss: 1.384 Test Acc: 0.600
Validation loss decreased (-0.556233 --> -0.599986).  Saving model ...
Epoch: 4 cost time: 1.4276947975158691
Epoch: 4, Steps: 8 | Train Loss: 1.276 Vali Loss: 0.965 Vali Acc: 0.787 Test Loss: 0.965 Test Acc: 0.787
Validation loss decreased (-0.599986 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 1.0403590202331543
Epoch: 5, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.664 Vali Acc: 0.806 Test Loss: 0.664 Test Acc: 0.806
Validation loss decreased (-0.787490 --> -0.806243).  Saving model ...
Epoch: 6 cost time: 0.8885374069213867
Epoch: 6, Steps: 8 | Train Loss: 0.505 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 1.3052215576171875
Epoch: 7, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4758014678955078
Epoch: 8, Steps: 8 | Train Loss: 0.236 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 0.7296814918518066
Epoch: 9, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8183896541595459
Epoch: 10, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9222767353057861
Epoch: 11, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.658 Vali Acc: 0.838 Test Loss: 0.658 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4727389812469482
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.708 Vali Acc: 0.859 Test Loss: 0.708 Test Acc: 0.859
Validation loss decreased (-0.849994 --> -0.859368).  Saving model ...
Epoch: 13 cost time: 1.2298362255096436
Epoch: 13, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.699 Vali Acc: 0.831 Test Loss: 0.699 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2198638916015625
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.843 Vali Acc: 0.844 Test Loss: 0.843 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.127143144607544
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0924499034881592
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.733 Vali Acc: 0.863 Test Loss: 0.733 Test Acc: 0.863
Validation loss decreased (-0.859368 --> -0.862493).  Saving model ...
Epoch: 17 cost time: 0.8543078899383545
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.864 Vali Acc: 0.869 Test Loss: 0.864 Test Acc: 0.869
Validation loss decreased (-0.862493 --> -0.868741).  Saving model ...
Epoch: 18 cost time: 0.9162681102752686
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.102 Vali Acc: 0.841 Test Loss: 1.102 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3997271060943604
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.889 Vali Acc: 0.850 Test Loss: 0.889 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1159248352050781
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.866 Test Loss: 0.794 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1274590492248535
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.860 Vali Acc: 0.875 Test Loss: 0.860 Test Acc: 0.875
Validation loss decreased (-0.868741 --> -0.874991).  Saving model ...
Epoch: 22 cost time: 1.0907659530639648
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.869 Test Loss: 0.907 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4103317260742188
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.967 Vali Acc: 0.863 Test Loss: 0.967 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.00217866897583
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.856 Test Loss: 0.996 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.28275465965271
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.947 Vali Acc: 0.863 Test Loss: 0.947 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.095714807510376
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.869 Test Loss: 0.891 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.109917163848877
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.873 Vali Acc: 0.866 Test Loss: 0.873 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2953071594238281
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.895 Vali Acc: 0.872 Test Loss: 0.895 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9848630428314209
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.875 Test Loss: 0.915 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2255744934082031
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.878 Test Loss: 0.915 Test Acc: 0.878
Validation loss decreased (-0.874991 --> -0.878116).  Saving model ...
Epoch: 31 cost time: 1.340764045715332
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.878 Test Loss: 0.907 Test Acc: 0.878
Validation loss decreased (-0.878116 --> -0.878116).  Saving model ...
Epoch: 32 cost time: 1.0543873310089111
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.878 Test Loss: 0.898 Test Acc: 0.878
Validation loss decreased (-0.878116 --> -0.878116).  Saving model ...
Epoch: 33 cost time: 0.9288997650146484
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.878 Test Loss: 0.899 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0702805519104004
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.875 Test Loss: 0.907 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9425899982452393
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.872 Test Loss: 0.923 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4292075634002686
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.872 Test Loss: 0.934 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.194366455078125
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.869 Test Loss: 0.950 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4563145637512207
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.866 Test Loss: 0.956 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2257120609283447
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.875 Test Loss: 0.945 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.5311918258666992
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.878 Test Loss: 0.943 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.213106393814087
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.878 Test Loss: 0.942 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4274218082427979
Epoch: 42, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.872 Test Loss: 0.958 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 43729160
model size : 181.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5190513134002686
Epoch: 1, Steps: 8 | Train Loss: 2.237 Vali Loss: 2.115 Vali Acc: 0.134 Test Loss: 2.115 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 0.8520987033843994
Epoch: 2, Steps: 8 | Train Loss: 2.034 Vali Loss: 1.921 Vali Acc: 0.366 Test Loss: 1.921 Test Acc: 0.366
Validation loss decreased (-0.134354 --> -0.365606).  Saving model ...
Epoch: 3 cost time: 0.7075808048248291
Epoch: 3, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.702 Vali Acc: 0.566 Test Loss: 1.702 Test Acc: 0.566
Validation loss decreased (-0.365606 --> -0.565608).  Saving model ...
Epoch: 4 cost time: 0.8274118900299072
Epoch: 4, Steps: 8 | Train Loss: 1.595 Vali Loss: 1.431 Vali Acc: 0.703 Test Loss: 1.431 Test Acc: 0.703
Validation loss decreased (-0.565608 --> -0.703111).  Saving model ...
Epoch: 5 cost time: 0.880361795425415
Epoch: 5, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.117 Vali Acc: 0.750 Test Loss: 1.117 Test Acc: 0.750
Validation loss decreased (-0.703111 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 0.6235997676849365
Epoch: 6, Steps: 8 | Train Loss: 0.934 Vali Loss: 0.758 Vali Acc: 0.803 Test Loss: 0.758 Test Acc: 0.803
Validation loss decreased (-0.749989 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.7214670181274414
Epoch: 7, Steps: 8 | Train Loss: 0.681 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
Validation loss decreased (-0.803117 --> -0.803119).  Saving model ...
Epoch: 8 cost time: 0.769916296005249
Epoch: 8, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.478 Vali Acc: 0.831 Test Loss: 0.478 Test Acc: 0.831
Validation loss decreased (-0.803119 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 1.0769360065460205
Epoch: 9, Steps: 8 | Train Loss: 0.254 Vali Loss: 0.526 Vali Acc: 0.831 Test Loss: 0.526 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9196443557739258
Epoch: 10, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.7689259052276611
Epoch: 11, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.542 Vali Acc: 0.847 Test Loss: 0.542 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.7711474895477295
Epoch: 12, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.572 Vali Acc: 0.856 Test Loss: 0.572 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856244).  Saving model ...
Epoch: 13 cost time: 1.0729403495788574
Epoch: 13, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.599 Vali Acc: 0.841 Test Loss: 0.599 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8233447074890137
Epoch: 14, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 0.9396154880523682
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.618 Vali Acc: 0.863 Test Loss: 0.618 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 16 cost time: 0.9299619197845459
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.571 Vali Acc: 0.872 Test Loss: 0.571 Test Acc: 0.872
Validation loss decreased (-0.862494 --> -0.871869).  Saving model ...
Epoch: 17 cost time: 0.7760159969329834
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.853 Test Loss: 0.621 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.910414457321167
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.640 Vali Acc: 0.859 Test Loss: 0.640 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9036757946014404
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9749317169189453
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.669 Vali Acc: 0.863 Test Loss: 0.669 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0131142139434814
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0113580226898193
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.640 Vali Acc: 0.872 Test Loss: 0.640 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9416608810424805
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.869 Test Loss: 0.644 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9684281349182129
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.657 Vali Acc: 0.869 Test Loss: 0.657 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7212684154510498
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.866 Test Loss: 0.680 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6801228523254395
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.863 Test Loss: 0.674 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43652360
model size : 181.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4116029739379883
Epoch: 1, Steps: 8 | Train Loss: 2.191 Vali Loss: 2.014 Vali Acc: 0.225 Test Loss: 2.014 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 1.2645044326782227
Epoch: 2, Steps: 8 | Train Loss: 1.903 Vali Loss: 1.589 Vali Acc: 0.606 Test Loss: 1.589 Test Acc: 0.606
Validation loss decreased (-0.224980 --> -0.606234).  Saving model ...
Epoch: 3 cost time: 0.9336299896240234
Epoch: 3, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.071 Vali Acc: 0.794 Test Loss: 1.071 Test Acc: 0.794
Validation loss decreased (-0.606234 --> -0.793739).  Saving model ...
Epoch: 4 cost time: 1.1061830520629883
Epoch: 4, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.684 Vali Acc: 0.778 Test Loss: 0.684 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.027681827545166
Epoch: 5, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.793739 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 0.9094445705413818
Epoch: 6, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0133543014526367
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828118).  Saving model ...
Epoch: 8 cost time: 0.9723682403564453
Epoch: 8, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.694 Vali Acc: 0.834 Test Loss: 0.694 Test Acc: 0.834
Validation loss decreased (-0.828118 --> -0.834368).  Saving model ...
Epoch: 9 cost time: 1.0611448287963867
Epoch: 9, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
Validation loss decreased (-0.834368 --> -0.856243).  Saving model ...
Epoch: 10 cost time: 0.811232328414917
Epoch: 10, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.954 Vali Acc: 0.819 Test Loss: 0.954 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8360006809234619
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.885 Vali Acc: 0.869 Test Loss: 0.885 Test Acc: 0.869
Validation loss decreased (-0.856243 --> -0.868741).  Saving model ...
Epoch: 12 cost time: 1.1106455326080322
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.995 Vali Acc: 0.847 Test Loss: 0.995 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1879558563232422
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.056 Vali Acc: 0.853 Test Loss: 1.056 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.344635009765625
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.863 Test Loss: 1.017 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0097711086273193
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.866 Test Loss: 1.006 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.146885633468628
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.869 Test Loss: 1.007 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9706308841705322
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.077 Vali Acc: 0.866 Test Loss: 1.077 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9325146675109863
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.856 Test Loss: 1.077 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0298330783843994
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.853 Test Loss: 1.051 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.080758810043335
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.863 Test Loss: 1.047 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8598840236663818
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.060 Vali Acc: 0.863 Test Loss: 1.060 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 43858184
model size : 181.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3930561542510986
Epoch: 1, Steps: 8 | Train Loss: 2.140 Vali Loss: 1.993 Vali Acc: 0.172 Test Loss: 1.993 Test Acc: 0.172
Validation loss decreased (inf --> -0.171855).  Saving model ...
Epoch: 2 cost time: 0.8177270889282227
Epoch: 2, Steps: 8 | Train Loss: 1.890 Vali Loss: 1.686 Vali Acc: 0.644 Test Loss: 1.686 Test Acc: 0.644
Validation loss decreased (-0.171855 --> -0.643733).  Saving model ...
Epoch: 3 cost time: 1.286886215209961
Epoch: 3, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.325 Vali Acc: 0.722 Test Loss: 1.325 Test Acc: 0.722
Validation loss decreased (-0.643733 --> -0.721862).  Saving model ...
Epoch: 4 cost time: 1.3373801708221436
Epoch: 4, Steps: 8 | Train Loss: 1.154 Vali Loss: 0.913 Vali Acc: 0.797 Test Loss: 0.913 Test Acc: 0.797
Validation loss decreased (-0.721862 --> -0.796866).  Saving model ...
Epoch: 5 cost time: 1.2432153224945068
Epoch: 5, Steps: 8 | Train Loss: 0.732 Vali Loss: 0.626 Vali Acc: 0.778 Test Loss: 0.626 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9219551086425781
Epoch: 6, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.537 Vali Acc: 0.834 Test Loss: 0.537 Test Acc: 0.834
Validation loss decreased (-0.796866 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 1.2334089279174805
Epoch: 7, Steps: 8 | Train Loss: 0.363 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1755030155181885
Epoch: 8, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.672 Vali Acc: 0.841 Test Loss: 0.672 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840618).  Saving model ...
Epoch: 9 cost time: 1.1532659530639648
Epoch: 9, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.648 Vali Acc: 0.859 Test Loss: 0.648 Test Acc: 0.859
Validation loss decreased (-0.840618 --> -0.859369).  Saving model ...
Epoch: 10 cost time: 0.9770019054412842
Epoch: 10, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.633 Vali Acc: 0.863 Test Loss: 0.633 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 11 cost time: 1.1620640754699707
Epoch: 11, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.712 Vali Acc: 0.847 Test Loss: 0.712 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1644508838653564
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.783 Vali Acc: 0.856 Test Loss: 0.783 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.050915241241455
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.789 Vali Acc: 0.872 Test Loss: 0.789 Test Acc: 0.872
Validation loss decreased (-0.862494 --> -0.871867).  Saving model ...
Epoch: 14 cost time: 1.3485500812530518
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.757 Vali Acc: 0.872 Test Loss: 0.757 Test Acc: 0.872
Validation loss decreased (-0.871867 --> -0.871867).  Saving model ...
Epoch: 15 cost time: 1.0083162784576416
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.806 Vali Acc: 0.863 Test Loss: 0.806 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8471434116363525
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.831 Vali Acc: 0.875 Test Loss: 0.831 Test Acc: 0.875
Validation loss decreased (-0.871867 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.8070247173309326
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.878 Test Loss: 0.846 Test Acc: 0.878
Validation loss decreased (-0.874992 --> -0.878117).  Saving model ...
Epoch: 18 cost time: 1.172534465789795
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.838 Vali Acc: 0.875 Test Loss: 0.838 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9328360557556152
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.875 Test Loss: 0.858 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8651208877563477
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.875 Test Loss: 0.871 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8613808155059814
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.872 Test Loss: 0.860 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7782633304595947
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.875 Test Loss: 0.842 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8571567535400391
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.878 Test Loss: 0.905 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.930659294128418
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.881 Test Loss: 0.935 Test Acc: 0.881
Validation loss decreased (-0.878117 --> -0.881241).  Saving model ...
Epoch: 25 cost time: 0.8289077281951904
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.891 Test Loss: 0.918 Test Acc: 0.891
Validation loss decreased (-0.881241 --> -0.890616).  Saving model ...
Epoch: 26 cost time: 1.132538080215454
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.908 Vali Acc: 0.872 Test Loss: 0.908 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1716158390045166
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.872 Test Loss: 0.907 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2441093921661377
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.875 Test Loss: 0.914 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0138521194458008
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.881 Test Loss: 0.916 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0119869709014893
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.872 Test Loss: 0.918 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9950652122497559
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.875 Test Loss: 0.916 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0986335277557373
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.872 Test Loss: 0.914 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.965634822845459
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.872 Test Loss: 0.917 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8775012493133545
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.872 Test Loss: 0.921 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8270049095153809
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.872 Test Loss: 0.927 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.890625
model parameter : 43735304
model size : 181.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.237013101577759
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 2.061 Vali Acc: 0.206 Test Loss: 2.061 Test Acc: 0.206
Validation loss decreased (inf --> -0.206229).  Saving model ...
Epoch: 2 cost time: 0.8341207504272461
Epoch: 2, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.880 Vali Acc: 0.419 Test Loss: 1.880 Test Acc: 0.419
Validation loss decreased (-0.206229 --> -0.418731).  Saving model ...
Epoch: 3 cost time: 0.7621734142303467
Epoch: 3, Steps: 8 | Train Loss: 1.801 Vali Loss: 1.640 Vali Acc: 0.650 Test Loss: 1.640 Test Acc: 0.650
Validation loss decreased (-0.418731 --> -0.649984).  Saving model ...
Epoch: 4 cost time: 1.061746597290039
Epoch: 4, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.341 Vali Acc: 0.787 Test Loss: 1.341 Test Acc: 0.787
Validation loss decreased (-0.649984 --> -0.787487).  Saving model ...
Epoch: 5 cost time: 0.943108320236206
Epoch: 5, Steps: 8 | Train Loss: 1.251 Vali Loss: 0.998 Vali Acc: 0.809 Test Loss: 0.998 Test Acc: 0.809
Validation loss decreased (-0.787487 --> -0.809365).  Saving model ...
Epoch: 6 cost time: 0.8503167629241943
Epoch: 6, Steps: 8 | Train Loss: 0.847 Vali Loss: 0.664 Vali Acc: 0.819 Test Loss: 0.664 Test Acc: 0.819
Validation loss decreased (-0.809365 --> -0.818743).  Saving model ...
Epoch: 7 cost time: 0.855889081954956
Epoch: 7, Steps: 8 | Train Loss: 0.580 Vali Loss: 0.516 Vali Acc: 0.816 Test Loss: 0.516 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.09519362449646
Epoch: 8, Steps: 8 | Train Loss: 0.382 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.818743 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 1.1179907321929932
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.857128381729126
Epoch: 10, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.560 Vali Acc: 0.831 Test Loss: 0.560 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7622261047363281
Epoch: 11, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7955756187438965
Epoch: 12, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1670715808868408
Epoch: 13, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.596 Vali Acc: 0.853 Test Loss: 0.596 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 14 cost time: 1.1708853244781494
Epoch: 14, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.625 Vali Acc: 0.847 Test Loss: 0.625 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2171130180358887
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.666 Vali Acc: 0.859 Test Loss: 0.666 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859368).  Saving model ...
Epoch: 16 cost time: 0.9548177719116211
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.656 Vali Acc: 0.859 Test Loss: 0.656 Test Acc: 0.859
Validation loss decreased (-0.859368 --> -0.859368).  Saving model ...
Epoch: 17 cost time: 0.722977876663208
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.634 Vali Acc: 0.872 Test Loss: 0.634 Test Acc: 0.872
Validation loss decreased (-0.859368 --> -0.871869).  Saving model ...
Epoch: 18 cost time: 0.8236126899719238
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.813246488571167
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.675 Vali Acc: 0.863 Test Loss: 0.675 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0953550338745117
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.710 Vali Acc: 0.866 Test Loss: 0.710 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6773984432220459
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.744 Vali Acc: 0.863 Test Loss: 0.744 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7061896324157715
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.744 Vali Acc: 0.863 Test Loss: 0.744 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0349125862121582
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8768031597137451
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.726 Vali Acc: 0.869 Test Loss: 0.726 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.088454008102417
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.872 Test Loss: 0.729 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8679392337799072
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.872 Test Loss: 0.743 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7848608493804932
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.764 Vali Acc: 0.866 Test Loss: 0.764 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43658504
model size : 181.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7015507221221924
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 1.985 Vali Acc: 0.222 Test Loss: 1.985 Test Acc: 0.222
Validation loss decreased (inf --> -0.221855).  Saving model ...
Epoch: 2 cost time: 1.469731092453003
Epoch: 2, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.594 Vali Acc: 0.572 Test Loss: 1.594 Test Acc: 0.572
Validation loss decreased (-0.221855 --> -0.571859).  Saving model ...
Epoch: 3 cost time: 1.4554123878479004
Epoch: 3, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.131 Vali Acc: 0.762 Test Loss: 1.131 Test Acc: 0.762
Validation loss decreased (-0.571859 --> -0.762489).  Saving model ...
Epoch: 4 cost time: 1.6055011749267578
Epoch: 4, Steps: 8 | Train Loss: 0.913 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
Validation loss decreased (-0.762489 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 1.1611053943634033
Epoch: 5, Steps: 8 | Train Loss: 0.544 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 1.3286123275756836
Epoch: 6, Steps: 8 | Train Loss: 0.437 Vali Loss: 0.654 Vali Acc: 0.812 Test Loss: 0.654 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0744738578796387
Epoch: 7, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.683 Vali Acc: 0.841 Test Loss: 0.683 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840618).  Saving model ...
Epoch: 8 cost time: 1.1768033504486084
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.820 Vali Acc: 0.806 Test Loss: 0.820 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2833271026611328
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.844 Vali Acc: 0.844 Test Loss: 0.844 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843742).  Saving model ...
Epoch: 10 cost time: 1.285334587097168
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.746 Vali Acc: 0.859 Test Loss: 0.746 Test Acc: 0.859
Validation loss decreased (-0.843742 --> -0.859368).  Saving model ...
Epoch: 11 cost time: 1.2333736419677734
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.914 Vali Acc: 0.834 Test Loss: 0.914 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4360978603363037
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.925 Vali Acc: 0.844 Test Loss: 0.925 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.168604850769043
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.908 Vali Acc: 0.838 Test Loss: 0.908 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0484881401062012
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.910 Vali Acc: 0.850 Test Loss: 0.910 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0762169361114502
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.026 Vali Acc: 0.850 Test Loss: 1.026 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9528262615203857
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.021 Vali Acc: 0.850 Test Loss: 1.021 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7644879817962646
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.853 Test Loss: 1.004 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0051007270812988
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.841 Test Loss: 1.023 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8488888740539551
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.847 Test Loss: 0.997 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0628650188446045
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.853 Test Loss: 0.963 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 43878920
model size : 182.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.4681787490844727
Epoch: 1, Steps: 8 | Train Loss: 2.252 Vali Loss: 2.116 Vali Acc: 0.156 Test Loss: 2.116 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 1.4387927055358887
Epoch: 2, Steps: 8 | Train Loss: 1.991 Vali Loss: 1.829 Vali Acc: 0.494 Test Loss: 1.829 Test Acc: 0.494
Validation loss decreased (-0.156229 --> -0.493732).  Saving model ...
Epoch: 3 cost time: 1.5579743385314941
Epoch: 3, Steps: 8 | Train Loss: 1.726 Vali Loss: 1.512 Vali Acc: 0.750 Test Loss: 1.512 Test Acc: 0.750
Validation loss decreased (-0.493732 --> -0.749985).  Saving model ...
Epoch: 4 cost time: 0.9848363399505615
Epoch: 4, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.076 Vali Acc: 0.812 Test Loss: 1.076 Test Acc: 0.812
Validation loss decreased (-0.749985 --> -0.812489).  Saving model ...
Epoch: 5 cost time: 1.2845966815948486
Epoch: 5, Steps: 8 | Train Loss: 0.865 Vali Loss: 0.674 Vali Acc: 0.812 Test Loss: 0.674 Test Acc: 0.812
Validation loss decreased (-0.812489 --> -0.812493).  Saving model ...
Epoch: 6 cost time: 0.7735564708709717
Epoch: 6, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.553 Vali Acc: 0.797 Test Loss: 0.553 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0802810192108154
Epoch: 7, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
Validation loss decreased (-0.812493 --> -0.818745).  Saving model ...
Epoch: 8 cost time: 1.1270575523376465
Epoch: 8, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.608 Vali Acc: 0.834 Test Loss: 0.608 Test Acc: 0.834
Validation loss decreased (-0.818745 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 1.2149267196655273
Epoch: 9, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.666 Vali Acc: 0.831 Test Loss: 0.666 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7136194705963135
Epoch: 10, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.666 Vali Acc: 0.838 Test Loss: 0.666 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837493).  Saving model ...
Epoch: 11 cost time: 1.2326817512512207
Epoch: 11, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.701 Vali Acc: 0.844 Test Loss: 0.701 Test Acc: 0.844
Validation loss decreased (-0.837493 --> -0.843743).  Saving model ...
Epoch: 12 cost time: 0.9711387157440186
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.756 Vali Acc: 0.847 Test Loss: 0.756 Test Acc: 0.847
Validation loss decreased (-0.843743 --> -0.846867).  Saving model ...
Epoch: 13 cost time: 1.0102694034576416
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.741 Vali Acc: 0.853 Test Loss: 0.741 Test Acc: 0.853
Validation loss decreased (-0.846867 --> -0.853118).  Saving model ...
Epoch: 14 cost time: 0.8833503723144531
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.789 Vali Acc: 0.856 Test Loss: 0.789 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856242).  Saving model ...
Epoch: 15 cost time: 1.042128086090088
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.767 Vali Acc: 0.866 Test Loss: 0.767 Test Acc: 0.866
Validation loss decreased (-0.856242 --> -0.865617).  Saving model ...
Epoch: 16 cost time: 1.4397656917572021
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.830 Vali Acc: 0.847 Test Loss: 0.830 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3959989547729492
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.827 Vali Acc: 0.853 Test Loss: 0.827 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2311627864837646
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.850 Test Loss: 0.812 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4774842262268066
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.819 Vali Acc: 0.853 Test Loss: 0.819 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3085544109344482
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.850 Test Loss: 0.804 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3771064281463623
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.859 Test Loss: 0.801 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4410762786865234
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.859 Test Loss: 0.806 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8517754077911377
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.863 Test Loss: 0.810 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8250906467437744
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.866 Test Loss: 0.808 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8864068984985352
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.856 Test Loss: 0.816 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 43740680
model size : 181.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.510061264038086
Epoch: 1, Steps: 8 | Train Loss: 2.084 Vali Loss: 2.031 Vali Acc: 0.212 Test Loss: 2.031 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.8153431415557861
Epoch: 2, Steps: 8 | Train Loss: 1.980 Vali Loss: 1.879 Vali Acc: 0.519 Test Loss: 1.879 Test Acc: 0.519
Validation loss decreased (-0.212480 --> -0.518731).  Saving model ...
Epoch: 3 cost time: 0.8037233352661133
Epoch: 3, Steps: 8 | Train Loss: 1.784 Vali Loss: 1.668 Vali Acc: 0.625 Test Loss: 1.668 Test Acc: 0.625
Validation loss decreased (-0.518731 --> -0.624983).  Saving model ...
Epoch: 4 cost time: 0.7073321342468262
Epoch: 4, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.386 Vali Acc: 0.769 Test Loss: 1.386 Test Acc: 0.769
Validation loss decreased (-0.624983 --> -0.768736).  Saving model ...
Epoch: 5 cost time: 0.7852587699890137
Epoch: 5, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.053 Vali Acc: 0.766 Test Loss: 1.053 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6761236190795898
Epoch: 6, Steps: 8 | Train Loss: 0.912 Vali Loss: 0.743 Vali Acc: 0.784 Test Loss: 0.743 Test Acc: 0.784
Validation loss decreased (-0.768736 --> -0.784368).  Saving model ...
Epoch: 7 cost time: 0.8038012981414795
Epoch: 7, Steps: 8 | Train Loss: 0.616 Vali Loss: 0.599 Vali Acc: 0.791 Test Loss: 0.599 Test Acc: 0.791
Validation loss decreased (-0.784368 --> -0.790619).  Saving model ...
Epoch: 8 cost time: 0.697246789932251
Epoch: 8, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
Validation loss decreased (-0.790619 --> -0.806244).  Saving model ...
Epoch: 9 cost time: 0.7772021293640137
Epoch: 9, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.806244 --> -0.824994).  Saving model ...
Epoch: 10 cost time: 0.8562610149383545
Epoch: 10, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.646 Vali Acc: 0.819 Test Loss: 0.646 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8915643692016602
Epoch: 11, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9764058589935303
Epoch: 12, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.642 Vali Acc: 0.841 Test Loss: 0.642 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840619).  Saving model ...
Epoch: 13 cost time: 0.7669174671173096
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.677 Vali Acc: 0.847 Test Loss: 0.677 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846868).  Saving model ...
Epoch: 14 cost time: 0.733952522277832
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9891483783721924
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.692 Vali Acc: 0.841 Test Loss: 0.692 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7732734680175781
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.702 Vali Acc: 0.841 Test Loss: 0.702 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8876991271972656
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.728 Vali Acc: 0.847 Test Loss: 0.728 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8843514919281006
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.742 Vali Acc: 0.853 Test Loss: 0.742 Test Acc: 0.853
Validation loss decreased (-0.846868 --> -0.853118).  Saving model ...
Epoch: 19 cost time: 0.9180941581726074
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.739 Vali Acc: 0.847 Test Loss: 0.739 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9135026931762695
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9287641048431396
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9266111850738525
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.784 Vali Acc: 0.847 Test Loss: 0.784 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7231273651123047
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7564294338226318
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.779 Vali Acc: 0.850 Test Loss: 0.779 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8431682586669922
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.772 Vali Acc: 0.844 Test Loss: 0.772 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7720010280609131
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.773 Vali Acc: 0.844 Test Loss: 0.773 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5973320007324219
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8193771839141846
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.847 Test Loss: 0.797 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 43671560
model size : 181.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9251646995544434
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 1.998 Vali Acc: 0.272 Test Loss: 1.998 Test Acc: 0.272
Validation loss decreased (inf --> -0.271855).  Saving model ...
Epoch: 2 cost time: 0.9781429767608643
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.646 Vali Acc: 0.637 Test Loss: 1.646 Test Acc: 0.637
Validation loss decreased (-0.271855 --> -0.637484).  Saving model ...
Epoch: 3 cost time: 0.930415153503418
Epoch: 3, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.198 Vali Acc: 0.781 Test Loss: 1.198 Test Acc: 0.781
Validation loss decreased (-0.637484 --> -0.781238).  Saving model ...
Epoch: 4 cost time: 1.2986087799072266
Epoch: 4, Steps: 8 | Train Loss: 1.021 Vali Loss: 0.783 Vali Acc: 0.794 Test Loss: 0.783 Test Acc: 0.794
Validation loss decreased (-0.781238 --> -0.793742).  Saving model ...
Epoch: 5 cost time: 1.2373270988464355
Epoch: 5, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
Validation loss decreased (-0.793742 --> -0.840619).  Saving model ...
Epoch: 6 cost time: 1.3062853813171387
Epoch: 6, Steps: 8 | Train Loss: 0.376 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0508005619049072
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.562 Vali Acc: 0.828 Test Loss: 0.562 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1729276180267334
Epoch: 8, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9758918285369873
Epoch: 9, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 1.0290138721466064
Epoch: 10, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.846 Vali Acc: 0.847 Test Loss: 0.846 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7419869899749756
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.826 Vali Acc: 0.869 Test Loss: 0.826 Test Acc: 0.869
Validation loss decreased (-0.849993 --> -0.868742).  Saving model ...
Epoch: 12 cost time: 0.952103853225708
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.860 Vali Acc: 0.869 Test Loss: 0.860 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.041581153869629
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.907 Vali Acc: 0.869 Test Loss: 0.907 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0168991088867188
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.026 Vali Acc: 0.853 Test Loss: 1.026 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1274564266204834
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.019 Vali Acc: 0.853 Test Loss: 1.019 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1229181289672852
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.037 Vali Acc: 0.847 Test Loss: 1.037 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.329801321029663
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.844 Test Loss: 1.034 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1255526542663574
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.853 Test Loss: 1.019 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.078413963317871
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.863 Test Loss: 1.005 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4495434761047363
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.866 Test Loss: 1.016 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9406516551971436
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.866 Test Loss: 1.011 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 43868936
model size : 182.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5087547302246094
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.019 Vali Acc: 0.212 Test Loss: 2.019 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 1.0869638919830322
Epoch: 2, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.799 Vali Acc: 0.525 Test Loss: 1.799 Test Acc: 0.525
Validation loss decreased (-0.212480 --> -0.524982).  Saving model ...
Epoch: 3 cost time: 0.8777685165405273
Epoch: 3, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.480 Vali Acc: 0.697 Test Loss: 1.480 Test Acc: 0.697
Validation loss decreased (-0.524982 --> -0.696860).  Saving model ...
Epoch: 4 cost time: 1.1872987747192383
Epoch: 4, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.125 Vali Acc: 0.750 Test Loss: 1.125 Test Acc: 0.750
Validation loss decreased (-0.696860 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 1.1766269207000732
Epoch: 5, Steps: 8 | Train Loss: 0.919 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 1.0269441604614258
Epoch: 6, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 1.7461819648742676
Epoch: 7, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818745).  Saving model ...
Epoch: 8 cost time: 1.4433043003082275
Epoch: 8, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.469 Vali Acc: 0.853 Test Loss: 0.469 Test Acc: 0.853
Validation loss decreased (-0.818745 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 1.5633463859558105
Epoch: 9, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4706850051879883
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.580 Vali Acc: 0.847 Test Loss: 0.580 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3706340789794922
Epoch: 11, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.647 Vali Acc: 0.853 Test Loss: 0.647 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.446739673614502
Epoch: 12, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.853120 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.915273904800415
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.710 Vali Acc: 0.853 Test Loss: 0.710 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2437033653259277
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0660347938537598
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.724 Vali Acc: 0.844 Test Loss: 0.724 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7809391021728516
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.733 Vali Acc: 0.866 Test Loss: 0.733 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1750037670135498
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.758 Vali Acc: 0.866 Test Loss: 0.758 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8966732025146484
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0733380317687988
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.853 Test Loss: 0.779 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.812798023223877
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.810 Vali Acc: 0.844 Test Loss: 0.810 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3409934043884277
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.817 Vali Acc: 0.847 Test Loss: 0.817 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0726394653320312
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.847 Test Loss: 0.815 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 43746056
model size : 181.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5774431228637695
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 2.086 Vali Acc: 0.188 Test Loss: 2.086 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 0.683079719543457
Epoch: 2, Steps: 8 | Train Loss: 2.033 Vali Loss: 1.910 Vali Acc: 0.400 Test Loss: 1.910 Test Acc: 0.400
Validation loss decreased (-0.187479 --> -0.399981).  Saving model ...
Epoch: 3 cost time: 0.7207422256469727
Epoch: 3, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.696 Vali Acc: 0.622 Test Loss: 1.696 Test Acc: 0.622
Validation loss decreased (-0.399981 --> -0.621858).  Saving model ...
Epoch: 4 cost time: 0.948620080947876
Epoch: 4, Steps: 8 | Train Loss: 1.604 Vali Loss: 1.449 Vali Acc: 0.716 Test Loss: 1.449 Test Acc: 0.716
Validation loss decreased (-0.621858 --> -0.715611).  Saving model ...
Epoch: 5 cost time: 0.8493475914001465
Epoch: 5, Steps: 8 | Train Loss: 1.327 Vali Loss: 1.146 Vali Acc: 0.772 Test Loss: 1.146 Test Acc: 0.772
Validation loss decreased (-0.715611 --> -0.771864).  Saving model ...
Epoch: 6 cost time: 0.7831506729125977
Epoch: 6, Steps: 8 | Train Loss: 1.000 Vali Loss: 0.822 Vali Acc: 0.797 Test Loss: 0.822 Test Acc: 0.797
Validation loss decreased (-0.771864 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.8834662437438965
Epoch: 7, Steps: 8 | Train Loss: 0.700 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
Validation loss decreased (-0.796867 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 0.7482030391693115
Epoch: 8, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.477 Vali Acc: 0.825 Test Loss: 0.477 Test Acc: 0.825
Validation loss decreased (-0.809369 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.8258121013641357
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 0.465 Vali Acc: 0.847 Test Loss: 0.465 Test Acc: 0.847
Validation loss decreased (-0.824995 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.8195867538452148
Epoch: 10, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8323309421539307
Epoch: 11, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.7451276779174805
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7843418121337891
Epoch: 13, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.571 Vali Acc: 0.853 Test Loss: 0.571 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7726590633392334
Epoch: 14, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.612 Vali Acc: 0.847 Test Loss: 0.612 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7338318824768066
Epoch: 15, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8088209629058838
Epoch: 16, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.636 Vali Acc: 0.859 Test Loss: 0.636 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859369).  Saving model ...
Epoch: 17 cost time: 0.8047599792480469
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9406795501708984
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7532351016998291
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.674 Vali Acc: 0.844 Test Loss: 0.674 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7747471332550049
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.684 Vali Acc: 0.847 Test Loss: 0.684 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7737772464752197
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8184373378753662
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.707 Vali Acc: 0.856 Test Loss: 0.707 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6700396537780762
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.706 Vali Acc: 0.863 Test Loss: 0.706 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862493).  Saving model ...
Epoch: 24 cost time: 0.7560768127441406
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.841 Test Loss: 0.696 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8309602737426758
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.847 Test Loss: 0.689 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6011381149291992
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6270239353179932
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5535459518432617
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.859 Test Loss: 0.693 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6272740364074707
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.859 Test Loss: 0.696 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7806775569915771
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.863 Test Loss: 0.709 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6421387195587158
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6910727024078369
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.856 Test Loss: 0.714 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6409099102020264
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.863 Test Loss: 0.722 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 43692296
model size : 181.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.849576711654663
Epoch: 1, Steps: 8 | Train Loss: 2.273 Vali Loss: 2.054 Vali Acc: 0.141 Test Loss: 2.054 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 1.1159405708312988
Epoch: 2, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.648 Vali Acc: 0.569 Test Loss: 1.648 Test Acc: 0.569
Validation loss decreased (-0.140604 --> -0.568734).  Saving model ...
Epoch: 3 cost time: 0.8810455799102783
Epoch: 3, Steps: 8 | Train Loss: 1.427 Vali Loss: 1.153 Vali Acc: 0.778 Test Loss: 1.153 Test Acc: 0.778
Validation loss decreased (-0.568734 --> -0.778113).  Saving model ...
Epoch: 4 cost time: 1.5212109088897705
Epoch: 4, Steps: 8 | Train Loss: 0.989 Vali Loss: 0.757 Vali Acc: 0.784 Test Loss: 0.757 Test Acc: 0.784
Validation loss decreased (-0.778113 --> -0.784367).  Saving model ...
Epoch: 5 cost time: 1.3476393222808838
Epoch: 5, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.784367 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 1.2506353855133057
Epoch: 6, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.2208685874938965
Epoch: 7, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.552 Vali Acc: 0.847 Test Loss: 0.552 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846869).  Saving model ...
Epoch: 8 cost time: 1.2482504844665527
Epoch: 8, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.597 Vali Acc: 0.859 Test Loss: 0.597 Test Acc: 0.859
Validation loss decreased (-0.846869 --> -0.859369).  Saving model ...
Epoch: 9 cost time: 0.8096776008605957
Epoch: 9, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1028566360473633
Epoch: 10, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.797 Vali Acc: 0.844 Test Loss: 0.797 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4480843544006348
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.720 Vali Acc: 0.853 Test Loss: 0.720 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8241395950317383
Epoch: 12, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.707 Vali Acc: 0.869 Test Loss: 0.707 Test Acc: 0.869
Validation loss decreased (-0.859369 --> -0.868743).  Saving model ...
Epoch: 13 cost time: 1.3151273727416992
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.774 Vali Acc: 0.859 Test Loss: 0.774 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5225095748901367
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.802 Vali Acc: 0.869 Test Loss: 0.802 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4188041687011719
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.914 Vali Acc: 0.847 Test Loss: 0.914 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.372318983078003
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.924 Vali Acc: 0.850 Test Loss: 0.924 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8984289169311523
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.068 Vali Acc: 0.869 Test Loss: 1.068 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0567529201507568
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.138 Vali Acc: 0.841 Test Loss: 1.138 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8881750106811523
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.941 Vali Acc: 0.853 Test Loss: 0.941 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8253006935119629
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.969 Vali Acc: 0.863 Test Loss: 0.969 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7916884422302246
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.991 Vali Acc: 0.856 Test Loss: 0.991 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7027521133422852
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.882 Vali Acc: 0.863 Test Loss: 0.882 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 43872776
model size : 182.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4186859130859375
Epoch: 1, Steps: 8 | Train Loss: 2.070 Vali Loss: 2.002 Vali Acc: 0.291 Test Loss: 2.002 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 0.7719385623931885
Epoch: 2, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.777 Vali Acc: 0.572 Test Loss: 1.777 Test Acc: 0.572
Validation loss decreased (-0.290605 --> -0.571857).  Saving model ...
Epoch: 3 cost time: 0.6206738948822021
Epoch: 3, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.464 Vali Acc: 0.731 Test Loss: 1.464 Test Acc: 0.731
Validation loss decreased (-0.571857 --> -0.731235).  Saving model ...
Epoch: 4 cost time: 0.8013250827789307
Epoch: 4, Steps: 8 | Train Loss: 1.303 Vali Loss: 1.086 Vali Acc: 0.759 Test Loss: 1.086 Test Acc: 0.759
Validation loss decreased (-0.731235 --> -0.759364).  Saving model ...
Epoch: 5 cost time: 0.8320374488830566
Epoch: 5, Steps: 8 | Train Loss: 0.917 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
Validation loss decreased (-0.759364 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 0.9140164852142334
Epoch: 6, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.799993 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.8689894676208496
Epoch: 7, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5923011302947998
Epoch: 8, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.546 Vali Acc: 0.831 Test Loss: 0.546 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9336113929748535
Epoch: 9, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 0.7554728984832764
Epoch: 10, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.541 Vali Acc: 0.869 Test Loss: 0.541 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 0.6109139919281006
Epoch: 11, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.560 Vali Acc: 0.878 Test Loss: 0.560 Test Acc: 0.878
Validation loss decreased (-0.868745 --> -0.878119).  Saving model ...
Epoch: 12 cost time: 0.7855203151702881
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7185306549072266
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.559 Vali Acc: 0.884 Test Loss: 0.559 Test Acc: 0.884
Validation loss decreased (-0.878119 --> -0.884369).  Saving model ...
Epoch: 14 cost time: 0.8284459114074707
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8830673694610596
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.632 Vali Acc: 0.881 Test Loss: 0.632 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8131487369537354
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.615 Vali Acc: 0.863 Test Loss: 0.615 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7470922470092773
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.642 Vali Acc: 0.869 Test Loss: 0.642 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7803993225097656
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.742 Vali Acc: 0.853 Test Loss: 0.742 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6825752258300781
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.723 Vali Acc: 0.869 Test Loss: 0.723 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.744678258895874
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.699 Vali Acc: 0.878 Test Loss: 0.699 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5988202095031738
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.878 Test Loss: 0.697 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7082221508026123
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.692 Vali Acc: 0.878 Test Loss: 0.692 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7508561611175537
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.878 Test Loss: 0.702 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 43765256
model size : 181.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3967549800872803
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 2.093 Vali Acc: 0.166 Test Loss: 2.093 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 0.5293929576873779
Epoch: 2, Steps: 8 | Train Loss: 2.019 Vali Loss: 1.917 Vali Acc: 0.312 Test Loss: 1.917 Test Acc: 0.312
Validation loss decreased (-0.165604 --> -0.312481).  Saving model ...
Epoch: 3 cost time: 0.753563642501831
Epoch: 3, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.705 Vali Acc: 0.625 Test Loss: 1.705 Test Acc: 0.625
Validation loss decreased (-0.312481 --> -0.624983).  Saving model ...
Epoch: 4 cost time: 0.6507670879364014
Epoch: 4, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.450 Vali Acc: 0.694 Test Loss: 1.450 Test Acc: 0.694
Validation loss decreased (-0.624983 --> -0.693735).  Saving model ...
Epoch: 5 cost time: 0.6610045433044434
Epoch: 5, Steps: 8 | Train Loss: 1.336 Vali Loss: 1.119 Vali Acc: 0.756 Test Loss: 1.119 Test Acc: 0.756
Validation loss decreased (-0.693735 --> -0.756239).  Saving model ...
Epoch: 6 cost time: 0.774139404296875
Epoch: 6, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.809 Vali Acc: 0.797 Test Loss: 0.809 Test Acc: 0.797
Validation loss decreased (-0.756239 --> -0.796867).  Saving model ...
Epoch: 7 cost time: 0.71559739112854
Epoch: 7, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.615 Vali Acc: 0.797 Test Loss: 0.615 Test Acc: 0.797
Validation loss decreased (-0.796867 --> -0.796869).  Saving model ...
Epoch: 8 cost time: 0.7090878486633301
Epoch: 8, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
Validation loss decreased (-0.796869 --> -0.815620).  Saving model ...
Epoch: 9 cost time: 0.7928779125213623
Epoch: 9, Steps: 8 | Train Loss: 0.308 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
Validation loss decreased (-0.815620 --> -0.815620).  Saving model ...
Epoch: 10 cost time: 0.9183452129364014
Epoch: 10, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
Validation loss decreased (-0.815620 --> -0.818745).  Saving model ...
Epoch: 11 cost time: 0.6558833122253418
Epoch: 11, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.571 Vali Acc: 0.825 Test Loss: 0.571 Test Acc: 0.825
Validation loss decreased (-0.818745 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 0.8844733238220215
Epoch: 12, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8032724857330322
Epoch: 13, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 14 cost time: 0.8126943111419678
Epoch: 14, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6096947193145752
Epoch: 15, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.658 Vali Acc: 0.825 Test Loss: 0.658 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6675386428833008
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.630 Vali Acc: 0.834 Test Loss: 0.630 Test Acc: 0.834
Validation loss decreased (-0.828119 --> -0.834369).  Saving model ...
Epoch: 17 cost time: 0.8464114665985107
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.624 Vali Acc: 0.844 Test Loss: 0.624 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 0.8581099510192871
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 0.6993181705474854
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.649 Vali Acc: 0.847 Test Loss: 0.649 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6497073173522949
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7921266555786133
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.692 Vali Acc: 0.853 Test Loss: 0.692 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853118).  Saving model ...
Epoch: 22 cost time: 0.6705284118652344
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8275420665740967
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.701 Vali Acc: 0.847 Test Loss: 0.701 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8622751235961914
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.719 Vali Acc: 0.838 Test Loss: 0.719 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6879611015319824
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.750 Vali Acc: 0.841 Test Loss: 0.750 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9657893180847168
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.766 Vali Acc: 0.841 Test Loss: 0.766 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8898561000823975
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.761 Vali Acc: 0.847 Test Loss: 0.761 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7021458148956299
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.841 Test Loss: 0.757 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6482880115509033
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.766 Vali Acc: 0.841 Test Loss: 0.766 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8957734107971191
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.814 Vali Acc: 0.841 Test Loss: 0.814 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7828042507171631
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.828 Vali Acc: 0.841 Test Loss: 0.828 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 43711496
model size : 181.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.757331609725952
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 1.950 Vali Acc: 0.334 Test Loss: 1.950 Test Acc: 0.334
Validation loss decreased (inf --> -0.334355).  Saving model ...
Epoch: 2 cost time: 0.6914572715759277
Epoch: 2, Steps: 8 | Train Loss: 1.861 Vali Loss: 1.621 Vali Acc: 0.678 Test Loss: 1.621 Test Acc: 0.678
Validation loss decreased (-0.334355 --> -0.678109).  Saving model ...
Epoch: 3 cost time: 0.966315507888794
Epoch: 3, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.204 Vali Acc: 0.787 Test Loss: 1.204 Test Acc: 0.787
Validation loss decreased (-0.678109 --> -0.787488).  Saving model ...
Epoch: 4 cost time: 1.1631550788879395
Epoch: 4, Steps: 8 | Train Loss: 1.033 Vali Loss: 0.797 Vali Acc: 0.784 Test Loss: 0.797 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8551263809204102
Epoch: 5, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
Validation loss decreased (-0.787488 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 1.4280614852905273
Epoch: 6, Steps: 8 | Train Loss: 0.424 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.1593730449676514
Epoch: 7, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7197604179382324
Epoch: 8, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.606 Vali Acc: 0.834 Test Loss: 0.606 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0732343196868896
Epoch: 9, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.656 Vali Acc: 0.847 Test Loss: 0.656 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846868).  Saving model ...
Epoch: 10 cost time: 1.1886494159698486
Epoch: 10, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.715 Vali Acc: 0.847 Test Loss: 0.715 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5409572124481201
Epoch: 11, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.615 Vali Acc: 0.875 Test Loss: 0.615 Test Acc: 0.875
Validation loss decreased (-0.846868 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 1.4915997982025146
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.792 Vali Acc: 0.838 Test Loss: 0.792 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3553528785705566
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.754 Vali Acc: 0.841 Test Loss: 0.754 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3632912635803223
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.782 Vali Acc: 0.853 Test Loss: 0.782 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4476900100708008
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.871 Vali Acc: 0.853 Test Loss: 0.871 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8169269561767578
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.974 Vali Acc: 0.844 Test Loss: 0.974 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.709435224533081
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.913 Vali Acc: 0.844 Test Loss: 0.913 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9007220268249512
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.856 Test Loss: 0.859 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.118687629699707
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.830 Vali Acc: 0.853 Test Loss: 0.830 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.081542730331421
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.826 Vali Acc: 0.844 Test Loss: 0.826 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9488294124603271
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.853 Test Loss: 0.820 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 43868936
model size : 182.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2583401203155518
Epoch: 1, Steps: 8 | Train Loss: 2.119 Vali Loss: 2.036 Vali Acc: 0.200 Test Loss: 2.036 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 0.7708747386932373
Epoch: 2, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.816 Vali Acc: 0.519 Test Loss: 1.816 Test Acc: 0.519
Validation loss decreased (-0.199980 --> -0.518732).  Saving model ...
Epoch: 3 cost time: 0.6725585460662842
Epoch: 3, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.505 Vali Acc: 0.713 Test Loss: 1.505 Test Acc: 0.713
Validation loss decreased (-0.518732 --> -0.712485).  Saving model ...
Epoch: 4 cost time: 0.748523473739624
Epoch: 4, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.135 Vali Acc: 0.769 Test Loss: 1.135 Test Acc: 0.769
Validation loss decreased (-0.712485 --> -0.768739).  Saving model ...
Epoch: 5 cost time: 0.781196117401123
Epoch: 5, Steps: 8 | Train Loss: 0.962 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
Validation loss decreased (-0.768739 --> -0.803118).  Saving model ...
Epoch: 6 cost time: 0.6060700416564941
Epoch: 6, Steps: 8 | Train Loss: 0.599 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
Validation loss decreased (-0.803118 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 0.8710474967956543
Epoch: 7, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.812494 --> -0.818744).  Saving model ...
Epoch: 8 cost time: 1.1176998615264893
Epoch: 8, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.818744 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.938471794128418
Epoch: 9, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.541 Vali Acc: 0.853 Test Loss: 0.541 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.873018741607666
Epoch: 10, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.644 Vali Acc: 0.831 Test Loss: 0.644 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0153541564941406
Epoch: 11, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.591 Vali Acc: 0.853 Test Loss: 0.591 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0449016094207764
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.859 Test Loss: 0.570 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859369).  Saving model ...
Epoch: 13 cost time: 1.017975091934204
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.716 Vali Acc: 0.838 Test Loss: 0.716 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0095996856689453
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.619 Vali Acc: 0.859 Test Loss: 0.619 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8807814121246338
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.617 Vali Acc: 0.859 Test Loss: 0.617 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8322763442993164
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.669 Vali Acc: 0.853 Test Loss: 0.669 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8074302673339844
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.859369 --> -0.871869).  Saving model ...
Epoch: 18 cost time: 0.9270586967468262
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 0.8965966701507568
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.639 Vali Acc: 0.878 Test Loss: 0.639 Test Acc: 0.878
Validation loss decreased (-0.874994 --> -0.878119).  Saving model ...
Epoch: 20 cost time: 1.1676688194274902
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.666 Vali Acc: 0.863 Test Loss: 0.666 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.084458827972412
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.859 Test Loss: 0.668 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9015669822692871
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.866 Test Loss: 0.681 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7064549922943115
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.664 Vali Acc: 0.866 Test Loss: 0.664 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9443938732147217
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
Validation loss decreased (-0.878119 --> -0.878119).  Saving model ...
Epoch: 25 cost time: 0.8322019577026367
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.869 Test Loss: 0.631 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9661452770233154
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.670 Vali Acc: 0.863 Test Loss: 0.670 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8703837394714355
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.866 Test Loss: 0.688 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9507243633270264
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.869 Test Loss: 0.690 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8036973476409912
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.866 Test Loss: 0.682 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9459412097930908
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.679 Vali Acc: 0.869 Test Loss: 0.679 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7183620929718018
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.666 Vali Acc: 0.872 Test Loss: 0.666 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8461151123046875
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.875 Test Loss: 0.672 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7881410121917725
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.869 Test Loss: 0.687 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9419376850128174
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.866 Test Loss: 0.713 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 43784456
model size : 181.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7038075923919678
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 1.995 Vali Acc: 0.166 Test Loss: 1.995 Test Acc: 0.166
Validation loss decreased (inf --> -0.165605).  Saving model ...
Epoch: 2 cost time: 0.76662278175354
Epoch: 2, Steps: 8 | Train Loss: 1.969 Vali Loss: 1.814 Vali Acc: 0.487 Test Loss: 1.814 Test Acc: 0.487
Validation loss decreased (-0.165605 --> -0.487482).  Saving model ...
Epoch: 3 cost time: 0.7734060287475586
Epoch: 3, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.594 Vali Acc: 0.669 Test Loss: 1.594 Test Acc: 0.669
Validation loss decreased (-0.487482 --> -0.668734).  Saving model ...
Epoch: 4 cost time: 0.6547665596008301
Epoch: 4, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.354 Vali Acc: 0.747 Test Loss: 1.354 Test Acc: 0.747
Validation loss decreased (-0.668734 --> -0.746861).  Saving model ...
Epoch: 5 cost time: 0.832453727722168
Epoch: 5, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.078 Vali Acc: 0.816 Test Loss: 1.078 Test Acc: 0.816
Validation loss decreased (-0.746861 --> -0.815614).  Saving model ...
Epoch: 6 cost time: 0.789360761642456
Epoch: 6, Steps: 8 | Train Loss: 0.981 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6230804920196533
Epoch: 7, Steps: 8 | Train Loss: 0.682 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8439812660217285
Epoch: 8, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.547 Vali Acc: 0.787 Test Loss: 0.547 Test Acc: 0.787
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7082517147064209
Epoch: 9, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.513 Vali Acc: 0.822 Test Loss: 0.513 Test Acc: 0.822
Validation loss decreased (-0.815614 --> -0.821870).  Saving model ...
Epoch: 10 cost time: 0.9409348964691162
Epoch: 10, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
Validation loss decreased (-0.821870 --> -0.824995).  Saving model ...
Epoch: 11 cost time: 0.7577755451202393
Epoch: 11, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
Validation loss decreased (-0.824995 --> -0.828120).  Saving model ...
Epoch: 12 cost time: 0.8595201969146729
Epoch: 12, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 13 cost time: 0.5889384746551514
Epoch: 13, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.604 Vali Acc: 0.828 Test Loss: 0.604 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7888681888580322
Epoch: 14, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.552 Vali Acc: 0.834 Test Loss: 0.552 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7357161045074463
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.568 Vali Acc: 0.841 Test Loss: 0.568 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 16 cost time: 0.8682951927185059
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.651 Vali Acc: 0.838 Test Loss: 0.651 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9221339225769043
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.649 Vali Acc: 0.844 Test Loss: 0.649 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843744).  Saving model ...
Epoch: 18 cost time: 0.8815362453460693
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 19 cost time: 0.795830249786377
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 20 cost time: 0.8199560642242432
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843744).  Saving model ...
Epoch: 21 cost time: 0.9028453826904297
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.847 Test Loss: 0.606 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 22 cost time: 0.9523904323577881
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.762171745300293
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8868381977081299
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8011054992675781
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.716172456741333
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7907896041870117
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.660 Vali Acc: 0.847 Test Loss: 0.660 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9484126567840576
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.847 Test Loss: 0.655 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7547154426574707
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7274284362792969
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7763781547546387
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.673 Vali Acc: 0.841 Test Loss: 0.673 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8122463226318359
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.847 Test Loss: 0.683 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 43746056
model size : 181.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9838004112243652
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 2.038 Vali Acc: 0.256 Test Loss: 2.038 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 1.2984158992767334
Epoch: 2, Steps: 8 | Train Loss: 1.973 Vali Loss: 1.743 Vali Acc: 0.634 Test Loss: 1.743 Test Acc: 0.634
Validation loss decreased (-0.256230 --> -0.634358).  Saving model ...
Epoch: 3 cost time: 0.7659070491790771
Epoch: 3, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.390 Vali Acc: 0.778 Test Loss: 1.390 Test Acc: 0.778
Validation loss decreased (-0.634358 --> -0.778111).  Saving model ...
Epoch: 4 cost time: 1.0556869506835938
Epoch: 4, Steps: 8 | Train Loss: 1.237 Vali Loss: 1.007 Vali Acc: 0.784 Test Loss: 1.007 Test Acc: 0.784
Validation loss decreased (-0.778111 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 1.0357534885406494
Epoch: 5, Steps: 8 | Train Loss: 0.846 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
Validation loss decreased (-0.784365 --> -0.809368).  Saving model ...
Epoch: 6 cost time: 1.3303353786468506
Epoch: 6, Steps: 8 | Train Loss: 0.603 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
Validation loss decreased (-0.809368 --> -0.834369).  Saving model ...
Epoch: 7 cost time: 1.0972418785095215
Epoch: 7, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.528 Vali Acc: 0.828 Test Loss: 0.528 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7022256851196289
Epoch: 8, Steps: 8 | Train Loss: 0.250 Vali Loss: 0.579 Vali Acc: 0.844 Test Loss: 0.579 Test Acc: 0.844
Validation loss decreased (-0.834369 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 0.8658123016357422
Epoch: 9, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5988724231719971
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.684 Vali Acc: 0.841 Test Loss: 0.684 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8925108909606934
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.617 Vali Acc: 0.853 Test Loss: 0.617 Test Acc: 0.853
Validation loss decreased (-0.843744 --> -0.853119).  Saving model ...
Epoch: 12 cost time: 0.7355928421020508
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.748 Vali Acc: 0.844 Test Loss: 0.748 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7010195255279541
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9831006526947021
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.724 Vali Acc: 0.841 Test Loss: 0.724 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.019862174987793
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.722 Vali Acc: 0.844 Test Loss: 0.722 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8936488628387451
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0097522735595703
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.841 Test Loss: 0.862 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9875574111938477
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.847 Vali Acc: 0.847 Test Loss: 0.847 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8507499694824219
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.908 Vali Acc: 0.834 Test Loss: 0.908 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0104141235351562
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.838 Test Loss: 0.862 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8285961151123047
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.859 Test Loss: 0.816 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859367).  Saving model ...
Epoch: 22 cost time: 0.963566780090332
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.792 Vali Acc: 0.859 Test Loss: 0.792 Test Acc: 0.859
Validation loss decreased (-0.859367 --> -0.859367).  Saving model ...
Epoch: 23 cost time: 0.8491497039794922
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.856 Test Loss: 0.809 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6774234771728516
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.856 Test Loss: 0.842 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7658138275146484
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.853 Test Loss: 0.842 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8094892501831055
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.856 Test Loss: 0.846 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8211002349853516
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.856 Test Loss: 0.848 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.251035213470459
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.859 Test Loss: 0.856 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0853488445281982
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.859 Test Loss: 0.857 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4091708660125732
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.859 Test Loss: 0.850 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5175960063934326
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.872 Test Loss: 0.845 Test Acc: 0.872
Validation loss decreased (-0.859367 --> -0.871867).  Saving model ...
Epoch: 32 cost time: 0.8797276020050049
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.869 Test Loss: 0.850 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7056941986083984
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.872 Test Loss: 0.851 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6972737312316895
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.869 Test Loss: 0.850 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.129981279373169
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.869 Test Loss: 0.852 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3505496978759766
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.866 Test Loss: 0.852 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7105767726898193
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.866 Test Loss: 0.853 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1194584369659424
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.869 Test Loss: 0.853 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3908522129058838
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.872 Test Loss: 0.854 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.103356122970581
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.866 Test Loss: 0.862 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7056879997253418
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.866 Test Loss: 0.868 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43893512
model size : 182.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.660362482070923
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 2.093 Vali Acc: 0.159 Test Loss: 2.093 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.9536433219909668
Epoch: 2, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.890 Vali Acc: 0.494 Test Loss: 1.890 Test Acc: 0.494
Validation loss decreased (-0.159354 --> -0.493731).  Saving model ...
Epoch: 3 cost time: 1.0594358444213867
Epoch: 3, Steps: 8 | Train Loss: 1.813 Vali Loss: 1.643 Vali Acc: 0.722 Test Loss: 1.643 Test Acc: 0.722
Validation loss decreased (-0.493731 --> -0.721859).  Saving model ...
Epoch: 4 cost time: 1.0319738388061523
Epoch: 4, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.334 Vali Acc: 0.784 Test Loss: 1.334 Test Acc: 0.784
Validation loss decreased (-0.721859 --> -0.784362).  Saving model ...
Epoch: 5 cost time: 1.2352080345153809
Epoch: 5, Steps: 8 | Train Loss: 1.175 Vali Loss: 0.984 Vali Acc: 0.803 Test Loss: 0.984 Test Acc: 0.803
Validation loss decreased (-0.784362 --> -0.803115).  Saving model ...
Epoch: 6 cost time: 1.1811611652374268
Epoch: 6, Steps: 8 | Train Loss: 0.807 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (-0.803115 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 1.28233003616333
Epoch: 7, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 1.098825216293335
Epoch: 8, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.458 Vali Acc: 0.866 Test Loss: 0.458 Test Acc: 0.866
Validation loss decreased (-0.828120 --> -0.865620).  Saving model ...
Epoch: 9 cost time: 1.1834824085235596
Epoch: 9, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9677913188934326
Epoch: 10, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.487 Vali Acc: 0.853 Test Loss: 0.487 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7313859462738037
Epoch: 11, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 12 cost time: 0.8784213066101074
Epoch: 12, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.574 Vali Acc: 0.847 Test Loss: 0.574 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0908188819885254
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.573 Vali Acc: 0.853 Test Loss: 0.573 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9093997478485107
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9944350719451904
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.863 Test Loss: 0.569 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7582952976226807
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.616 Vali Acc: 0.866 Test Loss: 0.616 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8088750839233398
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.623 Vali Acc: 0.869 Test Loss: 0.623 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.096876621246338
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.636 Vali Acc: 0.863 Test Loss: 0.636 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8443682193756104
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.636 Vali Acc: 0.863 Test Loss: 0.636 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0962374210357666
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.863 Test Loss: 0.660 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8945481777191162
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.856 Test Loss: 0.671 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43824392
model size : 181.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5268948078155518
Epoch: 1, Steps: 8 | Train Loss: 2.219 Vali Loss: 2.082 Vali Acc: 0.066 Test Loss: 2.082 Test Acc: 0.066
Validation loss decreased (inf --> -0.065604).  Saving model ...
Epoch: 2 cost time: 0.7924971580505371
Epoch: 2, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.924 Vali Acc: 0.334 Test Loss: 1.924 Test Acc: 0.334
Validation loss decreased (-0.065604 --> -0.334356).  Saving model ...
Epoch: 3 cost time: 0.8665213584899902
Epoch: 3, Steps: 8 | Train Loss: 1.856 Vali Loss: 1.729 Vali Acc: 0.691 Test Loss: 1.729 Test Acc: 0.691
Validation loss decreased (-0.334356 --> -0.690608).  Saving model ...
Epoch: 4 cost time: 0.6759450435638428
Epoch: 4, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.497 Vali Acc: 0.725 Test Loss: 1.497 Test Acc: 0.725
Validation loss decreased (-0.690608 --> -0.724985).  Saving model ...
Epoch: 5 cost time: 0.8653099536895752
Epoch: 5, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.220 Vali Acc: 0.731 Test Loss: 1.220 Test Acc: 0.731
Validation loss decreased (-0.724985 --> -0.731238).  Saving model ...
Epoch: 6 cost time: 0.8120768070220947
Epoch: 6, Steps: 8 | Train Loss: 1.094 Vali Loss: 0.936 Vali Acc: 0.781 Test Loss: 0.936 Test Acc: 0.781
Validation loss decreased (-0.731238 --> -0.781241).  Saving model ...
Epoch: 7 cost time: 0.748673677444458
Epoch: 7, Steps: 8 | Train Loss: 0.801 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8372561931610107
Epoch: 8, Steps: 8 | Train Loss: 0.584 Vali Loss: 0.654 Vali Acc: 0.794 Test Loss: 0.654 Test Acc: 0.794
Validation loss decreased (-0.781241 --> -0.793743).  Saving model ...
Epoch: 9 cost time: 0.7390308380126953
Epoch: 9, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.594 Vali Acc: 0.781 Test Loss: 0.594 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7329392433166504
Epoch: 10, Steps: 8 | Train Loss: 0.275 Vali Loss: 0.585 Vali Acc: 0.819 Test Loss: 0.585 Test Acc: 0.819
Validation loss decreased (-0.793743 --> -0.818744).  Saving model ...
Epoch: 11 cost time: 0.8404207229614258
Epoch: 11, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.574 Vali Acc: 0.831 Test Loss: 0.574 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.7583012580871582
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8064043521881104
Epoch: 13, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6284558773040771
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 15 cost time: 0.7408149242401123
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.643 Vali Acc: 0.838 Test Loss: 0.643 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837494).  Saving model ...
Epoch: 16 cost time: 0.7222573757171631
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.659 Vali Acc: 0.838 Test Loss: 0.659 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.68558669090271
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.670 Vali Acc: 0.834 Test Loss: 0.670 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7302024364471436
Epoch: 18, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840618).  Saving model ...
Epoch: 19 cost time: 0.5804131031036377
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.625 Vali Acc: 0.853 Test Loss: 0.625 Test Acc: 0.853
Validation loss decreased (-0.840618 --> -0.853119).  Saving model ...
Epoch: 20 cost time: 0.6942553520202637
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.643 Vali Acc: 0.859 Test Loss: 0.643 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 21 cost time: 0.656153678894043
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.661 Vali Acc: 0.859 Test Loss: 0.661 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6410107612609863
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.664 Vali Acc: 0.853 Test Loss: 0.664 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7413749694824219
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.673 Vali Acc: 0.856 Test Loss: 0.673 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.734180212020874
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.685 Vali Acc: 0.853 Test Loss: 0.685 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7677648067474365
Epoch: 25, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.680 Vali Acc: 0.847 Test Loss: 0.680 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7327148914337158
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.677 Vali Acc: 0.853 Test Loss: 0.677 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6943466663360596
Epoch: 27, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.847 Test Loss: 0.696 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.795579195022583
Epoch: 28, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.721 Vali Acc: 0.847 Test Loss: 0.721 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9943137168884277
Epoch: 29, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.732 Vali Acc: 0.847 Test Loss: 0.732 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9813742637634277
Epoch: 30, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.735 Vali Acc: 0.844 Test Loss: 0.735 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 43785992
model size : 181.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7897400856018066
Epoch: 1, Steps: 8 | Train Loss: 2.183 Vali Loss: 1.992 Vali Acc: 0.250 Test Loss: 1.992 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 0.9259028434753418
Epoch: 2, Steps: 8 | Train Loss: 1.900 Vali Loss: 1.714 Vali Acc: 0.616 Test Loss: 1.714 Test Acc: 0.616
Validation loss decreased (-0.249980 --> -0.615608).  Saving model ...
Epoch: 3 cost time: 1.3097519874572754
Epoch: 3, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.373 Vali Acc: 0.738 Test Loss: 1.373 Test Acc: 0.738
Validation loss decreased (-0.615608 --> -0.737486).  Saving model ...
Epoch: 4 cost time: 1.2296996116638184
Epoch: 4, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.023 Vali Acc: 0.775 Test Loss: 1.023 Test Acc: 0.775
Validation loss decreased (-0.737486 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 1.0877017974853516
Epoch: 5, Steps: 8 | Train Loss: 0.878 Vali Loss: 0.715 Vali Acc: 0.784 Test Loss: 0.715 Test Acc: 0.784
Validation loss decreased (-0.774990 --> -0.784368).  Saving model ...
Epoch: 6 cost time: 0.8878622055053711
Epoch: 6, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
Validation loss decreased (-0.784368 --> -0.809370).  Saving model ...
Epoch: 7 cost time: 1.2363314628601074
Epoch: 7, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.508 Vali Acc: 0.831 Test Loss: 0.508 Test Acc: 0.831
Validation loss decreased (-0.809370 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 1.4621357917785645
Epoch: 8, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 1.41387939453125
Epoch: 9, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 10 cost time: 1.5319607257843018
Epoch: 10, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.869 Test Loss: 0.511 Test Acc: 0.869
Validation loss decreased (-0.846869 --> -0.868745).  Saving model ...
Epoch: 11 cost time: 1.4162111282348633
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2307021617889404
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.618 Vali Acc: 0.863 Test Loss: 0.618 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3019123077392578
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.859 Test Loss: 0.641 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2111639976501465
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.715 Vali Acc: 0.847 Test Loss: 0.715 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1308603286743164
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2897119522094727
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1162464618682861
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.718 Vali Acc: 0.863 Test Loss: 0.718 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.386617660522461
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.745 Vali Acc: 0.859 Test Loss: 0.745 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0854415893554688
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.866 Test Loss: 0.728 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8723726272583008
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.866 Test Loss: 0.718 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 43939592
model size : 182.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.611496686935425
Epoch: 1, Steps: 8 | Train Loss: 2.326 Vali Loss: 2.107 Vali Acc: 0.191 Test Loss: 2.107 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 0.8521318435668945
Epoch: 2, Steps: 8 | Train Loss: 2.037 Vali Loss: 1.862 Vali Acc: 0.425 Test Loss: 1.862 Test Acc: 0.425
Validation loss decreased (-0.190604 --> -0.424981).  Saving model ...
Epoch: 3 cost time: 0.7647585868835449
Epoch: 3, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.596 Vali Acc: 0.697 Test Loss: 1.596 Test Acc: 0.697
Validation loss decreased (-0.424981 --> -0.696859).  Saving model ...
Epoch: 4 cost time: 0.9582438468933105
Epoch: 4, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.286 Vali Acc: 0.759 Test Loss: 1.286 Test Acc: 0.759
Validation loss decreased (-0.696859 --> -0.759362).  Saving model ...
Epoch: 5 cost time: 0.8242161273956299
Epoch: 5, Steps: 8 | Train Loss: 1.210 Vali Loss: 0.946 Vali Acc: 0.797 Test Loss: 0.946 Test Acc: 0.797
Validation loss decreased (-0.759362 --> -0.796866).  Saving model ...
Epoch: 6 cost time: 0.9543683528900146
Epoch: 6, Steps: 8 | Train Loss: 0.850 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
Validation loss decreased (-0.796866 --> -0.803118).  Saving model ...
Epoch: 7 cost time: 0.785118818283081
Epoch: 7, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
Validation loss decreased (-0.803118 --> -0.821870).  Saving model ...
Epoch: 8 cost time: 0.8906745910644531
Epoch: 8, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
Validation loss decreased (-0.821870 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.7322084903717041
Epoch: 9, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.481 Vali Acc: 0.841 Test Loss: 0.481 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6662595272064209
Epoch: 10, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 11 cost time: 0.7677462100982666
Epoch: 11, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.846869 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.7132070064544678
Epoch: 12, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.534 Vali Acc: 0.853 Test Loss: 0.534 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7380146980285645
Epoch: 13, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.555 Vali Acc: 0.866 Test Loss: 0.555 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865619).  Saving model ...
Epoch: 14 cost time: 0.8514242172241211
Epoch: 14, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.616 Vali Acc: 0.863 Test Loss: 0.616 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6898081302642822
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.599 Vali Acc: 0.869 Test Loss: 0.599 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 16 cost time: 0.9670615196228027
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.643 Vali Acc: 0.863 Test Loss: 0.643 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6434586048126221
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.665 Vali Acc: 0.859 Test Loss: 0.665 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.994147539138794
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7619099617004395
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9201891422271729
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.689 Vali Acc: 0.859 Test Loss: 0.689 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9315564632415771
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.680 Vali Acc: 0.869 Test Loss: 0.680 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8719422817230225
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.670 Vali Acc: 0.863 Test Loss: 0.670 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7962436676025391
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.728 Vali Acc: 0.859 Test Loss: 0.728 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.891571044921875
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7122046947479248
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.859 Test Loss: 0.718 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 43878152
model size : 182.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3405282497406006
Epoch: 1, Steps: 8 | Train Loss: 2.239 Vali Loss: 2.111 Vali Acc: 0.141 Test Loss: 2.111 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 0.6017382144927979
Epoch: 2, Steps: 8 | Train Loss: 2.086 Vali Loss: 1.952 Vali Acc: 0.278 Test Loss: 1.952 Test Acc: 0.278
Validation loss decreased (-0.140604 --> -0.278105).  Saving model ...
Epoch: 3 cost time: 0.6488194465637207
Epoch: 3, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.765 Vali Acc: 0.588 Test Loss: 1.765 Test Acc: 0.588
Validation loss decreased (-0.278105 --> -0.587482).  Saving model ...
Epoch: 4 cost time: 0.7063350677490234
Epoch: 4, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.553 Vali Acc: 0.728 Test Loss: 1.553 Test Acc: 0.728
Validation loss decreased (-0.587482 --> -0.728109).  Saving model ...
Epoch: 5 cost time: 0.6848230361938477
Epoch: 5, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.296 Vali Acc: 0.791 Test Loss: 1.296 Test Acc: 0.791
Validation loss decreased (-0.728109 --> -0.790612).  Saving model ...
Epoch: 6 cost time: 0.7548902034759521
Epoch: 6, Steps: 8 | Train Loss: 1.204 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
Validation loss decreased (-0.790612 --> -0.818740).  Saving model ...
Epoch: 7 cost time: 0.8362948894500732
Epoch: 7, Steps: 8 | Train Loss: 0.888 Vali Loss: 0.728 Vali Acc: 0.838 Test Loss: 0.728 Test Acc: 0.838
Validation loss decreased (-0.818740 --> -0.837493).  Saving model ...
Epoch: 8 cost time: 0.8716776371002197
Epoch: 8, Steps: 8 | Train Loss: 0.652 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
Validation loss decreased (-0.837493 --> -0.837494).  Saving model ...
Epoch: 9 cost time: 0.7457180023193359
Epoch: 9, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.7311503887176514
Epoch: 10, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.6988058090209961
Epoch: 11, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7777960300445557
Epoch: 12, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.462 Vali Acc: 0.859 Test Loss: 0.462 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859370).  Saving model ...
Epoch: 13 cost time: 0.7272076606750488
Epoch: 13, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.492 Vali Acc: 0.859 Test Loss: 0.492 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8396663665771484
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.504 Vali Acc: 0.859 Test Loss: 0.504 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7339117527008057
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6521992683410645
Epoch: 16, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6108207702636719
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.535 Vali Acc: 0.863 Test Loss: 0.535 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862495).  Saving model ...
Epoch: 18 cost time: 0.8616666793823242
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.516 Vali Acc: 0.869 Test Loss: 0.516 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868745).  Saving model ...
Epoch: 19 cost time: 0.8156716823577881
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.527 Vali Acc: 0.863 Test Loss: 0.527 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7725546360015869
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.557 Vali Acc: 0.853 Test Loss: 0.557 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7163984775543213
Epoch: 21, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.856 Test Loss: 0.565 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8332669734954834
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.566 Vali Acc: 0.866 Test Loss: 0.566 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7597522735595703
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.561 Vali Acc: 0.869 Test Loss: 0.561 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7737972736358643
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
Validation loss decreased (-0.868745 --> -0.871869).  Saving model ...
Epoch: 25 cost time: 0.7414989471435547
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7585098743438721
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.600 Vali Acc: 0.863 Test Loss: 0.600 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6718521118164062
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7671499252319336
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.859 Test Loss: 0.607 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7394263744354248
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.604 Vali Acc: 0.859 Test Loss: 0.604 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7935590744018555
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.604 Vali Acc: 0.859 Test Loss: 0.604 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7552485466003418
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.608 Vali Acc: 0.863 Test Loss: 0.608 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7934460639953613
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.863 Test Loss: 0.613 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7685105800628662
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.863 Test Loss: 0.612 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7940194606781006
Epoch: 34, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.859 Test Loss: 0.619 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el6_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 43855112
model size : 181.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.886096477508545
Epoch: 1, Steps: 8 | Train Loss: 2.215 Vali Loss: 1.878 Vali Acc: 0.344 Test Loss: 1.878 Test Acc: 0.344
Validation loss decreased (inf --> -0.343731).  Saving model ...
Epoch: 2 cost time: 1.456996202468872
Epoch: 2, Steps: 8 | Train Loss: 1.707 Vali Loss: 1.251 Vali Acc: 0.697 Test Loss: 1.251 Test Acc: 0.697
Validation loss decreased (-0.343731 --> -0.696862).  Saving model ...
Epoch: 3 cost time: 1.4575624465942383
Epoch: 3, Steps: 8 | Train Loss: 1.031 Vali Loss: 0.769 Vali Acc: 0.787 Test Loss: 0.769 Test Acc: 0.787
Validation loss decreased (-0.696862 --> -0.787492).  Saving model ...
Epoch: 4 cost time: 1.2804539203643799
Epoch: 4, Steps: 8 | Train Loss: 0.592 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.787492 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.4286932945251465
Epoch: 5, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.536 Vali Acc: 0.834 Test Loss: 0.536 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.0415229797363281
Epoch: 6, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.3969624042510986
Epoch: 7, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.742 Vali Acc: 0.828 Test Loss: 0.742 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.029064416885376
Epoch: 8, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.895 Vali Acc: 0.838 Test Loss: 0.895 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5283863544464111
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.113 Vali Acc: 0.825 Test Loss: 1.113 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3264966011047363
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.989 Vali Acc: 0.831 Test Loss: 0.989 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4684457778930664
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.279 Vali Acc: 0.819 Test Loss: 1.279 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6267833709716797
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.236 Vali Acc: 0.825 Test Loss: 1.236 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6831512451171875
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.427 Vali Acc: 0.819 Test Loss: 1.427 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6684269905090332
Epoch: 14, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.558 Vali Acc: 0.819 Test Loss: 1.558 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3282086849212646
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.672 Vali Acc: 0.819 Test Loss: 1.672 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7257575988769531
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.005 Vali Acc: 0.797 Test Loss: 2.005 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 36966920
model size : 155.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9321343898773193
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 1.969 Vali Acc: 0.306 Test Loss: 1.969 Test Acc: 0.306
Validation loss decreased (inf --> -0.306230).  Saving model ...
Epoch: 2 cost time: 1.636389970779419
Epoch: 2, Steps: 8 | Train Loss: 1.831 Vali Loss: 1.522 Vali Acc: 0.722 Test Loss: 1.522 Test Acc: 0.722
Validation loss decreased (-0.306230 --> -0.721860).  Saving model ...
Epoch: 3 cost time: 1.3382747173309326
Epoch: 3, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.066 Vali Acc: 0.753 Test Loss: 1.066 Test Acc: 0.753
Validation loss decreased (-0.721860 --> -0.753114).  Saving model ...
Epoch: 4 cost time: 1.2262763977050781
Epoch: 4, Steps: 8 | Train Loss: 0.811 Vali Loss: 0.727 Vali Acc: 0.806 Test Loss: 0.727 Test Acc: 0.806
Validation loss decreased (-0.753114 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 0.8719620704650879
Epoch: 5, Steps: 8 | Train Loss: 0.530 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.806243 --> -0.828119).  Saving model ...
Epoch: 6 cost time: 1.2269647121429443
Epoch: 6, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2573585510253906
Epoch: 7, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.592 Vali Acc: 0.831 Test Loss: 0.592 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 1.4336371421813965
Epoch: 8, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.617 Vali Acc: 0.853 Test Loss: 0.617 Test Acc: 0.853
Validation loss decreased (-0.831244 --> -0.853119).  Saving model ...
Epoch: 9 cost time: 1.2153384685516357
Epoch: 9, Steps: 8 | Train Loss: 0.113 Vali Loss: 0.695 Vali Acc: 0.838 Test Loss: 0.695 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2387118339538574
Epoch: 10, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.031 Vali Acc: 0.831 Test Loss: 1.031 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2441504001617432
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.834 Vali Acc: 0.866 Test Loss: 0.834 Test Acc: 0.866
Validation loss decreased (-0.853119 --> -0.865617).  Saving model ...
Epoch: 12 cost time: 0.9384646415710449
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.111 Vali Acc: 0.841 Test Loss: 1.111 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7671992778778076
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.468 Vali Acc: 0.803 Test Loss: 1.468 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6690402030944824
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.322 Vali Acc: 0.812 Test Loss: 1.322 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8728392124176025
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.307 Vali Acc: 0.841 Test Loss: 1.307 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6815884113311768
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.316 Vali Acc: 0.841 Test Loss: 1.316 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8694829940795898
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.812 Test Loss: 1.503 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1022436618804932
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.323 Vali Acc: 0.850 Test Loss: 1.323 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.017519235610962
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.296 Vali Acc: 0.856 Test Loss: 1.296 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1941626071929932
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.847 Test Loss: 1.323 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9531991481781006
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.853 Test Loss: 1.376 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36721160
model size : 154.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0490500926971436
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 2.042 Vali Acc: 0.250 Test Loss: 2.042 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 0.8640704154968262
Epoch: 2, Steps: 8 | Train Loss: 1.930 Vali Loss: 1.729 Vali Acc: 0.566 Test Loss: 1.729 Test Acc: 0.566
Validation loss decreased (-0.249980 --> -0.565608).  Saving model ...
Epoch: 3 cost time: 1.0523102283477783
Epoch: 3, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.343 Vali Acc: 0.722 Test Loss: 1.343 Test Acc: 0.722
Validation loss decreased (-0.565608 --> -0.721862).  Saving model ...
Epoch: 4 cost time: 0.7754335403442383
Epoch: 4, Steps: 8 | Train Loss: 1.151 Vali Loss: 0.976 Vali Acc: 0.794 Test Loss: 0.976 Test Acc: 0.794
Validation loss decreased (-0.721862 --> -0.793740).  Saving model ...
Epoch: 5 cost time: 1.3270037174224854
Epoch: 5, Steps: 8 | Train Loss: 0.795 Vali Loss: 0.699 Vali Acc: 0.797 Test Loss: 0.699 Test Acc: 0.797
Validation loss decreased (-0.793740 --> -0.796868).  Saving model ...
Epoch: 6 cost time: 0.7987258434295654
Epoch: 6, Steps: 8 | Train Loss: 0.522 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
Validation loss decreased (-0.796868 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 1.253584384918213
Epoch: 7, Steps: 8 | Train Loss: 0.366 Vali Loss: 0.501 Vali Acc: 0.825 Test Loss: 0.501 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8358457088470459
Epoch: 8, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 1.269054651260376
Epoch: 9, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.619 Vali Acc: 0.834 Test Loss: 0.619 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9915411472320557
Epoch: 10, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.681 Vali Acc: 0.872 Test Loss: 0.681 Test Acc: 0.872
Validation loss decreased (-0.846870 --> -0.871868).  Saving model ...
Epoch: 11 cost time: 1.1092891693115234
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.644 Vali Acc: 0.847 Test Loss: 0.644 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8108983039855957
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.795 Vali Acc: 0.831 Test Loss: 0.795 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.186401128768921
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.876 Vali Acc: 0.828 Test Loss: 0.876 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0763120651245117
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.848 Vali Acc: 0.831 Test Loss: 0.848 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.837644100189209
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.868 Vali Acc: 0.844 Test Loss: 0.868 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.729372501373291
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.985 Vali Acc: 0.828 Test Loss: 0.985 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0689446926116943
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.985 Vali Acc: 0.834 Test Loss: 0.985 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8352041244506836
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.007 Vali Acc: 0.850 Test Loss: 1.007 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9050934314727783
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.942 Vali Acc: 0.869 Test Loss: 0.942 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1728053092956543
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.961 Vali Acc: 0.866 Test Loss: 0.961 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 36567560
model size : 154.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.274461507797241
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 1.860 Vali Acc: 0.372 Test Loss: 1.860 Test Acc: 0.372
Validation loss decreased (inf --> -0.371856).  Saving model ...
Epoch: 2 cost time: 1.3694331645965576
Epoch: 2, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.205 Vali Acc: 0.706 Test Loss: 1.205 Test Acc: 0.706
Validation loss decreased (-0.371856 --> -0.706238).  Saving model ...
Epoch: 3 cost time: 1.211380958557129
Epoch: 3, Steps: 8 | Train Loss: 0.967 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
Validation loss decreased (-0.706238 --> -0.793743).  Saving model ...
Epoch: 4 cost time: 1.6291131973266602
Epoch: 4, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.511 Vali Acc: 0.828 Test Loss: 0.511 Test Acc: 0.828
Validation loss decreased (-0.793743 --> -0.828120).  Saving model ...
Epoch: 5 cost time: 1.1334638595581055
Epoch: 5, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
Validation loss decreased (-0.828120 --> -0.865620).  Saving model ...
Epoch: 6 cost time: 1.0353584289550781
Epoch: 6, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4242072105407715
Epoch: 7, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.649 Vali Acc: 0.847 Test Loss: 0.649 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2223362922668457
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.686 Vali Acc: 0.838 Test Loss: 0.686 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3092598915100098
Epoch: 9, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.952 Vali Acc: 0.841 Test Loss: 0.952 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1709489822387695
Epoch: 10, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.013 Vali Acc: 0.844 Test Loss: 1.013 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2795453071594238
Epoch: 11, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.171 Vali Acc: 0.812 Test Loss: 1.171 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0865557193756104
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.597 Vali Acc: 0.800 Test Loss: 1.597 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1702804565429688
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.501 Vali Acc: 0.800 Test Loss: 1.501 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.196540355682373
Epoch: 14, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.443 Vali Acc: 0.794 Test Loss: 1.443 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2941195964813232
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.149 Vali Acc: 0.866 Test Loss: 1.149 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36973832
model size : 155.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.1597254276275635
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 1.912 Vali Acc: 0.341 Test Loss: 1.912 Test Acc: 0.341
Validation loss decreased (inf --> -0.340606).  Saving model ...
Epoch: 2 cost time: 1.216233491897583
Epoch: 2, Steps: 8 | Train Loss: 1.794 Vali Loss: 1.423 Vali Acc: 0.709 Test Loss: 1.423 Test Acc: 0.709
Validation loss decreased (-0.340606 --> -0.709361).  Saving model ...
Epoch: 3 cost time: 1.510998249053955
Epoch: 3, Steps: 8 | Train Loss: 1.253 Vali Loss: 0.938 Vali Acc: 0.791 Test Loss: 0.938 Test Acc: 0.791
Validation loss decreased (-0.709361 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 0.9118218421936035
Epoch: 4, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
Validation loss decreased (-0.790616 --> -0.843744).  Saving model ...
Epoch: 5 cost time: 1.2839927673339844
Epoch: 5, Steps: 8 | Train Loss: 0.533 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5027740001678467
Epoch: 6, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.511 Vali Acc: 0.828 Test Loss: 0.511 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5501642227172852
Epoch: 7, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8782589435577393
Epoch: 8, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.582 Vali Acc: 0.859 Test Loss: 0.582 Test Acc: 0.859
Validation loss decreased (-0.843744 --> -0.859369).  Saving model ...
Epoch: 9 cost time: 1.484264850616455
Epoch: 9, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.712 Vali Acc: 0.838 Test Loss: 0.712 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0503666400909424
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.794 Vali Acc: 0.841 Test Loss: 0.794 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6059048175811768
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.933 Vali Acc: 0.834 Test Loss: 0.933 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3360092639923096
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.992 Vali Acc: 0.834 Test Loss: 0.992 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1637797355651855
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.905 Vali Acc: 0.866 Test Loss: 0.905 Test Acc: 0.866
Validation loss decreased (-0.859369 --> -0.865616).  Saving model ...
Epoch: 14 cost time: 1.2654306888580322
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.991 Vali Acc: 0.853 Test Loss: 0.991 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5213463306427002
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.027 Vali Acc: 0.850 Test Loss: 1.027 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.286175012588501
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.054 Vali Acc: 0.850 Test Loss: 1.054 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3873236179351807
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.856 Test Loss: 1.073 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1662163734436035
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.847 Test Loss: 1.038 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4560930728912354
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.856 Test Loss: 1.012 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0060131549835205
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.863 Test Loss: 1.036 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3919527530670166
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.853 Test Loss: 1.100 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2987465858459473
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.853 Test Loss: 1.108 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.141179084777832
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.856 Test Loss: 1.113 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36728072
model size : 154.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.877121925354004
Epoch: 1, Steps: 8 | Train Loss: 2.226 Vali Loss: 1.996 Vali Acc: 0.269 Test Loss: 1.996 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 1.2920920848846436
Epoch: 2, Steps: 8 | Train Loss: 1.928 Vali Loss: 1.710 Vali Acc: 0.613 Test Loss: 1.710 Test Acc: 0.613
Validation loss decreased (-0.268730 --> -0.612483).  Saving model ...
Epoch: 3 cost time: 0.9575889110565186
Epoch: 3, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.328 Vali Acc: 0.762 Test Loss: 1.328 Test Acc: 0.762
Validation loss decreased (-0.612483 --> -0.762487).  Saving model ...
Epoch: 4 cost time: 1.196580171585083
Epoch: 4, Steps: 8 | Train Loss: 1.183 Vali Loss: 0.954 Vali Acc: 0.834 Test Loss: 0.954 Test Acc: 0.834
Validation loss decreased (-0.762487 --> -0.834365).  Saving model ...
Epoch: 5 cost time: 0.7266645431518555
Epoch: 5, Steps: 8 | Train Loss: 0.815 Vali Loss: 0.660 Vali Acc: 0.812 Test Loss: 0.660 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8775351047515869
Epoch: 6, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6732025146484375
Epoch: 7, Steps: 8 | Train Loss: 0.429 Vali Loss: 0.456 Vali Acc: 0.831 Test Loss: 0.456 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.839771032333374
Epoch: 8, Steps: 8 | Train Loss: 0.249 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9116415977478027
Epoch: 9, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.834365 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.8349897861480713
Epoch: 10, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.102264404296875
Epoch: 11, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.645 Vali Acc: 0.869 Test Loss: 0.645 Test Acc: 0.869
Validation loss decreased (-0.849995 --> -0.868744).  Saving model ...
Epoch: 12 cost time: 0.9279763698577881
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.583 Vali Acc: 0.863 Test Loss: 0.583 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8812205791473389
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8855979442596436
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.860 Vali Acc: 0.834 Test Loss: 0.860 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0161709785461426
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.891 Vali Acc: 0.841 Test Loss: 0.891 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8277220726013184
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.843 Vali Acc: 0.863 Test Loss: 0.843 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8580691814422607
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.725 Vali Acc: 0.872 Test Loss: 0.725 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871868).  Saving model ...
Epoch: 18 cost time: 1.1731953620910645
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.871868 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.8604114055633545
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.838 Vali Acc: 0.850 Test Loss: 0.838 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2215008735656738
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.844 Test Loss: 0.863 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9321329593658447
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.859 Test Loss: 0.839 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7916915416717529
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.859 Test Loss: 0.811 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9974207878112793
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.866 Test Loss: 0.809 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0206527709960938
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.863 Test Loss: 0.858 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8699464797973633
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.920 Vali Acc: 0.859 Test Loss: 0.920 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0803418159484863
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.866 Test Loss: 0.871 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8540375232696533
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.869 Test Loss: 0.849 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2223501205444336
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.869 Test Loss: 0.850 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 36559112
model size : 154.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.327766180038452
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 1.904 Vali Acc: 0.378 Test Loss: 1.904 Test Acc: 0.378
Validation loss decreased (inf --> -0.378106).  Saving model ...
Epoch: 2 cost time: 1.2677505016326904
Epoch: 2, Steps: 8 | Train Loss: 1.687 Vali Loss: 1.264 Vali Acc: 0.784 Test Loss: 1.264 Test Acc: 0.784
Validation loss decreased (-0.378106 --> -0.784362).  Saving model ...
Epoch: 3 cost time: 1.3268513679504395
Epoch: 3, Steps: 8 | Train Loss: 1.037 Vali Loss: 0.756 Vali Acc: 0.828 Test Loss: 0.756 Test Acc: 0.828
Validation loss decreased (-0.784362 --> -0.828117).  Saving model ...
Epoch: 4 cost time: 0.8850927352905273
Epoch: 4, Steps: 8 | Train Loss: 0.643 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
Validation loss decreased (-0.828117 --> -0.837495).  Saving model ...
Epoch: 5 cost time: 1.36149263381958
Epoch: 5, Steps: 8 | Train Loss: 0.359 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5955445766448975
Epoch: 6, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.635 Vali Acc: 0.838 Test Loss: 0.635 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1358890533447266
Epoch: 7, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.797 Vali Acc: 0.806 Test Loss: 0.797 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6212732791900635
Epoch: 8, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.724 Vali Acc: 0.853 Test Loss: 0.724 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853118).  Saving model ...
Epoch: 9 cost time: 1.4228754043579102
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.894 Vali Acc: 0.828 Test Loss: 0.894 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4236438274383545
Epoch: 10, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.190 Vali Acc: 0.828 Test Loss: 1.190 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3222670555114746
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.972 Vali Acc: 0.853 Test Loss: 0.972 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5385358333587646
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.279 Vali Acc: 0.841 Test Loss: 1.279 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4790081977844238
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.274 Vali Acc: 0.850 Test Loss: 1.274 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4731049537658691
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.409 Vali Acc: 0.828 Test Loss: 1.409 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5653438568115234
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.445 Vali Acc: 0.825 Test Loss: 1.445 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2252247333526611
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.435 Vali Acc: 0.825 Test Loss: 1.435 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.468446969985962
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.530 Vali Acc: 0.831 Test Loss: 1.530 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0709738731384277
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.831 Test Loss: 1.509 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 36980744
model size : 155.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8086793422698975
Epoch: 1, Steps: 8 | Train Loss: 2.131 Vali Loss: 1.938 Vali Acc: 0.331 Test Loss: 1.938 Test Acc: 0.331
Validation loss decreased (inf --> -0.331231).  Saving model ...
Epoch: 2 cost time: 1.1438281536102295
Epoch: 2, Steps: 8 | Train Loss: 1.846 Vali Loss: 1.530 Vali Acc: 0.681 Test Loss: 1.530 Test Acc: 0.681
Validation loss decreased (-0.331231 --> -0.681235).  Saving model ...
Epoch: 3 cost time: 1.4523391723632812
Epoch: 3, Steps: 8 | Train Loss: 1.300 Vali Loss: 1.076 Vali Acc: 0.787 Test Loss: 1.076 Test Acc: 0.787
Validation loss decreased (-0.681235 --> -0.787489).  Saving model ...
Epoch: 4 cost time: 1.2257647514343262
Epoch: 4, Steps: 8 | Train Loss: 0.912 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
Validation loss decreased (-0.787489 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 1.2504723072052002
Epoch: 5, Steps: 8 | Train Loss: 0.614 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.803118 --> -0.818745).  Saving model ...
Epoch: 6 cost time: 1.293351411819458
Epoch: 6, Steps: 8 | Train Loss: 0.443 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 1.0865957736968994
Epoch: 7, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
Validation loss decreased (-0.818745 --> -0.837494).  Saving model ...
Epoch: 8 cost time: 1.2215712070465088
Epoch: 8, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1845762729644775
Epoch: 9, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.701 Vali Acc: 0.841 Test Loss: 0.701 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 1.2382631301879883
Epoch: 10, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.819 Vali Acc: 0.844 Test Loss: 0.819 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843742).  Saving model ...
Epoch: 11 cost time: 1.122628927230835
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.920 Vali Acc: 0.828 Test Loss: 0.920 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3934824466705322
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.041 Vali Acc: 0.809 Test Loss: 1.041 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1824252605438232
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.167 Vali Acc: 0.828 Test Loss: 1.167 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2547821998596191
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.065 Vali Acc: 0.812 Test Loss: 1.065 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0988094806671143
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.321 Vali Acc: 0.822 Test Loss: 1.321 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3848848342895508
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.392 Vali Acc: 0.828 Test Loss: 1.392 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1315944194793701
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.322 Vali Acc: 0.850 Test Loss: 1.322 Test Acc: 0.850
Validation loss decreased (-0.843742 --> -0.849987).  Saving model ...
Epoch: 18 cost time: 1.1575767993927002
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.360 Vali Acc: 0.831 Test Loss: 1.360 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.256298303604126
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.236 Vali Acc: 0.838 Test Loss: 1.236 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8122532367706299
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.168 Vali Acc: 0.834 Test Loss: 1.168 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7166571617126465
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.296 Vali Acc: 0.838 Test Loss: 1.296 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6800932884216309
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.828 Test Loss: 1.294 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8377649784088135
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.276 Vali Acc: 0.859 Test Loss: 1.276 Test Acc: 0.859
Validation loss decreased (-0.849987 --> -0.859362).  Saving model ...
Epoch: 24 cost time: 0.9371387958526611
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.812 Test Loss: 1.522 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9446609020233154
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.414 Vali Acc: 0.841 Test Loss: 1.414 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9171249866485596
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.831 Test Loss: 1.532 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.196134090423584
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.482 Vali Acc: 0.838 Test Loss: 1.482 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8701035976409912
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.819 Test Loss: 1.609 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0662996768951416
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.635 Vali Acc: 0.819 Test Loss: 1.635 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8691666126251221
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.831 Test Loss: 1.618 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8319969177246094
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.834 Test Loss: 1.550 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9821155071258545
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.838 Test Loss: 1.489 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8440160751342773
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.844 Test Loss: 1.458 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 36688904
model size : 154.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.229912281036377
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.010 Vali Acc: 0.219 Test Loss: 2.010 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.7721505165100098
Epoch: 2, Steps: 8 | Train Loss: 1.948 Vali Loss: 1.759 Vali Acc: 0.562 Test Loss: 1.759 Test Acc: 0.562
Validation loss decreased (-0.218730 --> -0.562482).  Saving model ...
Epoch: 3 cost time: 0.9962153434753418
Epoch: 3, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.410 Vali Acc: 0.753 Test Loss: 1.410 Test Acc: 0.753
Validation loss decreased (-0.562482 --> -0.753111).  Saving model ...
Epoch: 4 cost time: 0.967759370803833
Epoch: 4, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.012 Vali Acc: 0.812 Test Loss: 1.012 Test Acc: 0.812
Validation loss decreased (-0.753111 --> -0.812490).  Saving model ...
Epoch: 5 cost time: 1.2800681591033936
Epoch: 5, Steps: 8 | Train Loss: 0.851 Vali Loss: 0.708 Vali Acc: 0.800 Test Loss: 0.708 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9200308322906494
Epoch: 6, Steps: 8 | Train Loss: 0.608 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
Validation loss decreased (-0.812490 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.3327052593231201
Epoch: 7, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.9289417266845703
Epoch: 8, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8215670585632324
Epoch: 9, Steps: 8 | Train Loss: 0.205 Vali Loss: 0.537 Vali Acc: 0.841 Test Loss: 0.537 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9286000728607178
Epoch: 10, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.631 Vali Acc: 0.834 Test Loss: 0.631 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7755894660949707
Epoch: 11, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.648 Vali Acc: 0.847 Test Loss: 0.648 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0951855182647705
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.698 Vali Acc: 0.856 Test Loss: 0.698 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856243).  Saving model ...
Epoch: 13 cost time: 0.834592342376709
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.794 Vali Acc: 0.847 Test Loss: 0.794 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6297636032104492
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.755 Vali Acc: 0.866 Test Loss: 0.755 Test Acc: 0.866
Validation loss decreased (-0.856243 --> -0.865617).  Saving model ...
Epoch: 15 cost time: 0.7408449649810791
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.694 Vali Acc: 0.863 Test Loss: 0.694 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7975590229034424
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.782 Vali Acc: 0.856 Test Loss: 0.782 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7134799957275391
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.866 Vali Acc: 0.856 Test Loss: 0.866 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.303842306137085
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.909 Vali Acc: 0.850 Test Loss: 0.909 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9216969013214111
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.969 Vali Acc: 0.838 Test Loss: 0.969 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8421766757965088
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.972 Vali Acc: 0.838 Test Loss: 0.972 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.201157808303833
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.859 Test Loss: 0.959 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8294241428375244
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.863 Test Loss: 0.924 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9215953350067139
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.869 Test Loss: 0.863 Test Acc: 0.869
Validation loss decreased (-0.865617 --> -0.868741).  Saving model ...
Epoch: 24 cost time: 0.8453123569488525
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.857 Vali Acc: 0.859 Test Loss: 0.857 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8286213874816895
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.872 Vali Acc: 0.863 Test Loss: 0.872 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.88633131980896
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.859 Test Loss: 0.903 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.573824405670166
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.856 Test Loss: 0.919 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7167143821716309
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.853 Test Loss: 0.938 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6533727645874023
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.859 Test Loss: 0.916 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9985384941101074
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.869 Test Loss: 0.904 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8201277256011963
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.901 Vali Acc: 0.866 Test Loss: 0.901 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.109525442123413
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.869 Test Loss: 0.869 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8371791839599609
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.890 Vali Acc: 0.866 Test Loss: 0.890 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 36558344
model size : 154.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.636591672897339
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 1.841 Vali Acc: 0.441 Test Loss: 1.841 Test Acc: 0.441
Validation loss decreased (inf --> -0.440607).  Saving model ...
Epoch: 2 cost time: 1.3527328968048096
Epoch: 2, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.198 Vali Acc: 0.769 Test Loss: 1.198 Test Acc: 0.769
Validation loss decreased (-0.440607 --> -0.768738).  Saving model ...
Epoch: 3 cost time: 1.4094653129577637
Epoch: 3, Steps: 8 | Train Loss: 0.951 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
Validation loss decreased (-0.768738 --> -0.806243).  Saving model ...
Epoch: 4 cost time: 1.053241491317749
Epoch: 4, Steps: 8 | Train Loss: 0.494 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.806243 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 1.00588059425354
Epoch: 5, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.505 Vali Acc: 0.847 Test Loss: 0.505 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 1.2260968685150146
Epoch: 6, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 1.4921681880950928
Epoch: 7, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.925 Vali Acc: 0.816 Test Loss: 0.925 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4587547779083252
Epoch: 8, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.834 Vali Acc: 0.881 Test Loss: 0.834 Test Acc: 0.881
Validation loss decreased (-0.849994 --> -0.881242).  Saving model ...
Epoch: 9 cost time: 1.2349059581756592
Epoch: 9, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.170 Vali Acc: 0.812 Test Loss: 1.170 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5218470096588135
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.054 Vali Acc: 0.859 Test Loss: 1.054 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6831202507019043
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.229 Vali Acc: 0.825 Test Loss: 1.229 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2770180702209473
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.844 Test Loss: 1.218 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4148766994476318
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.280 Vali Acc: 0.828 Test Loss: 1.280 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2096176147460938
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.312 Vali Acc: 0.828 Test Loss: 1.312 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2261815071105957
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.745 Vali Acc: 0.781 Test Loss: 1.745 Test Acc: 0.781
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4299769401550293
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.385 Vali Acc: 0.838 Test Loss: 1.385 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0652837753295898
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.514 Vali Acc: 0.834 Test Loss: 1.514 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3220810890197754
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.828 Vali Acc: 0.812 Test Loss: 1.828 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 36979976
model size : 155.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5620622634887695
Epoch: 1, Steps: 8 | Train Loss: 2.154 Vali Loss: 1.895 Vali Acc: 0.409 Test Loss: 1.895 Test Acc: 0.409
Validation loss decreased (inf --> -0.409356).  Saving model ...
Epoch: 2 cost time: 0.8473432064056396
Epoch: 2, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.510 Vali Acc: 0.622 Test Loss: 1.510 Test Acc: 0.622
Validation loss decreased (-0.409356 --> -0.621860).  Saving model ...
Epoch: 3 cost time: 1.1621286869049072
Epoch: 3, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.040 Vali Acc: 0.784 Test Loss: 1.040 Test Acc: 0.784
Validation loss decreased (-0.621860 --> -0.784365).  Saving model ...
Epoch: 4 cost time: 1.0974979400634766
Epoch: 4, Steps: 8 | Train Loss: 0.838 Vali Loss: 0.672 Vali Acc: 0.838 Test Loss: 0.672 Test Acc: 0.838
Validation loss decreased (-0.784365 --> -0.837493).  Saving model ...
Epoch: 5 cost time: 1.0322153568267822
Epoch: 5, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.523 Vali Acc: 0.812 Test Loss: 0.523 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2115364074707031
Epoch: 6, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2090578079223633
Epoch: 7, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.588 Vali Acc: 0.834 Test Loss: 0.588 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.300861120223999
Epoch: 8, Steps: 8 | Train Loss: 0.175 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
Validation loss decreased (-0.837493 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 0.9152848720550537
Epoch: 9, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.782 Vali Acc: 0.816 Test Loss: 0.782 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1722173690795898
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.783 Vali Acc: 0.838 Test Loss: 0.783 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1398820877075195
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.968 Vali Acc: 0.822 Test Loss: 0.968 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.341306209564209
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.929 Vali Acc: 0.838 Test Loss: 0.929 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9172701835632324
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.949 Vali Acc: 0.822 Test Loss: 0.949 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.147778034210205
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.266 Vali Acc: 0.828 Test Loss: 1.266 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0626394748687744
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.984 Vali Acc: 0.834 Test Loss: 0.984 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3618853092193604
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.030 Vali Acc: 0.838 Test Loss: 1.030 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9706850051879883
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.319 Vali Acc: 0.825 Test Loss: 1.319 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1393370628356934
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.276 Vali Acc: 0.834 Test Loss: 1.276 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 36695816
model size : 154.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6435203552246094
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.004 Vali Acc: 0.237 Test Loss: 2.004 Test Acc: 0.237
Validation loss decreased (inf --> -0.237480).  Saving model ...
Epoch: 2 cost time: 0.7757432460784912
Epoch: 2, Steps: 8 | Train Loss: 1.930 Vali Loss: 1.734 Vali Acc: 0.672 Test Loss: 1.734 Test Acc: 0.672
Validation loss decreased (-0.237480 --> -0.671858).  Saving model ...
Epoch: 3 cost time: 0.9260828495025635
Epoch: 3, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.400 Vali Acc: 0.778 Test Loss: 1.400 Test Acc: 0.778
Validation loss decreased (-0.671858 --> -0.778111).  Saving model ...
Epoch: 4 cost time: 1.0510551929473877
Epoch: 4, Steps: 8 | Train Loss: 1.258 Vali Loss: 1.017 Vali Acc: 0.809 Test Loss: 1.017 Test Acc: 0.809
Validation loss decreased (-0.778111 --> -0.809365).  Saving model ...
Epoch: 5 cost time: 0.632697582244873
Epoch: 5, Steps: 8 | Train Loss: 0.902 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
Validation loss decreased (-0.809365 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 1.0341358184814453
Epoch: 6, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.514 Vali Acc: 0.834 Test Loss: 0.514 Test Acc: 0.834
Validation loss decreased (-0.824993 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 1.07857084274292
Epoch: 7, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7874588966369629
Epoch: 8, Steps: 8 | Train Loss: 0.231 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 1.0031919479370117
Epoch: 9, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.1858515739440918
Epoch: 10, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.734 Vali Acc: 0.816 Test Loss: 0.734 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8854143619537354
Epoch: 11, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.731 Vali Acc: 0.834 Test Loss: 0.731 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1187736988067627
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.686 Vali Acc: 0.853 Test Loss: 0.686 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853118).  Saving model ...
Epoch: 13 cost time: 1.0371196269989014
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.710 Vali Acc: 0.838 Test Loss: 0.710 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2017695903778076
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.718 Vali Acc: 0.853 Test Loss: 0.718 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9697649478912354
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.722 Vali Acc: 0.863 Test Loss: 0.722 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862493).  Saving model ...
Epoch: 16 cost time: 0.8961610794067383
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.728 Vali Acc: 0.859 Test Loss: 0.728 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8655710220336914
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.751 Vali Acc: 0.847 Test Loss: 0.751 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8427116870880127
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.857 Vali Acc: 0.856 Test Loss: 0.857 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8030462265014648
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.888 Vali Acc: 0.853 Test Loss: 0.888 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6916134357452393
Epoch: 20, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.783 Vali Acc: 0.859 Test Loss: 0.783 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7828919887542725
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.853 Test Loss: 0.782 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7267062664031982
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.773 Vali Acc: 0.847 Test Loss: 0.773 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7891459465026855
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.766 Vali Acc: 0.859 Test Loss: 0.766 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.706122636795044
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.853 Test Loss: 0.841 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9113049507141113
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.866 Test Loss: 0.873 Test Acc: 0.866
Validation loss decreased (-0.862493 --> -0.865616).  Saving model ...
Epoch: 26 cost time: 0.8318254947662354
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.863 Test Loss: 0.896 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8744337558746338
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.877 Vali Acc: 0.869 Test Loss: 0.877 Test Acc: 0.869
Validation loss decreased (-0.865616 --> -0.868741).  Saving model ...
Epoch: 28 cost time: 0.943610668182373
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.872 Test Loss: 0.859 Test Acc: 0.872
Validation loss decreased (-0.868741 --> -0.871866).  Saving model ...
Epoch: 29 cost time: 0.8364026546478271
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.872 Test Loss: 0.848 Test Acc: 0.872
Validation loss decreased (-0.871866 --> -0.871867).  Saving model ...
Epoch: 30 cost time: 0.9986090660095215
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.866 Test Loss: 0.834 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9223487377166748
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.866 Test Loss: 0.824 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.131364345550537
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.866 Test Loss: 0.815 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6832003593444824
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.869 Test Loss: 0.830 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.022214651107788
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.866 Test Loss: 0.832 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0168821811676025
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.866 Test Loss: 0.829 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8686585426330566
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.875 Test Loss: 0.816 Test Acc: 0.875
Validation loss decreased (-0.871867 --> -0.874992).  Saving model ...
Epoch: 37 cost time: 0.9924049377441406
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.875 Test Loss: 0.812 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 38 cost time: 0.777972936630249
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.866 Test Loss: 0.830 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1660912036895752
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.863 Test Loss: 0.848 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2172324657440186
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.866 Test Loss: 0.854 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0936336517333984
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.866 Test Loss: 0.855 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9214282035827637
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.866 Test Loss: 0.851 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2787199020385742
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.866 Test Loss: 0.849 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8821442127227783
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.866 Test Loss: 0.846 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0625636577606201
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.866 Test Loss: 0.844 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8997533321380615
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.866 Test Loss: 0.837 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9511938095092773
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.869 Test Loss: 0.831 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 36549896
model size : 154.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.939680576324463
Epoch: 1, Steps: 8 | Train Loss: 2.159 Vali Loss: 1.937 Vali Acc: 0.328 Test Loss: 1.937 Test Acc: 0.328
Validation loss decreased (inf --> -0.328106).  Saving model ...
Epoch: 2 cost time: 0.9641411304473877
Epoch: 2, Steps: 8 | Train Loss: 1.744 Vali Loss: 1.379 Vali Acc: 0.728 Test Loss: 1.379 Test Acc: 0.728
Validation loss decreased (-0.328106 --> -0.728111).  Saving model ...
Epoch: 3 cost time: 0.9232099056243896
Epoch: 3, Steps: 8 | Train Loss: 1.135 Vali Loss: 0.872 Vali Acc: 0.791 Test Loss: 0.872 Test Acc: 0.791
Validation loss decreased (-0.728111 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 1.1440284252166748
Epoch: 4, Steps: 8 | Train Loss: 0.681 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.790616 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 0.9434075355529785
Epoch: 5, Steps: 8 | Train Loss: 0.401 Vali Loss: 0.493 Vali Acc: 0.841 Test Loss: 0.493 Test Acc: 0.841
Validation loss decreased (-0.821869 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.5534896850585938
Epoch: 6, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.594 Vali Acc: 0.831 Test Loss: 0.594 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2647395133972168
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.644 Vali Acc: 0.853 Test Loss: 0.644 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853119).  Saving model ...
Epoch: 8 cost time: 1.2329885959625244
Epoch: 8, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.782 Vali Acc: 0.825 Test Loss: 0.782 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6891181468963623
Epoch: 9, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.857 Vali Acc: 0.831 Test Loss: 0.857 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3912672996520996
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.935 Vali Acc: 0.863 Test Loss: 0.935 Test Acc: 0.863
Validation loss decreased (-0.853119 --> -0.862491).  Saving model ...
Epoch: 11 cost time: 1.6291286945343018
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.952 Vali Acc: 0.853 Test Loss: 0.952 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9320926666259766
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.156 Vali Acc: 0.841 Test Loss: 1.156 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.221358060836792
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.365 Vali Acc: 0.825 Test Loss: 1.365 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4402198791503906
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.232 Vali Acc: 0.847 Test Loss: 1.232 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3540451526641846
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.253 Vali Acc: 0.856 Test Loss: 1.253 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2234411239624023
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.834 Test Loss: 1.353 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5016744136810303
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.831 Test Loss: 1.394 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.123091697692871
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.834 Test Loss: 1.392 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6960759162902832
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.838 Test Loss: 1.367 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6694767475128174
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.841 Test Loss: 1.353 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 36871688
model size : 155.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7037012577056885
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 1.942 Vali Acc: 0.291 Test Loss: 1.942 Test Acc: 0.291
Validation loss decreased (inf --> -0.290606).  Saving model ...
Epoch: 2 cost time: 0.8196971416473389
Epoch: 2, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.585 Vali Acc: 0.650 Test Loss: 1.585 Test Acc: 0.650
Validation loss decreased (-0.290606 --> -0.649984).  Saving model ...
Epoch: 3 cost time: 0.7719988822937012
Epoch: 3, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.136 Vali Acc: 0.747 Test Loss: 1.136 Test Acc: 0.747
Validation loss decreased (-0.649984 --> -0.746864).  Saving model ...
Epoch: 4 cost time: 0.8834078311920166
Epoch: 4, Steps: 8 | Train Loss: 1.009 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.746864 --> -0.809368).  Saving model ...
Epoch: 5 cost time: 0.9646396636962891
Epoch: 5, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809369).  Saving model ...
Epoch: 6 cost time: 1.048663854598999
Epoch: 6, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
Validation loss decreased (-0.809369 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 1.3923213481903076
Epoch: 7, Steps: 8 | Train Loss: 0.285 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
Validation loss decreased (-0.818745 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 1.3916501998901367
Epoch: 8, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.661 Vali Acc: 0.847 Test Loss: 0.661 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1479387283325195
Epoch: 9, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.856245 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 0.7585787773132324
Epoch: 10, Steps: 8 | Train Loss: 0.071 Vali Loss: 0.713 Vali Acc: 0.844 Test Loss: 0.713 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.885810136795044
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.775 Vali Acc: 0.853 Test Loss: 0.775 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6980321407318115
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.862 Vali Acc: 0.838 Test Loss: 0.862 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.953101634979248
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.935 Vali Acc: 0.872 Test Loss: 0.935 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.341555118560791
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.933 Vali Acc: 0.847 Test Loss: 0.933 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8700494766235352
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.999 Vali Acc: 0.844 Test Loss: 0.999 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9523169994354248
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.984 Vali Acc: 0.850 Test Loss: 0.984 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2106688022613525
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.964 Vali Acc: 0.866 Test Loss: 0.964 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.828033447265625
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.979 Vali Acc: 0.856 Test Loss: 0.979 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6548607349395752
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.095 Vali Acc: 0.838 Test Loss: 1.095 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 36672008
model size : 154.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.436239719390869
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 1.972 Vali Acc: 0.178 Test Loss: 1.972 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.0119917392730713
Epoch: 2, Steps: 8 | Train Loss: 1.940 Vali Loss: 1.718 Vali Acc: 0.637 Test Loss: 1.718 Test Acc: 0.637
Validation loss decreased (-0.178105 --> -0.637483).  Saving model ...
Epoch: 3 cost time: 0.6592369079589844
Epoch: 3, Steps: 8 | Train Loss: 1.670 Vali Loss: 1.426 Vali Acc: 0.703 Test Loss: 1.426 Test Acc: 0.703
Validation loss decreased (-0.637483 --> -0.703111).  Saving model ...
Epoch: 4 cost time: 1.2089102268218994
Epoch: 4, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.092 Vali Acc: 0.816 Test Loss: 1.092 Test Acc: 0.816
Validation loss decreased (-0.703111 --> -0.815614).  Saving model ...
Epoch: 5 cost time: 0.6919910907745361
Epoch: 5, Steps: 8 | Train Loss: 0.968 Vali Loss: 0.765 Vali Acc: 0.844 Test Loss: 0.765 Test Acc: 0.844
Validation loss decreased (-0.815614 --> -0.843742).  Saving model ...
Epoch: 6 cost time: 1.149850606918335
Epoch: 6, Steps: 8 | Train Loss: 0.747 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9815425872802734
Epoch: 7, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
Validation loss decreased (-0.843742 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.8931806087493896
Epoch: 8, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3333077430725098
Epoch: 9, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.579 Vali Acc: 0.838 Test Loss: 0.579 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7491133213043213
Epoch: 10, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856244).  Saving model ...
Epoch: 11 cost time: 1.018897533416748
Epoch: 11, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.596 Vali Acc: 0.875 Test Loss: 0.596 Test Acc: 0.875
Validation loss decreased (-0.856244 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 1.144063949584961
Epoch: 12, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.651 Vali Acc: 0.866 Test Loss: 0.651 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.406904697418213
Epoch: 13, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7730667591094971
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.684 Vali Acc: 0.872 Test Loss: 0.684 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3202722072601318
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8575248718261719
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.813 Vali Acc: 0.847 Test Loss: 0.813 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7009077072143555
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.758 Vali Acc: 0.859 Test Loss: 0.758 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0702028274536133
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.682 Vali Acc: 0.869 Test Loss: 0.682 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0600292682647705
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.856 Test Loss: 0.728 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3437695503234863
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.779 Vali Acc: 0.859 Test Loss: 0.779 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0405089855194092
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.812 Vali Acc: 0.866 Test Loss: 0.812 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 36549128
model size : 154.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4506983757019043
Epoch: 1, Steps: 8 | Train Loss: 2.100 Vali Loss: 1.822 Vali Acc: 0.434 Test Loss: 1.822 Test Acc: 0.434
Validation loss decreased (inf --> -0.434357).  Saving model ...
Epoch: 2 cost time: 0.822943925857544
Epoch: 2, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.202 Vali Acc: 0.819 Test Loss: 1.202 Test Acc: 0.819
Validation loss decreased (-0.434357 --> -0.818738).  Saving model ...
Epoch: 3 cost time: 0.9398672580718994
Epoch: 3, Steps: 8 | Train Loss: 1.002 Vali Loss: 0.709 Vali Acc: 0.812 Test Loss: 0.709 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1993517875671387
Epoch: 4, Steps: 8 | Train Loss: 0.596 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
Validation loss decreased (-0.818738 --> -0.856245).  Saving model ...
Epoch: 5 cost time: 1.7210569381713867
Epoch: 5, Steps: 8 | Train Loss: 0.389 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1006455421447754
Epoch: 6, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.641 Vali Acc: 0.819 Test Loss: 0.641 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4596819877624512
Epoch: 7, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.671 Vali Acc: 0.834 Test Loss: 0.671 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.965968132019043
Epoch: 8, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.825 Vali Acc: 0.831 Test Loss: 0.825 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7792770862579346
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.951 Vali Acc: 0.822 Test Loss: 0.951 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4663867950439453
Epoch: 10, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.930 Vali Acc: 0.838 Test Loss: 0.930 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4973335266113281
Epoch: 11, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.545 Vali Acc: 0.797 Test Loss: 1.545 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1605169773101807
Epoch: 12, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.237 Vali Acc: 0.825 Test Loss: 1.237 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6626074314117432
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.328 Vali Acc: 0.816 Test Loss: 1.328 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.218229055404663
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.276 Vali Acc: 0.838 Test Loss: 1.276 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 36878600
model size : 155.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3502914905548096
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 1.912 Vali Acc: 0.306 Test Loss: 1.912 Test Acc: 0.306
Validation loss decreased (inf --> -0.306231).  Saving model ...
Epoch: 2 cost time: 1.175853967666626
Epoch: 2, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.503 Vali Acc: 0.678 Test Loss: 1.503 Test Acc: 0.678
Validation loss decreased (-0.306231 --> -0.678110).  Saving model ...
Epoch: 3 cost time: 1.1775031089782715
Epoch: 3, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.017 Vali Acc: 0.769 Test Loss: 1.017 Test Acc: 0.769
Validation loss decreased (-0.678110 --> -0.768740).  Saving model ...
Epoch: 4 cost time: 0.9608755111694336
Epoch: 4, Steps: 8 | Train Loss: 0.907 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
Validation loss decreased (-0.768740 --> -0.843743).  Saving model ...
Epoch: 5 cost time: 0.8545863628387451
Epoch: 5, Steps: 8 | Train Loss: 0.584 Vali Loss: 0.547 Vali Acc: 0.806 Test Loss: 0.547 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9580352306365967
Epoch: 6, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.843743 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.8788862228393555
Epoch: 7, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2889511585235596
Epoch: 8, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8054378032684326
Epoch: 9, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2975921630859375
Epoch: 10, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.768 Vali Acc: 0.834 Test Loss: 0.768 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9490149021148682
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.861 Vali Acc: 0.825 Test Loss: 0.861 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8364217281341553
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.964 Vali Acc: 0.825 Test Loss: 0.964 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.113952398300171
Epoch: 13, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.095 Vali Acc: 0.822 Test Loss: 1.095 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0704751014709473
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.998 Vali Acc: 0.812 Test Loss: 0.998 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0327346324920654
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.054 Vali Acc: 0.841 Test Loss: 1.054 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9001011848449707
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.114 Vali Acc: 0.825 Test Loss: 1.114 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 36678920
model size : 154.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7884178161621094
Epoch: 1, Steps: 8 | Train Loss: 2.181 Vali Loss: 2.048 Vali Acc: 0.156 Test Loss: 2.048 Test Acc: 0.156
Validation loss decreased (inf --> -0.156230).  Saving model ...
Epoch: 2 cost time: 0.9986016750335693
Epoch: 2, Steps: 8 | Train Loss: 1.943 Vali Loss: 1.792 Vali Acc: 0.547 Test Loss: 1.792 Test Acc: 0.547
Validation loss decreased (-0.156230 --> -0.546857).  Saving model ...
Epoch: 3 cost time: 1.1941697597503662
Epoch: 3, Steps: 8 | Train Loss: 1.683 Vali Loss: 1.470 Vali Acc: 0.684 Test Loss: 1.470 Test Acc: 0.684
Validation loss decreased (-0.546857 --> -0.684360).  Saving model ...
Epoch: 4 cost time: 1.2176291942596436
Epoch: 4, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.105 Vali Acc: 0.784 Test Loss: 1.105 Test Acc: 0.784
Validation loss decreased (-0.684360 --> -0.784364).  Saving model ...
Epoch: 5 cost time: 0.7966263294219971
Epoch: 5, Steps: 8 | Train Loss: 0.953 Vali Loss: 0.775 Vali Acc: 0.812 Test Loss: 0.775 Test Acc: 0.812
Validation loss decreased (-0.784364 --> -0.812492).  Saving model ...
Epoch: 6 cost time: 0.8232917785644531
Epoch: 6, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
Validation loss decreased (-0.812492 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.8528316020965576
Epoch: 7, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.8449969291687012
Epoch: 8, Steps: 8 | Train Loss: 0.354 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.9210848808288574
Epoch: 9, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0853261947631836
Epoch: 10, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9017839431762695
Epoch: 11, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7201886177062988
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.690 Vali Acc: 0.834 Test Loss: 0.690 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7442986965179443
Epoch: 13, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.747 Vali Acc: 0.834 Test Loss: 0.747 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7148399353027344
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.836 Vali Acc: 0.819 Test Loss: 0.836 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8537509441375732
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.000 Vali Acc: 0.816 Test Loss: 1.000 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6493792533874512
Epoch: 16, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.951 Vali Acc: 0.838 Test Loss: 0.951 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8246250152587891
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.909 Vali Acc: 0.819 Test Loss: 0.909 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9618401527404785
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.964 Vali Acc: 0.838 Test Loss: 0.964 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8375
model parameter : 36548360
model size : 154.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.0603108406066895
Epoch: 1, Steps: 8 | Train Loss: 2.197 Vali Loss: 1.955 Vali Acc: 0.287 Test Loss: 1.955 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 1.1564080715179443
Epoch: 2, Steps: 8 | Train Loss: 1.793 Vali Loss: 1.372 Vali Acc: 0.669 Test Loss: 1.372 Test Acc: 0.669
Validation loss decreased (-0.287480 --> -0.668736).  Saving model ...
Epoch: 3 cost time: 0.9475607872009277
Epoch: 3, Steps: 8 | Train Loss: 1.269 Vali Loss: 0.894 Vali Acc: 0.794 Test Loss: 0.894 Test Acc: 0.794
Validation loss decreased (-0.668736 --> -0.793741).  Saving model ...
Epoch: 4 cost time: 1.219271183013916
Epoch: 4, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
Validation loss decreased (-0.793741 --> -0.828119).  Saving model ...
Epoch: 5 cost time: 1.1033477783203125
Epoch: 5, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5100934505462646
Epoch: 6, Steps: 8 | Train Loss: 0.272 Vali Loss: 0.516 Vali Acc: 0.841 Test Loss: 0.516 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 1.4235374927520752
Epoch: 7, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.723 Vali Acc: 0.825 Test Loss: 0.723 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7660064697265625
Epoch: 8, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.768 Vali Acc: 0.834 Test Loss: 0.768 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2173075675964355
Epoch: 9, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.868 Vali Acc: 0.844 Test Loss: 0.868 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843741).  Saving model ...
Epoch: 10 cost time: 0.9833188056945801
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.088 Vali Acc: 0.825 Test Loss: 1.088 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8526785373687744
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.109 Vali Acc: 0.831 Test Loss: 1.109 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4085147380828857
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.318 Vali Acc: 0.831 Test Loss: 1.318 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2118141651153564
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.561 Vali Acc: 0.812 Test Loss: 1.561 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1132855415344238
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.458 Vali Acc: 0.812 Test Loss: 1.458 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.160123586654663
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.662 Vali Acc: 0.816 Test Loss: 1.662 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4598746299743652
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.566 Vali Acc: 0.800 Test Loss: 1.566 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5071945190429688
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.611 Vali Acc: 0.812 Test Loss: 1.611 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4886884689331055
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.642 Vali Acc: 0.819 Test Loss: 1.642 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.014914035797119
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.684 Vali Acc: 0.806 Test Loss: 1.684 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 36885512
model size : 155.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.857234239578247
Epoch: 1, Steps: 8 | Train Loss: 2.087 Vali Loss: 1.944 Vali Acc: 0.297 Test Loss: 1.944 Test Acc: 0.297
Validation loss decreased (inf --> -0.296856).  Saving model ...
Epoch: 2 cost time: 1.2996501922607422
Epoch: 2, Steps: 8 | Train Loss: 1.816 Vali Loss: 1.557 Vali Acc: 0.731 Test Loss: 1.557 Test Acc: 0.731
Validation loss decreased (-0.296856 --> -0.731234).  Saving model ...
Epoch: 3 cost time: 1.4778923988342285
Epoch: 3, Steps: 8 | Train Loss: 1.354 Vali Loss: 1.132 Vali Acc: 0.766 Test Loss: 1.132 Test Acc: 0.766
Validation loss decreased (-0.731234 --> -0.765614).  Saving model ...
Epoch: 4 cost time: 1.0432844161987305
Epoch: 4, Steps: 8 | Train Loss: 0.950 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.765614 --> -0.824993).  Saving model ...
Epoch: 5 cost time: 0.9358696937561035
Epoch: 5, Steps: 8 | Train Loss: 0.610 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
Validation loss decreased (-0.824993 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.9859724044799805
Epoch: 6, Steps: 8 | Train Loss: 0.397 Vali Loss: 0.529 Vali Acc: 0.831 Test Loss: 0.529 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4679327011108398
Epoch: 7, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.574 Vali Acc: 0.812 Test Loss: 0.574 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3337643146514893
Epoch: 8, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3855574131011963
Epoch: 9, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.627 Vali Acc: 0.838 Test Loss: 0.627 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.414036750793457
Epoch: 10, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 1.3792095184326172
Epoch: 11, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.730 Vali Acc: 0.847 Test Loss: 0.730 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.036377191543579
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.831 Vali Acc: 0.834 Test Loss: 0.831 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9802484512329102
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.983 Vali Acc: 0.831 Test Loss: 0.983 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0329065322875977
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.072460651397705
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.844 Vali Acc: 0.853 Test Loss: 0.844 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853117).  Saving model ...
Epoch: 16 cost time: 0.9905943870544434
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.957 Vali Acc: 0.844 Test Loss: 0.957 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9006555080413818
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.948 Vali Acc: 0.834 Test Loss: 0.948 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7929480075836182
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.868 Vali Acc: 0.847 Test Loss: 0.868 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0481641292572021
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.179 Vali Acc: 0.838 Test Loss: 1.179 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8303053379058838
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.989 Vali Acc: 0.844 Test Loss: 0.989 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1178169250488281
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.841 Test Loss: 0.954 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7261600494384766
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.944 Vali Acc: 0.844 Test Loss: 0.944 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8298485279083252
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.844 Test Loss: 0.971 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0570087432861328
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.850 Test Loss: 1.006 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0128331184387207
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.850 Test Loss: 1.027 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 36655112
model size : 154.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7371907234191895
Epoch: 1, Steps: 8 | Train Loss: 2.224 Vali Loss: 2.047 Vali Acc: 0.219 Test Loss: 2.047 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 1.0358350276947021
Epoch: 2, Steps: 8 | Train Loss: 1.993 Vali Loss: 1.819 Vali Acc: 0.447 Test Loss: 1.819 Test Acc: 0.447
Validation loss decreased (-0.218730 --> -0.446857).  Saving model ...
Epoch: 3 cost time: 1.0200862884521484
Epoch: 3, Steps: 8 | Train Loss: 1.716 Vali Loss: 1.529 Vali Acc: 0.706 Test Loss: 1.529 Test Acc: 0.706
Validation loss decreased (-0.446857 --> -0.706235).  Saving model ...
Epoch: 4 cost time: 0.9717006683349609
Epoch: 4, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.202 Vali Acc: 0.756 Test Loss: 1.202 Test Acc: 0.756
Validation loss decreased (-0.706235 --> -0.756238).  Saving model ...
Epoch: 5 cost time: 1.2699339389801025
Epoch: 5, Steps: 8 | Train Loss: 1.041 Vali Loss: 0.870 Vali Acc: 0.791 Test Loss: 0.870 Test Acc: 0.791
Validation loss decreased (-0.756238 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 1.1305017471313477
Epoch: 6, Steps: 8 | Train Loss: 0.723 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
Validation loss decreased (-0.790616 --> -0.812494).  Saving model ...
Epoch: 7 cost time: 0.9483134746551514
Epoch: 7, Steps: 8 | Train Loss: 0.487 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
Validation loss decreased (-0.812494 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 1.1978533267974854
Epoch: 8, Steps: 8 | Train Loss: 0.337 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 1.1372497081756592
Epoch: 9, Steps: 8 | Train Loss: 0.255 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9919636249542236
Epoch: 10, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8924787044525146
Epoch: 11, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.602 Vali Acc: 0.838 Test Loss: 0.602 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.014737844467163
Epoch: 12, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.591 Vali Acc: 0.859 Test Loss: 0.591 Test Acc: 0.859
Validation loss decreased (-0.840620 --> -0.859369).  Saving model ...
Epoch: 13 cost time: 0.9742918014526367
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.687 Vali Acc: 0.838 Test Loss: 0.687 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.02030348777771
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.697 Vali Acc: 0.841 Test Loss: 0.697 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.112382411956787
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.688 Vali Acc: 0.831 Test Loss: 0.688 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2289988994598389
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.788 Vali Acc: 0.834 Test Loss: 0.788 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0198264122009277
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.789 Vali Acc: 0.831 Test Loss: 0.789 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.046187400817871
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.788 Vali Acc: 0.841 Test Loss: 0.788 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0476179122924805
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.811 Vali Acc: 0.844 Test Loss: 0.811 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8447368144989014
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.821 Vali Acc: 0.853 Test Loss: 0.821 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9242141246795654
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.844 Test Loss: 0.830 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8406484127044678
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.838 Test Loss: 0.866 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 36547592
model size : 154.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.999995470046997
Epoch: 1, Steps: 8 | Train Loss: 2.137 Vali Loss: 1.891 Vali Acc: 0.359 Test Loss: 1.891 Test Acc: 0.359
Validation loss decreased (inf --> -0.359356).  Saving model ...
Epoch: 2 cost time: 0.9683670997619629
Epoch: 2, Steps: 8 | Train Loss: 1.701 Vali Loss: 1.325 Vali Acc: 0.716 Test Loss: 1.325 Test Acc: 0.716
Validation loss decreased (-0.359356 --> -0.715612).  Saving model ...
Epoch: 3 cost time: 1.2323896884918213
Epoch: 3, Steps: 8 | Train Loss: 1.105 Vali Loss: 0.766 Vali Acc: 0.844 Test Loss: 0.766 Test Acc: 0.844
Validation loss decreased (-0.715612 --> -0.843742).  Saving model ...
Epoch: 4 cost time: 1.62343168258667
Epoch: 4, Steps: 8 | Train Loss: 0.634 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6703364849090576
Epoch: 5, Steps: 8 | Train Loss: 0.383 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.694314956665039
Epoch: 6, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.655 Vali Acc: 0.816 Test Loss: 0.655 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1925129890441895
Epoch: 7, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2027311325073242
Epoch: 8, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.772 Vali Acc: 0.844 Test Loss: 0.772 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1679205894470215
Epoch: 9, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.732 Vali Acc: 0.847 Test Loss: 0.732 Test Acc: 0.847
Validation loss decreased (-0.843742 --> -0.846868).  Saving model ...
Epoch: 10 cost time: 1.2653894424438477
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.101 Vali Acc: 0.828 Test Loss: 1.101 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4356510639190674
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.935 Vali Acc: 0.850 Test Loss: 0.935 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 1.3848896026611328
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.236 Vali Acc: 0.866 Test Loss: 1.236 Test Acc: 0.866
Validation loss decreased (-0.849991 --> -0.865613).  Saving model ...
Epoch: 13 cost time: 1.746220588684082
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.555 Vali Acc: 0.866 Test Loss: 1.555 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1275148391723633
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.426 Vali Acc: 0.850 Test Loss: 1.426 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0984187126159668
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.770 Vali Acc: 0.856 Test Loss: 1.770 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2193775177001953
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.047 Vali Acc: 0.816 Test Loss: 2.047 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.973508358001709
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.659 Vali Acc: 0.853 Test Loss: 1.659 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9322311878204346
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.859 Test Loss: 1.530 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2019922733306885
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.550 Vali Acc: 0.853 Test Loss: 1.550 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7981300354003906
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.569 Vali Acc: 0.884 Test Loss: 1.569 Test Acc: 0.884
Validation loss decreased (-0.865613 --> -0.884359).  Saving model ...
Epoch: 21 cost time: 1.0659334659576416
Epoch: 21, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.782 Vali Acc: 0.859 Test Loss: 1.782 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2154810428619385
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.905 Vali Acc: 0.847 Test Loss: 1.905 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2229986190795898
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.871 Vali Acc: 0.853 Test Loss: 1.871 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9114654064178467
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.869 Test Loss: 1.771 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2658665180206299
Epoch: 25, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.790 Vali Acc: 0.853 Test Loss: 1.790 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.735156536102295
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.776 Vali Acc: 0.872 Test Loss: 1.776 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3041369915008545
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.896 Vali Acc: 0.838 Test Loss: 1.896 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1984572410583496
Epoch: 28, Steps: 8 | Train Loss: 0.059 Vali Loss: 2.452 Vali Acc: 0.838 Test Loss: 2.452 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7225773334503174
Epoch: 29, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.235 Vali Acc: 0.831 Test Loss: 2.235 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7127234935760498
Epoch: 30, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.844 Vali Acc: 0.859 Test Loss: 1.844 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 36892424
model size : 155.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.8276784420013428
Epoch: 1, Steps: 8 | Train Loss: 2.134 Vali Loss: 1.946 Vali Acc: 0.228 Test Loss: 1.946 Test Acc: 0.228
Validation loss decreased (inf --> -0.228106).  Saving model ...
Epoch: 2 cost time: 0.9220602512359619
Epoch: 2, Steps: 8 | Train Loss: 1.813 Vali Loss: 1.568 Vali Acc: 0.666 Test Loss: 1.568 Test Acc: 0.666
Validation loss decreased (-0.228106 --> -0.665609).  Saving model ...
Epoch: 3 cost time: 0.982973575592041
Epoch: 3, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.141 Vali Acc: 0.756 Test Loss: 1.141 Test Acc: 0.756
Validation loss decreased (-0.665609 --> -0.756239).  Saving model ...
Epoch: 4 cost time: 0.9942412376403809
Epoch: 4, Steps: 8 | Train Loss: 0.994 Vali Loss: 0.770 Vali Acc: 0.834 Test Loss: 0.770 Test Acc: 0.834
Validation loss decreased (-0.756239 --> -0.834367).  Saving model ...
Epoch: 5 cost time: 1.4774317741394043
Epoch: 5, Steps: 8 | Train Loss: 0.664 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1658849716186523
Epoch: 6, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.486 Vali Acc: 0.853 Test Loss: 0.486 Test Acc: 0.853
Validation loss decreased (-0.834367 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 1.0810825824737549
Epoch: 7, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3702266216278076
Epoch: 8, Steps: 8 | Train Loss: 0.163 Vali Loss: 0.609 Vali Acc: 0.834 Test Loss: 0.609 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0802297592163086
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2351679801940918
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.792 Vali Acc: 0.844 Test Loss: 0.792 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1527283191680908
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.809 Vali Acc: 0.863 Test Loss: 0.809 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862492).  Saving model ...
Epoch: 12 cost time: 1.0190002918243408
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.858 Vali Acc: 0.841 Test Loss: 0.858 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9201278686523438
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.938 Vali Acc: 0.834 Test Loss: 0.938 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2218704223632812
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.903 Vali Acc: 0.847 Test Loss: 0.903 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9936990737915039
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.891 Vali Acc: 0.856 Test Loss: 0.891 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.08229398727417
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.048 Vali Acc: 0.853 Test Loss: 1.048 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2836592197418213
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.035 Vali Acc: 0.856 Test Loss: 1.035 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2002923488616943
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.866 Test Loss: 0.927 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865616).  Saving model ...
Epoch: 19 cost time: 0.9435853958129883
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.023 Vali Acc: 0.856 Test Loss: 1.023 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2120246887207031
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.091 Vali Acc: 0.850 Test Loss: 1.091 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9970700740814209
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.019 Vali Acc: 0.847 Test Loss: 1.019 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3195288181304932
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.866 Test Loss: 0.991 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9523012638092041
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.866 Test Loss: 0.987 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2945265769958496
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.869 Test Loss: 0.999 Test Acc: 0.869
Validation loss decreased (-0.865616 --> -0.868740).  Saving model ...
Epoch: 25 cost time: 1.139479398727417
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.869 Test Loss: 1.007 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3737068176269531
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.869 Test Loss: 1.009 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1939871311187744
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.872 Test Loss: 1.003 Test Acc: 0.872
Validation loss decreased (-0.868740 --> -0.871865).  Saving model ...
Epoch: 28 cost time: 1.0079772472381592
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.872 Test Loss: 1.000 Test Acc: 0.872
Validation loss decreased (-0.871865 --> -0.871865).  Saving model ...
Epoch: 29 cost time: 1.4827673435211182
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.869 Test Loss: 0.996 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9075510501861572
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.866 Test Loss: 0.999 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8670141696929932
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.869 Test Loss: 1.003 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8383476734161377
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.869 Test Loss: 1.007 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9054017066955566
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.869 Test Loss: 1.013 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.572251558303833
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.869 Test Loss: 1.016 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7486834526062012
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.869 Test Loss: 1.012 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7619609832763672
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.872 Test Loss: 1.013 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9457855224609375
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.869 Test Loss: 1.014 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9415531158447266
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.869 Test Loss: 1.015 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 36662024
model size : 154.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4436748027801514
Epoch: 1, Steps: 8 | Train Loss: 2.152 Vali Loss: 2.006 Vali Acc: 0.250 Test Loss: 2.006 Test Acc: 0.250
Validation loss decreased (inf --> -0.249980).  Saving model ...
Epoch: 2 cost time: 0.7326984405517578
Epoch: 2, Steps: 8 | Train Loss: 1.937 Vali Loss: 1.787 Vali Acc: 0.684 Test Loss: 1.787 Test Acc: 0.684
Validation loss decreased (-0.249980 --> -0.684357).  Saving model ...
Epoch: 3 cost time: 0.9875519275665283
Epoch: 3, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.527 Vali Acc: 0.756 Test Loss: 1.527 Test Acc: 0.756
Validation loss decreased (-0.684357 --> -0.756235).  Saving model ...
Epoch: 4 cost time: 1.0484018325805664
Epoch: 4, Steps: 8 | Train Loss: 1.427 Vali Loss: 1.210 Vali Acc: 0.800 Test Loss: 1.210 Test Acc: 0.800
Validation loss decreased (-0.756235 --> -0.799988).  Saving model ...
Epoch: 5 cost time: 0.9931216239929199
Epoch: 5, Steps: 8 | Train Loss: 1.099 Vali Loss: 0.875 Vali Acc: 0.784 Test Loss: 0.875 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9485015869140625
Epoch: 6, Steps: 8 | Train Loss: 0.712 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.799988 --> -0.821869).  Saving model ...
Epoch: 7 cost time: 0.8049793243408203
Epoch: 7, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.821869 --> -0.846870).  Saving model ...
Epoch: 8 cost time: 1.0593740940093994
Epoch: 8, Steps: 8 | Train Loss: 0.343 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9087543487548828
Epoch: 9, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.574 Vali Acc: 0.831 Test Loss: 0.574 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9517590999603271
Epoch: 10, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.653 Vali Acc: 0.831 Test Loss: 0.653 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7117421627044678
Epoch: 11, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8317000865936279
Epoch: 12, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 1.1349506378173828
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.653 Vali Acc: 0.847 Test Loss: 0.653 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.806321382522583
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.753 Vali Acc: 0.838 Test Loss: 0.753 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8142859935760498
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.797 Vali Acc: 0.838 Test Loss: 0.797 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8993721008300781
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.732 Vali Acc: 0.856 Test Loss: 0.732 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.856243).  Saving model ...
Epoch: 17 cost time: 0.7385313510894775
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.748 Vali Acc: 0.853 Test Loss: 0.748 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0197045803070068
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.776 Vali Acc: 0.850 Test Loss: 0.776 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9184958934783936
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.815 Vali Acc: 0.847 Test Loss: 0.815 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7341830730438232
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.838 Vali Acc: 0.847 Test Loss: 0.838 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7344801425933838
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.859 Test Loss: 0.842 Test Acc: 0.859
Validation loss decreased (-0.856243 --> -0.859367).  Saving model ...
Epoch: 22 cost time: 0.7625784873962402
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.837 Vali Acc: 0.863 Test Loss: 0.837 Test Acc: 0.863
Validation loss decreased (-0.859367 --> -0.862492).  Saving model ...
Epoch: 23 cost time: 0.8025059700012207
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.866 Test Loss: 0.835 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865617).  Saving model ...
Epoch: 24 cost time: 1.0047907829284668
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.863 Test Loss: 0.846 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6804213523864746
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.856 Vali Acc: 0.859 Test Loss: 0.856 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6062772274017334
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.863 Test Loss: 0.857 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7930161952972412
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.863 Test Loss: 0.859 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6466484069824219
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.866 Test Loss: 0.865 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7672779560089111
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.866 Test Loss: 0.873 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0207405090332031
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.859 Test Loss: 0.876 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8170332908630371
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.859 Test Loss: 0.876 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8391773700714111
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.882 Vali Acc: 0.859 Test Loss: 0.882 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7498266696929932
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.859 Test Loss: 0.892 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36546824
model size : 154.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6684656143188477
Epoch: 1, Steps: 8 | Train Loss: 2.305 Vali Loss: 2.011 Vali Acc: 0.263 Test Loss: 2.011 Test Acc: 0.263
Validation loss decreased (inf --> -0.262480).  Saving model ...
Epoch: 2 cost time: 1.615929126739502
Epoch: 2, Steps: 8 | Train Loss: 1.873 Vali Loss: 1.563 Vali Acc: 0.550 Test Loss: 1.563 Test Acc: 0.550
Validation loss decreased (-0.262480 --> -0.549984).  Saving model ...
Epoch: 3 cost time: 1.4823148250579834
Epoch: 3, Steps: 8 | Train Loss: 1.355 Vali Loss: 1.028 Vali Acc: 0.728 Test Loss: 1.028 Test Acc: 0.728
Validation loss decreased (-0.549984 --> -0.728115).  Saving model ...
Epoch: 4 cost time: 1.0652174949645996
Epoch: 4, Steps: 8 | Train Loss: 0.792 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.728115 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 0.9486756324768066
Epoch: 5, Steps: 8 | Train Loss: 0.506 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.5085666179656982
Epoch: 6, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3423166275024414
Epoch: 7, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.622 Vali Acc: 0.866 Test Loss: 0.622 Test Acc: 0.866
Validation loss decreased (-0.849995 --> -0.865619).  Saving model ...
Epoch: 8 cost time: 1.1513912677764893
Epoch: 8, Steps: 8 | Train Loss: 0.195 Vali Loss: 0.822 Vali Acc: 0.844 Test Loss: 0.822 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1040170192718506
Epoch: 9, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.824 Vali Acc: 0.841 Test Loss: 0.824 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0592916011810303
Epoch: 10, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.308 Vali Acc: 0.819 Test Loss: 1.308 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9662628173828125
Epoch: 11, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.053 Vali Acc: 0.847 Test Loss: 1.053 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9461252689361572
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.151 Vali Acc: 0.834 Test Loss: 1.151 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9085514545440674
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.355 Vali Acc: 0.825 Test Loss: 1.355 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8272230625152588
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.253 Vali Acc: 0.828 Test Loss: 1.253 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9979977607727051
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.498 Vali Acc: 0.816 Test Loss: 1.498 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0418658256530762
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.480 Vali Acc: 0.828 Test Loss: 1.480 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8980629444122314
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.831 Test Loss: 1.479 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36822536
model size : 155.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.431624412536621
Epoch: 1, Steps: 8 | Train Loss: 2.187 Vali Loss: 2.030 Vali Acc: 0.178 Test Loss: 2.030 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 1.194774866104126
Epoch: 2, Steps: 8 | Train Loss: 1.952 Vali Loss: 1.709 Vali Acc: 0.506 Test Loss: 1.709 Test Acc: 0.506
Validation loss decreased (-0.178105 --> -0.506233).  Saving model ...
Epoch: 3 cost time: 1.0506932735443115
Epoch: 3, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.276 Vali Acc: 0.744 Test Loss: 1.276 Test Acc: 0.744
Validation loss decreased (-0.506233 --> -0.743737).  Saving model ...
Epoch: 4 cost time: 0.7816555500030518
Epoch: 4, Steps: 8 | Train Loss: 1.089 Vali Loss: 0.880 Vali Acc: 0.781 Test Loss: 0.880 Test Acc: 0.781
Validation loss decreased (-0.743737 --> -0.781241).  Saving model ...
Epoch: 5 cost time: 1.3655743598937988
Epoch: 5, Steps: 8 | Train Loss: 0.699 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
Validation loss decreased (-0.781241 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 1.5449624061584473
Epoch: 6, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.501 Vali Acc: 0.834 Test Loss: 0.501 Test Acc: 0.834
Validation loss decreased (-0.815619 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.991591215133667
Epoch: 7, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
Validation loss decreased (-0.834370 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.9749975204467773
Epoch: 8, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4583265781402588
Epoch: 9, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.732 Vali Acc: 0.853 Test Loss: 0.732 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853118).  Saving model ...
Epoch: 10 cost time: 0.785186767578125
Epoch: 10, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.738 Vali Acc: 0.831 Test Loss: 0.738 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2694413661956787
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.739 Vali Acc: 0.859 Test Loss: 0.739 Test Acc: 0.859
Validation loss decreased (-0.853118 --> -0.859368).  Saving model ...
Epoch: 12 cost time: 0.74942946434021
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.702 Vali Acc: 0.866 Test Loss: 0.702 Test Acc: 0.866
Validation loss decreased (-0.859368 --> -0.865618).  Saving model ...
Epoch: 13 cost time: 1.1973366737365723
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.938 Vali Acc: 0.825 Test Loss: 0.938 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9845004081726074
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.755 Vali Acc: 0.859 Test Loss: 0.755 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.012688398361206
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.888 Vali Acc: 0.841 Test Loss: 0.888 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8739197254180908
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.158 Vali Acc: 0.828 Test Loss: 1.158 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0527608394622803
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.959 Vali Acc: 0.838 Test Loss: 0.959 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1070570945739746
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.898 Vali Acc: 0.850 Test Loss: 0.898 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1524088382720947
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.877 Vali Acc: 0.863 Test Loss: 0.877 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3402197360992432
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.881 Vali Acc: 0.866 Test Loss: 0.881 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0542693138122559
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.937 Vali Acc: 0.866 Test Loss: 0.937 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4654831886291504
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.853 Test Loss: 0.985 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36645896
model size : 154.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.28718638420105
Epoch: 1, Steps: 8 | Train Loss: 2.112 Vali Loss: 2.009 Vali Acc: 0.231 Test Loss: 2.009 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.9664344787597656
Epoch: 2, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.806 Vali Acc: 0.566 Test Loss: 1.806 Test Acc: 0.566
Validation loss decreased (-0.231230 --> -0.565607).  Saving model ...
Epoch: 3 cost time: 0.6881215572357178
Epoch: 3, Steps: 8 | Train Loss: 1.680 Vali Loss: 1.530 Vali Acc: 0.713 Test Loss: 1.530 Test Acc: 0.713
Validation loss decreased (-0.565607 --> -0.712485).  Saving model ...
Epoch: 4 cost time: 0.7242581844329834
Epoch: 4, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.212 Vali Acc: 0.753 Test Loss: 1.212 Test Acc: 0.753
Validation loss decreased (-0.712485 --> -0.753113).  Saving model ...
Epoch: 5 cost time: 0.8051929473876953
Epoch: 5, Steps: 8 | Train Loss: 1.083 Vali Loss: 0.884 Vali Acc: 0.791 Test Loss: 0.884 Test Acc: 0.791
Validation loss decreased (-0.753113 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 0.931779146194458
Epoch: 6, Steps: 8 | Train Loss: 0.733 Vali Loss: 0.637 Vali Acc: 0.828 Test Loss: 0.637 Test Acc: 0.828
Validation loss decreased (-0.790616 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.8726062774658203
Epoch: 7, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.8696596622467041
Epoch: 8, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8016908168792725
Epoch: 9, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.485 Vali Acc: 0.853 Test Loss: 0.485 Test Acc: 0.853
Validation loss decreased (-0.831245 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.8930995464324951
Epoch: 10, Steps: 8 | Train Loss: 0.155 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8374795913696289
Epoch: 11, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.587 Vali Acc: 0.834 Test Loss: 0.587 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0046956539154053
Epoch: 12, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.636 Vali Acc: 0.853 Test Loss: 0.636 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7015697956085205
Epoch: 13, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8128693103790283
Epoch: 14, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.685 Vali Acc: 0.834 Test Loss: 0.685 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8492255210876465
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.688 Vali Acc: 0.853 Test Loss: 0.688 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7931950092315674
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.662 Vali Acc: 0.869 Test Loss: 0.662 Test Acc: 0.869
Validation loss decreased (-0.853120 --> -0.868743).  Saving model ...
Epoch: 17 cost time: 0.6365687847137451
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.734 Vali Acc: 0.853 Test Loss: 0.734 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7467827796936035
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.781 Vali Acc: 0.847 Test Loss: 0.781 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6941072940826416
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7559826374053955
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.844 Test Loss: 0.793 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8510158061981201
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.821 Vali Acc: 0.841 Test Loss: 0.821 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8117656707763672
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.808 Vali Acc: 0.844 Test Loss: 0.808 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8542275428771973
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.844 Test Loss: 0.797 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9735286235809326
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.841 Test Loss: 0.794 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9416022300720215
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.844 Test Loss: 0.786 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8208186626434326
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.850 Test Loss: 0.794 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 36553736
model size : 154.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.004085063934326
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.909 Vali Acc: 0.344 Test Loss: 1.909 Test Acc: 0.344
Validation loss decreased (inf --> -0.343731).  Saving model ...
Epoch: 2 cost time: 0.9035894870758057
Epoch: 2, Steps: 8 | Train Loss: 1.748 Vali Loss: 1.413 Vali Acc: 0.709 Test Loss: 1.413 Test Acc: 0.709
Validation loss decreased (-0.343731 --> -0.709361).  Saving model ...
Epoch: 3 cost time: 1.12101149559021
Epoch: 3, Steps: 8 | Train Loss: 1.222 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.709361 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 1.4276137351989746
Epoch: 4, Steps: 8 | Train Loss: 0.719 Vali Loss: 0.594 Vali Acc: 0.825 Test Loss: 0.594 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 1.0694527626037598
Epoch: 5, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.2433586120605469
Epoch: 6, Steps: 8 | Train Loss: 0.356 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.983379602432251
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 0.611 Vali Acc: 0.831 Test Loss: 0.611 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1883783340454102
Epoch: 8, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846868).  Saving model ...
Epoch: 9 cost time: 1.5538921356201172
Epoch: 9, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.853 Vali Acc: 0.812 Test Loss: 0.853 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4881489276885986
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.120 Vali Acc: 0.825 Test Loss: 1.120 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6251842975616455
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.004 Vali Acc: 0.834 Test Loss: 1.004 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2115168571472168
Epoch: 12, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.960 Vali Acc: 0.847 Test Loss: 0.960 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7331752777099609
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.476 Vali Acc: 0.803 Test Loss: 1.476 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6679627895355225
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.302 Vali Acc: 0.787 Test Loss: 1.302 Test Acc: 0.787
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1081876754760742
Epoch: 15, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.443 Vali Acc: 0.838 Test Loss: 1.443 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2998735904693604
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.865 Vali Acc: 0.791 Test Loss: 1.865 Test Acc: 0.791
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7793383598327637
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.585 Vali Acc: 0.828 Test Loss: 1.585 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.714961051940918
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.366 Vali Acc: 0.859 Test Loss: 1.366 Test Acc: 0.859
Validation loss decreased (-0.846868 --> -0.859361).  Saving model ...
Epoch: 19 cost time: 1.1848723888397217
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.831 Vali Acc: 0.803 Test Loss: 1.831 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2306978702545166
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.680 Vali Acc: 0.831 Test Loss: 1.680 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9771032333374023
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.616 Vali Acc: 0.847 Test Loss: 1.616 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3637731075286865
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.586 Vali Acc: 0.847 Test Loss: 1.586 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3814873695373535
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.500 Vali Acc: 0.859 Test Loss: 1.500 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9705743789672852
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.816 Test Loss: 1.875 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.480682373046875
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.742 Vali Acc: 0.834 Test Loss: 1.742 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4184961318969727
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.775 Vali Acc: 0.831 Test Loss: 1.775 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.430760383605957
Epoch: 27, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.407 Vali Acc: 0.859 Test Loss: 1.407 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0804862976074219
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.637 Vali Acc: 0.869 Test Loss: 1.637 Test Acc: 0.869
Validation loss decreased (-0.859361 --> -0.868734).  Saving model ...
Epoch: 29 cost time: 1.0297348499298096
Epoch: 29, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.543 Vali Acc: 0.847 Test Loss: 1.543 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1144936084747314
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.971 Vali Acc: 0.797 Test Loss: 1.971 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9581496715545654
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.972 Vali Acc: 0.819 Test Loss: 1.972 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1536688804626465
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.050 Vali Acc: 0.828 Test Loss: 2.050 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9574069976806641
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.959 Vali Acc: 0.844 Test Loss: 1.959 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2506604194641113
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.885 Vali Acc: 0.850 Test Loss: 1.885 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.758185625076294
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.853 Test Loss: 1.875 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9171092510223389
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.853 Test Loss: 1.858 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4972364902496338
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.850 Test Loss: 1.847 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1691646575927734
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.847 Test Loss: 1.840 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 36828680
model size : 155.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4775571823120117
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 1.989 Vali Acc: 0.219 Test Loss: 1.989 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.824209451675415
Epoch: 2, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.677 Vali Acc: 0.575 Test Loss: 1.677 Test Acc: 0.575
Validation loss decreased (-0.218730 --> -0.574983).  Saving model ...
Epoch: 3 cost time: 0.8661625385284424
Epoch: 3, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.258 Vali Acc: 0.744 Test Loss: 1.258 Test Acc: 0.744
Validation loss decreased (-0.574983 --> -0.743737).  Saving model ...
Epoch: 4 cost time: 0.9825253486633301
Epoch: 4, Steps: 8 | Train Loss: 1.092 Vali Loss: 0.867 Vali Acc: 0.806 Test Loss: 0.867 Test Acc: 0.806
Validation loss decreased (-0.743737 --> -0.806241).  Saving model ...
Epoch: 5 cost time: 0.7709777355194092
Epoch: 5, Steps: 8 | Train Loss: 0.703 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
Validation loss decreased (-0.806241 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 0.7434451580047607
Epoch: 6, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.775808572769165
Epoch: 7, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.479 Vali Acc: 0.844 Test Loss: 0.479 Test Acc: 0.844
Validation loss decreased (-0.821869 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.6054725646972656
Epoch: 8, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.627 Vali Acc: 0.816 Test Loss: 0.627 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.736236572265625
Epoch: 9, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.666 Vali Acc: 0.838 Test Loss: 0.666 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.931114912033081
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.707 Vali Acc: 0.834 Test Loss: 0.707 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6765515804290771
Epoch: 11, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.9126942157745361
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.713 Vali Acc: 0.853 Test Loss: 0.713 Test Acc: 0.853
Validation loss decreased (-0.849992 --> -0.853118).  Saving model ...
Epoch: 13 cost time: 0.8861184120178223
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.853 Vali Acc: 0.853 Test Loss: 0.853 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6791093349456787
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.801 Vali Acc: 0.853 Test Loss: 0.801 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.462874174118042
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856242).  Saving model ...
Epoch: 16 cost time: 0.7769379615783691
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.861 Vali Acc: 0.856 Test Loss: 0.861 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7786717414855957
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.972 Vali Acc: 0.844 Test Loss: 0.972 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4124267101287842
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.001 Vali Acc: 0.850 Test Loss: 1.001 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8551418781280518
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.925 Vali Acc: 0.841 Test Loss: 0.925 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9791300296783447
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.879 Vali Acc: 0.853 Test Loss: 0.879 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4027934074401855
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.847 Test Loss: 0.936 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7686097621917725
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.977 Vali Acc: 0.853 Test Loss: 0.977 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.419105052947998
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.917 Vali Acc: 0.853 Test Loss: 0.917 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0335566997528076
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.847 Test Loss: 0.940 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3057215213775635
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.847 Test Loss: 1.003 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 36644360
model size : 154.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.534470558166504
Epoch: 1, Steps: 8 | Train Loss: 2.162 Vali Loss: 2.072 Vali Acc: 0.141 Test Loss: 2.072 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 0.7279365062713623
Epoch: 2, Steps: 8 | Train Loss: 2.032 Vali Loss: 1.844 Vali Acc: 0.547 Test Loss: 1.844 Test Acc: 0.547
Validation loss decreased (-0.140604 --> -0.546857).  Saving model ...
Epoch: 3 cost time: 0.8495471477508545
Epoch: 3, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.568 Vali Acc: 0.747 Test Loss: 1.568 Test Acc: 0.747
Validation loss decreased (-0.546857 --> -0.746859).  Saving model ...
Epoch: 4 cost time: 0.8949398994445801
Epoch: 4, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.228 Vali Acc: 0.791 Test Loss: 1.228 Test Acc: 0.791
Validation loss decreased (-0.746859 --> -0.790613).  Saving model ...
Epoch: 5 cost time: 0.7321429252624512
Epoch: 5, Steps: 8 | Train Loss: 1.083 Vali Loss: 0.878 Vali Acc: 0.819 Test Loss: 0.878 Test Acc: 0.819
Validation loss decreased (-0.790613 --> -0.818741).  Saving model ...
Epoch: 6 cost time: 0.8072636127471924
Epoch: 6, Steps: 8 | Train Loss: 0.755 Vali Loss: 0.623 Vali Acc: 0.825 Test Loss: 0.623 Test Acc: 0.825
Validation loss decreased (-0.818741 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.7585768699645996
Epoch: 7, Steps: 8 | Train Loss: 0.546 Vali Loss: 0.502 Vali Acc: 0.828 Test Loss: 0.502 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.7196195125579834
Epoch: 8, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.522 Vali Acc: 0.831 Test Loss: 0.522 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 1.0315577983856201
Epoch: 9, Steps: 8 | Train Loss: 0.244 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.7627444267272949
Epoch: 10, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9086344242095947
Epoch: 11, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 0.7473917007446289
Epoch: 12, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.633 Vali Acc: 0.856 Test Loss: 0.633 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.856244).  Saving model ...
Epoch: 13 cost time: 0.7014832496643066
Epoch: 13, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.833306074142456
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.614 Vali Acc: 0.859 Test Loss: 0.614 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 15 cost time: 0.7305350303649902
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6646928787231445
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
Validation loss decreased (-0.859369 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.7562284469604492
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.881 Test Loss: 0.624 Test Acc: 0.881
Validation loss decreased (-0.874994 --> -0.881244).  Saving model ...
Epoch: 18 cost time: 0.7438254356384277
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7389452457427979
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.736 Vali Acc: 0.859 Test Loss: 0.736 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7793686389923096
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.743 Vali Acc: 0.878 Test Loss: 0.743 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7536582946777344
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.720 Vali Acc: 0.878 Test Loss: 0.720 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7291905879974365
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.887 Test Loss: 0.672 Test Acc: 0.887
Validation loss decreased (-0.881244 --> -0.887493).  Saving model ...
Epoch: 23 cost time: 0.7719929218292236
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.702 Vali Acc: 0.872 Test Loss: 0.702 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6449184417724609
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7112796306610107
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8849306106567383
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.847 Test Loss: 0.815 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7834722995758057
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.856 Test Loss: 0.786 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.877119779586792
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.863 Test Loss: 0.768 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7281839847564697
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.856 Test Loss: 0.766 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6829137802124023
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.859 Test Loss: 0.789 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6429004669189453
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.856 Test Loss: 0.824 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.720062255859375
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.859 Test Loss: 0.842 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8875
model parameter : 36552200
model size : 154.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.800055742263794
Epoch: 1, Steps: 8 | Train Loss: 2.170 Vali Loss: 1.983 Vali Acc: 0.197 Test Loss: 1.983 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 1.4174973964691162
Epoch: 2, Steps: 8 | Train Loss: 1.826 Vali Loss: 1.510 Vali Acc: 0.716 Test Loss: 1.510 Test Acc: 0.716
Validation loss decreased (-0.196855 --> -0.715610).  Saving model ...
Epoch: 3 cost time: 1.0194242000579834
Epoch: 3, Steps: 8 | Train Loss: 1.314 Vali Loss: 1.019 Vali Acc: 0.791 Test Loss: 1.019 Test Acc: 0.791
Validation loss decreased (-0.715610 --> -0.790615).  Saving model ...
Epoch: 4 cost time: 0.9308788776397705
Epoch: 4, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.672 Vali Acc: 0.806 Test Loss: 0.672 Test Acc: 0.806
Validation loss decreased (-0.790615 --> -0.806243).  Saving model ...
Epoch: 5 cost time: 0.9129197597503662
Epoch: 5, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
Validation loss decreased (-0.806243 --> -0.846870).  Saving model ...
Epoch: 6 cost time: 1.1916868686676025
Epoch: 6, Steps: 8 | Train Loss: 0.328 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8950603008270264
Epoch: 7, Steps: 8 | Train Loss: 0.221 Vali Loss: 0.739 Vali Acc: 0.816 Test Loss: 0.739 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9118280410766602
Epoch: 8, Steps: 8 | Train Loss: 0.158 Vali Loss: 0.817 Vali Acc: 0.819 Test Loss: 0.817 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2851088047027588
Epoch: 9, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.958 Vali Acc: 0.831 Test Loss: 0.958 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8331246376037598
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.929 Vali Acc: 0.856 Test Loss: 0.929 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856241).  Saving model ...
Epoch: 11 cost time: 1.0658304691314697
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.988 Vali Acc: 0.850 Test Loss: 0.988 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1260581016540527
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.232 Vali Acc: 0.838 Test Loss: 1.232 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.147188425064087
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.089 Vali Acc: 0.856 Test Loss: 1.089 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1663320064544678
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.859 Test Loss: 0.985 Test Acc: 0.859
Validation loss decreased (-0.856241 --> -0.859365).  Saving model ...
Epoch: 15 cost time: 1.4871199131011963
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.152 Vali Acc: 0.847 Test Loss: 1.152 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2549211978912354
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.044 Vali Acc: 0.850 Test Loss: 1.044 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1895136833190918
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.056 Vali Acc: 0.847 Test Loss: 1.056 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.581533432006836
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.166 Vali Acc: 0.853 Test Loss: 1.166 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1130337715148926
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.151 Vali Acc: 0.863 Test Loss: 1.151 Test Acc: 0.863
Validation loss decreased (-0.859365 --> -0.862488).  Saving model ...
Epoch: 20 cost time: 1.3669161796569824
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.107 Vali Acc: 0.856 Test Loss: 1.107 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.528979778289795
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.232 Vali Acc: 0.847 Test Loss: 1.232 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.051565408706665
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.311 Vali Acc: 0.847 Test Loss: 1.311 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3714189529418945
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.844 Test Loss: 1.350 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9902372360229492
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.844 Test Loss: 1.352 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8235857486724854
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.339 Vali Acc: 0.850 Test Loss: 1.339 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3465068340301514
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.850 Test Loss: 1.299 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1675889492034912
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.856 Test Loss: 1.277 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0655274391174316
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.856 Test Loss: 1.270 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4204864501953125
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.856 Test Loss: 1.262 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 36788744
model size : 155.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.560730457305908
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.054 Vali Acc: 0.188 Test Loss: 2.054 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 1.2906765937805176
Epoch: 2, Steps: 8 | Train Loss: 1.922 Vali Loss: 1.736 Vali Acc: 0.594 Test Loss: 1.736 Test Acc: 0.594
Validation loss decreased (-0.187479 --> -0.593733).  Saving model ...
Epoch: 3 cost time: 0.7276401519775391
Epoch: 3, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.310 Vali Acc: 0.744 Test Loss: 1.310 Test Acc: 0.744
Validation loss decreased (-0.593733 --> -0.743737).  Saving model ...
Epoch: 4 cost time: 0.8118770122528076
Epoch: 4, Steps: 8 | Train Loss: 1.098 Vali Loss: 0.867 Vali Acc: 0.797 Test Loss: 0.867 Test Acc: 0.797
Validation loss decreased (-0.743737 --> -0.796866).  Saving model ...
Epoch: 5 cost time: 0.6883604526519775
Epoch: 5, Steps: 8 | Train Loss: 0.711 Vali Loss: 0.570 Vali Acc: 0.819 Test Loss: 0.570 Test Acc: 0.819
Validation loss decreased (-0.796866 --> -0.818744).  Saving model ...
Epoch: 6 cost time: 0.7247786521911621
Epoch: 6, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
Validation loss decreased (-0.818744 --> -0.821870).  Saving model ...
Epoch: 7 cost time: 1.1146197319030762
Epoch: 7, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.663 Vali Acc: 0.787 Test Loss: 0.663 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7633469104766846
Epoch: 8, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.268829345703125
Epoch: 9, Steps: 8 | Train Loss: 0.152 Vali Loss: 0.761 Vali Acc: 0.819 Test Loss: 0.761 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7300231456756592
Epoch: 10, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.770 Vali Acc: 0.822 Test Loss: 0.770 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0830163955688477
Epoch: 11, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.856 Vali Acc: 0.828 Test Loss: 0.856 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828116).  Saving model ...
Epoch: 12 cost time: 0.9550836086273193
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.764 Vali Acc: 0.856 Test Loss: 0.764 Test Acc: 0.856
Validation loss decreased (-0.828116 --> -0.856242).  Saving model ...
Epoch: 13 cost time: 0.934640645980835
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.850 Vali Acc: 0.856 Test Loss: 0.850 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2504875659942627
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.849 Vali Acc: 0.863 Test Loss: 0.849 Test Acc: 0.863
Validation loss decreased (-0.856242 --> -0.862492).  Saving model ...
Epoch: 15 cost time: 0.8978664875030518
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.909 Vali Acc: 0.850 Test Loss: 0.909 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2252850532531738
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.928 Vali Acc: 0.844 Test Loss: 0.928 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0145604610443115
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.838 Vali Acc: 0.850 Test Loss: 0.838 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1895487308502197
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.908 Vali Acc: 0.847 Test Loss: 0.908 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8683815002441406
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.986 Vali Acc: 0.838 Test Loss: 0.986 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9453508853912354
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.975 Vali Acc: 0.841 Test Loss: 0.975 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0894129276275635
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.853 Test Loss: 0.938 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6449661254882812
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.853 Test Loss: 0.929 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8112261295318604
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.853 Test Loss: 0.933 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8113396167755127
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.853 Test Loss: 0.947 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 36642824
model size : 154.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5087709426879883
Epoch: 1, Steps: 8 | Train Loss: 2.207 Vali Loss: 2.070 Vali Acc: 0.178 Test Loss: 2.070 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 0.8143129348754883
Epoch: 2, Steps: 8 | Train Loss: 2.027 Vali Loss: 1.880 Vali Acc: 0.434 Test Loss: 1.880 Test Acc: 0.434
Validation loss decreased (-0.178104 --> -0.434356).  Saving model ...
Epoch: 3 cost time: 0.9379322528839111
Epoch: 3, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.659 Vali Acc: 0.578 Test Loss: 1.659 Test Acc: 0.578
Validation loss decreased (-0.434356 --> -0.578108).  Saving model ...
Epoch: 4 cost time: 0.8630385398864746
Epoch: 4, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.363 Vali Acc: 0.744 Test Loss: 1.363 Test Acc: 0.744
Validation loss decreased (-0.578108 --> -0.743736).  Saving model ...
Epoch: 5 cost time: 0.7521114349365234
Epoch: 5, Steps: 8 | Train Loss: 1.234 Vali Loss: 1.014 Vali Acc: 0.772 Test Loss: 1.014 Test Acc: 0.772
Validation loss decreased (-0.743736 --> -0.771865).  Saving model ...
Epoch: 6 cost time: 0.6398203372955322
Epoch: 6, Steps: 8 | Train Loss: 0.849 Vali Loss: 0.666 Vali Acc: 0.816 Test Loss: 0.666 Test Acc: 0.816
Validation loss decreased (-0.771865 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 0.7746255397796631
Epoch: 7, Steps: 8 | Train Loss: 0.566 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7315220832824707
Epoch: 8, Steps: 8 | Train Loss: 0.406 Vali Loss: 0.531 Vali Acc: 0.806 Test Loss: 0.531 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8190293312072754
Epoch: 9, Steps: 8 | Train Loss: 0.296 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
Validation loss decreased (-0.815618 --> -0.818744).  Saving model ...
Epoch: 10 cost time: 0.7728927135467529
Epoch: 10, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 0.6457638740539551
Epoch: 11, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9705157279968262
Epoch: 12, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.716 Vali Acc: 0.834 Test Loss: 0.716 Test Acc: 0.834
Validation loss decreased (-0.824994 --> -0.834368).  Saving model ...
Epoch: 13 cost time: 0.8572416305541992
Epoch: 13, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.834368 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 0.6975548267364502
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.732 Vali Acc: 0.850 Test Loss: 0.732 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8507964611053467
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.791 Vali Acc: 0.847 Test Loss: 0.791 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7245821952819824
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.767 Vali Acc: 0.844 Test Loss: 0.767 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7318694591522217
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.760 Vali Acc: 0.847 Test Loss: 0.760 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6700606346130371
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.804 Vali Acc: 0.869 Test Loss: 0.804 Test Acc: 0.869
Validation loss decreased (-0.849993 --> -0.868742).  Saving model ...
Epoch: 19 cost time: 0.707880973815918
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.834 Vali Acc: 0.869 Test Loss: 0.834 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6676173210144043
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.840 Vali Acc: 0.869 Test Loss: 0.840 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6102468967437744
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.869 Test Loss: 0.830 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6738393306732178
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.869 Test Loss: 0.846 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6608700752258301
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.864 Vali Acc: 0.866 Test Loss: 0.864 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.896141529083252
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.893 Vali Acc: 0.866 Test Loss: 0.893 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8228442668914795
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.903 Vali Acc: 0.866 Test Loss: 0.903 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9856748580932617
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.900 Vali Acc: 0.863 Test Loss: 0.900 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9326188564300537
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.903 Vali Acc: 0.866 Test Loss: 0.903 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.791954517364502
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.918 Vali Acc: 0.863 Test Loss: 0.918 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 36558344
model size : 154.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6048309803009033
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 2.003 Vali Acc: 0.269 Test Loss: 2.003 Test Acc: 0.269
Validation loss decreased (inf --> -0.268730).  Saving model ...
Epoch: 2 cost time: 0.7574317455291748
Epoch: 2, Steps: 8 | Train Loss: 1.824 Vali Loss: 1.534 Vali Acc: 0.544 Test Loss: 1.534 Test Acc: 0.544
Validation loss decreased (-0.268730 --> -0.543735).  Saving model ...
Epoch: 3 cost time: 0.9693193435668945
Epoch: 3, Steps: 8 | Train Loss: 1.324 Vali Loss: 1.029 Vali Acc: 0.766 Test Loss: 1.029 Test Acc: 0.766
Validation loss decreased (-0.543735 --> -0.765615).  Saving model ...
Epoch: 4 cost time: 0.7562224864959717
Epoch: 4, Steps: 8 | Train Loss: 0.781 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.765615 --> -0.799994).  Saving model ...
Epoch: 5 cost time: 1.2139956951141357
Epoch: 5, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.535 Vali Acc: 0.828 Test Loss: 0.535 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.828120).  Saving model ...
Epoch: 6 cost time: 0.7480719089508057
Epoch: 6, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.516 Vali Acc: 0.853 Test Loss: 0.516 Test Acc: 0.853
Validation loss decreased (-0.828120 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 1.273162841796875
Epoch: 7, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.729 Vali Acc: 0.831 Test Loss: 0.729 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2721672058105469
Epoch: 8, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.744 Vali Acc: 0.841 Test Loss: 0.744 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3716180324554443
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.827 Vali Acc: 0.850 Test Loss: 0.827 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8114829063415527
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.015 Vali Acc: 0.816 Test Loss: 1.015 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7715561389923096
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.937 Vali Acc: 0.844 Test Loss: 0.937 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2338531017303467
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.064 Vali Acc: 0.834 Test Loss: 1.064 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1848742961883545
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.287 Vali Acc: 0.825 Test Loss: 1.287 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2400565147399902
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.043 Vali Acc: 0.856 Test Loss: 1.043 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856240).  Saving model ...
Epoch: 15 cost time: 1.6103930473327637
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.304 Vali Acc: 0.838 Test Loss: 1.304 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9272019863128662
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.393 Vali Acc: 0.853 Test Loss: 1.393 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3255460262298584
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.310 Vali Acc: 0.859 Test Loss: 1.310 Test Acc: 0.859
Validation loss decreased (-0.856240 --> -0.859362).  Saving model ...
Epoch: 18 cost time: 0.9197392463684082
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.280 Vali Acc: 0.844 Test Loss: 1.280 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2972846031188965
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.234 Vali Acc: 0.850 Test Loss: 1.234 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5178537368774414
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.866 Test Loss: 1.213 Test Acc: 0.866
Validation loss decreased (-0.859362 --> -0.865613).  Saving model ...
Epoch: 21 cost time: 1.2546195983886719
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.866 Test Loss: 1.204 Test Acc: 0.866
Validation loss decreased (-0.865613 --> -0.865613).  Saving model ...
Epoch: 22 cost time: 1.5975666046142578
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.869 Test Loss: 1.198 Test Acc: 0.869
Validation loss decreased (-0.865613 --> -0.868738).  Saving model ...
Epoch: 23 cost time: 1.2985455989837646
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.869 Test Loss: 1.175 Test Acc: 0.869
Validation loss decreased (-0.868738 --> -0.868738).  Saving model ...
Epoch: 24 cost time: 1.10127592086792
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.157 Vali Acc: 0.869 Test Loss: 1.157 Test Acc: 0.869
Validation loss decreased (-0.868738 --> -0.868738).  Saving model ...
Epoch: 25 cost time: 1.1656644344329834
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.863 Test Loss: 1.198 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3512804508209229
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.859 Test Loss: 1.216 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1129498481750488
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.859 Test Loss: 1.222 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8253321647644043
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.863 Test Loss: 1.225 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8143332004547119
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.863 Test Loss: 1.222 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8426110744476318
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.863 Test Loss: 1.218 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8718364238739014
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.859 Test Loss: 1.212 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9965386390686035
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.859 Test Loss: 1.208 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7505500316619873
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.856 Test Loss: 1.217 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.988433837890625
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.863 Test Loss: 1.219 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 36802568
model size : 155.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.946897268295288
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 2.010 Vali Acc: 0.225 Test Loss: 2.010 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 0.7489163875579834
Epoch: 2, Steps: 8 | Train Loss: 1.897 Vali Loss: 1.719 Vali Acc: 0.569 Test Loss: 1.719 Test Acc: 0.569
Validation loss decreased (-0.224980 --> -0.568733).  Saving model ...
Epoch: 3 cost time: 0.7096490859985352
Epoch: 3, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.367 Vali Acc: 0.606 Test Loss: 1.367 Test Acc: 0.606
Validation loss decreased (-0.568733 --> -0.606236).  Saving model ...
Epoch: 4 cost time: 1.1338279247283936
Epoch: 4, Steps: 8 | Train Loss: 1.221 Vali Loss: 0.949 Vali Acc: 0.794 Test Loss: 0.949 Test Acc: 0.794
Validation loss decreased (-0.606236 --> -0.793741).  Saving model ...
Epoch: 5 cost time: 0.6971836090087891
Epoch: 5, Steps: 8 | Train Loss: 0.817 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.793741 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 0.9939117431640625
Epoch: 6, Steps: 8 | Train Loss: 0.518 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824995).  Saving model ...
Epoch: 7 cost time: 0.6665198802947998
Epoch: 7, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0360677242279053
Epoch: 8, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
Validation loss decreased (-0.824995 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 1.146397590637207
Epoch: 9, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.653 Vali Acc: 0.838 Test Loss: 0.653 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7219698429107666
Epoch: 10, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.680 Vali Acc: 0.838 Test Loss: 0.680 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7305991649627686
Epoch: 11, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.642 Vali Acc: 0.847 Test Loss: 0.642 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846869).  Saving model ...
Epoch: 12 cost time: 0.9287395477294922
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.740 Vali Acc: 0.853 Test Loss: 0.740 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853118).  Saving model ...
Epoch: 13 cost time: 0.6914098262786865
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.707 Vali Acc: 0.847 Test Loss: 0.707 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7351865768432617
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.820 Vali Acc: 0.866 Test Loss: 0.820 Test Acc: 0.866
Validation loss decreased (-0.853118 --> -0.865617).  Saving model ...
Epoch: 15 cost time: 0.784726619720459
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.858 Vali Acc: 0.866 Test Loss: 0.858 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7087624073028564
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.773 Vali Acc: 0.856 Test Loss: 0.773 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7445948123931885
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.799 Vali Acc: 0.863 Test Loss: 0.799 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1510233879089355
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.897 Vali Acc: 0.863 Test Loss: 0.897 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8416297435760498
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.881 Test Loss: 0.794 Test Acc: 0.881
Validation loss decreased (-0.865617 --> -0.881242).  Saving model ...
Epoch: 20 cost time: 0.7121086120605469
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.878 Test Loss: 0.796 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1135880947113037
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.856 Vali Acc: 0.872 Test Loss: 0.856 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7777495384216309
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.872 Test Loss: 0.912 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1836144924163818
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.866 Test Loss: 0.970 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8188745975494385
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.859 Test Loss: 0.987 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.128314733505249
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.869 Test Loss: 0.981 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0366039276123047
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.866 Test Loss: 0.962 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3793437480926514
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.859 Test Loss: 0.917 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7808487415313721
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.859 Test Loss: 0.896 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7440268993377686
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.863 Test Loss: 0.898 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 36641288
model size : 154.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2694101333618164
Epoch: 1, Steps: 8 | Train Loss: 2.206 Vali Loss: 2.115 Vali Acc: 0.138 Test Loss: 2.115 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.9987785816192627
Epoch: 2, Steps: 8 | Train Loss: 2.036 Vali Loss: 1.909 Vali Acc: 0.384 Test Loss: 1.909 Test Acc: 0.384
Validation loss decreased (-0.137479 --> -0.384356).  Saving model ...
Epoch: 3 cost time: 0.7625899314880371
Epoch: 3, Steps: 8 | Train Loss: 1.837 Vali Loss: 1.678 Vali Acc: 0.594 Test Loss: 1.678 Test Acc: 0.594
Validation loss decreased (-0.384356 --> -0.593733).  Saving model ...
Epoch: 4 cost time: 0.7111129760742188
Epoch: 4, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.396 Vali Acc: 0.728 Test Loss: 1.396 Test Acc: 0.728
Validation loss decreased (-0.593733 --> -0.728111).  Saving model ...
Epoch: 5 cost time: 0.7404482364654541
Epoch: 5, Steps: 8 | Train Loss: 1.251 Vali Loss: 1.079 Vali Acc: 0.759 Test Loss: 1.079 Test Acc: 0.759
Validation loss decreased (-0.728111 --> -0.759364).  Saving model ...
Epoch: 6 cost time: 0.7875616550445557
Epoch: 6, Steps: 8 | Train Loss: 0.918 Vali Loss: 0.732 Vali Acc: 0.809 Test Loss: 0.732 Test Acc: 0.809
Validation loss decreased (-0.759364 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 0.6599807739257812
Epoch: 7, Steps: 8 | Train Loss: 0.670 Vali Loss: 0.558 Vali Acc: 0.794 Test Loss: 0.558 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6756381988525391
Epoch: 8, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.809368 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 1.0018911361694336
Epoch: 9, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.696819543838501
Epoch: 10, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.6711273193359375
Epoch: 11, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9871904850006104
Epoch: 12, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.539 Vali Acc: 0.853 Test Loss: 0.539 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 13 cost time: 0.68990159034729
Epoch: 13, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.563 Vali Acc: 0.859 Test Loss: 0.563 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859369).  Saving model ...
Epoch: 14 cost time: 0.8945479393005371
Epoch: 14, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7693994045257568
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.635 Vali Acc: 0.856 Test Loss: 0.635 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9525482654571533
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
Validation loss decreased (-0.859369 --> -0.871869).  Saving model ...
Epoch: 17 cost time: 0.9627487659454346
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7803757190704346
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.859 Test Loss: 0.696 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7032680511474609
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.663 Vali Acc: 0.869 Test Loss: 0.663 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8276231288909912
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.670 Vali Acc: 0.869 Test Loss: 0.670 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7465894222259521
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.709 Vali Acc: 0.859 Test Loss: 0.709 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5441544055938721
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.692 Vali Acc: 0.869 Test Loss: 0.692 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7711269855499268
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.872 Test Loss: 0.715 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8362345695495605
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.736 Vali Acc: 0.863 Test Loss: 0.736 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7995867729187012
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.745 Vali Acc: 0.863 Test Loss: 0.745 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8636229038238525
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.866 Test Loss: 0.743 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 36564488
model size : 154.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.500870943069458
Epoch: 1, Steps: 8 | Train Loss: 2.224 Vali Loss: 2.009 Vali Acc: 0.225 Test Loss: 2.009 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 1.3865196704864502
Epoch: 2, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.570 Vali Acc: 0.606 Test Loss: 1.570 Test Acc: 0.606
Validation loss decreased (-0.224980 --> -0.606234).  Saving model ...
Epoch: 3 cost time: 1.007138729095459
Epoch: 3, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.045 Vali Acc: 0.803 Test Loss: 1.045 Test Acc: 0.803
Validation loss decreased (-0.606234 --> -0.803115).  Saving model ...
Epoch: 4 cost time: 0.9545402526855469
Epoch: 4, Steps: 8 | Train Loss: 0.862 Vali Loss: 0.677 Vali Acc: 0.784 Test Loss: 0.677 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0193960666656494
Epoch: 5, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
Validation loss decreased (-0.803115 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 0.8178155422210693
Epoch: 6, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.571 Vali Acc: 0.797 Test Loss: 0.571 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2788968086242676
Epoch: 7, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.725 Vali Acc: 0.834 Test Loss: 0.725 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834368).  Saving model ...
Epoch: 8 cost time: 1.122497320175171
Epoch: 8, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7725825309753418
Epoch: 9, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.761 Vali Acc: 0.850 Test Loss: 0.761 Test Acc: 0.850
Validation loss decreased (-0.834368 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 1.1927344799041748
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.924 Vali Acc: 0.825 Test Loss: 0.924 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8147222995758057
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.911 Vali Acc: 0.853 Test Loss: 0.911 Test Acc: 0.853
Validation loss decreased (-0.849992 --> -0.853116).  Saving model ...
Epoch: 12 cost time: 0.8856198787689209
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.029 Vali Acc: 0.838 Test Loss: 1.029 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1280205249786377
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.999 Vali Acc: 0.853 Test Loss: 0.999 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9653663635253906
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.078 Vali Acc: 0.866 Test Loss: 1.078 Test Acc: 0.866
Validation loss decreased (-0.853116 --> -0.865614).  Saving model ...
Epoch: 15 cost time: 0.7364678382873535
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.064 Vali Acc: 0.856 Test Loss: 1.064 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7507448196411133
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.059 Vali Acc: 0.853 Test Loss: 1.059 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9420268535614014
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.186 Vali Acc: 0.841 Test Loss: 1.186 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7513599395751953
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.094 Vali Acc: 0.841 Test Loss: 1.094 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6324210166931152
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.120 Vali Acc: 0.838 Test Loss: 1.120 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7280001640319824
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.206 Vali Acc: 0.847 Test Loss: 1.206 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7583425045013428
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.232 Vali Acc: 0.844 Test Loss: 1.232 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7965116500854492
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.224 Vali Acc: 0.844 Test Loss: 1.224 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6477274894714355
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.192 Vali Acc: 0.847 Test Loss: 1.192 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7755856513977051
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.853 Test Loss: 1.173 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36770312
model size : 154.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.3918395042419434
Epoch: 1, Steps: 8 | Train Loss: 2.110 Vali Loss: 1.982 Vali Acc: 0.184 Test Loss: 1.982 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 0.8513081073760986
Epoch: 2, Steps: 8 | Train Loss: 1.864 Vali Loss: 1.662 Vali Acc: 0.641 Test Loss: 1.662 Test Acc: 0.641
Validation loss decreased (-0.184355 --> -0.640608).  Saving model ...
Epoch: 3 cost time: 0.9454054832458496
Epoch: 3, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.282 Vali Acc: 0.728 Test Loss: 1.282 Test Acc: 0.728
Validation loss decreased (-0.640608 --> -0.728112).  Saving model ...
Epoch: 4 cost time: 1.40181565284729
Epoch: 4, Steps: 8 | Train Loss: 1.122 Vali Loss: 0.872 Vali Acc: 0.791 Test Loss: 0.872 Test Acc: 0.791
Validation loss decreased (-0.728112 --> -0.790616).  Saving model ...
Epoch: 5 cost time: 0.8156726360321045
Epoch: 5, Steps: 8 | Train Loss: 0.694 Vali Loss: 0.604 Vali Acc: 0.784 Test Loss: 0.604 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8465900421142578
Epoch: 6, Steps: 8 | Train Loss: 0.477 Vali Loss: 0.537 Vali Acc: 0.831 Test Loss: 0.537 Test Acc: 0.831
Validation loss decreased (-0.790616 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 1.285917043685913
Epoch: 7, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.584 Vali Acc: 0.831 Test Loss: 0.584 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0470259189605713
Epoch: 8, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.640 Vali Acc: 0.847 Test Loss: 0.640 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 1.2354626655578613
Epoch: 9, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.630 Vali Acc: 0.853 Test Loss: 0.630 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853119).  Saving model ...
Epoch: 10 cost time: 0.7286741733551025
Epoch: 10, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.623 Vali Acc: 0.869 Test Loss: 0.623 Test Acc: 0.869
Validation loss decreased (-0.853119 --> -0.868744).  Saving model ...
Epoch: 11 cost time: 0.7007057666778564
Epoch: 11, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.731 Vali Acc: 0.859 Test Loss: 0.731 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3129076957702637
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.686 Vali Acc: 0.863 Test Loss: 0.686 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.840339183807373
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.743 Vali Acc: 0.853 Test Loss: 0.743 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4297749996185303
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.750 Vali Acc: 0.863 Test Loss: 0.750 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0864465236663818
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.784 Vali Acc: 0.875 Test Loss: 0.784 Test Acc: 0.875
Validation loss decreased (-0.868744 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 1.3811211585998535
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.789 Vali Acc: 0.878 Test Loss: 0.789 Test Acc: 0.878
Validation loss decreased (-0.874992 --> -0.878117).  Saving model ...
Epoch: 17 cost time: 0.9435358047485352
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.878 Test Loss: 0.789 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3509876728057861
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.881 Test Loss: 0.794 Test Acc: 0.881
Validation loss decreased (-0.878117 --> -0.881242).  Saving model ...
Epoch: 19 cost time: 1.0527279376983643
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.891 Test Loss: 0.806 Test Acc: 0.891
Validation loss decreased (-0.881242 --> -0.890617).  Saving model ...
Epoch: 20 cost time: 0.8816897869110107
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.887 Test Loss: 0.827 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.417968511581421
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.813 Vali Acc: 0.887 Test Loss: 0.813 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7756929397583008
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.803 Vali Acc: 0.881 Test Loss: 0.803 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1986284255981445
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.887 Test Loss: 0.835 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8152296543121338
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.891 Test Loss: 0.879 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8652584552764893
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.869 Vali Acc: 0.878 Test Loss: 0.869 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9260210990905762
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.878 Test Loss: 0.862 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9914186000823975
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.869 Test Loss: 0.884 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2255291938781738
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.872 Test Loss: 0.902 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.95074462890625
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.869 Test Loss: 0.888 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.890625
model parameter : 36647432
model size : 154.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3443431854248047
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 2.058 Vali Acc: 0.200 Test Loss: 2.058 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 0.9482748508453369
Epoch: 2, Steps: 8 | Train Loss: 1.982 Vali Loss: 1.864 Vali Acc: 0.453 Test Loss: 1.864 Test Acc: 0.453
Validation loss decreased (-0.199979 --> -0.453106).  Saving model ...
Epoch: 3 cost time: 0.5476796627044678
Epoch: 3, Steps: 8 | Train Loss: 1.789 Vali Loss: 1.609 Vali Acc: 0.656 Test Loss: 1.609 Test Acc: 0.656
Validation loss decreased (-0.453106 --> -0.656234).  Saving model ...
Epoch: 4 cost time: 0.6995112895965576
Epoch: 4, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.296 Vali Acc: 0.787 Test Loss: 1.296 Test Acc: 0.787
Validation loss decreased (-0.656234 --> -0.787487).  Saving model ...
Epoch: 5 cost time: 0.610306978225708
Epoch: 5, Steps: 8 | Train Loss: 1.169 Vali Loss: 0.951 Vali Acc: 0.812 Test Loss: 0.951 Test Acc: 0.812
Validation loss decreased (-0.787487 --> -0.812490).  Saving model ...
Epoch: 6 cost time: 0.6886563301086426
Epoch: 6, Steps: 8 | Train Loss: 0.796 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.812490 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.6362645626068115
Epoch: 7, Steps: 8 | Train Loss: 0.548 Vali Loss: 0.514 Vali Acc: 0.819 Test Loss: 0.514 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 8 cost time: 0.7502892017364502
Epoch: 8, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.818745 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 1.083566427230835
Epoch: 9, Steps: 8 | Train Loss: 0.273 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8016293048858643
Epoch: 10, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9775974750518799
Epoch: 11, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 12 cost time: 0.8629155158996582
Epoch: 12, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.577 Vali Acc: 0.853 Test Loss: 0.577 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 13 cost time: 0.6768488883972168
Epoch: 13, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.604 Vali Acc: 0.838 Test Loss: 0.604 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8696935176849365
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9229564666748047
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856244).  Saving model ...
Epoch: 16 cost time: 0.7290394306182861
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.636 Vali Acc: 0.866 Test Loss: 0.636 Test Acc: 0.866
Validation loss decreased (-0.856244 --> -0.865619).  Saving model ...
Epoch: 17 cost time: 1.0625922679901123
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
Validation loss decreased (-0.865619 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 1.0523624420166016
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.866 Test Loss: 0.635 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8921515941619873
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.646 Vali Acc: 0.866 Test Loss: 0.646 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7680654525756836
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.661 Vali Acc: 0.869 Test Loss: 0.661 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.234670877456665
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.653 Vali Acc: 0.875 Test Loss: 0.653 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0272088050842285
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.015242576599121
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9662806987762451
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.93019700050354
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.869 Test Loss: 0.696 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8510377407073975
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.863 Test Loss: 0.721 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.199033498764038
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.739 Vali Acc: 0.859 Test Loss: 0.739 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 36570632
model size : 154.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 3.419215679168701
Epoch: 1, Steps: 8 | Train Loss: 2.199 Vali Loss: 1.980 Vali Acc: 0.228 Test Loss: 1.980 Test Acc: 0.228
Validation loss decreased (inf --> -0.228105).  Saving model ...
Epoch: 2 cost time: 1.0810041427612305
Epoch: 2, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.577 Vali Acc: 0.619 Test Loss: 1.577 Test Acc: 0.619
Validation loss decreased (-0.228105 --> -0.618734).  Saving model ...
Epoch: 3 cost time: 1.6148085594177246
Epoch: 3, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.114 Vali Acc: 0.756 Test Loss: 1.114 Test Acc: 0.756
Validation loss decreased (-0.618734 --> -0.756239).  Saving model ...
Epoch: 4 cost time: 1.3482894897460938
Epoch: 4, Steps: 8 | Train Loss: 0.908 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.756239 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.6829721927642822
Epoch: 5, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.520 Vali Acc: 0.831 Test Loss: 0.520 Test Acc: 0.831
Validation loss decreased (-0.799993 --> -0.831245).  Saving model ...
Epoch: 6 cost time: 1.3442308902740479
Epoch: 6, Steps: 8 | Train Loss: 0.457 Vali Loss: 0.627 Vali Acc: 0.794 Test Loss: 0.627 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4902074337005615
Epoch: 7, Steps: 8 | Train Loss: 0.227 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846869).  Saving model ...
Epoch: 8 cost time: 1.2218523025512695
Epoch: 8, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.802 Vali Acc: 0.806 Test Loss: 0.802 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6341478824615479
Epoch: 9, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.869 Vali Acc: 0.838 Test Loss: 0.869 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4734973907470703
Epoch: 10, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.875 Vali Acc: 0.838 Test Loss: 0.875 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6874315738677979
Epoch: 11, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.875 Vali Acc: 0.844 Test Loss: 0.875 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4035098552703857
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.881 Vali Acc: 0.869 Test Loss: 0.881 Test Acc: 0.869
Validation loss decreased (-0.846869 --> -0.868741).  Saving model ...
Epoch: 13 cost time: 1.0338504314422607
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.871 Vali Acc: 0.863 Test Loss: 0.871 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.244992733001709
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.976 Vali Acc: 0.838 Test Loss: 0.976 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5612123012542725
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.035 Vali Acc: 0.847 Test Loss: 1.035 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9361155033111572
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.847 Test Loss: 1.055 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0252463817596436
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.850 Test Loss: 1.025 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2015655040740967
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.853 Test Loss: 1.006 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8604884147644043
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.856 Test Loss: 1.018 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3287372589111328
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.859 Test Loss: 1.038 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1692192554473877
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.853 Test Loss: 1.053 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5451858043670654
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.853 Test Loss: 1.054 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 36791048
model size : 155.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.460268974304199
Epoch: 1, Steps: 8 | Train Loss: 2.225 Vali Loss: 2.115 Vali Acc: 0.134 Test Loss: 2.115 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 1.2951269149780273
Epoch: 2, Steps: 8 | Train Loss: 1.971 Vali Loss: 1.817 Vali Acc: 0.528 Test Loss: 1.817 Test Acc: 0.528
Validation loss decreased (-0.134354 --> -0.528107).  Saving model ...
Epoch: 3 cost time: 0.9148492813110352
Epoch: 3, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.492 Vali Acc: 0.759 Test Loss: 1.492 Test Acc: 0.759
Validation loss decreased (-0.528107 --> -0.759360).  Saving model ...
Epoch: 4 cost time: 1.2719001770019531
Epoch: 4, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.063 Vali Acc: 0.822 Test Loss: 1.063 Test Acc: 0.822
Validation loss decreased (-0.759360 --> -0.821864).  Saving model ...
Epoch: 5 cost time: 0.9296655654907227
Epoch: 5, Steps: 8 | Train Loss: 0.868 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.272754430770874
Epoch: 6, Steps: 8 | Train Loss: 0.545 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1974668502807617
Epoch: 7, Steps: 8 | Train Loss: 0.405 Vali Loss: 0.530 Vali Acc: 0.834 Test Loss: 0.530 Test Acc: 0.834
Validation loss decreased (-0.821864 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 1.1565971374511719
Epoch: 8, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.623 Vali Acc: 0.834 Test Loss: 0.623 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1368632316589355
Epoch: 9, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.712 Vali Acc: 0.812 Test Loss: 0.712 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9467926025390625
Epoch: 10, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.657 Vali Acc: 0.838 Test Loss: 0.657 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837493).  Saving model ...
Epoch: 11 cost time: 1.2689049243927002
Epoch: 11, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.757 Vali Acc: 0.831 Test Loss: 0.757 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7536923885345459
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.854 Vali Acc: 0.822 Test Loss: 0.854 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5569605827331543
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.819 Vali Acc: 0.831 Test Loss: 0.819 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5668284893035889
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.816 Vali Acc: 0.841 Test Loss: 0.816 Test Acc: 0.841
Validation loss decreased (-0.837493 --> -0.840617).  Saving model ...
Epoch: 15 cost time: 0.8291630744934082
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.290414571762085
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.864 Vali Acc: 0.838 Test Loss: 0.864 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0601279735565186
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.891 Vali Acc: 0.834 Test Loss: 0.891 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8748936653137207
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.877 Vali Acc: 0.841 Test Loss: 0.877 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8726050853729248
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.854 Vali Acc: 0.841 Test Loss: 0.854 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3573276996612549
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.847 Test Loss: 0.839 Test Acc: 0.847
Validation loss decreased (-0.840617 --> -0.846867).  Saving model ...
Epoch: 21 cost time: 0.9939355850219727
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.838 Vali Acc: 0.841 Test Loss: 0.838 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1490893363952637
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.850 Test Loss: 0.842 Test Acc: 0.850
Validation loss decreased (-0.846867 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 1.131242275238037
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.854 Vali Acc: 0.853 Test Loss: 0.854 Test Acc: 0.853
Validation loss decreased (-0.849992 --> -0.853116).  Saving model ...
Epoch: 24 cost time: 1.3281614780426025
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1299645900726318
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.870 Vali Acc: 0.844 Test Loss: 0.870 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8046121597290039
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.856 Test Loss: 0.942 Test Acc: 0.856
Validation loss decreased (-0.853116 --> -0.856241).  Saving model ...
Epoch: 27 cost time: 1.1342251300811768
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.915 Vali Acc: 0.841 Test Loss: 0.915 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6718416213989258
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.170881748199463
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.895 Vali Acc: 0.853 Test Loss: 0.895 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0251424312591553
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.878 Vali Acc: 0.850 Test Loss: 0.878 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7858877182006836
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.856 Test Loss: 0.884 Test Acc: 0.856
Validation loss decreased (-0.856241 --> -0.856241).  Saving model ...
Epoch: 32 cost time: 1.2059204578399658
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.890 Vali Acc: 0.859 Test Loss: 0.890 Test Acc: 0.859
Validation loss decreased (-0.856241 --> -0.859366).  Saving model ...
Epoch: 33 cost time: 0.7420902252197266
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.863 Test Loss: 0.891 Test Acc: 0.863
Validation loss decreased (-0.859366 --> -0.862491).  Saving model ...
Epoch: 34 cost time: 1.2805590629577637
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.863 Test Loss: 0.893 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9599483013153076
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.859 Test Loss: 0.889 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1889421939849854
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.859 Test Loss: 0.891 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0894041061401367
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.866 Test Loss: 0.892 Test Acc: 0.866
Validation loss decreased (-0.862491 --> -0.865616).  Saving model ...
Epoch: 38 cost time: 1.2381114959716797
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.866 Test Loss: 0.897 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0826032161712646
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.866 Test Loss: 0.898 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2111191749572754
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.866 Test Loss: 0.896 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2237634658813477
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.869 Test Loss: 0.889 Test Acc: 0.869
Validation loss decreased (-0.865616 --> -0.868741).  Saving model ...
Epoch: 42 cost time: 0.9250988960266113
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.869 Test Loss: 0.892 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.569786548614502
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.872 Test Loss: 0.890 Test Acc: 0.872
Validation loss decreased (-0.868741 --> -0.871866).  Saving model ...
Epoch: 44 cost time: 0.6945607662200928
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.872 Test Loss: 0.892 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7402212619781494
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.869 Test Loss: 0.896 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7177186012268066
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.869 Test Loss: 0.903 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.801013708114624
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.869 Test Loss: 0.906 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8692071437835693
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.869 Test Loss: 0.910 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8613195419311523
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.869 Test Loss: 0.912 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8220088481903076
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.866 Test Loss: 0.921 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 36652808
model size : 154.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2039546966552734
Epoch: 1, Steps: 8 | Train Loss: 2.087 Vali Loss: 2.031 Vali Acc: 0.209 Test Loss: 2.031 Test Acc: 0.209
Validation loss decreased (inf --> -0.209355).  Saving model ...
Epoch: 2 cost time: 0.6047616004943848
Epoch: 2, Steps: 8 | Train Loss: 1.944 Vali Loss: 1.870 Vali Acc: 0.528 Test Loss: 1.870 Test Acc: 0.528
Validation loss decreased (-0.209355 --> -0.528106).  Saving model ...
Epoch: 3 cost time: 0.7585687637329102
Epoch: 3, Steps: 8 | Train Loss: 1.790 Vali Loss: 1.643 Vali Acc: 0.647 Test Loss: 1.643 Test Acc: 0.647
Validation loss decreased (-0.528106 --> -0.646859).  Saving model ...
Epoch: 4 cost time: 0.60467529296875
Epoch: 4, Steps: 8 | Train Loss: 1.516 Vali Loss: 1.352 Vali Acc: 0.772 Test Loss: 1.352 Test Acc: 0.772
Validation loss decreased (-0.646859 --> -0.771861).  Saving model ...
Epoch: 5 cost time: 0.5273535251617432
Epoch: 5, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.028 Vali Acc: 0.762 Test Loss: 1.028 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6923823356628418
Epoch: 6, Steps: 8 | Train Loss: 0.867 Vali Loss: 0.737 Vali Acc: 0.794 Test Loss: 0.737 Test Acc: 0.794
Validation loss decreased (-0.771861 --> -0.793743).  Saving model ...
Epoch: 7 cost time: 0.6609835624694824
Epoch: 7, Steps: 8 | Train Loss: 0.606 Vali Loss: 0.588 Vali Acc: 0.787 Test Loss: 0.588 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6289942264556885
Epoch: 8, Steps: 8 | Train Loss: 0.413 Vali Loss: 0.549 Vali Acc: 0.812 Test Loss: 0.549 Test Acc: 0.812
Validation loss decreased (-0.793743 --> -0.812495).  Saving model ...
Epoch: 9 cost time: 0.8247425556182861
Epoch: 9, Steps: 8 | Train Loss: 0.307 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8368871212005615
Epoch: 10, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8024864196777344
Epoch: 11, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.641 Vali Acc: 0.831 Test Loss: 0.641 Test Acc: 0.831
Validation loss decreased (-0.812495 --> -0.831244).  Saving model ...
Epoch: 12 cost time: 0.7747886180877686
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 0.5554406642913818
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.656 Vali Acc: 0.841 Test Loss: 0.656 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8159103393554688
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.659 Vali Acc: 0.834 Test Loss: 0.659 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9497721195220947
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.679 Vali Acc: 0.841 Test Loss: 0.679 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7464570999145508
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.697 Vali Acc: 0.844 Test Loss: 0.697 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6385066509246826
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846868).  Saving model ...
Epoch: 18 cost time: 0.8034682273864746
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.720 Vali Acc: 0.853 Test Loss: 0.720 Test Acc: 0.853
Validation loss decreased (-0.846868 --> -0.853118).  Saving model ...
Epoch: 19 cost time: 0.8795342445373535
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6759128570556641
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.721 Vali Acc: 0.847 Test Loss: 0.721 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8448293209075928
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.847 Test Loss: 0.740 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7304215431213379
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.767 Vali Acc: 0.844 Test Loss: 0.767 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8998029232025146
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.789 Vali Acc: 0.841 Test Loss: 0.789 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.795853853225708
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.844 Test Loss: 0.794 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5960869789123535
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.791 Vali Acc: 0.841 Test Loss: 0.791 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8592889308929443
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.841 Test Loss: 0.800 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6654472351074219
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.827 Vali Acc: 0.834 Test Loss: 0.827 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7633757591247559
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.839 Vali Acc: 0.847 Test Loss: 0.839 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 36583688
model size : 154.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.9091484546661377
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 1.992 Vali Acc: 0.294 Test Loss: 1.992 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 1.0162856578826904
Epoch: 2, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.628 Vali Acc: 0.653 Test Loss: 1.628 Test Acc: 0.653
Validation loss decreased (-0.293730 --> -0.653109).  Saving model ...
Epoch: 3 cost time: 1.157191276550293
Epoch: 3, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.166 Vali Acc: 0.784 Test Loss: 1.166 Test Acc: 0.784
Validation loss decreased (-0.653109 --> -0.784363).  Saving model ...
Epoch: 4 cost time: 1.2120029926300049
Epoch: 4, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.751 Vali Acc: 0.794 Test Loss: 0.751 Test Acc: 0.794
Validation loss decreased (-0.784363 --> -0.793742).  Saving model ...
Epoch: 5 cost time: 1.3509609699249268
Epoch: 5, Steps: 8 | Train Loss: 0.609 Vali Loss: 0.554 Vali Acc: 0.841 Test Loss: 0.554 Test Acc: 0.841
Validation loss decreased (-0.793742 --> -0.840619).  Saving model ...
Epoch: 6 cost time: 1.1125783920288086
Epoch: 6, Steps: 8 | Train Loss: 0.385 Vali Loss: 0.512 Vali Acc: 0.819 Test Loss: 0.512 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.296806812286377
Epoch: 7, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.576 Vali Acc: 0.841 Test Loss: 0.576 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3864622116088867
Epoch: 8, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
Validation loss decreased (-0.840619 --> -0.846869).  Saving model ...
Epoch: 9 cost time: 1.3407630920410156
Epoch: 9, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1049330234527588
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.3602831363677979
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.850 Vali Acc: 0.838 Test Loss: 0.850 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3814799785614014
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.877 Vali Acc: 0.838 Test Loss: 0.877 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8678317070007324
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.901 Vali Acc: 0.847 Test Loss: 0.901 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4511590003967285
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.020 Vali Acc: 0.853 Test Loss: 1.020 Test Acc: 0.853
Validation loss decreased (-0.849992 --> -0.853115).  Saving model ...
Epoch: 15 cost time: 1.0595450401306152
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.061 Vali Acc: 0.847 Test Loss: 1.061 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9062135219573975
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.058 Vali Acc: 0.841 Test Loss: 1.058 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.354853630065918
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.114 Vali Acc: 0.838 Test Loss: 1.114 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2081670761108398
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.060 Vali Acc: 0.859 Test Loss: 1.060 Test Acc: 0.859
Validation loss decreased (-0.853115 --> -0.859364).  Saving model ...
Epoch: 19 cost time: 1.3565044403076172
Epoch: 19, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.018 Vali Acc: 0.856 Test Loss: 1.018 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3844218254089355
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.274 Vali Acc: 0.841 Test Loss: 1.274 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.228214979171753
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.106 Vali Acc: 0.850 Test Loss: 1.106 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2833013534545898
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.431 Vali Acc: 0.812 Test Loss: 1.431 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9474015235900879
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.309 Vali Acc: 0.825 Test Loss: 1.309 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.145237684249878
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.158 Vali Acc: 0.838 Test Loss: 1.158 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2016596794128418
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.211 Vali Acc: 0.866 Test Loss: 1.211 Test Acc: 0.866
Validation loss decreased (-0.859364 --> -0.865613).  Saving model ...
Epoch: 26 cost time: 1.1697590351104736
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.856 Test Loss: 1.336 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2783262729644775
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.275 Vali Acc: 0.841 Test Loss: 1.275 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8526661396026611
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.841 Test Loss: 1.233 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2343018054962158
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.844 Test Loss: 1.222 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9533915519714355
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.844 Test Loss: 1.219 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3548827171325684
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.853 Test Loss: 1.180 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3251216411590576
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.866 Test Loss: 1.165 Test Acc: 0.866
Validation loss decreased (-0.865613 --> -0.865613).  Saving model ...
Epoch: 33 cost time: 1.4028220176696777
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.869 Test Loss: 1.163 Test Acc: 0.869
Validation loss decreased (-0.865613 --> -0.868738).  Saving model ...
Epoch: 34 cost time: 0.9491636753082275
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.866 Test Loss: 1.165 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3278095722198486
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.866 Test Loss: 1.169 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.36212158203125
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.869 Test Loss: 1.171 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8415863513946533
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.869 Test Loss: 1.169 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2756307125091553
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.872 Test Loss: 1.167 Test Acc: 0.872
Validation loss decreased (-0.868738 --> -0.871863).  Saving model ...
Epoch: 39 cost time: 0.8263111114501953
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.875 Test Loss: 1.165 Test Acc: 0.875
Validation loss decreased (-0.871863 --> -0.874988).  Saving model ...
Epoch: 40 cost time: 0.732187032699585
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.875 Test Loss: 1.167 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7631652355194092
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.875 Test Loss: 1.172 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7345254421234131
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.875 Test Loss: 1.173 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8795425891876221
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.875 Test Loss: 1.173 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9456970691680908
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.875 Test Loss: 1.176 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8501770496368408
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.872 Test Loss: 1.185 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8157773017883301
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.872 Test Loss: 1.195 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9047343730926514
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.872 Test Loss: 1.197 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6553983688354492
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.196 Vali Acc: 0.872 Test Loss: 1.196 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9512672424316406
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.872 Test Loss: 1.193 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 36781064
model size : 154.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.956610918045044
Epoch: 1, Steps: 8 | Train Loss: 2.098 Vali Loss: 2.012 Vali Acc: 0.200 Test Loss: 2.012 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 1.3719525337219238
Epoch: 2, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.779 Vali Acc: 0.522 Test Loss: 1.779 Test Acc: 0.522
Validation loss decreased (-0.199980 --> -0.521857).  Saving model ...
Epoch: 3 cost time: 0.9333236217498779
Epoch: 3, Steps: 8 | Train Loss: 1.639 Vali Loss: 1.452 Vali Acc: 0.713 Test Loss: 1.452 Test Acc: 0.713
Validation loss decreased (-0.521857 --> -0.712485).  Saving model ...
Epoch: 4 cost time: 1.357163429260254
Epoch: 4, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.099 Vali Acc: 0.750 Test Loss: 1.099 Test Acc: 0.750
Validation loss decreased (-0.712485 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 0.9597785472869873
Epoch: 5, Steps: 8 | Train Loss: 0.920 Vali Loss: 0.768 Vali Acc: 0.809 Test Loss: 0.768 Test Acc: 0.809
Validation loss decreased (-0.749989 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 0.733417272567749
Epoch: 6, Steps: 8 | Train Loss: 0.600 Vali Loss: 0.561 Vali Acc: 0.819 Test Loss: 0.561 Test Acc: 0.819
Validation loss decreased (-0.809367 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 1.0534486770629883
Epoch: 7, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 1.4035484790802002
Epoch: 8, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
Validation loss decreased (-0.824995 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 1.033228874206543
Epoch: 9, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.498 Vali Acc: 0.856 Test Loss: 0.498 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856245).  Saving model ...
Epoch: 10 cost time: 1.3854169845581055
Epoch: 10, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5319974422454834
Epoch: 11, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0957636833190918
Epoch: 12, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3202228546142578
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.611 Vali Acc: 0.866 Test Loss: 0.611 Test Acc: 0.866
Validation loss decreased (-0.856245 --> -0.865619).  Saving model ...
Epoch: 14 cost time: 0.9736478328704834
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7619497776031494
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.801 Vali Acc: 0.844 Test Loss: 0.801 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7305028438568115
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.759 Vali Acc: 0.856 Test Loss: 0.759 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1632282733917236
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.728 Vali Acc: 0.856 Test Loss: 0.728 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8990378379821777
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.847 Test Loss: 0.792 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8397505283355713
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.844 Test Loss: 0.846 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.474517822265625
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.845 Vali Acc: 0.847 Test Loss: 0.845 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0840227603912354
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.817 Vali Acc: 0.844 Test Loss: 0.817 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2757384777069092
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.780 Vali Acc: 0.853 Test Loss: 0.780 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9238238334655762
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.856 Test Loss: 0.776 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36658184
model size : 154.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3839619159698486
Epoch: 1, Steps: 8 | Train Loss: 2.231 Vali Loss: 2.086 Vali Acc: 0.194 Test Loss: 2.086 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.6818230152130127
Epoch: 2, Steps: 8 | Train Loss: 2.048 Vali Loss: 1.904 Vali Acc: 0.406 Test Loss: 1.904 Test Acc: 0.406
Validation loss decreased (-0.193729 --> -0.406231).  Saving model ...
Epoch: 3 cost time: 0.8252847194671631
Epoch: 3, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.680 Vali Acc: 0.622 Test Loss: 1.680 Test Acc: 0.622
Validation loss decreased (-0.406231 --> -0.621858).  Saving model ...
Epoch: 4 cost time: 0.6767079830169678
Epoch: 4, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.432 Vali Acc: 0.706 Test Loss: 1.432 Test Acc: 0.706
Validation loss decreased (-0.621858 --> -0.706236).  Saving model ...
Epoch: 5 cost time: 0.785374641418457
Epoch: 5, Steps: 8 | Train Loss: 1.301 Vali Loss: 1.138 Vali Acc: 0.766 Test Loss: 1.138 Test Acc: 0.766
Validation loss decreased (-0.706236 --> -0.765614).  Saving model ...
Epoch: 6 cost time: 0.8129429817199707
Epoch: 6, Steps: 8 | Train Loss: 1.035 Vali Loss: 0.833 Vali Acc: 0.803 Test Loss: 0.833 Test Acc: 0.803
Validation loss decreased (-0.765614 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.8829162120819092
Epoch: 7, Steps: 8 | Train Loss: 0.752 Vali Loss: 0.621 Vali Acc: 0.806 Test Loss: 0.621 Test Acc: 0.806
Validation loss decreased (-0.803117 --> -0.806244).  Saving model ...
Epoch: 8 cost time: 0.9022274017333984
Epoch: 8, Steps: 8 | Train Loss: 0.488 Vali Loss: 0.491 Vali Acc: 0.831 Test Loss: 0.491 Test Acc: 0.831
Validation loss decreased (-0.806244 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.6969637870788574
Epoch: 9, Steps: 8 | Train Loss: 0.342 Vali Loss: 0.458 Vali Acc: 0.834 Test Loss: 0.458 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 0.833294153213501
Epoch: 10, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.439 Vali Acc: 0.853 Test Loss: 0.439 Test Acc: 0.853
Validation loss decreased (-0.834370 --> -0.853121).  Saving model ...
Epoch: 11 cost time: 0.8839113712310791
Epoch: 11, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.463 Vali Acc: 0.853 Test Loss: 0.463 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8335292339324951
Epoch: 12, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7643637657165527
Epoch: 13, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7833776473999023
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8718714714050293
Epoch: 15, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.587 Vali Acc: 0.856 Test Loss: 0.587 Test Acc: 0.856
Validation loss decreased (-0.853121 --> -0.856244).  Saving model ...
Epoch: 16 cost time: 0.821143388748169
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8183207511901855
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.582 Vali Acc: 0.853 Test Loss: 0.582 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7883403301239014
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.619 Vali Acc: 0.853 Test Loss: 0.619 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7077240943908691
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7721264362335205
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8373250961303711
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.847 Test Loss: 0.662 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6782734394073486
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.687 Vali Acc: 0.856 Test Loss: 0.687 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.690281867980957
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5829722881317139
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.856 Test Loss: 0.698 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.558192253112793
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.695 Vali Acc: 0.853 Test Loss: 0.695 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 36604424
model size : 154.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7096428871154785
Epoch: 1, Steps: 8 | Train Loss: 2.237 Vali Loss: 2.050 Vali Acc: 0.138 Test Loss: 2.050 Test Acc: 0.138
Validation loss decreased (inf --> -0.137480).  Saving model ...
Epoch: 2 cost time: 1.11842679977417
Epoch: 2, Steps: 8 | Train Loss: 1.914 Vali Loss: 1.626 Vali Acc: 0.569 Test Loss: 1.626 Test Acc: 0.569
Validation loss decreased (-0.137480 --> -0.568734).  Saving model ...
Epoch: 3 cost time: 1.26253080368042
Epoch: 3, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.112 Vali Acc: 0.781 Test Loss: 1.112 Test Acc: 0.781
Validation loss decreased (-0.568734 --> -0.781239).  Saving model ...
Epoch: 4 cost time: 0.7940349578857422
Epoch: 4, Steps: 8 | Train Loss: 0.931 Vali Loss: 0.716 Vali Acc: 0.791 Test Loss: 0.716 Test Acc: 0.791
Validation loss decreased (-0.781239 --> -0.790618).  Saving model ...
Epoch: 5 cost time: 0.9738767147064209
Epoch: 5, Steps: 8 | Train Loss: 0.584 Vali Loss: 0.512 Vali Acc: 0.841 Test Loss: 0.512 Test Acc: 0.841
Validation loss decreased (-0.790618 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 1.1794390678405762
Epoch: 6, Steps: 8 | Train Loss: 0.411 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9211471080780029
Epoch: 7, Steps: 8 | Train Loss: 0.219 Vali Loss: 0.608 Vali Acc: 0.838 Test Loss: 0.608 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2604401111602783
Epoch: 8, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 0.9515368938446045
Epoch: 9, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.738 Vali Acc: 0.844 Test Loss: 0.738 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3200349807739258
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.778 Vali Acc: 0.838 Test Loss: 0.778 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.317655324935913
Epoch: 11, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.721 Vali Acc: 0.863 Test Loss: 0.721 Test Acc: 0.863
Validation loss decreased (-0.843744 --> -0.862493).  Saving model ...
Epoch: 12 cost time: 1.3862230777740479
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.893 Vali Acc: 0.850 Test Loss: 0.893 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2959403991699219
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.804 Vali Acc: 0.853 Test Loss: 0.804 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.158689260482788
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.911 Vali Acc: 0.859 Test Loss: 0.911 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1962132453918457
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.955 Vali Acc: 0.841 Test Loss: 0.955 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8467440605163574
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.980 Vali Acc: 0.844 Test Loss: 0.980 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8243083953857422
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.015 Vali Acc: 0.856 Test Loss: 1.015 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8257951736450195
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.986 Vali Acc: 0.853 Test Loss: 0.986 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7799227237701416
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.863 Test Loss: 0.936 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8460488319396973
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.920 Vali Acc: 0.863 Test Loss: 0.920 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9442136287689209
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.856 Test Loss: 0.926 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 36784904
model size : 155.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4625468254089355
Epoch: 1, Steps: 8 | Train Loss: 2.060 Vali Loss: 1.993 Vali Acc: 0.300 Test Loss: 1.993 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 0.9285006523132324
Epoch: 2, Steps: 8 | Train Loss: 1.913 Vali Loss: 1.760 Vali Acc: 0.559 Test Loss: 1.760 Test Acc: 0.559
Validation loss decreased (-0.299980 --> -0.559357).  Saving model ...
Epoch: 3 cost time: 0.9059195518493652
Epoch: 3, Steps: 8 | Train Loss: 1.635 Vali Loss: 1.435 Vali Acc: 0.741 Test Loss: 1.435 Test Acc: 0.741
Validation loss decreased (-0.559357 --> -0.740611).  Saving model ...
Epoch: 4 cost time: 0.9569671154022217
Epoch: 4, Steps: 8 | Train Loss: 1.251 Vali Loss: 1.052 Vali Acc: 0.769 Test Loss: 1.052 Test Acc: 0.769
Validation loss decreased (-0.740611 --> -0.768739).  Saving model ...
Epoch: 5 cost time: 0.9205937385559082
Epoch: 5, Steps: 8 | Train Loss: 0.856 Vali Loss: 0.686 Vali Acc: 0.794 Test Loss: 0.686 Test Acc: 0.794
Validation loss decreased (-0.768739 --> -0.793743).  Saving model ...
Epoch: 6 cost time: 0.8937239646911621
Epoch: 6, Steps: 8 | Train Loss: 0.562 Vali Loss: 0.493 Vali Acc: 0.834 Test Loss: 0.493 Test Acc: 0.834
Validation loss decreased (-0.793743 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.9217607975006104
Epoch: 7, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.494 Vali Acc: 0.828 Test Loss: 0.494 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0166828632354736
Epoch: 8, Steps: 8 | Train Loss: 0.306 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0622668266296387
Epoch: 9, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.583 Vali Acc: 0.834 Test Loss: 0.583 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9582030773162842
Epoch: 10, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.597 Vali Acc: 0.847 Test Loss: 0.597 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846869).  Saving model ...
Epoch: 11 cost time: 0.9663264751434326
Epoch: 11, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.566 Vali Acc: 0.869 Test Loss: 0.566 Test Acc: 0.869
Validation loss decreased (-0.846869 --> -0.868744).  Saving model ...
Epoch: 12 cost time: 0.8906714916229248
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.617 Vali Acc: 0.869 Test Loss: 0.617 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8799633979797363
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
Validation loss decreased (-0.868744 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.887753963470459
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8032972812652588
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.666 Vali Acc: 0.872 Test Loss: 0.666 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9037668704986572
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.744 Vali Acc: 0.856 Test Loss: 0.744 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7576076984405518
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.695 Vali Acc: 0.872 Test Loss: 0.695 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6612191200256348
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.872 Test Loss: 0.697 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9490792751312256
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.872 Test Loss: 0.702 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7852938175201416
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.869 Test Loss: 0.737 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8675000667572021
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.750 Vali Acc: 0.866 Test Loss: 0.750 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8400959968566895
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.751 Vali Acc: 0.866 Test Loss: 0.751 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7461650371551514
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.869 Test Loss: 0.722 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 36677384
model size : 154.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4247560501098633
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 2.090 Vali Acc: 0.159 Test Loss: 2.090 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.7487554550170898
Epoch: 2, Steps: 8 | Train Loss: 2.017 Vali Loss: 1.908 Vali Acc: 0.309 Test Loss: 1.908 Test Acc: 0.309
Validation loss decreased (-0.159354 --> -0.309356).  Saving model ...
Epoch: 3 cost time: 0.7842934131622314
Epoch: 3, Steps: 8 | Train Loss: 1.808 Vali Loss: 1.691 Vali Acc: 0.634 Test Loss: 1.691 Test Acc: 0.634
Validation loss decreased (-0.309356 --> -0.634358).  Saving model ...
Epoch: 4 cost time: 0.8106017112731934
Epoch: 4, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.437 Vali Acc: 0.684 Test Loss: 1.437 Test Acc: 0.684
Validation loss decreased (-0.634358 --> -0.684361).  Saving model ...
Epoch: 5 cost time: 0.7116444110870361
Epoch: 5, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.111 Vali Acc: 0.747 Test Loss: 1.111 Test Acc: 0.747
Validation loss decreased (-0.684361 --> -0.746864).  Saving model ...
Epoch: 6 cost time: 0.8076095581054688
Epoch: 6, Steps: 8 | Train Loss: 0.960 Vali Loss: 0.812 Vali Acc: 0.784 Test Loss: 0.812 Test Acc: 0.784
Validation loss decreased (-0.746864 --> -0.784367).  Saving model ...
Epoch: 7 cost time: 0.6866188049316406
Epoch: 7, Steps: 8 | Train Loss: 0.672 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
Validation loss decreased (-0.784367 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 0.5608632564544678
Epoch: 8, Steps: 8 | Train Loss: 0.460 Vali Loss: 0.540 Vali Acc: 0.806 Test Loss: 0.540 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6803114414215088
Epoch: 9, Steps: 8 | Train Loss: 0.315 Vali Loss: 0.537 Vali Acc: 0.812 Test Loss: 0.537 Test Acc: 0.812
Validation loss decreased (-0.809369 --> -0.812495).  Saving model ...
Epoch: 10 cost time: 0.7435975074768066
Epoch: 10, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
Validation loss decreased (-0.812495 --> -0.821870).  Saving model ...
Epoch: 11 cost time: 0.7360427379608154
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.594 Vali Acc: 0.809 Test Loss: 0.594 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5944368839263916
Epoch: 12, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6211488246917725
Epoch: 13, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
Validation loss decreased (-0.821870 --> -0.837494).  Saving model ...
Epoch: 14 cost time: 0.7185115814208984
Epoch: 14, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.547 Vali Acc: 0.847 Test Loss: 0.547 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.8251919746398926
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.607 Vali Acc: 0.847 Test Loss: 0.607 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8430631160736084
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8620522022247314
Epoch: 17, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.675 Vali Acc: 0.841 Test Loss: 0.675 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7563221454620361
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.701 Vali Acc: 0.838 Test Loss: 0.701 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7303831577301025
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6256883144378662
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5307192802429199
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.724 Vali Acc: 0.834 Test Loss: 0.724 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6466407775878906
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.731 Vali Acc: 0.844 Test Loss: 0.731 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.701758861541748
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.735 Vali Acc: 0.844 Test Loss: 0.735 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7785763740539551
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.732 Vali Acc: 0.850 Test Loss: 0.732 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.6837384700775146
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.738 Vali Acc: 0.859 Test Loss: 0.738 Test Acc: 0.859
Validation loss decreased (-0.849993 --> -0.859368).  Saving model ...
Epoch: 26 cost time: 0.6576235294342041
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.856 Test Loss: 0.727 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7028424739837646
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.726 Vali Acc: 0.853 Test Loss: 0.726 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6107025146484375
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.734 Vali Acc: 0.853 Test Loss: 0.734 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6116049289703369
Epoch: 29, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.764 Vali Acc: 0.838 Test Loss: 0.764 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6626379489898682
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.662834644317627
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.769 Vali Acc: 0.847 Test Loss: 0.769 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5452797412872314
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6768617630004883
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.664923906326294
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6377766132354736
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.771 Vali Acc: 0.850 Test Loss: 0.771 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 36623624
model size : 154.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7520909309387207
Epoch: 1, Steps: 8 | Train Loss: 2.198 Vali Loss: 1.944 Vali Acc: 0.347 Test Loss: 1.944 Test Acc: 0.347
Validation loss decreased (inf --> -0.346856).  Saving model ...
Epoch: 2 cost time: 0.968010425567627
Epoch: 2, Steps: 8 | Train Loss: 1.830 Vali Loss: 1.605 Vali Acc: 0.662 Test Loss: 1.605 Test Acc: 0.662
Validation loss decreased (-0.346856 --> -0.662484).  Saving model ...
Epoch: 3 cost time: 0.7715408802032471
Epoch: 3, Steps: 8 | Train Loss: 1.450 Vali Loss: 1.178 Vali Acc: 0.800 Test Loss: 1.178 Test Acc: 0.800
Validation loss decreased (-0.662484 --> -0.799988).  Saving model ...
Epoch: 4 cost time: 0.6740775108337402
Epoch: 4, Steps: 8 | Train Loss: 1.015 Vali Loss: 0.777 Vali Acc: 0.794 Test Loss: 0.777 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.745558500289917
Epoch: 5, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
Validation loss decreased (-0.799988 --> -0.818745).  Saving model ...
Epoch: 6 cost time: 0.9114632606506348
Epoch: 6, Steps: 8 | Train Loss: 0.387 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
Validation loss decreased (-0.818745 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.6091539859771729
Epoch: 7, Steps: 8 | Train Loss: 0.353 Vali Loss: 0.607 Vali Acc: 0.794 Test Loss: 0.607 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9044189453125
Epoch: 8, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.9683883190155029
Epoch: 9, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7474157810211182
Epoch: 10, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.724 Vali Acc: 0.834 Test Loss: 0.724 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0974311828613281
Epoch: 11, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.600 Vali Acc: 0.859 Test Loss: 0.600 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859369).  Saving model ...
Epoch: 12 cost time: 0.9983508586883545
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.844 Vali Acc: 0.844 Test Loss: 0.844 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0461945533752441
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.052865743637085
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.700 Vali Acc: 0.847 Test Loss: 0.700 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8527932167053223
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.794 Vali Acc: 0.847 Test Loss: 0.794 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1218085289001465
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0674233436584473
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.803 Vali Acc: 0.850 Test Loss: 0.803 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9248709678649902
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.869 Test Loss: 0.753 Test Acc: 0.869
Validation loss decreased (-0.859369 --> -0.868742).  Saving model ...
Epoch: 19 cost time: 0.7101650238037109
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.872 Test Loss: 0.724 Test Acc: 0.872
Validation loss decreased (-0.868742 --> -0.871868).  Saving model ...
Epoch: 20 cost time: 0.6790647506713867
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.878 Test Loss: 0.731 Test Acc: 0.878
Validation loss decreased (-0.871868 --> -0.878118).  Saving model ...
Epoch: 21 cost time: 0.6971538066864014
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.875 Test Loss: 0.759 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.973505973815918
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.869 Test Loss: 0.753 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.994159460067749
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
Validation loss decreased (-0.878118 --> -0.878118).  Saving model ...
Epoch: 24 cost time: 0.7794651985168457
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.878 Test Loss: 0.702 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8456594944000244
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.878 Test Loss: 0.736 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0210537910461426
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.881 Test Loss: 0.751 Test Acc: 0.881
Validation loss decreased (-0.878118 --> -0.881242).  Saving model ...
Epoch: 27 cost time: 0.7203865051269531
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.878 Test Loss: 0.759 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1363534927368164
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.872 Test Loss: 0.763 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9384651184082031
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.872 Test Loss: 0.759 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1639125347137451
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.869 Test Loss: 0.753 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7577788829803467
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.866 Test Loss: 0.750 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3841423988342285
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.869 Test Loss: 0.753 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7802276611328125
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.872 Test Loss: 0.763 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8053579330444336
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.756136417388916
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.875 Test Loss: 0.777 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.946812629699707
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 36781064
model size : 154.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.595850706100464
Epoch: 1, Steps: 8 | Train Loss: 2.125 Vali Loss: 2.034 Vali Acc: 0.197 Test Loss: 2.034 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 0.7058866024017334
Epoch: 2, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.807 Vali Acc: 0.503 Test Loss: 1.807 Test Acc: 0.503
Validation loss decreased (-0.196855 --> -0.503107).  Saving model ...
Epoch: 3 cost time: 0.8300065994262695
Epoch: 3, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.494 Vali Acc: 0.734 Test Loss: 1.494 Test Acc: 0.734
Validation loss decreased (-0.503107 --> -0.734360).  Saving model ...
Epoch: 4 cost time: 0.7213020324707031
Epoch: 4, Steps: 8 | Train Loss: 1.410 Vali Loss: 1.127 Vali Acc: 0.769 Test Loss: 1.127 Test Acc: 0.769
Validation loss decreased (-0.734360 --> -0.768739).  Saving model ...
Epoch: 5 cost time: 0.7469058036804199
Epoch: 5, Steps: 8 | Train Loss: 0.959 Vali Loss: 0.735 Vali Acc: 0.806 Test Loss: 0.735 Test Acc: 0.806
Validation loss decreased (-0.768739 --> -0.806243).  Saving model ...
Epoch: 6 cost time: 0.8528475761413574
Epoch: 6, Steps: 8 | Train Loss: 0.623 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.6943514347076416
Epoch: 7, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.8024327754974365
Epoch: 8, Steps: 8 | Train Loss: 0.332 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.7155632972717285
Epoch: 9, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.7029464244842529
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6496963500976562
Epoch: 11, Steps: 8 | Train Loss: 0.088 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856244).  Saving model ...
Epoch: 12 cost time: 0.6424376964569092
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.576 Vali Acc: 0.869 Test Loss: 0.576 Test Acc: 0.869
Validation loss decreased (-0.856244 --> -0.868744).  Saving model ...
Epoch: 13 cost time: 0.8509314060211182
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8003578186035156
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.659 Vali Acc: 0.866 Test Loss: 0.659 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7637214660644531
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.640 Vali Acc: 0.872 Test Loss: 0.640 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871869).  Saving model ...
Epoch: 16 cost time: 0.8271842002868652
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.632 Vali Acc: 0.881 Test Loss: 0.632 Test Acc: 0.881
Validation loss decreased (-0.871869 --> -0.881244).  Saving model ...
Epoch: 17 cost time: 0.8823714256286621
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.685 Vali Acc: 0.866 Test Loss: 0.685 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7656238079071045
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.671 Vali Acc: 0.866 Test Loss: 0.671 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7231554985046387
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.872 Test Loss: 0.660 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8586349487304688
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.869 Test Loss: 0.630 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7497856616973877
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.863 Test Loss: 0.659 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8818490505218506
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.863 Test Loss: 0.700 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8411259651184082
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.866 Test Loss: 0.703 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.693117618560791
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.869 Test Loss: 0.686 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6978931427001953
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.680 Vali Acc: 0.872 Test Loss: 0.680 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6549127101898193
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.872 Test Loss: 0.708 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 36696584
model size : 154.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.192547082901001
Epoch: 1, Steps: 8 | Train Loss: 2.106 Vali Loss: 1.989 Vali Acc: 0.200 Test Loss: 1.989 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 0.6257278919219971
Epoch: 2, Steps: 8 | Train Loss: 1.963 Vali Loss: 1.802 Vali Acc: 0.491 Test Loss: 1.802 Test Acc: 0.491
Validation loss decreased (-0.199980 --> -0.490607).  Saving model ...
Epoch: 3 cost time: 0.6525635719299316
Epoch: 3, Steps: 8 | Train Loss: 1.745 Vali Loss: 1.576 Vali Acc: 0.678 Test Loss: 1.576 Test Acc: 0.678
Validation loss decreased (-0.490607 --> -0.678109).  Saving model ...
Epoch: 4 cost time: 0.5955376625061035
Epoch: 4, Steps: 8 | Train Loss: 1.491 Vali Loss: 1.333 Vali Acc: 0.753 Test Loss: 1.333 Test Acc: 0.753
Validation loss decreased (-0.678109 --> -0.753112).  Saving model ...
Epoch: 5 cost time: 0.6670479774475098
Epoch: 5, Steps: 8 | Train Loss: 1.262 Vali Loss: 1.056 Vali Acc: 0.822 Test Loss: 1.056 Test Acc: 0.822
Validation loss decreased (-0.753112 --> -0.821864).  Saving model ...
Epoch: 6 cost time: 0.7642421722412109
Epoch: 6, Steps: 8 | Train Loss: 0.979 Vali Loss: 0.818 Vali Acc: 0.803 Test Loss: 0.818 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6606616973876953
Epoch: 7, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7158119678497314
Epoch: 8, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6772124767303467
Epoch: 9, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5017547607421875
Epoch: 10, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.494 Vali Acc: 0.828 Test Loss: 0.494 Test Acc: 0.828
Validation loss decreased (-0.821864 --> -0.828120).  Saving model ...
Epoch: 11 cost time: 0.7033371925354004
Epoch: 11, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.594336986541748
Epoch: 12, Steps: 8 | Train Loss: 0.094 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.7973132133483887
Epoch: 13, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.575 Vali Acc: 0.834 Test Loss: 0.575 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5383217334747314
Epoch: 14, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6729271411895752
Epoch: 15, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7413513660430908
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.629 Vali Acc: 0.859 Test Loss: 0.629 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859369).  Saving model ...
Epoch: 17 cost time: 0.6467852592468262
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7499258518218994
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.599 Vali Acc: 0.856 Test Loss: 0.599 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6593868732452393
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6621873378753662
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.623 Vali Acc: 0.834 Test Loss: 0.623 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0035300254821777
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.841 Test Loss: 0.637 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7056975364685059
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7440810203552246
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.699329137802124
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.847 Test Loss: 0.642 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5626883506774902
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.847 Test Loss: 0.655 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.660198450088501
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.658 Vali Acc: 0.844 Test Loss: 0.658 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 36658184
model size : 154.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4559030532836914
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.034 Vali Acc: 0.256 Test Loss: 2.034 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 1.159456729888916
Epoch: 2, Steps: 8 | Train Loss: 1.977 Vali Loss: 1.730 Vali Acc: 0.613 Test Loss: 1.730 Test Acc: 0.613
Validation loss decreased (-0.256230 --> -0.612483).  Saving model ...
Epoch: 3 cost time: 0.7320318222045898
Epoch: 3, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.359 Vali Acc: 0.781 Test Loss: 1.359 Test Acc: 0.781
Validation loss decreased (-0.612483 --> -0.781236).  Saving model ...
Epoch: 4 cost time: 0.9416911602020264
Epoch: 4, Steps: 8 | Train Loss: 1.224 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7108519077301025
Epoch: 5, Steps: 8 | Train Loss: 0.797 Vali Loss: 0.661 Vali Acc: 0.812 Test Loss: 0.661 Test Acc: 0.812
Validation loss decreased (-0.781236 --> -0.812493).  Saving model ...
Epoch: 6 cost time: 0.8784453868865967
Epoch: 6, Steps: 8 | Train Loss: 0.525 Vali Loss: 0.561 Vali Acc: 0.838 Test Loss: 0.561 Test Acc: 0.838
Validation loss decreased (-0.812493 --> -0.837494).  Saving model ...
Epoch: 7 cost time: 1.1166431903839111
Epoch: 7, Steps: 8 | Train Loss: 0.393 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8241891860961914
Epoch: 8, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9690139293670654
Epoch: 9, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.658 Vali Acc: 0.831 Test Loss: 0.658 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9289326667785645
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.680 Vali Acc: 0.825 Test Loss: 0.680 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0681703090667725
Epoch: 11, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.730 Vali Acc: 0.828 Test Loss: 0.730 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8492810726165771
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
Validation loss decreased (-0.837494 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.9721500873565674
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.760 Vali Acc: 0.847 Test Loss: 0.760 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0192499160766602
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.864 Vali Acc: 0.825 Test Loss: 0.864 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0429306030273438
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.793 Vali Acc: 0.841 Test Loss: 0.793 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1610784530639648
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.856243).  Saving model ...
Epoch: 17 cost time: 0.6967871189117432
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.739 Vali Acc: 0.872 Test Loss: 0.739 Test Acc: 0.872
Validation loss decreased (-0.856243 --> -0.871868).  Saving model ...
Epoch: 18 cost time: 0.8742105960845947
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.866 Test Loss: 0.756 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8667936325073242
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.863 Test Loss: 0.778 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8360998630523682
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.778 Vali Acc: 0.859 Test Loss: 0.778 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7689104080200195
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.859 Test Loss: 0.776 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7298698425292969
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.802 Vali Acc: 0.856 Test Loss: 0.802 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7465941905975342
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.866 Test Loss: 0.816 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.685279130935669
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.863 Test Loss: 0.835 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7069442272186279
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.850 Test Loss: 0.843 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0802288055419922
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.859 Test Loss: 0.847 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.070035457611084
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.866 Test Loss: 0.842 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 36805640
model size : 155.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.308154821395874
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 2.092 Vali Acc: 0.166 Test Loss: 2.092 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 0.6039445400238037
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.880 Vali Acc: 0.487 Test Loss: 1.880 Test Acc: 0.487
Validation loss decreased (-0.165604 --> -0.487481).  Saving model ...
Epoch: 3 cost time: 0.7196159362792969
Epoch: 3, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.630 Vali Acc: 0.722 Test Loss: 1.630 Test Acc: 0.722
Validation loss decreased (-0.487481 --> -0.721859).  Saving model ...
Epoch: 4 cost time: 0.7883551120758057
Epoch: 4, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.316 Vali Acc: 0.784 Test Loss: 1.316 Test Acc: 0.784
Validation loss decreased (-0.721859 --> -0.784362).  Saving model ...
Epoch: 5 cost time: 0.7775881290435791
Epoch: 5, Steps: 8 | Train Loss: 1.155 Vali Loss: 0.975 Vali Acc: 0.806 Test Loss: 0.975 Test Acc: 0.806
Validation loss decreased (-0.784362 --> -0.806240).  Saving model ...
Epoch: 6 cost time: 0.6504471302032471
Epoch: 6, Steps: 8 | Train Loss: 0.821 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
Validation loss decreased (-0.806240 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 0.8312070369720459
Epoch: 7, Steps: 8 | Train Loss: 0.552 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.821868 --> -0.821869).  Saving model ...
Epoch: 8 cost time: 0.5940742492675781
Epoch: 8, Steps: 8 | Train Loss: 0.377 Vali Loss: 0.483 Vali Acc: 0.834 Test Loss: 0.483 Test Acc: 0.834
Validation loss decreased (-0.821869 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 0.7152080535888672
Epoch: 9, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7649316787719727
Epoch: 10, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 11 cost time: 0.7864398956298828
Epoch: 11, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8926732540130615
Epoch: 12, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.581 Vali Acc: 0.847 Test Loss: 0.581 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8224499225616455
Epoch: 13, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.619 Vali Acc: 0.847 Test Loss: 0.619 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6422042846679688
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6657595634460449
Epoch: 15, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.617 Vali Acc: 0.853 Test Loss: 0.617 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 16 cost time: 0.6624114513397217
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.679 Vali Acc: 0.847 Test Loss: 0.679 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7360022068023682
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.726 Vali Acc: 0.844 Test Loss: 0.726 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6912064552307129
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.671 Vali Acc: 0.853 Test Loss: 0.671 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6805539131164551
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.869 Test Loss: 0.627 Test Acc: 0.869
Validation loss decreased (-0.853119 --> -0.868744).  Saving model ...
Epoch: 20 cost time: 0.6938328742980957
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.642 Vali Acc: 0.863 Test Loss: 0.642 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8247015476226807
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.672 Vali Acc: 0.866 Test Loss: 0.672 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7682504653930664
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.859 Test Loss: 0.690 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8928499221801758
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.863 Test Loss: 0.682 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7857189178466797
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.685 Vali Acc: 0.859 Test Loss: 0.685 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7642202377319336
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.866 Test Loss: 0.703 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6570453643798828
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.866 Test Loss: 0.714 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.677586555480957
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.866 Test Loss: 0.727 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9411718845367432
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.866 Test Loss: 0.733 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8278913497924805
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.863 Test Loss: 0.739 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 36736520
model size : 154.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.320319414138794
Epoch: 1, Steps: 8 | Train Loss: 2.178 Vali Loss: 2.079 Vali Acc: 0.072 Test Loss: 2.079 Test Acc: 0.072
Validation loss decreased (inf --> -0.071854).  Saving model ...
Epoch: 2 cost time: 0.6829953193664551
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.911 Vali Acc: 0.356 Test Loss: 1.911 Test Acc: 0.356
Validation loss decreased (-0.071854 --> -0.356231).  Saving model ...
Epoch: 3 cost time: 0.5799953937530518
Epoch: 3, Steps: 8 | Train Loss: 1.849 Vali Loss: 1.706 Vali Acc: 0.672 Test Loss: 1.706 Test Acc: 0.672
Validation loss decreased (-0.356231 --> -0.671858).  Saving model ...
Epoch: 4 cost time: 0.6885883808135986
Epoch: 4, Steps: 8 | Train Loss: 1.632 Vali Loss: 1.467 Vali Acc: 0.725 Test Loss: 1.467 Test Acc: 0.725
Validation loss decreased (-0.671858 --> -0.724985).  Saving model ...
Epoch: 5 cost time: 0.5790829658508301
Epoch: 5, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.187 Vali Acc: 0.741 Test Loss: 1.187 Test Acc: 0.741
Validation loss decreased (-0.724985 --> -0.740613).  Saving model ...
Epoch: 6 cost time: 0.5625135898590088
Epoch: 6, Steps: 8 | Train Loss: 1.084 Vali Loss: 0.911 Vali Acc: 0.794 Test Loss: 0.911 Test Acc: 0.794
Validation loss decreased (-0.740613 --> -0.793741).  Saving model ...
Epoch: 7 cost time: 0.6262359619140625
Epoch: 7, Steps: 8 | Train Loss: 0.840 Vali Loss: 0.718 Vali Acc: 0.791 Test Loss: 0.718 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6693060398101807
Epoch: 8, Steps: 8 | Train Loss: 0.615 Vali Loss: 0.626 Vali Acc: 0.797 Test Loss: 0.626 Test Acc: 0.797
Validation loss decreased (-0.793741 --> -0.796869).  Saving model ...
Epoch: 9 cost time: 1.0005264282226562
Epoch: 9, Steps: 8 | Train Loss: 0.415 Vali Loss: 0.569 Vali Acc: 0.806 Test Loss: 0.569 Test Acc: 0.806
Validation loss decreased (-0.796869 --> -0.806244).  Saving model ...
Epoch: 10 cost time: 0.5971319675445557
Epoch: 10, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.566 Vali Acc: 0.812 Test Loss: 0.566 Test Acc: 0.812
Validation loss decreased (-0.806244 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 0.6864676475524902
Epoch: 11, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831245).  Saving model ...
Epoch: 12 cost time: 0.7490172386169434
Epoch: 12, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.550 Vali Acc: 0.844 Test Loss: 0.550 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843744).  Saving model ...
Epoch: 13 cost time: 0.7196497917175293
Epoch: 13, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.619760274887085
Epoch: 14, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 15 cost time: 0.6507787704467773
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.599 Vali Acc: 0.853 Test Loss: 0.599 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853119).  Saving model ...
Epoch: 16 cost time: 0.6647253036499023
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.636 Vali Acc: 0.841 Test Loss: 0.636 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.721226692199707
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.650 Vali Acc: 0.838 Test Loss: 0.650 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7591032981872559
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.681 Vali Acc: 0.828 Test Loss: 0.681 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8179826736450195
Epoch: 19, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.682 Vali Acc: 0.853 Test Loss: 0.682 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6418938636779785
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.670 Vali Acc: 0.834 Test Loss: 0.670 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7433497905731201
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.663 Vali Acc: 0.841 Test Loss: 0.663 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6330642700195312
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.670 Vali Acc: 0.847 Test Loss: 0.670 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7021162509918213
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.681 Vali Acc: 0.853 Test Loss: 0.681 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7183454036712646
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6025738716125488
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.688 Vali Acc: 0.847 Test Loss: 0.688 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 36698120
model size : 154.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2390248775482178
Epoch: 1, Steps: 8 | Train Loss: 2.177 Vali Loss: 1.989 Vali Acc: 0.253 Test Loss: 1.989 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 0.6825277805328369
Epoch: 2, Steps: 8 | Train Loss: 1.926 Vali Loss: 1.708 Vali Acc: 0.616 Test Loss: 1.708 Test Acc: 0.616
Validation loss decreased (-0.253105 --> -0.615608).  Saving model ...
Epoch: 3 cost time: 0.7201671600341797
Epoch: 3, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.367 Vali Acc: 0.725 Test Loss: 1.367 Test Acc: 0.725
Validation loss decreased (-0.615608 --> -0.724986).  Saving model ...
Epoch: 4 cost time: 0.7478296756744385
Epoch: 4, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.017 Vali Acc: 0.778 Test Loss: 1.017 Test Acc: 0.778
Validation loss decreased (-0.724986 --> -0.778115).  Saving model ...
Epoch: 5 cost time: 0.6471025943756104
Epoch: 5, Steps: 8 | Train Loss: 0.891 Vali Loss: 0.717 Vali Acc: 0.791 Test Loss: 0.717 Test Acc: 0.791
Validation loss decreased (-0.778115 --> -0.790618).  Saving model ...
Epoch: 6 cost time: 0.7094204425811768
Epoch: 6, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.790618 --> -0.803120).  Saving model ...
Epoch: 7 cost time: 0.9451298713684082
Epoch: 7, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
Validation loss decreased (-0.803120 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 1.1085631847381592
Epoch: 8, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.6937086582183838
Epoch: 9, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.612 Vali Acc: 0.838 Test Loss: 0.612 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9160528182983398
Epoch: 10, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.556 Vali Acc: 0.853 Test Loss: 0.556 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853119).  Saving model ...
Epoch: 11 cost time: 0.915306806564331
Epoch: 11, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.643 Vali Acc: 0.859 Test Loss: 0.643 Test Acc: 0.859
Validation loss decreased (-0.853119 --> -0.859369).  Saving model ...
Epoch: 12 cost time: 0.8478593826293945
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.738 Vali Acc: 0.850 Test Loss: 0.738 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9009242057800293
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.788 Vali Acc: 0.834 Test Loss: 0.788 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8608412742614746
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.739 Vali Acc: 0.856 Test Loss: 0.739 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7229635715484619
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.721 Vali Acc: 0.863 Test Loss: 0.721 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862493).  Saving model ...
Epoch: 16 cost time: 0.8407983779907227
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.799 Vali Acc: 0.847 Test Loss: 0.799 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7766575813293457
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.800 Vali Acc: 0.844 Test Loss: 0.800 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7975616455078125
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.878 Test Loss: 0.691 Test Acc: 0.878
Validation loss decreased (-0.862493 --> -0.878118).  Saving model ...
Epoch: 19 cost time: 0.8055670261383057
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.878 Test Loss: 0.715 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6635382175445557
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.859 Test Loss: 0.791 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.891303539276123
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.858 Vali Acc: 0.841 Test Loss: 0.858 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8064863681793213
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.856 Vali Acc: 0.850 Test Loss: 0.856 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7974405288696289
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.847 Test Loss: 0.868 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0694200992584229
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.868 Vali Acc: 0.847 Test Loss: 0.868 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8941628932952881
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.850 Test Loss: 0.866 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.252274513244629
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.856 Test Loss: 0.840 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8768715858459473
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.859 Test Loss: 0.821 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9651620388031006
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.859 Test Loss: 0.810 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 36851720
model size : 155.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4696028232574463
Epoch: 1, Steps: 8 | Train Loss: 2.323 Vali Loss: 2.104 Vali Acc: 0.191 Test Loss: 2.104 Test Acc: 0.191
Validation loss decreased (inf --> -0.190604).  Saving model ...
Epoch: 2 cost time: 0.8555059432983398
Epoch: 2, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.849 Vali Acc: 0.425 Test Loss: 1.849 Test Acc: 0.425
Validation loss decreased (-0.190604 --> -0.424982).  Saving model ...
Epoch: 3 cost time: 0.7325758934020996
Epoch: 3, Steps: 8 | Train Loss: 1.768 Vali Loss: 1.568 Vali Acc: 0.694 Test Loss: 1.568 Test Acc: 0.694
Validation loss decreased (-0.424982 --> -0.693734).  Saving model ...
Epoch: 4 cost time: 0.7527518272399902
Epoch: 4, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.253 Vali Acc: 0.766 Test Loss: 1.253 Test Acc: 0.766
Validation loss decreased (-0.693734 --> -0.765612).  Saving model ...
Epoch: 5 cost time: 0.707101583480835
Epoch: 5, Steps: 8 | Train Loss: 1.159 Vali Loss: 0.925 Vali Acc: 0.803 Test Loss: 0.925 Test Acc: 0.803
Validation loss decreased (-0.765612 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 0.7069394588470459
Epoch: 6, Steps: 8 | Train Loss: 0.836 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 0.7020578384399414
Epoch: 7, Steps: 8 | Train Loss: 0.591 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.7040131092071533
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7813713550567627
Epoch: 9, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.492 Vali Acc: 0.847 Test Loss: 0.492 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.5438358783721924
Epoch: 10, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5176031589508057
Epoch: 11, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.544 Vali Acc: 0.847 Test Loss: 0.544 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7133171558380127
Epoch: 12, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 0.5900747776031494
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.553 Vali Acc: 0.859 Test Loss: 0.553 Test Acc: 0.859
Validation loss decreased (-0.849994 --> -0.859369).  Saving model ...
Epoch: 14 cost time: 0.7044017314910889
Epoch: 14, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.586 Vali Acc: 0.863 Test Loss: 0.586 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 15 cost time: 0.6655158996582031
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.597 Vali Acc: 0.853 Test Loss: 0.597 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.634690523147583
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.863 Test Loss: 0.631 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.523421049118042
Epoch: 17, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.657 Vali Acc: 0.859 Test Loss: 0.657 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.541628360748291
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6050941944122314
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.629 Vali Acc: 0.853 Test Loss: 0.629 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5386667251586914
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.690 Vali Acc: 0.856 Test Loss: 0.690 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6061010360717773
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6603083610534668
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.856 Test Loss: 0.670 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5522527694702148
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5549511909484863
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.859 Test Loss: 0.687 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 36790280
model size : 155.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9565496444702148
Epoch: 1, Steps: 8 | Train Loss: 2.229 Vali Loss: 2.112 Vali Acc: 0.141 Test Loss: 2.112 Test Acc: 0.141
Validation loss decreased (inf --> -0.140604).  Saving model ...
Epoch: 2 cost time: 0.6616613864898682
Epoch: 2, Steps: 8 | Train Loss: 2.076 Vali Loss: 1.946 Vali Acc: 0.294 Test Loss: 1.946 Test Acc: 0.294
Validation loss decreased (-0.140604 --> -0.293731).  Saving model ...
Epoch: 3 cost time: 0.634465217590332
Epoch: 3, Steps: 8 | Train Loss: 1.915 Vali Loss: 1.748 Vali Acc: 0.600 Test Loss: 1.748 Test Acc: 0.600
Validation loss decreased (-0.293731 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 0.7751007080078125
Epoch: 4, Steps: 8 | Train Loss: 1.690 Vali Loss: 1.531 Vali Acc: 0.750 Test Loss: 1.531 Test Acc: 0.750
Validation loss decreased (-0.599983 --> -0.749985).  Saving model ...
Epoch: 5 cost time: 0.5877153873443604
Epoch: 5, Steps: 8 | Train Loss: 1.445 Vali Loss: 1.270 Vali Acc: 0.791 Test Loss: 1.270 Test Acc: 0.791
Validation loss decreased (-0.749985 --> -0.790612).  Saving model ...
Epoch: 6 cost time: 0.709683895111084
Epoch: 6, Steps: 8 | Train Loss: 1.200 Vali Loss: 0.979 Vali Acc: 0.806 Test Loss: 0.979 Test Acc: 0.806
Validation loss decreased (-0.790612 --> -0.806240).  Saving model ...
Epoch: 7 cost time: 0.6609854698181152
Epoch: 7, Steps: 8 | Train Loss: 0.889 Vali Loss: 0.715 Vali Acc: 0.841 Test Loss: 0.715 Test Acc: 0.841
Validation loss decreased (-0.806240 --> -0.840618).  Saving model ...
Epoch: 8 cost time: 0.7211503982543945
Epoch: 8, Steps: 8 | Train Loss: 0.629 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
Validation loss decreased (-0.840618 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 0.7306547164916992
Epoch: 9, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.496 Vali Acc: 0.844 Test Loss: 0.496 Test Acc: 0.844
Validation loss decreased (-0.843744 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 0.6589643955230713
Epoch: 10, Steps: 8 | Train Loss: 0.331 Vali Loss: 0.462 Vali Acc: 0.853 Test Loss: 0.462 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.7003343105316162
Epoch: 11, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.477 Vali Acc: 0.834 Test Loss: 0.477 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7037992477416992
Epoch: 12, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7147922515869141
Epoch: 13, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6850061416625977
Epoch: 14, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 15 cost time: 0.6357624530792236
Epoch: 15, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7593920230865479
Epoch: 16, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.512 Vali Acc: 0.859 Test Loss: 0.512 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 17 cost time: 0.6022686958312988
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6506874561309814
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.532 Vali Acc: 0.866 Test Loss: 0.532 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865620).  Saving model ...
Epoch: 19 cost time: 0.7158918380737305
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.544 Vali Acc: 0.863 Test Loss: 0.544 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7652974128723145
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.555 Vali Acc: 0.863 Test Loss: 0.555 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6989738941192627
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.583 Vali Acc: 0.853 Test Loss: 0.583 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7226688861846924
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5997540950775146
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.866 Test Loss: 0.589 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6712391376495361
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.610 Vali Acc: 0.859 Test Loss: 0.610 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7198476791381836
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5993251800537109
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6410536766052246
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.863 Test Loss: 0.624 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7048335075378418
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.859 Test Loss: 0.625 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el5_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 36767240
model size : 154.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.728567361831665
Epoch: 1, Steps: 8 | Train Loss: 2.194 Vali Loss: 1.856 Vali Acc: 0.391 Test Loss: 1.856 Test Acc: 0.391
Validation loss decreased (inf --> -0.390606).  Saving model ...
Epoch: 2 cost time: 0.9144673347473145
Epoch: 2, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.225 Vali Acc: 0.694 Test Loss: 1.225 Test Acc: 0.694
Validation loss decreased (-0.390606 --> -0.693738).  Saving model ...
Epoch: 3 cost time: 1.0224337577819824
Epoch: 3, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.754 Vali Acc: 0.784 Test Loss: 0.754 Test Acc: 0.784
Validation loss decreased (-0.693738 --> -0.784367).  Saving model ...
Epoch: 4 cost time: 1.1100482940673828
Epoch: 4, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.784367 --> -0.821869).  Saving model ...
Epoch: 5 cost time: 1.0603272914886475
Epoch: 5, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 6 cost time: 0.8992221355438232
Epoch: 6, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.828120 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.8096837997436523
Epoch: 7, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.638 Vali Acc: 0.831 Test Loss: 0.638 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0293328762054443
Epoch: 8, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843742).  Saving model ...
Epoch: 9 cost time: 0.9664113521575928
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.869 Vali Acc: 0.838 Test Loss: 0.869 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2702038288116455
Epoch: 10, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.010 Vali Acc: 0.834 Test Loss: 1.010 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2781291007995605
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.368 Vali Acc: 0.812 Test Loss: 1.368 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1381454467773438
Epoch: 12, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.266 Vali Acc: 0.838 Test Loss: 1.266 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2595691680908203
Epoch: 13, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.334 Vali Acc: 0.844 Test Loss: 1.334 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7723054885864258
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.550 Vali Acc: 0.828 Test Loss: 1.550 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0596797466278076
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.907 Vali Acc: 0.803 Test Loss: 1.907 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0508809089660645
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.839 Vali Acc: 0.794 Test Loss: 1.839 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8180296421051025
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.039 Vali Acc: 0.806 Test Loss: 2.039 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3437767028808594
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.153 Vali Acc: 0.819 Test Loss: 2.153 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.84375
model parameter : 29879048
model size : 128.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.376699686050415
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 1.962 Vali Acc: 0.312 Test Loss: 1.962 Test Acc: 0.312
Validation loss decreased (inf --> -0.312480).  Saving model ...
Epoch: 2 cost time: 0.7183358669281006
Epoch: 2, Steps: 8 | Train Loss: 1.809 Vali Loss: 1.500 Vali Acc: 0.706 Test Loss: 1.500 Test Acc: 0.706
Validation loss decreased (-0.312480 --> -0.706235).  Saving model ...
Epoch: 3 cost time: 0.9634912014007568
Epoch: 3, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.044 Vali Acc: 0.762 Test Loss: 1.044 Test Acc: 0.762
Validation loss decreased (-0.706235 --> -0.762490).  Saving model ...
Epoch: 4 cost time: 0.9468684196472168
Epoch: 4, Steps: 8 | Train Loss: 0.805 Vali Loss: 0.717 Vali Acc: 0.812 Test Loss: 0.717 Test Acc: 0.812
Validation loss decreased (-0.762490 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 1.0754022598266602
Epoch: 5, Steps: 8 | Train Loss: 0.490 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
Validation loss decreased (-0.812493 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.8134090900421143
Epoch: 6, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0366382598876953
Epoch: 7, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.571 Vali Acc: 0.831 Test Loss: 0.571 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9866220951080322
Epoch: 8, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.564 Vali Acc: 0.853 Test Loss: 0.564 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853119).  Saving model ...
Epoch: 9 cost time: 1.3232853412628174
Epoch: 9, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4180948734283447
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.920 Vali Acc: 0.831 Test Loss: 0.920 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8065931797027588
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.983 Vali Acc: 0.822 Test Loss: 0.983 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.08260178565979
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.079 Vali Acc: 0.841 Test Loss: 1.079 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0892319679260254
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.166 Vali Acc: 0.812 Test Loss: 1.166 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6314504146575928
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.382 Vali Acc: 0.816 Test Loss: 1.382 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3212242126464844
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.266 Vali Acc: 0.819 Test Loss: 1.266 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0788633823394775
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.119 Vali Acc: 0.850 Test Loss: 1.119 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1276307106018066
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.875 Test Loss: 1.042 Test Acc: 0.875
Validation loss decreased (-0.853119 --> -0.874990).  Saving model ...
Epoch: 18 cost time: 0.8915526866912842
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.866 Test Loss: 1.097 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7184665203094482
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.218 Vali Acc: 0.844 Test Loss: 1.218 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.654010534286499
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.253 Vali Acc: 0.844 Test Loss: 1.253 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6509695053100586
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.841 Test Loss: 1.236 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6680562496185303
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.233 Vali Acc: 0.844 Test Loss: 1.233 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6988513469696045
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.841 Test Loss: 1.250 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0009477138519287
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.841 Test Loss: 1.249 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8711297512054443
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.847 Test Loss: 1.236 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0206871032714844
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.844 Test Loss: 1.214 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9951629638671875
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.226 Vali Acc: 0.844 Test Loss: 1.226 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29633288
model size : 127.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0961389541625977
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 2.039 Vali Acc: 0.231 Test Loss: 2.039 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.709967851638794
Epoch: 2, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.717 Vali Acc: 0.572 Test Loss: 1.717 Test Acc: 0.572
Validation loss decreased (-0.231230 --> -0.571858).  Saving model ...
Epoch: 3 cost time: 0.7849383354187012
Epoch: 3, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.327 Vali Acc: 0.728 Test Loss: 1.327 Test Acc: 0.728
Validation loss decreased (-0.571858 --> -0.728112).  Saving model ...
Epoch: 4 cost time: 0.8285493850708008
Epoch: 4, Steps: 8 | Train Loss: 1.187 Vali Loss: 0.973 Vali Acc: 0.787 Test Loss: 0.973 Test Acc: 0.787
Validation loss decreased (-0.728112 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 0.7657372951507568
Epoch: 5, Steps: 8 | Train Loss: 0.791 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
Validation loss decreased (-0.787490 --> -0.796868).  Saving model ...
Epoch: 6 cost time: 0.8258054256439209
Epoch: 6, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.532 Vali Acc: 0.828 Test Loss: 0.532 Test Acc: 0.828
Validation loss decreased (-0.796868 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.7479276657104492
Epoch: 7, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.503 Vali Acc: 0.812 Test Loss: 0.503 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6681418418884277
Epoch: 8, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.828120 --> -0.859370).  Saving model ...
Epoch: 9 cost time: 0.7412595748901367
Epoch: 9, Steps: 8 | Train Loss: 0.187 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6355502605438232
Epoch: 10, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7591960430145264
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.659 Vali Acc: 0.847 Test Loss: 0.659 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7064306735992432
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.759 Vali Acc: 0.825 Test Loss: 0.759 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5867972373962402
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.807 Vali Acc: 0.847 Test Loss: 0.807 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7008771896362305
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.816 Vali Acc: 0.856 Test Loss: 0.816 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.779559850692749
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8333489894866943
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.952 Vali Acc: 0.834 Test Loss: 0.952 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9256246089935303
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.852 Vali Acc: 0.847 Test Loss: 0.852 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.825066089630127
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.962 Vali Acc: 0.856 Test Loss: 0.962 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 29479688
model size : 127.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.529425621032715
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 1.840 Vali Acc: 0.447 Test Loss: 1.840 Test Acc: 0.447
Validation loss decreased (inf --> -0.446857).  Saving model ...
Epoch: 2 cost time: 1.176346778869629
Epoch: 2, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.166 Vali Acc: 0.719 Test Loss: 1.166 Test Acc: 0.719
Validation loss decreased (-0.446857 --> -0.718738).  Saving model ...
Epoch: 3 cost time: 1.1495568752288818
Epoch: 3, Steps: 8 | Train Loss: 0.943 Vali Loss: 0.697 Vali Acc: 0.806 Test Loss: 0.697 Test Acc: 0.806
Validation loss decreased (-0.718738 --> -0.806243).  Saving model ...
Epoch: 4 cost time: 1.124664306640625
Epoch: 4, Steps: 8 | Train Loss: 0.542 Vali Loss: 0.497 Vali Acc: 0.831 Test Loss: 0.497 Test Acc: 0.831
Validation loss decreased (-0.806243 --> -0.831245).  Saving model ...
Epoch: 5 cost time: 0.999424934387207
Epoch: 5, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.526 Vali Acc: 0.859 Test Loss: 0.526 Test Acc: 0.859
Validation loss decreased (-0.831245 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 1.2757830619812012
Epoch: 6, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.534 Vali Acc: 0.806 Test Loss: 0.534 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2476582527160645
Epoch: 7, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3440494537353516
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.644 Vali Acc: 0.853 Test Loss: 0.644 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1521008014678955
Epoch: 9, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.797 Vali Acc: 0.847 Test Loss: 0.797 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3369393348693848
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.961 Vali Acc: 0.859 Test Loss: 0.961 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.232536792755127
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.058 Vali Acc: 0.844 Test Loss: 1.058 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.472752571105957
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.207 Vali Acc: 0.844 Test Loss: 1.207 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3175430297851562
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.168 Vali Acc: 0.838 Test Loss: 1.168 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9660112857818604
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.447 Vali Acc: 0.825 Test Loss: 1.447 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9942829608917236
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.172 Vali Acc: 0.831 Test Loss: 1.172 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 29885960
model size : 128.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.040952205657959
Epoch: 1, Steps: 8 | Train Loss: 2.085 Vali Loss: 1.900 Vali Acc: 0.353 Test Loss: 1.900 Test Acc: 0.353
Validation loss decreased (inf --> -0.353106).  Saving model ...
Epoch: 2 cost time: 1.1404352188110352
Epoch: 2, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.404 Vali Acc: 0.703 Test Loss: 1.404 Test Acc: 0.703
Validation loss decreased (-0.353106 --> -0.703111).  Saving model ...
Epoch: 3 cost time: 1.0949251651763916
Epoch: 3, Steps: 8 | Train Loss: 1.242 Vali Loss: 0.918 Vali Acc: 0.800 Test Loss: 0.918 Test Acc: 0.800
Validation loss decreased (-0.703111 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 1.1341750621795654
Epoch: 4, Steps: 8 | Train Loss: 0.788 Vali Loss: 0.624 Vali Acc: 0.847 Test Loss: 0.624 Test Acc: 0.847
Validation loss decreased (-0.799991 --> -0.846869).  Saving model ...
Epoch: 5 cost time: 1.0362021923065186
Epoch: 5, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.038388729095459
Epoch: 6, Steps: 8 | Train Loss: 0.345 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 1.0647528171539307
Epoch: 7, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.01387619972229
Epoch: 8, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7667737007141113
Epoch: 9, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.711 Vali Acc: 0.853 Test Loss: 0.711 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853118).  Saving model ...
Epoch: 10 cost time: 0.9740238189697266
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856242).  Saving model ...
Epoch: 11 cost time: 1.0337176322937012
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.913 Vali Acc: 0.838 Test Loss: 0.913 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8731915950775146
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.904 Vali Acc: 0.844 Test Loss: 0.904 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9090311527252197
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.871 Vali Acc: 0.850 Test Loss: 0.871 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8134052753448486
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.963 Vali Acc: 0.859 Test Loss: 0.963 Test Acc: 0.859
Validation loss decreased (-0.856242 --> -0.859365).  Saving model ...
Epoch: 15 cost time: 0.7408425807952881
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.079 Vali Acc: 0.850 Test Loss: 1.079 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6977455615997314
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.148 Vali Acc: 0.834 Test Loss: 1.148 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.676098108291626
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.123 Vali Acc: 0.838 Test Loss: 1.123 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7923266887664795
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.859 Test Loss: 1.106 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8630728721618652
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.863 Test Loss: 1.106 Test Acc: 0.863
Validation loss decreased (-0.859365 --> -0.862489).  Saving model ...
Epoch: 20 cost time: 0.9527485370635986
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.850 Test Loss: 1.104 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7520225048065186
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.112 Vali Acc: 0.850 Test Loss: 1.112 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8275570869445801
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.850 Test Loss: 1.142 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9228048324584961
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.853 Test Loss: 1.140 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0119333267211914
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.856 Test Loss: 1.097 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8045608997344971
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.856 Test Loss: 1.079 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9689922332763672
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.128 Vali Acc: 0.853 Test Loss: 1.128 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9835364818572998
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.159 Vali Acc: 0.847 Test Loss: 1.159 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9245901107788086
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.850 Test Loss: 1.167 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9266073703765869
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.847 Test Loss: 1.168 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29640200
model size : 127.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.775003433227539
Epoch: 1, Steps: 8 | Train Loss: 2.182 Vali Loss: 1.988 Vali Acc: 0.284 Test Loss: 1.988 Test Acc: 0.284
Validation loss decreased (inf --> -0.284355).  Saving model ...
Epoch: 2 cost time: 1.1234118938446045
Epoch: 2, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.686 Vali Acc: 0.616 Test Loss: 1.686 Test Acc: 0.616
Validation loss decreased (-0.284355 --> -0.615608).  Saving model ...
Epoch: 3 cost time: 0.8614013195037842
Epoch: 3, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.295 Vali Acc: 0.766 Test Loss: 1.295 Test Acc: 0.766
Validation loss decreased (-0.615608 --> -0.765612).  Saving model ...
Epoch: 4 cost time: 1.0781800746917725
Epoch: 4, Steps: 8 | Train Loss: 1.168 Vali Loss: 0.920 Vali Acc: 0.831 Test Loss: 0.920 Test Acc: 0.831
Validation loss decreased (-0.765612 --> -0.831241).  Saving model ...
Epoch: 5 cost time: 0.8012371063232422
Epoch: 5, Steps: 8 | Train Loss: 0.794 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1825764179229736
Epoch: 6, Steps: 8 | Train Loss: 0.593 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.085007905960083
Epoch: 7, Steps: 8 | Train Loss: 0.416 Vali Loss: 0.440 Vali Acc: 0.838 Test Loss: 0.440 Test Acc: 0.838
Validation loss decreased (-0.831241 --> -0.837496).  Saving model ...
Epoch: 8 cost time: 0.7037088871002197
Epoch: 8, Steps: 8 | Train Loss: 0.258 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
Validation loss decreased (-0.837496 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.9069514274597168
Epoch: 9, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.535 Vali Acc: 0.863 Test Loss: 0.535 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 10 cost time: 0.6933293342590332
Epoch: 10, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9263112545013428
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.674 Vali Acc: 0.859 Test Loss: 0.674 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.792832612991333
Epoch: 12, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.632 Vali Acc: 0.869 Test Loss: 0.632 Test Acc: 0.869
Validation loss decreased (-0.862495 --> -0.868744).  Saving model ...
Epoch: 13 cost time: 1.1752686500549316
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.762 Vali Acc: 0.834 Test Loss: 0.762 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0594367980957031
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.730 Vali Acc: 0.853 Test Loss: 0.730 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2488529682159424
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.687 Vali Acc: 0.869 Test Loss: 0.687 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1021380424499512
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.731 Vali Acc: 0.875 Test Loss: 0.731 Test Acc: 0.875
Validation loss decreased (-0.868744 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.9498987197875977
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.816 Vali Acc: 0.866 Test Loss: 0.816 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9289047718048096
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.882 Vali Acc: 0.856 Test Loss: 0.882 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5722959041595459
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.868 Vali Acc: 0.866 Test Loss: 0.868 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6624484062194824
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.798 Vali Acc: 0.875 Test Loss: 0.798 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9607985019683838
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.875 Test Loss: 0.847 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.954056978225708
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.866 Test Loss: 0.855 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9198768138885498
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.863 Test Loss: 0.839 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.158336877822876
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.869 Test Loss: 0.835 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.065605878829956
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.869 Test Loss: 0.825 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1745843887329102
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.869 Test Loss: 0.836 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29471240
model size : 127.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.656754970550537
Epoch: 1, Steps: 8 | Train Loss: 2.172 Vali Loss: 1.897 Vali Acc: 0.375 Test Loss: 1.897 Test Acc: 0.375
Validation loss decreased (inf --> -0.374981).  Saving model ...
Epoch: 2 cost time: 1.2114109992980957
Epoch: 2, Steps: 8 | Train Loss: 1.669 Vali Loss: 1.239 Vali Acc: 0.787 Test Loss: 1.239 Test Acc: 0.787
Validation loss decreased (-0.374981 --> -0.787488).  Saving model ...
Epoch: 3 cost time: 1.2763621807098389
Epoch: 3, Steps: 8 | Train Loss: 1.026 Vali Loss: 0.745 Vali Acc: 0.825 Test Loss: 0.745 Test Acc: 0.825
Validation loss decreased (-0.787488 --> -0.824993).  Saving model ...
Epoch: 4 cost time: 1.1366093158721924
Epoch: 4, Steps: 8 | Train Loss: 0.625 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (-0.824993 --> -0.840620).  Saving model ...
Epoch: 5 cost time: 1.3607449531555176
Epoch: 5, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1639456748962402
Epoch: 6, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.615 Vali Acc: 0.831 Test Loss: 0.615 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1786575317382812
Epoch: 7, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.788 Vali Acc: 0.809 Test Loss: 0.788 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3918321132659912
Epoch: 8, Steps: 8 | Train Loss: 0.150 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856243).  Saving model ...
Epoch: 9 cost time: 1.2130844593048096
Epoch: 9, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.924 Vali Acc: 0.825 Test Loss: 0.924 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.190627098083496
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.101 Vali Acc: 0.828 Test Loss: 1.101 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3468608856201172
Epoch: 11, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.005 Vali Acc: 0.822 Test Loss: 1.005 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3850007057189941
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.687 Vali Acc: 0.791 Test Loss: 1.687 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.376060962677002
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.206 Vali Acc: 0.847 Test Loss: 1.206 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9315576553344727
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.489 Vali Acc: 0.834 Test Loss: 1.489 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1672801971435547
Epoch: 15, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.896 Vali Acc: 0.803 Test Loss: 1.896 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2304959297180176
Epoch: 16, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.367 Vali Acc: 0.844 Test Loss: 1.367 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0560176372528076
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.809 Test Loss: 1.503 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9164142608642578
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.586 Vali Acc: 0.828 Test Loss: 1.586 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 29892872
model size : 128.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.863542318344116
Epoch: 1, Steps: 8 | Train Loss: 2.104 Vali Loss: 1.933 Vali Acc: 0.328 Test Loss: 1.933 Test Acc: 0.328
Validation loss decreased (inf --> -0.328106).  Saving model ...
Epoch: 2 cost time: 0.8956010341644287
Epoch: 2, Steps: 8 | Train Loss: 1.838 Vali Loss: 1.507 Vali Acc: 0.684 Test Loss: 1.507 Test Acc: 0.684
Validation loss decreased (-0.328106 --> -0.684360).  Saving model ...
Epoch: 3 cost time: 1.0556068420410156
Epoch: 3, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.048 Vali Acc: 0.791 Test Loss: 1.048 Test Acc: 0.791
Validation loss decreased (-0.684360 --> -0.790615).  Saving model ...
Epoch: 4 cost time: 0.7565603256225586
Epoch: 4, Steps: 8 | Train Loss: 0.908 Vali Loss: 0.701 Vali Acc: 0.819 Test Loss: 0.701 Test Acc: 0.819
Validation loss decreased (-0.790615 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 0.8363301753997803
Epoch: 5, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 0.5851776599884033
Epoch: 6, Steps: 8 | Train Loss: 0.450 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6925876140594482
Epoch: 7, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.7111451625823975
Epoch: 8, Steps: 8 | Train Loss: 0.214 Vali Loss: 0.667 Vali Acc: 0.825 Test Loss: 0.667 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9358170032501221
Epoch: 9, Steps: 8 | Train Loss: 0.120 Vali Loss: 0.694 Vali Acc: 0.841 Test Loss: 0.694 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 0.7448720932006836
Epoch: 10, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.821 Vali Acc: 0.834 Test Loss: 0.821 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1032347679138184
Epoch: 11, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.980 Vali Acc: 0.822 Test Loss: 0.980 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0794169902801514
Epoch: 12, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.938 Vali Acc: 0.838 Test Loss: 0.938 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.203197956085205
Epoch: 13, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.169 Vali Acc: 0.806 Test Loss: 1.169 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7462856769561768
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.005 Vali Acc: 0.850 Test Loss: 1.005 Test Acc: 0.850
Validation loss decreased (-0.840618 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.9861302375793457
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.979 Vali Acc: 0.844 Test Loss: 0.979 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8446614742279053
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.078 Vali Acc: 0.834 Test Loss: 1.078 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.888282060623169
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.214 Vali Acc: 0.822 Test Loss: 1.214 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9318397045135498
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.346 Vali Acc: 0.806 Test Loss: 1.346 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8138666152954102
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.207 Vali Acc: 0.834 Test Loss: 1.207 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9590780735015869
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.853 Test Loss: 1.088 Test Acc: 0.853
Validation loss decreased (-0.849990 --> -0.853114).  Saving model ...
Epoch: 21 cost time: 0.7225077152252197
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.054 Vali Acc: 0.847 Test Loss: 1.054 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6976699829101562
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.066 Vali Acc: 0.859 Test Loss: 1.066 Test Acc: 0.859
Validation loss decreased (-0.853114 --> -0.859364).  Saving model ...
Epoch: 23 cost time: 0.7542598247528076
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.850 Test Loss: 1.090 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6701481342315674
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.856 Test Loss: 1.113 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8173680305480957
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.853 Test Loss: 1.139 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6622047424316406
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.856 Test Loss: 1.139 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6393916606903076
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.859 Test Loss: 1.122 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6423506736755371
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.856 Test Loss: 1.118 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6041672229766846
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.856 Test Loss: 1.127 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0576176643371582
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.138 Vali Acc: 0.856 Test Loss: 1.138 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.922044038772583
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.863 Test Loss: 1.132 Test Acc: 0.863
Validation loss decreased (-0.859364 --> -0.862489).  Saving model ...
Epoch: 32 cost time: 1.1529228687286377
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.120 Vali Acc: 0.859 Test Loss: 1.120 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9545633792877197
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.863 Test Loss: 1.122 Test Acc: 0.863
Validation loss decreased (-0.862489 --> -0.862489).  Saving model ...
Epoch: 34 cost time: 0.9547350406646729
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.863 Test Loss: 1.125 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8679146766662598
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.863 Test Loss: 1.126 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2179350852966309
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.859 Test Loss: 1.121 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.143601894378662
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.863 Test Loss: 1.141 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1614372730255127
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.859 Test Loss: 1.160 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.894397497177124
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.859 Test Loss: 1.158 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0155577659606934
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.156 Vali Acc: 0.863 Test Loss: 1.156 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1780879497528076
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.859 Test Loss: 1.157 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0054664611816406
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.863 Test Loss: 1.153 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2080175876617432
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.863 Test Loss: 1.154 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29601032
model size : 127.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3217406272888184
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 2.002 Vali Acc: 0.191 Test Loss: 2.002 Test Acc: 0.191
Validation loss decreased (inf --> -0.190605).  Saving model ...
Epoch: 2 cost time: 0.7852892875671387
Epoch: 2, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.739 Vali Acc: 0.544 Test Loss: 1.739 Test Acc: 0.544
Validation loss decreased (-0.190605 --> -0.543733).  Saving model ...
Epoch: 3 cost time: 0.8616421222686768
Epoch: 3, Steps: 8 | Train Loss: 1.631 Vali Loss: 1.383 Vali Acc: 0.762 Test Loss: 1.383 Test Acc: 0.762
Validation loss decreased (-0.543733 --> -0.762486).  Saving model ...
Epoch: 4 cost time: 0.6894567012786865
Epoch: 4, Steps: 8 | Train Loss: 1.235 Vali Loss: 0.993 Vali Acc: 0.816 Test Loss: 0.993 Test Acc: 0.816
Validation loss decreased (-0.762486 --> -0.815615).  Saving model ...
Epoch: 5 cost time: 0.8626348972320557
Epoch: 5, Steps: 8 | Train Loss: 0.876 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6465799808502197
Epoch: 6, Steps: 8 | Train Loss: 0.630 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
Validation loss decreased (-0.815615 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.6762740612030029
Epoch: 7, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.6707758903503418
Epoch: 8, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.499 Vali Acc: 0.812 Test Loss: 0.499 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7924997806549072
Epoch: 9, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0527071952819824
Epoch: 10, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.634 Vali Acc: 0.816 Test Loss: 0.634 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6459810733795166
Epoch: 11, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.844916820526123
Epoch: 12, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.654 Vali Acc: 0.847 Test Loss: 0.654 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7751879692077637
Epoch: 13, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.637 Vali Acc: 0.863 Test Loss: 0.637 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862494).  Saving model ...
Epoch: 14 cost time: 0.6944308280944824
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.695 Vali Acc: 0.863 Test Loss: 0.695 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7274336814880371
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.719 Vali Acc: 0.866 Test Loss: 0.719 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865618).  Saving model ...
Epoch: 16 cost time: 0.6778643131256104
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8397176265716553
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.773 Vali Acc: 0.856 Test Loss: 0.773 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6822278499603271
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.942664384841919
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.773 Vali Acc: 0.859 Test Loss: 0.773 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7241778373718262
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.869 Test Loss: 0.800 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868742).  Saving model ...
Epoch: 21 cost time: 1.029024362564087
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.856 Test Loss: 0.842 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9758195877075195
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.863 Test Loss: 0.843 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9231178760528564
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.831 Vali Acc: 0.869 Test Loss: 0.831 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7135930061340332
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.836 Vali Acc: 0.866 Test Loss: 0.836 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9044473171234131
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.853 Test Loss: 0.879 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.660834550857544
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.856 Test Loss: 0.881 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8440425395965576
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.866 Test Loss: 0.896 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8421781063079834
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.866 Test Loss: 0.889 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7580726146697998
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.859 Test Loss: 0.889 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5057213306427002
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.859 Test Loss: 0.836 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 29470472
model size : 127.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0620100498199463
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.836 Vali Acc: 0.425 Test Loss: 1.836 Test Acc: 0.425
Validation loss decreased (inf --> -0.424982).  Saving model ...
Epoch: 2 cost time: 0.9003863334655762
Epoch: 2, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.183 Vali Acc: 0.753 Test Loss: 1.183 Test Acc: 0.753
Validation loss decreased (-0.424982 --> -0.753113).  Saving model ...
Epoch: 3 cost time: 1.0250792503356934
Epoch: 3, Steps: 8 | Train Loss: 0.944 Vali Loss: 0.705 Vali Acc: 0.803 Test Loss: 0.705 Test Acc: 0.803
Validation loss decreased (-0.753113 --> -0.803118).  Saving model ...
Epoch: 4 cost time: 1.1177022457122803
Epoch: 4, Steps: 8 | Train Loss: 0.492 Vali Loss: 0.487 Vali Acc: 0.834 Test Loss: 0.487 Test Acc: 0.834
Validation loss decreased (-0.803118 --> -0.834370).  Saving model ...
Epoch: 5 cost time: 1.0102736949920654
Epoch: 5, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.834370 --> -0.856245).  Saving model ...
Epoch: 6 cost time: 0.790151834487915
Epoch: 6, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.634 Vali Acc: 0.841 Test Loss: 0.634 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0510175228118896
Epoch: 7, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.920 Vali Acc: 0.806 Test Loss: 0.920 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9101450443267822
Epoch: 8, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.883 Vali Acc: 0.847 Test Loss: 0.883 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9747443199157715
Epoch: 9, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.254 Vali Acc: 0.791 Test Loss: 1.254 Test Acc: 0.791
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8766312599182129
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.337 Vali Acc: 0.809 Test Loss: 1.337 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9258530139923096
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.270 Vali Acc: 0.800 Test Loss: 1.270 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.173466444015503
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.226 Vali Acc: 0.841 Test Loss: 1.226 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9460141658782959
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.332 Vali Acc: 0.825 Test Loss: 1.332 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1216542720794678
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.310 Vali Acc: 0.844 Test Loss: 1.310 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1286571025848389
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.437 Vali Acc: 0.847 Test Loss: 1.437 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 29892104
model size : 128.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4564411640167236
Epoch: 1, Steps: 8 | Train Loss: 2.127 Vali Loss: 1.881 Vali Acc: 0.394 Test Loss: 1.881 Test Acc: 0.394
Validation loss decreased (inf --> -0.393731).  Saving model ...
Epoch: 2 cost time: 0.8549008369445801
Epoch: 2, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.478 Vali Acc: 0.641 Test Loss: 1.478 Test Acc: 0.641
Validation loss decreased (-0.393731 --> -0.640610).  Saving model ...
Epoch: 3 cost time: 0.8063387870788574
Epoch: 3, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.014 Vali Acc: 0.797 Test Loss: 1.014 Test Acc: 0.797
Validation loss decreased (-0.640610 --> -0.796865).  Saving model ...
Epoch: 4 cost time: 1.0738976001739502
Epoch: 4, Steps: 8 | Train Loss: 0.847 Vali Loss: 0.667 Vali Acc: 0.834 Test Loss: 0.667 Test Acc: 0.834
Validation loss decreased (-0.796865 --> -0.834368).  Saving model ...
Epoch: 5 cost time: 1.0667624473571777
Epoch: 5, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7648589611053467
Epoch: 6, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.834368 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 1.0075511932373047
Epoch: 7, Steps: 8 | Train Loss: 0.243 Vali Loss: 0.568 Vali Acc: 0.838 Test Loss: 0.568 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8162875175476074
Epoch: 8, Steps: 8 | Train Loss: 0.165 Vali Loss: 0.700 Vali Acc: 0.853 Test Loss: 0.700 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853118).  Saving model ...
Epoch: 9 cost time: 1.0124790668487549
Epoch: 9, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.761 Vali Acc: 0.822 Test Loss: 0.761 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7376787662506104
Epoch: 10, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.710 Vali Acc: 0.863 Test Loss: 0.710 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862493).  Saving model ...
Epoch: 11 cost time: 1.0500643253326416
Epoch: 11, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.835 Vali Acc: 0.844 Test Loss: 0.835 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8624591827392578
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.031 Vali Acc: 0.822 Test Loss: 1.031 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.925652265548706
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.913 Vali Acc: 0.841 Test Loss: 0.913 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9013433456420898
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.041 Vali Acc: 0.847 Test Loss: 1.041 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.030846357345581
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.037 Vali Acc: 0.831 Test Loss: 1.037 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.746800422668457
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.072 Vali Acc: 0.831 Test Loss: 1.072 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1606497764587402
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.122 Vali Acc: 0.838 Test Loss: 1.122 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6642618179321289
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.831 Test Loss: 1.082 Test Acc: 0.831
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9453680515289307
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.984 Vali Acc: 0.841 Test Loss: 0.984 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8745346069335938
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.853 Test Loss: 0.962 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29607944
model size : 127.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.524409532546997
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 2.001 Vali Acc: 0.247 Test Loss: 2.001 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.9762451648712158
Epoch: 2, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.717 Vali Acc: 0.681 Test Loss: 1.717 Test Acc: 0.681
Validation loss decreased (-0.246855 --> -0.681233).  Saving model ...
Epoch: 3 cost time: 1.024707317352295
Epoch: 3, Steps: 8 | Train Loss: 1.630 Vali Loss: 1.371 Vali Acc: 0.784 Test Loss: 1.371 Test Acc: 0.784
Validation loss decreased (-0.681233 --> -0.784361).  Saving model ...
Epoch: 4 cost time: 0.6608664989471436
Epoch: 4, Steps: 8 | Train Loss: 1.253 Vali Loss: 0.990 Vali Acc: 0.797 Test Loss: 0.990 Test Acc: 0.797
Validation loss decreased (-0.784361 --> -0.796865).  Saving model ...
Epoch: 5 cost time: 0.689521312713623
Epoch: 5, Steps: 8 | Train Loss: 0.881 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
Validation loss decreased (-0.796865 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 0.7071595191955566
Epoch: 6, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
Validation loss decreased (-0.824993 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.6647822856903076
Epoch: 7, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.521 Vali Acc: 0.822 Test Loss: 0.521 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7330207824707031
Epoch: 8, Steps: 8 | Train Loss: 0.262 Vali Loss: 0.587 Vali Acc: 0.841 Test Loss: 0.587 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6628913879394531
Epoch: 9, Steps: 8 | Train Loss: 0.132 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7962889671325684
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.634 Vali Acc: 0.847 Test Loss: 0.634 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846869).  Saving model ...
Epoch: 11 cost time: 0.8797681331634521
Epoch: 11, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.668 Vali Acc: 0.866 Test Loss: 0.668 Test Acc: 0.866
Validation loss decreased (-0.846869 --> -0.865618).  Saving model ...
Epoch: 12 cost time: 0.8038737773895264
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.638 Vali Acc: 0.856 Test Loss: 0.638 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8694009780883789
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.661 Vali Acc: 0.863 Test Loss: 0.661 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8876452445983887
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.749 Vali Acc: 0.856 Test Loss: 0.749 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6342589855194092
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.740 Vali Acc: 0.847 Test Loss: 0.740 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7438185214996338
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.745 Vali Acc: 0.878 Test Loss: 0.745 Test Acc: 0.878
Validation loss decreased (-0.865618 --> -0.878118).  Saving model ...
Epoch: 17 cost time: 1.130781650543213
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.841 Test Loss: 0.777 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6901028156280518
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.763 Vali Acc: 0.844 Test Loss: 0.763 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9960272312164307
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.853 Test Loss: 0.744 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0004780292510986
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.859 Test Loss: 0.769 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7593166828155518
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.757 Vali Acc: 0.869 Test Loss: 0.757 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8777110576629639
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.878 Test Loss: 0.735 Test Acc: 0.878
Validation loss decreased (-0.878118 --> -0.878118).  Saving model ...
Epoch: 23 cost time: 0.6163630485534668
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.866 Test Loss: 0.737 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8688850402832031
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.869 Test Loss: 0.772 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7282719612121582
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.863 Test Loss: 0.796 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.767040491104126
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.798 Vali Acc: 0.859 Test Loss: 0.798 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8193314075469971
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.863 Test Loss: 0.788 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5905742645263672
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.866 Test Loss: 0.772 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8001141548156738
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.866 Test Loss: 0.786 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7408473491668701
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.863 Test Loss: 0.809 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6986362934112549
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.863 Test Loss: 0.835 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8257999420166016
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.863 Test Loss: 0.837 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 29462024
model size : 127.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.610274076461792
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 1.930 Vali Acc: 0.341 Test Loss: 1.930 Test Acc: 0.341
Validation loss decreased (inf --> -0.340606).  Saving model ...
Epoch: 2 cost time: 0.8160128593444824
Epoch: 2, Steps: 8 | Train Loss: 1.748 Vali Loss: 1.357 Vali Acc: 0.753 Test Loss: 1.357 Test Acc: 0.753
Validation loss decreased (-0.340606 --> -0.753111).  Saving model ...
Epoch: 3 cost time: 0.9709386825561523
Epoch: 3, Steps: 8 | Train Loss: 1.140 Vali Loss: 0.856 Vali Acc: 0.787 Test Loss: 0.856 Test Acc: 0.787
Validation loss decreased (-0.753111 --> -0.787491).  Saving model ...
Epoch: 4 cost time: 1.1601414680480957
Epoch: 4, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
Validation loss decreased (-0.787491 --> -0.834369).  Saving model ...
Epoch: 5 cost time: 1.344249963760376
Epoch: 5, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 1.175907850265503
Epoch: 6, Steps: 8 | Train Loss: 0.270 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.834370 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 0.8015842437744141
Epoch: 7, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.661 Vali Acc: 0.838 Test Loss: 0.661 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3629393577575684
Epoch: 8, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.750 Vali Acc: 0.838 Test Loss: 0.750 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0267415046691895
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.827 Vali Acc: 0.850 Test Loss: 0.827 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.034822940826416
Epoch: 10, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.019 Vali Acc: 0.847 Test Loss: 1.019 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2715263366699219
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.016 Vali Acc: 0.856 Test Loss: 1.016 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.856240).  Saving model ...
Epoch: 12 cost time: 0.9740493297576904
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.365 Vali Acc: 0.806 Test Loss: 1.365 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1376399993896484
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.206 Vali Acc: 0.841 Test Loss: 1.206 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0948214530944824
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.259 Vali Acc: 0.838 Test Loss: 1.259 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.826087474822998
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.314 Vali Acc: 0.841 Test Loss: 1.314 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2559564113616943
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.831 Test Loss: 1.301 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9766402244567871
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.303 Vali Acc: 0.834 Test Loss: 1.303 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0717825889587402
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.847 Test Loss: 1.290 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1830103397369385
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.872 Test Loss: 1.273 Test Acc: 0.872
Validation loss decreased (-0.856240 --> -0.871862).  Saving model ...
Epoch: 20 cost time: 1.0608930587768555
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.270 Vali Acc: 0.872 Test Loss: 1.270 Test Acc: 0.872
Validation loss decreased (-0.871862 --> -0.871862).  Saving model ...
Epoch: 21 cost time: 1.131373405456543
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.866 Test Loss: 1.277 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.420976161956787
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.853 Test Loss: 1.292 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1434941291809082
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.850 Test Loss: 1.310 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2529256343841553
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.847 Test Loss: 1.319 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2679147720336914
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.850 Test Loss: 1.319 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1906535625457764
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.850 Test Loss: 1.314 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1514217853546143
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.850 Test Loss: 1.312 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0432395935058594
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.850 Test Loss: 1.316 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.927922248840332
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.850 Test Loss: 1.320 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.19795823097229
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.853 Test Loss: 1.336 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 29783816
model size : 128.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1609089374542236
Epoch: 1, Steps: 8 | Train Loss: 2.137 Vali Loss: 1.933 Vali Acc: 0.300 Test Loss: 1.933 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 0.7937910556793213
Epoch: 2, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.565 Vali Acc: 0.659 Test Loss: 1.565 Test Acc: 0.659
Validation loss decreased (-0.299981 --> -0.659359).  Saving model ...
Epoch: 3 cost time: 0.7475848197937012
Epoch: 3, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.113 Vali Acc: 0.747 Test Loss: 1.113 Test Acc: 0.747
Validation loss decreased (-0.659359 --> -0.746864).  Saving model ...
Epoch: 4 cost time: 0.8572421073913574
Epoch: 4, Steps: 8 | Train Loss: 0.978 Vali Loss: 0.723 Vali Acc: 0.819 Test Loss: 0.723 Test Acc: 0.819
Validation loss decreased (-0.746864 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 0.7014298439025879
Epoch: 5, Steps: 8 | Train Loss: 0.553 Vali Loss: 0.553 Vali Acc: 0.806 Test Loss: 0.553 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7049150466918945
Epoch: 6, Steps: 8 | Train Loss: 0.425 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.818743 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.6839871406555176
Epoch: 7, Steps: 8 | Train Loss: 0.261 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7873976230621338
Epoch: 8, Steps: 8 | Train Loss: 0.161 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 0.7063217163085938
Epoch: 9, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.689 Vali Acc: 0.831 Test Loss: 0.689 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8425350189208984
Epoch: 10, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.753 Vali Acc: 0.863 Test Loss: 0.753 Test Acc: 0.863
Validation loss decreased (-0.843744 --> -0.862492).  Saving model ...
Epoch: 11 cost time: 0.7279760837554932
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.843 Vali Acc: 0.828 Test Loss: 0.843 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7688961029052734
Epoch: 12, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.909 Vali Acc: 0.859 Test Loss: 0.909 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9439613819122314
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.943 Vali Acc: 0.834 Test Loss: 0.943 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7780842781066895
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.851 Vali Acc: 0.866 Test Loss: 0.851 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865616).  Saving model ...
Epoch: 15 cost time: 0.735004186630249
Epoch: 15, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.050 Vali Acc: 0.850 Test Loss: 1.050 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0288662910461426
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.980 Vali Acc: 0.834 Test Loss: 0.980 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7072489261627197
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.074 Vali Acc: 0.844 Test Loss: 1.074 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.592315673828125
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.006 Vali Acc: 0.859 Test Loss: 1.006 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9225046634674072
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.198 Vali Acc: 0.825 Test Loss: 1.198 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.019434928894043
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.981 Vali Acc: 0.872 Test Loss: 0.981 Test Acc: 0.872
Validation loss decreased (-0.865616 --> -0.871865).  Saving model ...
Epoch: 21 cost time: 0.7310526371002197
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.990 Vali Acc: 0.887 Test Loss: 0.990 Test Acc: 0.887
Validation loss decreased (-0.871865 --> -0.887490).  Saving model ...
Epoch: 22 cost time: 0.8165304660797119
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.872 Test Loss: 1.056 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9733061790466309
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.004 Vali Acc: 0.872 Test Loss: 1.004 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7924554347991943
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.872 Test Loss: 0.991 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9094173908233643
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.993 Vali Acc: 0.875 Test Loss: 0.993 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6746945381164551
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.069 Vali Acc: 0.859 Test Loss: 1.069 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6546111106872559
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.132 Vali Acc: 0.853 Test Loss: 1.132 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8943681716918945
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.859 Test Loss: 1.121 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7128810882568359
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.859 Test Loss: 1.113 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6313652992248535
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.863 Test Loss: 1.094 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7850182056427002
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.863 Test Loss: 1.081 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8875
model parameter : 29584136
model size : 127.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2519898414611816
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 1.963 Vali Acc: 0.194 Test Loss: 1.963 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 1.064220666885376
Epoch: 2, Steps: 8 | Train Loss: 1.935 Vali Loss: 1.702 Vali Acc: 0.641 Test Loss: 1.702 Test Acc: 0.641
Validation loss decreased (-0.193730 --> -0.640608).  Saving model ...
Epoch: 3 cost time: 0.9582102298736572
Epoch: 3, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.402 Vali Acc: 0.734 Test Loss: 1.402 Test Acc: 0.734
Validation loss decreased (-0.640608 --> -0.734361).  Saving model ...
Epoch: 4 cost time: 0.7543647289276123
Epoch: 4, Steps: 8 | Train Loss: 1.316 Vali Loss: 1.081 Vali Acc: 0.816 Test Loss: 1.081 Test Acc: 0.816
Validation loss decreased (-0.734361 --> -0.815614).  Saving model ...
Epoch: 5 cost time: 0.8422949314117432
Epoch: 5, Steps: 8 | Train Loss: 0.996 Vali Loss: 0.774 Vali Acc: 0.844 Test Loss: 0.774 Test Acc: 0.844
Validation loss decreased (-0.815614 --> -0.843742).  Saving model ...
Epoch: 6 cost time: 0.8998641967773438
Epoch: 6, Steps: 8 | Train Loss: 0.762 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6699821949005127
Epoch: 7, Steps: 8 | Train Loss: 0.503 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
Validation loss decreased (-0.843742 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.7334163188934326
Epoch: 8, Steps: 8 | Train Loss: 0.361 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0175490379333496
Epoch: 9, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.578 Vali Acc: 0.828 Test Loss: 0.578 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6745645999908447
Epoch: 10, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9959583282470703
Epoch: 11, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6584181785583496
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.680 Vali Acc: 0.844 Test Loss: 0.680 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.565051794052124
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.668 Vali Acc: 0.859 Test Loss: 0.668 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6112570762634277
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.647 Vali Acc: 0.866 Test Loss: 0.647 Test Acc: 0.866
Validation loss decreased (-0.859370 --> -0.865619).  Saving model ...
Epoch: 15 cost time: 0.8833763599395752
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.863 Test Loss: 0.691 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7449579238891602
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.726 Vali Acc: 0.863 Test Loss: 0.726 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.954869270324707
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.709 Vali Acc: 0.872 Test Loss: 0.709 Test Acc: 0.872
Validation loss decreased (-0.865619 --> -0.871868).  Saving model ...
Epoch: 18 cost time: 0.8451576232910156
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.863 Test Loss: 0.704 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.069434404373169
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.744 Vali Acc: 0.856 Test Loss: 0.744 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6967942714691162
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.754 Vali Acc: 0.859 Test Loss: 0.754 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6658346652984619
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.739 Vali Acc: 0.875 Test Loss: 0.739 Test Acc: 0.875
Validation loss decreased (-0.871868 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.7887706756591797
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.770 Vali Acc: 0.866 Test Loss: 0.770 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8422820568084717
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.791 Vali Acc: 0.863 Test Loss: 0.791 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7985517978668213
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.798 Vali Acc: 0.866 Test Loss: 0.798 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9100029468536377
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.856 Test Loss: 0.804 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9098081588745117
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.797 Vali Acc: 0.863 Test Loss: 0.797 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6224253177642822
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.802 Vali Acc: 0.863 Test Loss: 0.802 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9344639778137207
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.791 Vali Acc: 0.872 Test Loss: 0.791 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5711398124694824
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.866 Test Loss: 0.805 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8376929759979248
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.859 Test Loss: 0.823 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.503666877746582
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.859 Test Loss: 0.833 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29461256
model size : 127.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6923115253448486
Epoch: 1, Steps: 8 | Train Loss: 2.113 Vali Loss: 1.811 Vali Acc: 0.456 Test Loss: 1.811 Test Acc: 0.456
Validation loss decreased (inf --> -0.456232).  Saving model ...
Epoch: 2 cost time: 1.2268834114074707
Epoch: 2, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.171 Vali Acc: 0.844 Test Loss: 1.171 Test Acc: 0.844
Validation loss decreased (-0.456232 --> -0.843738).  Saving model ...
Epoch: 3 cost time: 0.8022768497467041
Epoch: 3, Steps: 8 | Train Loss: 0.974 Vali Loss: 0.693 Vali Acc: 0.828 Test Loss: 0.693 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9166405200958252
Epoch: 4, Steps: 8 | Train Loss: 0.588 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
Validation loss decreased (-0.843738 --> -0.849995).  Saving model ...
Epoch: 5 cost time: 0.9451868534088135
Epoch: 5, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.060241937637329
Epoch: 6, Steps: 8 | Train Loss: 0.289 Vali Loss: 0.590 Vali Acc: 0.831 Test Loss: 0.590 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9768083095550537
Epoch: 7, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.710 Vali Acc: 0.834 Test Loss: 0.710 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9027323722839355
Epoch: 8, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.742 Vali Acc: 0.838 Test Loss: 0.742 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.693889856338501
Epoch: 9, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.065 Vali Acc: 0.812 Test Loss: 1.065 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.876556396484375
Epoch: 10, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.884 Vali Acc: 0.847 Test Loss: 0.884 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8047580718994141
Epoch: 11, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.943 Vali Acc: 0.841 Test Loss: 0.943 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8655321598052979
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.125 Vali Acc: 0.838 Test Loss: 1.125 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9108917713165283
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.205 Vali Acc: 0.834 Test Loss: 1.205 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.855128288269043
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.185 Vali Acc: 0.834 Test Loss: 1.185 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 29790728
model size : 128.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1898460388183594
Epoch: 1, Steps: 8 | Train Loss: 2.122 Vali Loss: 1.898 Vali Acc: 0.322 Test Loss: 1.898 Test Acc: 0.322
Validation loss decreased (inf --> -0.321856).  Saving model ...
Epoch: 2 cost time: 0.7435216903686523
Epoch: 2, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.475 Vali Acc: 0.681 Test Loss: 1.475 Test Acc: 0.681
Validation loss decreased (-0.321856 --> -0.681235).  Saving model ...
Epoch: 3 cost time: 1.1197319030761719
Epoch: 3, Steps: 8 | Train Loss: 1.319 Vali Loss: 0.989 Vali Acc: 0.772 Test Loss: 0.989 Test Acc: 0.772
Validation loss decreased (-0.681235 --> -0.771865).  Saving model ...
Epoch: 4 cost time: 0.719857931137085
Epoch: 4, Steps: 8 | Train Loss: 0.889 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
Validation loss decreased (-0.771865 --> -0.843744).  Saving model ...
Epoch: 5 cost time: 0.592667818069458
Epoch: 5, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.555 Vali Acc: 0.812 Test Loss: 0.555 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6445925235748291
Epoch: 6, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.8620443344116211
Epoch: 7, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6008813381195068
Epoch: 8, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.665 Vali Acc: 0.831 Test Loss: 0.665 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6236684322357178
Epoch: 9, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.865 Vali Acc: 0.816 Test Loss: 0.865 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.580242395401001
Epoch: 10, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.747 Vali Acc: 0.838 Test Loss: 0.747 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5736894607543945
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.954 Vali Acc: 0.828 Test Loss: 0.954 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6754560470581055
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.970 Vali Acc: 0.809 Test Loss: 0.970 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7554781436920166
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.983 Vali Acc: 0.825 Test Loss: 0.983 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7274582386016846
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.989 Vali Acc: 0.825 Test Loss: 0.989 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6207199096679688
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.124 Vali Acc: 0.828 Test Loss: 1.124 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6290714740753174
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.103 Vali Acc: 0.834 Test Loss: 1.103 Test Acc: 0.834
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 29591048
model size : 127.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9989166259765625
Epoch: 1, Steps: 8 | Train Loss: 2.207 Vali Loss: 2.045 Vali Acc: 0.175 Test Loss: 2.045 Test Acc: 0.175
Validation loss decreased (inf --> -0.174980).  Saving model ...
Epoch: 2 cost time: 0.8705058097839355
Epoch: 2, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.777 Vali Acc: 0.562 Test Loss: 1.777 Test Acc: 0.562
Validation loss decreased (-0.174980 --> -0.562482).  Saving model ...
Epoch: 3 cost time: 0.6427879333496094
Epoch: 3, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.453 Vali Acc: 0.688 Test Loss: 1.453 Test Acc: 0.688
Validation loss decreased (-0.562482 --> -0.687485).  Saving model ...
Epoch: 4 cost time: 0.7766087055206299
Epoch: 4, Steps: 8 | Train Loss: 1.318 Vali Loss: 1.094 Vali Acc: 0.784 Test Loss: 1.094 Test Acc: 0.784
Validation loss decreased (-0.687485 --> -0.784364).  Saving model ...
Epoch: 5 cost time: 0.6661202907562256
Epoch: 5, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.771 Vali Acc: 0.822 Test Loss: 0.771 Test Acc: 0.822
Validation loss decreased (-0.784364 --> -0.821867).  Saving model ...
Epoch: 6 cost time: 0.7376711368560791
Epoch: 6, Steps: 8 | Train Loss: 0.676 Vali Loss: 0.572 Vali Acc: 0.831 Test Loss: 0.572 Test Acc: 0.831
Validation loss decreased (-0.821867 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.9342515468597412
Epoch: 7, Steps: 8 | Train Loss: 0.440 Vali Loss: 0.488 Vali Acc: 0.834 Test Loss: 0.488 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.5639150142669678
Epoch: 8, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7017514705657959
Epoch: 9, Steps: 8 | Train Loss: 0.225 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837494).  Saving model ...
Epoch: 10 cost time: 1.045531988143921
Epoch: 10, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.638 Vali Acc: 0.828 Test Loss: 0.638 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.531379222869873
Epoch: 11, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9770281314849854
Epoch: 12, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.663 Vali Acc: 0.838 Test Loss: 0.663 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6837036609649658
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.760 Vali Acc: 0.831 Test Loss: 0.760 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8269469738006592
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.785 Vali Acc: 0.834 Test Loss: 0.785 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6855220794677734
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.859 Vali Acc: 0.831 Test Loss: 0.859 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5399901866912842
Epoch: 16, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.777 Vali Acc: 0.838 Test Loss: 0.777 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6104466915130615
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.821 Vali Acc: 0.856 Test Loss: 0.821 Test Acc: 0.856
Validation loss decreased (-0.837494 --> -0.856242).  Saving model ...
Epoch: 18 cost time: 0.6059021949768066
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.849 Vali Acc: 0.838 Test Loss: 0.849 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7575960159301758
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.852 Vali Acc: 0.831 Test Loss: 0.852 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5912845134735107
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.836 Vali Acc: 0.850 Test Loss: 0.836 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7804696559906006
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.904 Vali Acc: 0.825 Test Loss: 0.904 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7377614974975586
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.007 Vali Acc: 0.825 Test Loss: 1.007 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7881498336791992
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.979 Vali Acc: 0.828 Test Loss: 0.979 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7007465362548828
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.828 Test Loss: 0.981 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7050697803497314
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.975 Vali Acc: 0.828 Test Loss: 0.975 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6526741981506348
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.967 Vali Acc: 0.822 Test Loss: 0.967 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.778649091720581
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.952 Vali Acc: 0.825 Test Loss: 0.952 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 29460488
model size : 127.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.304046154022217
Epoch: 1, Steps: 8 | Train Loss: 2.250 Vali Loss: 1.947 Vali Acc: 0.272 Test Loss: 1.947 Test Acc: 0.272
Validation loss decreased (inf --> -0.271856).  Saving model ...
Epoch: 2 cost time: 0.846947193145752
Epoch: 2, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.348 Vali Acc: 0.662 Test Loss: 1.348 Test Acc: 0.662
Validation loss decreased (-0.271856 --> -0.662487).  Saving model ...
Epoch: 3 cost time: 0.8903498649597168
Epoch: 3, Steps: 8 | Train Loss: 1.197 Vali Loss: 0.874 Vali Acc: 0.806 Test Loss: 0.874 Test Acc: 0.806
Validation loss decreased (-0.662487 --> -0.806241).  Saving model ...
Epoch: 4 cost time: 1.1188013553619385
Epoch: 4, Steps: 8 | Train Loss: 0.712 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
Validation loss decreased (-0.806241 --> -0.837494).  Saving model ...
Epoch: 5 cost time: 0.879126787185669
Epoch: 5, Steps: 8 | Train Loss: 0.431 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8233761787414551
Epoch: 6, Steps: 8 | Train Loss: 0.280 Vali Loss: 0.520 Vali Acc: 0.847 Test Loss: 0.520 Test Acc: 0.847
Validation loss decreased (-0.837494 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 1.2361533641815186
Epoch: 7, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0100188255310059
Epoch: 8, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.784 Vali Acc: 0.831 Test Loss: 0.784 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.103050947189331
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.984 Vali Acc: 0.838 Test Loss: 0.984 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7411491870880127
Epoch: 10, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.148 Vali Acc: 0.812 Test Loss: 1.148 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7759900093078613
Epoch: 11, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.258 Vali Acc: 0.834 Test Loss: 1.258 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9928975105285645
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.393 Vali Acc: 0.831 Test Loss: 1.393 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9621703624725342
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.507 Vali Acc: 0.828 Test Loss: 1.507 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.21030855178833
Epoch: 14, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.312 Vali Acc: 0.816 Test Loss: 1.312 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0325291156768799
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.772 Vali Acc: 0.819 Test Loss: 1.772 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1795985698699951
Epoch: 16, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.675 Vali Acc: 0.822 Test Loss: 1.675 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 29797640
model size : 128.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1902434825897217
Epoch: 1, Steps: 8 | Train Loss: 2.080 Vali Loss: 1.940 Vali Acc: 0.306 Test Loss: 1.940 Test Acc: 0.306
Validation loss decreased (inf --> -0.306231).  Saving model ...
Epoch: 2 cost time: 1.0786693096160889
Epoch: 2, Steps: 8 | Train Loss: 1.804 Vali Loss: 1.540 Vali Acc: 0.753 Test Loss: 1.540 Test Acc: 0.753
Validation loss decreased (-0.306231 --> -0.753110).  Saving model ...
Epoch: 3 cost time: 0.7050113677978516
Epoch: 3, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.111 Vali Acc: 0.766 Test Loss: 1.111 Test Acc: 0.766
Validation loss decreased (-0.753110 --> -0.765614).  Saving model ...
Epoch: 4 cost time: 0.8738918304443359
Epoch: 4, Steps: 8 | Train Loss: 0.958 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
Validation loss decreased (-0.765614 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 0.9057612419128418
Epoch: 5, Steps: 8 | Train Loss: 0.560 Vali Loss: 0.552 Vali Acc: 0.831 Test Loss: 0.552 Test Acc: 0.831
Validation loss decreased (-0.818743 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 0.6772942543029785
Epoch: 6, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.525 Vali Acc: 0.816 Test Loss: 0.525 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.806502103805542
Epoch: 7, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6467902660369873
Epoch: 8, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.8357000350952148
Epoch: 9, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6772496700286865
Epoch: 10, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.9152257442474365
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.820 Vali Acc: 0.838 Test Loss: 0.820 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0664093494415283
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.867 Vali Acc: 0.844 Test Loss: 0.867 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.590869665145874
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.930 Vali Acc: 0.841 Test Loss: 0.930 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1649181842803955
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.976 Vali Acc: 0.831 Test Loss: 0.976 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7254245281219482
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.939 Vali Acc: 0.847 Test Loss: 0.939 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8847789764404297
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.929 Vali Acc: 0.853 Test Loss: 0.929 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853116).  Saving model ...
Epoch: 17 cost time: 1.0030388832092285
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.957 Vali Acc: 0.850 Test Loss: 0.957 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9220302104949951
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.920 Vali Acc: 0.853 Test Loss: 0.920 Test Acc: 0.853
Validation loss decreased (-0.853116 --> -0.853116).  Saving model ...
Epoch: 19 cost time: 1.04103684425354
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.850 Test Loss: 0.949 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9350159168243408
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.850 Test Loss: 0.968 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6810142993927002
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.847 Test Loss: 0.975 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.835890531539917
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.980 Vali Acc: 0.850 Test Loss: 0.980 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6952259540557861
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.847 Test Loss: 0.985 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8269608020782471
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.844 Test Loss: 0.997 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6467411518096924
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.847 Test Loss: 0.985 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6304080486297607
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.850 Test Loss: 0.967 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5817532539367676
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.850 Test Loss: 0.956 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6196866035461426
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.853 Test Loss: 0.974 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 29567240
model size : 127.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.109135866165161
Epoch: 1, Steps: 8 | Train Loss: 2.189 Vali Loss: 2.046 Vali Acc: 0.228 Test Loss: 2.046 Test Acc: 0.228
Validation loss decreased (inf --> -0.228105).  Saving model ...
Epoch: 2 cost time: 0.8844044208526611
Epoch: 2, Steps: 8 | Train Loss: 1.989 Vali Loss: 1.807 Vali Acc: 0.447 Test Loss: 1.807 Test Acc: 0.447
Validation loss decreased (-0.228105 --> -0.446857).  Saving model ...
Epoch: 3 cost time: 0.5302183628082275
Epoch: 3, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.510 Vali Acc: 0.722 Test Loss: 1.510 Test Acc: 0.722
Validation loss decreased (-0.446857 --> -0.721860).  Saving model ...
Epoch: 4 cost time: 0.8603825569152832
Epoch: 4, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.185 Vali Acc: 0.762 Test Loss: 1.185 Test Acc: 0.762
Validation loss decreased (-0.721860 --> -0.762488).  Saving model ...
Epoch: 5 cost time: 0.8103804588317871
Epoch: 5, Steps: 8 | Train Loss: 1.068 Vali Loss: 0.867 Vali Acc: 0.791 Test Loss: 0.867 Test Acc: 0.791
Validation loss decreased (-0.762488 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 0.576683759689331
Epoch: 6, Steps: 8 | Train Loss: 0.728 Vali Loss: 0.608 Vali Acc: 0.825 Test Loss: 0.608 Test Acc: 0.825
Validation loss decreased (-0.790616 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.9823458194732666
Epoch: 7, Steps: 8 | Train Loss: 0.497 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.8618631362915039
Epoch: 8, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.8048427104949951
Epoch: 9, Steps: 8 | Train Loss: 0.246 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 10 cost time: 1.0054712295532227
Epoch: 10, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.598 Vali Acc: 0.816 Test Loss: 0.598 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7940530776977539
Epoch: 11, Steps: 8 | Train Loss: 0.117 Vali Loss: 0.603 Vali Acc: 0.841 Test Loss: 0.603 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9211697578430176
Epoch: 12, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.603 Vali Acc: 0.856 Test Loss: 0.603 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856244).  Saving model ...
Epoch: 13 cost time: 0.9079515933990479
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9769961833953857
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.675 Vali Acc: 0.831 Test Loss: 0.675 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8273482322692871
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7786498069763184
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9756276607513428
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.754 Vali Acc: 0.838 Test Loss: 0.754 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7729334831237793
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.798 Vali Acc: 0.844 Test Loss: 0.798 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.814349889755249
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.798 Vali Acc: 0.847 Test Loss: 0.798 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.725212812423706
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.752 Vali Acc: 0.844 Test Loss: 0.752 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5602812767028809
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.758 Vali Acc: 0.841 Test Loss: 0.758 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5585000514984131
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.847 Test Loss: 0.800 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 29459720
model size : 127.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0887794494628906
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 1.879 Vali Acc: 0.362 Test Loss: 1.879 Test Acc: 0.362
Validation loss decreased (inf --> -0.362481).  Saving model ...
Epoch: 2 cost time: 0.8876535892486572
Epoch: 2, Steps: 8 | Train Loss: 1.700 Vali Loss: 1.311 Vali Acc: 0.716 Test Loss: 1.311 Test Acc: 0.716
Validation loss decreased (-0.362481 --> -0.715612).  Saving model ...
Epoch: 3 cost time: 0.8782734870910645
Epoch: 3, Steps: 8 | Train Loss: 1.086 Vali Loss: 0.753 Vali Acc: 0.844 Test Loss: 0.753 Test Acc: 0.844
Validation loss decreased (-0.715612 --> -0.843742).  Saving model ...
Epoch: 4 cost time: 0.8366422653198242
Epoch: 4, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2216966152191162
Epoch: 5, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.475 Vali Acc: 0.853 Test Loss: 0.475 Test Acc: 0.853
Validation loss decreased (-0.843742 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 1.1968164443969727
Epoch: 6, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7700223922729492
Epoch: 7, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.711 Vali Acc: 0.822 Test Loss: 0.711 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6990315914154053
Epoch: 8, Steps: 8 | Train Loss: 0.089 Vali Loss: 0.825 Vali Acc: 0.844 Test Loss: 0.825 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.770437479019165
Epoch: 9, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.850 Vali Acc: 0.838 Test Loss: 0.850 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7047245502471924
Epoch: 10, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.042 Vali Acc: 0.838 Test Loss: 1.042 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.203322172164917
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.981 Vali Acc: 0.872 Test Loss: 0.981 Test Acc: 0.872
Validation loss decreased (-0.853120 --> -0.871865).  Saving model ...
Epoch: 12 cost time: 1.060431957244873
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.090 Vali Acc: 0.847 Test Loss: 1.090 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8555550575256348
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.444 Vali Acc: 0.834 Test Loss: 1.444 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.023695945739746
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.190 Vali Acc: 0.838 Test Loss: 1.190 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.742509126663208
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.204 Vali Acc: 0.859 Test Loss: 1.204 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0276098251342773
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.361 Vali Acc: 0.856 Test Loss: 1.361 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.073115587234497
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.470 Vali Acc: 0.856 Test Loss: 1.470 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2622110843658447
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.370 Vali Acc: 0.869 Test Loss: 1.370 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9755020141601562
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.844 Test Loss: 1.367 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7924203872680664
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.866 Test Loss: 1.342 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7531816959381104
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.863 Test Loss: 1.387 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 29804552
model size : 128.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.262509346008301
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 1.941 Vali Acc: 0.237 Test Loss: 1.941 Test Acc: 0.237
Validation loss decreased (inf --> -0.237481).  Saving model ...
Epoch: 2 cost time: 0.9357059001922607
Epoch: 2, Steps: 8 | Train Loss: 1.810 Vali Loss: 1.552 Vali Acc: 0.659 Test Loss: 1.552 Test Acc: 0.659
Validation loss decreased (-0.237481 --> -0.659359).  Saving model ...
Epoch: 3 cost time: 0.9958443641662598
Epoch: 3, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.120 Vali Acc: 0.759 Test Loss: 1.120 Test Acc: 0.759
Validation loss decreased (-0.659359 --> -0.759364).  Saving model ...
Epoch: 4 cost time: 0.7825326919555664
Epoch: 4, Steps: 8 | Train Loss: 1.003 Vali Loss: 0.754 Vali Acc: 0.834 Test Loss: 0.754 Test Acc: 0.834
Validation loss decreased (-0.759364 --> -0.834367).  Saving model ...
Epoch: 5 cost time: 0.800774097442627
Epoch: 5, Steps: 8 | Train Loss: 0.641 Vali Loss: 0.568 Vali Acc: 0.828 Test Loss: 0.568 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8921036720275879
Epoch: 6, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.478 Vali Acc: 0.859 Test Loss: 0.478 Test Acc: 0.859
Validation loss decreased (-0.834367 --> -0.859370).  Saving model ...
Epoch: 7 cost time: 0.6509897708892822
Epoch: 7, Steps: 8 | Train Loss: 0.292 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7608785629272461
Epoch: 8, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.677 Vali Acc: 0.812 Test Loss: 0.677 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6168293952941895
Epoch: 9, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.689 Vali Acc: 0.825 Test Loss: 0.689 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5997011661529541
Epoch: 10, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.734 Vali Acc: 0.847 Test Loss: 0.734 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.704622745513916
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.782 Vali Acc: 0.853 Test Loss: 0.782 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6199045181274414
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.772 Vali Acc: 0.853 Test Loss: 0.772 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7212910652160645
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.935 Vali Acc: 0.841 Test Loss: 0.935 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.758202075958252
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.906 Vali Acc: 0.869 Test Loss: 0.906 Test Acc: 0.869
Validation loss decreased (-0.859370 --> -0.868741).  Saving model ...
Epoch: 15 cost time: 0.7328875064849854
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.866 Test Loss: 0.881 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6644637584686279
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.940 Vali Acc: 0.853 Test Loss: 0.940 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5881438255310059
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.060 Vali Acc: 0.844 Test Loss: 1.060 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6073737144470215
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.844 Test Loss: 0.924 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6205992698669434
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.924 Vali Acc: 0.841 Test Loss: 0.924 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6728992462158203
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.114 Vali Acc: 0.847 Test Loss: 1.114 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.771622896194458
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.190 Vali Acc: 0.856 Test Loss: 1.190 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1093459129333496
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.035 Vali Acc: 0.847 Test Loss: 1.035 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.674933671951294
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.853 Test Loss: 0.986 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0651612281799316
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.859 Test Loss: 0.963 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 29574152
model size : 127.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9982647895812988
Epoch: 1, Steps: 8 | Train Loss: 2.168 Vali Loss: 2.004 Vali Acc: 0.244 Test Loss: 2.004 Test Acc: 0.244
Validation loss decreased (inf --> -0.243730).  Saving model ...
Epoch: 2 cost time: 0.5214028358459473
Epoch: 2, Steps: 8 | Train Loss: 1.935 Vali Loss: 1.776 Vali Acc: 0.662 Test Loss: 1.776 Test Acc: 0.662
Validation loss decreased (-0.243730 --> -0.662482).  Saving model ...
Epoch: 3 cost time: 0.7339215278625488
Epoch: 3, Steps: 8 | Train Loss: 1.693 Vali Loss: 1.509 Vali Acc: 0.753 Test Loss: 1.509 Test Acc: 0.753
Validation loss decreased (-0.662482 --> -0.753110).  Saving model ...
Epoch: 4 cost time: 0.5203921794891357
Epoch: 4, Steps: 8 | Train Loss: 1.395 Vali Loss: 1.188 Vali Acc: 0.797 Test Loss: 1.188 Test Acc: 0.797
Validation loss decreased (-0.753110 --> -0.796863).  Saving model ...
Epoch: 5 cost time: 0.6215019226074219
Epoch: 5, Steps: 8 | Train Loss: 1.078 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.796863 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 0.5678129196166992
Epoch: 6, Steps: 8 | Train Loss: 0.685 Vali Loss: 0.575 Vali Acc: 0.838 Test Loss: 0.575 Test Acc: 0.838
Validation loss decreased (-0.799991 --> -0.837494).  Saving model ...
Epoch: 7 cost time: 0.6730968952178955
Epoch: 7, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.593785285949707
Epoch: 8, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6885895729064941
Epoch: 9, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.591 Vali Acc: 0.834 Test Loss: 0.591 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5652992725372314
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.661 Vali Acc: 0.834 Test Loss: 0.661 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7147765159606934
Epoch: 11, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.680 Vali Acc: 0.841 Test Loss: 0.680 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840618).  Saving model ...
Epoch: 12 cost time: 0.6185572147369385
Epoch: 12, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6617457866668701
Epoch: 13, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.732 Vali Acc: 0.834 Test Loss: 0.732 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.48549675941467285
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.837 Vali Acc: 0.825 Test Loss: 0.837 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5156698226928711
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.919 Vali Acc: 0.825 Test Loss: 0.919 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5013551712036133
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.834 Vali Acc: 0.853 Test Loss: 0.834 Test Acc: 0.853
Validation loss decreased (-0.840618 --> -0.853117).  Saving model ...
Epoch: 17 cost time: 0.6104724407196045
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.808 Vali Acc: 0.838 Test Loss: 0.808 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6684961318969727
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.858 Vali Acc: 0.844 Test Loss: 0.858 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5508565902709961
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.884 Vali Acc: 0.838 Test Loss: 0.884 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6874094009399414
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.864 Vali Acc: 0.847 Test Loss: 0.864 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6084761619567871
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.849 Vali Acc: 0.847 Test Loss: 0.849 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.55908203125
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.855 Vali Acc: 0.853 Test Loss: 0.855 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6091208457946777
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.847 Test Loss: 0.875 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5028958320617676
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.887 Vali Acc: 0.850 Test Loss: 0.887 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.47681212425231934
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.850 Test Loss: 0.891 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4652292728424072
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.853 Test Loss: 0.893 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 29458952
model size : 127.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2171568870544434
Epoch: 1, Steps: 8 | Train Loss: 2.291 Vali Loss: 2.001 Vali Acc: 0.272 Test Loss: 2.001 Test Acc: 0.272
Validation loss decreased (inf --> -0.271855).  Saving model ...
Epoch: 2 cost time: 1.0719552040100098
Epoch: 2, Steps: 8 | Train Loss: 1.868 Vali Loss: 1.527 Vali Acc: 0.588 Test Loss: 1.527 Test Acc: 0.588
Validation loss decreased (-0.271855 --> -0.587485).  Saving model ...
Epoch: 3 cost time: 0.8626649379730225
Epoch: 3, Steps: 8 | Train Loss: 1.333 Vali Loss: 0.999 Vali Acc: 0.738 Test Loss: 0.999 Test Acc: 0.738
Validation loss decreased (-0.587485 --> -0.737490).  Saving model ...
Epoch: 4 cost time: 0.9568235874176025
Epoch: 4, Steps: 8 | Train Loss: 0.779 Vali Loss: 0.645 Vali Acc: 0.806 Test Loss: 0.645 Test Acc: 0.806
Validation loss decreased (-0.737490 --> -0.806244).  Saving model ...
Epoch: 5 cost time: 0.7498042583465576
Epoch: 5, Steps: 8 | Train Loss: 0.523 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.806244 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.8391916751861572
Epoch: 6, Steps: 8 | Train Loss: 0.336 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0040147304534912
Epoch: 7, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.547 Vali Acc: 0.859 Test Loss: 0.547 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.6873447895050049
Epoch: 8, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.783 Vali Acc: 0.838 Test Loss: 0.783 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0192880630493164
Epoch: 9, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.845 Vali Acc: 0.838 Test Loss: 0.845 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9606802463531494
Epoch: 10, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.045 Vali Acc: 0.841 Test Loss: 1.045 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.006061315536499
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.007 Vali Acc: 0.822 Test Loss: 1.007 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8664281368255615
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.227 Vali Acc: 0.831 Test Loss: 1.227 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6743974685668945
Epoch: 13, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.327 Vali Acc: 0.844 Test Loss: 1.327 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9786365032196045
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.241 Vali Acc: 0.847 Test Loss: 1.241 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6856708526611328
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.311 Vali Acc: 0.841 Test Loss: 1.311 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8355851173400879
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.292 Vali Acc: 0.850 Test Loss: 1.292 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0555660724639893
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.280 Vali Acc: 0.853 Test Loss: 1.280 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 29734664
model size : 128.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.178621530532837
Epoch: 1, Steps: 8 | Train Loss: 2.186 Vali Loss: 2.030 Vali Acc: 0.169 Test Loss: 2.030 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 0.8365743160247803
Epoch: 2, Steps: 8 | Train Loss: 1.960 Vali Loss: 1.695 Vali Acc: 0.509 Test Loss: 1.695 Test Acc: 0.509
Validation loss decreased (-0.168730 --> -0.509358).  Saving model ...
Epoch: 3 cost time: 0.6843223571777344
Epoch: 3, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.256 Vali Acc: 0.741 Test Loss: 1.256 Test Acc: 0.741
Validation loss decreased (-0.509358 --> -0.740612).  Saving model ...
Epoch: 4 cost time: 0.9342195987701416
Epoch: 4, Steps: 8 | Train Loss: 1.068 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.740612 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 0.746453046798706
Epoch: 5, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.607 Vali Acc: 0.812 Test Loss: 0.607 Test Acc: 0.812
Validation loss decreased (-0.774991 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.8896820545196533
Epoch: 6, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
Validation loss decreased (-0.812494 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.5828611850738525
Epoch: 7, Steps: 8 | Train Loss: 0.341 Vali Loss: 0.517 Vali Acc: 0.834 Test Loss: 0.517 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.9429981708526611
Epoch: 8, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6175365447998047
Epoch: 9, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.656 Vali Acc: 0.853 Test Loss: 0.656 Test Acc: 0.853
Validation loss decreased (-0.834370 --> -0.853118).  Saving model ...
Epoch: 10 cost time: 0.9043781757354736
Epoch: 10, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.667 Vali Acc: 0.847 Test Loss: 0.667 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8179922103881836
Epoch: 11, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.882 Vali Acc: 0.819 Test Loss: 0.882 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6591663360595703
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.771 Vali Acc: 0.828 Test Loss: 0.771 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8781430721282959
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.927 Vali Acc: 0.816 Test Loss: 0.927 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6312215328216553
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.824 Vali Acc: 0.853 Test Loss: 0.824 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9887235164642334
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.825 Vali Acc: 0.856 Test Loss: 0.825 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856242).  Saving model ...
Epoch: 16 cost time: 0.8043057918548584
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.876 Vali Acc: 0.853 Test Loss: 0.876 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8272647857666016
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.909 Vali Acc: 0.847 Test Loss: 0.909 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6891329288482666
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.024 Vali Acc: 0.819 Test Loss: 1.024 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6297452449798584
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.883 Vali Acc: 0.866 Test Loss: 0.883 Test Acc: 0.866
Validation loss decreased (-0.856242 --> -0.865616).  Saving model ...
Epoch: 20 cost time: 0.7885758876800537
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.878 Vali Acc: 0.856 Test Loss: 0.878 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5888316631317139
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.029 Vali Acc: 0.825 Test Loss: 1.029 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6052157878875732
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.014 Vali Acc: 0.834 Test Loss: 1.014 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6716530323028564
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.834 Test Loss: 1.022 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5737414360046387
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.010 Vali Acc: 0.841 Test Loss: 1.010 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6210508346557617
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.834 Test Loss: 1.032 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9003353118896484
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.834 Test Loss: 1.041 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8078832626342773
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.838 Test Loss: 1.046 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0181066989898682
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.035 Vali Acc: 0.841 Test Loss: 1.035 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8202054500579834
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.841 Test Loss: 1.031 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 29558024
model size : 127.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1716177463531494
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 2.005 Vali Acc: 0.234 Test Loss: 2.005 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 0.632598876953125
Epoch: 2, Steps: 8 | Train Loss: 1.888 Vali Loss: 1.794 Vali Acc: 0.575 Test Loss: 1.794 Test Acc: 0.575
Validation loss decreased (-0.234355 --> -0.574982).  Saving model ...
Epoch: 3 cost time: 0.74214768409729
Epoch: 3, Steps: 8 | Train Loss: 1.666 Vali Loss: 1.508 Vali Acc: 0.719 Test Loss: 1.508 Test Acc: 0.719
Validation loss decreased (-0.574982 --> -0.718735).  Saving model ...
Epoch: 4 cost time: 0.5155825614929199
Epoch: 4, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.195 Vali Acc: 0.747 Test Loss: 1.195 Test Acc: 0.747
Validation loss decreased (-0.718735 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.5573506355285645
Epoch: 5, Steps: 8 | Train Loss: 1.056 Vali Loss: 0.873 Vali Acc: 0.806 Test Loss: 0.873 Test Acc: 0.806
Validation loss decreased (-0.746863 --> -0.806241).  Saving model ...
Epoch: 6 cost time: 0.76651930809021
Epoch: 6, Steps: 8 | Train Loss: 0.727 Vali Loss: 0.644 Vali Acc: 0.819 Test Loss: 0.644 Test Acc: 0.819
Validation loss decreased (-0.806241 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.7031826972961426
Epoch: 7, Steps: 8 | Train Loss: 0.458 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
Validation loss decreased (-0.818744 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 0.6463358402252197
Epoch: 8, Steps: 8 | Train Loss: 0.400 Vali Loss: 0.502 Vali Acc: 0.812 Test Loss: 0.502 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.679243803024292
Epoch: 9, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.500 Vali Acc: 0.831 Test Loss: 0.500 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.5963513851165771
Epoch: 10, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.541 Vali Acc: 0.841 Test Loss: 0.541 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840620).  Saving model ...
Epoch: 11 cost time: 0.5516598224639893
Epoch: 11, Steps: 8 | Train Loss: 0.110 Vali Loss: 0.568 Vali Acc: 0.831 Test Loss: 0.568 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5608992576599121
Epoch: 12, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.651 Vali Acc: 0.831 Test Loss: 0.651 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5096108913421631
Epoch: 13, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.653 Vali Acc: 0.834 Test Loss: 0.653 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6132862567901611
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843744).  Saving model ...
Epoch: 15 cost time: 0.5557966232299805
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
Validation loss decreased (-0.843744 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.6960055828094482
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.722 Vali Acc: 0.831 Test Loss: 0.722 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8639333248138428
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.736 Vali Acc: 0.841 Test Loss: 0.736 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7494063377380371
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7159736156463623
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.901 Vali Acc: 0.838 Test Loss: 0.901 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5748322010040283
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.823 Vali Acc: 0.834 Test Loss: 0.823 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7409811019897461
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.730 Vali Acc: 0.853 Test Loss: 0.730 Test Acc: 0.853
Validation loss decreased (-0.849993 --> -0.853118).  Saving model ...
Epoch: 22 cost time: 0.6413466930389404
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6514341831207275
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.844 Test Loss: 0.782 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5711350440979004
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.802 Vali Acc: 0.847 Test Loss: 0.802 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6771149635314941
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.847 Test Loss: 0.789 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7042446136474609
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.847 Test Loss: 0.804 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7497251033782959
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.828 Vali Acc: 0.838 Test Loss: 0.828 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7388145923614502
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.862 Vali Acc: 0.838 Test Loss: 0.862 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7012019157409668
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.838 Test Loss: 0.868 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5617475509643555
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6776909828186035
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.822 Vali Acc: 0.859 Test Loss: 0.822 Test Acc: 0.859
Validation loss decreased (-0.853118 --> -0.859367).  Saving model ...
Epoch: 32 cost time: 0.9500405788421631
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.856 Test Loss: 0.822 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5556318759918213
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.856 Test Loss: 0.829 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5771472454071045
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.859 Test Loss: 0.838 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7584328651428223
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.850 Test Loss: 0.857 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7251996994018555
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.847 Test Loss: 0.871 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8306450843811035
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.847 Test Loss: 0.861 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5773751735687256
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.853 Test Loss: 0.857 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7147963047027588
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.856 Test Loss: 0.851 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7631313800811768
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.859 Test Loss: 0.861 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6072227954864502
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.856 Test Loss: 0.864 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 29465864
model size : 127.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5194225311279297
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 1.900 Vali Acc: 0.309 Test Loss: 1.900 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 0.9340217113494873
Epoch: 2, Steps: 8 | Train Loss: 1.785 Vali Loss: 1.392 Vali Acc: 0.700 Test Loss: 1.392 Test Acc: 0.700
Validation loss decreased (-0.309356 --> -0.699986).  Saving model ...
Epoch: 3 cost time: 1.1969726085662842
Epoch: 3, Steps: 8 | Train Loss: 1.164 Vali Loss: 0.872 Vali Acc: 0.812 Test Loss: 0.872 Test Acc: 0.812
Validation loss decreased (-0.699986 --> -0.812491).  Saving model ...
Epoch: 4 cost time: 1.0555989742279053
Epoch: 4, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.590 Vali Acc: 0.812 Test Loss: 0.590 Test Acc: 0.812
Validation loss decreased (-0.812491 --> -0.812494).  Saving model ...
Epoch: 5 cost time: 0.9885232448577881
Epoch: 5, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.489 Vali Acc: 0.841 Test Loss: 0.489 Test Acc: 0.841
Validation loss decreased (-0.812494 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.6520769596099854
Epoch: 6, Steps: 8 | Train Loss: 0.350 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7177579402923584
Epoch: 7, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.653 Vali Acc: 0.828 Test Loss: 0.653 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9981091022491455
Epoch: 8, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843743).  Saving model ...
Epoch: 9 cost time: 1.0789337158203125
Epoch: 9, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.743 Vali Acc: 0.841 Test Loss: 0.743 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6772537231445312
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.096 Vali Acc: 0.816 Test Loss: 1.096 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8365638256072998
Epoch: 11, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.961 Vali Acc: 0.828 Test Loss: 0.961 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1147713661193848
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.031 Vali Acc: 0.853 Test Loss: 1.031 Test Acc: 0.853
Validation loss decreased (-0.843743 --> -0.853115).  Saving model ...
Epoch: 13 cost time: 1.0216381549835205
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.270 Vali Acc: 0.828 Test Loss: 1.270 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9205639362335205
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.068 Vali Acc: 0.841 Test Loss: 1.068 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7614841461181641
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.152 Vali Acc: 0.838 Test Loss: 1.152 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.885622501373291
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.327 Vali Acc: 0.828 Test Loss: 1.327 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6768274307250977
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.221 Vali Acc: 0.847 Test Loss: 1.221 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6467475891113281
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.363 Vali Acc: 0.822 Test Loss: 1.363 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6144397258758545
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.554 Vali Acc: 0.828 Test Loss: 1.554 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6336307525634766
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.863 Test Loss: 1.090 Test Acc: 0.863
Validation loss decreased (-0.853115 --> -0.862489).  Saving model ...
Epoch: 21 cost time: 0.6139485836029053
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.116 Vali Acc: 0.859 Test Loss: 1.116 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6441872119903564
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.831 Test Loss: 1.539 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5552949905395508
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.368 Vali Acc: 0.828 Test Loss: 1.368 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5882527828216553
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.359 Vali Acc: 0.831 Test Loss: 1.359 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6302528381347656
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.770 Vali Acc: 0.812 Test Loss: 1.770 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6737031936645508
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.856 Vali Acc: 0.819 Test Loss: 1.856 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7804667949676514
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.822 Test Loss: 1.828 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8686151504516602
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.828 Test Loss: 1.786 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9091002941131592
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.828 Test Loss: 1.717 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8319664001464844
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.841 Test Loss: 1.691 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29740808
model size : 128.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.584432601928711
Epoch: 1, Steps: 8 | Train Loss: 2.129 Vali Loss: 1.982 Vali Acc: 0.219 Test Loss: 1.982 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.7231431007385254
Epoch: 2, Steps: 8 | Train Loss: 1.901 Vali Loss: 1.655 Vali Acc: 0.575 Test Loss: 1.655 Test Acc: 0.575
Validation loss decreased (-0.218730 --> -0.574983).  Saving model ...
Epoch: 3 cost time: 0.955859899520874
Epoch: 3, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.224 Vali Acc: 0.750 Test Loss: 1.224 Test Acc: 0.750
Validation loss decreased (-0.574983 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 0.7696754932403564
Epoch: 4, Steps: 8 | Train Loss: 1.040 Vali Loss: 0.838 Vali Acc: 0.809 Test Loss: 0.838 Test Acc: 0.809
Validation loss decreased (-0.749988 --> -0.809367).  Saving model ...
Epoch: 5 cost time: 0.9952006340026855
Epoch: 5, Steps: 8 | Train Loss: 0.687 Vali Loss: 0.574 Vali Acc: 0.834 Test Loss: 0.574 Test Acc: 0.834
Validation loss decreased (-0.809367 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 0.636263370513916
Epoch: 6, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0233500003814697
Epoch: 7, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.471 Vali Acc: 0.834 Test Loss: 0.471 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.7634084224700928
Epoch: 8, Steps: 8 | Train Loss: 0.218 Vali Loss: 0.672 Vali Acc: 0.812 Test Loss: 0.672 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8304808139801025
Epoch: 9, Steps: 8 | Train Loss: 0.172 Vali Loss: 0.668 Vali Acc: 0.834 Test Loss: 0.668 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9543168544769287
Epoch: 10, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.660 Vali Acc: 0.834 Test Loss: 0.660 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7825098037719727
Epoch: 11, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.759 Vali Acc: 0.834 Test Loss: 0.759 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6592895984649658
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.693 Vali Acc: 0.866 Test Loss: 0.693 Test Acc: 0.866
Validation loss decreased (-0.834370 --> -0.865618).  Saving model ...
Epoch: 13 cost time: 0.9343039989471436
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.782 Vali Acc: 0.847 Test Loss: 0.782 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0363991260528564
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.826 Vali Acc: 0.853 Test Loss: 0.826 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8761470317840576
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.961 Vali Acc: 0.834 Test Loss: 0.961 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9026517868041992
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.863 Vali Acc: 0.844 Test Loss: 0.863 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9458191394805908
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.976 Vali Acc: 0.847 Test Loss: 0.976 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7443320751190186
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.995 Vali Acc: 0.847 Test Loss: 0.995 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.577460765838623
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.872 Vali Acc: 0.856 Test Loss: 0.872 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5496535301208496
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.859 Test Loss: 0.889 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5685961246490479
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.908 Vali Acc: 0.859 Test Loss: 0.908 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9678399562835693
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.944 Vali Acc: 0.859 Test Loss: 0.944 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 29556488
model size : 127.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.108870029449463
Epoch: 1, Steps: 8 | Train Loss: 2.205 Vali Loss: 2.066 Vali Acc: 0.156 Test Loss: 2.066 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.7182888984680176
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.833 Vali Acc: 0.566 Test Loss: 1.833 Test Acc: 0.566
Validation loss decreased (-0.156229 --> -0.565607).  Saving model ...
Epoch: 3 cost time: 0.5700192451477051
Epoch: 3, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.553 Vali Acc: 0.728 Test Loss: 1.553 Test Acc: 0.728
Validation loss decreased (-0.565607 --> -0.728109).  Saving model ...
Epoch: 4 cost time: 0.7693657875061035
Epoch: 4, Steps: 8 | Train Loss: 1.419 Vali Loss: 1.213 Vali Acc: 0.791 Test Loss: 1.213 Test Acc: 0.791
Validation loss decreased (-0.728109 --> -0.790613).  Saving model ...
Epoch: 5 cost time: 0.592566728591919
Epoch: 5, Steps: 8 | Train Loss: 1.085 Vali Loss: 0.875 Vali Acc: 0.812 Test Loss: 0.875 Test Acc: 0.812
Validation loss decreased (-0.790613 --> -0.812491).  Saving model ...
Epoch: 6 cost time: 0.6889469623565674
Epoch: 6, Steps: 8 | Train Loss: 0.779 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
Validation loss decreased (-0.812491 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 0.7168974876403809
Epoch: 7, Steps: 8 | Train Loss: 0.524 Vali Loss: 0.499 Vali Acc: 0.831 Test Loss: 0.499 Test Acc: 0.831
Validation loss decreased (-0.824994 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.6643538475036621
Epoch: 8, Steps: 8 | Train Loss: 0.346 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.831245 --> -0.849995).  Saving model ...
Epoch: 9 cost time: 0.5466711521148682
Epoch: 9, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5253269672393799
Epoch: 10, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.580 Vali Acc: 0.825 Test Loss: 0.580 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.590172529220581
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.6446576118469238
Epoch: 12, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.643 Vali Acc: 0.869 Test Loss: 0.643 Test Acc: 0.869
Validation loss decreased (-0.853120 --> -0.868744).  Saving model ...
Epoch: 13 cost time: 0.6582629680633545
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.671 Vali Acc: 0.859 Test Loss: 0.671 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7937407493591309
Epoch: 14, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.613 Vali Acc: 0.869 Test Loss: 0.613 Test Acc: 0.869
Validation loss decreased (-0.868744 --> -0.868744).  Saving model ...
Epoch: 15 cost time: 0.5686283111572266
Epoch: 15, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871868).  Saving model ...
Epoch: 16 cost time: 0.7471258640289307
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.715 Vali Acc: 0.859 Test Loss: 0.715 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5581135749816895
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.667 Vali Acc: 0.881 Test Loss: 0.667 Test Acc: 0.881
Validation loss decreased (-0.871868 --> -0.881243).  Saving model ...
Epoch: 18 cost time: 0.7110395431518555
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.707 Vali Acc: 0.875 Test Loss: 0.707 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6246957778930664
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.726 Vali Acc: 0.884 Test Loss: 0.726 Test Acc: 0.884
Validation loss decreased (-0.881243 --> -0.884368).  Saving model ...
Epoch: 20 cost time: 0.69938063621521
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.690 Vali Acc: 0.881 Test Loss: 0.690 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7154092788696289
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.679 Vali Acc: 0.878 Test Loss: 0.679 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.46983766555786133
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.878 Test Loss: 0.702 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5830492973327637
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.723 Vali Acc: 0.881 Test Loss: 0.723 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6019906997680664
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.887 Test Loss: 0.716 Test Acc: 0.887
Validation loss decreased (-0.884368 --> -0.887493).  Saving model ...
Epoch: 25 cost time: 0.8828818798065186
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.878 Test Loss: 0.718 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6748788356781006
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.878 Test Loss: 0.719 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6905920505523682
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.878 Test Loss: 0.733 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.617577075958252
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.85837721824646
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.735 Vali Acc: 0.881 Test Loss: 0.735 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5992646217346191
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.878 Test Loss: 0.748 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.755582332611084
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.878 Test Loss: 0.759 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6564168930053711
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.878 Test Loss: 0.769 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7136716842651367
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.881 Test Loss: 0.769 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6886205673217773
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.881 Test Loss: 0.765 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8875
model parameter : 29464328
model size : 127.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2983925342559814
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 1.972 Vali Acc: 0.194 Test Loss: 1.972 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.9514737129211426
Epoch: 2, Steps: 8 | Train Loss: 1.807 Vali Loss: 1.483 Vali Acc: 0.722 Test Loss: 1.483 Test Acc: 0.722
Validation loss decreased (-0.193730 --> -0.721860).  Saving model ...
Epoch: 3 cost time: 0.7294623851776123
Epoch: 3, Steps: 8 | Train Loss: 1.269 Vali Loss: 0.992 Vali Acc: 0.797 Test Loss: 0.992 Test Acc: 0.797
Validation loss decreased (-0.721860 --> -0.796865).  Saving model ...
Epoch: 4 cost time: 1.3677010536193848
Epoch: 4, Steps: 8 | Train Loss: 0.823 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
Validation loss decreased (-0.796865 --> -0.809368).  Saving model ...
Epoch: 5 cost time: 1.007469892501831
Epoch: 5, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.809368 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.87068772315979
Epoch: 6, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.384977102279663
Epoch: 7, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.672 Vali Acc: 0.831 Test Loss: 0.672 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9624297618865967
Epoch: 8, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.793 Vali Acc: 0.812 Test Loss: 0.793 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9013173580169678
Epoch: 9, Steps: 8 | Train Loss: 0.130 Vali Loss: 0.883 Vali Acc: 0.853 Test Loss: 0.883 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853116).  Saving model ...
Epoch: 10 cost time: 1.1299965381622314
Epoch: 10, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.891 Vali Acc: 0.838 Test Loss: 0.891 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.89178466796875
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.035 Vali Acc: 0.856 Test Loss: 1.035 Test Acc: 0.856
Validation loss decreased (-0.853116 --> -0.856240).  Saving model ...
Epoch: 12 cost time: 0.8726940155029297
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.030 Vali Acc: 0.850 Test Loss: 1.030 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1509640216827393
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.972 Vali Acc: 0.853 Test Loss: 0.972 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1030242443084717
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.399 Vali Acc: 0.812 Test Loss: 1.399 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1729710102081299
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.266 Vali Acc: 0.831 Test Loss: 1.266 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7234756946563721
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.228 Vali Acc: 0.850 Test Loss: 1.228 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8861641883850098
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.297 Vali Acc: 0.841 Test Loss: 1.297 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7430589199066162
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.259 Vali Acc: 0.844 Test Loss: 1.259 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.062690019607544
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.251 Vali Acc: 0.850 Test Loss: 1.251 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8237955570220947
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.227 Vali Acc: 0.856 Test Loss: 1.227 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8768339157104492
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.859 Test Loss: 1.219 Test Acc: 0.859
Validation loss decreased (-0.856240 --> -0.859363).  Saving model ...
Epoch: 22 cost time: 0.8800289630889893
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.863 Test Loss: 1.221 Test Acc: 0.863
Validation loss decreased (-0.859363 --> -0.862488).  Saving model ...
Epoch: 23 cost time: 1.0951635837554932
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.863 Test Loss: 1.230 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8011112213134766
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.856 Test Loss: 1.246 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8955328464508057
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.850 Test Loss: 1.266 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8957715034484863
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.850 Test Loss: 1.277 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7645268440246582
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.847 Test Loss: 1.280 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1877424716949463
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.277 Vali Acc: 0.847 Test Loss: 1.277 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8520243167877197
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.276 Vali Acc: 0.847 Test Loss: 1.276 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8512694835662842
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.853 Test Loss: 1.281 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1754257678985596
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.850 Test Loss: 1.281 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0551917552947998
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.850 Test Loss: 1.284 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29700872
model size : 127.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.537088394165039
Epoch: 1, Steps: 8 | Train Loss: 2.165 Vali Loss: 2.055 Vali Acc: 0.197 Test Loss: 2.055 Test Acc: 0.197
Validation loss decreased (inf --> -0.196854).  Saving model ...
Epoch: 2 cost time: 0.6273148059844971
Epoch: 2, Steps: 8 | Train Loss: 1.910 Vali Loss: 1.733 Vali Acc: 0.600 Test Loss: 1.733 Test Acc: 0.600
Validation loss decreased (-0.196854 --> -0.599983).  Saving model ...
Epoch: 3 cost time: 0.9614510536193848
Epoch: 3, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.317 Vali Acc: 0.759 Test Loss: 1.317 Test Acc: 0.759
Validation loss decreased (-0.599983 --> -0.759362).  Saving model ...
Epoch: 4 cost time: 0.7964270114898682
Epoch: 4, Steps: 8 | Train Loss: 1.101 Vali Loss: 0.880 Vali Acc: 0.794 Test Loss: 0.880 Test Acc: 0.794
Validation loss decreased (-0.759362 --> -0.793741).  Saving model ...
Epoch: 5 cost time: 1.0717854499816895
Epoch: 5, Steps: 8 | Train Loss: 0.751 Vali Loss: 0.580 Vali Acc: 0.834 Test Loss: 0.580 Test Acc: 0.834
Validation loss decreased (-0.793741 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 1.2397608757019043
Epoch: 6, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 1.2447254657745361
Epoch: 7, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8251371383666992
Epoch: 8, Steps: 8 | Train Loss: 0.241 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.077326774597168
Epoch: 9, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.718 Vali Acc: 0.819 Test Loss: 0.718 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9645290374755859
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.736 Vali Acc: 0.831 Test Loss: 0.736 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9483776092529297
Epoch: 11, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.792 Vali Acc: 0.834 Test Loss: 0.792 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7318987846374512
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.739 Vali Acc: 0.856 Test Loss: 0.739 Test Acc: 0.856
Validation loss decreased (-0.834370 --> -0.856243).  Saving model ...
Epoch: 13 cost time: 0.6816999912261963
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.898 Vali Acc: 0.853 Test Loss: 0.898 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9178934097290039
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.890 Vali Acc: 0.847 Test Loss: 0.890 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9900755882263184
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.877 Vali Acc: 0.856 Test Loss: 0.877 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9683976173400879
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.838 Vali Acc: 0.866 Test Loss: 0.838 Test Acc: 0.866
Validation loss decreased (-0.856243 --> -0.865617).  Saving model ...
Epoch: 17 cost time: 0.6770360469818115
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.866 Test Loss: 0.823 Test Acc: 0.866
Validation loss decreased (-0.865617 --> -0.865617).  Saving model ...
Epoch: 18 cost time: 0.8728959560394287
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.839 Vali Acc: 0.863 Test Loss: 0.839 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7663593292236328
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.873 Vali Acc: 0.859 Test Loss: 0.873 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2135887145996094
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.879 Vali Acc: 0.853 Test Loss: 0.879 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.661257266998291
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.887 Vali Acc: 0.863 Test Loss: 0.887 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0974140167236328
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.903 Vali Acc: 0.863 Test Loss: 0.903 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8833088874816895
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.869 Test Loss: 0.910 Test Acc: 0.869
Validation loss decreased (-0.865617 --> -0.868741).  Saving model ...
Epoch: 24 cost time: 1.1241285800933838
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.898 Vali Acc: 0.863 Test Loss: 0.898 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7945528030395508
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.869 Test Loss: 0.899 Test Acc: 0.869
Validation loss decreased (-0.868741 --> -0.868741).  Saving model ...
Epoch: 26 cost time: 0.6359512805938721
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.872 Test Loss: 0.919 Test Acc: 0.872
Validation loss decreased (-0.868741 --> -0.871866).  Saving model ...
Epoch: 27 cost time: 0.6453211307525635
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.869 Test Loss: 0.934 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6371145248413086
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.869 Test Loss: 0.932 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8582143783569336
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.869 Test Loss: 0.902 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8881027698516846
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.869 Test Loss: 0.903 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9488611221313477
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.866 Test Loss: 0.933 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7710912227630615
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.856 Test Loss: 0.958 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1097707748413086
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.856 Test Loss: 0.976 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7853727340698242
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.856 Test Loss: 0.989 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8966648578643799
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.859 Test Loss: 0.985 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7432622909545898
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.977 Vali Acc: 0.859 Test Loss: 0.977 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 29554952
model size : 127.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1852049827575684
Epoch: 1, Steps: 8 | Train Loss: 2.197 Vali Loss: 2.071 Vali Acc: 0.169 Test Loss: 2.071 Test Acc: 0.169
Validation loss decreased (inf --> -0.168729).  Saving model ...
Epoch: 2 cost time: 0.7045571804046631
Epoch: 2, Steps: 8 | Train Loss: 2.023 Vali Loss: 1.873 Vali Acc: 0.403 Test Loss: 1.873 Test Acc: 0.403
Validation loss decreased (-0.168729 --> -0.403106).  Saving model ...
Epoch: 3 cost time: 0.654444694519043
Epoch: 3, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.643 Vali Acc: 0.619 Test Loss: 1.643 Test Acc: 0.619
Validation loss decreased (-0.403106 --> -0.618734).  Saving model ...
Epoch: 4 cost time: 0.7379317283630371
Epoch: 4, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.345 Vali Acc: 0.741 Test Loss: 1.345 Test Acc: 0.741
Validation loss decreased (-0.618734 --> -0.740612).  Saving model ...
Epoch: 5 cost time: 0.7912728786468506
Epoch: 5, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.004 Vali Acc: 0.778 Test Loss: 1.004 Test Acc: 0.778
Validation loss decreased (-0.740612 --> -0.778115).  Saving model ...
Epoch: 6 cost time: 0.703683614730835
Epoch: 6, Steps: 8 | Train Loss: 0.800 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
Validation loss decreased (-0.778115 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 0.724855899810791
Epoch: 7, Steps: 8 | Train Loss: 0.554 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
Validation loss decreased (-0.809368 --> -0.809370).  Saving model ...
Epoch: 8 cost time: 0.6418881416320801
Epoch: 8, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.508 Vali Acc: 0.834 Test Loss: 0.508 Test Acc: 0.834
Validation loss decreased (-0.809370 --> -0.834370).  Saving model ...
Epoch: 9 cost time: 0.7958908081054688
Epoch: 9, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.604 Vali Acc: 0.819 Test Loss: 0.604 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8698632717132568
Epoch: 10, Steps: 8 | Train Loss: 0.185 Vali Loss: 0.660 Vali Acc: 0.812 Test Loss: 0.660 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6580653190612793
Epoch: 11, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6135842800140381
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.691 Vali Acc: 0.844 Test Loss: 0.691 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843743).  Saving model ...
Epoch: 13 cost time: 0.6968121528625488
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.704 Vali Acc: 0.844 Test Loss: 0.704 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6322367191314697
Epoch: 14, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.742 Vali Acc: 0.838 Test Loss: 0.742 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6187574863433838
Epoch: 15, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.783 Vali Acc: 0.831 Test Loss: 0.783 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5707800388336182
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.772 Vali Acc: 0.856 Test Loss: 0.772 Test Acc: 0.856
Validation loss decreased (-0.843743 --> -0.856242).  Saving model ...
Epoch: 17 cost time: 0.7140257358551025
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.777 Vali Acc: 0.856 Test Loss: 0.777 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6012728214263916
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.777 Vali Acc: 0.859 Test Loss: 0.777 Test Acc: 0.859
Validation loss decreased (-0.856242 --> -0.859367).  Saving model ...
Epoch: 19 cost time: 0.769279956817627
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.794 Vali Acc: 0.863 Test Loss: 0.794 Test Acc: 0.863
Validation loss decreased (-0.859367 --> -0.862492).  Saving model ...
Epoch: 20 cost time: 0.7865846157073975
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.823 Vali Acc: 0.875 Test Loss: 0.823 Test Acc: 0.875
Validation loss decreased (-0.862492 --> -0.874992).  Saving model ...
Epoch: 21 cost time: 0.5841150283813477
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.841 Vali Acc: 0.869 Test Loss: 0.841 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6267421245574951
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.848 Vali Acc: 0.872 Test Loss: 0.848 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6587460041046143
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.866 Test Loss: 0.831 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7127163410186768
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.869 Test Loss: 0.831 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6654050350189209
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.866 Test Loss: 0.840 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7151556015014648
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.858 Vali Acc: 0.863 Test Loss: 0.858 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6539504528045654
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.859 Test Loss: 0.878 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5938053131103516
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.863 Test Loss: 0.893 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6536853313446045
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.866 Test Loss: 0.893 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5381278991699219
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.876 Vali Acc: 0.863 Test Loss: 0.876 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29470472
model size : 127.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1120150089263916
Epoch: 1, Steps: 8 | Train Loss: 2.164 Vali Loss: 1.997 Vali Acc: 0.284 Test Loss: 1.997 Test Acc: 0.284
Validation loss decreased (inf --> -0.284355).  Saving model ...
Epoch: 2 cost time: 0.7527754306793213
Epoch: 2, Steps: 8 | Train Loss: 1.813 Vali Loss: 1.520 Vali Acc: 0.547 Test Loss: 1.520 Test Acc: 0.547
Validation loss decreased (-0.284355 --> -0.546860).  Saving model ...
Epoch: 3 cost time: 0.7721962928771973
Epoch: 3, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.017 Vali Acc: 0.756 Test Loss: 1.017 Test Acc: 0.756
Validation loss decreased (-0.546860 --> -0.756240).  Saving model ...
Epoch: 4 cost time: 0.7634358406066895
Epoch: 4, Steps: 8 | Train Loss: 0.792 Vali Loss: 0.643 Vali Acc: 0.794 Test Loss: 0.643 Test Acc: 0.794
Validation loss decreased (-0.756240 --> -0.793744).  Saving model ...
Epoch: 5 cost time: 0.7641353607177734
Epoch: 5, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
Validation loss decreased (-0.793744 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.1814510822296143
Epoch: 6, Steps: 8 | Train Loss: 0.267 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
Validation loss decreased (-0.824994 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 1.3187823295593262
Epoch: 7, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.776 Vali Acc: 0.822 Test Loss: 0.776 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9503393173217773
Epoch: 8, Steps: 8 | Train Loss: 0.154 Vali Loss: 0.755 Vali Acc: 0.816 Test Loss: 0.755 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9080588817596436
Epoch: 9, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.908 Vali Acc: 0.838 Test Loss: 0.908 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837491).  Saving model ...
Epoch: 10 cost time: 0.8555071353912354
Epoch: 10, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.121 Vali Acc: 0.812 Test Loss: 1.121 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1468288898468018
Epoch: 11, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.014 Vali Acc: 0.847 Test Loss: 1.014 Test Acc: 0.847
Validation loss decreased (-0.837491 --> -0.846865).  Saving model ...
Epoch: 12 cost time: 1.475351333618164
Epoch: 12, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.935 Vali Acc: 0.831 Test Loss: 0.935 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2248921394348145
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.022 Vali Acc: 0.859 Test Loss: 1.022 Test Acc: 0.859
Validation loss decreased (-0.846865 --> -0.859365).  Saving model ...
Epoch: 14 cost time: 1.221278429031372
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.058 Vali Acc: 0.825 Test Loss: 1.058 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8175230026245117
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.987 Vali Acc: 0.847 Test Loss: 0.987 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7714450359344482
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.086 Vali Acc: 0.863 Test Loss: 1.086 Test Acc: 0.863
Validation loss decreased (-0.859365 --> -0.862489).  Saving model ...
Epoch: 17 cost time: 0.843756914138794
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.859 Test Loss: 1.111 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.339285135269165
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.193 Vali Acc: 0.850 Test Loss: 1.193 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.21903395652771
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.123 Vali Acc: 0.853 Test Loss: 1.123 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3506600856781006
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.850 Test Loss: 1.140 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0413696765899658
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.176 Vali Acc: 0.859 Test Loss: 1.176 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4816052913665771
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.188 Vali Acc: 0.856 Test Loss: 1.188 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0806729793548584
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.872 Test Loss: 1.163 Test Acc: 0.872
Validation loss decreased (-0.862489 --> -0.871863).  Saving model ...
Epoch: 24 cost time: 1.178431510925293
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.140 Vali Acc: 0.866 Test Loss: 1.140 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.182664394378662
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.866 Test Loss: 1.139 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2784769535064697
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.155 Vali Acc: 0.869 Test Loss: 1.155 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.112276315689087
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.869 Test Loss: 1.178 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0684278011322021
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.863 Test Loss: 1.199 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8864960670471191
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.863 Test Loss: 1.209 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8726415634155273
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.859 Test Loss: 1.208 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8208804130554199
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.863 Test Loss: 1.203 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7826437950134277
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.863 Test Loss: 1.195 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.174191951751709
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.863 Test Loss: 1.188 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 29714696
model size : 128.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.344899892807007
Epoch: 1, Steps: 8 | Train Loss: 2.157 Vali Loss: 2.005 Vali Acc: 0.231 Test Loss: 2.005 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.6628499031066895
Epoch: 2, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.699 Vali Acc: 0.559 Test Loss: 1.699 Test Acc: 0.559
Validation loss decreased (-0.231230 --> -0.559358).  Saving model ...
Epoch: 3 cost time: 0.7206478118896484
Epoch: 3, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.325 Vali Acc: 0.647 Test Loss: 1.325 Test Acc: 0.647
Validation loss decreased (-0.559358 --> -0.646862).  Saving model ...
Epoch: 4 cost time: 0.7094149589538574
Epoch: 4, Steps: 8 | Train Loss: 1.200 Vali Loss: 0.910 Vali Acc: 0.800 Test Loss: 0.910 Test Acc: 0.800
Validation loss decreased (-0.646862 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.8861467838287354
Epoch: 5, Steps: 8 | Train Loss: 0.776 Vali Loss: 0.635 Vali Acc: 0.812 Test Loss: 0.635 Test Acc: 0.812
Validation loss decreased (-0.799991 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.7136142253875732
Epoch: 6, Steps: 8 | Train Loss: 0.489 Vali Loss: 0.541 Vali Acc: 0.828 Test Loss: 0.541 Test Acc: 0.828
Validation loss decreased (-0.812494 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.8860902786254883
Epoch: 7, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.540 Vali Acc: 0.831 Test Loss: 0.540 Test Acc: 0.831
Validation loss decreased (-0.828120 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.7549402713775635
Epoch: 8, Steps: 8 | Train Loss: 0.224 Vali Loss: 0.538 Vali Acc: 0.847 Test Loss: 0.538 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.9663236141204834
Epoch: 9, Steps: 8 | Train Loss: 0.124 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6154587268829346
Epoch: 10, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.678 Vali Acc: 0.859 Test Loss: 0.678 Test Acc: 0.859
Validation loss decreased (-0.846870 --> -0.859368).  Saving model ...
Epoch: 11 cost time: 0.6624987125396729
Epoch: 11, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.628 Vali Acc: 0.869 Test Loss: 0.628 Test Acc: 0.869
Validation loss decreased (-0.859368 --> -0.868744).  Saving model ...
Epoch: 12 cost time: 1.0125339031219482
Epoch: 12, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.706 Vali Acc: 0.841 Test Loss: 0.706 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6457858085632324
Epoch: 13, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.673 Vali Acc: 0.872 Test Loss: 0.673 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871868).  Saving model ...
Epoch: 14 cost time: 0.788416862487793
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.724 Vali Acc: 0.866 Test Loss: 0.724 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0392146110534668
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.871868 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.9206986427307129
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.803 Vali Acc: 0.866 Test Loss: 0.803 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6704826354980469
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.805 Vali Acc: 0.859 Test Loss: 0.805 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7341306209564209
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.807 Vali Acc: 0.869 Test Loss: 0.807 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.643498420715332
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.820 Vali Acc: 0.872 Test Loss: 0.820 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8650243282318115
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.828 Vali Acc: 0.872 Test Loss: 0.828 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.717787504196167
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.869 Test Loss: 0.846 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5775923728942871
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.832 Vali Acc: 0.866 Test Loss: 0.832 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.553926944732666
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.866 Test Loss: 0.824 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6896262168884277
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.869 Test Loss: 0.837 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6058049201965332
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.892 Vali Acc: 0.863 Test Loss: 0.892 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29553416
model size : 127.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0025196075439453
Epoch: 1, Steps: 8 | Train Loss: 2.249 Vali Loss: 2.115 Vali Acc: 0.138 Test Loss: 2.115 Test Acc: 0.138
Validation loss decreased (inf --> -0.137479).  Saving model ...
Epoch: 2 cost time: 0.6613729000091553
Epoch: 2, Steps: 8 | Train Loss: 2.050 Vali Loss: 1.902 Vali Acc: 0.378 Test Loss: 1.902 Test Acc: 0.378
Validation loss decreased (-0.137479 --> -0.378106).  Saving model ...
Epoch: 3 cost time: 0.5213432312011719
Epoch: 3, Steps: 8 | Train Loss: 1.811 Vali Loss: 1.663 Vali Acc: 0.594 Test Loss: 1.663 Test Acc: 0.594
Validation loss decreased (-0.378106 --> -0.593733).  Saving model ...
Epoch: 4 cost time: 0.6666326522827148
Epoch: 4, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.378 Vali Acc: 0.716 Test Loss: 1.378 Test Acc: 0.716
Validation loss decreased (-0.593733 --> -0.715611).  Saving model ...
Epoch: 5 cost time: 0.6077287197113037
Epoch: 5, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.062 Vali Acc: 0.778 Test Loss: 1.062 Test Acc: 0.778
Validation loss decreased (-0.715611 --> -0.778114).  Saving model ...
Epoch: 6 cost time: 0.45659899711608887
Epoch: 6, Steps: 8 | Train Loss: 0.904 Vali Loss: 0.733 Vali Acc: 0.812 Test Loss: 0.733 Test Acc: 0.812
Validation loss decreased (-0.778114 --> -0.812493).  Saving model ...
Epoch: 7 cost time: 0.5355184078216553
Epoch: 7, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.558 Vali Acc: 0.806 Test Loss: 0.558 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5104784965515137
Epoch: 8, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.473 Vali Acc: 0.841 Test Loss: 0.473 Test Acc: 0.841
Validation loss decreased (-0.812493 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.5220425128936768
Epoch: 9, Steps: 8 | Train Loss: 0.290 Vali Loss: 0.515 Vali Acc: 0.834 Test Loss: 0.515 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7931921482086182
Epoch: 10, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
Validation loss decreased (-0.840620 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.7877719402313232
Epoch: 11, Steps: 8 | Train Loss: 0.156 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7772884368896484
Epoch: 12, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
Validation loss decreased (-0.849995 --> -0.859369).  Saving model ...
Epoch: 13 cost time: 0.6843631267547607
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5741322040557861
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6204922199249268
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.650 Vali Acc: 0.863 Test Loss: 0.650 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862494).  Saving model ...
Epoch: 16 cost time: 0.6309173107147217
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.643 Vali Acc: 0.869 Test Loss: 0.643 Test Acc: 0.869
Validation loss decreased (-0.862494 --> -0.868744).  Saving model ...
Epoch: 17 cost time: 0.529954195022583
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.868744 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.7041094303131104
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.654 Vali Acc: 0.866 Test Loss: 0.654 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.524590253829956
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.859 Test Loss: 0.682 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7092156410217285
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.682 Vali Acc: 0.869 Test Loss: 0.682 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7503917217254639
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.672 Vali Acc: 0.866 Test Loss: 0.672 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6094262599945068
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.869 Test Loss: 0.680 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4971277713775635
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.872 Test Loss: 0.697 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.652062177658081
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.733 Vali Acc: 0.859 Test Loss: 0.733 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6252710819244385
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.866 Test Loss: 0.735 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5247738361358643
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.869 Test Loss: 0.715 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5115370750427246
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.729 Vali Acc: 0.866 Test Loss: 0.729 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29476616
model size : 127.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6403326988220215
Epoch: 1, Steps: 8 | Train Loss: 2.171 Vali Loss: 1.999 Vali Acc: 0.253 Test Loss: 1.999 Test Acc: 0.253
Validation loss decreased (inf --> -0.253105).  Saving model ...
Epoch: 2 cost time: 0.7329058647155762
Epoch: 2, Steps: 8 | Train Loss: 1.885 Vali Loss: 1.537 Vali Acc: 0.591 Test Loss: 1.537 Test Acc: 0.591
Validation loss decreased (-0.253105 --> -0.590610).  Saving model ...
Epoch: 3 cost time: 0.7105660438537598
Epoch: 3, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.000 Vali Acc: 0.797 Test Loss: 1.000 Test Acc: 0.797
Validation loss decreased (-0.590610 --> -0.796865).  Saving model ...
Epoch: 4 cost time: 1.0183751583099365
Epoch: 4, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.654 Vali Acc: 0.778 Test Loss: 0.654 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6180942058563232
Epoch: 5, Steps: 8 | Train Loss: 0.444 Vali Loss: 0.509 Vali Acc: 0.834 Test Loss: 0.509 Test Acc: 0.834
Validation loss decreased (-0.796865 --> -0.834370).  Saving model ...
Epoch: 6 cost time: 0.594529390335083
Epoch: 6, Steps: 8 | Train Loss: 0.358 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0791471004486084
Epoch: 7, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.689 Vali Acc: 0.828 Test Loss: 0.689 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8892261981964111
Epoch: 8, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.769 Vali Acc: 0.819 Test Loss: 0.769 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8891115188598633
Epoch: 9, Steps: 8 | Train Loss: 0.091 Vali Loss: 0.757 Vali Acc: 0.869 Test Loss: 0.757 Test Acc: 0.869
Validation loss decreased (-0.834370 --> -0.868742).  Saving model ...
Epoch: 10 cost time: 0.7904691696166992
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.905 Vali Acc: 0.856 Test Loss: 0.905 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8612580299377441
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.844 Vali Acc: 0.856 Test Loss: 0.844 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7117776870727539
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.998 Vali Acc: 0.844 Test Loss: 0.998 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9380042552947998
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.948 Vali Acc: 0.875 Test Loss: 0.948 Test Acc: 0.875
Validation loss decreased (-0.868742 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 1.0134093761444092
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.901 Vali Acc: 0.863 Test Loss: 0.901 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6649274826049805
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.838 Test Loss: 1.090 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7918393611907959
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.113 Vali Acc: 0.863 Test Loss: 1.113 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6810791492462158
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.009 Vali Acc: 0.878 Test Loss: 1.009 Test Acc: 0.878
Validation loss decreased (-0.874991 --> -0.878115).  Saving model ...
Epoch: 18 cost time: 0.9094293117523193
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.850 Test Loss: 1.027 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7620284557342529
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.028 Vali Acc: 0.856 Test Loss: 1.028 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.864804744720459
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.872 Test Loss: 1.046 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9014565944671631
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.872 Test Loss: 1.027 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.928748607635498
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.872 Test Loss: 0.982 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6771636009216309
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.866 Test Loss: 0.986 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.729254961013794
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.863 Test Loss: 1.001 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7324345111846924
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.872 Test Loss: 1.010 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9229559898376465
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.872 Test Loss: 1.020 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8608686923980713
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.863 Test Loss: 1.033 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 29682440
model size : 127.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1603033542633057
Epoch: 1, Steps: 8 | Train Loss: 2.091 Vali Loss: 1.974 Vali Acc: 0.197 Test Loss: 1.974 Test Acc: 0.197
Validation loss decreased (inf --> -0.196855).  Saving model ...
Epoch: 2 cost time: 0.5636084079742432
Epoch: 2, Steps: 8 | Train Loss: 1.874 Vali Loss: 1.640 Vali Acc: 0.656 Test Loss: 1.640 Test Acc: 0.656
Validation loss decreased (-0.196855 --> -0.656234).  Saving model ...
Epoch: 3 cost time: 0.8463516235351562
Epoch: 3, Steps: 8 | Train Loss: 1.510 Vali Loss: 1.258 Vali Acc: 0.750 Test Loss: 1.258 Test Acc: 0.750
Validation loss decreased (-0.656234 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 0.7539429664611816
Epoch: 4, Steps: 8 | Train Loss: 1.106 Vali Loss: 0.860 Vali Acc: 0.791 Test Loss: 0.860 Test Acc: 0.791
Validation loss decreased (-0.749987 --> -0.790616).  Saving model ...
Epoch: 5 cost time: 0.6383960247039795
Epoch: 5, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.608 Vali Acc: 0.794 Test Loss: 0.608 Test Acc: 0.794
Validation loss decreased (-0.790616 --> -0.793744).  Saving model ...
Epoch: 6 cost time: 0.8983850479125977
Epoch: 6, Steps: 8 | Train Loss: 0.475 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
Validation loss decreased (-0.793744 --> -0.824995).  Saving model ...
Epoch: 7 cost time: 0.6927146911621094
Epoch: 7, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.553 Vali Acc: 0.838 Test Loss: 0.553 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837494).  Saving model ...
Epoch: 8 cost time: 0.5985004901885986
Epoch: 8, Steps: 8 | Train Loss: 0.232 Vali Loss: 0.628 Vali Acc: 0.831 Test Loss: 0.628 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7814967632293701
Epoch: 9, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.670 Vali Acc: 0.841 Test Loss: 0.670 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 0.8589515686035156
Epoch: 10, Steps: 8 | Train Loss: 0.105 Vali Loss: 0.635 Vali Acc: 0.863 Test Loss: 0.635 Test Acc: 0.863
Validation loss decreased (-0.840618 --> -0.862494).  Saving model ...
Epoch: 11 cost time: 0.8293201923370361
Epoch: 11, Steps: 8 | Train Loss: 0.062 Vali Loss: 0.715 Vali Acc: 0.859 Test Loss: 0.715 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.779893159866333
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.692 Vali Acc: 0.866 Test Loss: 0.692 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865618).  Saving model ...
Epoch: 13 cost time: 0.6870734691619873
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.720 Vali Acc: 0.872 Test Loss: 0.720 Test Acc: 0.872
Validation loss decreased (-0.865618 --> -0.871868).  Saving model ...
Epoch: 14 cost time: 0.5839643478393555
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.806 Vali Acc: 0.875 Test Loss: 0.806 Test Acc: 0.875
Validation loss decreased (-0.871868 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.6324501037597656
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.866 Test Loss: 0.768 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6794180870056152
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.714 Vali Acc: 0.866 Test Loss: 0.714 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5414166450500488
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.845 Vali Acc: 0.853 Test Loss: 0.845 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8612949848175049
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.923 Vali Acc: 0.875 Test Loss: 0.923 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7517318725585938
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.866 Test Loss: 0.890 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5596377849578857
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.886 Vali Acc: 0.875 Test Loss: 0.886 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8475704193115234
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.872 Test Loss: 0.873 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8239738941192627
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.857 Vali Acc: 0.872 Test Loss: 0.857 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7273838520050049
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.848 Vali Acc: 0.863 Test Loss: 0.848 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7567653656005859
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.875 Test Loss: 0.839 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29559560
model size : 127.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2360806465148926
Epoch: 1, Steps: 8 | Train Loss: 2.153 Vali Loss: 2.050 Vali Acc: 0.212 Test Loss: 2.050 Test Acc: 0.212
Validation loss decreased (inf --> -0.212479).  Saving model ...
Epoch: 2 cost time: 0.6370294094085693
Epoch: 2, Steps: 8 | Train Loss: 1.974 Vali Loss: 1.846 Vali Acc: 0.469 Test Loss: 1.846 Test Acc: 0.469
Validation loss decreased (-0.212479 --> -0.468732).  Saving model ...
Epoch: 3 cost time: 0.5602304935455322
Epoch: 3, Steps: 8 | Train Loss: 1.759 Vali Loss: 1.584 Vali Acc: 0.666 Test Loss: 1.584 Test Acc: 0.666
Validation loss decreased (-0.468732 --> -0.665609).  Saving model ...
Epoch: 4 cost time: 0.44019603729248047
Epoch: 4, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.273 Vali Acc: 0.778 Test Loss: 1.273 Test Acc: 0.778
Validation loss decreased (-0.665609 --> -0.778112).  Saving model ...
Epoch: 5 cost time: 0.7106800079345703
Epoch: 5, Steps: 8 | Train Loss: 1.140 Vali Loss: 0.935 Vali Acc: 0.806 Test Loss: 0.935 Test Acc: 0.806
Validation loss decreased (-0.778112 --> -0.806241).  Saving model ...
Epoch: 6 cost time: 0.5198218822479248
Epoch: 6, Steps: 8 | Train Loss: 0.816 Vali Loss: 0.636 Vali Acc: 0.831 Test Loss: 0.636 Test Acc: 0.831
Validation loss decreased (-0.806241 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.5400750637054443
Epoch: 7, Steps: 8 | Train Loss: 0.576 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7170000076293945
Epoch: 8, Steps: 8 | Train Loss: 0.381 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.5747690200805664
Epoch: 9, Steps: 8 | Train Loss: 0.294 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5577266216278076
Epoch: 10, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.546 Vali Acc: 0.834 Test Loss: 0.546 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6791040897369385
Epoch: 11, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.519 Vali Acc: 0.863 Test Loss: 0.519 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 0.5933191776275635
Epoch: 12, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.580 Vali Acc: 0.859 Test Loss: 0.580 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.644888162612915
Epoch: 13, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.547 Vali Acc: 0.859 Test Loss: 0.547 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6345603466033936
Epoch: 14, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.563 Vali Acc: 0.866 Test Loss: 0.563 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 15 cost time: 0.6327438354492188
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.639 Vali Acc: 0.859 Test Loss: 0.639 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6843280792236328
Epoch: 16, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.622 Vali Acc: 0.866 Test Loss: 0.622 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.643136739730835
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
Validation loss decreased (-0.865619 --> -0.871869).  Saving model ...
Epoch: 18 cost time: 0.6611592769622803
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.881 Test Loss: 0.619 Test Acc: 0.881
Validation loss decreased (-0.871869 --> -0.881244).  Saving model ...
Epoch: 19 cost time: 0.4633669853210449
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.878 Test Loss: 0.642 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7278203964233398
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.668 Vali Acc: 0.884 Test Loss: 0.668 Test Acc: 0.884
Validation loss decreased (-0.881244 --> -0.884368).  Saving model ...
Epoch: 21 cost time: 0.579784631729126
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.681 Vali Acc: 0.884 Test Loss: 0.681 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4773578643798828
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.681 Vali Acc: 0.881 Test Loss: 0.681 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5995800495147705
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6568453311920166
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.694 Vali Acc: 0.878 Test Loss: 0.694 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5961463451385498
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.695 Vali Acc: 0.881 Test Loss: 0.695 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6300444602966309
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.710 Vali Acc: 0.878 Test Loss: 0.710 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5867354869842529
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.735 Vali Acc: 0.872 Test Loss: 0.735 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6046969890594482
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.742 Vali Acc: 0.875 Test Loss: 0.742 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5198988914489746
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.881 Test Loss: 0.730 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4930531978607178
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.884 Test Loss: 0.734 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 29482760
model size : 127.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.472217082977295
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 1.974 Vali Acc: 0.231 Test Loss: 1.974 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.7118380069732666
Epoch: 2, Steps: 8 | Train Loss: 1.853 Vali Loss: 1.562 Vali Acc: 0.603 Test Loss: 1.562 Test Acc: 0.603
Validation loss decreased (-0.231230 --> -0.603109).  Saving model ...
Epoch: 3 cost time: 0.9654114246368408
Epoch: 3, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.093 Vali Acc: 0.753 Test Loss: 1.093 Test Acc: 0.753
Validation loss decreased (-0.603109 --> -0.753114).  Saving model ...
Epoch: 4 cost time: 0.9637875556945801
Epoch: 4, Steps: 8 | Train Loss: 0.884 Vali Loss: 0.685 Vali Acc: 0.812 Test Loss: 0.685 Test Acc: 0.812
Validation loss decreased (-0.753114 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 0.9352996349334717
Epoch: 5, Steps: 8 | Train Loss: 0.500 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
Validation loss decreased (-0.812493 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.6663053035736084
Epoch: 6, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7020494937896729
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6510083675384521
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.820 Vali Acc: 0.806 Test Loss: 0.820 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6906194686889648
Epoch: 9, Steps: 8 | Train Loss: 0.055 Vali Loss: 0.831 Vali Acc: 0.838 Test Loss: 0.831 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5767104625701904
Epoch: 10, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.794 Vali Acc: 0.853 Test Loss: 0.794 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853117).  Saving model ...
Epoch: 11 cost time: 0.5874617099761963
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.846 Vali Acc: 0.844 Test Loss: 0.846 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7893800735473633
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.825 Vali Acc: 0.872 Test Loss: 0.825 Test Acc: 0.872
Validation loss decreased (-0.853117 --> -0.871867).  Saving model ...
Epoch: 13 cost time: 0.6760225296020508
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.890 Vali Acc: 0.853 Test Loss: 0.890 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8590066432952881
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.847 Test Loss: 0.980 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6393477916717529
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.847 Test Loss: 1.005 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7398951053619385
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.859 Test Loss: 0.963 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6312780380249023
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.859 Test Loss: 0.926 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6898016929626465
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.869 Test Loss: 0.915 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8596358299255371
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.931 Vali Acc: 0.869 Test Loss: 0.931 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7129991054534912
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.863 Test Loss: 0.929 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7210049629211426
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.866 Test Loss: 0.928 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8430149555206299
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.875 Test Loss: 0.924 Test Acc: 0.875
Validation loss decreased (-0.871867 --> -0.874991).  Saving model ...
Epoch: 23 cost time: 1.0646569728851318
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.875 Test Loss: 0.934 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9000897407531738
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.866 Test Loss: 0.952 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1198930740356445
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.866 Test Loss: 0.967 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8837440013885498
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.866 Test Loss: 0.976 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.879767656326294
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.866 Test Loss: 0.978 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.13853120803833
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.872 Test Loss: 0.957 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6982216835021973
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.869 Test Loss: 0.948 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8199167251586914
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.869 Test Loss: 0.963 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6392426490783691
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.869 Test Loss: 0.984 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9121155738830566
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.863 Test Loss: 0.995 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29703176
model size : 127.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.367713451385498
Epoch: 1, Steps: 8 | Train Loss: 2.229 Vali Loss: 2.108 Vali Acc: 0.159 Test Loss: 2.108 Test Acc: 0.159
Validation loss decreased (inf --> -0.159354).  Saving model ...
Epoch: 2 cost time: 0.8174178600311279
Epoch: 2, Steps: 8 | Train Loss: 1.992 Vali Loss: 1.804 Vali Acc: 0.525 Test Loss: 1.804 Test Acc: 0.525
Validation loss decreased (-0.159354 --> -0.524982).  Saving model ...
Epoch: 3 cost time: 0.8564271926879883
Epoch: 3, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.464 Vali Acc: 0.769 Test Loss: 1.464 Test Acc: 0.769
Validation loss decreased (-0.524982 --> -0.768735).  Saving model ...
Epoch: 4 cost time: 0.6903321743011475
Epoch: 4, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.028 Vali Acc: 0.828 Test Loss: 1.028 Test Acc: 0.828
Validation loss decreased (-0.768735 --> -0.828115).  Saving model ...
Epoch: 5 cost time: 0.995941162109375
Epoch: 5, Steps: 8 | Train Loss: 0.889 Vali Loss: 0.664 Vali Acc: 0.816 Test Loss: 0.664 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6187169551849365
Epoch: 6, Steps: 8 | Train Loss: 0.570 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.868074893951416
Epoch: 7, Steps: 8 | Train Loss: 0.442 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
Validation loss decreased (-0.828115 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.660090446472168
Epoch: 8, Steps: 8 | Train Loss: 0.274 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7803988456726074
Epoch: 9, Steps: 8 | Train Loss: 0.186 Vali Loss: 0.628 Vali Acc: 0.828 Test Loss: 0.628 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.017934799194336
Epoch: 10, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843744).  Saving model ...
Epoch: 11 cost time: 0.9326770305633545
Epoch: 11, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846868).  Saving model ...
Epoch: 12 cost time: 0.6244535446166992
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.846868 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.6710340976715088
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.719 Vali Acc: 0.834 Test Loss: 0.719 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6436812877655029
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.736 Vali Acc: 0.847 Test Loss: 0.736 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5888288021087646
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.745 Vali Acc: 0.866 Test Loss: 0.745 Test Acc: 0.866
Validation loss decreased (-0.849993 --> -0.865618).  Saving model ...
Epoch: 16 cost time: 0.9706466197967529
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.792 Vali Acc: 0.850 Test Loss: 0.792 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6278674602508545
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.825 Vali Acc: 0.847 Test Loss: 0.825 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6064627170562744
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.844 Test Loss: 0.822 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.934018611907959
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.847 Test Loss: 0.812 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.747448205947876
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.853 Test Loss: 0.800 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.008765459060669
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.810 Vali Acc: 0.856 Test Loss: 0.810 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7907869815826416
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.853 Test Loss: 0.820 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6881933212280273
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.853 Test Loss: 0.832 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9460761547088623
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.853 Test Loss: 0.837 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.593696117401123
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.853 Test Loss: 0.848 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 29564936
model size : 127.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9544568061828613
Epoch: 1, Steps: 8 | Train Loss: 2.061 Vali Loss: 2.028 Vali Acc: 0.216 Test Loss: 2.028 Test Acc: 0.216
Validation loss decreased (inf --> -0.215605).  Saving model ...
Epoch: 2 cost time: 0.6016879081726074
Epoch: 2, Steps: 8 | Train Loss: 1.975 Vali Loss: 1.862 Vali Acc: 0.519 Test Loss: 1.862 Test Acc: 0.519
Validation loss decreased (-0.215605 --> -0.518731).  Saving model ...
Epoch: 3 cost time: 0.5535829067230225
Epoch: 3, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.631 Vali Acc: 0.650 Test Loss: 1.631 Test Acc: 0.650
Validation loss decreased (-0.518731 --> -0.649984).  Saving model ...
Epoch: 4 cost time: 0.5855712890625
Epoch: 4, Steps: 8 | Train Loss: 1.510 Vali Loss: 1.346 Vali Acc: 0.759 Test Loss: 1.346 Test Acc: 0.759
Validation loss decreased (-0.649984 --> -0.759362).  Saving model ...
Epoch: 5 cost time: 0.5887222290039062
Epoch: 5, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.029 Vali Acc: 0.769 Test Loss: 1.029 Test Acc: 0.769
Validation loss decreased (-0.759362 --> -0.768740).  Saving model ...
Epoch: 6 cost time: 0.681311845779419
Epoch: 6, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.749 Vali Acc: 0.794 Test Loss: 0.749 Test Acc: 0.794
Validation loss decreased (-0.768740 --> -0.793743).  Saving model ...
Epoch: 7 cost time: 0.7364389896392822
Epoch: 7, Steps: 8 | Train Loss: 0.644 Vali Loss: 0.599 Vali Acc: 0.794 Test Loss: 0.599 Test Acc: 0.794
Validation loss decreased (-0.793743 --> -0.793744).  Saving model ...
Epoch: 8 cost time: 0.643242597579956
Epoch: 8, Steps: 8 | Train Loss: 0.407 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
Validation loss decreased (-0.793744 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.750676155090332
Epoch: 9, Steps: 8 | Train Loss: 0.293 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.818744 --> -0.828119).  Saving model ...
Epoch: 10 cost time: 0.6141505241394043
Epoch: 10, Steps: 8 | Train Loss: 0.193 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5007786750793457
Epoch: 11, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4744412899017334
Epoch: 12, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.623 Vali Acc: 0.831 Test Loss: 0.623 Test Acc: 0.831
Validation loss decreased (-0.828119 --> -0.831244).  Saving model ...
Epoch: 13 cost time: 0.6427507400512695
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.701 Vali Acc: 0.828 Test Loss: 0.701 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5772867202758789
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.695 Vali Acc: 0.847 Test Loss: 0.695 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846868).  Saving model ...
Epoch: 15 cost time: 0.5153379440307617
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5443618297576904
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.709 Vali Acc: 0.847 Test Loss: 0.709 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5141401290893555
Epoch: 17, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.746 Vali Acc: 0.844 Test Loss: 0.746 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5127637386322021
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.746 Vali Acc: 0.841 Test Loss: 0.746 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6479403972625732
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.737 Vali Acc: 0.834 Test Loss: 0.737 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5356791019439697
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.767 Vali Acc: 0.841 Test Loss: 0.767 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5212459564208984
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.778 Vali Acc: 0.841 Test Loss: 0.778 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.497830867767334
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.769 Vali Acc: 0.841 Test Loss: 0.769 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5052895545959473
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.785 Vali Acc: 0.847 Test Loss: 0.785 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5794589519500732
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.847 Test Loss: 0.792 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 29495816
model size : 127.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.114243268966675
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.986 Vali Acc: 0.291 Test Loss: 1.986 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 0.5640745162963867
Epoch: 2, Steps: 8 | Train Loss: 1.885 Vali Loss: 1.600 Vali Acc: 0.644 Test Loss: 1.600 Test Acc: 0.644
Validation loss decreased (-0.290605 --> -0.643734).  Saving model ...
Epoch: 3 cost time: 0.7318613529205322
Epoch: 3, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.128 Vali Acc: 0.775 Test Loss: 1.128 Test Acc: 0.775
Validation loss decreased (-0.643734 --> -0.774989).  Saving model ...
Epoch: 4 cost time: 1.0731868743896484
Epoch: 4, Steps: 8 | Train Loss: 0.953 Vali Loss: 0.746 Vali Acc: 0.781 Test Loss: 0.746 Test Acc: 0.781
Validation loss decreased (-0.774989 --> -0.781243).  Saving model ...
Epoch: 5 cost time: 0.9182469844818115
Epoch: 5, Steps: 8 | Train Loss: 0.589 Vali Loss: 0.562 Vali Acc: 0.834 Test Loss: 0.562 Test Acc: 0.834
Validation loss decreased (-0.781243 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 0.8837776184082031
Epoch: 6, Steps: 8 | Train Loss: 0.351 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6320586204528809
Epoch: 7, Steps: 8 | Train Loss: 0.226 Vali Loss: 0.533 Vali Acc: 0.834 Test Loss: 0.533 Test Acc: 0.834
Validation loss decreased (-0.834369 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 1.0000030994415283
Epoch: 8, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8818113803863525
Epoch: 9, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.650 Vali Acc: 0.853 Test Loss: 0.650 Test Acc: 0.853
Validation loss decreased (-0.834370 --> -0.853118).  Saving model ...
Epoch: 10 cost time: 0.8763394355773926
Epoch: 10, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.831 Vali Acc: 0.831 Test Loss: 0.831 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6247375011444092
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.868 Vali Acc: 0.838 Test Loss: 0.868 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1200087070465088
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.844 Vali Acc: 0.856 Test Loss: 0.844 Test Acc: 0.856
Validation loss decreased (-0.853118 --> -0.856242).  Saving model ...
Epoch: 13 cost time: 0.906937837600708
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.850 Vali Acc: 0.859 Test Loss: 0.850 Test Acc: 0.859
Validation loss decreased (-0.856242 --> -0.859366).  Saving model ...
Epoch: 14 cost time: 0.8258824348449707
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.856 Test Loss: 0.933 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8083884716033936
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.908 Vali Acc: 0.856 Test Loss: 0.908 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0602188110351562
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.866 Test Loss: 0.884 Test Acc: 0.866
Validation loss decreased (-0.859366 --> -0.865616).  Saving model ...
Epoch: 17 cost time: 0.5607850551605225
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.878 Test Loss: 0.859 Test Acc: 0.878
Validation loss decreased (-0.865616 --> -0.878116).  Saving model ...
Epoch: 18 cost time: 0.6570181846618652
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.934 Vali Acc: 0.863 Test Loss: 0.934 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9869217872619629
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.915 Vali Acc: 0.875 Test Loss: 0.915 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8523166179656982
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.887 Vali Acc: 0.863 Test Loss: 0.887 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5952663421630859
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.050 Vali Acc: 0.834 Test Loss: 1.050 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9357092380523682
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.045 Vali Acc: 0.831 Test Loss: 1.045 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6606161594390869
Epoch: 23, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.894 Vali Acc: 0.863 Test Loss: 0.894 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9357621669769287
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.907 Vali Acc: 0.859 Test Loss: 0.907 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7684938907623291
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.945 Vali Acc: 0.863 Test Loss: 0.945 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7354707717895508
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.834 Test Loss: 1.049 Test Acc: 0.834
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7242555618286133
Epoch: 27, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.933 Vali Acc: 0.872 Test Loss: 0.933 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 29693192
model size : 127.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.15584397315979
Epoch: 1, Steps: 8 | Train Loss: 2.117 Vali Loss: 2.009 Vali Acc: 0.200 Test Loss: 2.009 Test Acc: 0.200
Validation loss decreased (inf --> -0.199980).  Saving model ...
Epoch: 2 cost time: 0.897819995880127
Epoch: 2, Steps: 8 | Train Loss: 1.905 Vali Loss: 1.770 Vali Acc: 0.522 Test Loss: 1.770 Test Acc: 0.522
Validation loss decreased (-0.199980 --> -0.521857).  Saving model ...
Epoch: 3 cost time: 0.8559021949768066
Epoch: 3, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.436 Vali Acc: 0.709 Test Loss: 1.436 Test Acc: 0.709
Validation loss decreased (-0.521857 --> -0.709361).  Saving model ...
Epoch: 4 cost time: 0.5207579135894775
Epoch: 4, Steps: 8 | Train Loss: 1.281 Vali Loss: 1.083 Vali Acc: 0.747 Test Loss: 1.083 Test Acc: 0.747
Validation loss decreased (-0.709361 --> -0.746864).  Saving model ...
Epoch: 5 cost time: 0.8419551849365234
Epoch: 5, Steps: 8 | Train Loss: 0.890 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
Validation loss decreased (-0.746864 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 0.540259599685669
Epoch: 6, Steps: 8 | Train Loss: 0.638 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.828119).  Saving model ...
Epoch: 7 cost time: 0.7530491352081299
Epoch: 7, Steps: 8 | Train Loss: 0.448 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5913047790527344
Epoch: 8, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.488 Vali Acc: 0.853 Test Loss: 0.488 Test Acc: 0.853
Validation loss decreased (-0.828119 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.759397029876709
Epoch: 9, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
Validation loss decreased (-0.853120 --> -0.853120).  Saving model ...
Epoch: 10 cost time: 0.883167028427124
Epoch: 10, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.601 Vali Acc: 0.838 Test Loss: 0.601 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.710256814956665
Epoch: 11, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.571 Vali Acc: 0.853 Test Loss: 0.571 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9840672016143799
Epoch: 12, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.652 Vali Acc: 0.863 Test Loss: 0.652 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862493).  Saving model ...
Epoch: 13 cost time: 0.7188730239868164
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.621 Vali Acc: 0.853 Test Loss: 0.621 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9467413425445557
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.641 Vali Acc: 0.859 Test Loss: 0.641 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6397185325622559
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.707 Vali Acc: 0.869 Test Loss: 0.707 Test Acc: 0.869
Validation loss decreased (-0.862493 --> -0.868743).  Saving model ...
Epoch: 16 cost time: 0.5029523372650146
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.699 Vali Acc: 0.859 Test Loss: 0.699 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8477811813354492
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.701 Vali Acc: 0.869 Test Loss: 0.701 Test Acc: 0.869
Validation loss decreased (-0.868743 --> -0.868743).  Saving model ...
Epoch: 18 cost time: 0.61775803565979
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.738 Vali Acc: 0.866 Test Loss: 0.738 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.578493595123291
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.743 Vali Acc: 0.866 Test Loss: 0.743 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7189657688140869
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.723 Vali Acc: 0.869 Test Loss: 0.723 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5524435043334961
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.863 Test Loss: 0.723 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9169418811798096
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.743 Vali Acc: 0.866 Test Loss: 0.743 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6666486263275146
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.859 Test Loss: 0.783 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6002345085144043
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.786 Vali Acc: 0.863 Test Loss: 0.786 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5560791492462158
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.869 Test Loss: 0.776 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.639695405960083
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.869 Test Loss: 0.775 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8211410045623779
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.866 Test Loss: 0.772 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 29570312
model size : 127.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.222208261489868
Epoch: 1, Steps: 8 | Train Loss: 2.232 Vali Loss: 2.083 Vali Acc: 0.178 Test Loss: 2.083 Test Acc: 0.178
Validation loss decreased (inf --> -0.178104).  Saving model ...
Epoch: 2 cost time: 0.6060070991516113
Epoch: 2, Steps: 8 | Train Loss: 2.020 Vali Loss: 1.893 Vali Acc: 0.409 Test Loss: 1.893 Test Acc: 0.409
Validation loss decreased (-0.178104 --> -0.409356).  Saving model ...
Epoch: 3 cost time: 0.6539461612701416
Epoch: 3, Steps: 8 | Train Loss: 1.807 Vali Loss: 1.663 Vali Acc: 0.613 Test Loss: 1.663 Test Acc: 0.613
Validation loss decreased (-0.409356 --> -0.612483).  Saving model ...
Epoch: 4 cost time: 0.5408496856689453
Epoch: 4, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.407 Vali Acc: 0.709 Test Loss: 1.407 Test Acc: 0.709
Validation loss decreased (-0.612483 --> -0.709361).  Saving model ...
Epoch: 5 cost time: 0.567251443862915
Epoch: 5, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.119 Vali Acc: 0.756 Test Loss: 1.119 Test Acc: 0.756
Validation loss decreased (-0.709361 --> -0.756239).  Saving model ...
Epoch: 6 cost time: 0.5192766189575195
Epoch: 6, Steps: 8 | Train Loss: 1.020 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
Validation loss decreased (-0.756239 --> -0.803117).  Saving model ...
Epoch: 7 cost time: 0.558469295501709
Epoch: 7, Steps: 8 | Train Loss: 0.749 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
Validation loss decreased (-0.803117 --> -0.809369).  Saving model ...
Epoch: 8 cost time: 0.6828954219818115
Epoch: 8, Steps: 8 | Train Loss: 0.472 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.809369 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.5841851234436035
Epoch: 9, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.6064112186431885
Epoch: 10, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6105217933654785
Epoch: 11, Steps: 8 | Train Loss: 0.168 Vali Loss: 0.449 Vali Acc: 0.866 Test Loss: 0.449 Test Acc: 0.866
Validation loss decreased (-0.846870 --> -0.865621).  Saving model ...
Epoch: 12 cost time: 0.5670711994171143
Epoch: 12, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5483028888702393
Epoch: 13, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.558 Vali Acc: 0.847 Test Loss: 0.558 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5603630542755127
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.575 Vali Acc: 0.853 Test Loss: 0.575 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6269149780273438
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6053025722503662
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.554 Vali Acc: 0.869 Test Loss: 0.554 Test Acc: 0.869
Validation loss decreased (-0.865621 --> -0.868744).  Saving model ...
Epoch: 17 cost time: 0.5843329429626465
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.563 Vali Acc: 0.869 Test Loss: 0.563 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6452934741973877
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.572 Vali Acc: 0.869 Test Loss: 0.572 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7019083499908447
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.574 Vali Acc: 0.863 Test Loss: 0.574 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6558694839477539
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.595 Vali Acc: 0.863 Test Loss: 0.595 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5065958499908447
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.610 Vali Acc: 0.866 Test Loss: 0.610 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.552833080291748
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.866 Test Loss: 0.633 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6091108322143555
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.866 Test Loss: 0.635 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6275076866149902
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.866 Test Loss: 0.630 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.563776969909668
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.638 Vali Acc: 0.859 Test Loss: 0.638 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5747566223144531
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.863 Test Loss: 0.661 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 29516552
model size : 127.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8819189071655273
Epoch: 1, Steps: 8 | Train Loss: 2.260 Vali Loss: 2.043 Vali Acc: 0.147 Test Loss: 2.043 Test Acc: 0.147
Validation loss decreased (inf --> -0.146855).  Saving model ...
Epoch: 2 cost time: 0.7348170280456543
Epoch: 2, Steps: 8 | Train Loss: 1.917 Vali Loss: 1.608 Vali Acc: 0.562 Test Loss: 1.608 Test Acc: 0.562
Validation loss decreased (-0.146855 --> -0.562484).  Saving model ...
Epoch: 3 cost time: 0.9585800170898438
Epoch: 3, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.101 Vali Acc: 0.800 Test Loss: 1.101 Test Acc: 0.800
Validation loss decreased (-0.562484 --> -0.799989).  Saving model ...
Epoch: 4 cost time: 0.9094007015228271
Epoch: 4, Steps: 8 | Train Loss: 0.932 Vali Loss: 0.713 Vali Acc: 0.791 Test Loss: 0.713 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7206919193267822
Epoch: 5, Steps: 8 | Train Loss: 0.590 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.799989 --> -0.843745).  Saving model ...
Epoch: 6 cost time: 0.6706979274749756
Epoch: 6, Steps: 8 | Train Loss: 0.390 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9677801132202148
Epoch: 7, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.533 Vali Acc: 0.853 Test Loss: 0.533 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.7530033588409424
Epoch: 8, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6982300281524658
Epoch: 9, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.645 Vali Acc: 0.853 Test Loss: 0.645 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7827553749084473
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.682 Vali Acc: 0.847 Test Loss: 0.682 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5997836589813232
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.750 Vali Acc: 0.859 Test Loss: 0.750 Test Acc: 0.859
Validation loss decreased (-0.853120 --> -0.859367).  Saving model ...
Epoch: 12 cost time: 0.7357356548309326
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.813 Vali Acc: 0.856 Test Loss: 0.813 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7794439792633057
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.798 Vali Acc: 0.844 Test Loss: 0.798 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9956672191619873
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.882 Vali Acc: 0.838 Test Loss: 0.882 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8124172687530518
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.938 Vali Acc: 0.841 Test Loss: 0.938 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0823948383331299
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.971 Vali Acc: 0.844 Test Loss: 0.971 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8263599872589111
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.987 Vali Acc: 0.847 Test Loss: 0.987 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9335229396820068
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.850 Test Loss: 0.958 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7517156600952148
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.853 Test Loss: 0.943 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7707743644714355
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.923 Vali Acc: 0.863 Test Loss: 0.923 Test Acc: 0.863
Validation loss decreased (-0.859367 --> -0.862491).  Saving model ...
Epoch: 21 cost time: 0.9605567455291748
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.859 Test Loss: 0.928 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5973408222198486
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.859 Test Loss: 0.938 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7093501091003418
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.859 Test Loss: 1.000 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6530170440673828
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.963 Vali Acc: 0.856 Test Loss: 0.963 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6487119197845459
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.939 Vali Acc: 0.853 Test Loss: 0.939 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7887990474700928
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.932 Vali Acc: 0.856 Test Loss: 0.932 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7342722415924072
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.922 Vali Acc: 0.847 Test Loss: 0.922 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8323538303375244
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.863 Test Loss: 0.926 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6388883590698242
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.937 Vali Acc: 0.859 Test Loss: 0.937 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0717332363128662
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.863 Test Loss: 0.943 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29697032
model size : 127.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9857795238494873
Epoch: 1, Steps: 8 | Train Loss: 2.075 Vali Loss: 1.988 Vali Acc: 0.291 Test Loss: 1.988 Test Acc: 0.291
Validation loss decreased (inf --> -0.290605).  Saving model ...
Epoch: 2 cost time: 0.6014008522033691
Epoch: 2, Steps: 8 | Train Loss: 1.920 Vali Loss: 1.751 Vali Acc: 0.575 Test Loss: 1.751 Test Acc: 0.575
Validation loss decreased (-0.290605 --> -0.574982).  Saving model ...
Epoch: 3 cost time: 0.5436000823974609
Epoch: 3, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.430 Vali Acc: 0.734 Test Loss: 1.430 Test Acc: 0.734
Validation loss decreased (-0.574982 --> -0.734361).  Saving model ...
Epoch: 4 cost time: 0.5604941844940186
Epoch: 4, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.056 Vali Acc: 0.756 Test Loss: 1.056 Test Acc: 0.756
Validation loss decreased (-0.734361 --> -0.756239).  Saving model ...
Epoch: 5 cost time: 0.6549355983734131
Epoch: 5, Steps: 8 | Train Loss: 0.900 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
Validation loss decreased (-0.756239 --> -0.809368).  Saving model ...
Epoch: 6 cost time: 0.6809155941009521
Epoch: 6, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
Validation loss decreased (-0.809368 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.6702990531921387
Epoch: 7, Steps: 8 | Train Loss: 0.404 Vali Loss: 0.489 Vali Acc: 0.828 Test Loss: 0.489 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6803548336029053
Epoch: 8, Steps: 8 | Train Loss: 0.344 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6929013729095459
Epoch: 9, Steps: 8 | Train Loss: 0.188 Vali Loss: 0.562 Vali Acc: 0.841 Test Loss: 0.562 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.6587121486663818
Epoch: 10, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.567 Vali Acc: 0.853 Test Loss: 0.567 Test Acc: 0.853
Validation loss decreased (-0.840619 --> -0.853119).  Saving model ...
Epoch: 11 cost time: 0.7597472667694092
Epoch: 11, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.526 Vali Acc: 0.866 Test Loss: 0.526 Test Acc: 0.866
Validation loss decreased (-0.853119 --> -0.865620).  Saving model ...
Epoch: 12 cost time: 0.6106014251708984
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.577 Vali Acc: 0.872 Test Loss: 0.577 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871869).  Saving model ...
Epoch: 13 cost time: 0.6500139236450195
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.575 Vali Acc: 0.872 Test Loss: 0.575 Test Acc: 0.872
Validation loss decreased (-0.871869 --> -0.871869).  Saving model ...
Epoch: 14 cost time: 0.6100218296051025
Epoch: 14, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.866 Test Loss: 0.557 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7857494354248047
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.708 Vali Acc: 0.869 Test Loss: 0.708 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7971363067626953
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.747 Vali Acc: 0.841 Test Loss: 0.747 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5673842430114746
Epoch: 17, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.747 Vali Acc: 0.847 Test Loss: 0.747 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7960033416748047
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.677 Vali Acc: 0.863 Test Loss: 0.677 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6844382286071777
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.872 Test Loss: 0.662 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.630171537399292
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.625 Vali Acc: 0.872 Test Loss: 0.625 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5448036193847656
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.5914962291717529
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.734 Vali Acc: 0.869 Test Loss: 0.734 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.555535078048706
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.875 Test Loss: 0.738 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6578023433685303
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.872 Test Loss: 0.724 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5811567306518555
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.878 Test Loss: 0.720 Test Acc: 0.878
Validation loss decreased (-0.874993 --> -0.878118).  Saving model ...
Epoch: 26 cost time: 0.5987904071807861
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5850167274475098
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.878 Test Loss: 0.732 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6688992977142334
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.749 Vali Acc: 0.875 Test Loss: 0.749 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.69429612159729
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.875 Test Loss: 0.754 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.545539140701294
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.872 Test Loss: 0.762 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8804194927215576
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.872 Test Loss: 0.763 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7695178985595703
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.556917667388916
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.872 Test Loss: 0.764 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6112549304962158
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.872 Test Loss: 0.765 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5405263900756836
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.872 Test Loss: 0.769 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 29589512
model size : 127.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1438486576080322
Epoch: 1, Steps: 8 | Train Loss: 2.167 Vali Loss: 2.089 Vali Acc: 0.156 Test Loss: 2.089 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.6803369522094727
Epoch: 2, Steps: 8 | Train Loss: 2.003 Vali Loss: 1.900 Vali Acc: 0.309 Test Loss: 1.900 Test Acc: 0.309
Validation loss decreased (-0.156229 --> -0.309356).  Saving model ...
Epoch: 3 cost time: 0.6250977516174316
Epoch: 3, Steps: 8 | Train Loss: 1.817 Vali Loss: 1.678 Vali Acc: 0.619 Test Loss: 1.678 Test Acc: 0.619
Validation loss decreased (-0.309356 --> -0.618733).  Saving model ...
Epoch: 4 cost time: 0.7071208953857422
Epoch: 4, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.420 Vali Acc: 0.688 Test Loss: 1.420 Test Acc: 0.688
Validation loss decreased (-0.618733 --> -0.687486).  Saving model ...
Epoch: 5 cost time: 0.5949881076812744
Epoch: 5, Steps: 8 | Train Loss: 1.340 Vali Loss: 1.099 Vali Acc: 0.747 Test Loss: 1.099 Test Acc: 0.747
Validation loss decreased (-0.687486 --> -0.746864).  Saving model ...
Epoch: 6 cost time: 0.6231341361999512
Epoch: 6, Steps: 8 | Train Loss: 0.987 Vali Loss: 0.815 Vali Acc: 0.781 Test Loss: 0.815 Test Acc: 0.781
Validation loss decreased (-0.746864 --> -0.781242).  Saving model ...
Epoch: 7 cost time: 0.6201729774475098
Epoch: 7, Steps: 8 | Train Loss: 0.734 Vali Loss: 0.612 Vali Acc: 0.806 Test Loss: 0.612 Test Acc: 0.806
Validation loss decreased (-0.781242 --> -0.806244).  Saving model ...
Epoch: 8 cost time: 0.635422945022583
Epoch: 8, Steps: 8 | Train Loss: 0.480 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
Validation loss decreased (-0.806244 --> -0.818745).  Saving model ...
Epoch: 9 cost time: 0.659278154373169
Epoch: 9, Steps: 8 | Train Loss: 0.330 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
Validation loss decreased (-0.818745 --> -0.818745).  Saving model ...
Epoch: 10 cost time: 0.6560053825378418
Epoch: 10, Steps: 8 | Train Loss: 0.235 Vali Loss: 0.500 Vali Acc: 0.834 Test Loss: 0.500 Test Acc: 0.834
Validation loss decreased (-0.818745 --> -0.834370).  Saving model ...
Epoch: 11 cost time: 0.5910418033599854
Epoch: 11, Steps: 8 | Train Loss: 0.174 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
Validation loss decreased (-0.834370 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.565366268157959
Epoch: 12, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5885441303253174
Epoch: 13, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.548 Vali Acc: 0.834 Test Loss: 0.548 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.607917070388794
Epoch: 14, Steps: 8 | Train Loss: 0.069 Vali Loss: 0.556 Vali Acc: 0.838 Test Loss: 0.556 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6569483280181885
Epoch: 15, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.634 Vali Acc: 0.831 Test Loss: 0.634 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.636028528213501
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.637 Vali Acc: 0.838 Test Loss: 0.637 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.679295539855957
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.644 Vali Acc: 0.831 Test Loss: 0.644 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5306558609008789
Epoch: 18, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 0.5183329582214355
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5749516487121582
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5734467506408691
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.634 Vali Acc: 0.841 Test Loss: 0.634 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6361284255981445
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6094100475311279
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.856243).  Saving model ...
Epoch: 24 cost time: 0.5302486419677734
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.673 Vali Acc: 0.853 Test Loss: 0.673 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.667006254196167
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.856 Test Loss: 0.668 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5970442295074463
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.562981367111206
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
Validation loss decreased (-0.856243 --> -0.856243).  Saving model ...
Epoch: 28 cost time: 0.6560068130493164
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.853 Test Loss: 0.660 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6827213764190674
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.853 Test Loss: 0.660 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7197492122650146
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.692 Vali Acc: 0.856 Test Loss: 0.692 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6547722816467285
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.713 Vali Acc: 0.847 Test Loss: 0.713 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6423170566558838
Epoch: 32, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5346770286560059
Epoch: 33, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.859 Test Loss: 0.712 Test Acc: 0.859
Validation loss decreased (-0.856243 --> -0.859368).  Saving model ...
Epoch: 34 cost time: 0.6668570041656494
Epoch: 34, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.859 Test Loss: 0.688 Test Acc: 0.859
Validation loss decreased (-0.859368 --> -0.859368).  Saving model ...
Epoch: 35 cost time: 0.6464266777038574
Epoch: 35, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.737 Vali Acc: 0.856 Test Loss: 0.737 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5646812915802002
Epoch: 36, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.856 Test Loss: 0.756 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5619738101959229
Epoch: 37, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.859 Test Loss: 0.749 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7051684856414795
Epoch: 38, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.859 Test Loss: 0.736 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6810832023620605
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.856 Test Loss: 0.729 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.624570369720459
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.859 Test Loss: 0.731 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6807653903961182
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.863 Test Loss: 0.739 Test Acc: 0.863
Validation loss decreased (-0.859368 --> -0.862493).  Saving model ...
Epoch: 42 cost time: 0.6550660133361816
Epoch: 42, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.859 Test Loss: 0.751 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7339749336242676
Epoch: 43, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.859 Test Loss: 0.754 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.690852165222168
Epoch: 44, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7199692726135254
Epoch: 45, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.859 Test Loss: 0.745 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.716400146484375
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.713547945022583
Epoch: 47, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.755 Vali Acc: 0.859 Test Loss: 0.755 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7174665927886963
Epoch: 48, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.859 Test Loss: 0.758 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6085827350616455
Epoch: 49, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.856 Test Loss: 0.758 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6427168846130371
Epoch: 50, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.853 Test Loss: 0.760 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29535752
model size : 127.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2850770950317383
Epoch: 1, Steps: 8 | Train Loss: 2.158 Vali Loss: 1.939 Vali Acc: 0.328 Test Loss: 1.939 Test Acc: 0.328
Validation loss decreased (inf --> -0.328106).  Saving model ...
Epoch: 2 cost time: 0.9529829025268555
Epoch: 2, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.584 Vali Acc: 0.700 Test Loss: 1.584 Test Acc: 0.700
Validation loss decreased (-0.328106 --> -0.699984).  Saving model ...
Epoch: 3 cost time: 0.657334566116333
Epoch: 3, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.152 Vali Acc: 0.787 Test Loss: 1.152 Test Acc: 0.787
Validation loss decreased (-0.699984 --> -0.787488).  Saving model ...
Epoch: 4 cost time: 0.803607702255249
Epoch: 4, Steps: 8 | Train Loss: 0.999 Vali Loss: 0.766 Vali Acc: 0.784 Test Loss: 0.766 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9552607536315918
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
Validation loss decreased (-0.787488 --> -0.824995).  Saving model ...
Epoch: 6 cost time: 0.9302587509155273
Epoch: 6, Steps: 8 | Train Loss: 0.394 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.8224689960479736
Epoch: 7, Steps: 8 | Train Loss: 0.375 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.967400074005127
Epoch: 8, Steps: 8 | Train Loss: 0.178 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 9 cost time: 0.5711140632629395
Epoch: 9, Steps: 8 | Train Loss: 0.101 Vali Loss: 0.649 Vali Acc: 0.828 Test Loss: 0.649 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9408035278320312
Epoch: 10, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.6593489646911621
Epoch: 11, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
Validation loss decreased (-0.849993 --> -0.859369).  Saving model ...
Epoch: 12 cost time: 0.866178035736084
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.717 Vali Acc: 0.856 Test Loss: 0.717 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6385700702667236
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.681 Vali Acc: 0.866 Test Loss: 0.681 Test Acc: 0.866
Validation loss decreased (-0.859369 --> -0.865618).  Saving model ...
Epoch: 14 cost time: 0.908728837966919
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.731 Vali Acc: 0.875 Test Loss: 0.731 Test Acc: 0.875
Validation loss decreased (-0.865618 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.681572675704956
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.859 Test Loss: 0.783 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.965003252029419
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.863 Test Loss: 0.804 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6509582996368408
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.792 Vali Acc: 0.866 Test Loss: 0.792 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6575915813446045
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.872 Test Loss: 0.812 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6495819091796875
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.866 Test Loss: 0.816 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9572722911834717
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.866 Test Loss: 0.816 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5726461410522461
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.866 Test Loss: 0.810 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5881040096282959
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.866 Test Loss: 0.824 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8233039379119873
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.866 Test Loss: 0.846 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6666569709777832
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.866 Test Loss: 0.863 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29693192
model size : 127.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0733675956726074
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 2.034 Vali Acc: 0.206 Test Loss: 2.034 Test Acc: 0.206
Validation loss decreased (inf --> -0.206230).  Saving model ...
Epoch: 2 cost time: 0.5098261833190918
Epoch: 2, Steps: 8 | Train Loss: 1.933 Vali Loss: 1.792 Vali Acc: 0.506 Test Loss: 1.792 Test Acc: 0.506
Validation loss decreased (-0.206230 --> -0.506232).  Saving model ...
Epoch: 3 cost time: 0.6626777648925781
Epoch: 3, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.469 Vali Acc: 0.734 Test Loss: 1.469 Test Acc: 0.734
Validation loss decreased (-0.506232 --> -0.734360).  Saving model ...
Epoch: 4 cost time: 0.6093094348907471
Epoch: 4, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.106 Vali Acc: 0.772 Test Loss: 1.106 Test Acc: 0.772
Validation loss decreased (-0.734360 --> -0.771864).  Saving model ...
Epoch: 5 cost time: 0.5539617538452148
Epoch: 5, Steps: 8 | Train Loss: 0.962 Vali Loss: 0.742 Vali Acc: 0.803 Test Loss: 0.742 Test Acc: 0.803
Validation loss decreased (-0.771864 --> -0.803118).  Saving model ...
Epoch: 6 cost time: 0.7691888809204102
Epoch: 6, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
Validation loss decreased (-0.803118 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.6169230937957764
Epoch: 7, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.542 Vali Acc: 0.819 Test Loss: 0.542 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 8 cost time: 0.6534733772277832
Epoch: 8, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.476 Vali Acc: 0.853 Test Loss: 0.476 Test Acc: 0.853
Validation loss decreased (-0.818745 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.8066565990447998
Epoch: 9, Steps: 8 | Train Loss: 0.199 Vali Loss: 0.497 Vali Acc: 0.863 Test Loss: 0.497 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862495).  Saving model ...
Epoch: 10 cost time: 0.5990216732025146
Epoch: 10, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.617 Vali Acc: 0.853 Test Loss: 0.617 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5503473281860352
Epoch: 11, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.583 Vali Acc: 0.856 Test Loss: 0.583 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5051448345184326
Epoch: 12, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.541 Vali Acc: 0.863 Test Loss: 0.541 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5433368682861328
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.646 Vali Acc: 0.859 Test Loss: 0.646 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4657411575317383
Epoch: 14, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.602 Vali Acc: 0.866 Test Loss: 0.602 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 15 cost time: 0.4992706775665283
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.691 Vali Acc: 0.853 Test Loss: 0.691 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4800395965576172
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.600 Vali Acc: 0.872 Test Loss: 0.600 Test Acc: 0.872
Validation loss decreased (-0.865619 --> -0.871869).  Saving model ...
Epoch: 17 cost time: 0.505521297454834
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
Validation loss decreased (-0.871869 --> -0.881244).  Saving model ...
Epoch: 18 cost time: 0.5385942459106445
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.625 Vali Acc: 0.875 Test Loss: 0.625 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5093836784362793
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5847623348236084
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.48578619956970215
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6325645446777344
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.642 Vali Acc: 0.884 Test Loss: 0.642 Test Acc: 0.884
Validation loss decreased (-0.881244 --> -0.884369).  Saving model ...
Epoch: 23 cost time: 0.579056978225708
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.881 Test Loss: 0.676 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.546238899230957
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.685 Vali Acc: 0.881 Test Loss: 0.685 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5549187660217285
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.881 Test Loss: 0.687 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5326361656188965
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.881 Test Loss: 0.690 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6011731624603271
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.884 Test Loss: 0.695 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6506679058074951
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.884 Test Loss: 0.697 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.551443338394165
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.881 Test Loss: 0.710 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5917470455169678
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.875 Test Loss: 0.718 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8425464630126953
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.878 Test Loss: 0.721 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7163279056549072
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.881 Test Loss: 0.714 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 29608712
model size : 127.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1928014755249023
Epoch: 1, Steps: 8 | Train Loss: 2.101 Vali Loss: 1.986 Vali Acc: 0.194 Test Loss: 1.986 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.6916689872741699
Epoch: 2, Steps: 8 | Train Loss: 1.949 Vali Loss: 1.791 Vali Acc: 0.503 Test Loss: 1.791 Test Acc: 0.503
Validation loss decreased (-0.193730 --> -0.503107).  Saving model ...
Epoch: 3 cost time: 0.5845701694488525
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.562 Vali Acc: 0.681 Test Loss: 1.562 Test Acc: 0.681
Validation loss decreased (-0.503107 --> -0.681234).  Saving model ...
Epoch: 4 cost time: 0.6088674068450928
Epoch: 4, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.318 Vali Acc: 0.762 Test Loss: 1.318 Test Acc: 0.762
Validation loss decreased (-0.681234 --> -0.762487).  Saving model ...
Epoch: 5 cost time: 0.5605971813201904
Epoch: 5, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.045 Vali Acc: 0.825 Test Loss: 1.045 Test Acc: 0.825
Validation loss decreased (-0.762487 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.5454981327056885
Epoch: 6, Steps: 8 | Train Loss: 0.988 Vali Loss: 0.813 Vali Acc: 0.806 Test Loss: 0.813 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6017019748687744
Epoch: 7, Steps: 8 | Train Loss: 0.713 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6306366920471191
Epoch: 8, Steps: 8 | Train Loss: 0.439 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6913917064666748
Epoch: 9, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.49085330963134766
Epoch: 10, Steps: 8 | Train Loss: 0.197 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
Validation loss decreased (-0.824990 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 0.4690971374511719
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.5878555774688721
Epoch: 12, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.837495 --> -0.856245).  Saving model ...
Epoch: 13 cost time: 0.5474064350128174
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5139889717102051
Epoch: 14, Steps: 8 | Train Loss: 0.049 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5466930866241455
Epoch: 15, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6201322078704834
Epoch: 16, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6096227169036865
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5636999607086182
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.610252857208252
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6395461559295654
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5928244590759277
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.847 Test Loss: 0.623 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6565413475036621
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.605 Vali Acc: 0.853 Test Loss: 0.605 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 29570312
model size : 127.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3855278491973877
Epoch: 1, Steps: 8 | Train Loss: 2.181 Vali Loss: 2.029 Vali Acc: 0.275 Test Loss: 2.029 Test Acc: 0.275
Validation loss decreased (inf --> -0.274980).  Saving model ...
Epoch: 2 cost time: 0.7415869235992432
Epoch: 2, Steps: 8 | Train Loss: 1.973 Vali Loss: 1.712 Vali Acc: 0.647 Test Loss: 1.712 Test Acc: 0.647
Validation loss decreased (-0.274980 --> -0.646858).  Saving model ...
Epoch: 3 cost time: 0.8883111476898193
Epoch: 3, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.336 Vali Acc: 0.787 Test Loss: 1.336 Test Acc: 0.787
Validation loss decreased (-0.646858 --> -0.787487).  Saving model ...
Epoch: 4 cost time: 0.6086785793304443
Epoch: 4, Steps: 8 | Train Loss: 1.203 Vali Loss: 0.962 Vali Acc: 0.778 Test Loss: 0.962 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.704683780670166
Epoch: 5, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.663 Vali Acc: 0.800 Test Loss: 0.663 Test Acc: 0.800
Validation loss decreased (-0.787487 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 0.9402894973754883
Epoch: 6, Steps: 8 | Train Loss: 0.528 Vali Loss: 0.555 Vali Acc: 0.834 Test Loss: 0.555 Test Acc: 0.834
Validation loss decreased (-0.799993 --> -0.834369).  Saving model ...
Epoch: 7 cost time: 0.667778491973877
Epoch: 7, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
Validation loss decreased (-0.834369 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.7572388648986816
Epoch: 8, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.584 Vali Acc: 0.828 Test Loss: 0.584 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8221700191497803
Epoch: 9, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.639 Vali Acc: 0.838 Test Loss: 0.639 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6780829429626465
Epoch: 10, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.652 Vali Acc: 0.838 Test Loss: 0.652 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6721172332763672
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.743 Vali Acc: 0.825 Test Loss: 0.743 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8801891803741455
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.736 Vali Acc: 0.831 Test Loss: 0.736 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6701908111572266
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.726 Vali Acc: 0.831 Test Loss: 0.726 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9017794132232666
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.861 Vali Acc: 0.834 Test Loss: 0.861 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7265594005584717
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.755 Vali Acc: 0.847 Test Loss: 0.755 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846867).  Saving model ...
Epoch: 16 cost time: 0.8896095752716064
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
Validation loss decreased (-0.846867 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.7138228416442871
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.826 Vali Acc: 0.841 Test Loss: 0.826 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.946624755859375
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.838 Vali Acc: 0.844 Test Loss: 0.838 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7074015140533447
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.826 Vali Acc: 0.850 Test Loss: 0.826 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9365296363830566
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6260693073272705
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.844 Vali Acc: 0.853 Test Loss: 0.844 Test Acc: 0.853
Validation loss decreased (-0.849992 --> -0.853117).  Saving model ...
Epoch: 22 cost time: 0.9670567512512207
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.859 Test Loss: 0.845 Test Acc: 0.859
Validation loss decreased (-0.853117 --> -0.859367).  Saving model ...
Epoch: 23 cost time: 0.6222436428070068
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.869 Test Loss: 0.850 Test Acc: 0.869
Validation loss decreased (-0.859367 --> -0.868741).  Saving model ...
Epoch: 24 cost time: 0.879366397857666
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.863 Test Loss: 0.865 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7224149703979492
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.863 Test Loss: 0.860 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7605977058410645
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.863 Test Loss: 0.853 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6599056720733643
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.863 Test Loss: 0.845 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6951570510864258
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.866 Test Loss: 0.844 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7646126747131348
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.866 Test Loss: 0.846 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7450234889984131
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.856 Test Loss: 0.853 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.686241865158081
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.859 Test Loss: 0.862 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7818379402160645
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.863 Test Loss: 0.870 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7923288345336914
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.863 Test Loss: 0.875 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 29717768
model size : 128.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9598207473754883
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 2.093 Vali Acc: 0.166 Test Loss: 2.093 Test Acc: 0.166
Validation loss decreased (inf --> -0.165604).  Saving model ...
Epoch: 2 cost time: 0.5859024524688721
Epoch: 2, Steps: 8 | Train Loss: 2.043 Vali Loss: 1.871 Vali Acc: 0.497 Test Loss: 1.871 Test Acc: 0.497
Validation loss decreased (-0.165604 --> -0.496856).  Saving model ...
Epoch: 3 cost time: 0.5918934345245361
Epoch: 3, Steps: 8 | Train Loss: 1.767 Vali Loss: 1.611 Vali Acc: 0.716 Test Loss: 1.611 Test Acc: 0.716
Validation loss decreased (-0.496856 --> -0.715609).  Saving model ...
Epoch: 4 cost time: 0.6603777408599854
Epoch: 4, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.295 Vali Acc: 0.787 Test Loss: 1.295 Test Acc: 0.787
Validation loss decreased (-0.715609 --> -0.787487).  Saving model ...
Epoch: 5 cost time: 0.695537805557251
Epoch: 5, Steps: 8 | Train Loss: 1.141 Vali Loss: 0.961 Vali Acc: 0.812 Test Loss: 0.961 Test Acc: 0.812
Validation loss decreased (-0.787487 --> -0.812490).  Saving model ...
Epoch: 6 cost time: 0.5086860656738281
Epoch: 6, Steps: 8 | Train Loss: 0.825 Vali Loss: 0.687 Vali Acc: 0.816 Test Loss: 0.687 Test Acc: 0.816
Validation loss decreased (-0.812490 --> -0.815618).  Saving model ...
Epoch: 7 cost time: 0.6368918418884277
Epoch: 7, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5831949710845947
Epoch: 8, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.815618 --> -0.840620).  Saving model ...
Epoch: 9 cost time: 0.5337314605712891
Epoch: 9, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.529 Vali Acc: 0.834 Test Loss: 0.529 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7028505802154541
Epoch: 10, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.478 Vali Acc: 0.853 Test Loss: 0.478 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 11 cost time: 0.774381160736084
Epoch: 11, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.528 Vali Acc: 0.847 Test Loss: 0.528 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5730748176574707
Epoch: 12, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5728330612182617
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4184455871582031
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862494).  Saving model ...
Epoch: 15 cost time: 0.6668186187744141
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.570 Vali Acc: 0.859 Test Loss: 0.570 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5156435966491699
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.614 Vali Acc: 0.863 Test Loss: 0.614 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5466508865356445
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6680457592010498
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6297531127929688
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.859 Test Loss: 0.640 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5727238655090332
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.654 Vali Acc: 0.859 Test Loss: 0.654 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7601668834686279
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.676 Vali Acc: 0.853 Test Loss: 0.676 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.670771598815918
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.696 Vali Acc: 0.853 Test Loss: 0.696 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5715482234954834
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.853 Test Loss: 0.705 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.679621696472168
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.856 Test Loss: 0.690 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 29648648
model size : 127.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4334893226623535
Epoch: 1, Steps: 8 | Train Loss: 2.176 Vali Loss: 2.077 Vali Acc: 0.078 Test Loss: 2.077 Test Acc: 0.078
Validation loss decreased (inf --> -0.078104).  Saving model ...
Epoch: 2 cost time: 0.4816250801086426
Epoch: 2, Steps: 8 | Train Loss: 2.009 Vali Loss: 1.903 Vali Acc: 0.369 Test Loss: 1.903 Test Acc: 0.369
Validation loss decreased (-0.078104 --> -0.368731).  Saving model ...
Epoch: 3 cost time: 0.6341495513916016
Epoch: 3, Steps: 8 | Train Loss: 1.862 Vali Loss: 1.692 Vali Acc: 0.647 Test Loss: 1.692 Test Acc: 0.647
Validation loss decreased (-0.368731 --> -0.646858).  Saving model ...
Epoch: 4 cost time: 0.590411901473999
Epoch: 4, Steps: 8 | Train Loss: 1.639 Vali Loss: 1.451 Vali Acc: 0.719 Test Loss: 1.451 Test Acc: 0.719
Validation loss decreased (-0.646858 --> -0.718735).  Saving model ...
Epoch: 5 cost time: 0.6288321018218994
Epoch: 5, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.176 Vali Acc: 0.741 Test Loss: 1.176 Test Acc: 0.741
Validation loss decreased (-0.718735 --> -0.740613).  Saving model ...
Epoch: 6 cost time: 0.6757323741912842
Epoch: 6, Steps: 8 | Train Loss: 1.071 Vali Loss: 0.908 Vali Acc: 0.794 Test Loss: 0.908 Test Acc: 0.794
Validation loss decreased (-0.740613 --> -0.793741).  Saving model ...
Epoch: 7 cost time: 0.5959365367889404
Epoch: 7, Steps: 8 | Train Loss: 0.856 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
Validation loss decreased (-0.793741 --> -0.793743).  Saving model ...
Epoch: 8 cost time: 0.6763067245483398
Epoch: 8, Steps: 8 | Train Loss: 0.620 Vali Loss: 0.616 Vali Acc: 0.791 Test Loss: 0.616 Test Acc: 0.791
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.695504903793335
Epoch: 9, Steps: 8 | Train Loss: 0.426 Vali Loss: 0.547 Vali Acc: 0.806 Test Loss: 0.547 Test Acc: 0.806
Validation loss decreased (-0.793743 --> -0.806245).  Saving model ...
Epoch: 10 cost time: 0.6539785861968994
Epoch: 10, Steps: 8 | Train Loss: 0.326 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
Validation loss decreased (-0.806245 --> -0.815620).  Saving model ...
Epoch: 11 cost time: 0.6208724975585938
Epoch: 11, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
Validation loss decreased (-0.815620 --> -0.837495).  Saving model ...
Epoch: 12 cost time: 0.6863749027252197
Epoch: 12, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 0.702979564666748
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6180939674377441
Epoch: 14, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5335958003997803
Epoch: 15, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.552 Vali Acc: 0.853 Test Loss: 0.552 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 16 cost time: 0.6005961894989014
Epoch: 16, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5213887691497803
Epoch: 17, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856245).  Saving model ...
Epoch: 18 cost time: 0.6200244426727295
Epoch: 18, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6219325065612793
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.586 Vali Acc: 0.853 Test Loss: 0.586 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6210050582885742
Epoch: 20, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5941438674926758
Epoch: 21, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6880948543548584
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.576 Vali Acc: 0.847 Test Loss: 0.576 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6267409324645996
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.847 Test Loss: 0.589 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5678553581237793
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.598 Vali Acc: 0.853 Test Loss: 0.598 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5276002883911133
Epoch: 25, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.853 Test Loss: 0.606 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4910590648651123
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.618 Vali Acc: 0.853 Test Loss: 0.618 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5012013912200928
Epoch: 27, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.621 Vali Acc: 0.853 Test Loss: 0.621 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 29610248
model size : 127.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9340486526489258
Epoch: 1, Steps: 8 | Train Loss: 2.143 Vali Loss: 1.985 Vali Acc: 0.247 Test Loss: 1.985 Test Acc: 0.247
Validation loss decreased (inf --> -0.246855).  Saving model ...
Epoch: 2 cost time: 0.5887794494628906
Epoch: 2, Steps: 8 | Train Loss: 1.886 Vali Loss: 1.683 Vali Acc: 0.619 Test Loss: 1.683 Test Acc: 0.619
Validation loss decreased (-0.246855 --> -0.618733).  Saving model ...
Epoch: 3 cost time: 0.8115060329437256
Epoch: 3, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.337 Vali Acc: 0.716 Test Loss: 1.337 Test Acc: 0.716
Validation loss decreased (-0.618733 --> -0.715612).  Saving model ...
Epoch: 4 cost time: 0.5104811191558838
Epoch: 4, Steps: 8 | Train Loss: 1.193 Vali Loss: 0.991 Vali Acc: 0.784 Test Loss: 0.991 Test Acc: 0.784
Validation loss decreased (-0.715612 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 0.7351305484771729
Epoch: 5, Steps: 8 | Train Loss: 0.869 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
Validation loss decreased (-0.784365 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 0.8199307918548584
Epoch: 6, Steps: 8 | Train Loss: 0.565 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
Validation loss decreased (-0.799993 --> -0.815620).  Saving model ...
Epoch: 7 cost time: 1.0074186325073242
Epoch: 7, Steps: 8 | Train Loss: 0.362 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
Validation loss decreased (-0.815620 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.5564930438995361
Epoch: 8, Steps: 8 | Train Loss: 0.260 Vali Loss: 0.510 Vali Acc: 0.831 Test Loss: 0.510 Test Acc: 0.831
Validation loss decreased (-0.831245 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.9776251316070557
Epoch: 9, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.578 Vali Acc: 0.841 Test Loss: 0.578 Test Acc: 0.841
Validation loss decreased (-0.831245 --> -0.840619).  Saving model ...
Epoch: 10 cost time: 0.6471273899078369
Epoch: 10, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 0.7789883613586426
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.597 Vali Acc: 0.863 Test Loss: 0.597 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862494).  Saving model ...
Epoch: 12 cost time: 0.47734594345092773
Epoch: 12, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6419312953948975
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.729 Vali Acc: 0.844 Test Loss: 0.729 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9019038677215576
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.727 Vali Acc: 0.866 Test Loss: 0.727 Test Acc: 0.866
Validation loss decreased (-0.862494 --> -0.865618).  Saving model ...
Epoch: 15 cost time: 0.9334836006164551
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.649 Vali Acc: 0.866 Test Loss: 0.649 Test Acc: 0.866
Validation loss decreased (-0.865618 --> -0.865619).  Saving model ...
Epoch: 16 cost time: 0.6342043876647949
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.683 Vali Acc: 0.859 Test Loss: 0.683 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4964587688446045
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.711 Vali Acc: 0.863 Test Loss: 0.711 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6366860866546631
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.744 Vali Acc: 0.847 Test Loss: 0.744 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8725738525390625
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6102778911590576
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6366066932678223
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.847 Test Loss: 0.777 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.922271728515625
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.856 Test Loss: 0.785 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6514356136322021
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.853 Test Loss: 0.801 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8762474060058594
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.853 Test Loss: 0.789 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6122276782989502
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.856 Test Loss: 0.785 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 29763848
model size : 128.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.100043773651123
Epoch: 1, Steps: 8 | Train Loss: 2.302 Vali Loss: 2.100 Vali Acc: 0.194 Test Loss: 2.100 Test Acc: 0.194
Validation loss decreased (inf --> -0.193729).  Saving model ...
Epoch: 2 cost time: 0.5739359855651855
Epoch: 2, Steps: 8 | Train Loss: 2.014 Vali Loss: 1.838 Vali Acc: 0.416 Test Loss: 1.838 Test Acc: 0.416
Validation loss decreased (-0.193729 --> -0.415607).  Saving model ...
Epoch: 3 cost time: 0.6412694454193115
Epoch: 3, Steps: 8 | Train Loss: 1.740 Vali Loss: 1.555 Vali Acc: 0.700 Test Loss: 1.555 Test Acc: 0.700
Validation loss decreased (-0.415607 --> -0.699984).  Saving model ...
Epoch: 4 cost time: 0.6027631759643555
Epoch: 4, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.242 Vali Acc: 0.772 Test Loss: 1.242 Test Acc: 0.772
Validation loss decreased (-0.699984 --> -0.771863).  Saving model ...
Epoch: 5 cost time: 0.6906704902648926
Epoch: 5, Steps: 8 | Train Loss: 1.183 Vali Loss: 0.929 Vali Acc: 0.803 Test Loss: 0.929 Test Acc: 0.803
Validation loss decreased (-0.771863 --> -0.803116).  Saving model ...
Epoch: 6 cost time: 0.6253316402435303
Epoch: 6, Steps: 8 | Train Loss: 0.850 Vali Loss: 0.680 Vali Acc: 0.809 Test Loss: 0.680 Test Acc: 0.809
Validation loss decreased (-0.803116 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 0.6186175346374512
Epoch: 7, Steps: 8 | Train Loss: 0.602 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
Validation loss decreased (-0.809368 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.6502258777618408
Epoch: 8, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.519 Vali Acc: 0.825 Test Loss: 0.519 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.47060561180114746
Epoch: 9, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.5887126922607422
Epoch: 10, Steps: 8 | Train Loss: 0.247 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47019410133361816
Epoch: 11, Steps: 8 | Train Loss: 0.138 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
Validation loss decreased (-0.846870 --> -0.856245).  Saving model ...
Epoch: 12 cost time: 0.5942509174346924
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.553 Vali Acc: 0.834 Test Loss: 0.553 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6133508682250977
Epoch: 13, Steps: 8 | Train Loss: 0.058 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5805540084838867
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.665 Vali Acc: 0.853 Test Loss: 0.665 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6766767501831055
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.618257999420166
Epoch: 16, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.577 Vali Acc: 0.859 Test Loss: 0.577 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859369).  Saving model ...
Epoch: 17 cost time: 0.5528593063354492
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.618 Vali Acc: 0.859 Test Loss: 0.618 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5995609760284424
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.628 Vali Acc: 0.866 Test Loss: 0.628 Test Acc: 0.866
Validation loss decreased (-0.859369 --> -0.865619).  Saving model ...
Epoch: 19 cost time: 0.6135098934173584
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.625 Vali Acc: 0.863 Test Loss: 0.625 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6035177707672119
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.863 Test Loss: 0.626 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6482014656066895
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.629 Vali Acc: 0.863 Test Loss: 0.629 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5918974876403809
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.866 Test Loss: 0.642 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5389034748077393
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.869 Test Loss: 0.648 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868744).  Saving model ...
Epoch: 24 cost time: 0.6954641342163086
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.872 Test Loss: 0.661 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871868).  Saving model ...
Epoch: 25 cost time: 0.6770927906036377
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.872 Test Loss: 0.674 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7061035633087158
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.863 Test Loss: 0.677 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5755355358123779
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.872 Test Loss: 0.670 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6782188415527344
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.668 Vali Acc: 0.872 Test Loss: 0.668 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7153487205505371
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
Validation loss decreased (-0.871868 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 0.4945225715637207
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.875 Test Loss: 0.696 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5613243579864502
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.872 Test Loss: 0.709 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6925263404846191
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.863 Test Loss: 0.707 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5793004035949707
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.863 Test Loss: 0.709 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6574716567993164
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.866 Test Loss: 0.717 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7293753623962402
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.866 Test Loss: 0.723 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6278707981109619
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.863 Test Loss: 0.732 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5297996997833252
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.614492654800415
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.863 Test Loss: 0.741 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5502574443817139
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.863 Test Loss: 0.744 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 29702408
model size : 127.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2584314346313477
Epoch: 1, Steps: 8 | Train Loss: 2.260 Vali Loss: 2.116 Vali Acc: 0.134 Test Loss: 2.116 Test Acc: 0.134
Validation loss decreased (inf --> -0.134354).  Saving model ...
Epoch: 2 cost time: 0.5512697696685791
Epoch: 2, Steps: 8 | Train Loss: 2.079 Vali Loss: 1.943 Vali Acc: 0.272 Test Loss: 1.943 Test Acc: 0.272
Validation loss decreased (-0.134354 --> -0.271856).  Saving model ...
Epoch: 3 cost time: 0.5551071166992188
Epoch: 3, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.737 Vali Acc: 0.600 Test Loss: 1.737 Test Acc: 0.600
Validation loss decreased (-0.271856 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 0.6882905960083008
Epoch: 4, Steps: 8 | Train Loss: 1.668 Vali Loss: 1.512 Vali Acc: 0.750 Test Loss: 1.512 Test Acc: 0.750
Validation loss decreased (-0.599983 --> -0.749985).  Saving model ...
Epoch: 5 cost time: 0.6721508502960205
Epoch: 5, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.249 Vali Acc: 0.781 Test Loss: 1.249 Test Acc: 0.781
Validation loss decreased (-0.749985 --> -0.781238).  Saving model ...
Epoch: 6 cost time: 0.6816127300262451
Epoch: 6, Steps: 8 | Train Loss: 1.184 Vali Loss: 0.960 Vali Acc: 0.791 Test Loss: 0.960 Test Acc: 0.791
Validation loss decreased (-0.781238 --> -0.790615).  Saving model ...
Epoch: 7 cost time: 0.5648238658905029
Epoch: 7, Steps: 8 | Train Loss: 0.859 Vali Loss: 0.716 Vali Acc: 0.825 Test Loss: 0.716 Test Acc: 0.825
Validation loss decreased (-0.790615 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 0.555474042892456
Epoch: 8, Steps: 8 | Train Loss: 0.631 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 0.6975235939025879
Epoch: 9, Steps: 8 | Train Loss: 0.449 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.5478100776672363
Epoch: 10, Steps: 8 | Train Loss: 0.314 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853121).  Saving model ...
Epoch: 11 cost time: 0.5639102458953857
Epoch: 11, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.452 Vali Acc: 0.847 Test Loss: 0.452 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.456859827041626
Epoch: 12, Steps: 8 | Train Loss: 0.121 Vali Loss: 0.436 Vali Acc: 0.869 Test Loss: 0.436 Test Acc: 0.869
Validation loss decreased (-0.853121 --> -0.868746).  Saving model ...
Epoch: 13 cost time: 0.6132276058197021
Epoch: 13, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.474 Vali Acc: 0.847 Test Loss: 0.474 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6023685932159424
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5542910099029541
Epoch: 15, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.473 Vali Acc: 0.866 Test Loss: 0.473 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4991319179534912
Epoch: 16, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.486 Vali Acc: 0.859 Test Loss: 0.486 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.45725035667419434
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.503 Vali Acc: 0.869 Test Loss: 0.503 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6001846790313721
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.866 Test Loss: 0.512 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6584463119506836
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.524 Vali Acc: 0.869 Test Loss: 0.524 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5312333106994629
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.531 Vali Acc: 0.866 Test Loss: 0.531 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6277382373809814
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.546 Vali Acc: 0.866 Test Loss: 0.546 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.543302059173584
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.567 Vali Acc: 0.863 Test Loss: 0.567 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el4_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 29679368
model size : 127.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9866554737091064
Epoch: 1, Steps: 8 | Train Loss: 2.210 Vali Loss: 1.845 Vali Acc: 0.409 Test Loss: 1.845 Test Acc: 0.409
Validation loss decreased (inf --> -0.409357).  Saving model ...
Epoch: 2 cost time: 0.7613663673400879
Epoch: 2, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.235 Vali Acc: 0.703 Test Loss: 1.235 Test Acc: 0.703
Validation loss decreased (-0.409357 --> -0.703113).  Saving model ...
Epoch: 3 cost time: 0.8463239669799805
Epoch: 3, Steps: 8 | Train Loss: 0.990 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
Validation loss decreased (-0.703113 --> -0.799992).  Saving model ...
Epoch: 4 cost time: 0.9746191501617432
Epoch: 4, Steps: 8 | Train Loss: 0.573 Vali Loss: 0.570 Vali Acc: 0.825 Test Loss: 0.570 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.8667252063751221
Epoch: 5, Steps: 8 | Train Loss: 0.364 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
Validation loss decreased (-0.824994 --> -0.840620).  Saving model ...
Epoch: 6 cost time: 0.9178838729858398
Epoch: 6, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.542 Vali Acc: 0.841 Test Loss: 0.542 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7345147132873535
Epoch: 7, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9730162620544434
Epoch: 8, Steps: 8 | Train Loss: 0.118 Vali Loss: 0.762 Vali Acc: 0.831 Test Loss: 0.762 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.75406813621521
Epoch: 9, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.788 Vali Acc: 0.866 Test Loss: 0.788 Test Acc: 0.866
Validation loss decreased (-0.840620 --> -0.865617).  Saving model ...
Epoch: 10 cost time: 0.6597695350646973
Epoch: 10, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.000 Vali Acc: 0.841 Test Loss: 1.000 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5887279510498047
Epoch: 11, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.308 Vali Acc: 0.812 Test Loss: 1.308 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6049425601959229
Epoch: 12, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.364 Vali Acc: 0.819 Test Loss: 1.364 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6662397384643555
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.540 Vali Acc: 0.822 Test Loss: 1.540 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7074036598205566
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.351 Vali Acc: 0.850 Test Loss: 1.351 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.709763765335083
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.539 Vali Acc: 0.841 Test Loss: 1.539 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.731694221496582
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.500 Vali Acc: 0.838 Test Loss: 1.500 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7490620613098145
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.900 Vali Acc: 0.822 Test Loss: 1.900 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7191331386566162
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.153 Vali Acc: 0.800 Test Loss: 2.153 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8235776424407959
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.831 Test Loss: 1.911 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 22791176
model size : 101.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0923070907592773
Epoch: 1, Steps: 8 | Train Loss: 2.107 Vali Loss: 1.951 Vali Acc: 0.325 Test Loss: 1.951 Test Acc: 0.325
Validation loss decreased (inf --> -0.324980).  Saving model ...
Epoch: 2 cost time: 0.5868749618530273
Epoch: 2, Steps: 8 | Train Loss: 1.774 Vali Loss: 1.502 Vali Acc: 0.691 Test Loss: 1.502 Test Acc: 0.691
Validation loss decreased (-0.324980 --> -0.690610).  Saving model ...
Epoch: 3 cost time: 0.9624488353729248
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.072 Vali Acc: 0.756 Test Loss: 1.072 Test Acc: 0.756
Validation loss decreased (-0.690610 --> -0.756239).  Saving model ...
Epoch: 4 cost time: 0.6089580059051514
Epoch: 4, Steps: 8 | Train Loss: 0.799 Vali Loss: 0.726 Vali Acc: 0.822 Test Loss: 0.726 Test Acc: 0.822
Validation loss decreased (-0.756239 --> -0.821868).  Saving model ...
Epoch: 5 cost time: 0.5781805515289307
Epoch: 5, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.568 Vali Acc: 0.834 Test Loss: 0.568 Test Acc: 0.834
Validation loss decreased (-0.821868 --> -0.834369).  Saving model ...
Epoch: 6 cost time: 0.6248769760131836
Epoch: 6, Steps: 8 | Train Loss: 0.369 Vali Loss: 0.516 Vali Acc: 0.831 Test Loss: 0.516 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5921013355255127
Epoch: 7, Steps: 8 | Train Loss: 0.279 Vali Loss: 0.549 Vali Acc: 0.831 Test Loss: 0.549 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0778307914733887
Epoch: 8, Steps: 8 | Train Loss: 0.201 Vali Loss: 0.592 Vali Acc: 0.853 Test Loss: 0.592 Test Acc: 0.853
Validation loss decreased (-0.834369 --> -0.853119).  Saving model ...
Epoch: 9 cost time: 0.6593680381774902
Epoch: 9, Steps: 8 | Train Loss: 0.149 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
Validation loss decreased (-0.853119 --> -0.871869).  Saving model ...
Epoch: 10 cost time: 0.6219124794006348
Epoch: 10, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.977 Vali Acc: 0.822 Test Loss: 0.977 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9025688171386719
Epoch: 11, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.801 Vali Acc: 0.853 Test Loss: 0.801 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7640340328216553
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.166 Vali Acc: 0.844 Test Loss: 1.166 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9399998188018799
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.089 Vali Acc: 0.841 Test Loss: 1.089 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7355632781982422
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.146 Vali Acc: 0.838 Test Loss: 1.146 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7566330432891846
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.277 Vali Acc: 0.831 Test Loss: 1.277 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9428818225860596
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.224 Vali Acc: 0.838 Test Loss: 1.224 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7654869556427002
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.159 Vali Acc: 0.844 Test Loss: 1.159 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8403587341308594
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.157 Vali Acc: 0.853 Test Loss: 1.157 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8651204109191895
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.186 Vali Acc: 0.850 Test Loss: 1.186 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22545416
model size : 100.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2165284156799316
Epoch: 1, Steps: 8 | Train Loss: 2.180 Vali Loss: 2.040 Vali Acc: 0.259 Test Loss: 2.040 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 0.7860310077667236
Epoch: 2, Steps: 8 | Train Loss: 1.965 Vali Loss: 1.724 Vali Acc: 0.584 Test Loss: 1.724 Test Acc: 0.584
Validation loss decreased (-0.259355 --> -0.584358).  Saving model ...
Epoch: 3 cost time: 0.5685718059539795
Epoch: 3, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.354 Vali Acc: 0.741 Test Loss: 1.354 Test Acc: 0.741
Validation loss decreased (-0.584358 --> -0.740611).  Saving model ...
Epoch: 4 cost time: 0.7232534885406494
Epoch: 4, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.028 Vali Acc: 0.784 Test Loss: 1.028 Test Acc: 0.784
Validation loss decreased (-0.740611 --> -0.784365).  Saving model ...
Epoch: 5 cost time: 0.5258722305297852
Epoch: 5, Steps: 8 | Train Loss: 0.806 Vali Loss: 0.765 Vali Acc: 0.791 Test Loss: 0.765 Test Acc: 0.791
Validation loss decreased (-0.784365 --> -0.790617).  Saving model ...
Epoch: 6 cost time: 0.8076694011688232
Epoch: 6, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.575 Vali Acc: 0.831 Test Loss: 0.575 Test Acc: 0.831
Validation loss decreased (-0.790617 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.5277981758117676
Epoch: 7, Steps: 8 | Train Loss: 0.417 Vali Loss: 0.500 Vali Acc: 0.828 Test Loss: 0.500 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8801047801971436
Epoch: 8, Steps: 8 | Train Loss: 0.284 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6017074584960938
Epoch: 9, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.561 Vali Acc: 0.825 Test Loss: 0.561 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.42652106285095215
Epoch: 10, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.650 Vali Acc: 0.859 Test Loss: 0.650 Test Acc: 0.859
Validation loss decreased (-0.831244 --> -0.859368).  Saving model ...
Epoch: 11 cost time: 0.8243143558502197
Epoch: 11, Steps: 8 | Train Loss: 0.085 Vali Loss: 0.693 Vali Acc: 0.822 Test Loss: 0.693 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5211203098297119
Epoch: 12, Steps: 8 | Train Loss: 0.054 Vali Loss: 0.931 Vali Acc: 0.822 Test Loss: 0.931 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.512291431427002
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.823 Vali Acc: 0.847 Test Loss: 0.823 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8501043319702148
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.766 Vali Acc: 0.863 Test Loss: 0.766 Test Acc: 0.863
Validation loss decreased (-0.859368 --> -0.862492).  Saving model ...
Epoch: 15 cost time: 0.5955777168273926
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.803 Vali Acc: 0.844 Test Loss: 0.803 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7826659679412842
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.804 Vali Acc: 0.863 Test Loss: 0.804 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5483629703521729
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.856 Test Loss: 0.863 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4778451919555664
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.901 Vali Acc: 0.863 Test Loss: 0.901 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7286159992218018
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.870 Vali Acc: 0.866 Test Loss: 0.870 Test Acc: 0.866
Validation loss decreased (-0.862492 --> -0.865616).  Saving model ...
Epoch: 20 cost time: 0.5672504901885986
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.863 Test Loss: 0.895 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.45461559295654297
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.853 Test Loss: 0.936 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4695425033569336
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.859 Test Loss: 0.947 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7602794170379639
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.863 Test Loss: 0.954 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5552144050598145
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.866 Test Loss: 0.942 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4929838180541992
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.866 Test Loss: 0.928 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.813873291015625
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.937 Vali Acc: 0.859 Test Loss: 0.937 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5366144180297852
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.853 Test Loss: 0.950 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.603583812713623
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.856 Test Loss: 0.958 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7523231506347656
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.850 Test Loss: 0.958 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 22391816
model size : 100.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1731834411621094
Epoch: 1, Steps: 8 | Train Loss: 2.184 Vali Loss: 1.829 Vali Acc: 0.466 Test Loss: 1.829 Test Acc: 0.466
Validation loss decreased (inf --> -0.465607).  Saving model ...
Epoch: 2 cost time: 0.9823169708251953
Epoch: 2, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.198 Vali Acc: 0.684 Test Loss: 1.198 Test Acc: 0.684
Validation loss decreased (-0.465607 --> -0.684363).  Saving model ...
Epoch: 3 cost time: 0.7863292694091797
Epoch: 3, Steps: 8 | Train Loss: 0.947 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
Validation loss decreased (-0.684363 --> -0.803118).  Saving model ...
Epoch: 4 cost time: 0.6775302886962891
Epoch: 4, Steps: 8 | Train Loss: 0.543 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
Validation loss decreased (-0.803118 --> -0.815620).  Saving model ...
Epoch: 5 cost time: 0.9949595928192139
Epoch: 5, Steps: 8 | Train Loss: 0.512 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
Validation loss decreased (-0.815620 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 0.7304837703704834
Epoch: 6, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0771081447601318
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8219311237335205
Epoch: 8, Steps: 8 | Train Loss: 0.166 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862494).  Saving model ...
Epoch: 9 cost time: 1.0003972053527832
Epoch: 9, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.878 Vali Acc: 0.825 Test Loss: 0.878 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8400804996490479
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.976 Vali Acc: 0.838 Test Loss: 0.976 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7972097396850586
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.223 Vali Acc: 0.812 Test Loss: 1.223 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7727530002593994
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.266 Vali Acc: 0.828 Test Loss: 1.266 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8315396308898926
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.498 Vali Acc: 0.803 Test Loss: 1.498 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8751614093780518
Epoch: 14, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.601 Vali Acc: 0.834 Test Loss: 1.601 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6904432773590088
Epoch: 15, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.196 Vali Acc: 0.859 Test Loss: 1.196 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.790358304977417
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.532 Vali Acc: 0.847 Test Loss: 1.532 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7157301902770996
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.438 Vali Acc: 0.841 Test Loss: 1.438 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8443903923034668
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.286 Vali Acc: 0.850 Test Loss: 1.286 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 22798088
model size : 101.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1961822509765625
Epoch: 1, Steps: 8 | Train Loss: 2.095 Vali Loss: 1.890 Vali Acc: 0.375 Test Loss: 1.890 Test Acc: 0.375
Validation loss decreased (inf --> -0.374981).  Saving model ...
Epoch: 2 cost time: 0.6561324596405029
Epoch: 2, Steps: 8 | Train Loss: 1.769 Vali Loss: 1.407 Vali Acc: 0.728 Test Loss: 1.407 Test Acc: 0.728
Validation loss decreased (-0.374981 --> -0.728111).  Saving model ...
Epoch: 3 cost time: 0.5788576602935791
Epoch: 3, Steps: 8 | Train Loss: 1.172 Vali Loss: 0.943 Vali Acc: 0.791 Test Loss: 0.943 Test Acc: 0.791
Validation loss decreased (-0.728111 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 0.5572702884674072
Epoch: 4, Steps: 8 | Train Loss: 0.803 Vali Loss: 0.670 Vali Acc: 0.834 Test Loss: 0.670 Test Acc: 0.834
Validation loss decreased (-0.790616 --> -0.834368).  Saving model ...
Epoch: 5 cost time: 0.5746889114379883
Epoch: 5, Steps: 8 | Train Loss: 0.541 Vali Loss: 0.548 Vali Acc: 0.812 Test Loss: 0.548 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5753369331359863
Epoch: 6, Steps: 8 | Train Loss: 0.370 Vali Loss: 0.487 Vali Acc: 0.847 Test Loss: 0.487 Test Acc: 0.847
Validation loss decreased (-0.834368 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.6309597492218018
Epoch: 7, Steps: 8 | Train Loss: 0.305 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.5688354969024658
Epoch: 8, Steps: 8 | Train Loss: 0.182 Vali Loss: 0.583 Vali Acc: 0.831 Test Loss: 0.583 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5824270248413086
Epoch: 9, Steps: 8 | Train Loss: 0.122 Vali Loss: 0.604 Vali Acc: 0.863 Test Loss: 0.604 Test Acc: 0.863
Validation loss decreased (-0.849995 --> -0.862494).  Saving model ...
Epoch: 10 cost time: 0.7566359043121338
Epoch: 10, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.743 Vali Acc: 0.844 Test Loss: 0.743 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9208788871765137
Epoch: 11, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.828 Vali Acc: 0.822 Test Loss: 0.828 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6589171886444092
Epoch: 12, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.864 Vali Acc: 0.863 Test Loss: 0.864 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9219567775726318
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5143084526062012
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.946 Vali Acc: 0.850 Test Loss: 0.946 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7148714065551758
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.919 Vali Acc: 0.856 Test Loss: 0.919 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6487946510314941
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.923 Vali Acc: 0.850 Test Loss: 0.923 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8990318775177002
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.841 Test Loss: 1.145 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6268296241760254
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.844 Test Loss: 1.063 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9346182346343994
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.856 Test Loss: 0.992 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 22552328
model size : 100.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.035154104232788
Epoch: 1, Steps: 8 | Train Loss: 2.252 Vali Loss: 1.987 Vali Acc: 0.259 Test Loss: 1.987 Test Acc: 0.259
Validation loss decreased (inf --> -0.259355).  Saving model ...
Epoch: 2 cost time: 0.5183298587799072
Epoch: 2, Steps: 8 | Train Loss: 1.947 Vali Loss: 1.689 Vali Acc: 0.606 Test Loss: 1.689 Test Acc: 0.606
Validation loss decreased (-0.259355 --> -0.606233).  Saving model ...
Epoch: 3 cost time: 0.6710844039916992
Epoch: 3, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.319 Vali Acc: 0.753 Test Loss: 1.319 Test Acc: 0.753
Validation loss decreased (-0.606233 --> -0.753112).  Saving model ...
Epoch: 4 cost time: 0.6059792041778564
Epoch: 4, Steps: 8 | Train Loss: 1.144 Vali Loss: 0.963 Vali Acc: 0.841 Test Loss: 0.963 Test Acc: 0.841
Validation loss decreased (-0.753112 --> -0.840615).  Saving model ...
Epoch: 5 cost time: 0.8502817153930664
Epoch: 5, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.698 Vali Acc: 0.812 Test Loss: 0.698 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6385312080383301
Epoch: 6, Steps: 8 | Train Loss: 0.601 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6352496147155762
Epoch: 7, Steps: 8 | Train Loss: 0.454 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
Validation loss decreased (-0.840615 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.582012414932251
Epoch: 8, Steps: 8 | Train Loss: 0.303 Vali Loss: 0.474 Vali Acc: 0.856 Test Loss: 0.474 Test Acc: 0.856
Validation loss decreased (-0.843745 --> -0.856245).  Saving model ...
Epoch: 9 cost time: 0.8965544700622559
Epoch: 9, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.499 Vali Acc: 0.859 Test Loss: 0.499 Test Acc: 0.859
Validation loss decreased (-0.856245 --> -0.859370).  Saving model ...
Epoch: 10 cost time: 0.6862938404083252
Epoch: 10, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6910414695739746
Epoch: 11, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5681459903717041
Epoch: 12, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
Validation loss decreased (-0.859370 --> -0.871869).  Saving model ...
Epoch: 13 cost time: 0.8655171394348145
Epoch: 13, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5584256649017334
Epoch: 14, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.643 Vali Acc: 0.866 Test Loss: 0.643 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8885538578033447
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.734 Vali Acc: 0.866 Test Loss: 0.734 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6175661087036133
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.882 Vali Acc: 0.834 Test Loss: 0.882 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6124658584594727
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.790 Vali Acc: 0.869 Test Loss: 0.790 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8649637699127197
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.814 Vali Acc: 0.869 Test Loss: 0.814 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6743695735931396
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.847 Test Loss: 0.854 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.730682373046875
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.863 Vali Acc: 0.847 Test Loss: 0.863 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6626427173614502
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.838 Vali Acc: 0.850 Test Loss: 0.838 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8998398780822754
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.853 Test Loss: 0.809 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22383368
model size : 100.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.644740581512451
Epoch: 1, Steps: 8 | Train Loss: 2.156 Vali Loss: 1.888 Vali Acc: 0.350 Test Loss: 1.888 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 0.9641599655151367
Epoch: 2, Steps: 8 | Train Loss: 1.661 Vali Loss: 1.259 Vali Acc: 0.784 Test Loss: 1.259 Test Acc: 0.784
Validation loss decreased (-0.349981 --> -0.784362).  Saving model ...
Epoch: 3 cost time: 0.966921329498291
Epoch: 3, Steps: 8 | Train Loss: 1.018 Vali Loss: 0.772 Vali Acc: 0.838 Test Loss: 0.772 Test Acc: 0.838
Validation loss decreased (-0.784362 --> -0.837492).  Saving model ...
Epoch: 4 cost time: 0.8969604969024658
Epoch: 4, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.571 Vali Acc: 0.841 Test Loss: 0.571 Test Acc: 0.841
Validation loss decreased (-0.837492 --> -0.840619).  Saving model ...
Epoch: 5 cost time: 0.84609055519104
Epoch: 5, Steps: 8 | Train Loss: 0.360 Vali Loss: 0.551 Vali Acc: 0.825 Test Loss: 0.551 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8130977153778076
Epoch: 6, Steps: 8 | Train Loss: 0.291 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.8367393016815186
Epoch: 7, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.641 Vali Acc: 0.819 Test Loss: 0.641 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.86627197265625
Epoch: 8, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.659 Vali Acc: 0.847 Test Loss: 0.659 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846868).  Saving model ...
Epoch: 9 cost time: 0.8240747451782227
Epoch: 9, Steps: 8 | Train Loss: 0.114 Vali Loss: 0.906 Vali Acc: 0.819 Test Loss: 0.906 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8301374912261963
Epoch: 10, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.919 Vali Acc: 0.844 Test Loss: 0.919 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8322875499725342
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.009 Vali Acc: 0.838 Test Loss: 1.009 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8965754508972168
Epoch: 12, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.112 Vali Acc: 0.844 Test Loss: 1.112 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6974911689758301
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.107 Vali Acc: 0.828 Test Loss: 1.107 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7764341831207275
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.491 Vali Acc: 0.819 Test Loss: 1.491 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6849427223205566
Epoch: 15, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.420 Vali Acc: 0.819 Test Loss: 1.420 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.714653730392456
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.361 Vali Acc: 0.816 Test Loss: 1.361 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.703373908996582
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.832 Vali Acc: 0.819 Test Loss: 1.832 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6803851127624512
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 2.017 Vali Acc: 0.812 Test Loss: 2.017 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 22805000
model size : 101.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9620695114135742
Epoch: 1, Steps: 8 | Train Loss: 2.100 Vali Loss: 1.933 Vali Acc: 0.316 Test Loss: 1.933 Test Acc: 0.316
Validation loss decreased (inf --> -0.315606).  Saving model ...
Epoch: 2 cost time: 0.5152497291564941
Epoch: 2, Steps: 8 | Train Loss: 1.811 Vali Loss: 1.522 Vali Acc: 0.675 Test Loss: 1.522 Test Acc: 0.675
Validation loss decreased (-0.315606 --> -0.674985).  Saving model ...
Epoch: 3 cost time: 0.9226460456848145
Epoch: 3, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.088 Vali Acc: 0.775 Test Loss: 1.088 Test Acc: 0.775
Validation loss decreased (-0.674985 --> -0.774989).  Saving model ...
Epoch: 4 cost time: 0.6178576946258545
Epoch: 4, Steps: 8 | Train Loss: 0.883 Vali Loss: 0.737 Vali Acc: 0.812 Test Loss: 0.737 Test Acc: 0.812
Validation loss decreased (-0.774989 --> -0.812493).  Saving model ...
Epoch: 5 cost time: 0.56009840965271
Epoch: 5, Steps: 8 | Train Loss: 0.630 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
Validation loss decreased (-0.812493 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.7733969688415527
Epoch: 6, Steps: 8 | Train Loss: 0.438 Vali Loss: 0.565 Vali Acc: 0.834 Test Loss: 0.565 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5491585731506348
Epoch: 7, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.515 Vali Acc: 0.853 Test Loss: 0.515 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853120).  Saving model ...
Epoch: 8 cost time: 0.5799930095672607
Epoch: 8, Steps: 8 | Train Loss: 0.233 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5362284183502197
Epoch: 9, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.692 Vali Acc: 0.847 Test Loss: 0.692 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6148297786712646
Epoch: 10, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.750 Vali Acc: 0.834 Test Loss: 0.750 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7571978569030762
Epoch: 11, Steps: 8 | Train Loss: 0.102 Vali Loss: 0.855 Vali Acc: 0.847 Test Loss: 0.855 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5802056789398193
Epoch: 12, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.878 Vali Acc: 0.831 Test Loss: 0.878 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.649766206741333
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.021 Vali Acc: 0.822 Test Loss: 1.021 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8751070499420166
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.996 Vali Acc: 0.838 Test Loss: 0.996 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7511117458343506
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.015 Vali Acc: 0.828 Test Loss: 1.015 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6126232147216797
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.139 Vali Acc: 0.838 Test Loss: 1.139 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8293421268463135
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.086 Vali Acc: 0.831 Test Loss: 1.086 Test Acc: 0.831
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 22513160
model size : 100.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1196017265319824
Epoch: 1, Steps: 8 | Train Loss: 2.142 Vali Loss: 2.007 Vali Acc: 0.184 Test Loss: 2.007 Test Acc: 0.184
Validation loss decreased (inf --> -0.184355).  Saving model ...
Epoch: 2 cost time: 0.47234272956848145
Epoch: 2, Steps: 8 | Train Loss: 1.927 Vali Loss: 1.740 Vali Acc: 0.569 Test Loss: 1.740 Test Acc: 0.569
Validation loss decreased (-0.184355 --> -0.568733).  Saving model ...
Epoch: 3 cost time: 0.8767201900482178
Epoch: 3, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.397 Vali Acc: 0.756 Test Loss: 1.397 Test Acc: 0.756
Validation loss decreased (-0.568733 --> -0.756236).  Saving model ...
Epoch: 4 cost time: 0.6699216365814209
Epoch: 4, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.046 Vali Acc: 0.800 Test Loss: 1.046 Test Acc: 0.800
Validation loss decreased (-0.756236 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 0.8618125915527344
Epoch: 5, Steps: 8 | Train Loss: 0.890 Vali Loss: 0.752 Vali Acc: 0.809 Test Loss: 0.752 Test Acc: 0.809
Validation loss decreased (-0.799990 --> -0.809367).  Saving model ...
Epoch: 6 cost time: 0.5624213218688965
Epoch: 6, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.564 Vali Acc: 0.838 Test Loss: 0.564 Test Acc: 0.838
Validation loss decreased (-0.809367 --> -0.837494).  Saving model ...
Epoch: 7 cost time: 0.7556655406951904
Epoch: 7, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
Validation loss decreased (-0.837494 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 0.6317007541656494
Epoch: 8, Steps: 8 | Train Loss: 0.338 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8438200950622559
Epoch: 9, Steps: 8 | Train Loss: 0.298 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8472287654876709
Epoch: 10, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5548996925354004
Epoch: 11, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.605 Vali Acc: 0.853 Test Loss: 0.605 Test Acc: 0.853
Validation loss decreased (-0.849995 --> -0.853119).  Saving model ...
Epoch: 12 cost time: 0.8357267379760742
Epoch: 12, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8208267688751221
Epoch: 13, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.643 Vali Acc: 0.869 Test Loss: 0.643 Test Acc: 0.869
Validation loss decreased (-0.853119 --> -0.868744).  Saving model ...
Epoch: 14 cost time: 0.7492740154266357
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.688 Vali Acc: 0.869 Test Loss: 0.688 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6317727565765381
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.709 Vali Acc: 0.863 Test Loss: 0.709 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.63504958152771
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8975193500518799
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.856 Test Loss: 0.740 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5567617416381836
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.866 Test Loss: 0.774 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6057918071746826
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.752 Vali Acc: 0.863 Test Loss: 0.752 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6774060726165771
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.853 Test Loss: 0.756 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6233212947845459
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.866 Test Loss: 0.756 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5694308280944824
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.773 Vali Acc: 0.866 Test Loss: 0.773 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7786905765533447
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.866 Test Loss: 0.783 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 22382600
model size : 100.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.194711685180664
Epoch: 1, Steps: 8 | Train Loss: 2.085 Vali Loss: 1.828 Vali Acc: 0.456 Test Loss: 1.828 Test Acc: 0.456
Validation loss decreased (inf --> -0.456232).  Saving model ...
Epoch: 2 cost time: 0.7552423477172852
Epoch: 2, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.190 Vali Acc: 0.766 Test Loss: 1.190 Test Acc: 0.766
Validation loss decreased (-0.456232 --> -0.765613).  Saving model ...
Epoch: 3 cost time: 0.7358343601226807
Epoch: 3, Steps: 8 | Train Loss: 0.918 Vali Loss: 0.742 Vali Acc: 0.800 Test Loss: 0.742 Test Acc: 0.800
Validation loss decreased (-0.765613 --> -0.799993).  Saving model ...
Epoch: 4 cost time: 0.7762529850006104
Epoch: 4, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.799993 --> -0.843745).  Saving model ...
Epoch: 5 cost time: 0.760979175567627
Epoch: 5, Steps: 8 | Train Loss: 0.325 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 6 cost time: 0.7983977794647217
Epoch: 6, Steps: 8 | Train Loss: 0.229 Vali Loss: 0.643 Vali Acc: 0.841 Test Loss: 0.643 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8148446083068848
Epoch: 7, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.783 Vali Acc: 0.812 Test Loss: 0.783 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7725608348846436
Epoch: 8, Steps: 8 | Train Loss: 0.084 Vali Loss: 0.736 Vali Acc: 0.866 Test Loss: 0.736 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865618).  Saving model ...
Epoch: 9 cost time: 0.7622685432434082
Epoch: 9, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.078 Vali Acc: 0.825 Test Loss: 1.078 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7768938541412354
Epoch: 10, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.965 Vali Acc: 0.844 Test Loss: 0.965 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7233836650848389
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.179 Vali Acc: 0.850 Test Loss: 1.179 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6698486804962158
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.161 Vali Acc: 0.850 Test Loss: 1.161 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.723207950592041
Epoch: 13, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.302 Vali Acc: 0.841 Test Loss: 1.302 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6902868747711182
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.271 Vali Acc: 0.853 Test Loss: 1.271 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7036380767822266
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.234 Vali Acc: 0.838 Test Loss: 1.234 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6834065914154053
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.214 Vali Acc: 0.841 Test Loss: 1.214 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7763283252716064
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.253 Vali Acc: 0.850 Test Loss: 1.253 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7856724262237549
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.277 Vali Acc: 0.844 Test Loss: 1.277 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 22804232
model size : 101.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3263208866119385
Epoch: 1, Steps: 8 | Train Loss: 2.123 Vali Loss: 1.870 Vali Acc: 0.441 Test Loss: 1.870 Test Acc: 0.441
Validation loss decreased (inf --> -0.440606).  Saving model ...
Epoch: 2 cost time: 0.6467182636260986
Epoch: 2, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.472 Vali Acc: 0.644 Test Loss: 1.472 Test Acc: 0.644
Validation loss decreased (-0.440606 --> -0.643735).  Saving model ...
Epoch: 3 cost time: 0.8899116516113281
Epoch: 3, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.021 Vali Acc: 0.800 Test Loss: 1.021 Test Acc: 0.800
Validation loss decreased (-0.643735 --> -0.799990).  Saving model ...
Epoch: 4 cost time: 0.5869660377502441
Epoch: 4, Steps: 8 | Train Loss: 0.788 Vali Loss: 0.692 Vali Acc: 0.831 Test Loss: 0.692 Test Acc: 0.831
Validation loss decreased (-0.799990 --> -0.831243).  Saving model ...
Epoch: 5 cost time: 0.8618941307067871
Epoch: 5, Steps: 8 | Train Loss: 0.574 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.586301326751709
Epoch: 6, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.507 Vali Acc: 0.831 Test Loss: 0.507 Test Acc: 0.831
Validation loss decreased (-0.831243 --> -0.831245).  Saving model ...
Epoch: 7 cost time: 0.6229076385498047
Epoch: 7, Steps: 8 | Train Loss: 0.239 Vali Loss: 0.505 Vali Acc: 0.856 Test Loss: 0.505 Test Acc: 0.856
Validation loss decreased (-0.831245 --> -0.856245).  Saving model ...
Epoch: 8 cost time: 0.6609306335449219
Epoch: 8, Steps: 8 | Train Loss: 0.173 Vali Loss: 0.648 Vali Acc: 0.841 Test Loss: 0.648 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9342997074127197
Epoch: 9, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.591 Vali Acc: 0.869 Test Loss: 0.591 Test Acc: 0.869
Validation loss decreased (-0.856245 --> -0.868744).  Saving model ...
Epoch: 10 cost time: 0.5776550769805908
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.719 Vali Acc: 0.841 Test Loss: 0.719 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5281410217285156
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.748 Vali Acc: 0.872 Test Loss: 0.748 Test Acc: 0.872
Validation loss decreased (-0.868744 --> -0.871868).  Saving model ...
Epoch: 12 cost time: 0.8455600738525391
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.093 Vali Acc: 0.797 Test Loss: 1.093 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.61338210105896
Epoch: 13, Steps: 8 | Train Loss: 0.053 Vali Loss: 0.893 Vali Acc: 0.859 Test Loss: 0.893 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6204698085784912
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.932 Vali Acc: 0.841 Test Loss: 0.932 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5647640228271484
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.996 Vali Acc: 0.828 Test Loss: 0.996 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6441028118133545
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.961 Vali Acc: 0.850 Test Loss: 0.961 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8214616775512695
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.866 Test Loss: 0.942 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5832011699676514
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.950 Vali Acc: 0.863 Test Loss: 0.950 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7557768821716309
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.966 Vali Acc: 0.863 Test Loss: 0.966 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7237899303436279
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.078 Vali Acc: 0.844 Test Loss: 1.078 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9790506362915039
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.965 Vali Acc: 0.850 Test Loss: 0.965 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22520072
model size : 100.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.10925030708313
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 2.000 Vali Acc: 0.272 Test Loss: 2.000 Test Acc: 0.272
Validation loss decreased (inf --> -0.271855).  Saving model ...
Epoch: 2 cost time: 0.8415076732635498
Epoch: 2, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.720 Vali Acc: 0.666 Test Loss: 1.720 Test Acc: 0.666
Validation loss decreased (-0.271855 --> -0.665608).  Saving model ...
Epoch: 3 cost time: 0.6272039413452148
Epoch: 3, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.398 Vali Acc: 0.794 Test Loss: 1.398 Test Acc: 0.794
Validation loss decreased (-0.665608 --> -0.793736).  Saving model ...
Epoch: 4 cost time: 0.850902795791626
Epoch: 4, Steps: 8 | Train Loss: 1.272 Vali Loss: 1.055 Vali Acc: 0.812 Test Loss: 1.055 Test Acc: 0.812
Validation loss decreased (-0.793736 --> -0.812489).  Saving model ...
Epoch: 5 cost time: 0.5664482116699219
Epoch: 5, Steps: 8 | Train Loss: 0.910 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
Validation loss decreased (-0.812489 --> -0.821867).  Saving model ...
Epoch: 6 cost time: 0.7493283748626709
Epoch: 6, Steps: 8 | Train Loss: 0.630 Vali Loss: 0.551 Vali Acc: 0.841 Test Loss: 0.551 Test Acc: 0.841
Validation loss decreased (-0.821867 --> -0.840619).  Saving model ...
Epoch: 7 cost time: 0.700981855392456
Epoch: 7, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.510 Vali Acc: 0.834 Test Loss: 0.510 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7734434604644775
Epoch: 8, Steps: 8 | Train Loss: 0.256 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.597445011138916
Epoch: 9, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.624 Vali Acc: 0.841 Test Loss: 0.624 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.760859489440918
Epoch: 10, Steps: 8 | Train Loss: 0.119 Vali Loss: 0.616 Vali Acc: 0.831 Test Loss: 0.616 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.45198917388916016
Epoch: 11, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.840619 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 0.4496293067932129
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.5083963871002197
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.678 Vali Acc: 0.853 Test Loss: 0.678 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47850728034973145
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.681 Vali Acc: 0.866 Test Loss: 0.681 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5224061012268066
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.691 Vali Acc: 0.856 Test Loss: 0.691 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5161068439483643
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.781 Vali Acc: 0.859 Test Loss: 0.781 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5900552272796631
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.751 Vali Acc: 0.875 Test Loss: 0.751 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.49432921409606934
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.726 Vali Acc: 0.869 Test Loss: 0.726 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4837775230407715
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.735 Vali Acc: 0.869 Test Loss: 0.735 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5423002243041992
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.765 Vali Acc: 0.863 Test Loss: 0.765 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5141410827636719
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.856 Test Loss: 0.798 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.48351001739501953
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.859 Test Loss: 0.820 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 22374152
model size : 100.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5701043605804443
Epoch: 1, Steps: 8 | Train Loss: 2.188 Vali Loss: 1.927 Vali Acc: 0.350 Test Loss: 1.927 Test Acc: 0.350
Validation loss decreased (inf --> -0.349981).  Saving model ...
Epoch: 2 cost time: 0.8329501152038574
Epoch: 2, Steps: 8 | Train Loss: 1.741 Vali Loss: 1.382 Vali Acc: 0.697 Test Loss: 1.382 Test Acc: 0.697
Validation loss decreased (-0.349981 --> -0.696861).  Saving model ...
Epoch: 3 cost time: 0.6543722152709961
Epoch: 3, Steps: 8 | Train Loss: 1.111 Vali Loss: 0.883 Vali Acc: 0.803 Test Loss: 0.883 Test Acc: 0.803
Validation loss decreased (-0.696861 --> -0.803116).  Saving model ...
Epoch: 4 cost time: 0.7273869514465332
Epoch: 4, Steps: 8 | Train Loss: 0.668 Vali Loss: 0.586 Vali Acc: 0.831 Test Loss: 0.586 Test Acc: 0.831
Validation loss decreased (-0.803116 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 0.5802161693572998
Epoch: 5, Steps: 8 | Train Loss: 0.418 Vali Loss: 0.518 Vali Acc: 0.828 Test Loss: 0.518 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9082028865814209
Epoch: 6, Steps: 8 | Train Loss: 0.257 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7046935558319092
Epoch: 7, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.663 Vali Acc: 0.838 Test Loss: 0.663 Test Acc: 0.838
Validation loss decreased (-0.831244 --> -0.837493).  Saving model ...
Epoch: 8 cost time: 0.9946613311767578
Epoch: 8, Steps: 8 | Train Loss: 0.160 Vali Loss: 0.832 Vali Acc: 0.816 Test Loss: 0.832 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5708465576171875
Epoch: 9, Steps: 8 | Train Loss: 0.145 Vali Loss: 0.744 Vali Acc: 0.863 Test Loss: 0.744 Test Acc: 0.863
Validation loss decreased (-0.837493 --> -0.862493).  Saving model ...
Epoch: 10 cost time: 0.7826786041259766
Epoch: 10, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.849 Vali Acc: 0.863 Test Loss: 0.849 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6235072612762451
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 0.853 Vali Acc: 0.856 Test Loss: 0.853 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5749108791351318
Epoch: 12, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.109 Vali Acc: 0.816 Test Loss: 1.109 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9468047618865967
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.992 Vali Acc: 0.841 Test Loss: 0.992 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5675680637359619
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.019 Vali Acc: 0.853 Test Loss: 1.019 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5165255069732666
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.220 Vali Acc: 0.834 Test Loss: 1.220 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5305743217468262
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.235 Vali Acc: 0.841 Test Loss: 1.235 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8008012771606445
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.202 Vali Acc: 0.850 Test Loss: 1.202 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6892538070678711
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.853 Test Loss: 1.173 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9744448661804199
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.847 Test Loss: 1.166 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 22695944
model size : 101.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.027665615081787
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 1.928 Vali Acc: 0.281 Test Loss: 1.928 Test Acc: 0.281
Validation loss decreased (inf --> -0.281231).  Saving model ...
Epoch: 2 cost time: 0.8458552360534668
Epoch: 2, Steps: 8 | Train Loss: 1.841 Vali Loss: 1.573 Vali Acc: 0.672 Test Loss: 1.573 Test Acc: 0.672
Validation loss decreased (-0.281231 --> -0.671859).  Saving model ...
Epoch: 3 cost time: 0.6011641025543213
Epoch: 3, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.149 Vali Acc: 0.753 Test Loss: 1.149 Test Acc: 0.753
Validation loss decreased (-0.671859 --> -0.753114).  Saving model ...
Epoch: 4 cost time: 0.8919675350189209
Epoch: 4, Steps: 8 | Train Loss: 0.991 Vali Loss: 0.768 Vali Acc: 0.809 Test Loss: 0.768 Test Acc: 0.809
Validation loss decreased (-0.753114 --> -0.809367).  Saving model ...
Epoch: 5 cost time: 0.6359305381774902
Epoch: 5, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.809367 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 0.5761451721191406
Epoch: 6, Steps: 8 | Train Loss: 0.427 Vali Loss: 0.498 Vali Acc: 0.828 Test Loss: 0.498 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.6494638919830322
Epoch: 7, Steps: 8 | Train Loss: 0.333 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.5539517402648926
Epoch: 8, Steps: 8 | Train Loss: 0.202 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.543302059173584
Epoch: 9, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.674 Vali Acc: 0.841 Test Loss: 0.674 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 0.857914924621582
Epoch: 10, Steps: 8 | Train Loss: 0.070 Vali Loss: 0.738 Vali Acc: 0.853 Test Loss: 0.738 Test Acc: 0.853
Validation loss decreased (-0.840618 --> -0.853118).  Saving model ...
Epoch: 11 cost time: 0.5808682441711426
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.701 Vali Acc: 0.872 Test Loss: 0.701 Test Acc: 0.872
Validation loss decreased (-0.853118 --> -0.871868).  Saving model ...
Epoch: 12 cost time: 0.9445910453796387
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.776 Vali Acc: 0.850 Test Loss: 0.776 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6988167762756348
Epoch: 13, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.915 Vali Acc: 0.819 Test Loss: 0.915 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7033021450042725
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.842 Vali Acc: 0.850 Test Loss: 0.842 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.78871750831604
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.877 Vali Acc: 0.856 Test Loss: 0.877 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6152710914611816
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.954 Vali Acc: 0.825 Test Loss: 0.954 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8237910270690918
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.945 Vali Acc: 0.863 Test Loss: 0.945 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6357705593109131
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.863 Test Loss: 0.982 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5995190143585205
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.866 Test Loss: 0.973 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8193233013153076
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.863 Test Loss: 0.945 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6156437397003174
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.866 Test Loss: 0.928 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22496264
model size : 100.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9689359664916992
Epoch: 1, Steps: 8 | Train Loss: 2.173 Vali Loss: 1.961 Vali Acc: 0.225 Test Loss: 1.961 Test Acc: 0.225
Validation loss decreased (inf --> -0.224980).  Saving model ...
Epoch: 2 cost time: 0.8239307403564453
Epoch: 2, Steps: 8 | Train Loss: 1.953 Vali Loss: 1.706 Vali Acc: 0.616 Test Loss: 1.706 Test Acc: 0.616
Validation loss decreased (-0.224980 --> -0.615608).  Saving model ...
Epoch: 3 cost time: 0.5865132808685303
Epoch: 3, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.419 Vali Acc: 0.706 Test Loss: 1.419 Test Acc: 0.706
Validation loss decreased (-0.615608 --> -0.706236).  Saving model ...
Epoch: 4 cost time: 0.8512201309204102
Epoch: 4, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.115 Vali Acc: 0.822 Test Loss: 1.115 Test Acc: 0.822
Validation loss decreased (-0.706236 --> -0.821864).  Saving model ...
Epoch: 5 cost time: 0.6480107307434082
Epoch: 5, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.820 Vali Acc: 0.853 Test Loss: 0.820 Test Acc: 0.853
Validation loss decreased (-0.821864 --> -0.853117).  Saving model ...
Epoch: 6 cost time: 0.7129983901977539
Epoch: 6, Steps: 8 | Train Loss: 0.758 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6417884826660156
Epoch: 7, Steps: 8 | Train Loss: 0.563 Vali Loss: 0.463 Vali Acc: 0.872 Test Loss: 0.463 Test Acc: 0.872
Validation loss decreased (-0.853117 --> -0.871870).  Saving model ...
Epoch: 8 cost time: 0.6413147449493408
Epoch: 8, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6606371402740479
Epoch: 9, Steps: 8 | Train Loss: 0.242 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8539314270019531
Epoch: 10, Steps: 8 | Train Loss: 0.200 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7359166145324707
Epoch: 11, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.574 Vali Acc: 0.863 Test Loss: 0.574 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6935830116271973
Epoch: 12, Steps: 8 | Train Loss: 0.080 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.871870 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.6321148872375488
Epoch: 13, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6079425811767578
Epoch: 14, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.663 Vali Acc: 0.859 Test Loss: 0.663 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7852864265441895
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5675668716430664
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.722 Vali Acc: 0.866 Test Loss: 0.722 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8725564479827881
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.715 Vali Acc: 0.869 Test Loss: 0.715 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5919852256774902
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.881 Test Loss: 0.670 Test Acc: 0.881
Validation loss decreased (-0.874994 --> -0.881243).  Saving model ...
Epoch: 19 cost time: 0.8985741138458252
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.878 Test Loss: 0.700 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7009122371673584
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.721 Vali Acc: 0.872 Test Loss: 0.721 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6844093799591064
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5564389228820801
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.884 Test Loss: 0.709 Test Acc: 0.884
Validation loss decreased (-0.881243 --> -0.884368).  Saving model ...
Epoch: 23 cost time: 0.7326555252075195
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.872 Test Loss: 0.753 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.720057487487793
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.872 Test Loss: 0.778 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6511974334716797
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.869 Test Loss: 0.783 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6354877948760986
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.784 Vali Acc: 0.869 Test Loss: 0.784 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6563351154327393
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.788 Vali Acc: 0.872 Test Loss: 0.788 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5212583541870117
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.875 Test Loss: 0.783 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6643831729888916
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.878 Test Loss: 0.788 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5997130870819092
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.881 Test Loss: 0.771 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.576176643371582
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.891 Test Loss: 0.769 Test Acc: 0.891
Validation loss decreased (-0.884368 --> -0.890617).  Saving model ...
Epoch: 32 cost time: 0.576411247253418
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.875 Test Loss: 0.793 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5904238224029541
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.869 Test Loss: 0.811 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6278936862945557
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.872 Test Loss: 0.818 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6104626655578613
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.881 Test Loss: 0.801 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.617821216583252
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.887 Test Loss: 0.795 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.598914623260498
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.884 Test Loss: 0.793 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5258536338806152
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.881 Test Loss: 0.804 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5739567279815674
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.887 Test Loss: 0.804 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5606083869934082
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.887 Test Loss: 0.807 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5405778884887695
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.887 Test Loss: 0.813 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.890625
model parameter : 22373384
model size : 100.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2779288291931152
Epoch: 1, Steps: 8 | Train Loss: 2.126 Vali Loss: 1.797 Vali Acc: 0.494 Test Loss: 1.797 Test Acc: 0.494
Validation loss decreased (inf --> -0.493732).  Saving model ...
Epoch: 2 cost time: 1.0399417877197266
Epoch: 2, Steps: 8 | Train Loss: 1.595 Vali Loss: 1.198 Vali Acc: 0.812 Test Loss: 1.198 Test Acc: 0.812
Validation loss decreased (-0.493732 --> -0.812488).  Saving model ...
Epoch: 3 cost time: 0.8626716136932373
Epoch: 3, Steps: 8 | Train Loss: 0.984 Vali Loss: 0.738 Vali Acc: 0.822 Test Loss: 0.738 Test Acc: 0.822
Validation loss decreased (-0.812488 --> -0.821868).  Saving model ...
Epoch: 4 cost time: 1.1083016395568848
Epoch: 4, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
Validation loss decreased (-0.821868 --> -0.846870).  Saving model ...
Epoch: 5 cost time: 0.9168121814727783
Epoch: 5, Steps: 8 | Train Loss: 0.396 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7637600898742676
Epoch: 6, Steps: 8 | Train Loss: 0.335 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7069549560546875
Epoch: 7, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.638 Vali Acc: 0.834 Test Loss: 0.638 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0947151184082031
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.641 Vali Acc: 0.838 Test Loss: 0.641 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8094568252563477
Epoch: 9, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.807 Vali Acc: 0.844 Test Loss: 0.807 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.031275749206543
Epoch: 10, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7853772640228271
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.087 Vali Acc: 0.828 Test Loss: 1.087 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8121964931488037
Epoch: 12, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.038 Vali Acc: 0.841 Test Loss: 1.038 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7043752670288086
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.996 Vali Acc: 0.838 Test Loss: 0.996 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0275163650512695
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.243 Vali Acc: 0.850 Test Loss: 1.243 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849988).  Saving model ...
Epoch: 15 cost time: 0.5814704895019531
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.414 Vali Acc: 0.812 Test Loss: 1.414 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1445097923278809
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.190 Vali Acc: 0.847 Test Loss: 1.190 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7308979034423828
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.373 Vali Acc: 0.819 Test Loss: 1.373 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7178537845611572
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.452 Vali Acc: 0.803 Test Loss: 1.452 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7846424579620361
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.819 Test Loss: 1.527 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0679607391357422
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.822 Test Loss: 1.602 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8376243114471436
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.822 Test Loss: 1.588 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0623164176940918
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.825 Test Loss: 1.572 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9750981330871582
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.569 Vali Acc: 0.825 Test Loss: 1.569 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.701408863067627
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.825 Test Loss: 1.581 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 22702856
model size : 101.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.152761936187744
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 1.888 Vali Acc: 0.309 Test Loss: 1.888 Test Acc: 0.309
Validation loss decreased (inf --> -0.309356).  Saving model ...
Epoch: 2 cost time: 0.8035945892333984
Epoch: 2, Steps: 8 | Train Loss: 1.743 Vali Loss: 1.471 Vali Acc: 0.684 Test Loss: 1.471 Test Acc: 0.684
Validation loss decreased (-0.309356 --> -0.684360).  Saving model ...
Epoch: 3 cost time: 0.8581223487854004
Epoch: 3, Steps: 8 | Train Loss: 1.293 Vali Loss: 1.015 Vali Acc: 0.762 Test Loss: 1.015 Test Acc: 0.762
Validation loss decreased (-0.684360 --> -0.762490).  Saving model ...
Epoch: 4 cost time: 0.7150459289550781
Epoch: 4, Steps: 8 | Train Loss: 0.926 Vali Loss: 0.709 Vali Acc: 0.838 Test Loss: 0.709 Test Acc: 0.838
Validation loss decreased (-0.762490 --> -0.837493).  Saving model ...
Epoch: 5 cost time: 0.8613476753234863
Epoch: 5, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7004733085632324
Epoch: 6, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.837493 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.8625545501708984
Epoch: 7, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.854581356048584
Epoch: 8, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7425081729888916
Epoch: 9, Steps: 8 | Train Loss: 0.170 Vali Loss: 0.693 Vali Acc: 0.838 Test Loss: 0.693 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8313300609588623
Epoch: 10, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.667 Vali Acc: 0.847 Test Loss: 0.667 Test Acc: 0.847
Validation loss decreased (-0.840620 --> -0.846868).  Saving model ...
Epoch: 11 cost time: 0.5746021270751953
Epoch: 11, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.863 Vali Acc: 0.825 Test Loss: 0.863 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8402323722839355
Epoch: 12, Steps: 8 | Train Loss: 0.046 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7097351551055908
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.894 Vali Acc: 0.838 Test Loss: 0.894 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6556010246276855
Epoch: 14, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.941 Vali Acc: 0.844 Test Loss: 0.941 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8559086322784424
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.045 Vali Acc: 0.834 Test Loss: 1.045 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7036027908325195
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.002 Vali Acc: 0.812 Test Loss: 1.002 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8003880977630615
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.249 Vali Acc: 0.834 Test Loss: 1.249 Test Acc: 0.834
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8922045230865479
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.001 Vali Acc: 0.841 Test Loss: 1.001 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7164175510406494
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.989 Vali Acc: 0.859 Test Loss: 0.989 Test Acc: 0.859
Validation loss decreased (-0.846868 --> -0.859365).  Saving model ...
Epoch: 20 cost time: 0.895941972732544
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.074 Vali Acc: 0.856 Test Loss: 1.074 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6549727916717529
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.853 Test Loss: 1.121 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5859065055847168
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.145 Vali Acc: 0.841 Test Loss: 1.145 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8472740650177002
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.155 Vali Acc: 0.831 Test Loss: 1.155 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6670701503753662
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.831 Test Loss: 1.121 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.579810380935669
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.838 Test Loss: 1.097 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5698528289794922
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.838 Test Loss: 1.087 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6617739200592041
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.838 Test Loss: 1.085 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5874068737030029
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.838 Test Loss: 1.087 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5721662044525146
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.838 Test Loss: 1.090 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 22503176
model size : 100.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.8400874137878418
Epoch: 1, Steps: 8 | Train Loss: 2.190 Vali Loss: 2.049 Vali Acc: 0.138 Test Loss: 2.049 Test Acc: 0.138
Validation loss decreased (inf --> -0.137480).  Saving model ...
Epoch: 2 cost time: 0.6245548725128174
Epoch: 2, Steps: 8 | Train Loss: 1.967 Vali Loss: 1.776 Vali Acc: 0.572 Test Loss: 1.776 Test Acc: 0.572
Validation loss decreased (-0.137480 --> -0.571857).  Saving model ...
Epoch: 3 cost time: 0.5932304859161377
Epoch: 3, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.468 Vali Acc: 0.719 Test Loss: 1.468 Test Acc: 0.719
Validation loss decreased (-0.571857 --> -0.718735).  Saving model ...
Epoch: 4 cost time: 0.5950295925140381
Epoch: 4, Steps: 8 | Train Loss: 1.293 Vali Loss: 1.134 Vali Acc: 0.787 Test Loss: 1.134 Test Acc: 0.787
Validation loss decreased (-0.718735 --> -0.787489).  Saving model ...
Epoch: 5 cost time: 0.6862421035766602
Epoch: 5, Steps: 8 | Train Loss: 0.946 Vali Loss: 0.829 Vali Acc: 0.828 Test Loss: 0.829 Test Acc: 0.828
Validation loss decreased (-0.787489 --> -0.828117).  Saving model ...
Epoch: 6 cost time: 0.5231351852416992
Epoch: 6, Steps: 8 | Train Loss: 0.747 Vali Loss: 0.621 Vali Acc: 0.831 Test Loss: 0.621 Test Acc: 0.831
Validation loss decreased (-0.828117 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 0.5802407264709473
Epoch: 7, Steps: 8 | Train Loss: 0.535 Vali Loss: 0.519 Vali Acc: 0.834 Test Loss: 0.519 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.5363006591796875
Epoch: 8, Steps: 8 | Train Loss: 0.349 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5454576015472412
Epoch: 9, Steps: 8 | Train Loss: 0.278 Vali Loss: 0.521 Vali Acc: 0.847 Test Loss: 0.521 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.8355553150177002
Epoch: 10, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.648 Vali Acc: 0.816 Test Loss: 0.648 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7789871692657471
Epoch: 11, Steps: 8 | Train Loss: 0.135 Vali Loss: 0.688 Vali Acc: 0.831 Test Loss: 0.688 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6063175201416016
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.641 Vali Acc: 0.838 Test Loss: 0.641 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6321356296539307
Epoch: 13, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.681 Vali Acc: 0.844 Test Loss: 0.681 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8221676349639893
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.664 Vali Acc: 0.838 Test Loss: 0.664 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5759687423706055
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.709 Vali Acc: 0.841 Test Loss: 0.709 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.48473286628723145
Epoch: 16, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.735 Vali Acc: 0.841 Test Loss: 0.735 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5271081924438477
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.702 Vali Acc: 0.838 Test Loss: 0.702 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5846929550170898
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.707 Vali Acc: 0.853 Test Loss: 0.707 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853118).  Saving model ...
Epoch: 19 cost time: 0.8292725086212158
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.737 Vali Acc: 0.847 Test Loss: 0.737 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5946476459503174
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.756 Vali Acc: 0.844 Test Loss: 0.756 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5956807136535645
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.841 Test Loss: 0.792 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5521948337554932
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.841 Test Loss: 0.815 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5568361282348633
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.819 Vali Acc: 0.841 Test Loss: 0.819 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8290791511535645
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.841 Test Loss: 0.821 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8676955699920654
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.817 Vali Acc: 0.847 Test Loss: 0.817 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.578726053237915
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.847 Test Loss: 0.812 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6581940650939941
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5490279197692871
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.853 Test Loss: 0.812 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.853125
model parameter : 22372616
model size : 100.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.546212673187256
Epoch: 1, Steps: 8 | Train Loss: 2.232 Vali Loss: 1.945 Vali Acc: 0.331 Test Loss: 1.945 Test Acc: 0.331
Validation loss decreased (inf --> -0.331231).  Saving model ...
Epoch: 2 cost time: 0.9072237014770508
Epoch: 2, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.362 Vali Acc: 0.666 Test Loss: 1.362 Test Acc: 0.666
Validation loss decreased (-0.331231 --> -0.665611).  Saving model ...
Epoch: 3 cost time: 0.7008216381072998
Epoch: 3, Steps: 8 | Train Loss: 1.192 Vali Loss: 0.891 Vali Acc: 0.794 Test Loss: 0.891 Test Acc: 0.794
Validation loss decreased (-0.665611 --> -0.793741).  Saving model ...
Epoch: 4 cost time: 0.694918155670166
Epoch: 4, Steps: 8 | Train Loss: 0.698 Vali Loss: 0.591 Vali Acc: 0.831 Test Loss: 0.591 Test Acc: 0.831
Validation loss decreased (-0.793741 --> -0.831244).  Saving model ...
Epoch: 5 cost time: 1.0389175415039062
Epoch: 5, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7062215805053711
Epoch: 6, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.831244 --> -0.846870).  Saving model ...
Epoch: 7 cost time: 0.6648383140563965
Epoch: 7, Steps: 8 | Train Loss: 0.209 Vali Loss: 0.656 Vali Acc: 0.831 Test Loss: 0.656 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7012789249420166
Epoch: 8, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.659 Vali Acc: 0.831 Test Loss: 0.659 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9346103668212891
Epoch: 9, Steps: 8 | Train Loss: 0.097 Vali Loss: 0.841 Vali Acc: 0.834 Test Loss: 0.841 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9331209659576416
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.932 Vali Acc: 0.806 Test Loss: 0.932 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9151179790496826
Epoch: 11, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.208 Vali Acc: 0.834 Test Loss: 1.208 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0754926204681396
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.189 Vali Acc: 0.812 Test Loss: 1.189 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7875247001647949
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.374 Vali Acc: 0.831 Test Loss: 1.374 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1112768650054932
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.252 Vali Acc: 0.819 Test Loss: 1.252 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0003981590270996
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.375 Vali Acc: 0.828 Test Loss: 1.375 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7700638771057129
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.282 Vali Acc: 0.825 Test Loss: 1.282 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.846875
model parameter : 22709768
model size : 101.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3146963119506836
Epoch: 1, Steps: 8 | Train Loss: 2.096 Vali Loss: 1.929 Vali Acc: 0.294 Test Loss: 1.929 Test Acc: 0.294
Validation loss decreased (inf --> -0.293731).  Saving model ...
Epoch: 2 cost time: 0.5799744129180908
Epoch: 2, Steps: 8 | Train Loss: 1.790 Vali Loss: 1.550 Vali Acc: 0.731 Test Loss: 1.550 Test Acc: 0.731
Validation loss decreased (-0.293731 --> -0.731234).  Saving model ...
Epoch: 3 cost time: 0.8152167797088623
Epoch: 3, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.143 Vali Acc: 0.778 Test Loss: 1.143 Test Acc: 0.778
Validation loss decreased (-0.731234 --> -0.778114).  Saving model ...
Epoch: 4 cost time: 0.5461289882659912
Epoch: 4, Steps: 8 | Train Loss: 0.979 Vali Loss: 0.791 Vali Acc: 0.816 Test Loss: 0.791 Test Acc: 0.816
Validation loss decreased (-0.778114 --> -0.815617).  Saving model ...
Epoch: 5 cost time: 0.5760345458984375
Epoch: 5, Steps: 8 | Train Loss: 0.597 Vali Loss: 0.583 Vali Acc: 0.831 Test Loss: 0.583 Test Acc: 0.831
Validation loss decreased (-0.815617 --> -0.831244).  Saving model ...
Epoch: 6 cost time: 0.7781369686126709
Epoch: 6, Steps: 8 | Train Loss: 0.469 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5626323223114014
Epoch: 7, Steps: 8 | Train Loss: 0.365 Vali Loss: 0.512 Vali Acc: 0.828 Test Loss: 0.512 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8367490768432617
Epoch: 8, Steps: 8 | Train Loss: 0.217 Vali Loss: 0.550 Vali Acc: 0.834 Test Loss: 0.550 Test Acc: 0.834
Validation loss decreased (-0.831244 --> -0.834369).  Saving model ...
Epoch: 9 cost time: 0.8315708637237549
Epoch: 9, Steps: 8 | Train Loss: 0.141 Vali Loss: 0.626 Vali Acc: 0.834 Test Loss: 0.626 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5310060977935791
Epoch: 10, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.671 Vali Acc: 0.853 Test Loss: 0.671 Test Acc: 0.853
Validation loss decreased (-0.834369 --> -0.853118).  Saving model ...
Epoch: 11 cost time: 0.581017017364502
Epoch: 11, Steps: 8 | Train Loss: 0.056 Vali Loss: 0.685 Vali Acc: 0.847 Test Loss: 0.685 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.535569429397583
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7160835266113281
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.958 Vali Acc: 0.812 Test Loss: 0.958 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7946615219116211
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.729 Vali Acc: 0.859 Test Loss: 0.729 Test Acc: 0.859
Validation loss decreased (-0.853118 --> -0.859368).  Saving model ...
Epoch: 15 cost time: 0.5846412181854248
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.838 Vali Acc: 0.859 Test Loss: 0.838 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7663156986236572
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.853 Test Loss: 0.801 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.811321496963501
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5234317779541016
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.859 Test Loss: 0.768 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7804312705993652
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.856 Test Loss: 0.820 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7895567417144775
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.867 Vali Acc: 0.847 Test Loss: 0.867 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6478238105773926
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.844 Test Loss: 0.876 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5213208198547363
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.844 Test Loss: 0.883 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7743806838989258
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.850 Test Loss: 0.879 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5307457447052002
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 22479368
model size : 100.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 1.9353537559509277
Epoch: 1, Steps: 8 | Train Loss: 2.219 Vali Loss: 2.048 Vali Acc: 0.188 Test Loss: 2.048 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 0.5083677768707275
Epoch: 2, Steps: 8 | Train Loss: 2.008 Vali Loss: 1.812 Vali Acc: 0.416 Test Loss: 1.812 Test Acc: 0.416
Validation loss decreased (-0.187480 --> -0.415607).  Saving model ...
Epoch: 3 cost time: 0.7828564643859863
Epoch: 3, Steps: 8 | Train Loss: 1.737 Vali Loss: 1.532 Vali Acc: 0.706 Test Loss: 1.532 Test Acc: 0.706
Validation loss decreased (-0.415607 --> -0.706235).  Saving model ...
Epoch: 4 cost time: 0.6264538764953613
Epoch: 4, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.238 Vali Acc: 0.747 Test Loss: 1.238 Test Acc: 0.747
Validation loss decreased (-0.706235 --> -0.746863).  Saving model ...
Epoch: 5 cost time: 0.8080539703369141
Epoch: 5, Steps: 8 | Train Loss: 1.112 Vali Loss: 0.941 Vali Acc: 0.791 Test Loss: 0.941 Test Acc: 0.791
Validation loss decreased (-0.746863 --> -0.790616).  Saving model ...
Epoch: 6 cost time: 0.5564842224121094
Epoch: 6, Steps: 8 | Train Loss: 0.788 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
Validation loss decreased (-0.790616 --> -0.809368).  Saving model ...
Epoch: 7 cost time: 0.5915794372558594
Epoch: 7, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.555 Vali Acc: 0.831 Test Loss: 0.555 Test Acc: 0.831
Validation loss decreased (-0.809368 --> -0.831244).  Saving model ...
Epoch: 8 cost time: 0.756075382232666
Epoch: 8, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.499 Vali Acc: 0.825 Test Loss: 0.499 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6916828155517578
Epoch: 9, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.831244 --> -0.840620).  Saving model ...
Epoch: 10 cost time: 0.510582685470581
Epoch: 10, Steps: 8 | Train Loss: 0.213 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.840620 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.5383799076080322
Epoch: 11, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5717730522155762
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 0.5833020210266113
Epoch: 13, Steps: 8 | Train Loss: 0.074 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5318887233734131
Epoch: 14, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.652 Vali Acc: 0.834 Test Loss: 0.652 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.46633028984069824
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5653188228607178
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.666 Vali Acc: 0.847 Test Loss: 0.666 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5211992263793945
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.725 Vali Acc: 0.834 Test Loss: 0.725 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5323588848114014
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.736 Vali Acc: 0.841 Test Loss: 0.736 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5215330123901367
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.721 Vali Acc: 0.841 Test Loss: 0.721 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.546262264251709
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.725 Vali Acc: 0.847 Test Loss: 0.725 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.530153751373291
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.741 Vali Acc: 0.847 Test Loss: 0.741 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5829083919525146
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 22371848
model size : 100.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3324949741363525
Epoch: 1, Steps: 8 | Train Loss: 2.108 Vali Loss: 1.868 Vali Acc: 0.394 Test Loss: 1.868 Test Acc: 0.394
Validation loss decreased (inf --> -0.393731).  Saving model ...
Epoch: 2 cost time: 0.7232909202575684
Epoch: 2, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.318 Vali Acc: 0.731 Test Loss: 1.318 Test Acc: 0.731
Validation loss decreased (-0.393731 --> -0.731237).  Saving model ...
Epoch: 3 cost time: 0.6166379451751709
Epoch: 3, Steps: 8 | Train Loss: 1.062 Vali Loss: 0.801 Vali Acc: 0.844 Test Loss: 0.801 Test Acc: 0.844
Validation loss decreased (-0.731237 --> -0.843742).  Saving model ...
Epoch: 4 cost time: 0.8319418430328369
Epoch: 4, Steps: 8 | Train Loss: 0.637 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6113123893737793
Epoch: 5, Steps: 8 | Train Loss: 0.420 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
Validation loss decreased (-0.843742 --> -0.878120).  Saving model ...
Epoch: 6 cost time: 0.9036824703216553
Epoch: 6, Steps: 8 | Train Loss: 0.266 Vali Loss: 0.591 Vali Acc: 0.834 Test Loss: 0.591 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6793794631958008
Epoch: 7, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7812831401824951
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 0.979 Vali Acc: 0.806 Test Loss: 0.979 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7693793773651123
Epoch: 9, Steps: 8 | Train Loss: 0.098 Vali Loss: 0.949 Vali Acc: 0.828 Test Loss: 0.949 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0623645782470703
Epoch: 10, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.223 Vali Acc: 0.803 Test Loss: 1.223 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8467428684234619
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.222 Vali Acc: 0.822 Test Loss: 1.222 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7616555690765381
Epoch: 12, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.024 Vali Acc: 0.859 Test Loss: 1.024 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6410057544708252
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.264 Vali Acc: 0.856 Test Loss: 1.264 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9871776103973389
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.260 Vali Acc: 0.831 Test Loss: 1.260 Test Acc: 0.831
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7923526763916016
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.287 Vali Acc: 0.841 Test Loss: 1.287 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 22716680
model size : 101.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2907772064208984
Epoch: 1, Steps: 8 | Train Loss: 2.155 Vali Loss: 1.936 Vali Acc: 0.253 Test Loss: 1.936 Test Acc: 0.253
Validation loss decreased (inf --> -0.253106).  Saving model ...
Epoch: 2 cost time: 0.7707829475402832
Epoch: 2, Steps: 8 | Train Loss: 1.790 Vali Loss: 1.557 Vali Acc: 0.659 Test Loss: 1.557 Test Acc: 0.659
Validation loss decreased (-0.253106 --> -0.659359).  Saving model ...
Epoch: 3 cost time: 0.8014481067657471
Epoch: 3, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.145 Vali Acc: 0.759 Test Loss: 1.145 Test Acc: 0.759
Validation loss decreased (-0.659359 --> -0.759364).  Saving model ...
Epoch: 4 cost time: 0.5887033939361572
Epoch: 4, Steps: 8 | Train Loss: 0.968 Vali Loss: 0.819 Vali Acc: 0.844 Test Loss: 0.819 Test Acc: 0.844
Validation loss decreased (-0.759364 --> -0.843742).  Saving model ...
Epoch: 5 cost time: 0.5149049758911133
Epoch: 5, Steps: 8 | Train Loss: 0.753 Vali Loss: 0.600 Vali Acc: 0.831 Test Loss: 0.600 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.527885913848877
Epoch: 6, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
Validation loss decreased (-0.843742 --> -0.853120).  Saving model ...
Epoch: 7 cost time: 0.82663893699646
Epoch: 7, Steps: 8 | Train Loss: 0.329 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8345503807067871
Epoch: 8, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4719686508178711
Epoch: 9, Steps: 8 | Train Loss: 0.146 Vali Loss: 0.639 Vali Acc: 0.838 Test Loss: 0.639 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7467770576477051
Epoch: 10, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7492239475250244
Epoch: 11, Steps: 8 | Train Loss: 0.059 Vali Loss: 0.683 Vali Acc: 0.856 Test Loss: 0.683 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856243).  Saving model ...
Epoch: 12 cost time: 0.5856859683990479
Epoch: 12, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.773 Vali Acc: 0.866 Test Loss: 0.773 Test Acc: 0.866
Validation loss decreased (-0.856243 --> -0.865617).  Saving model ...
Epoch: 13 cost time: 0.7643294334411621
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.878 Vali Acc: 0.844 Test Loss: 0.878 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6219489574432373
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.870 Vali Acc: 0.850 Test Loss: 0.870 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6987259387969971
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.848 Vali Acc: 0.863 Test Loss: 0.848 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7720115184783936
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.829 Vali Acc: 0.866 Test Loss: 0.829 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6441655158996582
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.852 Vali Acc: 0.859 Test Loss: 0.852 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4988381862640381
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.877 Vali Acc: 0.866 Test Loss: 0.877 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7578291893005371
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.866 Test Loss: 0.902 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.49361085891723633
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.859 Test Loss: 0.916 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5127007961273193
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.866 Test Loss: 0.912 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.3913686275482178
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.859 Test Loss: 0.906 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 22486280
model size : 100.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.187253475189209
Epoch: 1, Steps: 8 | Train Loss: 2.160 Vali Loss: 2.010 Vali Acc: 0.231 Test Loss: 2.010 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 0.4761006832122803
Epoch: 2, Steps: 8 | Train Loss: 1.919 Vali Loss: 1.774 Vali Acc: 0.637 Test Loss: 1.774 Test Acc: 0.637
Validation loss decreased (-0.231230 --> -0.637482).  Saving model ...
Epoch: 3 cost time: 0.5697357654571533
Epoch: 3, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.516 Vali Acc: 0.766 Test Loss: 1.516 Test Acc: 0.766
Validation loss decreased (-0.637482 --> -0.765610).  Saving model ...
Epoch: 4 cost time: 0.43773746490478516
Epoch: 4, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.224 Vali Acc: 0.791 Test Loss: 1.224 Test Acc: 0.791
Validation loss decreased (-0.765610 --> -0.790613).  Saving model ...
Epoch: 5 cost time: 0.47524023056030273
Epoch: 5, Steps: 8 | Train Loss: 1.024 Vali Loss: 0.934 Vali Acc: 0.778 Test Loss: 0.934 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.44929051399230957
Epoch: 6, Steps: 8 | Train Loss: 0.772 Vali Loss: 0.653 Vali Acc: 0.838 Test Loss: 0.653 Test Acc: 0.838
Validation loss decreased (-0.790613 --> -0.837493).  Saving model ...
Epoch: 7 cost time: 0.6019210815429688
Epoch: 7, Steps: 8 | Train Loss: 0.564 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.837493 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.4647524356842041
Epoch: 8, Steps: 8 | Train Loss: 0.432 Vali Loss: 0.479 Vali Acc: 0.841 Test Loss: 0.479 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4631490707397461
Epoch: 9, Steps: 8 | Train Loss: 0.230 Vali Loss: 0.550 Vali Acc: 0.828 Test Loss: 0.550 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.43529391288757324
Epoch: 10, Steps: 8 | Train Loss: 0.206 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.43772387504577637
Epoch: 11, Steps: 8 | Train Loss: 0.109 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6445014476776123
Epoch: 12, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.812 Vali Acc: 0.850 Test Loss: 0.812 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.4686598777770996
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.685 Vali Acc: 0.838 Test Loss: 0.685 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6496434211730957
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.787 Vali Acc: 0.828 Test Loss: 0.787 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5871462821960449
Epoch: 15, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.871 Vali Acc: 0.831 Test Loss: 0.871 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5254664421081543
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.752 Vali Acc: 0.844 Test Loss: 0.752 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.45667266845703125
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.6188321113586426
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.807 Vali Acc: 0.847 Test Loss: 0.807 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4877758026123047
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.895 Vali Acc: 0.838 Test Loss: 0.895 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4405858516693115
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.847 Vali Acc: 0.847 Test Loss: 0.847 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6133699417114258
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.859 Test Loss: 0.834 Test Acc: 0.859
Validation loss decreased (-0.849993 --> -0.859367).  Saving model ...
Epoch: 22 cost time: 0.4983048439025879
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.841 Vali Acc: 0.856 Test Loss: 0.841 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6255662441253662
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.856 Vali Acc: 0.856 Test Loss: 0.856 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5518500804901123
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.881 Vali Acc: 0.853 Test Loss: 0.881 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5490710735321045
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.850 Test Loss: 0.907 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4595613479614258
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.908 Vali Acc: 0.853 Test Loss: 0.908 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.589257001876831
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.853 Test Loss: 0.893 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4771571159362793
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.856 Test Loss: 0.866 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5101032257080078
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.856 Test Loss: 0.865 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6078252792358398
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.856 Test Loss: 0.879 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6186246871948242
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.856 Test Loss: 0.893 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 22371080
model size : 100.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0922176837921143
Epoch: 1, Steps: 8 | Train Loss: 2.303 Vali Loss: 1.996 Vali Acc: 0.300 Test Loss: 1.996 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 0.938462495803833
Epoch: 2, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.516 Vali Acc: 0.700 Test Loss: 1.516 Test Acc: 0.700
Validation loss decreased (-0.299980 --> -0.699985).  Saving model ...
Epoch: 3 cost time: 0.803370475769043
Epoch: 3, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.036 Vali Acc: 0.731 Test Loss: 1.036 Test Acc: 0.731
Validation loss decreased (-0.699985 --> -0.731240).  Saving model ...
Epoch: 4 cost time: 0.6427979469299316
Epoch: 4, Steps: 8 | Train Loss: 0.770 Vali Loss: 0.682 Vali Acc: 0.819 Test Loss: 0.682 Test Acc: 0.819
Validation loss decreased (-0.731240 --> -0.818743).  Saving model ...
Epoch: 5 cost time: 0.548454999923706
Epoch: 5, Steps: 8 | Train Loss: 0.495 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
Validation loss decreased (-0.818743 --> -0.828119).  Saving model ...
Epoch: 6 cost time: 0.515211820602417
Epoch: 6, Steps: 8 | Train Loss: 0.423 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5912692546844482
Epoch: 7, Steps: 8 | Train Loss: 0.286 Vali Loss: 0.544 Vali Acc: 0.859 Test Loss: 0.544 Test Acc: 0.859
Validation loss decreased (-0.828119 --> -0.859370).  Saving model ...
Epoch: 8 cost time: 0.6415507793426514
Epoch: 8, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.881 Vali Acc: 0.825 Test Loss: 0.881 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5933973789215088
Epoch: 9, Steps: 8 | Train Loss: 0.167 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6132974624633789
Epoch: 10, Steps: 8 | Train Loss: 0.092 Vali Loss: 0.997 Vali Acc: 0.831 Test Loss: 0.997 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6194634437561035
Epoch: 11, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.978 Vali Acc: 0.834 Test Loss: 0.978 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5407695770263672
Epoch: 12, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.025 Vali Acc: 0.838 Test Loss: 1.025 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5505247116088867
Epoch: 13, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.328 Vali Acc: 0.809 Test Loss: 1.328 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5590007305145264
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.147 Vali Acc: 0.841 Test Loss: 1.147 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.614905595779419
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.214 Vali Acc: 0.825 Test Loss: 1.214 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6124913692474365
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.315 Vali Acc: 0.803 Test Loss: 1.315 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6013698577880859
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.262 Vali Acc: 0.838 Test Loss: 1.262 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 22646792
model size : 101.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0837655067443848
Epoch: 1, Steps: 8 | Train Loss: 2.192 Vali Loss: 2.035 Vali Acc: 0.144 Test Loss: 2.035 Test Acc: 0.144
Validation loss decreased (inf --> -0.143730).  Saving model ...
Epoch: 2 cost time: 0.518916130065918
Epoch: 2, Steps: 8 | Train Loss: 1.938 Vali Loss: 1.693 Vali Acc: 0.541 Test Loss: 1.693 Test Acc: 0.541
Validation loss decreased (-0.143730 --> -0.540608).  Saving model ...
Epoch: 3 cost time: 0.43718433380126953
Epoch: 3, Steps: 8 | Train Loss: 1.483 Vali Loss: 1.275 Vali Acc: 0.725 Test Loss: 1.275 Test Acc: 0.725
Validation loss decreased (-0.540608 --> -0.724987).  Saving model ...
Epoch: 4 cost time: 0.5367958545684814
Epoch: 4, Steps: 8 | Train Loss: 1.046 Vali Loss: 0.899 Vali Acc: 0.784 Test Loss: 0.899 Test Acc: 0.784
Validation loss decreased (-0.724987 --> -0.784366).  Saving model ...
Epoch: 5 cost time: 0.6549041271209717
Epoch: 5, Steps: 8 | Train Loss: 0.758 Vali Loss: 0.638 Vali Acc: 0.816 Test Loss: 0.638 Test Acc: 0.816
Validation loss decreased (-0.784366 --> -0.815619).  Saving model ...
Epoch: 6 cost time: 0.7733299732208252
Epoch: 6, Steps: 8 | Train Loss: 0.517 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.815619 --> -0.837495).  Saving model ...
Epoch: 7 cost time: 0.7243921756744385
Epoch: 7, Steps: 8 | Train Loss: 0.384 Vali Loss: 0.465 Vali Acc: 0.834 Test Loss: 0.465 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5097951889038086
Epoch: 8, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.540 Vali Acc: 0.828 Test Loss: 0.540 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5469958782196045
Epoch: 9, Steps: 8 | Train Loss: 0.194 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 0.5180273056030273
Epoch: 10, Steps: 8 | Train Loss: 0.111 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.684525728225708
Epoch: 11, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.778 Vali Acc: 0.841 Test Loss: 0.778 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5761749744415283
Epoch: 12, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.790 Vali Acc: 0.844 Test Loss: 0.790 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5821497440338135
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.826 Vali Acc: 0.866 Test Loss: 0.826 Test Acc: 0.866
Validation loss decreased (-0.849994 --> -0.865617).  Saving model ...
Epoch: 14 cost time: 0.5446193218231201
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.826 Vali Acc: 0.853 Test Loss: 0.826 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7671098709106445
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.928 Vali Acc: 0.831 Test Loss: 0.928 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7286543846130371
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.796 Vali Acc: 0.859 Test Loss: 0.796 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4755725860595703
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.856 Test Loss: 0.779 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5150737762451172
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.958 Vali Acc: 0.844 Test Loss: 0.958 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7025923728942871
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.892 Vali Acc: 0.850 Test Loss: 0.892 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6264855861663818
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.829 Vali Acc: 0.856 Test Loss: 0.829 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.497208833694458
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.853 Test Loss: 0.842 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5817975997924805
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.853 Test Loss: 0.859 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6029098033905029
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.847 Test Loss: 0.922 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 22470152
model size : 100.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.0469748973846436
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 2.002 Vali Acc: 0.256 Test Loss: 2.002 Test Acc: 0.256
Validation loss decreased (inf --> -0.256230).  Saving model ...
Epoch: 2 cost time: 0.521834135055542
Epoch: 2, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.795 Vali Acc: 0.575 Test Loss: 1.795 Test Acc: 0.575
Validation loss decreased (-0.256230 --> -0.574982).  Saving model ...
Epoch: 3 cost time: 0.55539870262146
Epoch: 3, Steps: 8 | Train Loss: 1.666 Vali Loss: 1.528 Vali Acc: 0.697 Test Loss: 1.528 Test Acc: 0.697
Validation loss decreased (-0.574982 --> -0.696860).  Saving model ...
Epoch: 4 cost time: 0.6698729991912842
Epoch: 4, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.241 Vali Acc: 0.741 Test Loss: 1.241 Test Acc: 0.741
Validation loss decreased (-0.696860 --> -0.740613).  Saving model ...
Epoch: 5 cost time: 0.5676157474517822
Epoch: 5, Steps: 8 | Train Loss: 1.120 Vali Loss: 0.955 Vali Acc: 0.775 Test Loss: 0.955 Test Acc: 0.775
Validation loss decreased (-0.740613 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 0.5688595771789551
Epoch: 6, Steps: 8 | Train Loss: 0.773 Vali Loss: 0.715 Vali Acc: 0.797 Test Loss: 0.715 Test Acc: 0.797
Validation loss decreased (-0.774990 --> -0.796868).  Saving model ...
Epoch: 7 cost time: 0.5944056510925293
Epoch: 7, Steps: 8 | Train Loss: 0.527 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
Validation loss decreased (-0.796868 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 0.6422755718231201
Epoch: 8, Steps: 8 | Train Loss: 0.446 Vali Loss: 0.510 Vali Acc: 0.812 Test Loss: 0.510 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5089108943939209
Epoch: 9, Steps: 8 | Train Loss: 0.318 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5030210018157959
Epoch: 10, Steps: 8 | Train Loss: 0.215 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
Validation loss decreased (-0.824995 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.5704092979431152
Epoch: 11, Steps: 8 | Train Loss: 0.147 Vali Loss: 0.545 Vali Acc: 0.831 Test Loss: 0.545 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4748876094818115
Epoch: 12, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.608 Vali Acc: 0.831 Test Loss: 0.608 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5694317817687988
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.563 Vali Acc: 0.841 Test Loss: 0.563 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6397285461425781
Epoch: 14, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4828181266784668
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.603 Vali Acc: 0.869 Test Loss: 0.603 Test Acc: 0.869
Validation loss decreased (-0.843745 --> -0.868744).  Saving model ...
Epoch: 16 cost time: 0.665679931640625
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 0.601 Vali Acc: 0.869 Test Loss: 0.601 Test Acc: 0.869
Validation loss decreased (-0.868744 --> -0.868744).  Saving model ...
Epoch: 17 cost time: 0.49486327171325684
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.638 Vali Acc: 0.859 Test Loss: 0.638 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.542670488357544
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.702 Vali Acc: 0.847 Test Loss: 0.702 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5329582691192627
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.718 Vali Acc: 0.847 Test Loss: 0.718 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6109135150909424
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.859 Test Loss: 0.702 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5494387149810791
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.859 Test Loss: 0.699 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6169819831848145
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.853 Test Loss: 0.699 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.47695112228393555
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.709 Vali Acc: 0.863 Test Loss: 0.709 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5423834323883057
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.863 Test Loss: 0.724 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5041713714599609
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.718 Vali Acc: 0.869 Test Loss: 0.718 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5193097591400146
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.742 Vali Acc: 0.853 Test Loss: 0.742 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 22377992
model size : 100.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.026944875717163
Epoch: 1, Steps: 8 | Train Loss: 2.136 Vali Loss: 1.910 Vali Acc: 0.203 Test Loss: 1.910 Test Acc: 0.203
Validation loss decreased (inf --> -0.203106).  Saving model ...
Epoch: 2 cost time: 0.6839876174926758
Epoch: 2, Steps: 8 | Train Loss: 1.748 Vali Loss: 1.392 Vali Acc: 0.716 Test Loss: 1.392 Test Acc: 0.716
Validation loss decreased (-0.203106 --> -0.715611).  Saving model ...
Epoch: 3 cost time: 0.76194167137146
Epoch: 3, Steps: 8 | Train Loss: 1.193 Vali Loss: 0.923 Vali Acc: 0.791 Test Loss: 0.923 Test Acc: 0.791
Validation loss decreased (-0.715611 --> -0.790616).  Saving model ...
Epoch: 4 cost time: 0.8093607425689697
Epoch: 4, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.622 Vali Acc: 0.825 Test Loss: 0.622 Test Acc: 0.825
Validation loss decreased (-0.790616 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 0.5946922302246094
Epoch: 5, Steps: 8 | Train Loss: 0.453 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.824994 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.8011815547943115
Epoch: 6, Steps: 8 | Train Loss: 0.380 Vali Loss: 0.519 Vali Acc: 0.828 Test Loss: 0.519 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.67201828956604
Epoch: 7, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6638672351837158
Epoch: 8, Steps: 8 | Train Loss: 0.179 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7144060134887695
Epoch: 9, Steps: 8 | Train Loss: 0.103 Vali Loss: 0.714 Vali Acc: 0.828 Test Loss: 0.714 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8487396240234375
Epoch: 10, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.936 Vali Acc: 0.828 Test Loss: 0.936 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6093802452087402
Epoch: 11, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.016 Vali Acc: 0.828 Test Loss: 1.016 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7981166839599609
Epoch: 12, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.044 Vali Acc: 0.838 Test Loss: 1.044 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6469368934631348
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.029 Vali Acc: 0.825 Test Loss: 1.029 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7723820209503174
Epoch: 14, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.981 Vali Acc: 0.850 Test Loss: 0.981 Test Acc: 0.850
Validation loss decreased (-0.837495 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.6265401840209961
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.967 Vali Acc: 0.844 Test Loss: 0.967 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7258141040802002
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.137 Vali Acc: 0.844 Test Loss: 1.137 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7401783466339111
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.266 Vali Acc: 0.838 Test Loss: 1.266 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8240032196044922
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.283 Vali Acc: 0.838 Test Loss: 1.283 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6366996765136719
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.189 Vali Acc: 0.847 Test Loss: 1.189 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6273975372314453
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.156 Vali Acc: 0.853 Test Loss: 1.156 Test Acc: 0.853
Validation loss decreased (-0.849990 --> -0.853113).  Saving model ...
Epoch: 21 cost time: 0.6380348205566406
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.853 Test Loss: 1.143 Test Acc: 0.853
Validation loss decreased (-0.853113 --> -0.853114).  Saving model ...
Epoch: 22 cost time: 0.7745413780212402
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.135 Vali Acc: 0.856 Test Loss: 1.135 Test Acc: 0.856
Validation loss decreased (-0.853114 --> -0.856239).  Saving model ...
Epoch: 23 cost time: 0.6250264644622803
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.850 Test Loss: 1.160 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.593663215637207
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.853 Test Loss: 1.161 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6861720085144043
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.853 Test Loss: 1.167 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7253694534301758
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.853 Test Loss: 1.171 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.865795373916626
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.850 Test Loss: 1.165 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5005702972412109
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.850 Test Loss: 1.169 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7603108882904053
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.853 Test Loss: 1.171 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7691853046417236
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.853 Test Loss: 1.174 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5938050746917725
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.853 Test Loss: 1.180 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6534867286682129
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.856 Test Loss: 1.183 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 22652936
model size : 101.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3671021461486816
Epoch: 1, Steps: 8 | Train Loss: 2.105 Vali Loss: 1.976 Vali Acc: 0.212 Test Loss: 1.976 Test Acc: 0.212
Validation loss decreased (inf --> -0.212480).  Saving model ...
Epoch: 2 cost time: 0.5060815811157227
Epoch: 2, Steps: 8 | Train Loss: 1.884 Vali Loss: 1.652 Vali Acc: 0.591 Test Loss: 1.652 Test Acc: 0.591
Validation loss decreased (-0.212480 --> -0.590608).  Saving model ...
Epoch: 3 cost time: 0.5554699897766113
Epoch: 3, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.253 Vali Acc: 0.747 Test Loss: 1.253 Test Acc: 0.747
Validation loss decreased (-0.590608 --> -0.746862).  Saving model ...
Epoch: 4 cost time: 0.5120704174041748
Epoch: 4, Steps: 8 | Train Loss: 1.081 Vali Loss: 0.906 Vali Acc: 0.800 Test Loss: 0.906 Test Acc: 0.800
Validation loss decreased (-0.746862 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.5098443031311035
Epoch: 5, Steps: 8 | Train Loss: 0.716 Vali Loss: 0.633 Vali Acc: 0.838 Test Loss: 0.633 Test Acc: 0.838
Validation loss decreased (-0.799991 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.5868265628814697
Epoch: 6, Steps: 8 | Train Loss: 0.537 Vali Loss: 0.548 Vali Acc: 0.806 Test Loss: 0.548 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5526270866394043
Epoch: 7, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
Validation loss decreased (-0.837494 --> -0.837495).  Saving model ...
Epoch: 8 cost time: 0.5049028396606445
Epoch: 8, Steps: 8 | Train Loss: 0.304 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.49392151832580566
Epoch: 9, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
Validation loss decreased (-0.837495 --> -0.843744).  Saving model ...
Epoch: 10 cost time: 0.4984011650085449
Epoch: 10, Steps: 8 | Train Loss: 0.123 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5451667308807373
Epoch: 11, Steps: 8 | Train Loss: 0.128 Vali Loss: 0.777 Vali Acc: 0.859 Test Loss: 0.777 Test Acc: 0.859
Validation loss decreased (-0.843744 --> -0.859367).  Saving model ...
Epoch: 12 cost time: 0.709338903427124
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.634 Vali Acc: 0.859 Test Loss: 0.634 Test Acc: 0.859
Validation loss decreased (-0.859367 --> -0.859369).  Saving model ...
Epoch: 13 cost time: 0.755561113357544
Epoch: 13, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.724 Vali Acc: 0.850 Test Loss: 0.724 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7811484336853027
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.758 Vali Acc: 0.847 Test Loss: 0.758 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6800031661987305
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.927 Vali Acc: 0.831 Test Loss: 0.927 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8168549537658691
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.922 Vali Acc: 0.844 Test Loss: 0.922 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.714186429977417
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.832 Vali Acc: 0.863 Test Loss: 0.832 Test Acc: 0.863
Validation loss decreased (-0.859369 --> -0.862492).  Saving model ...
Epoch: 18 cost time: 0.8032119274139404
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.872 Vali Acc: 0.853 Test Loss: 0.872 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6950521469116211
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.838 Test Loss: 0.898 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6995227336883545
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.919 Vali Acc: 0.841 Test Loss: 0.919 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8282372951507568
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.847 Test Loss: 0.923 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9757490158081055
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.831 Test Loss: 0.930 Test Acc: 0.831
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7658627033233643
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.831 Test Loss: 0.936 Test Acc: 0.831
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7755320072174072
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.844 Test Loss: 0.935 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9679429531097412
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.850 Test Loss: 0.903 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.859490156173706
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.856 Test Loss: 0.874 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9490272998809814
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.895 Vali Acc: 0.847 Test Loss: 0.895 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 22468616
model size : 100.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.2856075763702393
Epoch: 1, Steps: 8 | Train Loss: 2.145 Vali Loss: 2.068 Vali Acc: 0.150 Test Loss: 2.068 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 0.7337651252746582
Epoch: 2, Steps: 8 | Train Loss: 2.011 Vali Loss: 1.829 Vali Acc: 0.512 Test Loss: 1.829 Test Acc: 0.512
Validation loss decreased (-0.149979 --> -0.512482).  Saving model ...
Epoch: 3 cost time: 0.6894056797027588
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.554 Vali Acc: 0.731 Test Loss: 1.554 Test Acc: 0.731
Validation loss decreased (-0.512482 --> -0.731234).  Saving model ...
Epoch: 4 cost time: 0.8024873733520508
Epoch: 4, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.242 Vali Acc: 0.784 Test Loss: 1.242 Test Acc: 0.784
Validation loss decreased (-0.731234 --> -0.784363).  Saving model ...
Epoch: 5 cost time: 0.7901511192321777
Epoch: 5, Steps: 8 | Train Loss: 1.068 Vali Loss: 0.928 Vali Acc: 0.806 Test Loss: 0.928 Test Acc: 0.806
Validation loss decreased (-0.784363 --> -0.806241).  Saving model ...
Epoch: 6 cost time: 0.7670485973358154
Epoch: 6, Steps: 8 | Train Loss: 0.777 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
Validation loss decreased (-0.806241 --> -0.821868).  Saving model ...
Epoch: 7 cost time: 0.7316596508026123
Epoch: 7, Steps: 8 | Train Loss: 0.577 Vali Loss: 0.511 Vali Acc: 0.844 Test Loss: 0.511 Test Acc: 0.844
Validation loss decreased (-0.821868 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.7719876766204834
Epoch: 8, Steps: 8 | Train Loss: 0.461 Vali Loss: 0.496 Vali Acc: 0.834 Test Loss: 0.496 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6762917041778564
Epoch: 9, Steps: 8 | Train Loss: 0.299 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6657431125640869
Epoch: 10, Steps: 8 | Train Loss: 0.240 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7255361080169678
Epoch: 11, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.554 Vali Acc: 0.859 Test Loss: 0.554 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859369).  Saving model ...
Epoch: 12 cost time: 0.7936601638793945
Epoch: 12, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6933729648590088
Epoch: 13, Steps: 8 | Train Loss: 0.072 Vali Loss: 0.640 Vali Acc: 0.847 Test Loss: 0.640 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6533889770507812
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.629 Vali Acc: 0.853 Test Loss: 0.629 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7968945503234863
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5801825523376465
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.651 Vali Acc: 0.847 Test Loss: 0.651 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6752753257751465
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.673 Vali Acc: 0.844 Test Loss: 0.673 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.665806770324707
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.653104305267334
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6505389213562012
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.689 Vali Acc: 0.844 Test Loss: 0.689 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6973977088928223
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.699 Vali Acc: 0.853 Test Loss: 0.699 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 22376456
model size : 100.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7414162158966064
Epoch: 1, Steps: 8 | Train Loss: 2.193 Vali Loss: 1.973 Vali Acc: 0.178 Test Loss: 1.973 Test Acc: 0.178
Validation loss decreased (inf --> -0.178105).  Saving model ...
Epoch: 2 cost time: 0.7799289226531982
Epoch: 2, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.501 Vali Acc: 0.728 Test Loss: 1.501 Test Acc: 0.728
Validation loss decreased (-0.178105 --> -0.728110).  Saving model ...
Epoch: 3 cost time: 0.7369630336761475
Epoch: 3, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.040 Vali Acc: 0.794 Test Loss: 1.040 Test Acc: 0.794
Validation loss decreased (-0.728110 --> -0.793740).  Saving model ...
Epoch: 4 cost time: 0.9006052017211914
Epoch: 4, Steps: 8 | Train Loss: 0.839 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
Validation loss decreased (-0.793740 --> -0.803118).  Saving model ...
Epoch: 5 cost time: 0.9719998836517334
Epoch: 5, Steps: 8 | Train Loss: 0.538 Vali Loss: 0.512 Vali Acc: 0.859 Test Loss: 0.512 Test Acc: 0.859
Validation loss decreased (-0.803118 --> -0.859370).  Saving model ...
Epoch: 6 cost time: 1.003382921218872
Epoch: 6, Steps: 8 | Train Loss: 0.373 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9004392623901367
Epoch: 7, Steps: 8 | Train Loss: 0.253 Vali Loss: 0.610 Vali Acc: 0.838 Test Loss: 0.610 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8645060062408447
Epoch: 8, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.752 Vali Acc: 0.812 Test Loss: 0.752 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8364105224609375
Epoch: 9, Steps: 8 | Train Loss: 0.125 Vali Loss: 0.792 Vali Acc: 0.838 Test Loss: 0.792 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7218360900878906
Epoch: 10, Steps: 8 | Train Loss: 0.052 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9615919589996338
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.902 Vali Acc: 0.838 Test Loss: 0.902 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9192650318145752
Epoch: 12, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.865 Vali Acc: 0.847 Test Loss: 0.865 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1375298500061035
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.899 Vali Acc: 0.863 Test Loss: 0.899 Test Acc: 0.863
Validation loss decreased (-0.859370 --> -0.862491).  Saving model ...
Epoch: 14 cost time: 1.1626825332641602
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.311 Vali Acc: 0.825 Test Loss: 1.311 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2148077487945557
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.171 Vali Acc: 0.828 Test Loss: 1.171 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0260381698608398
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.198 Vali Acc: 0.834 Test Loss: 1.198 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2227158546447754
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.138 Vali Acc: 0.844 Test Loss: 1.138 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2492613792419434
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.856 Test Loss: 1.124 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0798790454864502
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.072 Vali Acc: 0.847 Test Loss: 1.072 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.204319715499878
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.196 Vali Acc: 0.831 Test Loss: 1.196 Test Acc: 0.831
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9701061248779297
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.194 Vali Acc: 0.834 Test Loss: 1.194 Test Acc: 0.834
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1836271286010742
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.239 Vali Acc: 0.844 Test Loss: 1.239 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9641387462615967
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.184 Vali Acc: 0.853 Test Loss: 1.184 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 22613000
model size : 100.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7741119861602783
Epoch: 1, Steps: 8 | Train Loss: 2.185 Vali Loss: 2.057 Vali Acc: 0.172 Test Loss: 2.057 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.8955371379852295
Epoch: 2, Steps: 8 | Train Loss: 1.894 Vali Loss: 1.738 Vali Acc: 0.562 Test Loss: 1.738 Test Acc: 0.562
Validation loss decreased (-0.171854 --> -0.562483).  Saving model ...
Epoch: 3 cost time: 1.1033194065093994
Epoch: 3, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.348 Vali Acc: 0.750 Test Loss: 1.348 Test Acc: 0.750
Validation loss decreased (-0.562483 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 0.9217514991760254
Epoch: 4, Steps: 8 | Train Loss: 1.168 Vali Loss: 0.955 Vali Acc: 0.787 Test Loss: 0.955 Test Acc: 0.787
Validation loss decreased (-0.749987 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 1.0445618629455566
Epoch: 5, Steps: 8 | Train Loss: 0.784 Vali Loss: 0.658 Vali Acc: 0.822 Test Loss: 0.658 Test Acc: 0.822
Validation loss decreased (-0.787490 --> -0.821868).  Saving model ...
Epoch: 6 cost time: 1.1711692810058594
Epoch: 6, Steps: 8 | Train Loss: 0.587 Vali Loss: 0.513 Vali Acc: 0.828 Test Loss: 0.513 Test Acc: 0.828
Validation loss decreased (-0.821868 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.8503580093383789
Epoch: 7, Steps: 8 | Train Loss: 0.368 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8639373779296875
Epoch: 8, Steps: 8 | Train Loss: 0.252 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.092254638671875
Epoch: 9, Steps: 8 | Train Loss: 0.183 Vali Loss: 0.652 Vali Acc: 0.816 Test Loss: 0.652 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9216117858886719
Epoch: 10, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.747 Vali Acc: 0.834 Test Loss: 0.747 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834368).  Saving model ...
Epoch: 11 cost time: 1.0905475616455078
Epoch: 11, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.795 Vali Acc: 0.834 Test Loss: 0.795 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0813472270965576
Epoch: 12, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.733 Vali Acc: 0.853 Test Loss: 0.733 Test Acc: 0.853
Validation loss decreased (-0.834368 --> -0.853118).  Saving model ...
Epoch: 13 cost time: 1.1409804821014404
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.809 Vali Acc: 0.869 Test Loss: 0.809 Test Acc: 0.869
Validation loss decreased (-0.853118 --> -0.868742).  Saving model ...
Epoch: 14 cost time: 0.9089343547821045
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.761 Vali Acc: 0.869 Test Loss: 0.761 Test Acc: 0.869
Validation loss decreased (-0.868742 --> -0.868742).  Saving model ...
Epoch: 15 cost time: 0.8958325386047363
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.783 Vali Acc: 0.875 Test Loss: 0.783 Test Acc: 0.875
Validation loss decreased (-0.868742 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 1.0207626819610596
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.921 Vali Acc: 0.856 Test Loss: 0.921 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7407205104827881
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.957 Vali Acc: 0.844 Test Loss: 0.957 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9816479682922363
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.875 Vali Acc: 0.859 Test Loss: 0.875 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.042182207107544
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.880 Vali Acc: 0.863 Test Loss: 0.880 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0926117897033691
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.850 Test Loss: 0.907 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.918997049331665
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.931 Vali Acc: 0.863 Test Loss: 0.931 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8678877353668213
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.869 Test Loss: 0.938 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.058650016784668
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.914 Vali Acc: 0.872 Test Loss: 0.914 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0521156787872314
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.856 Test Loss: 0.904 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9987866878509521
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.863 Test Loss: 0.892 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 22467080
model size : 100.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.621800661087036
Epoch: 1, Steps: 8 | Train Loss: 2.219 Vali Loss: 2.071 Vali Acc: 0.181 Test Loss: 2.071 Test Acc: 0.181
Validation loss decreased (inf --> -0.181229).  Saving model ...
Epoch: 2 cost time: 0.8023438453674316
Epoch: 2, Steps: 8 | Train Loss: 2.030 Vali Loss: 1.873 Vali Acc: 0.388 Test Loss: 1.873 Test Acc: 0.388
Validation loss decreased (-0.181229 --> -0.387481).  Saving model ...
Epoch: 3 cost time: 0.8318476676940918
Epoch: 3, Steps: 8 | Train Loss: 1.773 Vali Loss: 1.655 Vali Acc: 0.619 Test Loss: 1.655 Test Acc: 0.619
Validation loss decreased (-0.387481 --> -0.618733).  Saving model ...
Epoch: 4 cost time: 0.7523057460784912
Epoch: 4, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.373 Vali Acc: 0.744 Test Loss: 1.373 Test Acc: 0.744
Validation loss decreased (-0.618733 --> -0.743736).  Saving model ...
Epoch: 5 cost time: 0.6970655918121338
Epoch: 5, Steps: 8 | Train Loss: 1.197 Vali Loss: 1.079 Vali Acc: 0.775 Test Loss: 1.079 Test Acc: 0.775
Validation loss decreased (-0.743736 --> -0.774989).  Saving model ...
Epoch: 6 cost time: 0.6855120658874512
Epoch: 6, Steps: 8 | Train Loss: 0.929 Vali Loss: 0.762 Vali Acc: 0.812 Test Loss: 0.762 Test Acc: 0.812
Validation loss decreased (-0.774989 --> -0.812492).  Saving model ...
Epoch: 7 cost time: 0.6639754772186279
Epoch: 7, Steps: 8 | Train Loss: 0.614 Vali Loss: 0.593 Vali Acc: 0.806 Test Loss: 0.593 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7460503578186035
Epoch: 8, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.488 Vali Acc: 0.847 Test Loss: 0.488 Test Acc: 0.847
Validation loss decreased (-0.812492 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.7072899341583252
Epoch: 9, Steps: 8 | Train Loss: 0.334 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7039117813110352
Epoch: 10, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8337106704711914
Epoch: 11, Steps: 8 | Train Loss: 0.153 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7421255111694336
Epoch: 12, Steps: 8 | Train Loss: 0.108 Vali Loss: 0.642 Vali Acc: 0.847 Test Loss: 0.642 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6883988380432129
Epoch: 13, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.669 Vali Acc: 0.853 Test Loss: 0.669 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853118).  Saving model ...
Epoch: 14 cost time: 0.6712493896484375
Epoch: 14, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.700 Vali Acc: 0.844 Test Loss: 0.700 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.762272834777832
Epoch: 15, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.732 Vali Acc: 0.853 Test Loss: 0.732 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7561526298522949
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.751 Vali Acc: 0.853 Test Loss: 0.751 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6859982013702393
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.771 Vali Acc: 0.853 Test Loss: 0.771 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.704509973526001
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.795 Vali Acc: 0.859 Test Loss: 0.795 Test Acc: 0.859
Validation loss decreased (-0.853118 --> -0.859367).  Saving model ...
Epoch: 19 cost time: 0.7320959568023682
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.801 Vali Acc: 0.866 Test Loss: 0.801 Test Acc: 0.866
Validation loss decreased (-0.859367 --> -0.865617).  Saving model ...
Epoch: 20 cost time: 0.7093183994293213
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.813 Vali Acc: 0.866 Test Loss: 0.813 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7151224613189697
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.806 Vali Acc: 0.863 Test Loss: 0.806 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6874384880065918
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.859 Test Loss: 0.808 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7896468639373779
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.808 Vali Acc: 0.866 Test Loss: 0.808 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7461192607879639
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.825 Vali Acc: 0.863 Test Loss: 0.825 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7646126747131348
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.828 Vali Acc: 0.866 Test Loss: 0.828 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7669904232025146
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.831 Vali Acc: 0.866 Test Loss: 0.831 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7166359424591064
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.826 Vali Acc: 0.866 Test Loss: 0.826 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8612048625946045
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.866 Test Loss: 0.834 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6512305736541748
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.866 Test Loss: 0.842 Test Acc: 0.866
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 22382600
model size : 100.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.48038649559021
Epoch: 1, Steps: 8 | Train Loss: 2.148 Vali Loss: 1.998 Vali Acc: 0.237 Test Loss: 1.998 Test Acc: 0.237
Validation loss decreased (inf --> -0.237480).  Saving model ...
Epoch: 2 cost time: 1.012686014175415
Epoch: 2, Steps: 8 | Train Loss: 1.819 Vali Loss: 1.519 Vali Acc: 0.609 Test Loss: 1.519 Test Acc: 0.609
Validation loss decreased (-0.237480 --> -0.609360).  Saving model ...
Epoch: 3 cost time: 1.155930757522583
Epoch: 3, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.054 Vali Acc: 0.766 Test Loss: 1.054 Test Acc: 0.766
Validation loss decreased (-0.609360 --> -0.765614).  Saving model ...
Epoch: 4 cost time: 0.8917648792266846
Epoch: 4, Steps: 8 | Train Loss: 0.768 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.765614 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.11704421043396
Epoch: 5, Steps: 8 | Train Loss: 0.516 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.821869).  Saving model ...
Epoch: 6 cost time: 1.2047841548919678
Epoch: 6, Steps: 8 | Train Loss: 0.320 Vali Loss: 0.516 Vali Acc: 0.828 Test Loss: 0.516 Test Acc: 0.828
Validation loss decreased (-0.821869 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.9750289916992188
Epoch: 7, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.954953670501709
Epoch: 8, Steps: 8 | Train Loss: 0.140 Vali Loss: 0.672 Vali Acc: 0.838 Test Loss: 0.672 Test Acc: 0.838
Validation loss decreased (-0.828120 --> -0.837493).  Saving model ...
Epoch: 9 cost time: 1.1218938827514648
Epoch: 9, Steps: 8 | Train Loss: 0.151 Vali Loss: 0.819 Vali Acc: 0.828 Test Loss: 0.819 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.070547103881836
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.987 Vali Acc: 0.825 Test Loss: 0.987 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9733307361602783
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 0.825 Vali Acc: 0.847 Test Loss: 0.825 Test Acc: 0.847
Validation loss decreased (-0.837493 --> -0.846867).  Saving model ...
Epoch: 12 cost time: 1.0344626903533936
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.046 Vali Acc: 0.844 Test Loss: 1.046 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9731473922729492
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.102 Vali Acc: 0.850 Test Loss: 1.102 Test Acc: 0.850
Validation loss decreased (-0.846867 --> -0.849989).  Saving model ...
Epoch: 14 cost time: 1.0586519241333008
Epoch: 14, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.066 Vali Acc: 0.828 Test Loss: 1.066 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2839536666870117
Epoch: 15, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.700 Vali Acc: 0.847 Test Loss: 1.700 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8175089359283447
Epoch: 16, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.483 Vali Acc: 0.806 Test Loss: 1.483 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.179854393005371
Epoch: 17, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.451 Vali Acc: 0.822 Test Loss: 1.451 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9992685317993164
Epoch: 18, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.699 Vali Acc: 0.850 Test Loss: 1.699 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1777548789978027
Epoch: 19, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.851 Vali Acc: 0.834 Test Loss: 1.851 Test Acc: 0.834
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8220958709716797
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.819 Test Loss: 1.748 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1954410076141357
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.760 Vali Acc: 0.844 Test Loss: 1.760 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9694814682006836
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.850 Test Loss: 1.675 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2372679710388184
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.844 Test Loss: 1.638 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85
model parameter : 22626824
model size : 100.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.550832509994507
Epoch: 1, Steps: 8 | Train Loss: 2.149 Vali Loss: 2.009 Vali Acc: 0.188 Test Loss: 2.009 Test Acc: 0.188
Validation loss decreased (inf --> -0.187480).  Saving model ...
Epoch: 2 cost time: 1.0963163375854492
Epoch: 2, Steps: 8 | Train Loss: 1.886 Vali Loss: 1.709 Vali Acc: 0.550 Test Loss: 1.709 Test Acc: 0.550
Validation loss decreased (-0.187480 --> -0.549983).  Saving model ...
Epoch: 3 cost time: 0.8825597763061523
Epoch: 3, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.364 Vali Acc: 0.631 Test Loss: 1.364 Test Acc: 0.631
Validation loss decreased (-0.549983 --> -0.631236).  Saving model ...
Epoch: 4 cost time: 1.0066814422607422
Epoch: 4, Steps: 8 | Train Loss: 1.230 Vali Loss: 0.980 Vali Acc: 0.797 Test Loss: 0.980 Test Acc: 0.797
Validation loss decreased (-0.631236 --> -0.796865).  Saving model ...
Epoch: 5 cost time: 0.9197595119476318
Epoch: 5, Steps: 8 | Train Loss: 0.812 Vali Loss: 0.700 Vali Acc: 0.819 Test Loss: 0.700 Test Acc: 0.819
Validation loss decreased (-0.796865 --> -0.818743).  Saving model ...
Epoch: 6 cost time: 0.7856149673461914
Epoch: 6, Steps: 8 | Train Loss: 0.536 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.818743 --> -0.824995).  Saving model ...
Epoch: 7 cost time: 0.8530478477478027
Epoch: 7, Steps: 8 | Train Loss: 0.430 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
Validation loss decreased (-0.824995 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.8639359474182129
Epoch: 8, Steps: 8 | Train Loss: 0.276 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837495).  Saving model ...
Epoch: 9 cost time: 0.8746898174285889
Epoch: 9, Steps: 8 | Train Loss: 0.196 Vali Loss: 0.678 Vali Acc: 0.819 Test Loss: 0.678 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8197827339172363
Epoch: 10, Steps: 8 | Train Loss: 0.184 Vali Loss: 0.714 Vali Acc: 0.847 Test Loss: 0.714 Test Acc: 0.847
Validation loss decreased (-0.837495 --> -0.846868).  Saving model ...
Epoch: 11 cost time: 0.9188449382781982
Epoch: 11, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.673 Vali Acc: 0.828 Test Loss: 0.673 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9381933212280273
Epoch: 12, Steps: 8 | Train Loss: 0.086 Vali Loss: 0.738 Vali Acc: 0.853 Test Loss: 0.738 Test Acc: 0.853
Validation loss decreased (-0.846868 --> -0.853118).  Saving model ...
Epoch: 13 cost time: 0.8471348285675049
Epoch: 13, Steps: 8 | Train Loss: 0.043 Vali Loss: 0.715 Vali Acc: 0.831 Test Loss: 0.715 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8150973320007324
Epoch: 14, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.848 Vali Acc: 0.844 Test Loss: 0.848 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7922835350036621
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 0.815 Vali Acc: 0.847 Test Loss: 0.815 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.793346643447876
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.771 Vali Acc: 0.863 Test Loss: 0.771 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862492).  Saving model ...
Epoch: 17 cost time: 0.8061299324035645
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.869 Vali Acc: 0.869 Test Loss: 0.869 Test Acc: 0.869
Validation loss decreased (-0.862492 --> -0.868741).  Saving model ...
Epoch: 18 cost time: 0.8497822284698486
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.897 Vali Acc: 0.838 Test Loss: 0.897 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8642282485961914
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.890 Vali Acc: 0.834 Test Loss: 0.890 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7846591472625732
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.856 Test Loss: 0.843 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9522104263305664
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.859 Test Loss: 0.846 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8148055076599121
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.853 Test Loss: 0.839 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7683506011962891
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.850 Test Loss: 0.861 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9339361190795898
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.853 Test Loss: 0.863 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9390637874603271
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.853 Test Loss: 0.863 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9503815174102783
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.853 Test Loss: 0.865 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.866955041885376
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.856 Test Loss: 0.883 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 22465544
model size : 100.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.333040237426758
Epoch: 1, Steps: 8 | Train Loss: 2.248 Vali Loss: 2.130 Vali Acc: 0.150 Test Loss: 2.130 Test Acc: 0.150
Validation loss decreased (inf --> -0.149979).  Saving model ...
Epoch: 2 cost time: 0.7218582630157471
Epoch: 2, Steps: 8 | Train Loss: 2.067 Vali Loss: 1.908 Vali Acc: 0.409 Test Loss: 1.908 Test Acc: 0.409
Validation loss decreased (-0.149979 --> -0.409356).  Saving model ...
Epoch: 3 cost time: 0.6562254428863525
Epoch: 3, Steps: 8 | Train Loss: 1.802 Vali Loss: 1.676 Vali Acc: 0.600 Test Loss: 1.676 Test Acc: 0.600
Validation loss decreased (-0.409356 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 0.6838624477386475
Epoch: 4, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.404 Vali Acc: 0.734 Test Loss: 1.404 Test Acc: 0.734
Validation loss decreased (-0.599983 --> -0.734361).  Saving model ...
Epoch: 5 cost time: 0.7520949840545654
Epoch: 5, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.126 Vali Acc: 0.778 Test Loss: 1.126 Test Acc: 0.778
Validation loss decreased (-0.734361 --> -0.778114).  Saving model ...
Epoch: 6 cost time: 0.7381210327148438
Epoch: 6, Steps: 8 | Train Loss: 0.929 Vali Loss: 0.811 Vali Acc: 0.809 Test Loss: 0.811 Test Acc: 0.809
Validation loss decreased (-0.778114 --> -0.809367).  Saving model ...
Epoch: 7 cost time: 0.7305521965026855
Epoch: 7, Steps: 8 | Train Loss: 0.714 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8263354301452637
Epoch: 8, Steps: 8 | Train Loss: 0.513 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
Validation loss decreased (-0.809367 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.8095030784606934
Epoch: 9, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 0.7002243995666504
Epoch: 10, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
Validation loss decreased (-0.824995 --> -0.837495).  Saving model ...
Epoch: 11 cost time: 0.6796507835388184
Epoch: 11, Steps: 8 | Train Loss: 0.164 Vali Loss: 0.496 Vali Acc: 0.853 Test Loss: 0.496 Test Acc: 0.853
Validation loss decreased (-0.837495 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.6767709255218506
Epoch: 12, Steps: 8 | Train Loss: 0.137 Vali Loss: 0.553 Vali Acc: 0.847 Test Loss: 0.553 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6780436038970947
Epoch: 13, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8232755661010742
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.576 Vali Acc: 0.863 Test Loss: 0.576 Test Acc: 0.863
Validation loss decreased (-0.853120 --> -0.862494).  Saving model ...
Epoch: 15 cost time: 0.7420592308044434
Epoch: 15, Steps: 8 | Train Loss: 0.048 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7361571788787842
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.604 Vali Acc: 0.863 Test Loss: 0.604 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7233443260192871
Epoch: 17, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.639 Vali Acc: 0.863 Test Loss: 0.639 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6048667430877686
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.639 Vali Acc: 0.859 Test Loss: 0.639 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6211035251617432
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.668 Vali Acc: 0.872 Test Loss: 0.668 Test Acc: 0.872
Validation loss decreased (-0.862494 --> -0.871868).  Saving model ...
Epoch: 20 cost time: 0.7063717842102051
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.869 Test Loss: 0.675 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7164299488067627
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.685 Vali Acc: 0.869 Test Loss: 0.685 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8127923011779785
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.679 Vali Acc: 0.859 Test Loss: 0.679 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6569578647613525
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.673 Vali Acc: 0.866 Test Loss: 0.673 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7518253326416016
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.872 Test Loss: 0.705 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7242588996887207
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.735 Vali Acc: 0.878 Test Loss: 0.735 Test Acc: 0.878
Validation loss decreased (-0.871868 --> -0.878118).  Saving model ...
Epoch: 26 cost time: 0.6219244003295898
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.743 Vali Acc: 0.866 Test Loss: 0.743 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.676577091217041
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.727 Vali Acc: 0.866 Test Loss: 0.727 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6207690238952637
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.872 Test Loss: 0.706 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5490078926086426
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.869 Test Loss: 0.713 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6078512668609619
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.863 Test Loss: 0.723 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5770087242126465
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.863 Test Loss: 0.734 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.811664342880249
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.866 Test Loss: 0.728 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7958991527557373
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.866 Test Loss: 0.731 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7662310600280762
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.866 Test Loss: 0.740 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.677715539932251
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.863 Test Loss: 0.747 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 22388744
model size : 100.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.513653039932251
Epoch: 1, Steps: 8 | Train Loss: 2.218 Vali Loss: 1.998 Vali Acc: 0.300 Test Loss: 1.998 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 0.8839216232299805
Epoch: 2, Steps: 8 | Train Loss: 1.861 Vali Loss: 1.542 Vali Acc: 0.647 Test Loss: 1.542 Test Acc: 0.647
Validation loss decreased (-0.299980 --> -0.646860).  Saving model ...
Epoch: 3 cost time: 0.9767942428588867
Epoch: 3, Steps: 8 | Train Loss: 1.277 Vali Loss: 1.053 Vali Acc: 0.791 Test Loss: 1.053 Test Acc: 0.791
Validation loss decreased (-0.646860 --> -0.790614).  Saving model ...
Epoch: 4 cost time: 1.007155179977417
Epoch: 4, Steps: 8 | Train Loss: 0.830 Vali Loss: 0.706 Vali Acc: 0.787 Test Loss: 0.706 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.000913143157959
Epoch: 5, Steps: 8 | Train Loss: 0.558 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.790614 --> -0.821870).  Saving model ...
Epoch: 6 cost time: 0.9220430850982666
Epoch: 6, Steps: 8 | Train Loss: 0.357 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9795925617218018
Epoch: 7, Steps: 8 | Train Loss: 0.238 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.7667090892791748
Epoch: 8, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.765 Vali Acc: 0.816 Test Loss: 0.765 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9689328670501709
Epoch: 9, Steps: 8 | Train Loss: 0.171 Vali Loss: 0.739 Vali Acc: 0.841 Test Loss: 0.739 Test Acc: 0.841
Validation loss decreased (-0.828119 --> -0.840618).  Saving model ...
Epoch: 10 cost time: 0.7041223049163818
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.013 Vali Acc: 0.831 Test Loss: 1.013 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8714101314544678
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 0.853 Vali Acc: 0.847 Test Loss: 0.853 Test Acc: 0.847
Validation loss decreased (-0.840618 --> -0.846866).  Saving model ...
Epoch: 12 cost time: 0.906998872756958
Epoch: 12, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.082 Vali Acc: 0.853 Test Loss: 1.082 Test Acc: 0.853
Validation loss decreased (-0.846866 --> -0.853114).  Saving model ...
Epoch: 13 cost time: 1.110654592514038
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.980 Vali Acc: 0.872 Test Loss: 0.980 Test Acc: 0.872
Validation loss decreased (-0.853114 --> -0.871865).  Saving model ...
Epoch: 14 cost time: 0.9522519111633301
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.969 Vali Acc: 0.847 Test Loss: 0.969 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9464638233184814
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.092 Vali Acc: 0.853 Test Loss: 1.092 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8965742588043213
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.116 Vali Acc: 0.850 Test Loss: 1.116 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0230488777160645
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.997 Vali Acc: 0.869 Test Loss: 0.997 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8404560089111328
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.884 Test Loss: 0.969 Test Acc: 0.884
Validation loss decreased (-0.871865 --> -0.884365).  Saving model ...
Epoch: 19 cost time: 0.953026533126831
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.953 Vali Acc: 0.884 Test Loss: 0.953 Test Acc: 0.884
Validation loss decreased (-0.884365 --> -0.884365).  Saving model ...
Epoch: 20 cost time: 0.8511121273040771
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.872 Test Loss: 0.956 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9044795036315918
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.859 Test Loss: 0.973 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8470463752746582
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.859 Test Loss: 0.978 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8209424018859863
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.856 Test Loss: 0.995 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9043958187103271
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.869 Test Loss: 1.014 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9112040996551514
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.875 Test Loss: 1.036 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9248216152191162
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.024 Vali Acc: 0.872 Test Loss: 1.024 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7905712127685547
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.863 Test Loss: 1.021 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8102421760559082
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.856 Test Loss: 1.025 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8837659358978271
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.856 Test Loss: 1.036 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 22594568
model size : 100.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4107797145843506
Epoch: 1, Steps: 8 | Train Loss: 2.121 Vali Loss: 1.964 Vali Acc: 0.219 Test Loss: 1.964 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 0.7334229946136475
Epoch: 2, Steps: 8 | Train Loss: 1.885 Vali Loss: 1.635 Vali Acc: 0.666 Test Loss: 1.635 Test Acc: 0.666
Validation loss decreased (-0.218730 --> -0.665609).  Saving model ...
Epoch: 3 cost time: 1.0161054134368896
Epoch: 3, Steps: 8 | Train Loss: 1.516 Vali Loss: 1.281 Vali Acc: 0.750 Test Loss: 1.281 Test Acc: 0.750
Validation loss decreased (-0.665609 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 1.0511107444763184
Epoch: 4, Steps: 8 | Train Loss: 1.116 Vali Loss: 0.923 Vali Acc: 0.784 Test Loss: 0.923 Test Acc: 0.784
Validation loss decreased (-0.749987 --> -0.784366).  Saving model ...
Epoch: 5 cost time: 1.0253973007202148
Epoch: 5, Steps: 8 | Train Loss: 0.745 Vali Loss: 0.652 Vali Acc: 0.806 Test Loss: 0.652 Test Acc: 0.806
Validation loss decreased (-0.784366 --> -0.806243).  Saving model ...
Epoch: 6 cost time: 1.040203332901001
Epoch: 6, Steps: 8 | Train Loss: 0.484 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
Validation loss decreased (-0.806243 --> -0.818745).  Saving model ...
Epoch: 7 cost time: 0.9862842559814453
Epoch: 7, Steps: 8 | Train Loss: 0.402 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7847785949707031
Epoch: 8, Steps: 8 | Train Loss: 0.264 Vali Loss: 0.616 Vali Acc: 0.828 Test Loss: 0.616 Test Acc: 0.828
Validation loss decreased (-0.818745 --> -0.828119).  Saving model ...
Epoch: 9 cost time: 0.9810738563537598
Epoch: 9, Steps: 8 | Train Loss: 0.189 Vali Loss: 0.705 Vali Acc: 0.828 Test Loss: 0.705 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.796868085861206
Epoch: 10, Steps: 8 | Train Loss: 0.115 Vali Loss: 0.664 Vali Acc: 0.847 Test Loss: 0.664 Test Acc: 0.847
Validation loss decreased (-0.828119 --> -0.846868).  Saving model ...
Epoch: 11 cost time: 0.7553732395172119
Epoch: 11, Steps: 8 | Train Loss: 0.065 Vali Loss: 0.727 Vali Acc: 0.847 Test Loss: 0.727 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0418801307678223
Epoch: 12, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
Validation loss decreased (-0.846868 --> -0.856243).  Saving model ...
Epoch: 13 cost time: 0.8639819622039795
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0321860313415527
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.734 Vali Acc: 0.872 Test Loss: 0.734 Test Acc: 0.872
Validation loss decreased (-0.856243 --> -0.871868).  Saving model ...
Epoch: 15 cost time: 0.8582592010498047
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.769 Vali Acc: 0.863 Test Loss: 0.769 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1332566738128662
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.762 Vali Acc: 0.863 Test Loss: 0.762 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9664287567138672
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.795 Vali Acc: 0.856 Test Loss: 0.795 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7716975212097168
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.826 Vali Acc: 0.872 Test Loss: 0.826 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8092396259307861
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.828 Vali Acc: 0.866 Test Loss: 0.828 Test Acc: 0.866
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0751450061798096
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.853 Test Loss: 0.830 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8680932521820068
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.822 Vali Acc: 0.863 Test Loss: 0.822 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.090200662612915
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.818 Vali Acc: 0.863 Test Loss: 0.818 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0699777603149414
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.872 Test Loss: 0.824 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8740758895874023
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.875 Test Loss: 0.835 Test Acc: 0.875
Validation loss decreased (-0.871868 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 1.1697349548339844
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.875 Test Loss: 0.834 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 26 cost time: 0.9101614952087402
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.878 Test Loss: 0.835 Test Acc: 0.878
Validation loss decreased (-0.874992 --> -0.878117).  Saving model ...
Epoch: 27 cost time: 1.163372278213501
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.869 Test Loss: 0.834 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0122597217559814
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.881 Test Loss: 0.837 Test Acc: 0.881
Validation loss decreased (-0.878117 --> -0.881242).  Saving model ...
Epoch: 29 cost time: 1.1388554573059082
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.881 Test Loss: 0.842 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.10791015625
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.881 Test Loss: 0.845 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9913544654846191
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.878 Test Loss: 0.842 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.016188621520996
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.875 Test Loss: 0.846 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9399449825286865
Epoch: 33, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.869 Test Loss: 0.859 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1174581050872803
Epoch: 34, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.869 Test Loss: 0.858 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9972002506256104
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.869 Test Loss: 0.869 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.91912841796875
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.877 Vali Acc: 0.875 Test Loss: 0.877 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0913505554199219
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.882 Vali Acc: 0.875 Test Loss: 0.882 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0535132884979248
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.881 Vali Acc: 0.872 Test Loss: 0.881 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.88125
model parameter : 22471688
model size : 100.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.476590633392334
Epoch: 1, Steps: 8 | Train Loss: 2.201 Vali Loss: 2.052 Vali Acc: 0.184 Test Loss: 2.052 Test Acc: 0.184
Validation loss decreased (inf --> -0.184354).  Saving model ...
Epoch: 2 cost time: 0.6386477947235107
Epoch: 2, Steps: 8 | Train Loss: 2.012 Vali Loss: 1.852 Vali Acc: 0.459 Test Loss: 1.852 Test Acc: 0.459
Validation loss decreased (-0.184354 --> -0.459356).  Saving model ...
Epoch: 3 cost time: 0.8451476097106934
Epoch: 3, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.611 Vali Acc: 0.662 Test Loss: 1.611 Test Acc: 0.662
Validation loss decreased (-0.459356 --> -0.662484).  Saving model ...
Epoch: 4 cost time: 0.8269650936126709
Epoch: 4, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.338 Vali Acc: 0.778 Test Loss: 1.338 Test Acc: 0.778
Validation loss decreased (-0.662484 --> -0.778112).  Saving model ...
Epoch: 5 cost time: 0.7786109447479248
Epoch: 5, Steps: 8 | Train Loss: 1.204 Vali Loss: 1.041 Vali Acc: 0.809 Test Loss: 1.041 Test Acc: 0.809
Validation loss decreased (-0.778112 --> -0.809365).  Saving model ...
Epoch: 6 cost time: 0.786116361618042
Epoch: 6, Steps: 8 | Train Loss: 0.886 Vali Loss: 0.744 Vali Acc: 0.825 Test Loss: 0.744 Test Acc: 0.825
Validation loss decreased (-0.809365 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.8373639583587646
Epoch: 7, Steps: 8 | Train Loss: 0.665 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.824993 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 0.7660496234893799
Epoch: 8, Steps: 8 | Train Loss: 0.467 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.7741494178771973
Epoch: 9, Steps: 8 | Train Loss: 0.316 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8337092399597168
Epoch: 10, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6743149757385254
Epoch: 11, Steps: 8 | Train Loss: 0.148 Vali Loss: 0.523 Vali Acc: 0.853 Test Loss: 0.523 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853120).  Saving model ...
Epoch: 12 cost time: 0.7932798862457275
Epoch: 12, Steps: 8 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.866 Test Loss: 0.515 Test Acc: 0.866
Validation loss decreased (-0.853120 --> -0.865620).  Saving model ...
Epoch: 13 cost time: 0.9113762378692627
Epoch: 13, Steps: 8 | Train Loss: 0.061 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
Validation loss decreased (-0.865620 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.8817386627197266
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7932791709899902
Epoch: 15, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8702552318572998
Epoch: 16, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.619 Vali Acc: 0.859 Test Loss: 0.619 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6933376789093018
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7228245735168457
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7150144577026367
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.661 Vali Acc: 0.866 Test Loss: 0.661 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8127541542053223
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.872 Test Loss: 0.667 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8133282661437988
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.666 Vali Acc: 0.875 Test Loss: 0.666 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.779421329498291
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8230044841766357
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.875
model parameter : 22394888
model size : 100.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps32_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5843136310577393
Epoch: 1, Steps: 8 | Train Loss: 2.199 Vali Loss: 1.976 Vali Acc: 0.234 Test Loss: 1.976 Test Acc: 0.234
Validation loss decreased (inf --> -0.234355).  Saving model ...
Epoch: 2 cost time: 1.1649506092071533
Epoch: 2, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.579 Vali Acc: 0.600 Test Loss: 1.579 Test Acc: 0.600
Validation loss decreased (-0.234355 --> -0.599984).  Saving model ...
Epoch: 3 cost time: 0.8364105224609375
Epoch: 3, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.138 Vali Acc: 0.756 Test Loss: 1.138 Test Acc: 0.756
Validation loss decreased (-0.599984 --> -0.756239).  Saving model ...
Epoch: 4 cost time: 1.0084381103515625
Epoch: 4, Steps: 8 | Train Loss: 0.912 Vali Loss: 0.741 Vali Acc: 0.816 Test Loss: 0.741 Test Acc: 0.816
Validation loss decreased (-0.756239 --> -0.815618).  Saving model ...
Epoch: 5 cost time: 0.9787509441375732
Epoch: 5, Steps: 8 | Train Loss: 0.567 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
Validation loss decreased (-0.815618 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 1.0118417739868164
Epoch: 6, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9474575519561768
Epoch: 7, Steps: 8 | Train Loss: 0.245 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840619).  Saving model ...
Epoch: 8 cost time: 1.0587825775146484
Epoch: 8, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.748 Vali Acc: 0.806 Test Loss: 0.748 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2030293941497803
Epoch: 9, Steps: 8 | Train Loss: 0.134 Vali Loss: 0.753 Vali Acc: 0.834 Test Loss: 0.753 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1466741561889648
Epoch: 10, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.807 Vali Acc: 0.838 Test Loss: 0.807 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9437487125396729
Epoch: 11, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.865 Vali Acc: 0.844 Test Loss: 0.865 Test Acc: 0.844
Validation loss decreased (-0.840619 --> -0.843741).  Saving model ...
Epoch: 12 cost time: 0.7907266616821289
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.878 Vali Acc: 0.850 Test Loss: 0.878 Test Acc: 0.850
Validation loss decreased (-0.843741 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.9518673419952393
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.863 Vali Acc: 0.853 Test Loss: 0.863 Test Acc: 0.853
Validation loss decreased (-0.849991 --> -0.853116).  Saving model ...
Epoch: 14 cost time: 0.9960360527038574
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.848 Vali Acc: 0.856 Test Loss: 0.848 Test Acc: 0.856
Validation loss decreased (-0.853116 --> -0.856242).  Saving model ...
Epoch: 15 cost time: 0.9340660572052002
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.852 Vali Acc: 0.866 Test Loss: 0.852 Test Acc: 0.866
Validation loss decreased (-0.856242 --> -0.865616).  Saving model ...
Epoch: 16 cost time: 0.927008867263794
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.948 Vali Acc: 0.844 Test Loss: 0.948 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9688587188720703
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.887 Vali Acc: 0.863 Test Loss: 0.887 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9832327365875244
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.880 Vali Acc: 0.872 Test Loss: 0.880 Test Acc: 0.872
Validation loss decreased (-0.865616 --> -0.871866).  Saving model ...
Epoch: 19 cost time: 0.960869312286377
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.970 Vali Acc: 0.834 Test Loss: 0.970 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0571341514587402
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.841 Test Loss: 0.956 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9281854629516602
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.847 Test Loss: 0.945 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0924701690673828
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.847 Test Loss: 0.943 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.000765085220337
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.853 Test Loss: 0.940 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9367740154266357
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.850 Test Loss: 0.938 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9128432273864746
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.853 Test Loss: 0.948 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9819157123565674
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.853 Test Loss: 0.962 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9758749008178711
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.850 Test Loss: 0.976 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.14918851852417
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.850 Test Loss: 0.989 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps32_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22615304
model size : 100.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps32_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7696492671966553
Epoch: 1, Steps: 8 | Train Loss: 2.262 Vali Loss: 2.113 Vali Acc: 0.172 Test Loss: 2.113 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 1.0111708641052246
Epoch: 2, Steps: 8 | Train Loss: 1.999 Vali Loss: 1.819 Vali Acc: 0.494 Test Loss: 1.819 Test Acc: 0.494
Validation loss decreased (-0.171854 --> -0.493732).  Saving model ...
Epoch: 3 cost time: 0.9106900691986084
Epoch: 3, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.498 Vali Acc: 0.756 Test Loss: 1.498 Test Acc: 0.756
Validation loss decreased (-0.493732 --> -0.756235).  Saving model ...
Epoch: 4 cost time: 1.0699241161346436
Epoch: 4, Steps: 8 | Train Loss: 1.286 Vali Loss: 1.115 Vali Acc: 0.822 Test Loss: 1.115 Test Acc: 0.822
Validation loss decreased (-0.756235 --> -0.821864).  Saving model ...
Epoch: 5 cost time: 0.9338185787200928
Epoch: 5, Steps: 8 | Train Loss: 0.908 Vali Loss: 0.754 Vali Acc: 0.812 Test Loss: 0.754 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0776691436767578
Epoch: 6, Steps: 8 | Train Loss: 0.628 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
Validation loss decreased (-0.821864 --> -0.828120).  Saving model ...
Epoch: 7 cost time: 0.9406454563140869
Epoch: 7, Steps: 8 | Train Loss: 0.436 Vali Loss: 0.505 Vali Acc: 0.834 Test Loss: 0.505 Test Acc: 0.834
Validation loss decreased (-0.828120 --> -0.834370).  Saving model ...
Epoch: 8 cost time: 0.9823868274688721
Epoch: 8, Steps: 8 | Train Loss: 0.319 Vali Loss: 0.538 Vali Acc: 0.825 Test Loss: 0.538 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8836915493011475
Epoch: 9, Steps: 8 | Train Loss: 0.198 Vali Loss: 0.625 Vali Acc: 0.831 Test Loss: 0.625 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9809134006500244
Epoch: 10, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
Validation loss decreased (-0.834370 --> -0.856244).  Saving model ...
Epoch: 11 cost time: 1.1500701904296875
Epoch: 11, Steps: 8 | Train Loss: 0.076 Vali Loss: 0.618 Vali Acc: 0.859 Test Loss: 0.618 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859369).  Saving model ...
Epoch: 12 cost time: 1.0018625259399414
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.693 Vali Acc: 0.847 Test Loss: 0.693 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0231995582580566
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.703 Vali Acc: 0.853 Test Loss: 0.703 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1140954494476318
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0591607093811035
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.724 Vali Acc: 0.872 Test Loss: 0.724 Test Acc: 0.872
Validation loss decreased (-0.859369 --> -0.871868).  Saving model ...
Epoch: 16 cost time: 1.1641380786895752
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0376765727996826
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.762 Vali Acc: 0.856 Test Loss: 0.762 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.973325252532959
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.856 Test Loss: 0.783 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9570503234863281
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0874848365783691
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.856 Test Loss: 0.743 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0522327423095703
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.866 Test Loss: 0.742 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0760974884033203
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.755 Vali Acc: 0.866 Test Loss: 0.755 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0595662593841553
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.859 Test Loss: 0.777 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0977888107299805
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.863 Test Loss: 0.783 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.878270149230957
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.784 Vali Acc: 0.856 Test Loss: 0.784 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps32_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22477064
model size : 100.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps32_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.470975160598755
Epoch: 1, Steps: 8 | Train Loss: 2.116 Vali Loss: 2.035 Vali Acc: 0.169 Test Loss: 2.035 Test Acc: 0.169
Validation loss decreased (inf --> -0.168730).  Saving model ...
Epoch: 2 cost time: 0.7225127220153809
Epoch: 2, Steps: 8 | Train Loss: 1.955 Vali Loss: 1.865 Vali Acc: 0.453 Test Loss: 1.865 Test Acc: 0.453
Validation loss decreased (-0.168730 --> -0.453106).  Saving model ...
Epoch: 3 cost time: 0.7956180572509766
Epoch: 3, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.642 Vali Acc: 0.653 Test Loss: 1.642 Test Acc: 0.653
Validation loss decreased (-0.453106 --> -0.653109).  Saving model ...
Epoch: 4 cost time: 0.8566000461578369
Epoch: 4, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.378 Vali Acc: 0.762 Test Loss: 1.378 Test Acc: 0.762
Validation loss decreased (-0.653109 --> -0.762486).  Saving model ...
Epoch: 5 cost time: 0.900965690612793
Epoch: 5, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.098 Vali Acc: 0.759 Test Loss: 1.098 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8746371269226074
Epoch: 6, Steps: 8 | Train Loss: 0.966 Vali Loss: 0.829 Vali Acc: 0.806 Test Loss: 0.829 Test Acc: 0.806
Validation loss decreased (-0.762486 --> -0.806242).  Saving model ...
Epoch: 7 cost time: 0.8254501819610596
Epoch: 7, Steps: 8 | Train Loss: 0.679 Vali Loss: 0.633 Vali Acc: 0.787 Test Loss: 0.633 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8270888328552246
Epoch: 8, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
Validation loss decreased (-0.806242 --> -0.815619).  Saving model ...
Epoch: 9 cost time: 0.8378214836120605
Epoch: 9, Steps: 8 | Train Loss: 0.310 Vali Loss: 0.517 Vali Acc: 0.831 Test Loss: 0.517 Test Acc: 0.831
Validation loss decreased (-0.815619 --> -0.831245).  Saving model ...
Epoch: 10 cost time: 0.8800899982452393
Epoch: 10, Steps: 8 | Train Loss: 0.234 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8157074451446533
Epoch: 11, Steps: 8 | Train Loss: 0.126 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6610710620880127
Epoch: 12, Steps: 8 | Train Loss: 0.096 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
Validation loss decreased (-0.831245 --> -0.846869).  Saving model ...
Epoch: 13 cost time: 0.892085075378418
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.587 Vali Acc: 0.847 Test Loss: 0.587 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.727837085723877
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6909153461456299
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.658 Vali Acc: 0.853 Test Loss: 0.658 Test Acc: 0.853
Validation loss decreased (-0.846869 --> -0.853118).  Saving model ...
Epoch: 16 cost time: 0.7314960956573486
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.631 Vali Acc: 0.853 Test Loss: 0.631 Test Acc: 0.853
Validation loss decreased (-0.853118 --> -0.853119).  Saving model ...
Epoch: 17 cost time: 0.8049812316894531
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.637 Vali Acc: 0.856 Test Loss: 0.637 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856244).  Saving model ...
Epoch: 18 cost time: 0.7451167106628418
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6806685924530029
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6675972938537598
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7841546535491943
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.727 Vali Acc: 0.841 Test Loss: 0.727 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7421565055847168
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.710 Vali Acc: 0.847 Test Loss: 0.710 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7315022945404053
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.715 Vali Acc: 0.859 Test Loss: 0.715 Test Acc: 0.859
Validation loss decreased (-0.856244 --> -0.859368).  Saving model ...
Epoch: 24 cost time: 0.7078418731689453
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.726 Vali Acc: 0.856 Test Loss: 0.726 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7150897979736328
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.859 Test Loss: 0.732 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.736907958984375
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.853 Test Loss: 0.744 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.741908073425293
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.760 Vali Acc: 0.856 Test Loss: 0.760 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6638925075531006
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.782 Vali Acc: 0.850 Test Loss: 0.782 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7128520011901855
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.676598310470581
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.784 Vali Acc: 0.853 Test Loss: 0.784 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7069501876831055
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.773 Vali Acc: 0.859 Test Loss: 0.773 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6369953155517578
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.767 Vali Acc: 0.859 Test Loss: 0.767 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7154827117919922
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.859 Test Loss: 0.768 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps32_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 22407944
model size : 100.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.6042792797088623
Epoch: 1, Steps: 8 | Train Loss: 2.147 Vali Loss: 1.978 Vali Acc: 0.287 Test Loss: 1.978 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 1.1209986209869385
Epoch: 2, Steps: 8 | Train Loss: 1.866 Vali Loss: 1.604 Vali Acc: 0.659 Test Loss: 1.604 Test Acc: 0.659
Validation loss decreased (-0.287480 --> -0.659359).  Saving model ...
Epoch: 3 cost time: 1.005347490310669
Epoch: 3, Steps: 8 | Train Loss: 1.367 Vali Loss: 1.163 Vali Acc: 0.772 Test Loss: 1.163 Test Acc: 0.772
Validation loss decreased (-0.659359 --> -0.771863).  Saving model ...
Epoch: 4 cost time: 1.0699775218963623
Epoch: 4, Steps: 8 | Train Loss: 0.955 Vali Loss: 0.782 Vali Acc: 0.791 Test Loss: 0.782 Test Acc: 0.791
Validation loss decreased (-0.771863 --> -0.790617).  Saving model ...
Epoch: 5 cost time: 0.994154691696167
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 0.598 Vali Acc: 0.838 Test Loss: 0.598 Test Acc: 0.838
Validation loss decreased (-0.790617 --> -0.837494).  Saving model ...
Epoch: 6 cost time: 0.8870847225189209
Epoch: 6, Steps: 8 | Train Loss: 0.409 Vali Loss: 0.520 Vali Acc: 0.806 Test Loss: 0.520 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1170358657836914
Epoch: 7, Steps: 8 | Train Loss: 0.282 Vali Loss: 0.520 Vali Acc: 0.841 Test Loss: 0.520 Test Acc: 0.841
Validation loss decreased (-0.837494 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 1.0732884407043457
Epoch: 8, Steps: 8 | Train Loss: 0.176 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.057915449142456
Epoch: 9, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.840620 --> -0.856244).  Saving model ...
Epoch: 10 cost time: 0.9739956855773926
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.729 Vali Acc: 0.847 Test Loss: 0.729 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1732299327850342
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9902350902557373
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.822 Vali Acc: 0.866 Test Loss: 0.822 Test Acc: 0.866
Validation loss decreased (-0.856244 --> -0.865617).  Saving model ...
Epoch: 13 cost time: 0.9955310821533203
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.868 Vali Acc: 0.853 Test Loss: 0.868 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8985583782196045
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.978 Vali Acc: 0.841 Test Loss: 0.978 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0724186897277832
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.881 Vali Acc: 0.850 Test Loss: 0.881 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9356529712677002
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.869 Vali Acc: 0.853 Test Loss: 0.869 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9215314388275146
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.917 Vali Acc: 0.847 Test Loss: 0.917 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0620121955871582
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.960 Vali Acc: 0.850 Test Loss: 0.960 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.987030029296875
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.853 Test Loss: 0.990 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1411545276641846
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.853 Test Loss: 1.005 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1779425144195557
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.850 Test Loss: 0.977 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1850731372833252
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.863 Test Loss: 0.958 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.865625
model parameter : 22605320
model size : 100.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7044458389282227
Epoch: 1, Steps: 8 | Train Loss: 2.125 Vali Loss: 2.007 Vali Acc: 0.219 Test Loss: 2.007 Test Acc: 0.219
Validation loss decreased (inf --> -0.218730).  Saving model ...
Epoch: 2 cost time: 1.1167981624603271
Epoch: 2, Steps: 8 | Train Loss: 1.912 Vali Loss: 1.777 Vali Acc: 0.494 Test Loss: 1.777 Test Acc: 0.494
Validation loss decreased (-0.218730 --> -0.493732).  Saving model ...
Epoch: 3 cost time: 1.107525110244751
Epoch: 3, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.466 Vali Acc: 0.697 Test Loss: 1.466 Test Acc: 0.697
Validation loss decreased (-0.493732 --> -0.696860).  Saving model ...
Epoch: 4 cost time: 1.0052690505981445
Epoch: 4, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.138 Vali Acc: 0.753 Test Loss: 1.138 Test Acc: 0.753
Validation loss decreased (-0.696860 --> -0.753114).  Saving model ...
Epoch: 5 cost time: 0.9301283359527588
Epoch: 5, Steps: 8 | Train Loss: 0.944 Vali Loss: 0.832 Vali Acc: 0.787 Test Loss: 0.832 Test Acc: 0.787
Validation loss decreased (-0.753114 --> -0.787492).  Saving model ...
Epoch: 6 cost time: 1.0306651592254639
Epoch: 6, Steps: 8 | Train Loss: 0.661 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
Validation loss decreased (-0.787492 --> -0.815619).  Saving model ...
Epoch: 7 cost time: 0.8131296634674072
Epoch: 7, Steps: 8 | Train Loss: 0.486 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
Validation loss decreased (-0.815619 --> -0.828120).  Saving model ...
Epoch: 8 cost time: 1.0715129375457764
Epoch: 8, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.481 Vali Acc: 0.847 Test Loss: 0.481 Test Acc: 0.847
Validation loss decreased (-0.828120 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 1.0162451267242432
Epoch: 9, Steps: 8 | Train Loss: 0.251 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9946153163909912
Epoch: 10, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.565 Vali Acc: 0.847 Test Loss: 0.565 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8784830570220947
Epoch: 11, Steps: 8 | Train Loss: 0.093 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
Validation loss decreased (-0.846870 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.0258393287658691
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.653 Vali Acc: 0.853 Test Loss: 0.653 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853118).  Saving model ...
Epoch: 13 cost time: 1.0914158821105957
Epoch: 13, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.675 Vali Acc: 0.838 Test Loss: 0.675 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.038860559463501
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.672 Vali Acc: 0.863 Test Loss: 0.672 Test Acc: 0.863
Validation loss decreased (-0.853118 --> -0.862493).  Saving model ...
Epoch: 15 cost time: 0.7842350006103516
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.747 Vali Acc: 0.853 Test Loss: 0.747 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0079374313354492
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.711 Vali Acc: 0.863 Test Loss: 0.711 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9667367935180664
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.725 Vali Acc: 0.859 Test Loss: 0.725 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0209355354309082
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.784 Vali Acc: 0.847 Test Loss: 0.784 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9756441116333008
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.853 Test Loss: 0.781 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9685344696044922
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.859 Test Loss: 0.757 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9509150981903076
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.866 Test Loss: 0.749 Test Acc: 0.866
Validation loss decreased (-0.862493 --> -0.865618).  Saving model ...
Epoch: 22 cost time: 0.9379208087921143
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.755 Vali Acc: 0.869 Test Loss: 0.755 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868742).  Saving model ...
Epoch: 23 cost time: 0.9144270420074463
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.762 Vali Acc: 0.869 Test Loss: 0.762 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8888907432556152
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.750 Vali Acc: 0.866 Test Loss: 0.750 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9703373908996582
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.767 Vali Acc: 0.869 Test Loss: 0.767 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.770928144454956
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.869 Test Loss: 0.781 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8352968692779541
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.869 Test Loss: 0.794 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6789937019348145
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.866 Test Loss: 0.804 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9660096168518066
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.869 Test Loss: 0.795 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0541393756866455
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.869 Test Loss: 0.789 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9402546882629395
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.869 Test Loss: 0.779 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.172130823135376
Epoch: 32, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.869 Test Loss: 0.795 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 22482440
model size : 100.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.140854835510254
Epoch: 1, Steps: 8 | Train Loss: 2.220 Vali Loss: 2.091 Vali Acc: 0.188 Test Loss: 2.091 Test Acc: 0.188
Validation loss decreased (inf --> -0.187479).  Saving model ...
Epoch: 2 cost time: 0.6482686996459961
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.900 Vali Acc: 0.356 Test Loss: 1.900 Test Acc: 0.356
Validation loss decreased (-0.187479 --> -0.356231).  Saving model ...
Epoch: 3 cost time: 0.6486241817474365
Epoch: 3, Steps: 8 | Train Loss: 1.787 Vali Loss: 1.671 Vali Acc: 0.613 Test Loss: 1.671 Test Acc: 0.613
Validation loss decreased (-0.356231 --> -0.612483).  Saving model ...
Epoch: 4 cost time: 0.7572717666625977
Epoch: 4, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.433 Vali Acc: 0.694 Test Loss: 1.433 Test Acc: 0.694
Validation loss decreased (-0.612483 --> -0.693736).  Saving model ...
Epoch: 5 cost time: 0.6807026863098145
Epoch: 5, Steps: 8 | Train Loss: 1.275 Vali Loss: 1.184 Vali Acc: 0.741 Test Loss: 1.184 Test Acc: 0.741
Validation loss decreased (-0.693736 --> -0.740613).  Saving model ...
Epoch: 6 cost time: 0.7761058807373047
Epoch: 6, Steps: 8 | Train Loss: 1.030 Vali Loss: 0.904 Vali Acc: 0.791 Test Loss: 0.904 Test Acc: 0.791
Validation loss decreased (-0.740613 --> -0.790616).  Saving model ...
Epoch: 7 cost time: 0.6453588008880615
Epoch: 7, Steps: 8 | Train Loss: 0.804 Vali Loss: 0.689 Vali Acc: 0.806 Test Loss: 0.689 Test Acc: 0.806
Validation loss decreased (-0.790616 --> -0.806243).  Saving model ...
Epoch: 8 cost time: 0.6996555328369141
Epoch: 8, Steps: 8 | Train Loss: 0.555 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
Validation loss decreased (-0.806243 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.768064022064209
Epoch: 9, Steps: 8 | Train Loss: 0.410 Vali Loss: 0.476 Vali Acc: 0.834 Test Loss: 0.476 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 0.8149361610412598
Epoch: 10, Steps: 8 | Train Loss: 0.263 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.740084171295166
Epoch: 11, Steps: 8 | Train Loss: 0.207 Vali Loss: 0.468 Vali Acc: 0.847 Test Loss: 0.468 Test Acc: 0.847
Validation loss decreased (-0.843745 --> -0.846870).  Saving model ...
Epoch: 12 cost time: 0.6473937034606934
Epoch: 12, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7637667655944824
Epoch: 13, Steps: 8 | Train Loss: 0.087 Vali Loss: 0.513 Vali Acc: 0.847 Test Loss: 0.513 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6952588558197021
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 0.525 Vali Acc: 0.863 Test Loss: 0.525 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862495).  Saving model ...
Epoch: 15 cost time: 0.7959973812103271
Epoch: 15, Steps: 8 | Train Loss: 0.047 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7640583515167236
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 0.570 Vali Acc: 0.859 Test Loss: 0.570 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.73468017578125
Epoch: 17, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7429962158203125
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.863 Test Loss: 0.611 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7306833267211914
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.863 Test Loss: 0.624 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7347807884216309
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.863 Test Loss: 0.630 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.770937442779541
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.632 Vali Acc: 0.866 Test Loss: 0.632 Test Acc: 0.866
Validation loss decreased (-0.862495 --> -0.865619).  Saving model ...
Epoch: 22 cost time: 0.7214467525482178
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.863 Test Loss: 0.630 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8027844429016113
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.859 Test Loss: 0.634 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8365423679351807
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.658 Vali Acc: 0.856 Test Loss: 0.658 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7524044513702393
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.698 Vali Acc: 0.856 Test Loss: 0.698 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6989436149597168
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.706 Vali Acc: 0.856 Test Loss: 0.706 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.68955397605896
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.707 Vali Acc: 0.859 Test Loss: 0.707 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7305989265441895
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.687 Vali Acc: 0.856 Test Loss: 0.687 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.718390703201294
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.863 Test Loss: 0.676 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7808916568756104
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.869 Test Loss: 0.681 Test Acc: 0.869
Validation loss decreased (-0.865619 --> -0.868743).  Saving model ...
Epoch: 31 cost time: 0.7850768566131592
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8427538871765137
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.856 Test Loss: 0.721 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8167052268981934
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.853 Test Loss: 0.744 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.783898115158081
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.853 Test Loss: 0.744 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7596790790557861
Epoch: 35, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.850 Test Loss: 0.737 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7496354579925537
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.859 Test Loss: 0.727 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.819896936416626
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.863 Test Loss: 0.725 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8024389743804932
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.863 Test Loss: 0.730 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8630714416503906
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.866 Test Loss: 0.733 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8095910549163818
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.863 Test Loss: 0.731 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.86875
model parameter : 22428680
model size : 100.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.731555700302124
Epoch: 1, Steps: 8 | Train Loss: 2.284 Vali Loss: 2.045 Vali Acc: 0.166 Test Loss: 2.045 Test Acc: 0.166
Validation loss decreased (inf --> -0.165605).  Saving model ...
Epoch: 2 cost time: 0.923274040222168
Epoch: 2, Steps: 8 | Train Loss: 1.895 Vali Loss: 1.620 Vali Acc: 0.584 Test Loss: 1.620 Test Acc: 0.584
Validation loss decreased (-0.165605 --> -0.584359).  Saving model ...
Epoch: 3 cost time: 0.8732132911682129
Epoch: 3, Steps: 8 | Train Loss: 1.428 Vali Loss: 1.150 Vali Acc: 0.787 Test Loss: 1.150 Test Acc: 0.787
Validation loss decreased (-0.584359 --> -0.787488).  Saving model ...
Epoch: 4 cost time: 0.9408586025238037
Epoch: 4, Steps: 8 | Train Loss: 0.943 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
Validation loss decreased (-0.787488 --> -0.803117).  Saving model ...
Epoch: 5 cost time: 0.9163663387298584
Epoch: 5, Steps: 8 | Train Loss: 0.623 Vali Loss: 0.548 Vali Acc: 0.838 Test Loss: 0.548 Test Acc: 0.838
Validation loss decreased (-0.803117 --> -0.837495).  Saving model ...
Epoch: 6 cost time: 0.9356861114501953
Epoch: 6, Steps: 8 | Train Loss: 0.428 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.837495 --> -0.840620).  Saving model ...
Epoch: 7 cost time: 0.9558942317962646
Epoch: 7, Steps: 8 | Train Loss: 0.268 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
Validation loss decreased (-0.840620 --> -0.840620).  Saving model ...
Epoch: 8 cost time: 0.7408976554870605
Epoch: 8, Steps: 8 | Train Loss: 0.191 Vali Loss: 0.526 Vali Acc: 0.853 Test Loss: 0.526 Test Acc: 0.853
Validation loss decreased (-0.840620 --> -0.853120).  Saving model ...
Epoch: 9 cost time: 0.6848092079162598
Epoch: 9, Steps: 8 | Train Loss: 0.127 Vali Loss: 0.691 Vali Acc: 0.834 Test Loss: 0.691 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9919929504394531
Epoch: 10, Steps: 8 | Train Loss: 0.078 Vali Loss: 0.725 Vali Acc: 0.847 Test Loss: 0.725 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9831657409667969
Epoch: 11, Steps: 8 | Train Loss: 0.036 Vali Loss: 0.648 Vali Acc: 0.872 Test Loss: 0.648 Test Acc: 0.872
Validation loss decreased (-0.853120 --> -0.871869).  Saving model ...
Epoch: 12 cost time: 0.8991014957427979
Epoch: 12, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.771 Vali Acc: 0.841 Test Loss: 0.771 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.058488130569458
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.746 Vali Acc: 0.863 Test Loss: 0.746 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0174267292022705
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.803 Vali Acc: 0.856 Test Loss: 0.803 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9039421081542969
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.840 Vali Acc: 0.847 Test Loss: 0.840 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.003610372543335
Epoch: 16, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.819 Vali Acc: 0.863 Test Loss: 0.819 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8336901664733887
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.833 Vali Acc: 0.869 Test Loss: 0.833 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8966524600982666
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.874 Vali Acc: 0.844 Test Loss: 0.874 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.925727128982544
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.954 Vali Acc: 0.844 Test Loss: 0.954 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1016535758972168
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.875 Test Loss: 0.856 Test Acc: 0.875
Validation loss decreased (-0.871869 --> -0.874991).  Saving model ...
Epoch: 21 cost time: 0.9754798412322998
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.892 Vali Acc: 0.878 Test Loss: 0.892 Test Acc: 0.878
Validation loss decreased (-0.874991 --> -0.878116).  Saving model ...
Epoch: 22 cost time: 1.0727217197418213
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.876 Vali Acc: 0.863 Test Loss: 0.876 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0653977394104004
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.841 Test Loss: 1.015 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0790760517120361
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.031 Vali Acc: 0.838 Test Loss: 1.031 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0370407104492188
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.850 Test Loss: 0.976 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8442225456237793
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.841 Test Loss: 0.962 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1423640251159668
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.847 Test Loss: 0.954 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1080493927001953
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.850 Test Loss: 0.949 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9025156497955322
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.853 Test Loss: 0.955 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9725100994110107
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.853 Test Loss: 0.970 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9384713172912598
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.850 Test Loss: 0.980 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 22609160
model size : 100.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.3949177265167236
Epoch: 1, Steps: 8 | Train Loss: 2.049 Vali Loss: 1.986 Vali Acc: 0.294 Test Loss: 1.986 Test Acc: 0.294
Validation loss decreased (inf --> -0.293730).  Saving model ...
Epoch: 2 cost time: 0.7573249340057373
Epoch: 2, Steps: 8 | Train Loss: 1.921 Vali Loss: 1.755 Vali Acc: 0.547 Test Loss: 1.755 Test Acc: 0.547
Validation loss decreased (-0.293730 --> -0.546857).  Saving model ...
Epoch: 3 cost time: 0.7660579681396484
Epoch: 3, Steps: 8 | Train Loss: 1.651 Vali Loss: 1.446 Vali Acc: 0.728 Test Loss: 1.446 Test Acc: 0.728
Validation loss decreased (-0.546857 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 0.7548353672027588
Epoch: 4, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.099 Vali Acc: 0.753 Test Loss: 1.099 Test Acc: 0.753
Validation loss decreased (-0.728111 --> -0.753114).  Saving model ...
Epoch: 5 cost time: 0.7422261238098145
Epoch: 5, Steps: 8 | Train Loss: 0.906 Vali Loss: 0.770 Vali Acc: 0.797 Test Loss: 0.770 Test Acc: 0.797
Validation loss decreased (-0.753114 --> -0.796867).  Saving model ...
Epoch: 6 cost time: 0.854525089263916
Epoch: 6, Steps: 8 | Train Loss: 0.604 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.796867 --> -0.843745).  Saving model ...
Epoch: 7 cost time: 0.7958414554595947
Epoch: 7, Steps: 8 | Train Loss: 0.478 Vali Loss: 0.515 Vali Acc: 0.825 Test Loss: 0.515 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8214545249938965
Epoch: 8, Steps: 8 | Train Loss: 0.347 Vali Loss: 0.513 Vali Acc: 0.831 Test Loss: 0.513 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6907413005828857
Epoch: 9, Steps: 8 | Train Loss: 0.208 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.843745 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 0.7084791660308838
Epoch: 10, Steps: 8 | Train Loss: 0.143 Vali Loss: 0.569 Vali Acc: 0.847 Test Loss: 0.569 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8442361354827881
Epoch: 11, Steps: 8 | Train Loss: 0.104 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7556579113006592
Epoch: 12, Steps: 8 | Train Loss: 0.063 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.878119).  Saving model ...
Epoch: 13 cost time: 0.799551248550415
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.584 Vali Acc: 0.863 Test Loss: 0.584 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7650227546691895
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.593 Vali Acc: 0.863 Test Loss: 0.593 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.837637186050415
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.643 Vali Acc: 0.872 Test Loss: 0.643 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7189757823944092
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.677 Vali Acc: 0.866 Test Loss: 0.677 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7808594703674316
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.718766450881958
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.687 Vali Acc: 0.863 Test Loss: 0.687 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7904424667358398
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.859 Test Loss: 0.714 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7139358520507812
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.701 Vali Acc: 0.863 Test Loss: 0.701 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7764220237731934
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.863 Test Loss: 0.722 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8510072231292725
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.869 Test Loss: 0.712 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 22501640
model size : 100.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.1486573219299316
Epoch: 1, Steps: 8 | Train Loss: 2.203 Vali Loss: 2.100 Vali Acc: 0.156 Test Loss: 2.100 Test Acc: 0.156
Validation loss decreased (inf --> -0.156229).  Saving model ...
Epoch: 2 cost time: 0.633857011795044
Epoch: 2, Steps: 8 | Train Loss: 2.026 Vali Loss: 1.910 Vali Acc: 0.291 Test Loss: 1.910 Test Acc: 0.291
Validation loss decreased (-0.156229 --> -0.290606).  Saving model ...
Epoch: 3 cost time: 0.6862931251525879
Epoch: 3, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.690 Vali Acc: 0.588 Test Loss: 1.690 Test Acc: 0.588
Validation loss decreased (-0.290606 --> -0.587483).  Saving model ...
Epoch: 4 cost time: 0.6552367210388184
Epoch: 4, Steps: 8 | Train Loss: 1.589 Vali Loss: 1.457 Vali Acc: 0.659 Test Loss: 1.457 Test Acc: 0.659
Validation loss decreased (-0.587483 --> -0.659360).  Saving model ...
Epoch: 5 cost time: 0.6030526161193848
Epoch: 5, Steps: 8 | Train Loss: 1.295 Vali Loss: 1.172 Vali Acc: 0.728 Test Loss: 1.172 Test Acc: 0.728
Validation loss decreased (-0.659360 --> -0.728113).  Saving model ...
Epoch: 6 cost time: 0.597541332244873
Epoch: 6, Steps: 8 | Train Loss: 1.049 Vali Loss: 0.903 Vali Acc: 0.766 Test Loss: 0.903 Test Acc: 0.766
Validation loss decreased (-0.728113 --> -0.765616).  Saving model ...
Epoch: 7 cost time: 0.6839742660522461
Epoch: 7, Steps: 8 | Train Loss: 0.798 Vali Loss: 0.669 Vali Acc: 0.797 Test Loss: 0.669 Test Acc: 0.797
Validation loss decreased (-0.765616 --> -0.796868).  Saving model ...
Epoch: 8 cost time: 0.7681128978729248
Epoch: 8, Steps: 8 | Train Loss: 0.551 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
Validation loss decreased (-0.796868 --> -0.818744).  Saving model ...
Epoch: 9 cost time: 0.7305781841278076
Epoch: 9, Steps: 8 | Train Loss: 0.379 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
Validation loss decreased (-0.818744 --> -0.818745).  Saving model ...
Epoch: 10 cost time: 0.7793271541595459
Epoch: 10, Steps: 8 | Train Loss: 0.312 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
Validation loss decreased (-0.818745 --> -0.821870).  Saving model ...
Epoch: 11 cost time: 0.5719389915466309
Epoch: 11, Steps: 8 | Train Loss: 0.203 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7095425128936768
Epoch: 12, Steps: 8 | Train Loss: 0.139 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7522330284118652
Epoch: 13, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6360740661621094
Epoch: 14, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.548 Vali Acc: 0.828 Test Loss: 0.548 Test Acc: 0.828
Validation loss decreased (-0.821870 --> -0.828120).  Saving model ...
Epoch: 15 cost time: 0.685117244720459
Epoch: 15, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7890384197235107
Epoch: 16, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
Validation loss decreased (-0.828120 --> -0.843744).  Saving model ...
Epoch: 17 cost time: 0.6189227104187012
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846869).  Saving model ...
Epoch: 18 cost time: 0.7139723300933838
Epoch: 18, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7062699794769287
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.846869 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 0.721848726272583
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.617 Vali Acc: 0.853 Test Loss: 0.617 Test Acc: 0.853
Validation loss decreased (-0.849994 --> -0.853119).  Saving model ...
Epoch: 21 cost time: 0.7725281715393066
Epoch: 21, Steps: 8 | Train Loss: 0.012 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6267731189727783
Epoch: 22, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.646 Vali Acc: 0.853 Test Loss: 0.646 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6759579181671143
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.661 Vali Acc: 0.847 Test Loss: 0.661 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6889798641204834
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.668 Vali Acc: 0.847 Test Loss: 0.668 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8524861335754395
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7246019840240479
Epoch: 26, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.685312032699585
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.687 Vali Acc: 0.853 Test Loss: 0.687 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6516327857971191
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.853 Test Loss: 0.691 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6937255859375
Epoch: 29, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
Validation loss decreased (-0.853119 --> -0.856243).  Saving model ...
Epoch: 30 cost time: 0.6168897151947021
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.853 Test Loss: 0.693 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6705660820007324
Epoch: 31, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6165778636932373
Epoch: 32, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.856 Test Loss: 0.701 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6270046234130859
Epoch: 33, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.859 Test Loss: 0.720 Test Acc: 0.859
Validation loss decreased (-0.856243 --> -0.859368).  Saving model ...
Epoch: 34 cost time: 0.6445393562316895
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.859 Test Loss: 0.725 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.648801326751709
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.859 Test Loss: 0.725 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.60892653465271
Epoch: 36, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
Validation loss decreased (-0.859368 --> -0.862493).  Saving model ...
Epoch: 37 cost time: 0.6882219314575195
Epoch: 37, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6626691818237305
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.859 Test Loss: 0.751 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6962175369262695
Epoch: 39, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.757 Vali Acc: 0.856 Test Loss: 0.757 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.66925048828125
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.856 Test Loss: 0.759 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6564693450927734
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.856 Test Loss: 0.757 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6854069232940674
Epoch: 42, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.853 Test Loss: 0.758 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7017638683319092
Epoch: 43, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7088603973388672
Epoch: 44, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7178647518157959
Epoch: 45, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.774 Vali Acc: 0.850 Test Loss: 0.774 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6843967437744141
Epoch: 46, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.853 Test Loss: 0.777 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 22447880
model size : 100.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5695714950561523
Epoch: 1, Steps: 8 | Train Loss: 2.138 Vali Loss: 1.938 Vali Acc: 0.312 Test Loss: 1.938 Test Acc: 0.312
Validation loss decreased (inf --> -0.312481).  Saving model ...
Epoch: 2 cost time: 0.9112157821655273
Epoch: 2, Steps: 8 | Train Loss: 1.863 Vali Loss: 1.594 Vali Acc: 0.697 Test Loss: 1.594 Test Acc: 0.697
Validation loss decreased (-0.312481 --> -0.696859).  Saving model ...
Epoch: 3 cost time: 0.9441752433776855
Epoch: 3, Steps: 8 | Train Loss: 1.407 Vali Loss: 1.190 Vali Acc: 0.787 Test Loss: 1.190 Test Acc: 0.787
Validation loss decreased (-0.696859 --> -0.787488).  Saving model ...
Epoch: 4 cost time: 1.018554925918579
Epoch: 4, Steps: 8 | Train Loss: 1.056 Vali Loss: 0.836 Vali Acc: 0.787 Test Loss: 0.836 Test Acc: 0.787
Validation loss decreased (-0.787488 --> -0.787492).  Saving model ...
Epoch: 5 cost time: 0.8763196468353271
Epoch: 5, Steps: 8 | Train Loss: 0.720 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
Validation loss decreased (-0.787492 --> -0.812494).  Saving model ...
Epoch: 6 cost time: 0.786247968673706
Epoch: 6, Steps: 8 | Train Loss: 0.464 Vali Loss: 0.477 Vali Acc: 0.834 Test Loss: 0.477 Test Acc: 0.834
Validation loss decreased (-0.812494 --> -0.834370).  Saving model ...
Epoch: 7 cost time: 0.9703323841094971
Epoch: 7, Steps: 8 | Train Loss: 0.352 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.012660026550293
Epoch: 8, Steps: 8 | Train Loss: 0.204 Vali Loss: 0.534 Vali Acc: 0.847 Test Loss: 0.534 Test Acc: 0.847
Validation loss decreased (-0.834370 --> -0.846870).  Saving model ...
Epoch: 9 cost time: 0.9857666492462158
Epoch: 9, Steps: 8 | Train Loss: 0.131 Vali Loss: 0.656 Vali Acc: 0.831 Test Loss: 0.656 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8756101131439209
Epoch: 10, Steps: 8 | Train Loss: 0.090 Vali Loss: 0.728 Vali Acc: 0.834 Test Loss: 0.728 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0733473300933838
Epoch: 11, Steps: 8 | Train Loss: 0.051 Vali Loss: 0.658 Vali Acc: 0.863 Test Loss: 0.658 Test Acc: 0.863
Validation loss decreased (-0.846870 --> -0.862493).  Saving model ...
Epoch: 12 cost time: 0.8943617343902588
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 0.821 Vali Acc: 0.819 Test Loss: 0.821 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9866793155670166
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.746 Vali Acc: 0.866 Test Loss: 0.746 Test Acc: 0.866
Validation loss decreased (-0.862493 --> -0.865618).  Saving model ...
Epoch: 14 cost time: 0.9168975353240967
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0442819595336914
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.848 Vali Acc: 0.834 Test Loss: 0.848 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.74519944190979
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.856 Vali Acc: 0.844 Test Loss: 0.856 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9124510288238525
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.842 Vali Acc: 0.859 Test Loss: 0.842 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8601372241973877
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.850 Test Loss: 0.824 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9261298179626465
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.897 Vali Acc: 0.847 Test Loss: 0.897 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9133117198944092
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.963 Vali Acc: 0.847 Test Loss: 0.963 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0715594291687012
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.879 Vali Acc: 0.866 Test Loss: 0.879 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8596820831298828
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.866 Test Loss: 0.848 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9539124965667725
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.869 Test Loss: 0.853 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868741).  Saving model ...
Epoch: 24 cost time: 0.9008939266204834
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.872 Test Loss: 0.871 Test Acc: 0.872
Validation loss decreased (-0.868741 --> -0.871866).  Saving model ...
Epoch: 25 cost time: 0.8623449802398682
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.872 Test Loss: 0.871 Test Acc: 0.872
Validation loss decreased (-0.871866 --> -0.871866).  Saving model ...
Epoch: 26 cost time: 0.7548773288726807
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.872 Test Loss: 0.869 Test Acc: 0.872
Validation loss decreased (-0.871866 --> -0.871866).  Saving model ...
Epoch: 27 cost time: 0.8463585376739502
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.872 Vali Acc: 0.872 Test Loss: 0.872 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1408591270446777
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.872 Test Loss: 0.879 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9779984951019287
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.872 Test Loss: 0.875 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7590923309326172
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.869 Test Loss: 0.868 Test Acc: 0.869
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7780013084411621
Epoch: 31, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.869 Test Loss: 0.866 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9119179248809814
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.872 Test Loss: 0.863 Test Acc: 0.872
Validation loss decreased (-0.871866 --> -0.871866).  Saving model ...
Epoch: 33 cost time: 0.9897980690002441
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.872 Test Loss: 0.867 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1160483360290527
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.872 Test Loss: 0.872 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9327332973480225
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.872 Test Loss: 0.884 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0593609809875488
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.872 Test Loss: 0.899 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.924447774887085
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.872 Test Loss: 0.904 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9557406902313232
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.872 Test Loss: 0.905 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.058020830154419
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.872 Test Loss: 0.908 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9852354526519775
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.872 Test Loss: 0.910 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.873537540435791
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.872 Test Loss: 0.913 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1557199954986572
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.872 Test Loss: 0.916 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22605320
model size : 100.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.7146811485290527
Epoch: 1, Steps: 8 | Train Loss: 2.151 Vali Loss: 2.033 Vali Acc: 0.194 Test Loss: 2.033 Test Acc: 0.194
Validation loss decreased (inf --> -0.193730).  Saving model ...
Epoch: 2 cost time: 0.8327844142913818
Epoch: 2, Steps: 8 | Train Loss: 1.892 Vali Loss: 1.801 Vali Acc: 0.512 Test Loss: 1.801 Test Acc: 0.512
Validation loss decreased (-0.193730 --> -0.512482).  Saving model ...
Epoch: 3 cost time: 0.8449728488922119
Epoch: 3, Steps: 8 | Train Loss: 1.689 Vali Loss: 1.502 Vali Acc: 0.734 Test Loss: 1.502 Test Acc: 0.734
Validation loss decreased (-0.512482 --> -0.734360).  Saving model ...
Epoch: 4 cost time: 0.774066686630249
Epoch: 4, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.179 Vali Acc: 0.766 Test Loss: 1.179 Test Acc: 0.766
Validation loss decreased (-0.734360 --> -0.765613).  Saving model ...
Epoch: 5 cost time: 0.8212800025939941
Epoch: 5, Steps: 8 | Train Loss: 1.013 Vali Loss: 0.848 Vali Acc: 0.803 Test Loss: 0.848 Test Acc: 0.803
Validation loss decreased (-0.765613 --> -0.803117).  Saving model ...
Epoch: 6 cost time: 0.7529242038726807
Epoch: 6, Steps: 8 | Train Loss: 0.717 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
Validation loss decreased (-0.803117 --> -0.818744).  Saving model ...
Epoch: 7 cost time: 0.7987923622131348
Epoch: 7, Steps: 8 | Train Loss: 0.479 Vali Loss: 0.531 Vali Acc: 0.831 Test Loss: 0.531 Test Acc: 0.831
Validation loss decreased (-0.818744 --> -0.831245).  Saving model ...
Epoch: 8 cost time: 0.6805975437164307
Epoch: 8, Steps: 8 | Train Loss: 0.371 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
Validation loss decreased (-0.831245 --> -0.843745).  Saving model ...
Epoch: 9 cost time: 0.7797110080718994
Epoch: 9, Steps: 8 | Train Loss: 0.269 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8008692264556885
Epoch: 10, Steps: 8 | Train Loss: 0.157 Vali Loss: 0.599 Vali Acc: 0.834 Test Loss: 0.599 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8171260356903076
Epoch: 11, Steps: 8 | Train Loss: 0.100 Vali Loss: 0.584 Vali Acc: 0.853 Test Loss: 0.584 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853119).  Saving model ...
Epoch: 12 cost time: 0.6918051242828369
Epoch: 12, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.545 Vali Acc: 0.869 Test Loss: 0.545 Test Acc: 0.869
Validation loss decreased (-0.853119 --> -0.868745).  Saving model ...
Epoch: 13 cost time: 0.7229814529418945
Epoch: 13, Steps: 8 | Train Loss: 0.040 Vali Loss: 0.559 Vali Acc: 0.866 Test Loss: 0.559 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7762737274169922
Epoch: 14, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.615 Vali Acc: 0.863 Test Loss: 0.615 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6940858364105225
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.646 Vali Acc: 0.856 Test Loss: 0.646 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6771249771118164
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.596 Vali Acc: 0.863 Test Loss: 0.596 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6521759033203125
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.875 Test Loss: 0.602 Test Acc: 0.875
Validation loss decreased (-0.868745 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.7468156814575195
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8041503429412842
Epoch: 19, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.621 Vali Acc: 0.872 Test Loss: 0.621 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7203340530395508
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.872 Test Loss: 0.636 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7917830944061279
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.910510778427124
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.678 Vali Acc: 0.869 Test Loss: 0.678 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8317646980285645
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.669 Vali Acc: 0.863 Test Loss: 0.669 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7834248542785645
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7602972984313965
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.872 Test Loss: 0.666 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7567505836486816
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8955018520355225
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.878 Test Loss: 0.685 Test Acc: 0.878
Validation loss decreased (-0.874994 --> -0.878118).  Saving model ...
Epoch: 28 cost time: 0.7140610218048096
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.878 Test Loss: 0.683 Test Acc: 0.878
Validation loss decreased (-0.878118 --> -0.878118).  Saving model ...
Epoch: 29 cost time: 0.798443078994751
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.675 Vali Acc: 0.881 Test Loss: 0.675 Test Acc: 0.881
Validation loss decreased (-0.878118 --> -0.881243).  Saving model ...
Epoch: 30 cost time: 0.7733814716339111
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.690 Vali Acc: 0.881 Test Loss: 0.690 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8035871982574463
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.884 Test Loss: 0.693 Test Acc: 0.884
Validation loss decreased (-0.881243 --> -0.884368).  Saving model ...
Epoch: 32 cost time: 0.7889931201934814
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.884 Test Loss: 0.706 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7805466651916504
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.881 Test Loss: 0.701 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8371202945709229
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.881 Test Loss: 0.719 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.769568681716919
Epoch: 35, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.881 Test Loss: 0.723 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7887556552886963
Epoch: 36, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.884 Test Loss: 0.721 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.866940975189209
Epoch: 37, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.884 Test Loss: 0.725 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6694152355194092
Epoch: 38, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.884 Test Loss: 0.724 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8539683818817139
Epoch: 39, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.884 Test Loss: 0.735 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7490229606628418
Epoch: 40, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.884 Test Loss: 0.746 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7991364002227783
Epoch: 41, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.884 Test Loss: 0.753 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.884375
model parameter : 22520840
model size : 100.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.4458413124084473
Epoch: 1, Steps: 8 | Train Loss: 2.144 Vali Loss: 1.984 Vali Acc: 0.203 Test Loss: 1.984 Test Acc: 0.203
Validation loss decreased (inf --> -0.203105).  Saving model ...
Epoch: 2 cost time: 0.711822509765625
Epoch: 2, Steps: 8 | Train Loss: 1.939 Vali Loss: 1.797 Vali Acc: 0.453 Test Loss: 1.797 Test Acc: 0.453
Validation loss decreased (-0.203105 --> -0.453107).  Saving model ...
Epoch: 3 cost time: 0.7231040000915527
Epoch: 3, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.576 Vali Acc: 0.700 Test Loss: 1.576 Test Acc: 0.700
Validation loss decreased (-0.453107 --> -0.699984).  Saving model ...
Epoch: 4 cost time: 0.6526992321014404
Epoch: 4, Steps: 8 | Train Loss: 1.497 Vali Loss: 1.350 Vali Acc: 0.756 Test Loss: 1.350 Test Acc: 0.756
Validation loss decreased (-0.699984 --> -0.756236).  Saving model ...
Epoch: 5 cost time: 0.716799259185791
Epoch: 5, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.108 Vali Acc: 0.831 Test Loss: 1.108 Test Acc: 0.831
Validation loss decreased (-0.756236 --> -0.831239).  Saving model ...
Epoch: 6 cost time: 0.6707382202148438
Epoch: 6, Steps: 8 | Train Loss: 1.010 Vali Loss: 0.882 Vali Acc: 0.822 Test Loss: 0.882 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7891168594360352
Epoch: 7, Steps: 8 | Train Loss: 0.765 Vali Loss: 0.676 Vali Acc: 0.825 Test Loss: 0.676 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7058372497558594
Epoch: 8, Steps: 8 | Train Loss: 0.556 Vali Loss: 0.554 Vali Acc: 0.831 Test Loss: 0.554 Test Acc: 0.831
Validation loss decreased (-0.831239 --> -0.831244).  Saving model ...
Epoch: 9 cost time: 0.7511196136474609
Epoch: 9, Steps: 8 | Train Loss: 0.378 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7391476631164551
Epoch: 10, Steps: 8 | Train Loss: 0.265 Vali Loss: 0.490 Vali Acc: 0.831 Test Loss: 0.490 Test Acc: 0.831
Validation loss decreased (-0.831244 --> -0.831245).  Saving model ...
Epoch: 11 cost time: 0.72788405418396
Epoch: 11, Steps: 8 | Train Loss: 0.180 Vali Loss: 0.497 Vali Acc: 0.828 Test Loss: 0.497 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6057720184326172
Epoch: 12, Steps: 8 | Train Loss: 0.129 Vali Loss: 0.527 Vali Acc: 0.831 Test Loss: 0.527 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7086317539215088
Epoch: 13, Steps: 8 | Train Loss: 0.112 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
Validation loss decreased (-0.831245 --> -0.837494).  Saving model ...
Epoch: 14 cost time: 0.6653497219085693
Epoch: 14, Steps: 8 | Train Loss: 0.060 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
Validation loss decreased (-0.837494 --> -0.853120).  Saving model ...
Epoch: 15 cost time: 0.7739748954772949
Epoch: 15, Steps: 8 | Train Loss: 0.038 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.853120 --> -0.856245).  Saving model ...
Epoch: 16 cost time: 0.7190582752227783
Epoch: 16, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.574 Vali Acc: 0.841 Test Loss: 0.574 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7210443019866943
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6573734283447266
Epoch: 18, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8655333518981934
Epoch: 19, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.792762041091919
Epoch: 20, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7782437801361084
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.609 Vali Acc: 0.853 Test Loss: 0.609 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6333706378936768
Epoch: 22, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.612 Vali Acc: 0.847 Test Loss: 0.612 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6536352634429932
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.847 Test Loss: 0.639 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8564670085906982
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.645 Vali Acc: 0.853 Test Loss: 0.645 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7129683494567871
Epoch: 25, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.85625
model parameter : 22482440
model size : 100.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.833909034729004
Epoch: 1, Steps: 8 | Train Loss: 2.198 Vali Loss: 2.022 Vali Acc: 0.287 Test Loss: 2.022 Test Acc: 0.287
Validation loss decreased (inf --> -0.287480).  Saving model ...
Epoch: 2 cost time: 0.8604843616485596
Epoch: 2, Steps: 8 | Train Loss: 1.942 Vali Loss: 1.715 Vali Acc: 0.662 Test Loss: 1.715 Test Acc: 0.662
Validation loss decreased (-0.287480 --> -0.662483).  Saving model ...
Epoch: 3 cost time: 1.022911787033081
Epoch: 3, Steps: 8 | Train Loss: 1.536 Vali Loss: 1.356 Vali Acc: 0.794 Test Loss: 1.356 Test Acc: 0.794
Validation loss decreased (-0.662483 --> -0.793736).  Saving model ...
Epoch: 4 cost time: 0.8430685997009277
Epoch: 4, Steps: 8 | Train Loss: 1.198 Vali Loss: 1.005 Vali Acc: 0.778 Test Loss: 1.005 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1835815906524658
Epoch: 5, Steps: 8 | Train Loss: 0.858 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
Validation loss decreased (-0.793736 --> -0.806243).  Saving model ...
Epoch: 6 cost time: 0.9013330936431885
Epoch: 6, Steps: 8 | Train Loss: 0.579 Vali Loss: 0.567 Vali Acc: 0.831 Test Loss: 0.567 Test Acc: 0.831
Validation loss decreased (-0.806243 --> -0.831244).  Saving model ...
Epoch: 7 cost time: 1.111811876296997
Epoch: 7, Steps: 8 | Train Loss: 0.408 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.831244 --> -0.843745).  Saving model ...
Epoch: 8 cost time: 0.8574461936950684
Epoch: 8, Steps: 8 | Train Loss: 0.297 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0266659259796143
Epoch: 9, Steps: 8 | Train Loss: 0.237 Vali Loss: 0.632 Vali Acc: 0.834 Test Loss: 0.632 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8576574325561523
Epoch: 10, Steps: 8 | Train Loss: 0.136 Vali Loss: 0.650 Vali Acc: 0.831 Test Loss: 0.650 Test Acc: 0.831
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9789652824401855
Epoch: 11, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.727 Vali Acc: 0.834 Test Loss: 0.727 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7530956268310547
Epoch: 12, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.796 Vali Acc: 0.841 Test Loss: 0.796 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0086262226104736
Epoch: 13, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.756 Vali Acc: 0.853 Test Loss: 0.756 Test Acc: 0.853
Validation loss decreased (-0.843745 --> -0.853117).  Saving model ...
Epoch: 14 cost time: 0.8563449382781982
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 0.714 Vali Acc: 0.866 Test Loss: 0.714 Test Acc: 0.866
Validation loss decreased (-0.853117 --> -0.865618).  Saving model ...
Epoch: 15 cost time: 0.8400239944458008
Epoch: 15, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.710 Vali Acc: 0.869 Test Loss: 0.710 Test Acc: 0.869
Validation loss decreased (-0.865618 --> -0.868743).  Saving model ...
Epoch: 16 cost time: 0.9378228187561035
Epoch: 16, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.763 Vali Acc: 0.859 Test Loss: 0.763 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8417999744415283
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8955714702606201
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.859 Test Loss: 0.830 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9816725254058838
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.866 Test Loss: 0.805 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8136546611785889
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.872 Test Loss: 0.794 Test Acc: 0.872
Validation loss decreased (-0.868743 --> -0.871867).  Saving model ...
Epoch: 21 cost time: 0.8688392639160156
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.863 Test Loss: 0.801 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7760007381439209
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.866 Test Loss: 0.810 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8295106887817383
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.869 Test Loss: 0.809 Test Acc: 0.869
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9058847427368164
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.866 Test Loss: 0.810 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8758313655853271
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.869 Test Loss: 0.804 Test Acc: 0.869
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8722109794616699
Epoch: 26, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.869 Test Loss: 0.807 Test Acc: 0.869
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8801784515380859
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.869 Test Loss: 0.815 Test Acc: 0.869
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9736692905426025
Epoch: 28, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.872 Test Loss: 0.823 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9668474197387695
Epoch: 29, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.872 Test Loss: 0.828 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9803709983825684
Epoch: 30, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.872 Test Loss: 0.822 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22629896
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.675227165222168
Epoch: 1, Steps: 8 | Train Loss: 2.202 Vali Loss: 2.096 Vali Acc: 0.153 Test Loss: 2.096 Test Acc: 0.153
Validation loss decreased (inf --> -0.153104).  Saving model ...
Epoch: 2 cost time: 0.8214991092681885
Epoch: 2, Steps: 8 | Train Loss: 2.072 Vali Loss: 1.878 Vali Acc: 0.450 Test Loss: 1.878 Test Acc: 0.450
Validation loss decreased (-0.153104 --> -0.449981).  Saving model ...
Epoch: 3 cost time: 0.7032382488250732
Epoch: 3, Steps: 8 | Train Loss: 1.783 Vali Loss: 1.627 Vali Acc: 0.662 Test Loss: 1.627 Test Acc: 0.662
Validation loss decreased (-0.449981 --> -0.662484).  Saving model ...
Epoch: 4 cost time: 0.8194417953491211
Epoch: 4, Steps: 8 | Train Loss: 1.463 Vali Loss: 1.336 Vali Acc: 0.781 Test Loss: 1.336 Test Acc: 0.781
Validation loss decreased (-0.662484 --> -0.781237).  Saving model ...
Epoch: 5 cost time: 0.8442747592926025
Epoch: 5, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.023 Vali Acc: 0.819 Test Loss: 1.023 Test Acc: 0.819
Validation loss decreased (-0.781237 --> -0.818740).  Saving model ...
Epoch: 6 cost time: 0.8243846893310547
Epoch: 6, Steps: 8 | Train Loss: 0.877 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.818740 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.8386707305908203
Epoch: 7, Steps: 8 | Train Loss: 0.618 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6977827548980713
Epoch: 8, Steps: 8 | Train Loss: 0.483 Vali Loss: 0.501 Vali Acc: 0.831 Test Loss: 0.501 Test Acc: 0.831
Validation loss decreased (-0.824993 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.8797030448913574
Epoch: 9, Steps: 8 | Train Loss: 0.295 Vali Loss: 0.527 Vali Acc: 0.834 Test Loss: 0.527 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834370).  Saving model ...
Epoch: 10 cost time: 0.769141435623169
Epoch: 10, Steps: 8 | Train Loss: 0.211 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 11 cost time: 0.8038089275360107
Epoch: 11, Steps: 8 | Train Loss: 0.159 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7324895858764648
Epoch: 12, Steps: 8 | Train Loss: 0.081 Vali Loss: 0.518 Vali Acc: 0.863 Test Loss: 0.518 Test Acc: 0.863
Validation loss decreased (-0.843745 --> -0.862495).  Saving model ...
Epoch: 13 cost time: 0.826972246170044
Epoch: 13, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7833375930786133
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7928264141082764
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9570250511169434
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.77707839012146
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 0.625 Vali Acc: 0.853 Test Loss: 0.625 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7389309406280518
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.633 Vali Acc: 0.853 Test Loss: 0.633 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8747897148132324
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7193455696105957
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6790871620178223
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.671 Vali Acc: 0.847 Test Loss: 0.671 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8012363910675049
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.8625
model parameter : 22560776
model size : 100.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5292959213256836
Epoch: 1, Steps: 8 | Train Loss: 2.183 Vali Loss: 2.075 Vali Acc: 0.084 Test Loss: 2.075 Test Acc: 0.084
Validation loss decreased (inf --> -0.084354).  Saving model ...
Epoch: 2 cost time: 0.6718404293060303
Epoch: 2, Steps: 8 | Train Loss: 2.035 Vali Loss: 1.904 Vali Acc: 0.350 Test Loss: 1.904 Test Acc: 0.350
Validation loss decreased (-0.084354 --> -0.349981).  Saving model ...
Epoch: 3 cost time: 0.5801699161529541
Epoch: 3, Steps: 8 | Train Loss: 1.881 Vali Loss: 1.706 Vali Acc: 0.703 Test Loss: 1.706 Test Acc: 0.703
Validation loss decreased (-0.349981 --> -0.703108).  Saving model ...
Epoch: 4 cost time: 0.7085933685302734
Epoch: 4, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.485 Vali Acc: 0.731 Test Loss: 1.485 Test Acc: 0.731
Validation loss decreased (-0.703108 --> -0.731235).  Saving model ...
Epoch: 5 cost time: 0.691314697265625
Epoch: 5, Steps: 8 | Train Loss: 1.394 Vali Loss: 1.244 Vali Acc: 0.750 Test Loss: 1.244 Test Acc: 0.750
Validation loss decreased (-0.731235 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.8075916767120361
Epoch: 6, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.000 Vali Acc: 0.784 Test Loss: 1.000 Test Acc: 0.784
Validation loss decreased (-0.749988 --> -0.784365).  Saving model ...
Epoch: 7 cost time: 0.727149248123169
Epoch: 7, Steps: 8 | Train Loss: 0.929 Vali Loss: 0.797 Vali Acc: 0.797 Test Loss: 0.797 Test Acc: 0.797
Validation loss decreased (-0.784365 --> -0.796867).  Saving model ...
Epoch: 8 cost time: 0.8085751533508301
Epoch: 8, Steps: 8 | Train Loss: 0.689 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
Validation loss decreased (-0.796867 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.6756641864776611
Epoch: 9, Steps: 8 | Train Loss: 0.498 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
Validation loss decreased (-0.799993 --> -0.803119).  Saving model ...
Epoch: 10 cost time: 0.728381872177124
Epoch: 10, Steps: 8 | Train Loss: 0.399 Vali Loss: 0.556 Vali Acc: 0.812 Test Loss: 0.556 Test Acc: 0.812
Validation loss decreased (-0.803119 --> -0.812494).  Saving model ...
Epoch: 11 cost time: 0.6742119789123535
Epoch: 11, Steps: 8 | Train Loss: 0.277 Vali Loss: 0.513 Vali Acc: 0.825 Test Loss: 0.513 Test Acc: 0.825
Validation loss decreased (-0.812494 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 0.6722488403320312
Epoch: 12, Steps: 8 | Train Loss: 0.190 Vali Loss: 0.504 Vali Acc: 0.834 Test Loss: 0.504 Test Acc: 0.834
Validation loss decreased (-0.824995 --> -0.834370).  Saving model ...
Epoch: 13 cost time: 0.6546831130981445
Epoch: 13, Steps: 8 | Train Loss: 0.142 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
Validation loss decreased (-0.834370 --> -0.843745).  Saving model ...
Epoch: 14 cost time: 0.6090269088745117
Epoch: 14, Steps: 8 | Train Loss: 0.099 Vali Loss: 0.506 Vali Acc: 0.859 Test Loss: 0.506 Test Acc: 0.859
Validation loss decreased (-0.843745 --> -0.859370).  Saving model ...
Epoch: 15 cost time: 0.7078475952148438
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 0.515 Vali Acc: 0.859 Test Loss: 0.515 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6898331642150879
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 0.520 Vali Acc: 0.859 Test Loss: 0.520 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.686166524887085
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.654149055480957
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7207915782928467
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 0.563 Vali Acc: 0.853 Test Loss: 0.563 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6684467792510986
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6617121696472168
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.569 Vali Acc: 0.853 Test Loss: 0.569 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7022087574005127
Epoch: 22, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.665952205657959
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.618 Vali Acc: 0.853 Test Loss: 0.618 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6284465789794922
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 0.636 Vali Acc: 0.853 Test Loss: 0.636 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.859375
model parameter : 22522376
model size : 100.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.5379638671875
Epoch: 1, Steps: 8 | Train Loss: 2.206 Vali Loss: 1.988 Vali Acc: 0.231 Test Loss: 1.988 Test Acc: 0.231
Validation loss decreased (inf --> -0.231230).  Saving model ...
Epoch: 2 cost time: 1.0289421081542969
Epoch: 2, Steps: 8 | Train Loss: 1.916 Vali Loss: 1.689 Vali Acc: 0.584 Test Loss: 1.689 Test Acc: 0.584
Validation loss decreased (-0.231230 --> -0.584358).  Saving model ...
Epoch: 3 cost time: 0.8757579326629639
Epoch: 3, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.363 Vali Acc: 0.728 Test Loss: 1.363 Test Acc: 0.728
Validation loss decreased (-0.584358 --> -0.728111).  Saving model ...
Epoch: 4 cost time: 1.0335805416107178
Epoch: 4, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.049 Vali Acc: 0.787 Test Loss: 1.049 Test Acc: 0.787
Validation loss decreased (-0.728111 --> -0.787490).  Saving model ...
Epoch: 5 cost time: 0.9925215244293213
Epoch: 5, Steps: 8 | Train Loss: 0.903 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.787490 --> -0.799992).  Saving model ...
Epoch: 6 cost time: 0.8449020385742188
Epoch: 6, Steps: 8 | Train Loss: 0.627 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.799992 --> -0.809369).  Saving model ...
Epoch: 7 cost time: 1.0611867904663086
Epoch: 7, Steps: 8 | Train Loss: 0.391 Vali Loss: 0.522 Vali Acc: 0.822 Test Loss: 0.522 Test Acc: 0.822
Validation loss decreased (-0.809369 --> -0.821870).  Saving model ...
Epoch: 8 cost time: 0.8734855651855469
Epoch: 8, Steps: 8 | Train Loss: 0.321 Vali Loss: 0.503 Vali Acc: 0.831 Test Loss: 0.503 Test Acc: 0.831
Validation loss decreased (-0.821870 --> -0.831245).  Saving model ...
Epoch: 9 cost time: 0.9045937061309814
Epoch: 9, Steps: 8 | Train Loss: 0.228 Vali Loss: 0.561 Vali Acc: 0.834 Test Loss: 0.561 Test Acc: 0.834
Validation loss decreased (-0.831245 --> -0.834369).  Saving model ...
Epoch: 10 cost time: 0.8817687034606934
Epoch: 10, Steps: 8 | Train Loss: 0.116 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
Validation loss decreased (-0.834369 --> -0.859370).  Saving model ...
Epoch: 11 cost time: 0.8460052013397217
Epoch: 11, Steps: 8 | Train Loss: 0.073 Vali Loss: 0.610 Vali Acc: 0.856 Test Loss: 0.610 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8464882373809814
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7883000373840332
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6979608535766602
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
Validation loss decreased (-0.859370 --> -0.871869).  Saving model ...
Epoch: 15 cost time: 0.8389120101928711
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 0.654 Vali Acc: 0.863 Test Loss: 0.654 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8383152484893799
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.779 Vali Acc: 0.847 Test Loss: 0.779 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8418185710906982
Epoch: 17, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.814 Vali Acc: 0.847 Test Loss: 0.814 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8699526786804199
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.767 Vali Acc: 0.853 Test Loss: 0.767 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9014880657196045
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.859 Test Loss: 0.736 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9899237155914307
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9586312770843506
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 0.732 Vali Acc: 0.856 Test Loss: 0.732 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8815720081329346
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.949195384979248
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.856 Test Loss: 0.763 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0118787288665771
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22675976
model size : 101.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.726580858230591
Epoch: 1, Steps: 8 | Train Loss: 2.293 Vali Loss: 2.110 Vali Acc: 0.172 Test Loss: 2.110 Test Acc: 0.172
Validation loss decreased (inf --> -0.171854).  Saving model ...
Epoch: 2 cost time: 0.7081751823425293
Epoch: 2, Steps: 8 | Train Loss: 2.056 Vali Loss: 1.842 Vali Acc: 0.391 Test Loss: 1.842 Test Acc: 0.391
Validation loss decreased (-0.171854 --> -0.390607).  Saving model ...
Epoch: 3 cost time: 0.765958309173584
Epoch: 3, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.555 Vali Acc: 0.713 Test Loss: 1.555 Test Acc: 0.713
Validation loss decreased (-0.390607 --> -0.712484).  Saving model ...
Epoch: 4 cost time: 0.6799869537353516
Epoch: 4, Steps: 8 | Train Loss: 1.426 Vali Loss: 1.256 Vali Acc: 0.794 Test Loss: 1.256 Test Acc: 0.794
Validation loss decreased (-0.712484 --> -0.793737).  Saving model ...
Epoch: 5 cost time: 0.7263960838317871
Epoch: 5, Steps: 8 | Train Loss: 1.162 Vali Loss: 0.956 Vali Acc: 0.825 Test Loss: 0.956 Test Acc: 0.825
Validation loss decreased (-0.793737 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.8049781322479248
Epoch: 6, Steps: 8 | Train Loss: 0.851 Vali Loss: 0.709 Vali Acc: 0.819 Test Loss: 0.709 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7139101028442383
Epoch: 7, Steps: 8 | Train Loss: 0.647 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.824990 --> -0.828119).  Saving model ...
Epoch: 8 cost time: 0.8088726997375488
Epoch: 8, Steps: 8 | Train Loss: 0.455 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6659102439880371
Epoch: 9, Steps: 8 | Train Loss: 0.287 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
Validation loss decreased (-0.828119 --> -0.837495).  Saving model ...
Epoch: 10 cost time: 0.7304165363311768
Epoch: 10, Steps: 8 | Train Loss: 0.281 Vali Loss: 0.526 Vali Acc: 0.834 Test Loss: 0.526 Test Acc: 0.834
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8023331165313721
Epoch: 11, Steps: 8 | Train Loss: 0.169 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.837495 --> -0.862495).  Saving model ...
Epoch: 12 cost time: 0.7948243618011475
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
Validation loss decreased (-0.862495 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 0.7767479419708252
Epoch: 13, Steps: 8 | Train Loss: 0.077 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
Validation loss decreased (-0.874995 --> -0.878120).  Saving model ...
Epoch: 14 cost time: 0.6377403736114502
Epoch: 14, Steps: 8 | Train Loss: 0.057 Vali Loss: 0.571 Vali Acc: 0.863 Test Loss: 0.571 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6226465702056885
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 0.552 Vali Acc: 0.863 Test Loss: 0.552 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7961685657501221
Epoch: 16, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.580 Vali Acc: 0.866 Test Loss: 0.580 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6852452754974365
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 0.614 Vali Acc: 0.866 Test Loss: 0.614 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7794797420501709
Epoch: 18, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.614 Vali Acc: 0.863 Test Loss: 0.614 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7405450344085693
Epoch: 19, Steps: 8 | Train Loss: 0.014 Vali Loss: 0.608 Vali Acc: 0.866 Test Loss: 0.608 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8042376041412354
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.615 Vali Acc: 0.853 Test Loss: 0.615 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8778114318847656
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.863 Test Loss: 0.608 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.766676664352417
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.611 Vali Acc: 0.866 Test Loss: 0.611 Test Acc: 0.866
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8628768920898438
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.626 Vali Acc: 0.863 Test Loss: 0.626 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.878125
model parameter : 22614536
model size : 100.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_UWaveGestureLibraryModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/UWaveGestureLibrary/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

120
320
>>>>>>>start training : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
120
320
320
Epoch: 1 cost time: 2.413257598876953
Epoch: 1, Steps: 8 | Train Loss: 2.274 Vali Loss: 2.119 Vali Acc: 0.131 Test Loss: 2.119 Test Acc: 0.131
Validation loss decreased (inf --> -0.131229).  Saving model ...
Epoch: 2 cost time: 0.7239799499511719
Epoch: 2, Steps: 8 | Train Loss: 2.044 Vali Loss: 1.945 Vali Acc: 0.256 Test Loss: 1.945 Test Acc: 0.256
Validation loss decreased (-0.131229 --> -0.256231).  Saving model ...
Epoch: 3 cost time: 0.7076892852783203
Epoch: 3, Steps: 8 | Train Loss: 1.902 Vali Loss: 1.739 Vali Acc: 0.584 Test Loss: 1.739 Test Acc: 0.584
Validation loss decreased (-0.256231 --> -0.584358).  Saving model ...
Epoch: 4 cost time: 0.6516997814178467
Epoch: 4, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.523 Vali Acc: 0.731 Test Loss: 1.523 Test Acc: 0.731
Validation loss decreased (-0.584358 --> -0.731235).  Saving model ...
Epoch: 5 cost time: 0.625302791595459
Epoch: 5, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.279 Vali Acc: 0.806 Test Loss: 1.279 Test Acc: 0.806
Validation loss decreased (-0.731235 --> -0.806237).  Saving model ...
Epoch: 6 cost time: 0.5957109928131104
Epoch: 6, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.021 Vali Acc: 0.816 Test Loss: 1.021 Test Acc: 0.816
Validation loss decreased (-0.806237 --> -0.815615).  Saving model ...
Epoch: 7 cost time: 0.6922926902770996
Epoch: 7, Steps: 8 | Train Loss: 0.954 Vali Loss: 0.781 Vali Acc: 0.834 Test Loss: 0.781 Test Acc: 0.834
Validation loss decreased (-0.815615 --> -0.834367).  Saving model ...
Epoch: 8 cost time: 0.6623518466949463
Epoch: 8, Steps: 8 | Train Loss: 0.692 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
Validation loss decreased (-0.834367 --> -0.843744).  Saving model ...
Epoch: 9 cost time: 0.6767354011535645
Epoch: 9, Steps: 8 | Train Loss: 0.507 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
Validation loss decreased (-0.843744 --> -0.846870).  Saving model ...
Epoch: 10 cost time: 0.6652684211730957
Epoch: 10, Steps: 8 | Train Loss: 0.372 Vali Loss: 0.444 Vali Acc: 0.853 Test Loss: 0.444 Test Acc: 0.853
Validation loss decreased (-0.846870 --> -0.853121).  Saving model ...
Epoch: 11 cost time: 0.5639464855194092
Epoch: 11, Steps: 8 | Train Loss: 0.222 Vali Loss: 0.440 Vali Acc: 0.850 Test Loss: 0.440 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.660165548324585
Epoch: 12, Steps: 8 | Train Loss: 0.162 Vali Loss: 0.443 Vali Acc: 0.863 Test Loss: 0.443 Test Acc: 0.863
Validation loss decreased (-0.853121 --> -0.862496).  Saving model ...
Epoch: 13 cost time: 0.6945948600769043
Epoch: 13, Steps: 8 | Train Loss: 0.106 Vali Loss: 0.484 Vali Acc: 0.853 Test Loss: 0.484 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6433002948760986
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6917426586151123
Epoch: 15, Steps: 8 | Train Loss: 0.064 Vali Loss: 0.482 Vali Acc: 0.853 Test Loss: 0.482 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6543731689453125
Epoch: 16, Steps: 8 | Train Loss: 0.039 Vali Loss: 0.477 Vali Acc: 0.863 Test Loss: 0.477 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7261009216308594
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6561861038208008
Epoch: 18, Steps: 8 | Train Loss: 0.026 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6155374050140381
Epoch: 19, Steps: 8 | Train Loss: 0.023 Vali Loss: 0.502 Vali Acc: 0.866 Test Loss: 0.502 Test Acc: 0.866
Validation loss decreased (-0.862496 --> -0.865620).  Saving model ...
Epoch: 20 cost time: 0.5928974151611328
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.872 Test Loss: 0.522 Test Acc: 0.872
Validation loss decreased (-0.865620 --> -0.871870).  Saving model ...
Epoch: 21 cost time: 0.5518877506256104
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 0.539 Vali Acc: 0.869 Test Loss: 0.539 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6214656829833984
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 0.545 Vali Acc: 0.866 Test Loss: 0.545 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5909919738769531
Epoch: 23, Steps: 8 | Train Loss: 0.010 Vali Loss: 0.549 Vali Acc: 0.859 Test Loss: 0.549 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5487501621246338
Epoch: 24, Steps: 8 | Train Loss: 0.009 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6500866413116455
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.863 Test Loss: 0.563 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5676276683807373
Epoch: 26, Steps: 8 | Train Loss: 0.008 Vali Loss: 0.572 Vali Acc: 0.866 Test Loss: 0.572 Test Acc: 0.866
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7883117198944092
Epoch: 27, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.578 Vali Acc: 0.866 Test Loss: 0.578 Test Acc: 0.866
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.708810567855835
Epoch: 28, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.577 Vali Acc: 0.869 Test Loss: 0.577 Test Acc: 0.869
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6260788440704346
Epoch: 29, Steps: 8 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.869 Test Loss: 0.573 Test Acc: 0.869
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5902876853942871
Epoch: 30, Steps: 8 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.869 Test Loss: 0.576 Test Acc: 0.869
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_UWaveGestureLibrary_GPT4TS_UEA_ftM_sl315_ll0_pl0_el3_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
320
test shape: torch.Size([320, 8]) torch.Size([320, 1])
accuracy:0.871875
model parameter : 22591496
model size : 100.85MB
