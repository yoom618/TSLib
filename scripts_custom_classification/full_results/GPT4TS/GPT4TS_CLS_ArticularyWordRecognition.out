Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.313969373703003
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.331 Vali Acc: 0.470 Test Loss: 2.331 Test Acc: 0.470
Validation loss decreased (inf --> -0.469977).  Saving model ...
Epoch: 2 cost time: 2.8403100967407227
Epoch: 2, Steps: 18 | Train Loss: 1.575 Vali Loss: 0.692 Vali Acc: 0.860 Test Loss: 0.692 Test Acc: 0.860
Validation loss decreased (-0.469977 --> -0.859993).  Saving model ...
Epoch: 3 cost time: 2.9738171100616455
Epoch: 3, Steps: 18 | Train Loss: 0.332 Vali Loss: 0.289 Vali Acc: 0.910 Test Loss: 0.289 Test Acc: 0.910
Validation loss decreased (-0.859993 --> -0.909997).  Saving model ...
Epoch: 4 cost time: 1.1711113452911377
Epoch: 4, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.370 Vali Acc: 0.913 Test Loss: 0.370 Test Acc: 0.913
Validation loss decreased (-0.909997 --> -0.913330).  Saving model ...
Epoch: 5 cost time: 4.070414066314697
Epoch: 5, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.913330 --> -0.936664).  Saving model ...
Epoch: 6 cost time: 1.8272078037261963
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.327 Vali Acc: 0.943 Test Loss: 0.327 Test Acc: 0.943
Validation loss decreased (-0.936664 --> -0.943330).  Saving model ...
Epoch: 7 cost time: 4.6408257484436035
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.960 Test Loss: 0.289 Test Acc: 0.960
Validation loss decreased (-0.943330 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 4.333037376403809
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 3.827888011932373
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 3.737881660461426
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7302513122558594
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7082903385162354
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.970 Test Loss: 0.221 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.651240587234497
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.011993885040283
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.53407621383667
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.288884162902832
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.970 Test Loss: 0.220 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8512523174285889
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.970 Test Loss: 0.219 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8866677284240723
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.579467535018921
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 44970265
model size : 186.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7876229286193848
Epoch: 1, Steps: 18 | Train Loss: 3.188 Vali Loss: 2.544 Vali Acc: 0.523 Test Loss: 2.544 Test Acc: 0.523
Validation loss decreased (inf --> -0.523308).  Saving model ...
Epoch: 2 cost time: 2.769324541091919
Epoch: 2, Steps: 18 | Train Loss: 1.928 Vali Loss: 0.966 Vali Acc: 0.900 Test Loss: 0.966 Test Acc: 0.900
Validation loss decreased (-0.523308 --> -0.899990).  Saving model ...
Epoch: 3 cost time: 2.566232681274414
Epoch: 3, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
Validation loss decreased (-0.899990 --> -0.919997).  Saving model ...
Epoch: 4 cost time: 2.8519411087036133
Epoch: 4, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
Validation loss decreased (-0.919997 --> -0.926664).  Saving model ...
Epoch: 5 cost time: 3.301769495010376
Epoch: 5, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.422 Vali Acc: 0.907 Test Loss: 0.422 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.179802179336548
Epoch: 6, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.426 Vali Acc: 0.913 Test Loss: 0.426 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7914326190948486
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.280 Vali Acc: 0.940 Test Loss: 0.280 Test Acc: 0.940
Validation loss decreased (-0.926664 --> -0.939997).  Saving model ...
Epoch: 8 cost time: 2.652294635772705
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.325 Vali Acc: 0.953 Test Loss: 0.325 Test Acc: 0.953
Validation loss decreased (-0.939997 --> -0.953330).  Saving model ...
Epoch: 9 cost time: 2.759422540664673
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.953330 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 2.6900761127471924
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.510073661804199
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8238649368286133
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 2.917128086090088
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2522315979003906
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2157490253448486
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5715670585632324
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.475961685180664
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8171095848083496
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.928575277328491
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7644338607788086
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.682093620300293
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8421664237976074
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44493337
model size : 184.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.124090671539307
Epoch: 1, Steps: 18 | Train Loss: 3.243 Vali Loss: 2.785 Vali Acc: 0.490 Test Loss: 2.785 Test Acc: 0.490
Validation loss decreased (inf --> -0.489972).  Saving model ...
Epoch: 2 cost time: 2.108598232269287
Epoch: 2, Steps: 18 | Train Loss: 2.405 Vali Loss: 1.645 Vali Acc: 0.897 Test Loss: 1.645 Test Acc: 0.897
Validation loss decreased (-0.489972 --> -0.896650).  Saving model ...
Epoch: 3 cost time: 2.010389566421509
Epoch: 3, Steps: 18 | Train Loss: 1.100 Vali Loss: 0.426 Vali Acc: 0.907 Test Loss: 0.426 Test Acc: 0.907
Validation loss decreased (-0.896650 --> -0.906662).  Saving model ...
Epoch: 4 cost time: 2.1267759799957275
Epoch: 4, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.906662 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.8436548709869385
Epoch: 5, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.916664 --> -0.936665).  Saving model ...
Epoch: 6 cost time: 1.504955530166626
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.936665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.1169359683990479
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1150422096252441
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1625821590423584
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.0988986492156982
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.8095955848693848
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3990793228149414
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8295187950134277
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5818257331848145
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.802880048751831
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4189739227294922
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.788163423538208
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0962774753570557
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.6148114204406738
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.609654426574707
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5648455619812012
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.484339714050293
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1922571659088135
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6032497882843018
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7889738082885742
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5223724842071533
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6929705142974854
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2986681461334229
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.7035386562347412
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5456197261810303
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2143280506134033
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.9390254020690918
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.723464012145996
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.6790173053741455
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.913604736328125
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.734006643295288
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2523689270019531
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8162429332733154
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8235743045806885
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2485640048980713
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0949139595031738
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2031497955322266
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.9693799018859863
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44016409
model size : 182.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.21858024597168
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 2.493 Vali Acc: 0.530 Test Loss: 2.493 Test Acc: 0.530
Validation loss decreased (inf --> -0.529975).  Saving model ...
Epoch: 2 cost time: 2.265947103500366
Epoch: 2, Steps: 18 | Train Loss: 1.695 Vali Loss: 0.773 Vali Acc: 0.883 Test Loss: 0.773 Test Acc: 0.883
Validation loss decreased (-0.529975 --> -0.883326).  Saving model ...
Epoch: 3 cost time: 3.5770769119262695
Epoch: 3, Steps: 18 | Train Loss: 0.322 Vali Loss: 0.285 Vali Acc: 0.907 Test Loss: 0.285 Test Acc: 0.907
Validation loss decreased (-0.883326 --> -0.906664).  Saving model ...
Epoch: 4 cost time: 3.698096513748169
Epoch: 4, Steps: 18 | Train Loss: 0.260 Vali Loss: 0.390 Vali Acc: 0.920 Test Loss: 0.390 Test Acc: 0.920
Validation loss decreased (-0.906664 --> -0.919996).  Saving model ...
Epoch: 5 cost time: 3.459005832672119
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.380 Vali Acc: 0.920 Test Loss: 0.380 Test Acc: 0.920
Validation loss decreased (-0.919996 --> -0.919996).  Saving model ...
Epoch: 6 cost time: 1.9140286445617676
Epoch: 6, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.386 Vali Acc: 0.913 Test Loss: 0.386 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.931093454360962
Epoch: 7, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
Validation loss decreased (-0.919996 --> -0.936664).  Saving model ...
Epoch: 8 cost time: 2.840773582458496
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.936664 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 1.8888664245605469
Epoch: 9, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.568 Vali Acc: 0.920 Test Loss: 0.568 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3002703189849854
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.546 Vali Acc: 0.917 Test Loss: 0.546 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6524152755737305
Epoch: 11, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.574 Vali Acc: 0.913 Test Loss: 0.574 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.783604383468628
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.587 Vali Acc: 0.913 Test Loss: 0.587 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.343088388442993
Epoch: 13, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.463 Vali Acc: 0.933 Test Loss: 0.463 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3824124336242676
Epoch: 14, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.519 Vali Acc: 0.927 Test Loss: 0.519 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.159985303878784
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.940 Test Loss: 0.480 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0824825763702393
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.927 Test Loss: 0.499 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3840489387512207
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.683 Vali Acc: 0.903 Test Loss: 0.683 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.465424060821533
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 44970265
model size : 186.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.82129168510437
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 2.743 Vali Acc: 0.420 Test Loss: 2.743 Test Acc: 0.420
Validation loss decreased (inf --> -0.419973).  Saving model ...
Epoch: 2 cost time: 2.0752336978912354
Epoch: 2, Steps: 18 | Train Loss: 2.267 Vali Loss: 1.447 Vali Acc: 0.850 Test Loss: 1.447 Test Acc: 0.850
Validation loss decreased (-0.419973 --> -0.849986).  Saving model ...
Epoch: 3 cost time: 1.7925362586975098
Epoch: 3, Steps: 18 | Train Loss: 0.836 Vali Loss: 0.316 Vali Acc: 0.927 Test Loss: 0.316 Test Acc: 0.927
Validation loss decreased (-0.849986 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 1.508779525756836
Epoch: 4, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.926664 --> -0.929997).  Saving model ...
Epoch: 5 cost time: 2.1267740726470947
Epoch: 5, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
Validation loss decreased (-0.929997 --> -0.943331).  Saving model ...
Epoch: 6 cost time: 1.9103360176086426
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.162 Vali Acc: 0.943 Test Loss: 0.162 Test Acc: 0.943
Validation loss decreased (-0.943331 --> -0.943332).  Saving model ...
Epoch: 7 cost time: 1.8397831916809082
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1450600624084473
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.943332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.6950452327728271
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9780104160308838
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0230119228363037
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.10103440284729
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.6331002712249756
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.992140293121338
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.9997997283935547
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9073741436004639
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.926201343536377
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.007871150970459
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9276750087738037
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.4499402046203613
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.776104211807251
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.556380033493042
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0973665714263916
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5083258152008057
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.183295726776123
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7824978828430176
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2288610935211182
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.896909236907959
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4701080322265625
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.443847894668579
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 44265241
model size : 183.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5247573852539062
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 2.883 Vali Acc: 0.387 Test Loss: 2.883 Test Acc: 0.387
Validation loss decreased (inf --> -0.386638).  Saving model ...
Epoch: 2 cost time: 1.3385140895843506
Epoch: 2, Steps: 18 | Train Loss: 2.604 Vali Loss: 1.978 Vali Acc: 0.820 Test Loss: 1.978 Test Acc: 0.820
Validation loss decreased (-0.386638 --> -0.819980).  Saving model ...
Epoch: 3 cost time: 1.510859489440918
Epoch: 3, Steps: 18 | Train Loss: 1.422 Vali Loss: 0.555 Vali Acc: 0.897 Test Loss: 0.555 Test Acc: 0.897
Validation loss decreased (-0.819980 --> -0.896661).  Saving model ...
Epoch: 4 cost time: 1.3000338077545166
Epoch: 4, Steps: 18 | Train Loss: 0.350 Vali Loss: 0.177 Vali Acc: 0.947 Test Loss: 0.177 Test Acc: 0.947
Validation loss decreased (-0.896661 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.5237679481506348
Epoch: 5, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.946665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.2768967151641846
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.45159912109375
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3302216529846191
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3184654712677002
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.455336570739746
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6881933212280273
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.330456256866455
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.657738208770752
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4748919010162354
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.252201795578003
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.7812812328338623
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.7638471126556396
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.2319483757019043
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8739771842956543
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.59428071975708
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3811070919036865
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5120346546173096
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5102550983428955
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5016496181488037
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5078308582305908
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1627864837646484
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8260550498962402
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 43954201
model size : 182.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.895685911178589
Epoch: 1, Steps: 18 | Train Loss: 3.277 Vali Loss: 2.458 Vali Acc: 0.390 Test Loss: 2.458 Test Acc: 0.390
Validation loss decreased (inf --> -0.389975).  Saving model ...
Epoch: 2 cost time: 2.8859546184539795
Epoch: 2, Steps: 18 | Train Loss: 1.800 Vali Loss: 0.825 Vali Acc: 0.853 Test Loss: 0.825 Test Acc: 0.853
Validation loss decreased (-0.389975 --> -0.853325).  Saving model ...
Epoch: 3 cost time: 2.72226619720459
Epoch: 3, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.853325 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 2.769606590270996
Epoch: 4, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.259 Vali Acc: 0.943 Test Loss: 0.259 Test Acc: 0.943
Validation loss decreased (-0.929997 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 3.1798412799835205
Epoch: 5, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.640 Vali Acc: 0.877 Test Loss: 0.640 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.545583486557007
Epoch: 6, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.364 Vali Acc: 0.933 Test Loss: 0.364 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7028791904449463
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.930 Test Loss: 0.420 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.032046318054199
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
Validation loss decreased (-0.943331 --> -0.953331).  Saving model ...
Epoch: 9 cost time: 2.834596872329712
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 10 cost time: 2.6861002445220947
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.408 Vali Acc: 0.937 Test Loss: 0.408 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6297192573547363
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.957 Test Loss: 0.343 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4343950748443604
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.719 Vali Acc: 0.903 Test Loss: 0.719 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7445313930511475
Epoch: 13, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.682 Vali Acc: 0.917 Test Loss: 0.682 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.714606523513794
Epoch: 14, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.294 Vali Acc: 0.927 Test Loss: 1.294 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.959763765335083
Epoch: 15, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.437 Vali Acc: 0.870 Test Loss: 1.437 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8964314460754395
Epoch: 16, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.327 Vali Acc: 0.967 Test Loss: 0.327 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966663).  Saving model ...
Epoch: 17 cost time: 2.4471237659454346
Epoch: 17, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.351 Vali Acc: 0.963 Test Loss: 0.351 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4972500801086426
Epoch: 18, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.535 Vali Acc: 0.937 Test Loss: 0.535 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4406991004943848
Epoch: 19, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.570 Vali Acc: 0.947 Test Loss: 0.570 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.434645175933838
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.953 Test Loss: 0.517 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.772472620010376
Epoch: 21, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.887 Vali Acc: 0.923 Test Loss: 0.887 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0079078674316406
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.937 Test Loss: 0.638 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6774704456329346
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.575 Vali Acc: 0.943 Test Loss: 0.575 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7312121391296387
Epoch: 24, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.720 Vali Acc: 0.933 Test Loss: 0.720 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6879897117614746
Epoch: 25, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.072 Vali Acc: 0.893 Test Loss: 1.072 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.6278791427612305
Epoch: 26, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.884 Vali Acc: 0.937 Test Loss: 0.884 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 44991001
model size : 186.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.675370216369629
Epoch: 1, Steps: 18 | Train Loss: 3.205 Vali Loss: 2.721 Vali Acc: 0.407 Test Loss: 2.721 Test Acc: 0.407
Validation loss decreased (inf --> -0.406639).  Saving model ...
Epoch: 2 cost time: 1.7642090320587158
Epoch: 2, Steps: 18 | Train Loss: 2.322 Vali Loss: 1.425 Vali Acc: 0.783 Test Loss: 1.425 Test Acc: 0.783
Validation loss decreased (-0.406639 --> -0.783319).  Saving model ...
Epoch: 3 cost time: 2.4025440216064453
Epoch: 3, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.248 Vali Acc: 0.940 Test Loss: 0.248 Test Acc: 0.940
Validation loss decreased (-0.783319 --> -0.939998).  Saving model ...
Epoch: 4 cost time: 1.908200740814209
Epoch: 4, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.939998 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 2.15978741645813
Epoch: 5, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.810703992843628
Epoch: 6, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0150270462036133
Epoch: 7, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3711767196655273
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1083738803863525
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.7696902751922607
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.9704153537750244
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8795671463012695
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4636178016662598
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7428972721099854
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7487373352050781
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6124329566955566
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.943 Test Loss: 0.306 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7530829906463623
Epoch: 17, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9011805057525635
Epoch: 18, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.563 Vali Acc: 0.913 Test Loss: 0.563 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6257400512695312
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.970 Test Loss: 0.225 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.989041805267334
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44285977
model size : 183.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2790849208831787
Epoch: 1, Steps: 18 | Train Loss: 3.257 Vali Loss: 2.896 Vali Acc: 0.340 Test Loss: 2.896 Test Acc: 0.340
Validation loss decreased (inf --> -0.339971).  Saving model ...
Epoch: 2 cost time: 0.7558097839355469
Epoch: 2, Steps: 18 | Train Loss: 2.628 Vali Loss: 2.014 Vali Acc: 0.850 Test Loss: 2.014 Test Acc: 0.850
Validation loss decreased (-0.339971 --> -0.849980).  Saving model ...
Epoch: 3 cost time: 1.9741418361663818
Epoch: 3, Steps: 18 | Train Loss: 1.467 Vali Loss: 0.548 Vali Acc: 0.937 Test Loss: 0.548 Test Acc: 0.937
Validation loss decreased (-0.849980 --> -0.936661).  Saving model ...
Epoch: 4 cost time: 1.5312163829803467
Epoch: 4, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5579752922058105
Epoch: 5, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
Validation loss decreased (-0.936661 --> -0.943332).  Saving model ...
Epoch: 6 cost time: 1.3379828929901123
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.963 Test Loss: 0.103 Test Acc: 0.963
Validation loss decreased (-0.943332 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.330639362335205
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2844092845916748
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.17913818359375
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6489853858947754
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.904088020324707
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1203527450561523
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.5440905094146729
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9578402042388916
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.038980722427368
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.5529601573944092
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1927571296691895
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.6448500156402588
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.847701072692871
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5879955291748047
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7797913551330566
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5269477367401123
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.768002986907959
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1486425399780273
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.679513692855835
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8027873039245605
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6568281650543213
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 43933465
model size : 182.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5573084354400635
Epoch: 1, Steps: 18 | Train Loss: 3.189 Vali Loss: 2.555 Vali Acc: 0.447 Test Loss: 2.555 Test Acc: 0.447
Validation loss decreased (inf --> -0.446641).  Saving model ...
Epoch: 2 cost time: 2.178295850753784
Epoch: 2, Steps: 18 | Train Loss: 1.959 Vali Loss: 1.051 Vali Acc: 0.847 Test Loss: 1.051 Test Acc: 0.847
Validation loss decreased (-0.446641 --> -0.846656).  Saving model ...
Epoch: 3 cost time: 2.1941895484924316
Epoch: 3, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.846656 --> -0.933331).  Saving model ...
Epoch: 4 cost time: 1.6598618030548096
Epoch: 4, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.478 Vali Acc: 0.873 Test Loss: 0.478 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4183166027069092
Epoch: 5, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.230 Vali Acc: 0.940 Test Loss: 0.230 Test Acc: 0.940
Validation loss decreased (-0.933331 --> -0.939998).  Saving model ...
Epoch: 6 cost time: 2.279232978820801
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.329047918319702
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 2.2877166271209717
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0658838748931885
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.252188205718994
Epoch: 10, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 2.1394999027252197
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3363959789276123
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8630175590515137
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6396610736846924
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3810677528381348
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.960 Test Loss: 0.225 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2021801471710205
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.165259599685669
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.675 Vali Acc: 0.903 Test Loss: 0.675 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1487793922424316
Epoch: 18, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.622 Vali Acc: 0.890 Test Loss: 0.622 Test Acc: 0.890
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1534125804901123
Epoch: 19, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.401 Vali Acc: 0.937 Test Loss: 0.401 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.13935923576355
Epoch: 20, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.453 Vali Acc: 0.933 Test Loss: 0.453 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44534809
model size : 184.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.369983673095703
Epoch: 1, Steps: 18 | Train Loss: 3.230 Vali Loss: 2.711 Vali Acc: 0.430 Test Loss: 2.711 Test Acc: 0.430
Validation loss decreased (inf --> -0.429973).  Saving model ...
Epoch: 2 cost time: 1.7398779392242432
Epoch: 2, Steps: 18 | Train Loss: 2.300 Vali Loss: 1.384 Vali Acc: 0.903 Test Loss: 1.384 Test Acc: 0.903
Validation loss decreased (-0.429973 --> -0.903319).  Saving model ...
Epoch: 3 cost time: 1.7067105770111084
Epoch: 3, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.276 Vali Acc: 0.947 Test Loss: 0.276 Test Acc: 0.947
Validation loss decreased (-0.903319 --> -0.946664).  Saving model ...
Epoch: 4 cost time: 0.9837489128112793
Epoch: 4, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
Validation loss decreased (-0.946664 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 2.0152313709259033
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.953332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.8293468952178955
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.639197826385498
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6986000537872314
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.977 Test Loss: 0.176 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.8478128910064697
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2732224464416504
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.920 Test Loss: 0.287 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7601230144500732
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.231 Vali Acc: 0.947 Test Loss: 0.231 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4081523418426514
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6273431777954102
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.845461130142212
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.177755355834961
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.960446834564209
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9715898036956787
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.088757038116455
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44161561
model size : 183.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.661752939224243
Epoch: 1, Steps: 18 | Train Loss: 3.258 Vali Loss: 2.916 Vali Acc: 0.357 Test Loss: 2.916 Test Acc: 0.357
Validation loss decreased (inf --> -0.356638).  Saving model ...
Epoch: 2 cost time: 1.272066354751587
Epoch: 2, Steps: 18 | Train Loss: 2.626 Vali Loss: 2.033 Vali Acc: 0.847 Test Loss: 2.033 Test Acc: 0.847
Validation loss decreased (-0.356638 --> -0.846646).  Saving model ...
Epoch: 3 cost time: 1.189739465713501
Epoch: 3, Steps: 18 | Train Loss: 1.488 Vali Loss: 0.649 Vali Acc: 0.913 Test Loss: 0.649 Test Acc: 0.913
Validation loss decreased (-0.846646 --> -0.913327).  Saving model ...
Epoch: 4 cost time: 2.013455867767334
Epoch: 4, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
Validation loss decreased (-0.913327 --> -0.929997).  Saving model ...
Epoch: 5 cost time: 1.8760302066802979
Epoch: 5, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.929997 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3286738395690918
Epoch: 6, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6519134044647217
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4464452266693115
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1252853870391846
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1089284420013428
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1566109657287598
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8023979663848877
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.377882480621338
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8314003944396973
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1589243412017822
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.690460205078125
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3964354991912842
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.389979362487793
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.664219617843628
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.260418176651001
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7245030403137207
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1835825443267822
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4220445156097412
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.91951584815979
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.568953275680542
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9508380889892578
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.701249599456787
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6726610660552979
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6329681873321533
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6925342082977295
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 43912729
model size : 182.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.676732301712036
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 2.635 Vali Acc: 0.433 Test Loss: 2.635 Test Acc: 0.433
Validation loss decreased (inf --> -0.433307).  Saving model ...
Epoch: 2 cost time: 1.2189204692840576
Epoch: 2, Steps: 18 | Train Loss: 2.128 Vali Loss: 1.117 Vali Acc: 0.847 Test Loss: 1.117 Test Acc: 0.847
Validation loss decreased (-0.433307 --> -0.846655).  Saving model ...
Epoch: 3 cost time: 2.236135482788086
Epoch: 3, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.254 Vali Acc: 0.913 Test Loss: 0.254 Test Acc: 0.913
Validation loss decreased (-0.846655 --> -0.913331).  Saving model ...
Epoch: 4 cost time: 1.6450958251953125
Epoch: 4, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.436 Vali Acc: 0.903 Test Loss: 0.436 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4929845333099365
Epoch: 5, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
Validation loss decreased (-0.913331 --> -0.939998).  Saving model ...
Epoch: 6 cost time: 1.5434575080871582
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.939998 --> -0.943331).  Saving model ...
Epoch: 7 cost time: 1.494626522064209
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.244 Vali Acc: 0.923 Test Loss: 0.244 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1757755279541016
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4767038822174072
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1147658824920654
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 2.1810500621795654
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 12 cost time: 1.5902798175811768
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 13 cost time: 1.8466458320617676
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 14 cost time: 1.541398286819458
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9908547401428223
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 16 cost time: 2.027900457382202
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 17 cost time: 2.1440351009368896
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7191123962402344
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 19 cost time: 1.9986016750335693
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 20 cost time: 2.0457234382629395
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7739202976226807
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.706282615661621
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.884922742843628
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 24 cost time: 2.346156358718872
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8586058616638184
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1796224117279053
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 27 cost time: 2.1467387676239014
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 2.384007692337036
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7157206535339355
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1447272300720215
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7233991622924805
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.182056427001953
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.408541202545166
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.002774238586426
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.621156930923462
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8711585998535156
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.001211404800415
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 44534809
model size : 184.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8475053310394287
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 2.803 Vali Acc: 0.390 Test Loss: 2.803 Test Acc: 0.390
Validation loss decreased (inf --> -0.389972).  Saving model ...
Epoch: 2 cost time: 1.7907476425170898
Epoch: 2, Steps: 18 | Train Loss: 2.422 Vali Loss: 1.609 Vali Acc: 0.847 Test Loss: 1.609 Test Acc: 0.847
Validation loss decreased (-0.389972 --> -0.846651).  Saving model ...
Epoch: 3 cost time: 2.006467819213867
Epoch: 3, Steps: 18 | Train Loss: 0.962 Vali Loss: 0.292 Vali Acc: 0.923 Test Loss: 0.292 Test Acc: 0.923
Validation loss decreased (-0.846651 --> -0.923330).  Saving model ...
Epoch: 4 cost time: 1.4709515571594238
Epoch: 4, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.204 Vali Acc: 0.927 Test Loss: 0.204 Test Acc: 0.927
Validation loss decreased (-0.923330 --> -0.926665).  Saving model ...
Epoch: 5 cost time: 1.4033985137939453
Epoch: 5, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.947 Test Loss: 0.188 Test Acc: 0.947
Validation loss decreased (-0.926665 --> -0.946665).  Saving model ...
Epoch: 6 cost time: 1.3312640190124512
Epoch: 6, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.946665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4338891506195068
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.7695846557617188
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4976434707641602
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.745419979095459
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.138838768005371
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9710781574249268
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1418907642364502
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.665174961090088
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1113741397857666
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8539564609527588
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0387353897094727
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5012938976287842
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6815292835235596
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.7610795497894287
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6027565002441406
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2751898765563965
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.3639729022979736
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4504568576812744
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2490286827087402
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5202407836914062
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.8841910362243652
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8627161979675293
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1931493282318115
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0097899436950684
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0538134574890137
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0833368301391602
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.165299892425537
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1693103313446045
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.4991984367370605
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6954779624938965
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8798463344573975
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.409238338470459
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6544818878173828
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.6089487075805664
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.6341605186462402
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.1292402744293213
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.493180274963379
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.8942885398864746
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.6893398761749268
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9723925590515137
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.5722057819366455
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.6583483219146729
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.674520492553711
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6426098346710205
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44161561
model size : 183.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6542086601257324
Epoch: 1, Steps: 18 | Train Loss: 3.276 Vali Loss: 2.972 Vali Acc: 0.270 Test Loss: 2.972 Test Acc: 0.270
Validation loss decreased (inf --> -0.269970).  Saving model ...
Epoch: 2 cost time: 1.1669836044311523
Epoch: 2, Steps: 18 | Train Loss: 2.735 Vali Loss: 2.218 Vali Acc: 0.763 Test Loss: 2.218 Test Acc: 0.763
Validation loss decreased (-0.269970 --> -0.763311).  Saving model ...
Epoch: 3 cost time: 1.119359016418457
Epoch: 3, Steps: 18 | Train Loss: 1.714 Vali Loss: 0.742 Vali Acc: 0.917 Test Loss: 0.742 Test Acc: 0.917
Validation loss decreased (-0.763311 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 1.109165906906128
Epoch: 4, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
Validation loss decreased (-0.916659 --> -0.919997).  Saving model ...
Epoch: 5 cost time: 0.9002678394317627
Epoch: 5, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
Validation loss decreased (-0.919997 --> -0.953332).  Saving model ...
Epoch: 6 cost time: 1.1759717464447021
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.2223427295684814
Epoch: 7, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9241104125976562
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 0.9294421672821045
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9940919876098633
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1112327575683594
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.0538723468780518
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.9933149814605713
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.0206470489501953
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.8238801956176758
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.0272130966186523
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2443621158599854
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2691245079040527
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1165251731872559
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.713137149810791
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.2294995784759521
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.1031591892242432
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.7552909851074219
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.09547758102417
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3880927562713623
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0340218544006348
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.301114559173584
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.949336051940918
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8214395046234131
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9804952144622803
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0205414295196533
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1334588527679443
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1282732486724854
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 43891993
model size : 182.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.532304048538208
Epoch: 1, Steps: 18 | Train Loss: 3.278 Vali Loss: 2.600 Vali Acc: 0.543 Test Loss: 2.600 Test Acc: 0.543
Validation loss decreased (inf --> -0.543307).  Saving model ...
Epoch: 2 cost time: 1.896261215209961
Epoch: 2, Steps: 18 | Train Loss: 2.018 Vali Loss: 1.022 Vali Acc: 0.843 Test Loss: 1.022 Test Acc: 0.843
Validation loss decreased (-0.543307 --> -0.843323).  Saving model ...
Epoch: 3 cost time: 1.826524019241333
Epoch: 3, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
Validation loss decreased (-0.843323 --> -0.936664).  Saving model ...
Epoch: 4 cost time: 2.2370145320892334
Epoch: 4, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.290 Vali Acc: 0.910 Test Loss: 0.290 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.584343910217285
Epoch: 5, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.936664 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.947319507598877
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.398 Vali Acc: 0.927 Test Loss: 0.398 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0397744178771973
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.358 Vali Acc: 0.913 Test Loss: 0.358 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0464744567871094
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.52449369430542
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.967 Test Loss: 0.241 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7209219932556152
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.509 Vali Acc: 0.927 Test Loss: 0.509 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5049030780792236
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3900094032287598
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.440 Vali Acc: 0.920 Test Loss: 0.440 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1073052883148193
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.351 Vali Acc: 0.960 Test Loss: 0.351 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.151012659072876
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4531748294830322
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44555545
model size : 184.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6258201599121094
Epoch: 1, Steps: 18 | Train Loss: 3.246 Vali Loss: 2.816 Vali Acc: 0.447 Test Loss: 2.816 Test Acc: 0.447
Validation loss decreased (inf --> -0.446639).  Saving model ...
Epoch: 2 cost time: 1.8023433685302734
Epoch: 2, Steps: 18 | Train Loss: 2.458 Vali Loss: 1.670 Vali Acc: 0.830 Test Loss: 1.670 Test Acc: 0.830
Validation loss decreased (-0.446639 --> -0.829983).  Saving model ...
Epoch: 3 cost time: 1.3804879188537598
Epoch: 3, Steps: 18 | Train Loss: 1.060 Vali Loss: 0.420 Vali Acc: 0.887 Test Loss: 0.420 Test Acc: 0.887
Validation loss decreased (-0.829983 --> -0.886662).  Saving model ...
Epoch: 4 cost time: 2.3288400173187256
Epoch: 4, Steps: 18 | Train Loss: 0.250 Vali Loss: 0.281 Vali Acc: 0.923 Test Loss: 0.281 Test Acc: 0.923
Validation loss decreased (-0.886662 --> -0.923331).  Saving model ...
Epoch: 5 cost time: 2.1243607997894287
Epoch: 5, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.268 Vali Acc: 0.913 Test Loss: 0.268 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.386521816253662
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.923331 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 2.368130922317505
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.233 Vali Acc: 0.940 Test Loss: 0.233 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0208733081817627
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1375675201416016
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 2.1889400482177734
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.9043500423431396
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.9182713031768799
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9969732761383057
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7582197189331055
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.248692512512207
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7715129852294922
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.800147294998169
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9594368934631348
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7152018547058105
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.184149980545044
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.428926944732666
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.0238275527954102
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8132641315460205
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8068346977233887
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1242947578430176
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.927673578262329
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6379587650299072
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9360074996948242
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2398955821990967
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.415970802307129
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0043559074401855
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8462190628051758
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5103800296783447
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1479012966156006
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.785834550857544
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7394475936889648
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7494471073150635
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8424985408782959
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.757490873336792
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44099353
model size : 182.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8364555835723877
Epoch: 1, Steps: 18 | Train Loss: 3.279 Vali Loss: 2.999 Vali Acc: 0.323 Test Loss: 2.999 Test Acc: 0.323
Validation loss decreased (inf --> -0.323303).  Saving model ...
Epoch: 2 cost time: 0.9238498210906982
Epoch: 2, Steps: 18 | Train Loss: 2.788 Vali Loss: 2.286 Vali Acc: 0.800 Test Loss: 2.286 Test Acc: 0.800
Validation loss decreased (-0.323303 --> -0.799977).  Saving model ...
Epoch: 3 cost time: 1.2853879928588867
Epoch: 3, Steps: 18 | Train Loss: 1.759 Vali Loss: 0.801 Vali Acc: 0.910 Test Loss: 0.801 Test Acc: 0.910
Validation loss decreased (-0.799977 --> -0.909992).  Saving model ...
Epoch: 4 cost time: 1.0449495315551758
Epoch: 4, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
Validation loss decreased (-0.909992 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 0.8871042728424072
Epoch: 5, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.224 Vali Acc: 0.940 Test Loss: 0.224 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1648857593536377
Epoch: 6, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.3003292083740234
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.1295223236083984
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0938525199890137
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3316731452941895
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.230337142944336
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1328153610229492
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1716194152832031
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9349591732025146
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9558825492858887
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1837148666381836
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1609840393066406
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8264038562774658
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9385757446289062
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9044623374938965
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8947868347167969
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8625595569610596
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.9900593757629395
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1731681823730469
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1778781414031982
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.326798439025879
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.3513457775115967
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1269686222076416
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1979224681854248
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2017149925231934
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.9068450927734375
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.2821471691131592
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.252218246459961
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.1886355876922607
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.2523822784423828
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.3161559104919434
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.319185733795166
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2861733436584473
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.129173994064331
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1493008136749268
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.23602294921875
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2785906791687012
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2986032962799072
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0081136226654053
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2715458869934082
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 43891993
model size : 182.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9353110790252686
Epoch: 1, Steps: 18 | Train Loss: 3.196 Vali Loss: 2.645 Vali Acc: 0.373 Test Loss: 2.645 Test Acc: 0.373
Validation loss decreased (inf --> -0.373307).  Saving model ...
Epoch: 2 cost time: 1.38832688331604
Epoch: 2, Steps: 18 | Train Loss: 2.029 Vali Loss: 1.059 Vali Acc: 0.837 Test Loss: 1.059 Test Acc: 0.837
Validation loss decreased (-0.373307 --> -0.836656).  Saving model ...
Epoch: 3 cost time: 1.6090240478515625
Epoch: 3, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.360 Vali Acc: 0.907 Test Loss: 0.360 Test Acc: 0.907
Validation loss decreased (-0.836656 --> -0.906663).  Saving model ...
Epoch: 4 cost time: 1.8468434810638428
Epoch: 4, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.906663 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 1.2576818466186523
Epoch: 5, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2145373821258545
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.391841173171997
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.424 Vali Acc: 0.927 Test Loss: 0.424 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3839154243469238
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.3733470439910889
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.296938180923462
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 2.3817553520202637
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 2.4272782802581787
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 2.2243728637695312
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7661826610565186
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3456528186798096
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9306201934814453
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9517261981964111
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.395247220993042
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8116796016693115
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2360193729400635
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.230842113494873
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2059764862060547
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44576281
model size : 184.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3845560550689697
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 2.844 Vali Acc: 0.320 Test Loss: 2.844 Test Acc: 0.320
Validation loss decreased (inf --> -0.319972).  Saving model ...
Epoch: 2 cost time: 1.2411317825317383
Epoch: 2, Steps: 18 | Train Loss: 2.486 Vali Loss: 1.685 Vali Acc: 0.850 Test Loss: 1.685 Test Acc: 0.850
Validation loss decreased (-0.319972 --> -0.849983).  Saving model ...
Epoch: 3 cost time: 1.1598224639892578
Epoch: 3, Steps: 18 | Train Loss: 1.101 Vali Loss: 0.459 Vali Acc: 0.907 Test Loss: 0.459 Test Acc: 0.907
Validation loss decreased (-0.849983 --> -0.906662).  Saving model ...
Epoch: 4 cost time: 1.4899466037750244
Epoch: 4, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.906662 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 0.9366943836212158
Epoch: 5, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949998).  Saving model ...
Epoch: 6 cost time: 1.0515313148498535
Epoch: 6, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959999).  Saving model ...
Epoch: 7 cost time: 1.2123980522155762
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.959999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.9174060821533203
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0226380825042725
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5688426494598389
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3850996494293213
Epoch: 11, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6926357746124268
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.929356575012207
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9098498821258545
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.4301679134368896
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4317033290863037
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3177313804626465
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.419710397720337
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.7806329727172852
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4221668243408203
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.72218918800354
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5851199626922607
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4165723323822021
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.5064148902893066
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.359713077545166
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.192488431930542
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9346840381622314
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.481842041015625
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.4501190185546875
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 0.9434807300567627
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.2035119533538818
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.6540462970733643
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.258516788482666
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.5495645999908447
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1061880588531494
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.49867844581604
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.421600341796875
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.5055780410766602
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.1843781471252441
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 1.6025457382202148
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.5364658832550049
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4206314086914062
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3472375869750977
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0522396564483643
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9977662563323975
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7256629467010498
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 47 cost time: 1.1609675884246826
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 48 cost time: 1.0243949890136719
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0574595928192139
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3826920986175537
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 44120089
model size : 182.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2912819385528564
Epoch: 1, Steps: 18 | Train Loss: 3.262 Vali Loss: 2.955 Vali Acc: 0.280 Test Loss: 2.955 Test Acc: 0.280
Validation loss decreased (inf --> -0.279970).  Saving model ...
Epoch: 2 cost time: 0.838714599609375
Epoch: 2, Steps: 18 | Train Loss: 2.744 Vali Loss: 2.289 Vali Acc: 0.763 Test Loss: 2.289 Test Acc: 0.763
Validation loss decreased (-0.279970 --> -0.763310).  Saving model ...
Epoch: 3 cost time: 1.1183960437774658
Epoch: 3, Steps: 18 | Train Loss: 1.797 Vali Loss: 0.921 Vali Acc: 0.883 Test Loss: 0.921 Test Acc: 0.883
Validation loss decreased (-0.763310 --> -0.883324).  Saving model ...
Epoch: 4 cost time: 1.0061571598052979
Epoch: 4, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.399 Vali Acc: 0.907 Test Loss: 0.399 Test Acc: 0.907
Validation loss decreased (-0.883324 --> -0.906663).  Saving model ...
Epoch: 5 cost time: 0.9475104808807373
Epoch: 5, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.906663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.8286745548248291
Epoch: 6, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8375134468078613
Epoch: 7, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.2210395336151123
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.969999 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.1579384803771973
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2016568183898926
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1582231521606445
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2829391956329346
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3246359825134277
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1018412113189697
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4069929122924805
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8598875999450684
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.2664847373962402
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.3110909461975098
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.2212750911712646
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 0.9816553592681885
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.0962738990783691
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1276168823242188
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.491023063659668
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0807311534881592
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.0383808612823486
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 0.8055005073547363
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 0.797783613204956
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.082726240158081
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1192824840545654
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3807907104492188
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.2721140384674072
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.2445957660675049
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1780920028686523
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1372497081756592
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3576860427856445
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.2015376091003418
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.2522475719451904
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0546879768371582
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.948472261428833
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6599016189575195
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.920860767364502
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.143131971359253
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 0.8084151744842529
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2044832706451416
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1350336074829102
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.467181921005249
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.397869348526001
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.280571699142456
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.17057466506958
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0153050422668457
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 43891993
model size : 182.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.402313709259033
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 2.703 Vali Acc: 0.383 Test Loss: 2.703 Test Acc: 0.383
Validation loss decreased (inf --> -0.383306).  Saving model ...
Epoch: 2 cost time: 1.895984172821045
Epoch: 2, Steps: 18 | Train Loss: 2.191 Vali Loss: 1.256 Vali Acc: 0.850 Test Loss: 1.256 Test Acc: 0.850
Validation loss decreased (-0.383306 --> -0.849987).  Saving model ...
Epoch: 3 cost time: 1.8014264106750488
Epoch: 3, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
Validation loss decreased (-0.849987 --> -0.913330).  Saving model ...
Epoch: 4 cost time: 1.584219217300415
Epoch: 4, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.913330 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 1.7116525173187256
Epoch: 5, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.919701099395752
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7276663780212402
Epoch: 7, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953332).  Saving model ...
Epoch: 8 cost time: 1.8370351791381836
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5983920097351074
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.953332 --> -0.959999).  Saving model ...
Epoch: 10 cost time: 1.4516029357910156
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9510858058929443
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.959999 --> -0.963332).  Saving model ...
Epoch: 12 cost time: 1.9307949542999268
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.5304646492004395
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 2.353846549987793
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 2.0583064556121826
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.916402816772461
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.9284403324127197
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.9980850219726562
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.845076322555542
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 2.06266188621521
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 2.011014699935913
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.5416369438171387
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 1.3470237255096436
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 2.161043882369995
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.8613924980163574
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.124223232269287
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 1.9763143062591553
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 2.078648328781128
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.1126434803009033
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 2.0485997200012207
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.6957027912139893
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.998436450958252
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 2.012267589569092
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8164756298065186
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7583119869232178
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.9871799945831299
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.0429165363311768
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.596426010131836
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 2.158719062805176
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.1585772037506104
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.0799131393432617
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9917066097259521
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7788500785827637
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.0004875659942627
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7224791049957275
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.533478021621704
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.3947839736938477
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.4368829727172852
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 44368921
model size : 183.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.084994077682495
Epoch: 1, Steps: 18 | Train Loss: 3.257 Vali Loss: 2.827 Vali Acc: 0.433 Test Loss: 2.827 Test Acc: 0.433
Validation loss decreased (inf --> -0.433305).  Saving model ...
Epoch: 2 cost time: 1.7597002983093262
Epoch: 2, Steps: 18 | Train Loss: 2.486 Vali Loss: 1.759 Vali Acc: 0.880 Test Loss: 1.759 Test Acc: 0.880
Validation loss decreased (-0.433305 --> -0.879982).  Saving model ...
Epoch: 3 cost time: 2.053732395172119
Epoch: 3, Steps: 18 | Train Loss: 1.197 Vali Loss: 0.452 Vali Acc: 0.887 Test Loss: 0.452 Test Acc: 0.887
Validation loss decreased (-0.879982 --> -0.886662).  Saving model ...
Epoch: 4 cost time: 1.9974677562713623
Epoch: 4, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.886662 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.4574036598205566
Epoch: 5, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4936373233795166
Epoch: 6, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 2.131063938140869
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8516206741333008
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.7712445259094238
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.651256799697876
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.93925142288208
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6006314754486084
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.067997694015503
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.074838399887085
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0057199001312256
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5208520889282227
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8894407749176025
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4663705825805664
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8009166717529297
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.610008716583252
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.888735294342041
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0641682147979736
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3866770267486572
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2425241470336914
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2448699474334717
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2075603008270264
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8410453796386719
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0252795219421387
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8512709140777588
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0059194564819336
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7757506370544434
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.011279582977295
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 44078617
model size : 182.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4250993728637695
Epoch: 1, Steps: 18 | Train Loss: 3.306 Vali Loss: 3.049 Vali Acc: 0.213 Test Loss: 3.049 Test Acc: 0.213
Validation loss decreased (inf --> -0.213303).  Saving model ...
Epoch: 2 cost time: 1.382134199142456
Epoch: 2, Steps: 18 | Train Loss: 2.897 Vali Loss: 2.445 Vali Acc: 0.793 Test Loss: 2.445 Test Acc: 0.793
Validation loss decreased (-0.213303 --> -0.793309).  Saving model ...
Epoch: 3 cost time: 1.2671451568603516
Epoch: 3, Steps: 18 | Train Loss: 2.060 Vali Loss: 1.116 Vali Acc: 0.940 Test Loss: 1.116 Test Acc: 0.940
Validation loss decreased (-0.793309 --> -0.939989).  Saving model ...
Epoch: 4 cost time: 1.262389898300171
Epoch: 4, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.939989 --> -0.949997).  Saving model ...
Epoch: 5 cost time: 1.1910934448242188
Epoch: 5, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.294936180114746
Epoch: 6, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
Validation loss decreased (-0.949997 --> -0.956665).  Saving model ...
Epoch: 7 cost time: 1.2955260276794434
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.193248987197876
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3064947128295898
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.230611801147461
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2165610790252686
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2521886825561523
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3575439453125
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2724215984344482
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.099182367324829
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.334162950515747
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.2660887241363525
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.336946964263916
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0436046123504639
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1337785720825195
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1353650093078613
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.269489049911499
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.887901782989502
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2766458988189697
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2704691886901855
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2697160243988037
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.234123945236206
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0835545063018799
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2865068912506104
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3345057964324951
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2644453048706055
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2819468975067139
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 43891993
model size : 182.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8976614475250244
Epoch: 1, Steps: 18 | Train Loss: 3.189 Vali Loss: 2.662 Vali Acc: 0.387 Test Loss: 2.662 Test Acc: 0.387
Validation loss decreased (inf --> -0.386640).  Saving model ...
Epoch: 2 cost time: 1.4355533123016357
Epoch: 2, Steps: 18 | Train Loss: 2.171 Vali Loss: 1.220 Vali Acc: 0.840 Test Loss: 1.220 Test Acc: 0.840
Validation loss decreased (-0.386640 --> -0.839988).  Saving model ...
Epoch: 3 cost time: 1.3394196033477783
Epoch: 3, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (-0.839988 --> -0.916663).  Saving model ...
Epoch: 4 cost time: 1.964998483657837
Epoch: 4, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
Validation loss decreased (-0.916663 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 2.037165880203247
Epoch: 5, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6884946823120117
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.949998 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.4204175472259521
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7826402187347412
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.8228497505187988
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5018117427825928
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.960 Test Loss: 0.208 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5080971717834473
Epoch: 11, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.257 Vali Acc: 0.953 Test Loss: 0.257 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9663383960723877
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7880330085754395
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0064332485198975
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.766472578048706
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 1.5076141357421875
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.798905849456787
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 1.8363404273986816
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 1.4958460330963135
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 1.2602159976959229
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 1.7093281745910645
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.772841453552246
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 1.514815330505371
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 0.8695683479309082
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.6157288551330566
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 1.9839634895324707
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 1.9494564533233643
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0378379821777344
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7385222911834717
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5653505325317383
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 2.1512718200683594
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 1.0263288021087646
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 33 cost time: 2.090679883956909
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 34 cost time: 0.9907751083374023
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 35 cost time: 1.3210039138793945
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 36 cost time: 1.5916600227355957
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 37 cost time: 1.986480712890625
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 38 cost time: 1.6419703960418701
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 39 cost time: 1.966139554977417
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 40 cost time: 1.7928991317749023
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.420072078704834
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.608792781829834
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 43 cost time: 1.9012956619262695
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4000098705291748
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4496610164642334
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 46 cost time: 2.200301170349121
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 47 cost time: 2.134788751602173
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 48 cost time: 2.2018818855285645
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 49 cost time: 1.4222674369812012
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 50 cost time: 1.7026240825653076
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44389657
model size : 184.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.028333902359009
Epoch: 1, Steps: 18 | Train Loss: 3.260 Vali Loss: 2.917 Vali Acc: 0.380 Test Loss: 2.917 Test Acc: 0.380
Validation loss decreased (inf --> -0.379971).  Saving model ...
Epoch: 2 cost time: 1.3944387435913086
Epoch: 2, Steps: 18 | Train Loss: 2.622 Vali Loss: 1.985 Vali Acc: 0.823 Test Loss: 1.985 Test Acc: 0.823
Validation loss decreased (-0.379971 --> -0.823313).  Saving model ...
Epoch: 3 cost time: 1.3738954067230225
Epoch: 3, Steps: 18 | Train Loss: 1.420 Vali Loss: 0.549 Vali Acc: 0.907 Test Loss: 0.549 Test Acc: 0.907
Validation loss decreased (-0.823313 --> -0.906661).  Saving model ...
Epoch: 4 cost time: 1.200824499130249
Epoch: 4, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.255 Vali Acc: 0.913 Test Loss: 0.255 Test Acc: 0.913
Validation loss decreased (-0.906661 --> -0.913331).  Saving model ...
Epoch: 5 cost time: 1.8240594863891602
Epoch: 5, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.192 Vali Acc: 0.947 Test Loss: 0.192 Test Acc: 0.947
Validation loss decreased (-0.913331 --> -0.946665).  Saving model ...
Epoch: 6 cost time: 1.474487066268921
Epoch: 6, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.946665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6271531581878662
Epoch: 7, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2084567546844482
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6188843250274658
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.348435401916504
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2929368019104004
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5497360229492188
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4667017459869385
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2379193305969238
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5092642307281494
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1842339038848877
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44057881
model size : 182.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7066409587860107
Epoch: 1, Steps: 18 | Train Loss: 3.264 Vali Loss: 2.967 Vali Acc: 0.263 Test Loss: 2.967 Test Acc: 0.263
Validation loss decreased (inf --> -0.263304).  Saving model ...
Epoch: 2 cost time: 0.9507598876953125
Epoch: 2, Steps: 18 | Train Loss: 2.781 Vali Loss: 2.343 Vali Acc: 0.713 Test Loss: 2.343 Test Acc: 0.713
Validation loss decreased (-0.263304 --> -0.713310).  Saving model ...
Epoch: 3 cost time: 0.8778815269470215
Epoch: 3, Steps: 18 | Train Loss: 1.958 Vali Loss: 1.074 Vali Acc: 0.887 Test Loss: 1.074 Test Acc: 0.887
Validation loss decreased (-0.713310 --> -0.886656).  Saving model ...
Epoch: 4 cost time: 0.9349291324615479
Epoch: 4, Steps: 18 | Train Loss: 0.775 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
Validation loss decreased (-0.886656 --> -0.929997).  Saving model ...
Epoch: 5 cost time: 0.8067452907562256
Epoch: 5, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.205 Vali Acc: 0.940 Test Loss: 0.205 Test Acc: 0.940
Validation loss decreased (-0.929997 --> -0.939998).  Saving model ...
Epoch: 6 cost time: 0.853863000869751
Epoch: 6, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.162 Vali Acc: 0.947 Test Loss: 0.162 Test Acc: 0.947
Validation loss decreased (-0.939998 --> -0.946665).  Saving model ...
Epoch: 7 cost time: 0.9264359474182129
Epoch: 7, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
Validation loss decreased (-0.946665 --> -0.959999).  Saving model ...
Epoch: 8 cost time: 0.9585220813751221
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.959999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9614155292510986
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9404687881469727
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0518338680267334
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9624526500701904
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9961228370666504
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8710062503814697
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0362634658813477
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9020435810089111
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9383835792541504
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8964052200317383
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7905488014221191
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.9961607456207275
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0249791145324707
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.9009385108947754
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0079152584075928
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9474442005157471
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.05269455909729
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.000206708908081
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9339094161987305
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9855420589447021
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8859231472015381
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1155736446380615
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.002427577972412
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.0164992809295654
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.1730492115020752
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.9649922847747803
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.9368891716003418
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.9839191436767578
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8822097778320312
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8248276710510254
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8317790031433105
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.8074667453765869
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7825860977172852
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7135465145111084
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7622213363647461
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.75738525390625
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7179927825927734
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8128864765167236
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8172280788421631
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.8996226787567139
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.9379715919494629
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.9330508708953857
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 43891993
model size : 182.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0664517879486084
Epoch: 1, Steps: 18 | Train Loss: 3.254 Vali Loss: 2.700 Vali Acc: 0.423 Test Loss: 2.700 Test Acc: 0.423
Validation loss decreased (inf --> -0.423306).  Saving model ...
Epoch: 2 cost time: 1.712141752243042
Epoch: 2, Steps: 18 | Train Loss: 2.154 Vali Loss: 1.114 Vali Acc: 0.900 Test Loss: 1.114 Test Acc: 0.900
Validation loss decreased (-0.423306 --> -0.899989).  Saving model ...
Epoch: 3 cost time: 1.2776761054992676
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.245 Vali Acc: 0.927 Test Loss: 0.245 Test Acc: 0.927
Validation loss decreased (-0.899989 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 1.5611155033111572
Epoch: 4, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.926664 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 1.3239309787750244
Epoch: 5, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.261 Vali Acc: 0.923 Test Loss: 0.261 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6337602138519287
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959999).  Saving model ...
Epoch: 7 cost time: 1.0260400772094727
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8534846305847168
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.959999 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.645308494567871
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.5290286540985107
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7161049842834473
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7645204067230225
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.7266261577606201
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.6315951347351074
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.708038330078125
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.790447473526001
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.6335539817810059
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9567759037017822
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9195647239685059
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.667717695236206
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2729229927062988
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.354928731918335
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5082933902740479
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.29042911529541
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7149839401245117
Epoch: 25, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7225043773651123
Epoch: 26, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.339 Vali Acc: 0.800 Test Loss: 1.339 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44410393
model size : 184.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.166503429412842
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 2.853 Vali Acc: 0.437 Test Loss: 2.853 Test Acc: 0.437
Validation loss decreased (inf --> -0.436638).  Saving model ...
Epoch: 2 cost time: 1.1810081005096436
Epoch: 2, Steps: 18 | Train Loss: 2.578 Vali Loss: 1.835 Vali Acc: 0.837 Test Loss: 1.835 Test Acc: 0.837
Validation loss decreased (-0.436638 --> -0.836648).  Saving model ...
Epoch: 3 cost time: 1.3349881172180176
Epoch: 3, Steps: 18 | Train Loss: 1.284 Vali Loss: 0.492 Vali Acc: 0.903 Test Loss: 0.492 Test Acc: 0.903
Validation loss decreased (-0.836648 --> -0.903328).  Saving model ...
Epoch: 4 cost time: 1.5466420650482178
Epoch: 4, Steps: 18 | Train Loss: 0.320 Vali Loss: 0.210 Vali Acc: 0.957 Test Loss: 0.210 Test Acc: 0.957
Validation loss decreased (-0.903328 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 1.516388177871704
Epoch: 5, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.680393934249878
Epoch: 6, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8459365367889404
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.7406527996063232
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9091970920562744
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4479410648345947
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.087028980255127
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.6126773357391357
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6344795227050781
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5191633701324463
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2214834690093994
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.394225835800171
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.6377885341644287
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9803688526153564
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3630917072296143
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4236640930175781
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8107526302337646
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4159142971038818
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6893680095672607
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3750741481781006
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.2310011386871338
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.234886646270752
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7311301231384277
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.400627851486206
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3661255836486816
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.9559741020202637
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6372590065002441
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7738590240478516
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.2791199684143066
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8437557220458984
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8719937801361084
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.5607261657714844
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 2.069190740585327
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8966186046600342
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.0150597095489502
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.8752861022949219
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.2958886623382568
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8870046138763428
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.2488970756530762
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3475990295410156
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2779614925384521
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2009522914886475
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1746368408203125
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7785449028015137
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9098029136657715
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2685153484344482
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 44078617
model size : 182.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6878507137298584
Epoch: 1, Steps: 18 | Train Loss: 3.281 Vali Loss: 3.030 Vali Acc: 0.177 Test Loss: 3.030 Test Acc: 0.177
Validation loss decreased (inf --> -0.176636).  Saving model ...
Epoch: 2 cost time: 0.8830916881561279
Epoch: 2, Steps: 18 | Train Loss: 2.866 Vali Loss: 2.439 Vali Acc: 0.723 Test Loss: 2.439 Test Acc: 0.723
Validation loss decreased (-0.176636 --> -0.723309).  Saving model ...
Epoch: 3 cost time: 1.1351702213287354
Epoch: 3, Steps: 18 | Train Loss: 2.049 Vali Loss: 1.165 Vali Acc: 0.913 Test Loss: 1.165 Test Acc: 0.913
Validation loss decreased (-0.723309 --> -0.913322).  Saving model ...
Epoch: 4 cost time: 0.8178339004516602
Epoch: 4, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.290 Vali Acc: 0.957 Test Loss: 0.290 Test Acc: 0.957
Validation loss decreased (-0.913322 --> -0.956664).  Saving model ...
Epoch: 5 cost time: 1.0990235805511475
Epoch: 5, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9655556678771973
Epoch: 6, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 0.970858097076416
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9121124744415283
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9355189800262451
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0484344959259033
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0345396995544434
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.043381929397583
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9745140075683594
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.967 Test Loss: 0.091 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1170539855957031
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9289951324462891
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.199568271636963
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1166529655456543
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0779228210449219
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0836336612701416
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.231987714767456
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2407259941101074
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.194387674331665
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0552794933319092
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1725988388061523
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3685040473937988
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.108229160308838
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9904110431671143
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2303307056427002
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.0500831604003906
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9502248764038086
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9359514713287354
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0088281631469727
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0738110542297363
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.0943541526794434
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.0319781303405762
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9424724578857422
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1089239120483398
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8901267051696777
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9126870632171631
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9137783050537109
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0292084217071533
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8367149829864502
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.0517830848693848
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9606623649597168
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7729189395904541
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.9875411987304688
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.8264846801757812
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.9525241851806641
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.874669075012207
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.0495274066925049
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 43912729
model size : 182.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.080103635787964
Epoch: 1, Steps: 18 | Train Loss: 3.258 Vali Loss: 2.792 Vali Acc: 0.457 Test Loss: 2.792 Test Acc: 0.457
Validation loss decreased (inf --> -0.456639).  Saving model ...
Epoch: 2 cost time: 0.9434428215026855
Epoch: 2, Steps: 18 | Train Loss: 2.375 Vali Loss: 1.514 Vali Acc: 0.830 Test Loss: 1.514 Test Acc: 0.830
Validation loss decreased (-0.456639 --> -0.829985).  Saving model ...
Epoch: 3 cost time: 1.461071491241455
Epoch: 3, Steps: 18 | Train Loss: 0.930 Vali Loss: 0.296 Vali Acc: 0.923 Test Loss: 0.296 Test Acc: 0.923
Validation loss decreased (-0.829985 --> -0.923330).  Saving model ...
Epoch: 4 cost time: 0.8580989837646484
Epoch: 4, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.214 Vali Acc: 0.927 Test Loss: 0.214 Test Acc: 0.927
Validation loss decreased (-0.923330 --> -0.926665).  Saving model ...
Epoch: 5 cost time: 1.6001060009002686
Epoch: 5, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.926665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.2716071605682373
Epoch: 6, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.253 Vali Acc: 0.953 Test Loss: 0.253 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5620219707489014
Epoch: 7, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5325706005096436
Epoch: 8, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.402501106262207
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.5070247650146484
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.4462487697601318
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.327258825302124
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.510563611984253
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.255051851272583
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.4367341995239258
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.1147863864898682
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0777125358581543
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0713675022125244
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3048830032348633
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.2610435485839844
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9696578979492188
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.4440832138061523
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.3888325691223145
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.8632278442382812
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.3172969818115234
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.2217719554901123
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.070847511291504
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1790177822113037
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4791934490203857
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2167017459869385
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2325096130371094
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.407909870147705
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.548860788345337
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7840495109558105
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3421258926391602
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 44306713
model size : 183.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.595846652984619
Epoch: 1, Steps: 18 | Train Loss: 3.245 Vali Loss: 2.919 Vali Acc: 0.343 Test Loss: 2.919 Test Acc: 0.343
Validation loss decreased (inf --> -0.343304).  Saving model ...
Epoch: 2 cost time: 1.1216368675231934
Epoch: 2, Steps: 18 | Train Loss: 2.635 Vali Loss: 2.034 Vali Acc: 0.807 Test Loss: 2.034 Test Acc: 0.807
Validation loss decreased (-0.343304 --> -0.806646).  Saving model ...
Epoch: 3 cost time: 1.0083603858947754
Epoch: 3, Steps: 18 | Train Loss: 1.430 Vali Loss: 0.493 Vali Acc: 0.940 Test Loss: 0.493 Test Acc: 0.940
Validation loss decreased (-0.806646 --> -0.939995).  Saving model ...
Epoch: 4 cost time: 1.117203950881958
Epoch: 4, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.221 Vali Acc: 0.947 Test Loss: 0.221 Test Acc: 0.947
Validation loss decreased (-0.939995 --> -0.946664).  Saving model ...
Epoch: 5 cost time: 1.0366766452789307
Epoch: 5, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.946664 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.9672203063964844
Epoch: 6, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.987149715423584
Epoch: 7, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.2633392810821533
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.1726651191711426
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.1946077346801758
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8066616058349609
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9964344501495361
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.777310848236084
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0399532318115234
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1040074825286865
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9876322746276855
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9148173332214355
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8405392169952393
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2042210102081299
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3896145820617676
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2352523803710938
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.466597080230713
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1910772323608398
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.354625940322876
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.3918135166168213
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9306137561798096
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3013031482696533
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0312511920928955
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.0703892707824707
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0635862350463867
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.3454456329345703
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 0.787879228591919
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7944540977478027
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0711076259613037
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.443065881729126
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3109209537506104
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.0243332386016846
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0217132568359375
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1095213890075684
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 1.4995975494384766
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.033909797668457
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0364205837249756
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1365115642547607
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4272565841674805
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9967341423034668
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2627251148223877
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3815250396728516
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.092714786529541
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.1533277034759521
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 44078617
model size : 182.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.098212957382202
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 3.025 Vali Acc: 0.233 Test Loss: 3.025 Test Acc: 0.233
Validation loss decreased (inf --> -0.233303).  Saving model ...
Epoch: 2 cost time: 1.0912823677062988
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 2.417 Vali Acc: 0.693 Test Loss: 2.417 Test Acc: 0.693
Validation loss decreased (-0.233303 --> -0.693309).  Saving model ...
Epoch: 3 cost time: 0.8269913196563721
Epoch: 3, Steps: 18 | Train Loss: 2.002 Vali Loss: 1.087 Vali Acc: 0.897 Test Loss: 1.087 Test Acc: 0.897
Validation loss decreased (-0.693309 --> -0.896656).  Saving model ...
Epoch: 4 cost time: 0.8660988807678223
Epoch: 4, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.263 Vali Acc: 0.963 Test Loss: 0.263 Test Acc: 0.963
Validation loss decreased (-0.896656 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 1.071674108505249
Epoch: 5, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.213 Vali Acc: 0.940 Test Loss: 0.213 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9938020706176758
Epoch: 6, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966666).  Saving model ...
Epoch: 7 cost time: 1.0633704662322998
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.966666 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0193302631378174
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.093759536743164
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.0570878982543945
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.1373910903930664
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8258676528930664
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1097712516784668
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1270325183868408
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.112833023071289
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.056405782699585
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1498091220855713
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1269850730895996
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2102406024932861
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1302366256713867
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0542118549346924
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0308048725128174
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0514616966247559
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0276875495910645
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.190356969833374
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0014209747314453
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.0161726474761963
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0990829467773438
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9878044128417969
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0260241031646729
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1712427139282227
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.002335548400879
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1438238620758057
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1122241020202637
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9093563556671143
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.050441026687622
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1925053596496582
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2651195526123047
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0400185585021973
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1675989627838135
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8896048069000244
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.988835334777832
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 43933465
model size : 182.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5417914390563965
Epoch: 1, Steps: 18 | Train Loss: 3.258 Vali Loss: 2.851 Vali Acc: 0.453 Test Loss: 2.851 Test Acc: 0.453
Validation loss decreased (inf --> -0.453305).  Saving model ...
Epoch: 2 cost time: 1.8331782817840576
Epoch: 2, Steps: 18 | Train Loss: 2.483 Vali Loss: 1.648 Vali Acc: 0.877 Test Loss: 1.648 Test Acc: 0.877
Validation loss decreased (-0.453305 --> -0.876650).  Saving model ...
Epoch: 3 cost time: 1.7849905490875244
Epoch: 3, Steps: 18 | Train Loss: 0.973 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.876650 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.3438687324523926
Epoch: 4, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.257 Vali Acc: 0.920 Test Loss: 0.257 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9581518173217773
Epoch: 5, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.929997 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.6686127185821533
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.605715274810791
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6700546741485596
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1238112449645996
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6438846588134766
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.5453908443450928
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 1.42364501953125
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5322444438934326
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.607797384262085
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.8110008239746094
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1043901443481445
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.7368922233581543
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.8102867603302002
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.7617030143737793
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.3659579753875732
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7513163089752197
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.4622225761413574
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7605218887329102
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.641880989074707
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.7651379108428955
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.2539525032043457
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.4393153190612793
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.7647690773010254
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.3729093074798584
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.4833154678344727
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3661811351776123
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5699148178100586
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4968676567077637
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5936110019683838
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.69777250289917
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.5111746788024902
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7408356666564941
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7307453155517578
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6116461753845215
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5683887004852295
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.7322413921356201
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6564586162567139
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.742119550704956
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8025786876678467
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6940484046936035
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44265241
model size : 183.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.114206314086914
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 2.947 Vali Acc: 0.377 Test Loss: 2.947 Test Acc: 0.377
Validation loss decreased (inf --> -0.376637).  Saving model ...
Epoch: 2 cost time: 0.8443214893341064
Epoch: 2, Steps: 18 | Train Loss: 2.716 Vali Loss: 2.151 Vali Acc: 0.820 Test Loss: 2.151 Test Acc: 0.820
Validation loss decreased (-0.376637 --> -0.819978).  Saving model ...
Epoch: 3 cost time: 1.037614345550537
Epoch: 3, Steps: 18 | Train Loss: 1.566 Vali Loss: 0.676 Vali Acc: 0.900 Test Loss: 0.676 Test Acc: 0.900
Validation loss decreased (-0.819978 --> -0.899993).  Saving model ...
Epoch: 4 cost time: 0.9527382850646973
Epoch: 4, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.225 Vali Acc: 0.940 Test Loss: 0.225 Test Acc: 0.940
Validation loss decreased (-0.899993 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 0.9373862743377686
Epoch: 5, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.182 Vali Acc: 0.947 Test Loss: 0.182 Test Acc: 0.947
Validation loss decreased (-0.939998 --> -0.946665).  Saving model ...
Epoch: 6 cost time: 0.9958255290985107
Epoch: 6, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
Validation loss decreased (-0.946665 --> -0.959999).  Saving model ...
Epoch: 7 cost time: 0.7895352840423584
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.983856201171875
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9619836807250977
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.906064510345459
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0697193145751953
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8992938995361328
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1489713191986084
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8754556179046631
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.231400728225708
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0959153175354004
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.246467113494873
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.108515977859497
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0938739776611328
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.1311845779418945
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9014270305633545
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.792478084564209
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7808141708374023
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8130879402160645
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7085864543914795
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.794567346572876
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9714362621307373
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0771501064300537
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1572999954223633
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 44078617
model size : 182.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5866260528564453
Epoch: 1, Steps: 18 | Train Loss: 3.330 Vali Loss: 3.075 Vali Acc: 0.203 Test Loss: 3.075 Test Acc: 0.203
Validation loss decreased (inf --> -0.203303).  Saving model ...
Epoch: 2 cost time: 0.9607503414154053
Epoch: 2, Steps: 18 | Train Loss: 2.926 Vali Loss: 2.560 Vali Acc: 0.703 Test Loss: 2.560 Test Acc: 0.703
Validation loss decreased (-0.203303 --> -0.703308).  Saving model ...
Epoch: 3 cost time: 0.8838849067687988
Epoch: 3, Steps: 18 | Train Loss: 2.258 Vali Loss: 1.515 Vali Acc: 0.877 Test Loss: 1.515 Test Acc: 0.877
Validation loss decreased (-0.703308 --> -0.876652).  Saving model ...
Epoch: 4 cost time: 0.8504698276519775
Epoch: 4, Steps: 18 | Train Loss: 1.099 Vali Loss: 0.429 Vali Acc: 0.933 Test Loss: 0.429 Test Acc: 0.933
Validation loss decreased (-0.876652 --> -0.933329).  Saving model ...
Epoch: 5 cost time: 0.9050185680389404
Epoch: 5, Steps: 18 | Train Loss: 0.334 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
Validation loss decreased (-0.933329 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 0.8534438610076904
Epoch: 6, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8776729106903076
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.8551108837127686
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9127926826477051
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8481152057647705
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.872807502746582
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9873168468475342
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8965940475463867
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9614520072937012
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8074319362640381
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7651724815368652
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7882158756256104
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.9502606391906738
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8606998920440674
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8225362300872803
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9547967910766602
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9135751724243164
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8146984577178955
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8303101062774658
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0185129642486572
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.818251371383667
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9046387672424316
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 43954201
model size : 182.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7188518047332764
Epoch: 1, Steps: 18 | Train Loss: 3.248 Vali Loss: 2.854 Vali Acc: 0.370 Test Loss: 2.854 Test Acc: 0.370
Validation loss decreased (inf --> -0.369971).  Saving model ...
Epoch: 2 cost time: 1.3430449962615967
Epoch: 2, Steps: 18 | Train Loss: 2.451 Vali Loss: 1.544 Vali Acc: 0.877 Test Loss: 1.544 Test Acc: 0.877
Validation loss decreased (-0.369971 --> -0.876651).  Saving model ...
Epoch: 3 cost time: 1.3931214809417725
Epoch: 3, Steps: 18 | Train Loss: 0.939 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
Validation loss decreased (-0.876651 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.2929589748382568
Epoch: 4, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.165 Vali Acc: 0.947 Test Loss: 0.165 Test Acc: 0.947
Validation loss decreased (-0.929997 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 0.9588363170623779
Epoch: 5, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.946665 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.4665088653564453
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.960 Test Loss: 0.115 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3500163555145264
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6338632106781006
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2476098537445068
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2370657920837402
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.328369379043579
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.034693717956543
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7928783893585205
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.094397783279419
Epoch: 14, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.940 Test Loss: 0.217 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3109626770019531
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.675577163696289
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5345299243927002
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.957 Test Loss: 0.200 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5999836921691895
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 44327449
model size : 183.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2402379512786865
Epoch: 1, Steps: 18 | Train Loss: 3.331 Vali Loss: 3.040 Vali Acc: 0.127 Test Loss: 3.040 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 1.1184613704681396
Epoch: 2, Steps: 18 | Train Loss: 2.804 Vali Loss: 2.302 Vali Acc: 0.753 Test Loss: 2.302 Test Acc: 0.753
Validation loss decreased (-0.126636 --> -0.753310).  Saving model ...
Epoch: 3 cost time: 1.002030611038208
Epoch: 3, Steps: 18 | Train Loss: 1.731 Vali Loss: 0.764 Vali Acc: 0.877 Test Loss: 0.764 Test Acc: 0.877
Validation loss decreased (-0.753310 --> -0.876659).  Saving model ...
Epoch: 4 cost time: 1.164806604385376
Epoch: 4, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.876659 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 0.8095369338989258
Epoch: 5, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.1585040092468262
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.956665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.2261323928833008
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0835022926330566
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2222683429718018
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.075028419494629
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1508533954620361
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0983023643493652
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9334022998809814
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0652103424072266
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7527163028717041
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.215832233428955
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.110687017440796
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1909699440002441
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1916909217834473
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8746867179870605
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2796964645385742
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.1252861022949219
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2103586196899414
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1862318515777588
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1855826377868652
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.193528175354004
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1477394104003906
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9713253974914551
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0263338088989258
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3652169704437256
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.263657569885254
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3540794849395752
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.166783332824707
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1510958671569824
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1242775917053223
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 44120089
model size : 182.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2405548095703125
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 3.032 Vali Acc: 0.180 Test Loss: 3.032 Test Acc: 0.180
Validation loss decreased (inf --> -0.179970).  Saving model ...
Epoch: 2 cost time: 0.973576545715332
Epoch: 2, Steps: 18 | Train Loss: 2.852 Vali Loss: 2.433 Vali Acc: 0.657 Test Loss: 2.433 Test Acc: 0.657
Validation loss decreased (-0.179970 --> -0.656642).  Saving model ...
Epoch: 3 cost time: 0.8882081508636475
Epoch: 3, Steps: 18 | Train Loss: 2.116 Vali Loss: 1.280 Vali Acc: 0.903 Test Loss: 1.280 Test Acc: 0.903
Validation loss decreased (-0.656642 --> -0.903321).  Saving model ...
Epoch: 4 cost time: 1.053131103515625
Epoch: 4, Steps: 18 | Train Loss: 0.985 Vali Loss: 0.386 Vali Acc: 0.940 Test Loss: 0.386 Test Acc: 0.940
Validation loss decreased (-0.903321 --> -0.939996).  Saving model ...
Epoch: 5 cost time: 0.869218111038208
Epoch: 5, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.202 Vali Acc: 0.940 Test Loss: 0.202 Test Acc: 0.940
Validation loss decreased (-0.939996 --> -0.939998).  Saving model ...
Epoch: 6 cost time: 0.9279613494873047
Epoch: 6, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.939998 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.842374324798584
Epoch: 7, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8857526779174805
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0363843441009521
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9059882164001465
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8748245239257812
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8952736854553223
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7695705890655518
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9226477146148682
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9727840423583984
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.789766788482666
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9331278800964355
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8442094326019287
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0454254150390625
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9384491443634033
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.05155611038208
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9094212055206299
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0739431381225586
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.966681957244873
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0126709938049316
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8822653293609619
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9825832843780518
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44016409
model size : 182.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3716816902160645
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 2.866 Vali Acc: 0.440 Test Loss: 2.866 Test Acc: 0.440
Validation loss decreased (inf --> -0.439971).  Saving model ...
Epoch: 2 cost time: 1.1575829982757568
Epoch: 2, Steps: 18 | Train Loss: 2.542 Vali Loss: 1.748 Vali Acc: 0.800 Test Loss: 1.748 Test Acc: 0.800
Validation loss decreased (-0.439971 --> -0.799983).  Saving model ...
Epoch: 3 cost time: 0.8240089416503906
Epoch: 3, Steps: 18 | Train Loss: 1.169 Vali Loss: 0.477 Vali Acc: 0.910 Test Loss: 0.477 Test Acc: 0.910
Validation loss decreased (-0.799983 --> -0.909995).  Saving model ...
Epoch: 4 cost time: 0.8416001796722412
Epoch: 4, Steps: 18 | Train Loss: 0.320 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.909995 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 0.8816802501678467
Epoch: 5, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.0774762630462646
Epoch: 6, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.05647611618042
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.2130179405212402
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8891022205352783
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8610923290252686
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.1113266944885254
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.899550199508667
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.9946434497833252
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.210092544555664
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.032092809677124
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8384089469909668
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2280840873718262
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9114546775817871
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9957644939422607
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8427927494049072
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9272744655609131
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9412500858306885
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9046063423156738
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0242180824279785
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0323374271392822
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7877006530761719
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3208072185516357
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1680340766906738
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4415256977081299
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1720468997955322
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2322251796722412
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 44306713
model size : 183.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4986472129821777
Epoch: 1, Steps: 18 | Train Loss: 3.287 Vali Loss: 3.023 Vali Acc: 0.200 Test Loss: 3.023 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 0.8354699611663818
Epoch: 2, Steps: 18 | Train Loss: 2.815 Vali Loss: 2.293 Vali Acc: 0.743 Test Loss: 2.293 Test Acc: 0.743
Validation loss decreased (-0.199970 --> -0.743310).  Saving model ...
Epoch: 3 cost time: 0.9757874011993408
Epoch: 3, Steps: 18 | Train Loss: 1.824 Vali Loss: 1.032 Vali Acc: 0.803 Test Loss: 1.032 Test Acc: 0.803
Validation loss decreased (-0.743310 --> -0.803323).  Saving model ...
Epoch: 4 cost time: 0.805518627166748
Epoch: 4, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.349 Vali Acc: 0.927 Test Loss: 0.349 Test Acc: 0.927
Validation loss decreased (-0.803323 --> -0.926663).  Saving model ...
Epoch: 5 cost time: 1.1962847709655762
Epoch: 5, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.189 Vali Acc: 0.960 Test Loss: 0.189 Test Acc: 0.960
Validation loss decreased (-0.926663 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.0185081958770752
Epoch: 6, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 7 cost time: 0.7550930976867676
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.0351247787475586
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.1468422412872314
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.008044719696045
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0277431011199951
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0212607383728027
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.070418357849121
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0368671417236328
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8294203281402588
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8222737312316895
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9329006671905518
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1270856857299805
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9381799697875977
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.1233830451965332
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9388134479522705
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.063751220703125
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0519533157348633
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1488142013549805
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1086900234222412
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0714716911315918
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.051952600479126
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.877535343170166
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9633944034576416
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0247039794921875
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44161561
model size : 183.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1941874027252197
Epoch: 1, Steps: 18 | Train Loss: 3.379 Vali Loss: 3.136 Vali Acc: 0.123 Test Loss: 3.136 Test Acc: 0.123
Validation loss decreased (inf --> -0.123302).  Saving model ...
Epoch: 2 cost time: 0.8680579662322998
Epoch: 2, Steps: 18 | Train Loss: 2.972 Vali Loss: 2.634 Vali Acc: 0.570 Test Loss: 2.634 Test Acc: 0.570
Validation loss decreased (-0.123302 --> -0.569974).  Saving model ...
Epoch: 3 cost time: 0.9573304653167725
Epoch: 3, Steps: 18 | Train Loss: 2.409 Vali Loss: 1.725 Vali Acc: 0.823 Test Loss: 1.725 Test Acc: 0.823
Validation loss decreased (-0.569974 --> -0.823316).  Saving model ...
Epoch: 4 cost time: 0.859708309173584
Epoch: 4, Steps: 18 | Train Loss: 1.400 Vali Loss: 0.718 Vali Acc: 0.920 Test Loss: 0.718 Test Acc: 0.920
Validation loss decreased (-0.823316 --> -0.919993).  Saving model ...
Epoch: 5 cost time: 0.9769339561462402
Epoch: 5, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.296 Vali Acc: 0.953 Test Loss: 0.296 Test Acc: 0.953
Validation loss decreased (-0.919993 --> -0.953330).  Saving model ...
Epoch: 6 cost time: 0.9147887229919434
Epoch: 6, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.953330 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.9822824001312256
Epoch: 7, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9215555191040039
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.93182373046875
Epoch: 9, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.953 Test Loss: 0.137 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7860159873962402
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7757341861724854
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8198387622833252
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7309653759002686
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8580749034881592
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7407054901123047
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.709230899810791
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8886013031005859
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8298690319061279
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.8480105400085449
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7429461479187012
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.888157844543457
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7698755264282227
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.8052577972412109
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.9830284118652344
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.8684887886047363
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8059909343719482
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.9603676795959473
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9064521789550781
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9610729217529297
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8793697357177734
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9221248626708984
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7862217426300049
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9286866188049316
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8921141624450684
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7852921485900879
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8955442905426025
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 44078617
model size : 182.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.298154830932617
Epoch: 1, Steps: 18 | Train Loss: 3.151 Vali Loss: 2.291 Vali Acc: 0.510 Test Loss: 2.291 Test Acc: 0.510
Validation loss decreased (inf --> -0.509977).  Saving model ...
Epoch: 2 cost time: 1.54689621925354
Epoch: 2, Steps: 18 | Train Loss: 1.520 Vali Loss: 0.638 Vali Acc: 0.873 Test Loss: 0.638 Test Acc: 0.873
Validation loss decreased (-0.509977 --> -0.873327).  Saving model ...
Epoch: 3 cost time: 1.432426929473877
Epoch: 3, Steps: 18 | Train Loss: 0.322 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
Validation loss decreased (-0.873327 --> -0.913331).  Saving model ...
Epoch: 4 cost time: 1.821695327758789
Epoch: 4, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.913331 --> -0.933331).  Saving model ...
Epoch: 5 cost time: 2.1286582946777344
Epoch: 5, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.387 Vali Acc: 0.930 Test Loss: 0.387 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7715044021606445
Epoch: 6, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.529 Vali Acc: 0.887 Test Loss: 0.529 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9498729705810547
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.983 Test Loss: 0.153 Test Acc: 0.983
Validation loss decreased (-0.933331 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.8718183040618896
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.953 Test Loss: 0.257 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1371121406555176
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.291 Vali Acc: 0.960 Test Loss: 0.291 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6190993785858154
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9906589984893799
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.967 Test Loss: 0.293 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.843799352645874
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.947 Test Loss: 0.297 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9718966484069824
Epoch: 13, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.829622507095337
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.486 Vali Acc: 0.930 Test Loss: 0.486 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8892199993133545
Epoch: 15, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.706 Vali Acc: 0.903 Test Loss: 0.706 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.978689193725586
Epoch: 16, Steps: 18 | Train Loss: 0.156 Vali Loss: 0.630 Vali Acc: 0.927 Test Loss: 0.630 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8926970958709717
Epoch: 17, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.476 Vali Acc: 0.943 Test Loss: 0.476 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37882393
model size : 159.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.218700408935547
Epoch: 1, Steps: 18 | Train Loss: 3.211 Vali Loss: 2.518 Vali Acc: 0.497 Test Loss: 2.518 Test Acc: 0.497
Validation loss decreased (inf --> -0.496641).  Saving model ...
Epoch: 2 cost time: 1.3947200775146484
Epoch: 2, Steps: 18 | Train Loss: 1.900 Vali Loss: 0.947 Vali Acc: 0.900 Test Loss: 0.947 Test Acc: 0.900
Validation loss decreased (-0.496641 --> -0.899991).  Saving model ...
Epoch: 3 cost time: 0.9914312362670898
Epoch: 3, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.275 Vali Acc: 0.927 Test Loss: 0.275 Test Acc: 0.927
Validation loss decreased (-0.899991 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 1.3520293235778809
Epoch: 4, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.304 Vali Acc: 0.913 Test Loss: 0.304 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7816874980926514
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.926664 --> -0.936664).  Saving model ...
Epoch: 6 cost time: 1.3396763801574707
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
Validation loss decreased (-0.936664 --> -0.959998).  Saving model ...
Epoch: 7 cost time: 1.7468090057373047
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0089797973632812
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.940 Test Loss: 0.301 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0849719047546387
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2520525455474854
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9138610363006592
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.102360725402832
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.595 Vali Acc: 0.887 Test Loss: 0.595 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8654928207397461
Epoch: 13, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.413 Vali Acc: 0.927 Test Loss: 0.413 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.238539457321167
Epoch: 14, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.226 Vali Acc: 0.967 Test Loss: 0.226 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2630648612976074
Epoch: 15, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.505 Vali Acc: 0.933 Test Loss: 0.505 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3865306377410889
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5551824569702148
Epoch: 17, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979998).  Saving model ...
Epoch: 18 cost time: 1.019756555557251
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2443921566009521
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.947 Test Loss: 0.394 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.881819486618042
Epoch: 20, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.278 Vali Acc: 0.967 Test Loss: 0.278 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5436348915100098
Epoch: 21, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.937 Test Loss: 0.466 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6967008113861084
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.947 Test Loss: 0.286 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7074036598205566
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.328 Vali Acc: 0.947 Test Loss: 0.328 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3409168720245361
Epoch: 24, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.396 Vali Acc: 0.960 Test Loss: 0.396 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.654052495956421
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.675 Vali Acc: 0.927 Test Loss: 0.675 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5671157836914062
Epoch: 26, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.501 Vali Acc: 0.943 Test Loss: 0.501 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6195635795593262
Epoch: 27, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.840 Vali Acc: 0.907 Test Loss: 0.840 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37405465
model size : 157.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.621591567993164
Epoch: 1, Steps: 18 | Train Loss: 3.214 Vali Loss: 2.760 Vali Acc: 0.487 Test Loss: 2.760 Test Acc: 0.487
Validation loss decreased (inf --> -0.486639).  Saving model ...
Epoch: 2 cost time: 1.1434175968170166
Epoch: 2, Steps: 18 | Train Loss: 2.351 Vali Loss: 1.595 Vali Acc: 0.903 Test Loss: 1.595 Test Acc: 0.903
Validation loss decreased (-0.486639 --> -0.903317).  Saving model ...
Epoch: 3 cost time: 1.2552316188812256
Epoch: 3, Steps: 18 | Train Loss: 1.060 Vali Loss: 0.386 Vali Acc: 0.927 Test Loss: 0.386 Test Acc: 0.927
Validation loss decreased (-0.903317 --> -0.926663).  Saving model ...
Epoch: 4 cost time: 1.223503589630127
Epoch: 4, Steps: 18 | Train Loss: 0.268 Vali Loss: 0.180 Vali Acc: 0.947 Test Loss: 0.180 Test Acc: 0.947
Validation loss decreased (-0.926663 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.5648539066314697
Epoch: 5, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
Validation loss decreased (-0.946665 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 1.4017045497894287
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 7 cost time: 1.1980562210083008
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 8 cost time: 1.3760151863098145
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.311155080795288
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8907301425933838
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.9375004768371582
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7305347919464111
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7253861427307129
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8978784084320068
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2408843040466309
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2648282051086426
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2652370929718018
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0693638324737549
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.160898208618164
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6718037128448486
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9979052543640137
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7831888198852539
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.396131992340088
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.9645352363586426
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1760921478271484
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.1538758277893066
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.8963360786437988
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.2578110694885254
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0830557346343994
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.896836519241333
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9977734088897705
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9325499534606934
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1413450241088867
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9361941814422607
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2344427108764648
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2730774879455566
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.395246982574463
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0463666915893555
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 36928537
model size : 155.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8191001415252686
Epoch: 1, Steps: 18 | Train Loss: 3.178 Vali Loss: 2.457 Vali Acc: 0.520 Test Loss: 2.457 Test Acc: 0.520
Validation loss decreased (inf --> -0.519975).  Saving model ...
Epoch: 2 cost time: 1.355055809020996
Epoch: 2, Steps: 18 | Train Loss: 1.641 Vali Loss: 0.743 Vali Acc: 0.883 Test Loss: 0.743 Test Acc: 0.883
Validation loss decreased (-0.519975 --> -0.883326).  Saving model ...
Epoch: 3 cost time: 1.4894022941589355
Epoch: 3, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.248 Vali Acc: 0.913 Test Loss: 0.248 Test Acc: 0.913
Validation loss decreased (-0.883326 --> -0.913331).  Saving model ...
Epoch: 4 cost time: 2.144401788711548
Epoch: 4, Steps: 18 | Train Loss: 0.192 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
Validation loss decreased (-0.913331 --> -0.916663).  Saving model ...
Epoch: 5 cost time: 2.1087918281555176
Epoch: 5, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.425 Vali Acc: 0.917 Test Loss: 0.425 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1819584369659424
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.562 Vali Acc: 0.897 Test Loss: 0.562 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2651662826538086
Epoch: 7, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.575 Vali Acc: 0.893 Test Loss: 0.575 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.678908348083496
Epoch: 8, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.287 Vali Acc: 0.943 Test Loss: 0.287 Test Acc: 0.943
Validation loss decreased (-0.916663 --> -0.943330).  Saving model ...
Epoch: 9 cost time: 2.2925608158111572
Epoch: 9, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1093437671661377
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.559 Vali Acc: 0.917 Test Loss: 0.559 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6433792114257812
Epoch: 11, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.376 Vali Acc: 0.947 Test Loss: 0.376 Test Acc: 0.947
Validation loss decreased (-0.943330 --> -0.946663).  Saving model ...
Epoch: 12 cost time: 1.2790067195892334
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.766 Vali Acc: 0.900 Test Loss: 0.766 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2032966613769531
Epoch: 13, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.799 Vali Acc: 0.897 Test Loss: 0.799 Test Acc: 0.897
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2362942695617676
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.971 Vali Acc: 0.897 Test Loss: 0.971 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1489768028259277
Epoch: 15, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.047 Vali Acc: 0.890 Test Loss: 1.047 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6333112716674805
Epoch: 16, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.767 Vali Acc: 0.950 Test Loss: 0.767 Test Acc: 0.950
Validation loss decreased (-0.946663 --> -0.949992).  Saving model ...
Epoch: 17 cost time: 1.8857245445251465
Epoch: 17, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.049 Vali Acc: 0.913 Test Loss: 1.049 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7102539539337158
Epoch: 18, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.666 Vali Acc: 0.950 Test Loss: 0.666 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 19 cost time: 2.3017914295196533
Epoch: 19, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.898 Vali Acc: 0.923 Test Loss: 0.898 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1514151096343994
Epoch: 20, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.616 Vali Acc: 0.960 Test Loss: 0.616 Test Acc: 0.960
Validation loss decreased (-0.949993 --> -0.959994).  Saving model ...
Epoch: 21 cost time: 2.058961868286133
Epoch: 21, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.581 Vali Acc: 0.967 Test Loss: 0.581 Test Acc: 0.967
Validation loss decreased (-0.959994 --> -0.966661).  Saving model ...
Epoch: 22 cost time: 1.744170904159546
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.957 Test Loss: 0.703 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0905323028564453
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.957 Test Loss: 0.709 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.095444679260254
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.953 Test Loss: 0.723 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0120463371276855
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.953 Test Loss: 0.725 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1966779232025146
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.957 Test Loss: 0.704 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.420210123062134
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.957 Test Loss: 0.697 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9656739234924316
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.957 Test Loss: 0.694 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.546821117401123
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.957 Test Loss: 0.693 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.031989097595215
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.957 Test Loss: 0.693 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9870975017547607
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.957 Test Loss: 0.692 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 37882393
model size : 159.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6242475509643555
Epoch: 1, Steps: 18 | Train Loss: 3.215 Vali Loss: 2.723 Vali Acc: 0.433 Test Loss: 2.723 Test Acc: 0.433
Validation loss decreased (inf --> -0.433306).  Saving model ...
Epoch: 2 cost time: 1.1184601783752441
Epoch: 2, Steps: 18 | Train Loss: 2.235 Vali Loss: 1.399 Vali Acc: 0.847 Test Loss: 1.399 Test Acc: 0.847
Validation loss decreased (-0.433306 --> -0.846653).  Saving model ...
Epoch: 3 cost time: 1.5141522884368896
Epoch: 3, Steps: 18 | Train Loss: 0.818 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.846653 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 0.9457263946533203
Epoch: 4, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.189 Vali Acc: 0.947 Test Loss: 0.189 Test Acc: 0.947
Validation loss decreased (-0.929997 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.4333765506744385
Epoch: 5, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.179 Vali Acc: 0.940 Test Loss: 0.179 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2168283462524414
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9467711448669434
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.946665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.447969675064087
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8317131996154785
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9934742450714111
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.498758316040039
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1556451320648193
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3045928478240967
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.060899257659912
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3693838119506836
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6563034057617188
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5579702854156494
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2788341045379639
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3539745807647705
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8145956993103027
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.3107256889343262
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.245948076248169
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8973395824432373
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2900125980377197
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.55161714553833
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9220983982086182
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8930983543395996
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5457890033721924
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.378509283065796
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5814449787139893
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.7868058681488037
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.785963535308838
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4639616012573242
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6168577671051025
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5306470394134521
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.0568742752075195
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6173632144927979
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.9076297283172607
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7891974449157715
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.9091994762420654
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37177369
model size : 156.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7785959243774414
Epoch: 1, Steps: 18 | Train Loss: 3.218 Vali Loss: 2.864 Vali Acc: 0.393 Test Loss: 2.864 Test Acc: 0.393
Validation loss decreased (inf --> -0.393305).  Saving model ...
Epoch: 2 cost time: 1.0012593269348145
Epoch: 2, Steps: 18 | Train Loss: 2.555 Vali Loss: 1.925 Vali Acc: 0.820 Test Loss: 1.925 Test Acc: 0.820
Validation loss decreased (-0.393305 --> -0.819981).  Saving model ...
Epoch: 3 cost time: 1.246157169342041
Epoch: 3, Steps: 18 | Train Loss: 1.371 Vali Loss: 0.541 Vali Acc: 0.917 Test Loss: 0.541 Test Acc: 0.917
Validation loss decreased (-0.819981 --> -0.916661).  Saving model ...
Epoch: 4 cost time: 1.421931505203247
Epoch: 4, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
Validation loss decreased (-0.916661 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 1.712622880935669
Epoch: 5, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.953332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.1088435649871826
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.953 Test Loss: 0.125 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1291215419769287
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.528662919998169
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7796757221221924
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 0.9807009696960449
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8131885528564453
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1748991012573242
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5211129188537598
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3737797737121582
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7960560321807861
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.116178035736084
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9164400100708008
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.918830156326294
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.3289060592651367
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.501157283782959
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3494455814361572
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4401893615722656
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3684475421905518
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5246195793151855
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.019866704940796
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3736720085144043
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5866661071777344
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5500833988189697
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 36866329
model size : 155.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3263564109802246
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 2.423 Vali Acc: 0.393 Test Loss: 2.423 Test Acc: 0.393
Validation loss decreased (inf --> -0.393309).  Saving model ...
Epoch: 2 cost time: 2.451047658920288
Epoch: 2, Steps: 18 | Train Loss: 1.763 Vali Loss: 0.782 Vali Acc: 0.857 Test Loss: 0.782 Test Acc: 0.857
Validation loss decreased (-0.393309 --> -0.856659).  Saving model ...
Epoch: 3 cost time: 1.7784380912780762
Epoch: 3, Steps: 18 | Train Loss: 0.429 Vali Loss: 0.308 Vali Acc: 0.910 Test Loss: 0.308 Test Acc: 0.910
Validation loss decreased (-0.856659 --> -0.909997).  Saving model ...
Epoch: 4 cost time: 1.5918831825256348
Epoch: 4, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.322 Vali Acc: 0.913 Test Loss: 0.322 Test Acc: 0.913
Validation loss decreased (-0.909997 --> -0.913330).  Saving model ...
Epoch: 5 cost time: 2.158412218093872
Epoch: 5, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.306 Vali Acc: 0.953 Test Loss: 0.306 Test Acc: 0.953
Validation loss decreased (-0.913330 --> -0.953330).  Saving model ...
Epoch: 6 cost time: 1.456578254699707
Epoch: 6, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.263979434967041
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.557 Vali Acc: 0.917 Test Loss: 0.557 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8533871173858643
Epoch: 8, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.610 Vali Acc: 0.890 Test Loss: 0.610 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0909836292266846
Epoch: 9, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.556 Vali Acc: 0.920 Test Loss: 0.556 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1995339393615723
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.392 Vali Acc: 0.940 Test Loss: 0.392 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5640642642974854
Epoch: 11, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.584 Vali Acc: 0.917 Test Loss: 0.584 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7038776874542236
Epoch: 12, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.742 Vali Acc: 0.913 Test Loss: 0.742 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1739962100982666
Epoch: 13, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.787 Vali Acc: 0.923 Test Loss: 0.787 Test Acc: 0.923
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2167930603027344
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.484 Vali Acc: 0.953 Test Loss: 0.484 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.022738456726074
Epoch: 15, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.453 Vali Acc: 0.957 Test Loss: 0.453 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956662).  Saving model ...
Epoch: 16 cost time: 2.110166549682617
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.509 Vali Acc: 0.940 Test Loss: 0.509 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0718300342559814
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.872 Vali Acc: 0.900 Test Loss: 0.872 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0760974884033203
Epoch: 18, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.612 Vali Acc: 0.937 Test Loss: 0.612 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0091753005981445
Epoch: 19, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.576 Vali Acc: 0.930 Test Loss: 0.576 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3278405666351318
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.937 Test Loss: 0.538 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.378035306930542
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.899 Vali Acc: 0.933 Test Loss: 0.899 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2218120098114014
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.784 Vali Acc: 0.943 Test Loss: 0.784 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.290581464767456
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.930 Test Loss: 0.716 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3309144973754883
Epoch: 24, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.740 Vali Acc: 0.933 Test Loss: 0.740 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.992051124572754
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.933 Test Loss: 0.888 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 37903129
model size : 159.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.762345314025879
Epoch: 1, Steps: 18 | Train Loss: 3.202 Vali Loss: 2.694 Vali Acc: 0.403 Test Loss: 2.694 Test Acc: 0.403
Validation loss decreased (inf --> -0.403306).  Saving model ...
Epoch: 2 cost time: 1.0889663696289062
Epoch: 2, Steps: 18 | Train Loss: 2.273 Vali Loss: 1.371 Vali Acc: 0.777 Test Loss: 1.371 Test Acc: 0.777
Validation loss decreased (-0.403306 --> -0.776653).  Saving model ...
Epoch: 3 cost time: 1.5930016040802002
Epoch: 3, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.291 Vali Acc: 0.920 Test Loss: 0.291 Test Acc: 0.920
Validation loss decreased (-0.776653 --> -0.919997).  Saving model ...
Epoch: 4 cost time: 1.5165281295776367
Epoch: 4, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.919997 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 1.8672761917114258
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.940 Test Loss: 0.228 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5573594570159912
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.949998 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.310842752456665
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9055228233337402
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5854787826538086
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1756234169006348
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.7185337543487549
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.947495460510254
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.1564240455627441
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.8455805778503418
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.0629470348358154
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.8273913860321045
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 1.1377801895141602
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 1.5208680629730225
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 1.1387219429016113
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 1.3611905574798584
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 1.3026061058044434
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3329286575317383
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2139842510223389
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 1.1551306247711182
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.2445406913757324
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9847266674041748
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2389309406280518
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2009556293487549
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.087693691253662
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.155264139175415
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.574934720993042
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.265653371810913
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5321950912475586
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4083342552185059
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2464122772216797
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.259357213973999
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.6722908020019531
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37198105
model size : 156.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8849036693573
Epoch: 1, Steps: 18 | Train Loss: 3.220 Vali Loss: 2.879 Vali Acc: 0.353 Test Loss: 2.879 Test Acc: 0.353
Validation loss decreased (inf --> -0.353305).  Saving model ...
Epoch: 2 cost time: 1.0093975067138672
Epoch: 2, Steps: 18 | Train Loss: 2.598 Vali Loss: 1.942 Vali Acc: 0.867 Test Loss: 1.942 Test Acc: 0.867
Validation loss decreased (-0.353305 --> -0.866647).  Saving model ...
Epoch: 3 cost time: 0.8975651264190674
Epoch: 3, Steps: 18 | Train Loss: 1.362 Vali Loss: 0.515 Vali Acc: 0.940 Test Loss: 0.515 Test Acc: 0.940
Validation loss decreased (-0.866647 --> -0.939995).  Saving model ...
Epoch: 4 cost time: 1.0979716777801514
Epoch: 4, Steps: 18 | Train Loss: 0.315 Vali Loss: 0.213 Vali Acc: 0.947 Test Loss: 0.213 Test Acc: 0.947
Validation loss decreased (-0.939995 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.181138038635254
Epoch: 5, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0671992301940918
Epoch: 6, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.946665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.0735390186309814
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3563859462738037
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2889180183410645
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2276313304901123
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.317826271057129
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1858274936676025
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1854987144470215
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1516964435577393
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2760956287384033
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1275317668914795
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9486587047576904
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.155566692352295
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.391 Vali Acc: 0.943 Test Loss: 0.391 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.11895751953125
Epoch: 19, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0820276737213135
Epoch: 20, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.261169195175171
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8848316669464111
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 36845593
model size : 155.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9970812797546387
Epoch: 1, Steps: 18 | Train Loss: 3.155 Vali Loss: 2.526 Vali Acc: 0.450 Test Loss: 2.526 Test Acc: 0.450
Validation loss decreased (inf --> -0.449975).  Saving model ...
Epoch: 2 cost time: 1.4380764961242676
Epoch: 2, Steps: 18 | Train Loss: 1.880 Vali Loss: 1.006 Vali Acc: 0.843 Test Loss: 1.006 Test Acc: 0.843
Validation loss decreased (-0.449975 --> -0.843323).  Saving model ...
Epoch: 3 cost time: 1.3238937854766846
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.843323 --> -0.929998).  Saving model ...
Epoch: 4 cost time: 1.4087634086608887
Epoch: 4, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.432 Vali Acc: 0.897 Test Loss: 0.432 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1200332641601562
Epoch: 5, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.929998 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.9584522247314453
Epoch: 6, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.598076581954956
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3851978778839111
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 1.146444320678711
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.959998 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5536551475524902
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.5798418521881104
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.0551416873931885
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5283312797546387
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.3009068965911865
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.6518561840057373
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 2.131039619445801
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.776425838470459
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4946188926696777
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.2954351902008057
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.3967673778533936
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3486950397491455
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.55452299118042
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.578455924987793
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1384007930755615
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5217761993408203
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.1966984272003174
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.386049509048462
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3368749618530273
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.684325933456421
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2330620288848877
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.575263261795044
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1836597919464111
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.341832160949707
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.074497938156128
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5717356204986572
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4422168731689453
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.2004961967468262
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6663711071014404
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3539023399353027
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3444147109985352
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2632179260253906
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2183761596679688
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4147460460662842
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2422051429748535
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.538999319076538
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.40736722946167
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37446937
model size : 157.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.658107042312622
Epoch: 1, Steps: 18 | Train Loss: 3.217 Vali Loss: 2.688 Vali Acc: 0.463 Test Loss: 2.688 Test Acc: 0.463
Validation loss decreased (inf --> -0.463306).  Saving model ...
Epoch: 2 cost time: 0.9435679912567139
Epoch: 2, Steps: 18 | Train Loss: 2.262 Vali Loss: 1.343 Vali Acc: 0.910 Test Loss: 1.343 Test Acc: 0.910
Validation loss decreased (-0.463306 --> -0.909987).  Saving model ...
Epoch: 3 cost time: 1.1983249187469482
Epoch: 3, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.271 Vali Acc: 0.947 Test Loss: 0.271 Test Acc: 0.947
Validation loss decreased (-0.909987 --> -0.946664).  Saving model ...
Epoch: 4 cost time: 0.8510489463806152
Epoch: 4, Steps: 18 | Train Loss: 0.140 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 1.0513551235198975
Epoch: 5, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.949998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.1965763568878174
Epoch: 6, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.0411529541015625
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4340572357177734
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1447155475616455
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2286629676818848
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2413513660430908
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0213737487792969
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3066844940185547
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1259288787841797
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.3617210388183594
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2327101230621338
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.5815715789794922
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.3137860298156738
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.2081396579742432
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.22792387008667
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.0692391395568848
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.5140490531921387
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.4043045043945312
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1714975833892822
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1937446594238281
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0195865631103516
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2703204154968262
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9345805644989014
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7325828075408936
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4047305583953857
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4245929718017578
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.5987894535064697
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.6097357273101807
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 1.4401538372039795
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.091780662536621
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6749894618988037
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 1.8802540302276611
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 1.0989630222320557
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 1.2652137279510498
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 1.3767950534820557
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 41 cost time: 1.273888111114502
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.66056489944458
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.3831403255462646
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9948663711547852
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.7718932628631592
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2420904636383057
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5420281887054443
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0235710144042969
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.5473027229309082
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.4311606884002686
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37073689
model size : 156.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.493612766265869
Epoch: 1, Steps: 18 | Train Loss: 3.252 Vali Loss: 2.899 Vali Acc: 0.377 Test Loss: 2.899 Test Acc: 0.377
Validation loss decreased (inf --> -0.376638).  Saving model ...
Epoch: 2 cost time: 1.3128039836883545
Epoch: 2, Steps: 18 | Train Loss: 2.604 Vali Loss: 1.996 Vali Acc: 0.847 Test Loss: 1.996 Test Acc: 0.847
Validation loss decreased (-0.376638 --> -0.846647).  Saving model ...
Epoch: 3 cost time: 1.0086746215820312
Epoch: 3, Steps: 18 | Train Loss: 1.448 Vali Loss: 0.633 Vali Acc: 0.923 Test Loss: 0.633 Test Acc: 0.923
Validation loss decreased (-0.846647 --> -0.923327).  Saving model ...
Epoch: 4 cost time: 1.8922505378723145
Epoch: 4, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
Validation loss decreased (-0.923327 --> -0.933331).  Saving model ...
Epoch: 5 cost time: 1.459479570388794
Epoch: 5, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.933331 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.7220864295959473
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.5172204971313477
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9570660591125488
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2329046726226807
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.0537245273590088
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0331909656524658
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.0407037734985352
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.6823365688323975
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.456993818283081
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.0093579292297363
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.4834504127502441
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.4596803188323975
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.655580759048462
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.326056718826294
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4944326877593994
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0023534297943115
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.25227689743042
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3835773468017578
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0403969287872314
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.422799825668335
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9814620018005371
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 36824857
model size : 155.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9356632232666016
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 2.602 Vali Acc: 0.430 Test Loss: 2.602 Test Acc: 0.430
Validation loss decreased (inf --> -0.429974).  Saving model ...
Epoch: 2 cost time: 1.4455113410949707
Epoch: 2, Steps: 18 | Train Loss: 2.095 Vali Loss: 1.080 Vali Acc: 0.847 Test Loss: 1.080 Test Acc: 0.847
Validation loss decreased (-0.429974 --> -0.846656).  Saving model ...
Epoch: 3 cost time: 1.9647164344787598
Epoch: 3, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
Validation loss decreased (-0.846656 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.9711251258850098
Epoch: 4, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.434 Vali Acc: 0.893 Test Loss: 0.434 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9557769298553467
Epoch: 5, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.929997 --> -0.936665).  Saving model ...
Epoch: 6 cost time: 1.5205881595611572
Epoch: 6, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0084645748138428
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.311 Vali Acc: 0.943 Test Loss: 0.311 Test Acc: 0.943
Validation loss decreased (-0.936665 --> -0.943330).  Saving model ...
Epoch: 8 cost time: 1.171189546585083
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.384 Vali Acc: 0.937 Test Loss: 0.384 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9657111167907715
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.252 Vali Acc: 0.943 Test Loss: 0.252 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943331).  Saving model ...
Epoch: 10 cost time: 1.8779973983764648
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
Validation loss decreased (-0.943331 --> -0.953332).  Saving model ...
Epoch: 11 cost time: 2.0630061626434326
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963332).  Saving model ...
Epoch: 12 cost time: 1.7994554042816162
Epoch: 12, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6759734153747559
Epoch: 13, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.274 Vali Acc: 0.957 Test Loss: 0.274 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.14626145362854
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.363713264465332
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.337 Vali Acc: 0.947 Test Loss: 0.337 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9036853313446045
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.957 Test Loss: 0.313 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6893861293792725
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.967 Test Loss: 0.250 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966664).  Saving model ...
Epoch: 18 cost time: 2.2394206523895264
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.970 Test Loss: 0.243 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 19 cost time: 2.062243700027466
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.970 Test Loss: 0.239 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 20 cost time: 2.400928020477295
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.973 Test Loss: 0.236 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 21 cost time: 2.2445850372314453
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.973 Test Loss: 0.233 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 22 cost time: 2.037874698638916
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.973 Test Loss: 0.229 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 23 cost time: 2.219759464263916
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.973 Test Loss: 0.227 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 24 cost time: 2.1948935985565186
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.973 Test Loss: 0.226 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 25 cost time: 1.4702589511871338
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.973 Test Loss: 0.226 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 26 cost time: 2.204883098602295
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.973 Test Loss: 0.225 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 27 cost time: 2.1209352016448975
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.973 Test Loss: 0.224 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 28 cost time: 1.7836971282958984
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 29 cost time: 1.8250441551208496
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 30 cost time: 2.3858673572540283
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.973 Test Loss: 0.222 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 31 cost time: 1.7889654636383057
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.973 Test Loss: 0.220 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 32 cost time: 1.904655933380127
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 33 cost time: 1.404463291168213
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 34 cost time: 2.038444757461548
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 35 cost time: 1.115734577178955
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.973 Test Loss: 0.216 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 36 cost time: 2.3207485675811768
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.973 Test Loss: 0.216 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 37 cost time: 2.249866008758545
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.973 Test Loss: 0.216 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 38 cost time: 1.598729133605957
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 39 cost time: 1.6822636127471924
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 40 cost time: 1.4232101440429688
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 41 cost time: 1.6072614192962646
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.973 Test Loss: 0.214 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 42 cost time: 1.6404306888580322
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.973 Test Loss: 0.214 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 43 cost time: 1.7656564712524414
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.973 Test Loss: 0.214 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 44 cost time: 1.190009355545044
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 45 cost time: 1.4085681438446045
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 46 cost time: 1.6904544830322266
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 47 cost time: 1.6535921096801758
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.973 Test Loss: 0.212 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 48 cost time: 1.8691043853759766
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 49 cost time: 1.9520153999328613
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 50 cost time: 1.23225736618042
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 37446937
model size : 157.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3322954177856445
Epoch: 1, Steps: 18 | Train Loss: 3.247 Vali Loss: 2.778 Vali Acc: 0.403 Test Loss: 2.778 Test Acc: 0.403
Validation loss decreased (inf --> -0.403306).  Saving model ...
Epoch: 2 cost time: 1.2427632808685303
Epoch: 2, Steps: 18 | Train Loss: 2.399 Vali Loss: 1.540 Vali Acc: 0.847 Test Loss: 1.540 Test Acc: 0.847
Validation loss decreased (-0.403306 --> -0.846651).  Saving model ...
Epoch: 3 cost time: 1.1594641208648682
Epoch: 3, Steps: 18 | Train Loss: 0.915 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.846651 --> -0.936664).  Saving model ...
Epoch: 4 cost time: 1.061396598815918
Epoch: 4, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.936664 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 1.3401734828948975
Epoch: 5, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0742745399475098
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.043367624282837
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0097944736480713
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9743630886077881
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1148629188537598
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2601256370544434
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4397635459899902
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3674829006195068
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0790061950683594
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9478724002838135
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4011390209197998
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.5057601928710938
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.0843968391418457
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.3669795989990234
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.429227352142334
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.0879442691802979
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.212705135345459
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1628186702728271
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2521517276763916
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.2695822715759277
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.3232929706573486
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2171523571014404
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.0503690242767334
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.2015881538391113
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.3407890796661377
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 1.0382177829742432
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8097515106201172
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.013664722442627
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0393052101135254
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2753078937530518
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2797605991363525
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4867627620697021
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9688434600830078
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4551022052764893
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.8622229099273682
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.9674479961395264
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.0171542167663574
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2524449825286865
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9528965950012207
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1393942832946777
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1605584621429443
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9992794990539551
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2137296199798584
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3936877250671387
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2246899604797363
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 37073689
model size : 156.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.034529685974121
Epoch: 1, Steps: 18 | Train Loss: 3.279 Vali Loss: 2.958 Vali Acc: 0.277 Test Loss: 2.958 Test Acc: 0.277
Validation loss decreased (inf --> -0.276637).  Saving model ...
Epoch: 2 cost time: 0.7857391834259033
Epoch: 2, Steps: 18 | Train Loss: 2.705 Vali Loss: 2.178 Vali Acc: 0.770 Test Loss: 2.178 Test Acc: 0.770
Validation loss decreased (-0.276637 --> -0.769978).  Saving model ...
Epoch: 3 cost time: 1.0792007446289062
Epoch: 3, Steps: 18 | Train Loss: 1.676 Vali Loss: 0.739 Vali Acc: 0.920 Test Loss: 0.739 Test Acc: 0.920
Validation loss decreased (-0.769978 --> -0.919993).  Saving model ...
Epoch: 4 cost time: 0.9688224792480469
Epoch: 4, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.240 Vali Acc: 0.923 Test Loss: 0.240 Test Acc: 0.923
Validation loss decreased (-0.919993 --> -0.923331).  Saving model ...
Epoch: 5 cost time: 0.9977676868438721
Epoch: 5, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.144 Vali Acc: 0.953 Test Loss: 0.144 Test Acc: 0.953
Validation loss decreased (-0.923331 --> -0.953332).  Saving model ...
Epoch: 6 cost time: 0.9793188571929932
Epoch: 6, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.6448357105255127
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.963 Test Loss: 0.100 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6285011768341064
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6165287494659424
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9411606788635254
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7416095733642578
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.136312484741211
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7116315364837646
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.6221470832824707
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7711701393127441
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7049994468688965
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7110397815704346
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9019417762756348
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8440380096435547
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.00173020362854
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7661099433898926
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8100457191467285
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8172705173492432
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.792457103729248
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0270068645477295
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 36804121
model size : 155.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.606891632080078
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 2.569 Vali Acc: 0.543 Test Loss: 2.569 Test Acc: 0.543
Validation loss decreased (inf --> -0.543308).  Saving model ...
Epoch: 2 cost time: 1.5995030403137207
Epoch: 2, Steps: 18 | Train Loss: 1.974 Vali Loss: 0.986 Vali Acc: 0.853 Test Loss: 0.986 Test Acc: 0.853
Validation loss decreased (-0.543308 --> -0.853323).  Saving model ...
Epoch: 3 cost time: 1.1101794242858887
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.296 Vali Acc: 0.923 Test Loss: 0.296 Test Acc: 0.923
Validation loss decreased (-0.853323 --> -0.923330).  Saving model ...
Epoch: 4 cost time: 1.5745642185211182
Epoch: 4, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.260 Vali Acc: 0.910 Test Loss: 0.260 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2659602165222168
Epoch: 5, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
Validation loss decreased (-0.923330 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.3546853065490723
Epoch: 6, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.643 Vali Acc: 0.900 Test Loss: 0.643 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2558941841125488
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.2801740169525146
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0870521068573
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2711215019226074
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1190478801727295
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 3.041865825653076
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 2.749818801879883
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.154144048690796
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8575444221496582
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.928743839263916
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 2.6061017513275146
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.8267154693603516
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 2.360909938812256
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.853602409362793
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.7535457611083984
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1113553047180176
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8036253452301025
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2741811275482178
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.736513376235962
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.420245409011841
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3853096961975098
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.8003671169281006
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 37467673
model size : 157.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.786130666732788
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 2.798 Vali Acc: 0.433 Test Loss: 2.798 Test Acc: 0.433
Validation loss decreased (inf --> -0.433305).  Saving model ...
Epoch: 2 cost time: 2.5388450622558594
Epoch: 2, Steps: 18 | Train Loss: 2.450 Vali Loss: 1.619 Vali Acc: 0.850 Test Loss: 1.619 Test Acc: 0.850
Validation loss decreased (-0.433305 --> -0.849984).  Saving model ...
Epoch: 3 cost time: 2.700490713119507
Epoch: 3, Steps: 18 | Train Loss: 1.033 Vali Loss: 0.405 Vali Acc: 0.893 Test Loss: 0.405 Test Acc: 0.893
Validation loss decreased (-0.849984 --> -0.893329).  Saving model ...
Epoch: 4 cost time: 2.7440288066864014
Epoch: 4, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.286 Vali Acc: 0.897 Test Loss: 0.286 Test Acc: 0.897
Validation loss decreased (-0.893329 --> -0.896664).  Saving model ...
Epoch: 5 cost time: 2.5262539386749268
Epoch: 5, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.231 Vali Acc: 0.920 Test Loss: 0.231 Test Acc: 0.920
Validation loss decreased (-0.896664 --> -0.919998).  Saving model ...
Epoch: 6 cost time: 2.4875214099884033
Epoch: 6, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.919998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.6435558795928955
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.947 Test Loss: 0.188 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.335014820098877
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.2474439144134521
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9957401752471924
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.391697645187378
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4491207599639893
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9637649059295654
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8108348846435547
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0173916816711426
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9912221431732178
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.472900152206421
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0701653957366943
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37011481
model size : 155.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0662872791290283
Epoch: 1, Steps: 18 | Train Loss: 3.278 Vali Loss: 2.981 Vali Acc: 0.330 Test Loss: 2.981 Test Acc: 0.330
Validation loss decreased (inf --> -0.329970).  Saving model ...
Epoch: 2 cost time: 1.6913957595825195
Epoch: 2, Steps: 18 | Train Loss: 2.782 Vali Loss: 2.240 Vali Acc: 0.827 Test Loss: 2.240 Test Acc: 0.827
Validation loss decreased (-0.329970 --> -0.826644).  Saving model ...
Epoch: 3 cost time: 1.4820082187652588
Epoch: 3, Steps: 18 | Train Loss: 1.731 Vali Loss: 0.790 Vali Acc: 0.917 Test Loss: 0.790 Test Acc: 0.917
Validation loss decreased (-0.826644 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 1.0928239822387695
Epoch: 4, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.916659 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 1.3931822776794434
Epoch: 5, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3628368377685547
Epoch: 6, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.4124374389648438
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.8952453136444092
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6136791706085205
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8119227886199951
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.854555368423462
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.821256399154663
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7926349639892578
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.725658655166626
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6397817134857178
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6839361190795898
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.9403650760650635
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5896549224853516
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.850153923034668
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3512134552001953
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3805468082427979
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3170502185821533
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3510901927947998
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.108440637588501
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1724402904510498
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1048357486724854
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.4700512886047363
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4544475078582764
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2553906440734863
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3987739086151123
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.3031623363494873
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4795522689819336
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1306750774383545
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9489212036132812
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.4287667274475098
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.330888271331787
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.3369572162628174
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5162854194641113
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7233858108520508
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.6985459327697754
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5502877235412598
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4153993129730225
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.755232334136963
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4589378833770752
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4149959087371826
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.749347448348999
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2994534969329834
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.4172093868255615
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.5764820575714111
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.126798391342163
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 36804121
model size : 155.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5413625240325928
Epoch: 1, Steps: 18 | Train Loss: 3.179 Vali Loss: 2.616 Vali Acc: 0.397 Test Loss: 2.616 Test Acc: 0.397
Validation loss decreased (inf --> -0.396641).  Saving model ...
Epoch: 2 cost time: 2.2170748710632324
Epoch: 2, Steps: 18 | Train Loss: 2.018 Vali Loss: 1.012 Vali Acc: 0.847 Test Loss: 1.012 Test Acc: 0.847
Validation loss decreased (-0.396641 --> -0.846657).  Saving model ...
Epoch: 3 cost time: 3.3105897903442383
Epoch: 3, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.846657 --> -0.899996).  Saving model ...
Epoch: 4 cost time: 3.104537010192871
Epoch: 4, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.899996 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.0085532665252686
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.245 Vali Acc: 0.947 Test Loss: 0.245 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5160133838653564
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9140615463256836
Epoch: 7, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.403717517852783
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1940624713897705
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.6841132640838623
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.963 Test Loss: 0.246 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2956793308258057
Epoch: 11, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.960 Test Loss: 0.189 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.477083683013916
Epoch: 12, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.098735809326172
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.759775161743164
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.353 Vali Acc: 0.933 Test Loss: 0.353 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2306087017059326
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.937 Test Loss: 0.359 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.524571418762207
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5671017169952393
Epoch: 17, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.247 Vali Acc: 0.960 Test Loss: 0.247 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.009463310241699
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.953 Test Loss: 0.273 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6053502559661865
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.960 Test Loss: 0.250 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 37488409
model size : 157.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5974462032318115
Epoch: 1, Steps: 18 | Train Loss: 3.246 Vali Loss: 2.826 Vali Acc: 0.343 Test Loss: 2.826 Test Acc: 0.343
Validation loss decreased (inf --> -0.343305).  Saving model ...
Epoch: 2 cost time: 1.9927113056182861
Epoch: 2, Steps: 18 | Train Loss: 2.496 Vali Loss: 1.656 Vali Acc: 0.857 Test Loss: 1.656 Test Acc: 0.857
Validation loss decreased (-0.343305 --> -0.856650).  Saving model ...
Epoch: 3 cost time: 1.9237139225006104
Epoch: 3, Steps: 18 | Train Loss: 1.094 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.856650 --> -0.899996).  Saving model ...
Epoch: 4 cost time: 2.0425472259521484
Epoch: 4, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.899996 --> -0.929997).  Saving model ...
Epoch: 5 cost time: 2.3161256313323975
Epoch: 5, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.929997 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 2.574522018432617
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 2.02239727973938
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.8189377784729004
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1428418159484863
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.1705095767974854
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 2.3247056007385254
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9719061851501465
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4837026596069336
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.9784953594207764
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 2.158557891845703
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.7686753273010254
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 17 cost time: 1.7130210399627686
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0613677501678467
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5692455768585205
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4658119678497314
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6733887195587158
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7212295532226562
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.987 Test Loss: 0.089 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9712400436401367
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.253140926361084
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6669716835021973
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5355679988861084
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 37032217
model size : 155.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.291581153869629
Epoch: 1, Steps: 18 | Train Loss: 3.257 Vali Loss: 2.943 Vali Acc: 0.270 Test Loss: 2.943 Test Acc: 0.270
Validation loss decreased (inf --> -0.269971).  Saving model ...
Epoch: 2 cost time: 1.0303514003753662
Epoch: 2, Steps: 18 | Train Loss: 2.729 Vali Loss: 2.259 Vali Acc: 0.740 Test Loss: 2.259 Test Acc: 0.740
Validation loss decreased (-0.269971 --> -0.739977).  Saving model ...
Epoch: 3 cost time: 1.145934820175171
Epoch: 3, Steps: 18 | Train Loss: 1.787 Vali Loss: 0.926 Vali Acc: 0.877 Test Loss: 0.926 Test Acc: 0.877
Validation loss decreased (-0.739977 --> -0.876657).  Saving model ...
Epoch: 4 cost time: 0.9578852653503418
Epoch: 4, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.387 Vali Acc: 0.920 Test Loss: 0.387 Test Acc: 0.920
Validation loss decreased (-0.876657 --> -0.919996).  Saving model ...
Epoch: 5 cost time: 1.4047279357910156
Epoch: 5, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.919996 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 0.9777371883392334
Epoch: 6, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0304818153381348
Epoch: 7, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.0193119049072266
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2437305450439453
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.963 Test Loss: 0.103 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9912898540496826
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1022822856903076
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9349677562713623
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0377869606018066
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.4185097217559814
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2386457920074463
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.234311819076538
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0300469398498535
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.209388256072998
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.3529345989227295
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.327901840209961
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2269296646118164
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6115784645080566
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.5887408256530762
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.289968490600586
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.2968850135803223
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5376083850860596
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3782429695129395
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2251358032226562
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.253532886505127
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2049784660339355
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0545933246612549
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.0692098140716553
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.9677162170410156
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.599597692489624
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3507626056671143
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6111955642700195
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9004166126251221
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7111773490905762
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8774919509887695
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9574334621429443
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1288766860961914
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.057295799255371
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6845154762268066
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9772875308990479
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2902357578277588
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1831881999969482
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2745144367218018
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.5483777523040771
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.059579610824585
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9387829303741455
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 36804121
model size : 155.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9370205402374268
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 2.673 Vali Acc: 0.397 Test Loss: 2.673 Test Acc: 0.397
Validation loss decreased (inf --> -0.396640).  Saving model ...
Epoch: 2 cost time: 1.1722919940948486
Epoch: 2, Steps: 18 | Train Loss: 2.161 Vali Loss: 1.216 Vali Acc: 0.863 Test Loss: 1.216 Test Acc: 0.863
Validation loss decreased (-0.396640 --> -0.863321).  Saving model ...
Epoch: 3 cost time: 2.427582025527954
Epoch: 3, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.863321 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 2.6257081031799316
Epoch: 4, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.916664 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 2.0388615131378174
Epoch: 5, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.654325008392334
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.215461254119873
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.195 Vali Acc: 0.940 Test Loss: 0.195 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5563089847564697
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.52017879486084
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.569150686264038
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 1.4626092910766602
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 2.148134231567383
Epoch: 12, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2887864112854004
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.940 Test Loss: 0.249 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1139795780181885
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.402 Vali Acc: 0.913 Test Loss: 0.402 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6518657207489014
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9831511974334717
Epoch: 16, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6793124675750732
Epoch: 17, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.505 Vali Acc: 0.937 Test Loss: 0.505 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6114563941955566
Epoch: 18, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.000861167907715
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.328338384628296
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.960 Test Loss: 0.245 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6202471256256104
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 37281049
model size : 156.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.315239191055298
Epoch: 1, Steps: 18 | Train Loss: 3.242 Vali Loss: 2.809 Vali Acc: 0.443 Test Loss: 2.809 Test Acc: 0.443
Validation loss decreased (inf --> -0.443305).  Saving model ...
Epoch: 2 cost time: 2.332529306411743
Epoch: 2, Steps: 18 | Train Loss: 2.433 Vali Loss: 1.684 Vali Acc: 0.900 Test Loss: 1.684 Test Acc: 0.900
Validation loss decreased (-0.443305 --> -0.899983).  Saving model ...
Epoch: 3 cost time: 2.253561019897461
Epoch: 3, Steps: 18 | Train Loss: 1.121 Vali Loss: 0.449 Vali Acc: 0.890 Test Loss: 0.449 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8726954460144043
Epoch: 4, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.899983 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.6648399829864502
Epoch: 5, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3753578662872314
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9083380699157715
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.923 Test Loss: 0.223 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8962268829345703
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.4191854000091553
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.6774392127990723
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.4530131816864014
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.8181350231170654
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9553101062774658
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.9470508098602295
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.4889490604400635
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3326470851898193
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2260494232177734
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5064547061920166
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.537611484527588
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7204344272613525
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.30430269241333
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.5252676010131836
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5663833618164062
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.849872350692749
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.1524155139923096
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7935965061187744
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.869541883468628
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.643139123916626
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.360612154006958
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0877094268798828
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.918116569519043
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 36990745
model size : 155.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.438255786895752
Epoch: 1, Steps: 18 | Train Loss: 3.323 Vali Loss: 3.038 Vali Acc: 0.217 Test Loss: 3.038 Test Acc: 0.217
Validation loss decreased (inf --> -0.216636).  Saving model ...
Epoch: 2 cost time: 1.1529083251953125
Epoch: 2, Steps: 18 | Train Loss: 2.871 Vali Loss: 2.410 Vali Acc: 0.800 Test Loss: 2.410 Test Acc: 0.800
Validation loss decreased (-0.216636 --> -0.799976).  Saving model ...
Epoch: 3 cost time: 1.3660237789154053
Epoch: 3, Steps: 18 | Train Loss: 2.002 Vali Loss: 1.075 Vali Acc: 0.937 Test Loss: 1.075 Test Acc: 0.937
Validation loss decreased (-0.799976 --> -0.936656).  Saving model ...
Epoch: 4 cost time: 1.0502731800079346
Epoch: 4, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.258 Vali Acc: 0.943 Test Loss: 0.258 Test Acc: 0.943
Validation loss decreased (-0.936656 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 0.7577869892120361
Epoch: 5, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9517920017242432
Epoch: 6, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.943331 --> -0.956665).  Saving model ...
Epoch: 7 cost time: 1.4100024700164795
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.960 Test Loss: 0.111 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959999).  Saving model ...
Epoch: 8 cost time: 1.3150770664215088
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.959999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1725921630859375
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4170196056365967
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9777421951293945
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.1616508960723877
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2406892776489258
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.1164071559906006
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.305527925491333
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.2464494705200195
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2573623657226562
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.2477500438690186
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.088186502456665
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.9351744651794434
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6296358108520508
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.7382328510284424
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1752164363861084
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.950951337814331
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.7194702625274658
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1596894264221191
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6382710933685303
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3120512962341309
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9562034606933594
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.230733871459961
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2707087993621826
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.76981520652771
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.6205945014953613
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 1.4177136421203613
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7520442008972168
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5578408241271973
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.783496618270874
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4960174560546875
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7632575035095215
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4354779720306396
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.7485437393188477
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2937610149383545
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.6646175384521484
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 36804121
model size : 155.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.341017723083496
Epoch: 1, Steps: 18 | Train Loss: 3.172 Vali Loss: 2.629 Vali Acc: 0.443 Test Loss: 2.629 Test Acc: 0.443
Validation loss decreased (inf --> -0.443307).  Saving model ...
Epoch: 2 cost time: 1.6353693008422852
Epoch: 2, Steps: 18 | Train Loss: 2.121 Vali Loss: 1.154 Vali Acc: 0.853 Test Loss: 1.154 Test Acc: 0.853
Validation loss decreased (-0.443307 --> -0.853322).  Saving model ...
Epoch: 3 cost time: 1.8645117282867432
Epoch: 3, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.291 Vali Acc: 0.927 Test Loss: 0.291 Test Acc: 0.927
Validation loss decreased (-0.853322 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 2.104250192642212
Epoch: 4, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.926664 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.846534013748169
Epoch: 5, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7998530864715576
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 2.4017441272735596
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7418804168701172
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.302877902984619
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.983 Test Loss: 0.146 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.319904088973999
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.723888635635376
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.670149326324463
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5782604217529297
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.445479154586792
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.947 Test Loss: 0.270 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8871533870697021
Epoch: 15, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.37575101852417
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.570 Vali Acc: 0.880 Test Loss: 0.570 Test Acc: 0.880
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9764268398284912
Epoch: 17, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.342 Vali Acc: 0.953 Test Loss: 0.342 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2020957469940186
Epoch: 18, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.499 Vali Acc: 0.937 Test Loss: 0.499 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6698412895202637
Epoch: 19, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.724 Vali Acc: 0.913 Test Loss: 0.724 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37301785
model size : 156.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.336989164352417
Epoch: 1, Steps: 18 | Train Loss: 3.254 Vali Loss: 2.899 Vali Acc: 0.393 Test Loss: 2.899 Test Acc: 0.393
Validation loss decreased (inf --> -0.393304).  Saving model ...
Epoch: 2 cost time: 2.08536958694458
Epoch: 2, Steps: 18 | Train Loss: 2.617 Vali Loss: 1.921 Vali Acc: 0.827 Test Loss: 1.921 Test Acc: 0.827
Validation loss decreased (-0.393304 --> -0.826647).  Saving model ...
Epoch: 3 cost time: 2.046567440032959
Epoch: 3, Steps: 18 | Train Loss: 1.355 Vali Loss: 0.548 Vali Acc: 0.903 Test Loss: 0.548 Test Acc: 0.903
Validation loss decreased (-0.826647 --> -0.903328).  Saving model ...
Epoch: 4 cost time: 1.5501723289489746
Epoch: 4, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.291 Vali Acc: 0.907 Test Loss: 0.291 Test Acc: 0.907
Validation loss decreased (-0.903328 --> -0.906664).  Saving model ...
Epoch: 5 cost time: 1.9963829517364502
Epoch: 5, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.906664 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 2.294574499130249
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.87093186378479
Epoch: 7, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9727051258087158
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.7612526416778564
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.6513361930847168
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.349518060684204
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2353451251983643
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4302220344543457
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5300581455230713
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5538768768310547
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3520333766937256
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3100628852844238
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2847809791564941
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2078421115875244
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 36970009
model size : 155.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3562443256378174
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 2.955 Vali Acc: 0.273 Test Loss: 2.955 Test Acc: 0.273
Validation loss decreased (inf --> -0.273304).  Saving model ...
Epoch: 2 cost time: 0.8103184700012207
Epoch: 2, Steps: 18 | Train Loss: 2.773 Vali Loss: 2.330 Vali Acc: 0.710 Test Loss: 2.330 Test Acc: 0.710
Validation loss decreased (-0.273304 --> -0.709977).  Saving model ...
Epoch: 3 cost time: 1.0593178272247314
Epoch: 3, Steps: 18 | Train Loss: 1.941 Vali Loss: 1.073 Vali Acc: 0.893 Test Loss: 1.073 Test Acc: 0.893
Validation loss decreased (-0.709977 --> -0.893323).  Saving model ...
Epoch: 4 cost time: 1.1974554061889648
Epoch: 4, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
Validation loss decreased (-0.893323 --> -0.949997).  Saving model ...
Epoch: 5 cost time: 1.2319798469543457
Epoch: 5, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953332).  Saving model ...
Epoch: 6 cost time: 0.9678046703338623
Epoch: 6, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (-0.953332 --> -0.959999).  Saving model ...
Epoch: 7 cost time: 0.8544831275939941
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.8837933540344238
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.1736035346984863
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9866025447845459
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9452390670776367
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9632835388183594
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7576842308044434
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9456987380981445
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.092470645904541
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1509122848510742
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.256059169769287
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.2871453762054443
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9513320922851562
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2651238441467285
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.4364395141601562
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7666599750518799
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3203754425048828
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.869575023651123
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0594732761383057
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8978724479675293
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8961746692657471
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2010993957519531
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8584988117218018
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3281986713409424
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.3539206981658936
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.2852342128753662
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.9145550727844238
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8374545574188232
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0402510166168213
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.763110876083374
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7486374378204346
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.798478364944458
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9697582721710205
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0307831764221191
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.2572219371795654
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.9443905353546143
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9627861976623535
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2063405513763428
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0933215618133545
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0690371990203857
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2715699672698975
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0073201656341553
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0574049949645996
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7753708362579346
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 36804121
model size : 155.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4136593341827393
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 2.674 Vali Acc: 0.417 Test Loss: 2.674 Test Acc: 0.417
Validation loss decreased (inf --> -0.416640).  Saving model ...
Epoch: 2 cost time: 1.203197956085205
Epoch: 2, Steps: 18 | Train Loss: 2.092 Vali Loss: 1.054 Vali Acc: 0.903 Test Loss: 1.054 Test Acc: 0.903
Validation loss decreased (-0.416640 --> -0.903323).  Saving model ...
Epoch: 3 cost time: 1.627814769744873
Epoch: 3, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.286 Vali Acc: 0.907 Test Loss: 0.286 Test Acc: 0.907
Validation loss decreased (-0.903323 --> -0.906664).  Saving model ...
Epoch: 4 cost time: 1.5314538478851318
Epoch: 4, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.906664 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.9108543395996094
Epoch: 5, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.219 Vali Acc: 0.940 Test Loss: 0.219 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8828387260437012
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8528647422790527
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1723275184631348
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1315338611602783
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5918114185333252
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.6787025928497314
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9187977313995361
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5424065589904785
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.096130609512329
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0529794692993164
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5315496921539307
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.5664470195770264
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.045034408569336
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1786718368530273
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.5860202312469482
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.020841360092163
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.2358920574188232
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.8130648136138916
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.5182080268859863
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.0853192806243896
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.510495901107788
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.136340856552124
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.700441598892212
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.2828588485717773
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 2.27046537399292
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.688002586364746
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.3716907501220703
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 2.7140262126922607
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 2.32311749458313
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.1784889698028564
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 2.0409016609191895
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 2.3067331314086914
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3307552337646484
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.4320051670074463
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3543598651885986
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3504464626312256
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8469390869140625
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5650105476379395
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.6582927703857422
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3272442817687988
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.0842816829681396
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.597996473312378
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8567850589752197
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37322521
model size : 157.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.36444354057312
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 2.837 Vali Acc: 0.440 Test Loss: 2.837 Test Acc: 0.440
Validation loss decreased (inf --> -0.439972).  Saving model ...
Epoch: 2 cost time: 2.0209732055664062
Epoch: 2, Steps: 18 | Train Loss: 2.577 Vali Loss: 1.832 Vali Acc: 0.847 Test Loss: 1.832 Test Acc: 0.847
Validation loss decreased (-0.439972 --> -0.846648).  Saving model ...
Epoch: 3 cost time: 2.0968594551086426
Epoch: 3, Steps: 18 | Train Loss: 1.288 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
Validation loss decreased (-0.846648 --> -0.903328).  Saving model ...
Epoch: 4 cost time: 1.4289348125457764
Epoch: 4, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.903328 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.1641616821289062
Epoch: 5, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.213498592376709
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.259 Vali Acc: 0.927 Test Loss: 0.259 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.239314317703247
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2018060684204102
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.749929428100586
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.8560526371002197
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3150684833526611
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6197333335876465
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.041376829147339
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.211672067642212
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1299216747283936
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0398890972137451
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8594882488250732
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7542486190795898
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8227858543395996
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8009965419769287
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3914549350738525
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 36990745
model size : 155.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7357304096221924
Epoch: 1, Steps: 18 | Train Loss: 3.272 Vali Loss: 3.018 Vali Acc: 0.183 Test Loss: 3.018 Test Acc: 0.183
Validation loss decreased (inf --> -0.183303).  Saving model ...
Epoch: 2 cost time: 0.8635163307189941
Epoch: 2, Steps: 18 | Train Loss: 2.848 Vali Loss: 2.408 Vali Acc: 0.700 Test Loss: 2.408 Test Acc: 0.700
Validation loss decreased (-0.183303 --> -0.699976).  Saving model ...
Epoch: 3 cost time: 1.054769515991211
Epoch: 3, Steps: 18 | Train Loss: 2.039 Vali Loss: 1.140 Vali Acc: 0.910 Test Loss: 1.140 Test Acc: 0.910
Validation loss decreased (-0.699976 --> -0.909989).  Saving model ...
Epoch: 4 cost time: 1.150209665298462
Epoch: 4, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.285 Vali Acc: 0.953 Test Loss: 0.285 Test Acc: 0.953
Validation loss decreased (-0.909989 --> -0.953330).  Saving model ...
Epoch: 5 cost time: 1.2061231136322021
Epoch: 5, Steps: 18 | Train Loss: 0.219 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.953330 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.4547362327575684
Epoch: 6, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2945191860198975
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2134544849395752
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.887040376663208
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9482612609863281
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9957849979400635
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0431063175201416
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1657555103302002
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1281116008758545
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0606303215026855
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.163393497467041
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.100128412246704
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8941030502319336
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9376544952392578
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.429443597793579
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.316080093383789
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.4823410511016846
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1818983554840088
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1513934135437012
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0953185558319092
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9876499176025391
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.883983850479126
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.425853967666626
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0937068462371826
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1634330749511719
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9257833957672119
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 36824857
model size : 155.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.368791818618774
Epoch: 1, Steps: 18 | Train Loss: 3.245 Vali Loss: 2.769 Vali Acc: 0.463 Test Loss: 2.769 Test Acc: 0.463
Validation loss decreased (inf --> -0.463306).  Saving model ...
Epoch: 2 cost time: 2.1085102558135986
Epoch: 2, Steps: 18 | Train Loss: 2.332 Vali Loss: 1.435 Vali Acc: 0.830 Test Loss: 1.435 Test Acc: 0.830
Validation loss decreased (-0.463306 --> -0.829986).  Saving model ...
Epoch: 3 cost time: 2.438382625579834
Epoch: 3, Steps: 18 | Train Loss: 0.902 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
Validation loss decreased (-0.829986 --> -0.936664).  Saving model ...
Epoch: 4 cost time: 2.2537078857421875
Epoch: 4, Steps: 18 | Train Loss: 0.156 Vali Loss: 0.303 Vali Acc: 0.913 Test Loss: 0.303 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7279086112976074
Epoch: 5, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.144 Vali Acc: 0.953 Test Loss: 0.144 Test Acc: 0.953
Validation loss decreased (-0.936664 --> -0.953332).  Saving model ...
Epoch: 6 cost time: 2.365546703338623
Epoch: 6, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.7651588916778564
Epoch: 7, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.819748878479004
Epoch: 8, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.886298656463623
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6748619079589844
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6013457775115967
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.623002052307129
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7715699672698975
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.8705828189849854
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.9028961658477783
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1541059017181396
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4578359127044678
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6246273517608643
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2622056007385254
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.492814779281616
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.388554096221924
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2285101413726807
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8528528213500977
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5256593227386475
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37218841
model size : 156.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2571544647216797
Epoch: 1, Steps: 18 | Train Loss: 3.237 Vali Loss: 2.905 Vali Acc: 0.357 Test Loss: 2.905 Test Acc: 0.357
Validation loss decreased (inf --> -0.356638).  Saving model ...
Epoch: 2 cost time: 1.4764816761016846
Epoch: 2, Steps: 18 | Train Loss: 2.622 Vali Loss: 1.999 Vali Acc: 0.827 Test Loss: 1.999 Test Acc: 0.827
Validation loss decreased (-0.356638 --> -0.826647).  Saving model ...
Epoch: 3 cost time: 1.3139276504516602
Epoch: 3, Steps: 18 | Train Loss: 1.426 Vali Loss: 0.456 Vali Acc: 0.953 Test Loss: 0.456 Test Acc: 0.953
Validation loss decreased (-0.826647 --> -0.953329).  Saving model ...
Epoch: 4 cost time: 1.2990615367889404
Epoch: 4, Steps: 18 | Train Loss: 0.338 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2387280464172363
Epoch: 5, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
Validation loss decreased (-0.953329 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.246269702911377
Epoch: 6, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2425472736358643
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.4290118217468262
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.5375862121582031
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.7993383407592773
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4679267406463623
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0743868350982666
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3291685581207275
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7028238773345947
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.624962568283081
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4264569282531738
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5704460144042969
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8508713245391846
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9612336158752441
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.733863115310669
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5380768775939941
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3602797985076904
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3005197048187256
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1962149143218994
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2294707298278809
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.2680315971374512
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8171827793121338
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4575068950653076
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7846417427062988
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5600342750549316
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5615348815917969
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.459136724472046
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.581660509109497
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5426428318023682
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.625594139099121
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 36990745
model size : 155.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.793288469314575
Epoch: 1, Steps: 18 | Train Loss: 3.274 Vali Loss: 3.017 Vali Acc: 0.247 Test Loss: 3.017 Test Acc: 0.247
Validation loss decreased (inf --> -0.246636).  Saving model ...
Epoch: 2 cost time: 1.2388317584991455
Epoch: 2, Steps: 18 | Train Loss: 2.844 Vali Loss: 2.410 Vali Acc: 0.693 Test Loss: 2.410 Test Acc: 0.693
Validation loss decreased (-0.246636 --> -0.693309).  Saving model ...
Epoch: 3 cost time: 1.3459255695343018
Epoch: 3, Steps: 18 | Train Loss: 2.001 Vali Loss: 1.126 Vali Acc: 0.890 Test Loss: 1.126 Test Acc: 0.890
Validation loss decreased (-0.693309 --> -0.889989).  Saving model ...
Epoch: 4 cost time: 1.0413622856140137
Epoch: 4, Steps: 18 | Train Loss: 0.856 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
Validation loss decreased (-0.889989 --> -0.956664).  Saving model ...
Epoch: 5 cost time: 1.240234375
Epoch: 5, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.201 Vali Acc: 0.940 Test Loss: 0.201 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0021095275878906
Epoch: 6, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.4513728618621826
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.304842233657837
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4458699226379395
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.4312553405761719
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9627184867858887
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9388399124145508
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.264120101928711
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2371468544006348
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.4786896705627441
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9798097610473633
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1636722087860107
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.160642385482788
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9199750423431396
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8378951549530029
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0737929344177246
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.1564762592315674
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.3041234016418457
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0501041412353516
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0883018970489502
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.1693930625915527
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.1039972305297852
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.32955002784729
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.2684640884399414
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1591670513153076
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.072861909866333
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0827839374542236
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9713618755340576
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9003446102142334
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0672659873962402
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1024272441864014
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0174481868743896
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9048480987548828
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 36845593
model size : 155.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.706089973449707
Epoch: 1, Steps: 18 | Train Loss: 3.293 Vali Loss: 2.835 Vali Acc: 0.457 Test Loss: 2.835 Test Acc: 0.457
Validation loss decreased (inf --> -0.456638).  Saving model ...
Epoch: 2 cost time: 1.5125603675842285
Epoch: 2, Steps: 18 | Train Loss: 2.447 Vali Loss: 1.624 Vali Acc: 0.870 Test Loss: 1.624 Test Acc: 0.870
Validation loss decreased (-0.456638 --> -0.869984).  Saving model ...
Epoch: 3 cost time: 0.8657417297363281
Epoch: 3, Steps: 18 | Train Loss: 0.945 Vali Loss: 0.326 Vali Acc: 0.927 Test Loss: 0.326 Test Acc: 0.927
Validation loss decreased (-0.869984 --> -0.926663).  Saving model ...
Epoch: 4 cost time: 2.033989429473877
Epoch: 4, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.926663 --> -0.929998).  Saving model ...
Epoch: 5 cost time: 1.920067548751831
Epoch: 5, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.929998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.9425668716430664
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8192579746246338
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2259886264801025
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0746405124664307
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.84157395362854
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.347510576248169
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9599025249481201
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.7490243911743164
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3344132900238037
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.043804168701172
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.054354429244995
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.75065279006958
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3577234745025635
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.171799659729004
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.720165729522705
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.523071527481079
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8081204891204834
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.652467966079712
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.5935420989990234
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.823765754699707
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.91756272315979
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 2.2967069149017334
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 2.110574960708618
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4920244216918945
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.530210018157959
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5962226390838623
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.032790422439575
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7605714797973633
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.531006097793579
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0069034099578857
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.2543349266052246
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3803679943084717
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 37177369
model size : 156.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.330451011657715
Epoch: 1, Steps: 18 | Train Loss: 3.292 Vali Loss: 2.933 Vali Acc: 0.373 Test Loss: 2.933 Test Acc: 0.373
Validation loss decreased (inf --> -0.373304).  Saving model ...
Epoch: 2 cost time: 1.2514784336090088
Epoch: 2, Steps: 18 | Train Loss: 2.707 Vali Loss: 2.132 Vali Acc: 0.810 Test Loss: 2.132 Test Acc: 0.810
Validation loss decreased (-0.373304 --> -0.809979).  Saving model ...
Epoch: 3 cost time: 1.3201897144317627
Epoch: 3, Steps: 18 | Train Loss: 1.588 Vali Loss: 0.688 Vali Acc: 0.913 Test Loss: 0.688 Test Acc: 0.913
Validation loss decreased (-0.809979 --> -0.913326).  Saving model ...
Epoch: 4 cost time: 1.757725715637207
Epoch: 4, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
Validation loss decreased (-0.913326 --> -0.926664).  Saving model ...
Epoch: 5 cost time: 1.4811086654663086
Epoch: 5, Steps: 18 | Train Loss: 0.149 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.926664 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.5120697021484375
Epoch: 6, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.4011826515197754
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.3239436149597168
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.119448184967041
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0783236026763916
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.537358283996582
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.412796974182129
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.529189109802246
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3820273876190186
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2900071144104004
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1102614402770996
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5052804946899414
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.4415853023529053
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9748103618621826
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.166217565536499
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1748337745666504
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0031979084014893
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4739267826080322
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1165008544921875
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.1739654541015625
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8652307987213135
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9332563877105713
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2573463916778564
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1573243141174316
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1836638450622559
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2249128818511963
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7110271453857422
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.4265286922454834
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2117300033569336
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.1841280460357666
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.1598985195159912
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.042656660079956
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.998361349105835
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.0212352275848389
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.3218872547149658
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5149548053741455
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3742365837097168
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.389009714126587
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1077237129211426
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0671637058258057
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2234015464782715
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0196926593780518
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.6332316398620605
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.0192632675170898
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 36990745
model size : 155.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1872966289520264
Epoch: 1, Steps: 18 | Train Loss: 3.328 Vali Loss: 3.068 Vali Acc: 0.210 Test Loss: 3.068 Test Acc: 0.210
Validation loss decreased (inf --> -0.209969).  Saving model ...
Epoch: 2 cost time: 0.873342752456665
Epoch: 2, Steps: 18 | Train Loss: 2.900 Vali Loss: 2.532 Vali Acc: 0.713 Test Loss: 2.532 Test Acc: 0.713
Validation loss decreased (-0.209969 --> -0.713308).  Saving model ...
Epoch: 3 cost time: 0.9217383861541748
Epoch: 3, Steps: 18 | Train Loss: 2.245 Vali Loss: 1.515 Vali Acc: 0.887 Test Loss: 1.515 Test Acc: 0.887
Validation loss decreased (-0.713308 --> -0.886652).  Saving model ...
Epoch: 4 cost time: 0.972498893737793
Epoch: 4, Steps: 18 | Train Loss: 1.163 Vali Loss: 0.475 Vali Acc: 0.943 Test Loss: 0.475 Test Acc: 0.943
Validation loss decreased (-0.886652 --> -0.943329).  Saving model ...
Epoch: 5 cost time: 0.8684988021850586
Epoch: 5, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
Validation loss decreased (-0.943329 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 0.7896449565887451
Epoch: 6, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.8193638324737549
Epoch: 7, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9976158142089844
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9803588390350342
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.022205114364624
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.915316104888916
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.127572774887085
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0194623470306396
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9378154277801514
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9118516445159912
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0926451683044434
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0367271900177002
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9911105632781982
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9506828784942627
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0018730163574219
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2740576267242432
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.9605617523193359
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0081579685211182
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0840237140655518
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8597238063812256
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8586421012878418
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0502843856811523
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.106010913848877
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9955458641052246
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0589799880981445
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9974191188812256
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0601739883422852
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9507226943969727
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 36866329
model size : 155.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.605813980102539
Epoch: 1, Steps: 18 | Train Loss: 3.238 Vali Loss: 2.831 Vali Acc: 0.373 Test Loss: 2.831 Test Acc: 0.373
Validation loss decreased (inf --> -0.373305).  Saving model ...
Epoch: 2 cost time: 1.513415813446045
Epoch: 2, Steps: 18 | Train Loss: 2.414 Vali Loss: 1.481 Vali Acc: 0.877 Test Loss: 1.481 Test Acc: 0.877
Validation loss decreased (-0.373305 --> -0.876652).  Saving model ...
Epoch: 3 cost time: 1.7168149948120117
Epoch: 3, Steps: 18 | Train Loss: 0.922 Vali Loss: 0.307 Vali Acc: 0.927 Test Loss: 0.307 Test Acc: 0.927
Validation loss decreased (-0.876652 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 2.094460964202881
Epoch: 4, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
Validation loss decreased (-0.926664 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 1.4758141040802002
Epoch: 5, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5704905986785889
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.370190143585205
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4265077114105225
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.476515531539917
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.5411791801452637
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.7465832233428955
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3683295249938965
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.804384708404541
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.812861442565918
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.4836006164550781
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4147019386291504
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9132511615753174
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.748783826828003
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9407391548156738
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.857851266860962
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2875542640686035
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5525190830230713
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6544122695922852
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2211360931396484
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 37239577
model size : 156.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2202775478363037
Epoch: 1, Steps: 18 | Train Loss: 3.312 Vali Loss: 3.034 Vali Acc: 0.130 Test Loss: 3.034 Test Acc: 0.130
Validation loss decreased (inf --> -0.129970).  Saving model ...
Epoch: 2 cost time: 1.145477533340454
Epoch: 2, Steps: 18 | Train Loss: 2.772 Vali Loss: 2.279 Vali Acc: 0.740 Test Loss: 2.279 Test Acc: 0.740
Validation loss decreased (-0.129970 --> -0.739977).  Saving model ...
Epoch: 3 cost time: 1.5065133571624756
Epoch: 3, Steps: 18 | Train Loss: 1.724 Vali Loss: 0.764 Vali Acc: 0.903 Test Loss: 0.764 Test Acc: 0.903
Validation loss decreased (-0.739977 --> -0.903326).  Saving model ...
Epoch: 4 cost time: 1.2432303428649902
Epoch: 4, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.903326 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 1.2575328350067139
Epoch: 5, Steps: 18 | Train Loss: 0.149 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.5374729633331299
Epoch: 6, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4387898445129395
Epoch: 7, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2646312713623047
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.06485915184021
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9656322002410889
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 1.1771118640899658
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0319995880126953
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.967 Test Loss: 0.088 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1152565479278564
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1058640480041504
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.967 Test Loss: 0.088 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.159501552581787
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0633049011230469
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.963 Test Loss: 0.103 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2153205871582031
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1082148551940918
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.214580774307251
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5177834033966064
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37032217
model size : 155.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.486459255218506
Epoch: 1, Steps: 18 | Train Loss: 3.287 Vali Loss: 3.025 Vali Acc: 0.183 Test Loss: 3.025 Test Acc: 0.183
Validation loss decreased (inf --> -0.183303).  Saving model ...
Epoch: 2 cost time: 1.1774628162384033
Epoch: 2, Steps: 18 | Train Loss: 2.829 Vali Loss: 2.418 Vali Acc: 0.653 Test Loss: 2.418 Test Acc: 0.653
Validation loss decreased (-0.183303 --> -0.653309).  Saving model ...
Epoch: 3 cost time: 1.0587348937988281
Epoch: 3, Steps: 18 | Train Loss: 2.101 Vali Loss: 1.267 Vali Acc: 0.913 Test Loss: 1.267 Test Acc: 0.913
Validation loss decreased (-0.653309 --> -0.913321).  Saving model ...
Epoch: 4 cost time: 1.0140812397003174
Epoch: 4, Steps: 18 | Train Loss: 1.005 Vali Loss: 0.387 Vali Acc: 0.963 Test Loss: 0.387 Test Acc: 0.963
Validation loss decreased (-0.913321 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 0.9701623916625977
Epoch: 5, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9500129222869873
Epoch: 6, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.963329 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8729007244110107
Epoch: 7, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0684442520141602
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8121263980865479
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9296600818634033
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.1620051860809326
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8287899494171143
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0227627754211426
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.872612714767456
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9042308330535889
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.794029951095581
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8163988590240479
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0167622566223145
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8172976970672607
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9334096908569336
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9165501594543457
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9436895847320557
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0048558712005615
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8912918567657471
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0144848823547363
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9471931457519531
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.1815848350524902
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9830038547515869
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8468499183654785
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9593491554260254
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0172345638275146
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1064655780792236
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9188592433929443
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0170972347259521
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8839874267578125
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0405938625335693
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 36928537
model size : 155.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.521625518798828
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 2.850 Vali Acc: 0.433 Test Loss: 2.850 Test Acc: 0.433
Validation loss decreased (inf --> -0.433305).  Saving model ...
Epoch: 2 cost time: 0.9828746318817139
Epoch: 2, Steps: 18 | Train Loss: 2.517 Vali Loss: 1.678 Vali Acc: 0.793 Test Loss: 1.678 Test Acc: 0.793
Validation loss decreased (-0.433305 --> -0.793317).  Saving model ...
Epoch: 3 cost time: 0.7350397109985352
Epoch: 3, Steps: 18 | Train Loss: 1.127 Vali Loss: 0.498 Vali Acc: 0.897 Test Loss: 0.498 Test Acc: 0.897
Validation loss decreased (-0.793317 --> -0.896662).  Saving model ...
Epoch: 4 cost time: 1.3186588287353516
Epoch: 4, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.230 Vali Acc: 0.940 Test Loss: 0.230 Test Acc: 0.940
Validation loss decreased (-0.896662 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 1.1612927913665771
Epoch: 5, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
Validation loss decreased (-0.939998 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 1.2745029926300049
Epoch: 6, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.947 Test Loss: 0.190 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5744585990905762
Epoch: 7, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.3344449996948242
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.149801254272461
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.1451327800750732
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0461652278900146
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4132356643676758
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8957507610321045
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6897878646850586
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.238813877105713
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4061360359191895
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0404198169708252
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3641903400421143
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9774582386016846
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2534170150756836
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 37218841
model size : 156.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5857183933258057
Epoch: 1, Steps: 18 | Train Loss: 3.302 Vali Loss: 3.013 Vali Acc: 0.207 Test Loss: 3.013 Test Acc: 0.207
Validation loss decreased (inf --> -0.206637).  Saving model ...
Epoch: 2 cost time: 0.9480464458465576
Epoch: 2, Steps: 18 | Train Loss: 2.802 Vali Loss: 2.278 Vali Acc: 0.760 Test Loss: 2.278 Test Acc: 0.760
Validation loss decreased (-0.206637 --> -0.759977).  Saving model ...
Epoch: 3 cost time: 0.9131495952606201
Epoch: 3, Steps: 18 | Train Loss: 1.903 Vali Loss: 1.001 Vali Acc: 0.870 Test Loss: 1.001 Test Acc: 0.870
Validation loss decreased (-0.759977 --> -0.869990).  Saving model ...
Epoch: 4 cost time: 1.049506664276123
Epoch: 4, Steps: 18 | Train Loss: 0.700 Vali Loss: 0.324 Vali Acc: 0.943 Test Loss: 0.324 Test Acc: 0.943
Validation loss decreased (-0.869990 --> -0.943330).  Saving model ...
Epoch: 5 cost time: 1.154998779296875
Epoch: 5, Steps: 18 | Train Loss: 0.247 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
Validation loss decreased (-0.943330 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.9285786151885986
Epoch: 6, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.028327226638794
Epoch: 7, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.9638762474060059
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.1902477741241455
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9224104881286621
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9695708751678467
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9286983013153076
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8289244174957275
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8630235195159912
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2621090412139893
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8803908824920654
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9857707023620605
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9762229919433594
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2687644958496094
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9798815250396729
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 37073689
model size : 156.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.281799077987671
Epoch: 1, Steps: 18 | Train Loss: 3.376 Vali Loss: 3.132 Vali Acc: 0.130 Test Loss: 3.132 Test Acc: 0.130
Validation loss decreased (inf --> -0.129969).  Saving model ...
Epoch: 2 cost time: 0.9555478096008301
Epoch: 2, Steps: 18 | Train Loss: 2.976 Vali Loss: 2.609 Vali Acc: 0.577 Test Loss: 2.609 Test Acc: 0.577
Validation loss decreased (-0.129969 --> -0.576641).  Saving model ...
Epoch: 3 cost time: 1.0573902130126953
Epoch: 3, Steps: 18 | Train Loss: 2.373 Vali Loss: 1.705 Vali Acc: 0.800 Test Loss: 1.705 Test Acc: 0.800
Validation loss decreased (-0.576641 --> -0.799983).  Saving model ...
Epoch: 4 cost time: 0.8954803943634033
Epoch: 4, Steps: 18 | Train Loss: 1.393 Vali Loss: 0.710 Vali Acc: 0.913 Test Loss: 0.710 Test Acc: 0.913
Validation loss decreased (-0.799983 --> -0.913326).  Saving model ...
Epoch: 5 cost time: 0.9541749954223633
Epoch: 5, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.275 Vali Acc: 0.970 Test Loss: 0.275 Test Acc: 0.970
Validation loss decreased (-0.913326 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 0.957939624786377
Epoch: 6, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.8872156143188477
Epoch: 7, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.7791347503662109
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0429420471191406
Epoch: 9, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9933998584747314
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8389756679534912
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7520010471343994
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7913312911987305
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7735779285430908
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8141951560974121
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7838687896728516
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9332685470581055
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2960827350616455
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8645009994506836
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8670847415924072
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 36990745
model size : 155.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8324103355407715
Epoch: 1, Steps: 18 | Train Loss: 3.170 Vali Loss: 2.254 Vali Acc: 0.510 Test Loss: 2.254 Test Acc: 0.510
Validation loss decreased (inf --> -0.509977).  Saving model ...
Epoch: 2 cost time: 2.6517012119293213
Epoch: 2, Steps: 18 | Train Loss: 1.463 Vali Loss: 0.615 Vali Acc: 0.897 Test Loss: 0.615 Test Acc: 0.897
Validation loss decreased (-0.509977 --> -0.896661).  Saving model ...
Epoch: 3 cost time: 1.628183126449585
Epoch: 3, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
Validation loss decreased (-0.896661 --> -0.903331).  Saving model ...
Epoch: 4 cost time: 1.906064748764038
Epoch: 4, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.903331 --> -0.936664).  Saving model ...
Epoch: 5 cost time: 1.7642717361450195
Epoch: 5, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6160032749176025
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.277 Vali Acc: 0.940 Test Loss: 0.277 Test Acc: 0.940
Validation loss decreased (-0.936664 --> -0.939997).  Saving model ...
Epoch: 7 cost time: 1.9296247959136963
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.947 Test Loss: 0.260 Test Acc: 0.947
Validation loss decreased (-0.939997 --> -0.946664).  Saving model ...
Epoch: 8 cost time: 1.9881093502044678
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
Validation loss decreased (-0.946664 --> -0.953331).  Saving model ...
Epoch: 9 cost time: 2.8197195529937744
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.899613380432129
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 1.7146761417388916
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.940 Test Loss: 0.329 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.936288833618164
Epoch: 12, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.324 Vali Acc: 0.953 Test Loss: 0.324 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7311344146728516
Epoch: 13, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.035 Vali Acc: 0.863 Test Loss: 1.035 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6544907093048096
Epoch: 14, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.997 Vali Acc: 0.807 Test Loss: 1.997 Test Acc: 0.807
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1489546298980713
Epoch: 15, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.794 Vali Acc: 0.913 Test Loss: 0.794 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5132031440734863
Epoch: 16, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.906 Vali Acc: 0.847 Test Loss: 1.906 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.524064064025879
Epoch: 17, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.936 Vali Acc: 0.903 Test Loss: 0.936 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5845527648925781
Epoch: 18, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.157 Vali Acc: 0.883 Test Loss: 1.157 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5997967720031738
Epoch: 19, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.925 Vali Acc: 0.933 Test Loss: 0.925 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9705495834350586
Epoch: 20, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.082 Vali Acc: 0.917 Test Loss: 1.082 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 30794521
model size : 132.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7896883487701416
Epoch: 1, Steps: 18 | Train Loss: 3.189 Vali Loss: 2.483 Vali Acc: 0.523 Test Loss: 2.483 Test Acc: 0.523
Validation loss decreased (inf --> -0.523309).  Saving model ...
Epoch: 2 cost time: 1.2396438121795654
Epoch: 2, Steps: 18 | Train Loss: 1.867 Vali Loss: 0.909 Vali Acc: 0.903 Test Loss: 0.909 Test Acc: 0.903
Validation loss decreased (-0.523309 --> -0.903324).  Saving model ...
Epoch: 3 cost time: 1.2595524787902832
Epoch: 3, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.283 Vali Acc: 0.920 Test Loss: 0.283 Test Acc: 0.920
Validation loss decreased (-0.903324 --> -0.919997).  Saving model ...
Epoch: 4 cost time: 1.845062255859375
Epoch: 4, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.216 Vali Acc: 0.940 Test Loss: 0.216 Test Acc: 0.940
Validation loss decreased (-0.919997 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 1.1599478721618652
Epoch: 5, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.279 Vali Acc: 0.923 Test Loss: 0.279 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3749010562896729
Epoch: 6, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.939998 --> -0.949998).  Saving model ...
Epoch: 7 cost time: 1.7671830654144287
Epoch: 7, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 8 cost time: 2.030771493911743
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 9 cost time: 1.9574871063232422
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 2.041060209274292
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.649951457977295
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 1.5862860679626465
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 1.4487504959106445
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 1.9599149227142334
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6412324905395508
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.823585033416748
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0884132385253906
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5769977569580078
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8584041595458984
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 1.6695032119750977
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.536670207977295
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.0887775421142578
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9076533317565918
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6187243461608887
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.922907829284668
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.194308042526245
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.8030421733856201
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 2.285419225692749
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8026726245880127
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.920668363571167
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 1.4850966930389404
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.8955965042114258
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.7269675731658936
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2425034046173096
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9261226654052734
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8130254745483398
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.41782546043396
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.377868175506592
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 1.9811506271362305
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 1.6142818927764893
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 1.2471272945404053
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 1.5710406303405762
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9815678596496582
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 44 cost time: 2.3214104175567627
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 45 cost time: 1.7430424690246582
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6905338764190674
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.3295724391937256
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 48 cost time: 2.3342273235321045
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 49 cost time: 1.602637767791748
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 50 cost time: 2.4947750568389893
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 30317593
model size : 130.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.157792329788208
Epoch: 1, Steps: 18 | Train Loss: 3.201 Vali Loss: 2.731 Vali Acc: 0.537 Test Loss: 2.731 Test Acc: 0.537
Validation loss decreased (inf --> -0.536639).  Saving model ...
Epoch: 2 cost time: 0.9013485908508301
Epoch: 2, Steps: 18 | Train Loss: 2.345 Vali Loss: 1.545 Vali Acc: 0.920 Test Loss: 1.545 Test Acc: 0.920
Validation loss decreased (-0.536639 --> -0.919985).  Saving model ...
Epoch: 3 cost time: 1.2712910175323486
Epoch: 3, Steps: 18 | Train Loss: 1.090 Vali Loss: 0.414 Vali Acc: 0.927 Test Loss: 0.414 Test Acc: 0.927
Validation loss decreased (-0.919985 --> -0.926663).  Saving model ...
Epoch: 4 cost time: 1.159560203552246
Epoch: 4, Steps: 18 | Train Loss: 0.277 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
Validation loss decreased (-0.926663 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 1.0704131126403809
Epoch: 5, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5721893310546875
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.943331 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 2.0674469470977783
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8125073909759521
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.4290943145751953
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3930690288543701
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.015050172805786
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.963 Test Loss: 0.113 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4618644714355469
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8874170780181885
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9304792881011963
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.963 Test Loss: 0.118 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9292914867401123
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9312119483947754
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2636163234710693
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7728159427642822
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3816723823547363
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29840665
model size : 128.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.2987072467803955
Epoch: 1, Steps: 18 | Train Loss: 3.174 Vali Loss: 2.427 Vali Acc: 0.547 Test Loss: 2.427 Test Acc: 0.547
Validation loss decreased (inf --> -0.546642).  Saving model ...
Epoch: 2 cost time: 2.669621706008911
Epoch: 2, Steps: 18 | Train Loss: 1.617 Vali Loss: 0.735 Vali Acc: 0.880 Test Loss: 0.735 Test Acc: 0.880
Validation loss decreased (-0.546642 --> -0.879993).  Saving model ...
Epoch: 3 cost time: 2.527499198913574
Epoch: 3, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.879993 --> -0.929998).  Saving model ...
Epoch: 4 cost time: 2.4501821994781494
Epoch: 4, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
Validation loss decreased (-0.929998 --> -0.933330).  Saving model ...
Epoch: 5 cost time: 1.9383721351623535
Epoch: 5, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8832018375396729
Epoch: 6, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.928973913192749
Epoch: 7, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.456 Vali Acc: 0.907 Test Loss: 0.456 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6731035709381104
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.534 Vali Acc: 0.903 Test Loss: 0.534 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3800156116485596
Epoch: 9, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.578 Vali Acc: 0.917 Test Loss: 0.578 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0918850898742676
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.933330 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 1.7865879535675049
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.508 Vali Acc: 0.927 Test Loss: 0.508 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8425183296203613
Epoch: 12, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.425 Vali Acc: 0.927 Test Loss: 0.425 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9821581840515137
Epoch: 13, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.476 Vali Acc: 0.947 Test Loss: 0.476 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.715609073638916
Epoch: 14, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.001 Vali Acc: 0.857 Test Loss: 1.001 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7511367797851562
Epoch: 15, Steps: 18 | Train Loss: 0.082 Vali Loss: 1.097 Vali Acc: 0.883 Test Loss: 1.097 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1274876594543457
Epoch: 16, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5151393413543701
Epoch: 17, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.493 Vali Acc: 0.947 Test Loss: 0.493 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4597489833831787
Epoch: 18, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.195 Vali Acc: 0.867 Test Loss: 1.195 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3446779251098633
Epoch: 19, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.824 Vali Acc: 0.920 Test Loss: 0.824 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.872495412826538
Epoch: 20, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.537 Vali Acc: 0.943 Test Loss: 0.537 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 30794521
model size : 132.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3812623023986816
Epoch: 1, Steps: 18 | Train Loss: 3.215 Vali Loss: 2.692 Vali Acc: 0.437 Test Loss: 2.692 Test Acc: 0.437
Validation loss decreased (inf --> -0.436640).  Saving model ...
Epoch: 2 cost time: 1.667905330657959
Epoch: 2, Steps: 18 | Train Loss: 2.224 Vali Loss: 1.356 Vali Acc: 0.857 Test Loss: 1.356 Test Acc: 0.857
Validation loss decreased (-0.436640 --> -0.856653).  Saving model ...
Epoch: 3 cost time: 1.0178554058074951
Epoch: 3, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.306 Vali Acc: 0.943 Test Loss: 0.306 Test Acc: 0.943
Validation loss decreased (-0.856653 --> -0.943330).  Saving model ...
Epoch: 4 cost time: 1.354921579360962
Epoch: 4, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.943330 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 1.4837043285369873
Epoch: 5, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7917351722717285
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.949998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 2.0867528915405273
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2672545909881592
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5158963203430176
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.124868631362915
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.3928093910217285
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.3766703605651855
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.1578147411346436
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3467745780944824
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.9076223373413086
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.1926929950714111
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2633051872253418
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3110039234161377
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4580414295196533
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.425356149673462
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8820900917053223
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8860135078430176
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5629136562347412
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7225465774536133
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.52142333984375
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.5893704891204834
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.481476068496704
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.008622884750366
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.7578399181365967
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.86055588722229
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4807941913604736
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.566908836364746
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.012556314468384
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.545849084854126
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.136657953262329
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1318631172180176
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.530712842941284
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6695187091827393
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.388322114944458
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 30089497
model size : 129.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.018676280975342
Epoch: 1, Steps: 18 | Train Loss: 3.284 Vali Loss: 2.852 Vali Acc: 0.390 Test Loss: 2.852 Test Acc: 0.390
Validation loss decreased (inf --> -0.389971).  Saving model ...
Epoch: 2 cost time: 1.3489995002746582
Epoch: 2, Steps: 18 | Train Loss: 2.550 Vali Loss: 1.936 Vali Acc: 0.830 Test Loss: 1.936 Test Acc: 0.830
Validation loss decreased (-0.389971 --> -0.829981).  Saving model ...
Epoch: 3 cost time: 1.0834944248199463
Epoch: 3, Steps: 18 | Train Loss: 1.408 Vali Loss: 0.611 Vali Acc: 0.913 Test Loss: 0.611 Test Acc: 0.913
Validation loss decreased (-0.829981 --> -0.913327).  Saving model ...
Epoch: 4 cost time: 0.6997599601745605
Epoch: 4, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.184 Vali Acc: 0.940 Test Loss: 0.184 Test Acc: 0.940
Validation loss decreased (-0.913327 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 1.6178243160247803
Epoch: 5, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.939998 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.9209485054016113
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.856677770614624
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.8435747623443604
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.9701135158538818
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8058710098266602
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.459876298904419
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.896104335784912
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 2.3759145736694336
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.5791420936584473
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1821129322052002
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.681851863861084
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.7022757530212402
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 2.100996732711792
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.6257636547088623
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2563748359680176
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0944831371307373
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3938939571380615
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8515448570251465
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.185689687728882
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.987513542175293
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.5142362117767334
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7807273864746094
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6982152462005615
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 29778457
model size : 128.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.1122212409973145
Epoch: 1, Steps: 18 | Train Loss: 3.248 Vali Loss: 2.384 Vali Acc: 0.433 Test Loss: 2.384 Test Acc: 0.433
Validation loss decreased (inf --> -0.433309).  Saving model ...
Epoch: 2 cost time: 3.2860732078552246
Epoch: 2, Steps: 18 | Train Loss: 1.700 Vali Loss: 0.783 Vali Acc: 0.857 Test Loss: 0.783 Test Acc: 0.857
Validation loss decreased (-0.433309 --> -0.856659).  Saving model ...
Epoch: 3 cost time: 2.64951753616333
Epoch: 3, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.304 Vali Acc: 0.920 Test Loss: 0.304 Test Acc: 0.920
Validation loss decreased (-0.856659 --> -0.919997).  Saving model ...
Epoch: 4 cost time: 3.0023486614227295
Epoch: 4, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.919997 --> -0.933331).  Saving model ...
Epoch: 5 cost time: 3.286421775817871
Epoch: 5, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.256 Vali Acc: 0.960 Test Loss: 0.256 Test Acc: 0.960
Validation loss decreased (-0.933331 --> -0.959997).  Saving model ...
Epoch: 6 cost time: 3.251842498779297
Epoch: 6, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.315 Vali Acc: 0.940 Test Loss: 0.315 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8020248413085938
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0887882709503174
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.942 Vali Acc: 0.897 Test Loss: 0.942 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0352706909179688
Epoch: 9, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.911 Vali Acc: 0.880 Test Loss: 0.911 Test Acc: 0.880
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.598989486694336
Epoch: 10, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.253 Vali Acc: 0.960 Test Loss: 0.253 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959997).  Saving model ...
Epoch: 11 cost time: 2.5054306983947754
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1968698501586914
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.343 Vali Acc: 0.957 Test Loss: 0.343 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.923973798751831
Epoch: 13, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.620 Vali Acc: 0.910 Test Loss: 0.620 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6774346828460693
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3653604984283447
Epoch: 15, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.761 Vali Acc: 0.913 Test Loss: 0.761 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3459179401397705
Epoch: 16, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.452 Vali Acc: 0.933 Test Loss: 0.452 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5574982166290283
Epoch: 17, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.300 Vali Acc: 0.957 Test Loss: 0.300 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3904948234558105
Epoch: 18, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.449 Vali Acc: 0.940 Test Loss: 0.449 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.263690710067749
Epoch: 19, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.883 Vali Acc: 0.913 Test Loss: 0.883 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.186098575592041
Epoch: 20, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.764 Vali Acc: 0.933 Test Loss: 0.764 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 30815257
model size : 132.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6863157749176025
Epoch: 1, Steps: 18 | Train Loss: 3.195 Vali Loss: 2.672 Vali Acc: 0.410 Test Loss: 2.672 Test Acc: 0.410
Validation loss decreased (inf --> -0.409973).  Saving model ...
Epoch: 2 cost time: 2.8715875148773193
Epoch: 2, Steps: 18 | Train Loss: 2.234 Vali Loss: 1.349 Vali Acc: 0.783 Test Loss: 1.349 Test Acc: 0.783
Validation loss decreased (-0.409973 --> -0.783320).  Saving model ...
Epoch: 3 cost time: 1.4754784107208252
Epoch: 3, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
Validation loss decreased (-0.783320 --> -0.919997).  Saving model ...
Epoch: 4 cost time: 2.0459845066070557
Epoch: 4, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.919997 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 2.913703680038452
Epoch: 5, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 2.745359420776367
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4391238689422607
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6625585556030273
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 2.7590200901031494
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.1611740589141846
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.372 Vali Acc: 0.910 Test Loss: 0.372 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2041685581207275
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.977 Test Loss: 0.186 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8390352725982666
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.287 Vali Acc: 0.940 Test Loss: 0.287 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6773722171783447
Epoch: 13, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.521005630493164
Epoch: 14, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5056769847869873
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.964447259902954
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.542924642562866
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7322921752929688
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8316724300384521
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 30110233
model size : 129.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.132250785827637
Epoch: 1, Steps: 18 | Train Loss: 3.236 Vali Loss: 2.862 Vali Acc: 0.367 Test Loss: 2.862 Test Acc: 0.367
Validation loss decreased (inf --> -0.366638).  Saving model ...
Epoch: 2 cost time: 1.6336450576782227
Epoch: 2, Steps: 18 | Train Loss: 2.585 Vali Loss: 1.919 Vali Acc: 0.880 Test Loss: 1.919 Test Acc: 0.880
Validation loss decreased (-0.366638 --> -0.879981).  Saving model ...
Epoch: 3 cost time: 2.170769453048706
Epoch: 3, Steps: 18 | Train Loss: 1.353 Vali Loss: 0.536 Vali Acc: 0.937 Test Loss: 0.536 Test Acc: 0.937
Validation loss decreased (-0.879981 --> -0.936661).  Saving model ...
Epoch: 4 cost time: 1.9778976440429688
Epoch: 4, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
Validation loss decreased (-0.936661 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 2.2413458824157715
Epoch: 5, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.176 Vali Acc: 0.940 Test Loss: 0.176 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.635558605194092
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.943331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 2.390329599380493
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.230675220489502
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.174764394760132
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.0017011165618896
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.7606420516967773
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.6906216144561768
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3036465644836426
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.363922595977783
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5696873664855957
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.1524291038513184
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.93666410446167
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.249099016189575
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6593575477600098
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.463430404663086
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2697203159332275
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1983349323272705
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.6217689514160156
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1984903812408447
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.126061201095581
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.169292688369751
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3606162071228027
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7896897792816162
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3208236694335938
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6517059803009033
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6813058853149414
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1674885749816895
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29757721
model size : 128.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7450311183929443
Epoch: 1, Steps: 18 | Train Loss: 3.175 Vali Loss: 2.497 Vali Acc: 0.467 Test Loss: 2.497 Test Acc: 0.467
Validation loss decreased (inf --> -0.466642).  Saving model ...
Epoch: 2 cost time: 2.698687791824341
Epoch: 2, Steps: 18 | Train Loss: 1.860 Vali Loss: 0.993 Vali Acc: 0.843 Test Loss: 0.993 Test Acc: 0.843
Validation loss decreased (-0.466642 --> -0.843323).  Saving model ...
Epoch: 3 cost time: 2.6079213619232178
Epoch: 3, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.843323 --> -0.933331).  Saving model ...
Epoch: 4 cost time: 1.9197375774383545
Epoch: 4, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7193470001220703
Epoch: 5, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949998).  Saving model ...
Epoch: 6 cost time: 2.155761241912842
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.949998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 2.3367624282836914
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.943 Test Loss: 0.230 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9967882633209229
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2730767726898193
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8807103633880615
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5447874069213867
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.977 Test Loss: 0.199 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.531484842300415
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.977 Test Loss: 0.187 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.296335220336914
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.980 Test Loss: 0.178 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 14 cost time: 1.8628084659576416
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 15 cost time: 1.926095724105835
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 16 cost time: 1.6505100727081299
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 17 cost time: 1.3673255443572998
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.980 Test Loss: 0.170 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 18 cost time: 1.6767551898956299
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 19 cost time: 2.177807331085205
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 20 cost time: 1.4924883842468262
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 21 cost time: 1.7607319355010986
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 22 cost time: 1.500239610671997
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 23 cost time: 1.6242554187774658
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 24 cost time: 2.2428016662597656
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 25 cost time: 2.4664158821105957
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.980 Test Loss: 0.163 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 26 cost time: 1.5236313343048096
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 27 cost time: 1.2990117073059082
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.980 Test Loss: 0.160 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 28 cost time: 1.8313112258911133
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 29 cost time: 1.682748794555664
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 30 cost time: 2.3548760414123535
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 31 cost time: 2.412087917327881
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 32 cost time: 2.429185152053833
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 33 cost time: 1.8655502796173096
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 34 cost time: 1.6852009296417236
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 35 cost time: 1.4868402481079102
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 36 cost time: 1.974806785583496
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1824967861175537
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.527259349822998
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 39 cost time: 1.1505446434020996
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 40 cost time: 1.7243456840515137
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 41 cost time: 2.150193691253662
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 42 cost time: 2.2588791847229004
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 43 cost time: 1.6890172958374023
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 44 cost time: 1.9010028839111328
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 45 cost time: 1.686086893081665
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 46 cost time: 2.318894147872925
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 47 cost time: 2.24025821685791
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8200898170471191
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 49 cost time: 2.4542410373687744
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 50 cost time: 2.0492734909057617
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 30359065
model size : 130.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.979717254638672
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 2.658 Vali Acc: 0.447 Test Loss: 2.658 Test Acc: 0.447
Validation loss decreased (inf --> -0.446640).  Saving model ...
Epoch: 2 cost time: 1.3129312992095947
Epoch: 2, Steps: 18 | Train Loss: 2.216 Vali Loss: 1.312 Vali Acc: 0.907 Test Loss: 1.312 Test Acc: 0.907
Validation loss decreased (-0.446640 --> -0.906654).  Saving model ...
Epoch: 3 cost time: 2.307081460952759
Epoch: 3, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.283 Vali Acc: 0.953 Test Loss: 0.283 Test Acc: 0.953
Validation loss decreased (-0.906654 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 1.638638973236084
Epoch: 4, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 1.5764882564544678
Epoch: 5, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.4854905605316162
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1763653755187988
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.2946789264678955
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9872879981994629
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2364692687988281
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.823549509048462
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.544795274734497
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4226436614990234
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.4814212322235107
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9696104526519775
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4751431941986084
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6338510513305664
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.1285006999969482
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1353716850280762
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1364295482635498
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.872516393661499
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5459892749786377
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.649137258529663
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.014427423477173
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1737215518951416
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0911295413970947
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9800193309783936
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4610071182250977
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29985817
model size : 129.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7198667526245117
Epoch: 1, Steps: 18 | Train Loss: 3.257 Vali Loss: 2.886 Vali Acc: 0.367 Test Loss: 2.886 Test Acc: 0.367
Validation loss decreased (inf --> -0.366638).  Saving model ...
Epoch: 2 cost time: 0.8254005908966064
Epoch: 2, Steps: 18 | Train Loss: 2.600 Vali Loss: 1.984 Vali Acc: 0.850 Test Loss: 1.984 Test Acc: 0.850
Validation loss decreased (-0.366638 --> -0.849980).  Saving model ...
Epoch: 3 cost time: 0.9488260746002197
Epoch: 3, Steps: 18 | Train Loss: 1.447 Vali Loss: 0.654 Vali Acc: 0.927 Test Loss: 0.654 Test Acc: 0.927
Validation loss decreased (-0.849980 --> -0.926660).  Saving model ...
Epoch: 4 cost time: 1.2613635063171387
Epoch: 4, Steps: 18 | Train Loss: 0.429 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.926660 --> -0.933331).  Saving model ...
Epoch: 5 cost time: 2.086583137512207
Epoch: 5, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.933331 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.5376102924346924
Epoch: 6, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8122601509094238
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.963332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.2358052730560303
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 9 cost time: 1.3521389961242676
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8605141639709473
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2768723964691162
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9792568683624268
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2717390060424805
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8671891689300537
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8278939723968506
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9971752166748047
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5355560779571533
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8763978481292725
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 29736985
model size : 128.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1409823894500732
Epoch: 1, Steps: 18 | Train Loss: 3.226 Vali Loss: 2.582 Vali Acc: 0.437 Test Loss: 2.582 Test Acc: 0.437
Validation loss decreased (inf --> -0.436641).  Saving model ...
Epoch: 2 cost time: 2.791656494140625
Epoch: 2, Steps: 18 | Train Loss: 2.054 Vali Loss: 1.069 Vali Acc: 0.843 Test Loss: 1.069 Test Acc: 0.843
Validation loss decreased (-0.436641 --> -0.843323).  Saving model ...
Epoch: 3 cost time: 1.5121958255767822
Epoch: 3, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
Validation loss decreased (-0.843323 --> -0.939998).  Saving model ...
Epoch: 4 cost time: 2.122901678085327
Epoch: 4, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.877565622329712
Epoch: 5, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.939998 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 2.9390645027160645
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.249 Vali Acc: 0.947 Test Loss: 0.249 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0613746643066406
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8918325901031494
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.230 Vali Acc: 0.957 Test Loss: 0.230 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9512965679168701
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.957 Test Loss: 0.242 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.157395839691162
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4998908042907715
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3134913444519043
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6103317737579346
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8719713687896729
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.142186403274536
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 30359065
model size : 130.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.19681453704834
Epoch: 1, Steps: 18 | Train Loss: 3.242 Vali Loss: 2.760 Vali Acc: 0.407 Test Loss: 2.760 Test Acc: 0.407
Validation loss decreased (inf --> -0.406639).  Saving model ...
Epoch: 2 cost time: 1.6212501525878906
Epoch: 2, Steps: 18 | Train Loss: 2.329 Vali Loss: 1.513 Vali Acc: 0.850 Test Loss: 1.513 Test Acc: 0.850
Validation loss decreased (-0.406639 --> -0.849985).  Saving model ...
Epoch: 3 cost time: 0.896538496017456
Epoch: 3, Steps: 18 | Train Loss: 0.909 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
Validation loss decreased (-0.849985 --> -0.913330).  Saving model ...
Epoch: 4 cost time: 1.8657872676849365
Epoch: 4, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
Validation loss decreased (-0.913330 --> -0.943332).  Saving model ...
Epoch: 5 cost time: 1.8726961612701416
Epoch: 5, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.205 Vali Acc: 0.940 Test Loss: 0.205 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5686697959899902
Epoch: 6, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.943332 --> -0.949998).  Saving model ...
Epoch: 7 cost time: 1.5990405082702637
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.949998 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.8032200336456299
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966666).  Saving model ...
Epoch: 9 cost time: 1.6193113327026367
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.966666 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 2.0290582180023193
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1064486503601074
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0358388423919678
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1366348266601562
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6829004287719727
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.6749286651611328
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.4238910675048828
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 2.2344977855682373
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9369840621948242
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.778367280960083
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9559953212738037
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5693151950836182
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7293787002563477
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.5193369388580322
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5529975891113281
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5175254344940186
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3207523822784424
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.754835844039917
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.016505479812622
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6449439525604248
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.084136962890625
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.317152261734009
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8058323860168457
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.8738062381744385
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.265892744064331
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.1329922676086426
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.951742172241211
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29985817
model size : 129.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.605930805206299
Epoch: 1, Steps: 18 | Train Loss: 3.281 Vali Loss: 2.947 Vali Acc: 0.283 Test Loss: 2.947 Test Acc: 0.283
Validation loss decreased (inf --> -0.283304).  Saving model ...
Epoch: 2 cost time: 1.6541328430175781
Epoch: 2, Steps: 18 | Train Loss: 2.681 Vali Loss: 2.166 Vali Acc: 0.757 Test Loss: 2.166 Test Acc: 0.757
Validation loss decreased (-0.283304 --> -0.756645).  Saving model ...
Epoch: 3 cost time: 1.395293951034546
Epoch: 3, Steps: 18 | Train Loss: 1.669 Vali Loss: 0.776 Vali Acc: 0.920 Test Loss: 0.776 Test Acc: 0.920
Validation loss decreased (-0.756645 --> -0.919992).  Saving model ...
Epoch: 4 cost time: 1.3577601909637451
Epoch: 4, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.226 Vali Acc: 0.940 Test Loss: 0.226 Test Acc: 0.940
Validation loss decreased (-0.919992 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 1.1814827919006348
Epoch: 5, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.135087490081787
Epoch: 6, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.8991022109985352
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.0500261783599854
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.963 Test Loss: 0.098 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9454786777496338
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1276721954345703
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1314082145690918
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.0935828685760498
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1870808601379395
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0945541858673096
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2421658039093018
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.4813668727874756
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3313524723052979
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2225987911224365
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3940834999084473
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1450674533843994
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.331024408340454
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.2653615474700928
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.2092390060424805
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.530714988708496
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.547126054763794
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2916021347045898
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5192508697509766
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1286942958831787
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4167544841766357
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1743497848510742
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3051981925964355
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2594048976898193
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3530478477478027
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1409919261932373
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2835540771484375
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0814316272735596
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1300103664398193
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0995488166809082
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0023765563964844
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29716249
model size : 128.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.018458604812622
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 2.535 Vali Acc: 0.563 Test Loss: 2.535 Test Acc: 0.563
Validation loss decreased (inf --> -0.563308).  Saving model ...
Epoch: 2 cost time: 1.7204747200012207
Epoch: 2, Steps: 18 | Train Loss: 1.925 Vali Loss: 0.952 Vali Acc: 0.857 Test Loss: 0.952 Test Acc: 0.857
Validation loss decreased (-0.563308 --> -0.856657).  Saving model ...
Epoch: 3 cost time: 1.7658395767211914
Epoch: 3, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.856657 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.9467222690582275
Epoch: 4, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.199 Vali Acc: 0.940 Test Loss: 0.199 Test Acc: 0.940
Validation loss decreased (-0.929997 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 2.1659531593322754
Epoch: 5, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.226 Vali Acc: 0.947 Test Loss: 0.226 Test Acc: 0.947
Validation loss decreased (-0.939998 --> -0.946664).  Saving model ...
Epoch: 6 cost time: 1.3736281394958496
Epoch: 6, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.500 Vali Acc: 0.910 Test Loss: 0.500 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6711416244506836
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.946664 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.9433469772338867
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.963 Test Loss: 0.215 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1822559833526611
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.943 Test Loss: 0.283 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.152491331100464
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 2.311555862426758
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6654953956604004
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.953 Test Loss: 0.262 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1728627681732178
Epoch: 13, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.963 Test Loss: 0.241 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9176690578460693
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.763676404953003
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.8635056018829346
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 1.9453160762786865
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.19815731048584
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.917999029159546
Epoch: 19, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.51544189453125
Epoch: 20, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.332 Vali Acc: 0.940 Test Loss: 0.332 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.897928237915039
Epoch: 21, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.980 Vali Acc: 0.863 Test Loss: 0.980 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8384993076324463
Epoch: 22, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.756 Vali Acc: 0.907 Test Loss: 0.756 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5368752479553223
Epoch: 23, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.621 Vali Acc: 0.900 Test Loss: 0.621 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6106781959533691
Epoch: 24, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.708 Vali Acc: 0.913 Test Loss: 0.708 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6525793075561523
Epoch: 25, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.697 Vali Acc: 0.923 Test Loss: 0.697 Test Acc: 0.923
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3567297458648682
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.513 Vali Acc: 0.940 Test Loss: 0.513 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.0454747676849365
Epoch: 27, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.577 Vali Acc: 0.937 Test Loss: 0.577 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 30379801
model size : 130.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.067913770675659
Epoch: 1, Steps: 18 | Train Loss: 3.245 Vali Loss: 2.785 Vali Acc: 0.460 Test Loss: 2.785 Test Acc: 0.460
Validation loss decreased (inf --> -0.459972).  Saving model ...
Epoch: 2 cost time: 1.5132381916046143
Epoch: 2, Steps: 18 | Train Loss: 2.387 Vali Loss: 1.601 Vali Acc: 0.853 Test Loss: 1.601 Test Acc: 0.853
Validation loss decreased (-0.459972 --> -0.853317).  Saving model ...
Epoch: 3 cost time: 1.9693143367767334
Epoch: 3, Steps: 18 | Train Loss: 0.994 Vali Loss: 0.421 Vali Acc: 0.880 Test Loss: 0.421 Test Acc: 0.880
Validation loss decreased (-0.853317 --> -0.879996).  Saving model ...
Epoch: 4 cost time: 1.553116798400879
Epoch: 4, Steps: 18 | Train Loss: 0.284 Vali Loss: 0.289 Vali Acc: 0.920 Test Loss: 0.289 Test Acc: 0.920
Validation loss decreased (-0.879996 --> -0.919997).  Saving model ...
Epoch: 5 cost time: 1.4820585250854492
Epoch: 5, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.419008493423462
Epoch: 6, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.919997 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.406839370727539
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.947 Test Loss: 0.231 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4927713871002197
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.906768798828125
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1357152462005615
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5158019065856934
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0979061126708984
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2489326000213623
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.412165880203247
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.177824020385742
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8474676609039307
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4615252017974854
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.024822950363159
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29923609
model size : 128.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.316195249557495
Epoch: 1, Steps: 18 | Train Loss: 3.315 Vali Loss: 2.975 Vali Acc: 0.333 Test Loss: 2.975 Test Acc: 0.333
Validation loss decreased (inf --> -0.333304).  Saving model ...
Epoch: 2 cost time: 0.9094271659851074
Epoch: 2, Steps: 18 | Train Loss: 2.746 Vali Loss: 2.225 Vali Acc: 0.797 Test Loss: 2.225 Test Acc: 0.797
Validation loss decreased (-0.333304 --> -0.796644).  Saving model ...
Epoch: 3 cost time: 0.9653139114379883
Epoch: 3, Steps: 18 | Train Loss: 1.763 Vali Loss: 0.833 Vali Acc: 0.927 Test Loss: 0.833 Test Acc: 0.927
Validation loss decreased (-0.796644 --> -0.926658).  Saving model ...
Epoch: 4 cost time: 1.2857487201690674
Epoch: 4, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.233 Vali Acc: 0.953 Test Loss: 0.233 Test Acc: 0.953
Validation loss decreased (-0.926658 --> -0.953331).  Saving model ...
Epoch: 5 cost time: 1.1737034320831299
Epoch: 5, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.048567295074463
Epoch: 6, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.0176513195037842
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0435333251953125
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4213106632232666
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.5432775020599365
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.2262847423553467
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7994949817657471
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.885167121887207
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.3391845226287842
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.9409904479980469
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.952629804611206
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.2743735313415527
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1246528625488281
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5100219249725342
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1202521324157715
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4150800704956055
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3704662322998047
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2889595031738281
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4785175323486328
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1386871337890625
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5013542175292969
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1644799709320068
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29716249
model size : 128.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.080799341201782
Epoch: 1, Steps: 18 | Train Loss: 3.191 Vali Loss: 2.587 Vali Acc: 0.403 Test Loss: 2.587 Test Acc: 0.403
Validation loss decreased (inf --> -0.403307).  Saving model ...
Epoch: 2 cost time: 2.264439582824707
Epoch: 2, Steps: 18 | Train Loss: 1.961 Vali Loss: 0.999 Vali Acc: 0.840 Test Loss: 0.999 Test Acc: 0.840
Validation loss decreased (-0.403307 --> -0.839990).  Saving model ...
Epoch: 3 cost time: 2.271942138671875
Epoch: 3, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.839990 --> -0.903330).  Saving model ...
Epoch: 4 cost time: 2.736511468887329
Epoch: 4, Steps: 18 | Train Loss: 0.156 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.903330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 2.1307270526885986
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.234 Vali Acc: 0.957 Test Loss: 0.234 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0454585552215576
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.374 Vali Acc: 0.913 Test Loss: 0.374 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.001574993133545
Epoch: 7, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9126250743865967
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.963 Test Loss: 0.099 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5037059783935547
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.7409768104553223
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.736128807067871
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.8694438934326172
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 2.6023881435394287
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 2.025561571121216
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 2.611168146133423
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 2.5776314735412598
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9633197784423828
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.774137020111084
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7450454235076904
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.389486312866211
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 2.2349092960357666
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4068493843078613
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 2.0628583431243896
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0835771560668945
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 2.6650288105010986
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 2.7824788093566895
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.2158939838409424
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.76147723197937
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.369122266769409
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 2.6927196979522705
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 2.4249019622802734
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 2.2991745471954346
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 2.086815118789673
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.798736333847046
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0353832244873047
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0467283725738525
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.8844172954559326
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9506723880767822
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.2662806510925293
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.6154818534851074
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.060183048248291
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.1618199348449707
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.758800983428955
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4500164985656738
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2374253273010254
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 2.194127082824707
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 47 cost time: 1.46519136428833
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4566869735717773
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.695070743560791
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.225693941116333
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 30400537
model size : 130.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.17314887046814
Epoch: 1, Steps: 18 | Train Loss: 3.230 Vali Loss: 2.804 Vali Acc: 0.327 Test Loss: 2.804 Test Acc: 0.327
Validation loss decreased (inf --> -0.326639).  Saving model ...
Epoch: 2 cost time: 1.2520856857299805
Epoch: 2, Steps: 18 | Train Loss: 2.428 Vali Loss: 1.611 Vali Acc: 0.840 Test Loss: 1.611 Test Acc: 0.840
Validation loss decreased (-0.326639 --> -0.839984).  Saving model ...
Epoch: 3 cost time: 1.761915922164917
Epoch: 3, Steps: 18 | Train Loss: 1.065 Vali Loss: 0.450 Vali Acc: 0.890 Test Loss: 0.450 Test Acc: 0.890
Validation loss decreased (-0.839984 --> -0.889996).  Saving model ...
Epoch: 4 cost time: 1.73488450050354
Epoch: 4, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.238 Vali Acc: 0.927 Test Loss: 0.238 Test Acc: 0.927
Validation loss decreased (-0.889996 --> -0.926664).  Saving model ...
Epoch: 5 cost time: 2.1817448139190674
Epoch: 5, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.926664 --> -0.933331).  Saving model ...
Epoch: 6 cost time: 1.0656812191009521
Epoch: 6, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.933331 --> -0.959999).  Saving model ...
Epoch: 7 cost time: 1.776458740234375
Epoch: 7, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.959999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.8564002513885498
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6705036163330078
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.987 Test Loss: 0.089 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 10 cost time: 1.0088722705841064
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4072859287261963
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2301018238067627
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.987 Test Loss: 0.094 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.644010305404663
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.703467845916748
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 15 cost time: 1.647341251373291
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 16 cost time: 2.16652512550354
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 17 cost time: 1.8537282943725586
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 18 cost time: 1.6486530303955078
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.9592888355255127
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 20 cost time: 1.859161615371704
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 2.0270988941192627
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 1.7990553379058838
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 1.8987677097320557
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 24 cost time: 2.0323517322540283
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 25 cost time: 2.204287052154541
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4608631134033203
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0178658962249756
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7454824447631836
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.050950527191162
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6966416835784912
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 31 cost time: 1.4735908508300781
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4946167469024658
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.2425506114959717
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.750157117843628
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.096712827682495
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7140603065490723
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.138730049133301
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5694210529327393
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.0443522930145264
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5330896377563477
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 29944345
model size : 128.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.744640350341797
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 2.931 Vali Acc: 0.283 Test Loss: 2.931 Test Acc: 0.283
Validation loss decreased (inf --> -0.283304).  Saving model ...
Epoch: 2 cost time: 1.3658182621002197
Epoch: 2, Steps: 18 | Train Loss: 2.724 Vali Loss: 2.248 Vali Acc: 0.757 Test Loss: 2.248 Test Acc: 0.757
Validation loss decreased (-0.283304 --> -0.756644).  Saving model ...
Epoch: 3 cost time: 1.482959270477295
Epoch: 3, Steps: 18 | Train Loss: 1.795 Vali Loss: 0.946 Vali Acc: 0.890 Test Loss: 0.946 Test Acc: 0.890
Validation loss decreased (-0.756644 --> -0.889991).  Saving model ...
Epoch: 4 cost time: 1.0559139251708984
Epoch: 4, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.383 Vali Acc: 0.923 Test Loss: 0.383 Test Acc: 0.923
Validation loss decreased (-0.889991 --> -0.923330).  Saving model ...
Epoch: 5 cost time: 1.4213552474975586
Epoch: 5, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
Validation loss decreased (-0.923330 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.9779548645019531
Epoch: 6, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4494686126708984
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966666).  Saving model ...
Epoch: 8 cost time: 1.1306381225585938
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.966666 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.0781879425048828
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.0025815963745117
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.024024248123169
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.070746898651123
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0921680927276611
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9227957725524902
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.018423080444336
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.4551687240600586
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 0.8803479671478271
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5090816020965576
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2355399131774902
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9864480495452881
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9443297386169434
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2348098754882812
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.1502337455749512
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.1677775382995605
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.320129632949829
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2032523155212402
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9478781223297119
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7119400501251221
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.681553840637207
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7697322368621826
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8139965534210205
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8396134376525879
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2654211521148682
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 29716249
model size : 128.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9974751472473145
Epoch: 1, Steps: 18 | Train Loss: 3.237 Vali Loss: 2.646 Vali Acc: 0.403 Test Loss: 2.646 Test Acc: 0.403
Validation loss decreased (inf --> -0.403307).  Saving model ...
Epoch: 2 cost time: 1.831843376159668
Epoch: 2, Steps: 18 | Train Loss: 2.107 Vali Loss: 1.188 Vali Acc: 0.853 Test Loss: 1.188 Test Acc: 0.853
Validation loss decreased (-0.403307 --> -0.853321).  Saving model ...
Epoch: 3 cost time: 2.211946487426758
Epoch: 3, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.285 Vali Acc: 0.907 Test Loss: 0.285 Test Acc: 0.907
Validation loss decreased (-0.853321 --> -0.906664).  Saving model ...
Epoch: 4 cost time: 2.2373409271240234
Epoch: 4, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.906664 --> -0.936665).  Saving model ...
Epoch: 5 cost time: 1.754788875579834
Epoch: 5, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1844069957733154
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.987 Test Loss: 0.094 Test Acc: 0.987
Validation loss decreased (-0.936665 --> -0.986666).  Saving model ...
Epoch: 7 cost time: 1.6433591842651367
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7880265712738037
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1452183723449707
Epoch: 9, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.607 Vali Acc: 0.923 Test Loss: 0.607 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4588775634765625
Epoch: 10, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.194129467010498
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6665444374084473
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1200215816497803
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5380935668945312
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1180737018585205
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8817803859710693
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 30193177
model size : 129.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6304988861083984
Epoch: 1, Steps: 18 | Train Loss: 3.230 Vali Loss: 2.788 Vali Acc: 0.457 Test Loss: 2.788 Test Acc: 0.457
Validation loss decreased (inf --> -0.456639).  Saving model ...
Epoch: 2 cost time: 1.381188154220581
Epoch: 2, Steps: 18 | Train Loss: 2.434 Vali Loss: 1.671 Vali Acc: 0.897 Test Loss: 1.671 Test Acc: 0.897
Validation loss decreased (-0.456639 --> -0.896650).  Saving model ...
Epoch: 3 cost time: 1.9872660636901855
Epoch: 3, Steps: 18 | Train Loss: 1.156 Vali Loss: 0.473 Vali Acc: 0.880 Test Loss: 0.473 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4986484050750732
Epoch: 4, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.199 Vali Acc: 0.947 Test Loss: 0.199 Test Acc: 0.947
Validation loss decreased (-0.896650 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.4256951808929443
Epoch: 5, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.946665 --> -0.949999).  Saving model ...
Epoch: 6 cost time: 0.9501051902770996
Epoch: 6, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.949999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.9613311290740967
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.947 Test Loss: 0.171 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0110101699829102
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1019909381866455
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.77899169921875
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5826711654663086
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8703210353851318
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8968210220336914
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3859481811523438
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1476681232452393
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5998516082763672
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4435293674468994
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.096407175064087
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29902873
model size : 128.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4642527103424072
Epoch: 1, Steps: 18 | Train Loss: 3.305 Vali Loss: 3.026 Vali Acc: 0.223 Test Loss: 3.026 Test Acc: 0.223
Validation loss decreased (inf --> -0.223303).  Saving model ...
Epoch: 2 cost time: 0.9206829071044922
Epoch: 2, Steps: 18 | Train Loss: 2.837 Vali Loss: 2.383 Vali Acc: 0.813 Test Loss: 2.383 Test Acc: 0.813
Validation loss decreased (-0.223303 --> -0.813310).  Saving model ...
Epoch: 3 cost time: 1.2644951343536377
Epoch: 3, Steps: 18 | Train Loss: 2.000 Vali Loss: 1.103 Vali Acc: 0.947 Test Loss: 1.103 Test Acc: 0.947
Validation loss decreased (-0.813310 --> -0.946656).  Saving model ...
Epoch: 4 cost time: 1.2316868305206299
Epoch: 4, Steps: 18 | Train Loss: 0.795 Vali Loss: 0.256 Vali Acc: 0.957 Test Loss: 0.256 Test Acc: 0.957
Validation loss decreased (-0.946656 --> -0.956664).  Saving model ...
Epoch: 5 cost time: 0.8525450229644775
Epoch: 5, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3646111488342285
Epoch: 6, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7044057846069336
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.960 Test Loss: 0.099 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959999).  Saving model ...
Epoch: 8 cost time: 0.9151191711425781
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.3235108852386475
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.2683804035186768
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.062568187713623
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1851661205291748
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5101723670959473
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.093942642211914
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1707472801208496
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.154822587966919
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3016870021820068
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0887506008148193
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2059979438781738
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4632153511047363
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9600744247436523
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5090851783752441
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0022082328796387
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 29716249
model size : 128.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6213393211364746
Epoch: 1, Steps: 18 | Train Loss: 3.145 Vali Loss: 2.599 Vali Acc: 0.443 Test Loss: 2.599 Test Acc: 0.443
Validation loss decreased (inf --> -0.443307).  Saving model ...
Epoch: 2 cost time: 1.1914875507354736
Epoch: 2, Steps: 18 | Train Loss: 2.076 Vali Loss: 1.128 Vali Acc: 0.843 Test Loss: 1.128 Test Acc: 0.843
Validation loss decreased (-0.443307 --> -0.843322).  Saving model ...
Epoch: 3 cost time: 1.4297142028808594
Epoch: 3, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.843322 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.226907730102539
Epoch: 4, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
Validation loss decreased (-0.916664 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 1.1589152812957764
Epoch: 5, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7953529357910156
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.953332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9328265190124512
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8840086460113525
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.527160406112671
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.8382751941680908
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5288996696472168
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.289017915725708
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.2583611011505127
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3178009986877441
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.138120412826538
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.2157399654388428
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8732116222381592
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.0509986877441406
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4742543697357178
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5781316757202148
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2325499057769775
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.804551124572754
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7907004356384277
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.201057195663452
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5054259300231934
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3496007919311523
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.5928747653961182
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9948523044586182
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7487115859985352
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.034712314605713
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6929147243499756
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.9542837142944336
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7140169143676758
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.082474708557129
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4594860076904297
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.924971580505371
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 30213913
model size : 129.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.507652521133423
Epoch: 1, Steps: 18 | Train Loss: 3.272 Vali Loss: 2.890 Vali Acc: 0.387 Test Loss: 2.890 Test Acc: 0.387
Validation loss decreased (inf --> -0.386638).  Saving model ...
Epoch: 2 cost time: 0.8682806491851807
Epoch: 2, Steps: 18 | Train Loss: 2.578 Vali Loss: 1.917 Vali Acc: 0.837 Test Loss: 1.917 Test Acc: 0.837
Validation loss decreased (-0.386638 --> -0.836647).  Saving model ...
Epoch: 3 cost time: 0.811305046081543
Epoch: 3, Steps: 18 | Train Loss: 1.378 Vali Loss: 0.545 Vali Acc: 0.923 Test Loss: 0.545 Test Acc: 0.923
Validation loss decreased (-0.836647 --> -0.923328).  Saving model ...
Epoch: 4 cost time: 1.6006100177764893
Epoch: 4, Steps: 18 | Train Loss: 0.365 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5405840873718262
Epoch: 5, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.923328 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3168878555297852
Epoch: 6, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.3642103672027588
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.3186571598052979
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4600460529327393
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.254570722579956
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7979660034179688
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5482330322265625
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8035943508148193
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.165569543838501
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0207483768463135
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9733073711395264
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8932204246520996
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 29882137
model size : 128.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3519370555877686
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 2.940 Vali Acc: 0.280 Test Loss: 2.940 Test Acc: 0.280
Validation loss decreased (inf --> -0.279971).  Saving model ...
Epoch: 2 cost time: 0.982151985168457
Epoch: 2, Steps: 18 | Train Loss: 2.730 Vali Loss: 2.275 Vali Acc: 0.743 Test Loss: 2.275 Test Acc: 0.743
Validation loss decreased (-0.279971 --> -0.743311).  Saving model ...
Epoch: 3 cost time: 0.888451099395752
Epoch: 3, Steps: 18 | Train Loss: 1.921 Vali Loss: 1.058 Vali Acc: 0.890 Test Loss: 1.058 Test Acc: 0.890
Validation loss decreased (-0.743311 --> -0.889989).  Saving model ...
Epoch: 4 cost time: 0.865454912185669
Epoch: 4, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
Validation loss decreased (-0.889989 --> -0.933330).  Saving model ...
Epoch: 5 cost time: 0.7049148082733154
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
Validation loss decreased (-0.933330 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.0661866664886475
Epoch: 6, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.161 Vali Acc: 0.933 Test Loss: 0.161 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3395333290100098
Epoch: 7, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0384693145751953
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1702687740325928
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0723321437835693
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0020301342010498
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1985549926757812
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2234711647033691
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0551857948303223
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2766468524932861
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1629414558410645
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2086639404296875
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2912328243255615
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8930842876434326
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0280070304870605
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9265599250793457
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9581751823425293
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8058657646179199
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8617429733276367
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7322642803192139
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9700987339019775
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.09212064743042
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.1572229862213135
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0968921184539795
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.4191267490386963
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2028884887695312
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0402209758758545
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3537304401397705
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2871251106262207
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0241079330444336
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0735104084014893
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1205072402954102
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9773719310760498
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.3549623489379883
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.4275014400482178
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.0630314350128174
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3609557151794434
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.053821325302124
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.3551321029663086
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.0059854984283447
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6628842353820801
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6395328044891357
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8159120082855225
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8304941654205322
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3021273612976074
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29716249
model size : 128.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1649551391601562
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 2.632 Vali Acc: 0.443 Test Loss: 2.632 Test Acc: 0.443
Validation loss decreased (inf --> -0.443307).  Saving model ...
Epoch: 2 cost time: 1.580451250076294
Epoch: 2, Steps: 18 | Train Loss: 2.055 Vali Loss: 1.013 Vali Acc: 0.910 Test Loss: 1.013 Test Acc: 0.910
Validation loss decreased (-0.443307 --> -0.909990).  Saving model ...
Epoch: 3 cost time: 2.400461196899414
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.909990 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.7947309017181396
Epoch: 4, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.916664 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.865389347076416
Epoch: 5, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.773669719696045
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.262755870819092
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.0025532245635986
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5974466800689697
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0234150886535645
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5455348491668701
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.6318573951721191
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6589906215667725
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.577007532119751
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.540524959564209
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4907841682434082
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7129907608032227
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.960 Test Loss: 0.302 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7444884777069092
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.933 Test Loss: 0.333 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.199554681777954
Epoch: 19, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.345 Vali Acc: 0.943 Test Loss: 0.345 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7106387615203857
Epoch: 20, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.552 Vali Acc: 0.897 Test Loss: 0.552 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.578662395477295
Epoch: 21, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.639 Vali Acc: 0.927 Test Loss: 0.639 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8210647106170654
Epoch: 22, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.508 Vali Acc: 0.930 Test Loss: 0.508 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.333252429962158
Epoch: 23, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.490 Vali Acc: 0.950 Test Loss: 0.490 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 30234649
model size : 130.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1662092208862305
Epoch: 1, Steps: 18 | Train Loss: 3.212 Vali Loss: 2.820 Vali Acc: 0.413 Test Loss: 2.820 Test Acc: 0.413
Validation loss decreased (inf --> -0.413305).  Saving model ...
Epoch: 2 cost time: 1.3642399311065674
Epoch: 2, Steps: 18 | Train Loss: 2.562 Vali Loss: 1.783 Vali Acc: 0.833 Test Loss: 1.783 Test Acc: 0.833
Validation loss decreased (-0.413305 --> -0.833316).  Saving model ...
Epoch: 3 cost time: 1.2516632080078125
Epoch: 3, Steps: 18 | Train Loss: 1.277 Vali Loss: 0.515 Vali Acc: 0.893 Test Loss: 0.515 Test Acc: 0.893
Validation loss decreased (-0.833316 --> -0.893328).  Saving model ...
Epoch: 4 cost time: 2.2669179439544678
Epoch: 4, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
Validation loss decreased (-0.893328 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 2.0363380908966064
Epoch: 5, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.9656031131744385
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6611049175262451
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.0731475353240967
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.1746654510498047
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2291982173919678
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.5224056243896484
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0722789764404297
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.8856015205383301
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5296523571014404
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.37270188331604
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.6121151447296143
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6338107585906982
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.274163007736206
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.23828125
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.248852014541626
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.20086407661438
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.2778542041778564
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.807342290878296
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.4037282466888428
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.893608808517456
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.275404214859009
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.166619062423706
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.568767786026001
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.277878522872925
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 2.410756826400757
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.8604919910430908
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5822241306304932
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3618128299713135
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.083864688873291
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.448460817337036
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.9590411186218262
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.3762030601501465
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.9694340229034424
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.2489655017852783
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.6363327503204346
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2474939823150635
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.45632004737854
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.08901309967041
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0447700023651123
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.7962164878845215
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.203540563583374
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.8220937252044678
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.1161506175994873
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.230715751647949
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29902873
model size : 128.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7674384117126465
Epoch: 1, Steps: 18 | Train Loss: 3.275 Vali Loss: 3.007 Vali Acc: 0.177 Test Loss: 3.007 Test Acc: 0.177
Validation loss decreased (inf --> -0.176637).  Saving model ...
Epoch: 2 cost time: 1.227276086807251
Epoch: 2, Steps: 18 | Train Loss: 2.822 Vali Loss: 2.373 Vali Acc: 0.727 Test Loss: 2.373 Test Acc: 0.727
Validation loss decreased (-0.176637 --> -0.726643).  Saving model ...
Epoch: 3 cost time: 1.0832760334014893
Epoch: 3, Steps: 18 | Train Loss: 1.976 Vali Loss: 1.138 Vali Acc: 0.923 Test Loss: 1.138 Test Acc: 0.923
Validation loss decreased (-0.726643 --> -0.923322).  Saving model ...
Epoch: 4 cost time: 0.8958349227905273
Epoch: 4, Steps: 18 | Train Loss: 0.810 Vali Loss: 0.284 Vali Acc: 0.960 Test Loss: 0.284 Test Acc: 0.960
Validation loss decreased (-0.923322 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 0.9503598213195801
Epoch: 5, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0622780323028564
Epoch: 6, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.9675180912017822
Epoch: 7, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.058255910873413
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.0511670112609863
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.297278642654419
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3368542194366455
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0039246082305908
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9524593353271484
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2179594039916992
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8799009323120117
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8230271339416504
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.8642241954803467
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1139049530029297
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.218874216079712
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.264894723892212
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9789290428161621
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.317652940750122
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.155414342880249
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0944225788116455
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.3179616928100586
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.083461046218872
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0488626956939697
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9384222030639648
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8831210136413574
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0069222450256348
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1125962734222412
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.0690028667449951
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3107011318206787
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3014450073242188
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.178748607635498
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3793492317199707
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1580455303192139
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8816318511962891
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.216480016708374
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0910882949829102
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1786303520202637
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29736985
model size : 128.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.75563383102417
Epoch: 1, Steps: 18 | Train Loss: 3.265 Vali Loss: 2.758 Vali Acc: 0.457 Test Loss: 2.758 Test Acc: 0.457
Validation loss decreased (inf --> -0.456639).  Saving model ...
Epoch: 2 cost time: 1.7272789478302002
Epoch: 2, Steps: 18 | Train Loss: 2.313 Vali Loss: 1.452 Vali Acc: 0.820 Test Loss: 1.452 Test Acc: 0.820
Validation loss decreased (-0.456639 --> -0.819985).  Saving model ...
Epoch: 3 cost time: 2.106208562850952
Epoch: 3, Steps: 18 | Train Loss: 0.919 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
Validation loss decreased (-0.819985 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 2.0097014904022217
Epoch: 4, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4385621547698975
Epoch: 5, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
Validation loss decreased (-0.929997 --> -0.953332).  Saving model ...
Epoch: 6 cost time: 2.2809646129608154
Epoch: 6, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.953332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.9006950855255127
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.583416223526001
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.1158642768859863
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.3137671947479248
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3446481227874756
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4767749309539795
Epoch: 12, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.160564661026001
Epoch: 13, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6755516529083252
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1454875469207764
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7262496948242188
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1464619636535645
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5149240493774414
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.152940034866333
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 30130969
model size : 129.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0431997776031494
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 2.896 Vali Acc: 0.373 Test Loss: 2.896 Test Acc: 0.373
Validation loss decreased (inf --> -0.373304).  Saving model ...
Epoch: 2 cost time: 1.651763677597046
Epoch: 2, Steps: 18 | Train Loss: 2.626 Vali Loss: 1.998 Vali Acc: 0.817 Test Loss: 1.998 Test Acc: 0.817
Validation loss decreased (-0.373304 --> -0.816647).  Saving model ...
Epoch: 3 cost time: 0.9090054035186768
Epoch: 3, Steps: 18 | Train Loss: 1.462 Vali Loss: 0.518 Vali Acc: 0.943 Test Loss: 0.518 Test Acc: 0.943
Validation loss decreased (-0.816647 --> -0.943328).  Saving model ...
Epoch: 4 cost time: 1.4849905967712402
Epoch: 4, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
Validation loss decreased (-0.943328 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 1.1618826389312744
Epoch: 5, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.943331 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.0704326629638672
Epoch: 6, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.155745506286621
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0520029067993164
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.130378007888794
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.960 Test Loss: 0.107 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1260886192321777
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9051029682159424
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 1.111708641052246
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9780452251434326
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3324410915374756
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0781934261322021
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9753494262695312
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3702597618103027
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9853789806365967
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.032804250717163
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.4918274879455566
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0345659255981445
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2095918655395508
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5080130100250244
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1249120235443115
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.498629093170166
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2455403804779053
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0731277465820312
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.024296760559082
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9864177703857422
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 29902873
model size : 128.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7293264865875244
Epoch: 1, Steps: 18 | Train Loss: 3.277 Vali Loss: 3.006 Vali Acc: 0.237 Test Loss: 3.006 Test Acc: 0.237
Validation loss decreased (inf --> -0.236637).  Saving model ...
Epoch: 2 cost time: 1.0554020404815674
Epoch: 2, Steps: 18 | Train Loss: 2.801 Vali Loss: 2.377 Vali Acc: 0.703 Test Loss: 2.377 Test Acc: 0.703
Validation loss decreased (-0.236637 --> -0.703310).  Saving model ...
Epoch: 3 cost time: 1.1215431690216064
Epoch: 3, Steps: 18 | Train Loss: 2.007 Vali Loss: 1.133 Vali Acc: 0.880 Test Loss: 1.133 Test Acc: 0.880
Validation loss decreased (-0.703310 --> -0.879989).  Saving model ...
Epoch: 4 cost time: 0.9057683944702148
Epoch: 4, Steps: 18 | Train Loss: 0.841 Vali Loss: 0.298 Vali Acc: 0.940 Test Loss: 0.298 Test Acc: 0.940
Validation loss decreased (-0.879989 --> -0.939997).  Saving model ...
Epoch: 5 cost time: 0.814955472946167
Epoch: 5, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.211 Vali Acc: 0.940 Test Loss: 0.211 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939998).  Saving model ...
Epoch: 6 cost time: 0.8339486122131348
Epoch: 6, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966666).  Saving model ...
Epoch: 7 cost time: 1.286194086074829
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.966666 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.1281406879425049
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9255414009094238
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.2412853240966797
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9861063957214355
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2363231182098389
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0590674877166748
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8974130153656006
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1470730304718018
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9156689643859863
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.058091163635254
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0115947723388672
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2509245872497559
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9852535724639893
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0870699882507324
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9962193965911865
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0054278373718262
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8629021644592285
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8458542823791504
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0858714580535889
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9518275260925293
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8680346012115479
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8582274913787842
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0291812419891357
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9469571113586426
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0576465129852295
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1675584316253662
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1591999530792236
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.945742130279541
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1112499237060547
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.154404640197754
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.768033504486084
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1816353797912598
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9780147075653076
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.191110372543335
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0454192161560059
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.0816242694854736
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.0029447078704834
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9671106338500977
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8860666751861572
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.188715934753418
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8812777996063232
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9374544620513916
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2104239463806152
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29757721
model size : 128.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7035458087921143
Epoch: 1, Steps: 18 | Train Loss: 3.269 Vali Loss: 2.808 Vali Acc: 0.460 Test Loss: 2.808 Test Acc: 0.460
Validation loss decreased (inf --> -0.459972).  Saving model ...
Epoch: 2 cost time: 1.9585061073303223
Epoch: 2, Steps: 18 | Train Loss: 2.380 Vali Loss: 1.557 Vali Acc: 0.877 Test Loss: 1.557 Test Acc: 0.877
Validation loss decreased (-0.459972 --> -0.876651).  Saving model ...
Epoch: 3 cost time: 1.2650532722473145
Epoch: 3, Steps: 18 | Train Loss: 0.920 Vali Loss: 0.291 Vali Acc: 0.937 Test Loss: 0.291 Test Acc: 0.937
Validation loss decreased (-0.876651 --> -0.936664).  Saving model ...
Epoch: 4 cost time: 1.0526947975158691
Epoch: 4, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.231 Vali Acc: 0.927 Test Loss: 0.231 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.267106056213379
Epoch: 5, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (-0.936664 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.3100762367248535
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.953 Test Loss: 0.137 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0745820999145508
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9697704315185547
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959999).  Saving model ...
Epoch: 9 cost time: 1.168713092803955
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.960 Test Loss: 0.115 Test Acc: 0.960
Validation loss decreased (-0.959999 --> -0.959999).  Saving model ...
Epoch: 10 cost time: 1.189850091934204
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
Validation loss decreased (-0.959999 --> -0.966666).  Saving model ...
Epoch: 11 cost time: 1.0744235515594482
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
Validation loss decreased (-0.966666 --> -0.966666).  Saving model ...
Epoch: 12 cost time: 1.1757686138153076
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.966666 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.291747808456421
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 1.1786398887634277
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.1964406967163086
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 1.0769383907318115
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.3794176578521729
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.27884840965271
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.4210433959960938
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0511550903320312
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.435706615447998
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.441418170928955
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2294154167175293
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2948737144470215
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8879785537719727
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3795421123504639
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1058273315429688
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4751052856445312
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 30089497
model size : 129.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.589900493621826
Epoch: 1, Steps: 18 | Train Loss: 3.276 Vali Loss: 2.914 Vali Acc: 0.387 Test Loss: 2.914 Test Acc: 0.387
Validation loss decreased (inf --> -0.386638).  Saving model ...
Epoch: 2 cost time: 0.7686183452606201
Epoch: 2, Steps: 18 | Train Loss: 2.696 Vali Loss: 2.096 Vali Acc: 0.813 Test Loss: 2.096 Test Acc: 0.813
Validation loss decreased (-0.386638 --> -0.813312).  Saving model ...
Epoch: 3 cost time: 0.8286862373352051
Epoch: 3, Steps: 18 | Train Loss: 1.584 Vali Loss: 0.709 Vali Acc: 0.897 Test Loss: 0.709 Test Acc: 0.897
Validation loss decreased (-0.813312 --> -0.896660).  Saving model ...
Epoch: 4 cost time: 1.302234172821045
Epoch: 4, Steps: 18 | Train Loss: 0.473 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.896660 --> -0.933331).  Saving model ...
Epoch: 5 cost time: 0.8582625389099121
Epoch: 5, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.933331 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 0.8500325679779053
Epoch: 6, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9554040431976318
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.2341532707214355
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2411613464355469
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9497392177581787
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.7549049854278564
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.87264084815979
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.963 Test Loss: 0.112 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9207572937011719
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2872262001037598
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2592945098876953
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0145151615142822
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.9619345664978027
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8878171443939209
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8197014331817627
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.1002826690673828
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0503020286560059
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8912742137908936
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0731122493743896
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0828983783721924
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.1603171825408936
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.971491813659668
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9430191516876221
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7923529148101807
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.872063398361206
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8363380432128906
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9778199195861816
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9583024978637695
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1391520500183105
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.8147871494293213
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.998955488204956
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.078782320022583
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8753864765167236
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3052642345428467
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9628274440765381
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2665181159973145
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9122898578643799
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.124114990234375
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3534605503082275
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29902873
model size : 128.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.359752655029297
Epoch: 1, Steps: 18 | Train Loss: 3.340 Vali Loss: 3.057 Vali Acc: 0.203 Test Loss: 3.057 Test Acc: 0.203
Validation loss decreased (inf --> -0.203303).  Saving model ...
Epoch: 2 cost time: 0.8475396633148193
Epoch: 2, Steps: 18 | Train Loss: 2.913 Vali Loss: 2.512 Vali Acc: 0.733 Test Loss: 2.512 Test Acc: 0.733
Validation loss decreased (-0.203303 --> -0.733308).  Saving model ...
Epoch: 3 cost time: 0.9124424457550049
Epoch: 3, Steps: 18 | Train Loss: 2.239 Vali Loss: 1.519 Vali Acc: 0.897 Test Loss: 1.519 Test Acc: 0.897
Validation loss decreased (-0.733308 --> -0.896651).  Saving model ...
Epoch: 4 cost time: 0.7956461906433105
Epoch: 4, Steps: 18 | Train Loss: 1.173 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
Validation loss decreased (-0.896651 --> -0.936662).  Saving model ...
Epoch: 5 cost time: 0.906273603439331
Epoch: 5, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
Validation loss decreased (-0.936662 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.9671471118927002
Epoch: 6, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9787724018096924
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.966144323348999
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.8087031841278076
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7873458862304688
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.963 Test Loss: 0.110 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0591449737548828
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.046013355255127
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8296146392822266
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0298469066619873
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.914588212966919
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9510397911071777
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1198928356170654
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8678994178771973
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.8167376518249512
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8368277549743652
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0204265117645264
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8645913600921631
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.8802516460418701
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8576087951660156
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8283038139343262
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7906837463378906
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8642034530639648
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.764531135559082
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8038125038146973
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7575807571411133
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.8815155029296875
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.9594449996948242
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9925868511199951
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0028173923492432
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.257232427597046
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.9873940944671631
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7809381484985352
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.1713876724243164
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.8833341598510742
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8939743041992188
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7907092571258545
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.943058967590332
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2187621593475342
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8587589263916016
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1254231929779053
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0616817474365234
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9265487194061279
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1658856868743896
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29778457
model size : 128.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6190528869628906
Epoch: 1, Steps: 18 | Train Loss: 3.240 Vali Loss: 2.811 Vali Acc: 0.403 Test Loss: 2.811 Test Acc: 0.403
Validation loss decreased (inf --> -0.403305).  Saving model ...
Epoch: 2 cost time: 1.8493797779083252
Epoch: 2, Steps: 18 | Train Loss: 2.365 Vali Loss: 1.452 Vali Acc: 0.880 Test Loss: 1.452 Test Acc: 0.880
Validation loss decreased (-0.403305 --> -0.879985).  Saving model ...
Epoch: 3 cost time: 1.6580300331115723
Epoch: 3, Steps: 18 | Train Loss: 0.932 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.879985 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.7687318325042725
Epoch: 4, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.929997 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 2.082561492919922
Epoch: 5, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.3205642700195312
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3153836727142334
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.3998963832855225
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 0.7506330013275146
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.1306939125061035
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4470977783203125
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0948235988616943
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4996347427368164
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3228087425231934
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2151756286621094
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6298935413360596
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.917778730392456
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4935524463653564
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4464833736419678
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0106711387634277
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.810450792312622
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6259522438049316
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2825851440429688
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5057647228240967
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2732646465301514
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4348053932189941
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 30151705
model size : 129.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.456544876098633
Epoch: 1, Steps: 18 | Train Loss: 3.332 Vali Loss: 3.023 Vali Acc: 0.120 Test Loss: 3.023 Test Acc: 0.120
Validation loss decreased (inf --> -0.119970).  Saving model ...
Epoch: 2 cost time: 1.2059144973754883
Epoch: 2, Steps: 18 | Train Loss: 2.735 Vali Loss: 2.228 Vali Acc: 0.767 Test Loss: 2.228 Test Acc: 0.767
Validation loss decreased (-0.119970 --> -0.766644).  Saving model ...
Epoch: 3 cost time: 1.1940381526947021
Epoch: 3, Steps: 18 | Train Loss: 1.693 Vali Loss: 0.748 Vali Acc: 0.910 Test Loss: 0.748 Test Acc: 0.910
Validation loss decreased (-0.766644 --> -0.909993).  Saving model ...
Epoch: 4 cost time: 0.7946574687957764
Epoch: 4, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.213 Vali Acc: 0.960 Test Loss: 0.213 Test Acc: 0.960
Validation loss decreased (-0.909993 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.3813674449920654
Epoch: 5, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.0117216110229492
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.959998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.1067698001861572
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3660888671875
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1362409591674805
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.1497154235839844
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0236468315124512
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.237990379333496
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0295681953430176
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4433345794677734
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0931570529937744
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3050434589385986
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9959661960601807
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2784557342529297
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1286320686340332
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2288353443145752
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.051198959350586
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9457237720489502
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0412089824676514
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9155640602111816
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 29944345
model size : 128.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6977453231811523
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 3.013 Vali Acc: 0.193 Test Loss: 3.013 Test Acc: 0.193
Validation loss decreased (inf --> -0.193303).  Saving model ...
Epoch: 2 cost time: 0.9833874702453613
Epoch: 2, Steps: 18 | Train Loss: 2.826 Vali Loss: 2.392 Vali Acc: 0.677 Test Loss: 2.392 Test Acc: 0.677
Validation loss decreased (-0.193303 --> -0.676643).  Saving model ...
Epoch: 3 cost time: 0.8920800685882568
Epoch: 3, Steps: 18 | Train Loss: 2.087 Vali Loss: 1.291 Vali Acc: 0.923 Test Loss: 1.291 Test Acc: 0.923
Validation loss decreased (-0.676643 --> -0.923320).  Saving model ...
Epoch: 4 cost time: 0.9963207244873047
Epoch: 4, Steps: 18 | Train Loss: 1.062 Vali Loss: 0.418 Vali Acc: 0.957 Test Loss: 0.418 Test Acc: 0.957
Validation loss decreased (-0.923320 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 0.9525156021118164
Epoch: 5, Steps: 18 | Train Loss: 0.343 Vali Loss: 0.191 Vali Acc: 0.947 Test Loss: 0.191 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1227431297302246
Epoch: 6, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966666).  Saving model ...
Epoch: 7 cost time: 0.9529232978820801
Epoch: 7, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.967 Test Loss: 0.095 Test Acc: 0.967
Validation loss decreased (-0.966666 --> -0.966666).  Saving model ...
Epoch: 8 cost time: 0.9302964210510254
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.966666 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.0408928394317627
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.0992555618286133
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 11 cost time: 1.032099723815918
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 12 cost time: 1.0004940032958984
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9386026859283447
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 14 cost time: 1.3194661140441895
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1085870265960693
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9801697731018066
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 17 cost time: 0.9789397716522217
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 18 cost time: 1.0142557621002197
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 19 cost time: 0.9570562839508057
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0304851531982422
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8320362567901611
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0523433685302734
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9728777408599854
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.033811330795288
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9347195625305176
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.973333 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8620941638946533
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9596519470214844
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9490032196044922
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1715245246887207
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9979462623596191
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0412161350250244
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.038275957107544
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2010798454284668
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1040592193603516
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1090927124023438
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29840665
model size : 128.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0180296897888184
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 2.836 Vali Acc: 0.430 Test Loss: 2.836 Test Acc: 0.430
Validation loss decreased (inf --> -0.429972).  Saving model ...
Epoch: 2 cost time: 1.1465442180633545
Epoch: 2, Steps: 18 | Train Loss: 2.520 Vali Loss: 1.714 Vali Acc: 0.810 Test Loss: 1.714 Test Acc: 0.810
Validation loss decreased (-0.429972 --> -0.809983).  Saving model ...
Epoch: 3 cost time: 1.4029974937438965
Epoch: 3, Steps: 18 | Train Loss: 1.144 Vali Loss: 0.485 Vali Acc: 0.920 Test Loss: 0.485 Test Acc: 0.920
Validation loss decreased (-0.809983 --> -0.919995).  Saving model ...
Epoch: 4 cost time: 0.9545786380767822
Epoch: 4, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
Validation loss decreased (-0.919995 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 1.1152803897857666
Epoch: 5, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.943331 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.4119601249694824
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.4766175746917725
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.193103551864624
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3808093070983887
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.5104801654815674
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.007369041442871
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.985687255859375
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.059462070465088
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3342320919036865
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.070152759552002
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1497125625610352
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3061482906341553
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1734883785247803
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0753569602966309
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.238218069076538
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1020934581756592
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.01310396194458
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1143856048583984
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1563136577606201
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9827327728271484
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9891397953033447
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.022315263748169
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 30130969
model size : 129.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.061013698577881
Epoch: 1, Steps: 18 | Train Loss: 3.261 Vali Loss: 3.001 Vali Acc: 0.210 Test Loss: 3.001 Test Acc: 0.210
Validation loss decreased (inf --> -0.209970).  Saving model ...
Epoch: 2 cost time: 1.3737592697143555
Epoch: 2, Steps: 18 | Train Loss: 2.784 Vali Loss: 2.246 Vali Acc: 0.763 Test Loss: 2.246 Test Acc: 0.763
Validation loss decreased (-0.209970 --> -0.763311).  Saving model ...
Epoch: 3 cost time: 1.345287561416626
Epoch: 3, Steps: 18 | Train Loss: 1.837 Vali Loss: 0.994 Vali Acc: 0.867 Test Loss: 0.994 Test Acc: 0.867
Validation loss decreased (-0.763311 --> -0.866657).  Saving model ...
Epoch: 4 cost time: 1.123750925064087
Epoch: 4, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.340 Vali Acc: 0.943 Test Loss: 0.340 Test Acc: 0.943
Validation loss decreased (-0.866657 --> -0.943330).  Saving model ...
Epoch: 5 cost time: 1.323441982269287
Epoch: 5, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.943330 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.152977705001831
Epoch: 6, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.235239028930664
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2916278839111328
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3707807064056396
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1778433322906494
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.1100585460662842
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1929347515106201
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2886221408843994
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1194126605987549
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4459402561187744
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1573269367218018
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.4253406524658203
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.5111620426177979
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1960504055023193
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1107897758483887
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.059840202331543
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0751607418060303
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4182991981506348
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2828264236450195
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4949829578399658
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3225209712982178
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4563839435577393
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29985817
model size : 129.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.30259108543396
Epoch: 1, Steps: 18 | Train Loss: 3.377 Vali Loss: 3.124 Vali Acc: 0.127 Test Loss: 3.124 Test Acc: 0.127
Validation loss decreased (inf --> -0.126635).  Saving model ...
Epoch: 2 cost time: 1.230518102645874
Epoch: 2, Steps: 18 | Train Loss: 2.973 Vali Loss: 2.596 Vali Acc: 0.597 Test Loss: 2.596 Test Acc: 0.597
Validation loss decreased (-0.126635 --> -0.596641).  Saving model ...
Epoch: 3 cost time: 1.0758419036865234
Epoch: 3, Steps: 18 | Train Loss: 2.375 Vali Loss: 1.708 Vali Acc: 0.827 Test Loss: 1.708 Test Acc: 0.827
Validation loss decreased (-0.596641 --> -0.826650).  Saving model ...
Epoch: 4 cost time: 0.8507568836212158
Epoch: 4, Steps: 18 | Train Loss: 1.416 Vali Loss: 0.724 Vali Acc: 0.913 Test Loss: 0.724 Test Acc: 0.913
Validation loss decreased (-0.826650 --> -0.913326).  Saving model ...
Epoch: 5 cost time: 1.065159559249878
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.275 Vali Acc: 0.963 Test Loss: 0.275 Test Acc: 0.963
Validation loss decreased (-0.913326 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.9662947654724121
Epoch: 6, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.0705547332763672
Epoch: 7, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1042773723602295
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.963 Test Loss: 0.125 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0749146938323975
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.028214693069458
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.9577121734619141
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.110123872756958
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.1945586204528809
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0985543727874756
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1547207832336426
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.057450532913208
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0044147968292236
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1249127388000488
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2818448543548584
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0927560329437256
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2175664901733398
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.1210851669311523
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2022228240966797
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1400623321533203
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.2321925163269043
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0264475345611572
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2119574546813965
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0297634601593018
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1737608909606934
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0910041332244873
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.035327434539795
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0834345817565918
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0541574954986572
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9398431777954102
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0043458938598633
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 29902873
model size : 128.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8825995922088623
Epoch: 1, Steps: 18 | Train Loss: 3.159 Vali Loss: 2.274 Vali Acc: 0.540 Test Loss: 2.274 Test Acc: 0.540
Validation loss decreased (inf --> -0.539977).  Saving model ...
Epoch: 2 cost time: 1.2261662483215332
Epoch: 2, Steps: 18 | Train Loss: 1.446 Vali Loss: 0.738 Vali Acc: 0.867 Test Loss: 0.738 Test Acc: 0.867
Validation loss decreased (-0.539977 --> -0.866659).  Saving model ...
Epoch: 3 cost time: 1.6461286544799805
Epoch: 3, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.242 Vali Acc: 0.920 Test Loss: 0.242 Test Acc: 0.920
Validation loss decreased (-0.866659 --> -0.919998).  Saving model ...
Epoch: 4 cost time: 1.828622817993164
Epoch: 4, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.207 Vali Acc: 0.940 Test Loss: 0.207 Test Acc: 0.940
Validation loss decreased (-0.919998 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 1.5688211917877197
Epoch: 5, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.465 Vali Acc: 0.903 Test Loss: 0.465 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9159467220306396
Epoch: 6, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6225409507751465
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.515 Vali Acc: 0.913 Test Loss: 0.515 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.749596118927002
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.652 Vali Acc: 0.893 Test Loss: 0.652 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8637731075286865
Epoch: 9, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.468 Vali Acc: 0.923 Test Loss: 0.468 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3111870288848877
Epoch: 10, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8283298015594482
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.244 Vali Acc: 0.947 Test Loss: 0.244 Test Acc: 0.947
Validation loss decreased (-0.939998 --> -0.946664).  Saving model ...
Epoch: 12 cost time: 1.4684617519378662
Epoch: 12, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.920 Test Loss: 0.587 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0106654167175293
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.517 Vali Acc: 0.930 Test Loss: 0.517 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4023017883300781
Epoch: 14, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.617 Vali Acc: 0.927 Test Loss: 0.617 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.389374017715454
Epoch: 15, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.664 Vali Acc: 0.937 Test Loss: 0.664 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5916998386383057
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.927 Test Loss: 0.599 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4194014072418213
Epoch: 17, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.701 Vali Acc: 0.913 Test Loss: 0.701 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3958592414855957
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.792 Vali Acc: 0.920 Test Loss: 0.792 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6713535785675049
Epoch: 19, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.726 Vali Acc: 0.933 Test Loss: 0.726 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9201784133911133
Epoch: 20, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.779 Vali Acc: 0.943 Test Loss: 0.779 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4757623672485352
Epoch: 21, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.146 Vali Acc: 0.927 Test Loss: 1.146 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9466666666666667
model parameter : 23706649
model size : 105.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.876065492630005
Epoch: 1, Steps: 18 | Train Loss: 3.166 Vali Loss: 2.494 Vali Acc: 0.563 Test Loss: 2.494 Test Acc: 0.563
Validation loss decreased (inf --> -0.563308).  Saving model ...
Epoch: 2 cost time: 1.101613998413086
Epoch: 2, Steps: 18 | Train Loss: 1.843 Vali Loss: 1.045 Vali Acc: 0.857 Test Loss: 1.045 Test Acc: 0.857
Validation loss decreased (-0.563308 --> -0.856656).  Saving model ...
Epoch: 3 cost time: 1.249506950378418
Epoch: 3, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.265 Vali Acc: 0.943 Test Loss: 0.265 Test Acc: 0.943
Validation loss decreased (-0.856656 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 1.356553077697754
Epoch: 4, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.245 Vali Acc: 0.927 Test Loss: 0.245 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3902881145477295
Epoch: 5, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2790803909301758
Epoch: 6, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9450538158416748
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6121814250946045
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
Validation loss decreased (-0.943331 --> -0.956664).  Saving model ...
Epoch: 9 cost time: 1.4076130390167236
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.956664 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.2286937236785889
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.1638073921203613
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.155008316040039
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3458068370819092
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.829057216644287
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6632111072540283
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7168734073638916
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.591407299041748
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8747248649597168
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6777055263519287
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.120506525039673
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1523795127868652
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 1.2416112422943115
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 1.2651305198669434
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 24 cost time: 1.369741439819336
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8134069442749023
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7572824954986572
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0708043575286865
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.407426118850708
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4346158504486084
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4013862609863281
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3713979721069336
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.474034070968628
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.634552001953125
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 23229721
model size : 103.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1986098289489746
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 2.740 Vali Acc: 0.497 Test Loss: 2.740 Test Acc: 0.497
Validation loss decreased (inf --> -0.496639).  Saving model ...
Epoch: 2 cost time: 1.2734081745147705
Epoch: 2, Steps: 18 | Train Loss: 2.300 Vali Loss: 1.660 Vali Acc: 0.893 Test Loss: 1.660 Test Acc: 0.893
Validation loss decreased (-0.496639 --> -0.893317).  Saving model ...
Epoch: 3 cost time: 1.2408733367919922
Epoch: 3, Steps: 18 | Train Loss: 1.170 Vali Loss: 0.533 Vali Acc: 0.937 Test Loss: 0.533 Test Acc: 0.937
Validation loss decreased (-0.893317 --> -0.936661).  Saving model ...
Epoch: 4 cost time: 1.4395122528076172
Epoch: 4, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.936661 --> -0.936665).  Saving model ...
Epoch: 5 cost time: 1.40053129196167
Epoch: 5, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.936665 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.6188089847564697
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.956665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.2551307678222656
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3321192264556885
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.543130874633789
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.549006462097168
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.524472713470459
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1780705451965332
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.472456932067871
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8614521026611328
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.4185709953308105
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.41668701171875
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5422453880310059
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.593904733657837
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4048562049865723
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4474821090698242
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2187013626098633
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2127864360809326
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3266541957855225
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2854070663452148
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22752793
model size : 101.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5635595321655273
Epoch: 1, Steps: 18 | Train Loss: 3.171 Vali Loss: 2.439 Vali Acc: 0.493 Test Loss: 2.439 Test Acc: 0.493
Validation loss decreased (inf --> -0.493309).  Saving model ...
Epoch: 2 cost time: 1.804833173751831
Epoch: 2, Steps: 18 | Train Loss: 1.608 Vali Loss: 0.810 Vali Acc: 0.870 Test Loss: 0.810 Test Acc: 0.870
Validation loss decreased (-0.493309 --> -0.869992).  Saving model ...
Epoch: 3 cost time: 1.2525157928466797
Epoch: 3, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
Validation loss decreased (-0.869992 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 1.7436244487762451
Epoch: 4, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.02405047416687
Epoch: 5, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1424756050109863
Epoch: 6, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
Validation loss decreased (-0.926664 --> -0.936664).  Saving model ...
Epoch: 7 cost time: 2.042419195175171
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.291 Vali Acc: 0.953 Test Loss: 0.291 Test Acc: 0.953
Validation loss decreased (-0.936664 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 1.9758968353271484
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
Validation loss decreased (-0.953330 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 2.0749688148498535
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1287429332733154
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.861433744430542
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.937 Test Loss: 0.370 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.836421012878418
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.953 Test Loss: 0.295 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1131551265716553
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.953 Test Loss: 0.276 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.801769733428955
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.957 Test Loss: 0.254 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9953680038452148
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.957 Test Loss: 0.244 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6587951183319092
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0072381496429443
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.957 Test Loss: 0.238 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8234546184539795
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 23706649
model size : 105.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0561416149139404
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 2.698 Vali Acc: 0.453 Test Loss: 2.698 Test Acc: 0.453
Validation loss decreased (inf --> -0.453306).  Saving model ...
Epoch: 2 cost time: 1.3445899486541748
Epoch: 2, Steps: 18 | Train Loss: 2.214 Vali Loss: 1.471 Vali Acc: 0.820 Test Loss: 1.471 Test Acc: 0.820
Validation loss decreased (-0.453306 --> -0.819985).  Saving model ...
Epoch: 3 cost time: 2.04472017288208
Epoch: 3, Steps: 18 | Train Loss: 0.884 Vali Loss: 0.395 Vali Acc: 0.927 Test Loss: 0.395 Test Acc: 0.927
Validation loss decreased (-0.819985 --> -0.926663).  Saving model ...
Epoch: 4 cost time: 1.5459866523742676
Epoch: 4, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.926663 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.2315752506256104
Epoch: 5, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6473875045776367
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959999).  Saving model ...
Epoch: 7 cost time: 1.9456956386566162
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4984679222106934
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.8631503582000732
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.9527721405029297
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0606367588043213
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9885897636413574
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6907517910003662
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.065976858139038
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5045413970947266
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8305926322937012
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0545110702514648
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.736933708190918
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6820900440216064
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 23001625
model size : 102.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5065622329711914
Epoch: 1, Steps: 18 | Train Loss: 3.252 Vali Loss: 2.858 Vali Acc: 0.387 Test Loss: 2.858 Test Acc: 0.387
Validation loss decreased (inf --> -0.386638).  Saving model ...
Epoch: 2 cost time: 1.202204704284668
Epoch: 2, Steps: 18 | Train Loss: 2.557 Vali Loss: 1.996 Vali Acc: 0.807 Test Loss: 1.996 Test Acc: 0.807
Validation loss decreased (-0.386638 --> -0.806647).  Saving model ...
Epoch: 3 cost time: 1.3502495288848877
Epoch: 3, Steps: 18 | Train Loss: 1.479 Vali Loss: 0.763 Vali Acc: 0.917 Test Loss: 0.763 Test Acc: 0.917
Validation loss decreased (-0.806647 --> -0.916659).  Saving model ...
Epoch: 4 cost time: 1.263084888458252
Epoch: 4, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
Validation loss decreased (-0.916659 --> -0.953331).  Saving model ...
Epoch: 5 cost time: 1.238326072692871
Epoch: 5, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.953331 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.677825689315796
Epoch: 6, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.377488374710083
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.490006923675537
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 1.296417236328125
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6169373989105225
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.489088773727417
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2656724452972412
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5529656410217285
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3861024379730225
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1979122161865234
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.337113857269287
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4878244400024414
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.13346266746521
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8502154350280762
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6526510715484619
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0215394496917725
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1524829864501953
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6792480945587158
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4386639595031738
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4455461502075195
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3002455234527588
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.257972002029419
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 22690585
model size : 101.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3574628829956055
Epoch: 1, Steps: 18 | Train Loss: 3.277 Vali Loss: 2.402 Vali Acc: 0.410 Test Loss: 2.402 Test Acc: 0.410
Validation loss decreased (inf --> -0.409976).  Saving model ...
Epoch: 2 cost time: 1.8028268814086914
Epoch: 2, Steps: 18 | Train Loss: 1.653 Vali Loss: 0.848 Vali Acc: 0.843 Test Loss: 0.848 Test Acc: 0.843
Validation loss decreased (-0.409976 --> -0.843325).  Saving model ...
Epoch: 3 cost time: 1.8859434127807617
Epoch: 3, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.304 Vali Acc: 0.927 Test Loss: 0.304 Test Acc: 0.927
Validation loss decreased (-0.843325 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 1.5061259269714355
Epoch: 4, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.283 Vali Acc: 0.927 Test Loss: 0.283 Test Acc: 0.927
Validation loss decreased (-0.926664 --> -0.926664).  Saving model ...
Epoch: 5 cost time: 1.1964104175567627
Epoch: 5, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.456 Vali Acc: 0.920 Test Loss: 0.456 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6519403457641602
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
Validation loss decreased (-0.926664 --> -0.933330).  Saving model ...
Epoch: 7 cost time: 1.8945508003234863
Epoch: 7, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.480 Vali Acc: 0.910 Test Loss: 0.480 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1344032287597656
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.936663).  Saving model ...
Epoch: 9 cost time: 1.5092344284057617
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.495 Vali Acc: 0.923 Test Loss: 0.495 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7392094135284424
Epoch: 10, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.384 Vali Acc: 0.937 Test Loss: 0.384 Test Acc: 0.937
Validation loss decreased (-0.936663 --> -0.936663).  Saving model ...
Epoch: 11 cost time: 1.7956342697143555
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.350 Vali Acc: 0.947 Test Loss: 0.350 Test Acc: 0.947
Validation loss decreased (-0.936663 --> -0.946663).  Saving model ...
Epoch: 12 cost time: 1.949838638305664
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.386 Vali Acc: 0.960 Test Loss: 0.386 Test Acc: 0.960
Validation loss decreased (-0.946663 --> -0.959996).  Saving model ...
Epoch: 13 cost time: 1.47792387008667
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.523 Vali Acc: 0.927 Test Loss: 0.523 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1939847469329834
Epoch: 14, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.379 Vali Acc: 0.953 Test Loss: 0.379 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8506300449371338
Epoch: 15, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.248147964477539
Epoch: 16, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9135515689849854
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.357 Vali Acc: 0.953 Test Loss: 0.357 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4679763317108154
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8512144088745117
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8742268085479736
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9425320625305176
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9318161010742188
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.953 Test Loss: 0.366 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 23727385
model size : 105.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4175450801849365
Epoch: 1, Steps: 18 | Train Loss: 3.221 Vali Loss: 2.665 Vali Acc: 0.420 Test Loss: 2.665 Test Acc: 0.420
Validation loss decreased (inf --> -0.419973).  Saving model ...
Epoch: 2 cost time: 1.3851003646850586
Epoch: 2, Steps: 18 | Train Loss: 2.211 Vali Loss: 1.472 Vali Acc: 0.763 Test Loss: 1.472 Test Acc: 0.763
Validation loss decreased (-0.419973 --> -0.763319).  Saving model ...
Epoch: 3 cost time: 1.4780049324035645
Epoch: 3, Steps: 18 | Train Loss: 0.865 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
Validation loss decreased (-0.763319 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.8016843795776367
Epoch: 4, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.182 Vali Acc: 0.947 Test Loss: 0.182 Test Acc: 0.947
Validation loss decreased (-0.929997 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.6073074340820312
Epoch: 5, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6789875030517578
Epoch: 6, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
Validation loss decreased (-0.946665 --> -0.953332).  Saving model ...
Epoch: 7 cost time: 1.6404197216033936
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.953332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.233942985534668
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5078916549682617
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2522449493408203
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.7756037712097168
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.6047947406768799
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.403717041015625
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.7806053161621094
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.596785306930542
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 1.405102252960205
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3254756927490234
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9358034133911133
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3250925540924072
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3229749202728271
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4575483798980713
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0624136924743652
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5212852954864502
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9039721488952637
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5026178359985352
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 23022361
model size : 102.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.413663625717163
Epoch: 1, Steps: 18 | Train Loss: 3.216 Vali Loss: 2.871 Vali Acc: 0.377 Test Loss: 2.871 Test Acc: 0.377
Validation loss decreased (inf --> -0.376638).  Saving model ...
Epoch: 2 cost time: 1.1688997745513916
Epoch: 2, Steps: 18 | Train Loss: 2.520 Vali Loss: 2.015 Vali Acc: 0.860 Test Loss: 2.015 Test Acc: 0.860
Validation loss decreased (-0.376638 --> -0.859980).  Saving model ...
Epoch: 3 cost time: 1.359358787536621
Epoch: 3, Steps: 18 | Train Loss: 1.472 Vali Loss: 0.734 Vali Acc: 0.943 Test Loss: 0.734 Test Acc: 0.943
Validation loss decreased (-0.859980 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 1.4954805374145508
Epoch: 4, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7594373226165771
Epoch: 5, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2027952671051025
Epoch: 6, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.943326 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.738518238067627
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.698575735092163
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5749976634979248
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.016113042831421
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3130807876586914
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8587782382965088
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6928508281707764
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.0690934658050537
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.444678544998169
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.7445013523101807
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.238379716873169
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6358439922332764
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3198282718658447
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.2803900241851807
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9003617763519287
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1246051788330078
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.1340570449829102
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.1026346683502197
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8624839782714844
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.825451135635376
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.0158023834228516
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2863669395446777
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2730460166931152
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8759059906005859
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5979630947113037
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1412084102630615
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.636669397354126
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1036086082458496
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1156418323516846
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.382805347442627
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22669849
model size : 101.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.157953977584839
Epoch: 1, Steps: 18 | Train Loss: 3.172 Vali Loss: 2.503 Vali Acc: 0.480 Test Loss: 2.503 Test Acc: 0.480
Validation loss decreased (inf --> -0.479975).  Saving model ...
Epoch: 2 cost time: 1.9203259944915771
Epoch: 2, Steps: 18 | Train Loss: 1.847 Vali Loss: 1.099 Vali Acc: 0.827 Test Loss: 1.099 Test Acc: 0.827
Validation loss decreased (-0.479975 --> -0.826656).  Saving model ...
Epoch: 3 cost time: 2.1633267402648926
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.826656 --> -0.933331).  Saving model ...
Epoch: 4 cost time: 2.0446743965148926
Epoch: 4, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.520 Vali Acc: 0.887 Test Loss: 0.520 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3396754264831543
Epoch: 5, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.258 Vali Acc: 0.920 Test Loss: 0.258 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8107573986053467
Epoch: 6, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.237 Vali Acc: 0.940 Test Loss: 0.237 Test Acc: 0.940
Validation loss decreased (-0.933331 --> -0.939998).  Saving model ...
Epoch: 7 cost time: 1.6226844787597656
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.939998 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.4394724369049072
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.7190062999725342
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.6022229194641113
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.115391731262207
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1471388339996338
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3240633010864258
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3279361724853516
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5882949829101562
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3894670009613037
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.217970371246338
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5956721305847168
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6085925102233887
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 23271193
model size : 103.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.770256757736206
Epoch: 1, Steps: 18 | Train Loss: 3.226 Vali Loss: 2.660 Vali Acc: 0.470 Test Loss: 2.660 Test Acc: 0.470
Validation loss decreased (inf --> -0.469973).  Saving model ...
Epoch: 2 cost time: 1.0720512866973877
Epoch: 2, Steps: 18 | Train Loss: 2.184 Vali Loss: 1.410 Vali Acc: 0.900 Test Loss: 1.410 Test Acc: 0.900
Validation loss decreased (-0.469973 --> -0.899986).  Saving model ...
Epoch: 3 cost time: 1.0635662078857422
Epoch: 3, Steps: 18 | Train Loss: 0.915 Vali Loss: 0.312 Vali Acc: 0.957 Test Loss: 0.312 Test Acc: 0.957
Validation loss decreased (-0.899986 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 1.201941728591919
Epoch: 4, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 1.6897540092468262
Epoch: 5, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.167088270187378
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.585468053817749
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1920435428619385
Epoch: 8, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3358864784240723
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.4668731689453125
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9048852920532227
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3951492309570312
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4634764194488525
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1412627696990967
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3558216094970703
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.282677173614502
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0728321075439453
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3561582565307617
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8548264503479004
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0352303981781006
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7725365161895752
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1697642803192139
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22897945
model size : 102.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5006043910980225
Epoch: 1, Steps: 18 | Train Loss: 3.240 Vali Loss: 2.894 Vali Acc: 0.337 Test Loss: 2.894 Test Acc: 0.337
Validation loss decreased (inf --> -0.336638).  Saving model ...
Epoch: 2 cost time: 0.7526931762695312
Epoch: 2, Steps: 18 | Train Loss: 2.597 Vali Loss: 2.084 Vali Acc: 0.837 Test Loss: 2.084 Test Acc: 0.837
Validation loss decreased (-0.336638 --> -0.836646).  Saving model ...
Epoch: 3 cost time: 1.1478633880615234
Epoch: 3, Steps: 18 | Train Loss: 1.602 Vali Loss: 0.866 Vali Acc: 0.923 Test Loss: 0.866 Test Acc: 0.923
Validation loss decreased (-0.836646 --> -0.923325).  Saving model ...
Epoch: 4 cost time: 0.727851152420044
Epoch: 4, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
Validation loss decreased (-0.923325 --> -0.936664).  Saving model ...
Epoch: 5 cost time: 0.7729578018188477
Epoch: 5, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
Validation loss decreased (-0.936664 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 0.9649899005889893
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.959998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.8162600994110107
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7046644687652588
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9463081359863281
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.1130821704864502
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7160983085632324
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6279540061950684
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5315868854522705
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3020241260528564
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.3214645385742188
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1119258403778076
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.1347005367279053
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.3165340423583984
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9191193580627441
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7346034049987793
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.1851210594177246
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 1.8893799781799316
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3787105083465576
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.320901870727539
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1171939373016357
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7002885341644287
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4721193313598633
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.5353024005889893
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6583740711212158
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.307640790939331
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.0210235118865967
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8684537410736084
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.5188899040222168
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.940864086151123
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1785719394683838
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7033822536468506
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.2971539497375488
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3089613914489746
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.101327657699585
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1100897789001465
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0177719593048096
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0738253593444824
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 0.8354036808013916
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8304939270019531
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.400468111038208
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9085326194763184
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.4994661808013916
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7034444808959961
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3379828929901123
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1926486492156982
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 22649113
model size : 101.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7590172290802
Epoch: 1, Steps: 18 | Train Loss: 3.222 Vali Loss: 2.592 Vali Acc: 0.453 Test Loss: 2.592 Test Acc: 0.453
Validation loss decreased (inf --> -0.453307).  Saving model ...
Epoch: 2 cost time: 1.7756445407867432
Epoch: 2, Steps: 18 | Train Loss: 2.053 Vali Loss: 1.181 Vali Acc: 0.837 Test Loss: 1.181 Test Acc: 0.837
Validation loss decreased (-0.453307 --> -0.836655).  Saving model ...
Epoch: 3 cost time: 1.8977806568145752
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
Validation loss decreased (-0.836655 --> -0.936664).  Saving model ...
Epoch: 4 cost time: 1.8659002780914307
Epoch: 4, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.411 Vali Acc: 0.893 Test Loss: 0.411 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.106797456741333
Epoch: 5, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
Validation loss decreased (-0.936664 --> -0.943331).  Saving model ...
Epoch: 6 cost time: 1.297513723373413
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1424388885498047
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
Validation loss decreased (-0.943331 --> -0.953332).  Saving model ...
Epoch: 8 cost time: 1.2091832160949707
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.940 Test Loss: 0.240 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4896364212036133
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.953332 --> -0.956665).  Saving model ...
Epoch: 10 cost time: 1.5217926502227783
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963332).  Saving model ...
Epoch: 11 cost time: 1.0418899059295654
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7438490390777588
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.8165035247802734
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.509624719619751
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.5143096446990967
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0396065711975098
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3058114051818848
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8550636768341064
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4219191074371338
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5176661014556885
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5985901355743408
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7564961910247803
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2545390129089355
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.404329538345337
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 23271193
model size : 103.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9936635494232178
Epoch: 1, Steps: 18 | Train Loss: 3.234 Vali Loss: 2.767 Vali Acc: 0.433 Test Loss: 2.767 Test Acc: 0.433
Validation loss decreased (inf --> -0.433306).  Saving model ...
Epoch: 2 cost time: 1.4325664043426514
Epoch: 2, Steps: 18 | Train Loss: 2.352 Vali Loss: 1.612 Vali Acc: 0.853 Test Loss: 1.612 Test Acc: 0.853
Validation loss decreased (-0.433306 --> -0.853317).  Saving model ...
Epoch: 3 cost time: 1.3975744247436523
Epoch: 3, Steps: 18 | Train Loss: 0.985 Vali Loss: 0.389 Vali Acc: 0.907 Test Loss: 0.389 Test Acc: 0.907
Validation loss decreased (-0.853317 --> -0.906663).  Saving model ...
Epoch: 4 cost time: 1.300340175628662
Epoch: 4, Steps: 18 | Train Loss: 0.260 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.906663 --> -0.916664).  Saving model ...
Epoch: 5 cost time: 1.62831711769104
Epoch: 5, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.916664 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.6141822338104248
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.42940354347229
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5363662242889404
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6156036853790283
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.5114822387695312
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.325890302658081
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.4553749561309814
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2488789558410645
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2266936302185059
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1158719062805176
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5998241901397705
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4552185535430908
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7044823169708252
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3404293060302734
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.3134551048278809
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2477295398712158
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7533469200134277
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2614293098449707
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4797446727752686
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4879405498504639
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9876344203948975
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.7481565475463867
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5216686725616455
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6674213409423828
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2318027019500732
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.275759220123291
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4371767044067383
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.068655252456665
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.783076286315918
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.430084466934204
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2110178470611572
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7102832794189453
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3598010540008545
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1161088943481445
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6772055625915527
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22897945
model size : 102.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5307157039642334
Epoch: 1, Steps: 18 | Train Loss: 3.269 Vali Loss: 2.960 Vali Acc: 0.233 Test Loss: 2.960 Test Acc: 0.233
Validation loss decreased (inf --> -0.233304).  Saving model ...
Epoch: 2 cost time: 1.021653652191162
Epoch: 2, Steps: 18 | Train Loss: 2.665 Vali Loss: 2.233 Vali Acc: 0.777 Test Loss: 2.233 Test Acc: 0.777
Validation loss decreased (-0.233304 --> -0.776644).  Saving model ...
Epoch: 3 cost time: 1.2558085918426514
Epoch: 3, Steps: 18 | Train Loss: 1.773 Vali Loss: 0.984 Vali Acc: 0.927 Test Loss: 0.984 Test Acc: 0.927
Validation loss decreased (-0.776644 --> -0.926657).  Saving model ...
Epoch: 4 cost time: 0.9680960178375244
Epoch: 4, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.262 Vali Acc: 0.947 Test Loss: 0.262 Test Acc: 0.947
Validation loss decreased (-0.926657 --> -0.946664).  Saving model ...
Epoch: 5 cost time: 1.2634882926940918
Epoch: 5, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
Validation loss decreased (-0.946664 --> -0.953332).  Saving model ...
Epoch: 6 cost time: 1.240757703781128
Epoch: 6, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.1188514232635498
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2524871826171875
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.963 Test Loss: 0.109 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1443560123443604
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.2069897651672363
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.063786268234253
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1883618831634521
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1249744892120361
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3247332572937012
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0292534828186035
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1103966236114502
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9530956745147705
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0860624313354492
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.081387996673584
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.063934326171875
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.223233938217163
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9489622116088867
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.265326976776123
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1505565643310547
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.4319260120391846
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.2259695529937744
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4086201190948486
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0511243343353271
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.412252426147461
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.429537057876587
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3084383010864258
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.288649559020996
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3446276187896729
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1739556789398193
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1519224643707275
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9620568752288818
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.030951976776123
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.976219654083252
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1355869770050049
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0867116451263428
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8577718734741211
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1124012470245361
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9079146385192871
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8000695705413818
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1764767169952393
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.898780107498169
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1326775550842285
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22628377
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0421953201293945
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 2.549 Vali Acc: 0.590 Test Loss: 2.549 Test Acc: 0.590
Validation loss decreased (inf --> -0.589975).  Saving model ...
Epoch: 2 cost time: 1.731177806854248
Epoch: 2, Steps: 18 | Train Loss: 1.906 Vali Loss: 1.089 Vali Acc: 0.830 Test Loss: 1.089 Test Acc: 0.830
Validation loss decreased (-0.589975 --> -0.829989).  Saving model ...
Epoch: 3 cost time: 1.5630042552947998
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.282 Vali Acc: 0.927 Test Loss: 0.282 Test Acc: 0.927
Validation loss decreased (-0.829989 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 1.5768473148345947
Epoch: 4, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.203 Vali Acc: 0.940 Test Loss: 0.203 Test Acc: 0.940
Validation loss decreased (-0.926664 --> -0.939998).  Saving model ...
Epoch: 5 cost time: 1.4234192371368408
Epoch: 5, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.268 Vali Acc: 0.940 Test Loss: 0.268 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2634851932525635
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.939998 --> -0.949998).  Saving model ...
Epoch: 7 cost time: 1.4515893459320068
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.949998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.399526596069336
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9369730949401855
Epoch: 9, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4423298835754395
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2364087104797363
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9398708343505859
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0467674732208252
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8942914009094238
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.9212825298309326
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.838465929031372
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 1.3989567756652832
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 1.5516245365142822
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 1.3310368061065674
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 1.4728565216064453
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 1.7806406021118164
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.036651611328125
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 1.2827951908111572
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 1.7476296424865723
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.786850929260254
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 1.5990502834320068
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 1.5442562103271484
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 1.7777187824249268
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 1.597106695175171
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 1.7446320056915283
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 0.9354939460754395
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 1.2962822914123535
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1888065338134766
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.42525315284729
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2054522037506104
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1342098712921143
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1061067581176758
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 38 cost time: 1.3843390941619873
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3311877250671387
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 40 cost time: 1.5800974369049072
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 41 cost time: 1.4578678607940674
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 42 cost time: 1.4057996273040771
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.255005121231079
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 44 cost time: 1.4910423755645752
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 45 cost time: 1.3856592178344727
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7877116203308105
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 47 cost time: 1.2393336296081543
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 48 cost time: 1.8380756378173828
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 49 cost time: 1.7088541984558105
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.365781307220459
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 23291929
model size : 103.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.744206428527832
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 2.790 Vali Acc: 0.473 Test Loss: 2.790 Test Acc: 0.473
Validation loss decreased (inf --> -0.473305).  Saving model ...
Epoch: 2 cost time: 1.5631346702575684
Epoch: 2, Steps: 18 | Train Loss: 2.388 Vali Loss: 1.725 Vali Acc: 0.823 Test Loss: 1.725 Test Acc: 0.823
Validation loss decreased (-0.473305 --> -0.823316).  Saving model ...
Epoch: 3 cost time: 1.4780585765838623
Epoch: 3, Steps: 18 | Train Loss: 1.131 Vali Loss: 0.485 Vali Acc: 0.890 Test Loss: 0.485 Test Acc: 0.890
Validation loss decreased (-0.823316 --> -0.889995).  Saving model ...
Epoch: 4 cost time: 0.8033006191253662
Epoch: 4, Steps: 18 | Train Loss: 0.322 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
Validation loss decreased (-0.889995 --> -0.919997).  Saving model ...
Epoch: 5 cost time: 1.3498225212097168
Epoch: 5, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.220 Vali Acc: 0.913 Test Loss: 0.220 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3499455451965332
Epoch: 6, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.919997 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.696908712387085
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4133920669555664
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.2587940692901611
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.2271990776062012
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.483569860458374
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1481037139892578
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2280175685882568
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6100871562957764
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3394908905029297
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.7059051990509033
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.163215160369873
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6700012683868408
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.7501697540283203
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.4025402069091797
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6554110050201416
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2943000793457031
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6229419708251953
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.192352294921875
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6235454082489014
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0647380352020264
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6464893817901611
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2268602848052979
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5869085788726807
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22835737
model size : 101.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4875028133392334
Epoch: 1, Steps: 18 | Train Loss: 3.297 Vali Loss: 2.980 Vali Acc: 0.310 Test Loss: 2.980 Test Acc: 0.310
Validation loss decreased (inf --> -0.309970).  Saving model ...
Epoch: 2 cost time: 0.924492359161377
Epoch: 2, Steps: 18 | Train Loss: 2.744 Vali Loss: 2.268 Vali Acc: 0.803 Test Loss: 2.268 Test Acc: 0.803
Validation loss decreased (-0.309970 --> -0.803311).  Saving model ...
Epoch: 3 cost time: 0.9760687351226807
Epoch: 3, Steps: 18 | Train Loss: 1.793 Vali Loss: 1.006 Vali Acc: 0.920 Test Loss: 1.006 Test Acc: 0.920
Validation loss decreased (-0.803311 --> -0.919990).  Saving model ...
Epoch: 4 cost time: 0.8745005130767822
Epoch: 4, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.248 Vali Acc: 0.960 Test Loss: 0.248 Test Acc: 0.960
Validation loss decreased (-0.919990 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 0.7196099758148193
Epoch: 5, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.252 Vali Acc: 0.910 Test Loss: 0.252 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9230072498321533
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.9319126605987549
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.888094425201416
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0182170867919922
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.2679622173309326
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.202606201171875
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.0201084613800049
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.200767993927002
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8463590145111084
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2216577529907227
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.044306993484497
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.972888708114624
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.225010633468628
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.06892728805542
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0458965301513672
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.273921012878418
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.2780961990356445
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0622506141662598
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1797559261322021
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0519211292266846
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0340898036956787
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1673376560211182
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0916872024536133
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2397606372833252
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.959881067276001
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.0391435623168945
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8367793560028076
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.851154088973999
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8352663516998291
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.8559987545013428
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9422709941864014
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.9408268928527832
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.9115428924560547
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9107875823974609
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.9033944606781006
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8512101173400879
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1255598068237305
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9333317279815674
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9535763263702393
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0167732238769531
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7826821804046631
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.992354154586792
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6344213485717773
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7073328495025635
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22628377
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.497178792953491
Epoch: 1, Steps: 18 | Train Loss: 3.198 Vali Loss: 2.593 Vali Acc: 0.400 Test Loss: 2.593 Test Acc: 0.400
Validation loss decreased (inf --> -0.399974).  Saving model ...
Epoch: 2 cost time: 1.445765733718872
Epoch: 2, Steps: 18 | Train Loss: 1.970 Vali Loss: 1.127 Vali Acc: 0.833 Test Loss: 1.127 Test Acc: 0.833
Validation loss decreased (-0.399974 --> -0.833322).  Saving model ...
Epoch: 3 cost time: 1.433089256286621
Epoch: 3, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.341 Vali Acc: 0.930 Test Loss: 0.341 Test Acc: 0.930
Validation loss decreased (-0.833322 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.3630971908569336
Epoch: 4, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.929997 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.2708489894866943
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.442445993423462
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2842059135437012
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3526544570922852
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3354194164276123
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1663458347320557
Epoch: 10, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3821349143981934
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.9540913105010986
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.9734909534454346
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.4504578113555908
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.4658324718475342
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8148131370544434
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.021188735961914
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6235473155975342
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8018615245819092
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3254451751708984
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9626829624176025
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.476736068725586
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4318816661834717
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7545835971832275
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 23312665
model size : 103.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.905247926712036
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 2.816 Vali Acc: 0.377 Test Loss: 2.816 Test Acc: 0.377
Validation loss decreased (inf --> -0.376639).  Saving model ...
Epoch: 2 cost time: 1.3886706829071045
Epoch: 2, Steps: 18 | Train Loss: 2.447 Vali Loss: 1.737 Vali Acc: 0.827 Test Loss: 1.737 Test Acc: 0.827
Validation loss decreased (-0.376639 --> -0.826649).  Saving model ...
Epoch: 3 cost time: 1.4999101161956787
Epoch: 3, Steps: 18 | Train Loss: 1.133 Vali Loss: 0.509 Vali Acc: 0.920 Test Loss: 0.509 Test Acc: 0.920
Validation loss decreased (-0.826649 --> -0.919995).  Saving model ...
Epoch: 4 cost time: 1.6832430362701416
Epoch: 4, Steps: 18 | Train Loss: 0.351 Vali Loss: 0.277 Vali Acc: 0.927 Test Loss: 0.277 Test Acc: 0.927
Validation loss decreased (-0.919995 --> -0.926664).  Saving model ...
Epoch: 5 cost time: 1.542846918106079
Epoch: 5, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.157 Vali Acc: 0.947 Test Loss: 0.157 Test Acc: 0.947
Validation loss decreased (-0.926664 --> -0.946665).  Saving model ...
Epoch: 6 cost time: 1.5799665451049805
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.946665 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.7193853855133057
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.966665 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.5697832107543945
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.636509895324707
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4037423133850098
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 0.9937288761138916
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.1036725044250488
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7571759223937988
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0580122470855713
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.029362440109253
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.010042428970337
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.279890775680542
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1159887313842773
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6751034259796143
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2384862899780273
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.150970220565796
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 22856473
model size : 101.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.526639699935913
Epoch: 1, Steps: 18 | Train Loss: 3.266 Vali Loss: 2.946 Vali Acc: 0.227 Test Loss: 2.946 Test Acc: 0.227
Validation loss decreased (inf --> -0.226637).  Saving model ...
Epoch: 2 cost time: 0.8922128677368164
Epoch: 2, Steps: 18 | Train Loss: 2.723 Vali Loss: 2.315 Vali Acc: 0.730 Test Loss: 2.315 Test Acc: 0.730
Validation loss decreased (-0.226637 --> -0.729977).  Saving model ...
Epoch: 3 cost time: 0.8188490867614746
Epoch: 3, Steps: 18 | Train Loss: 1.928 Vali Loss: 1.203 Vali Acc: 0.910 Test Loss: 1.203 Test Acc: 0.910
Validation loss decreased (-0.729977 --> -0.909988).  Saving model ...
Epoch: 4 cost time: 1.2119739055633545
Epoch: 4, Steps: 18 | Train Loss: 0.911 Vali Loss: 0.454 Vali Acc: 0.907 Test Loss: 0.454 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8620684146881104
Epoch: 5, Steps: 18 | Train Loss: 0.257 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.909988 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.9722564220428467
Epoch: 6, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.167 Vali Acc: 0.947 Test Loss: 0.167 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7737689018249512
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.097970962524414
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9793996810913086
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.1830132007598877
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9337759017944336
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8707752227783203
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1503205299377441
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8650572299957275
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1344857215881348
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0077800750732422
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1826560497283936
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1797637939453125
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 0.7803411483764648
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.0581471920013428
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.1953537464141846
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8967940807342529
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1279006004333496
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.0530695915222168
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 0.8395707607269287
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.0307204723358154
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 0.9117608070373535
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 0.9903042316436768
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.108893632888794
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.060152292251587
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9793832302093506
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2195804119110107
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8942711353302002
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9899919033050537
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8139698505401611
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9116723537445068
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7898359298706055
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7037632465362549
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7779037952423096
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 22628377
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6322696208953857
Epoch: 1, Steps: 18 | Train Loss: 3.235 Vali Loss: 2.648 Vali Acc: 0.400 Test Loss: 2.648 Test Acc: 0.400
Validation loss decreased (inf --> -0.399974).  Saving model ...
Epoch: 2 cost time: 1.7269461154937744
Epoch: 2, Steps: 18 | Train Loss: 2.134 Vali Loss: 1.301 Vali Acc: 0.850 Test Loss: 1.301 Test Acc: 0.850
Validation loss decreased (-0.399974 --> -0.849987).  Saving model ...
Epoch: 3 cost time: 1.7037758827209473
Epoch: 3, Steps: 18 | Train Loss: 0.768 Vali Loss: 0.338 Vali Acc: 0.910 Test Loss: 0.338 Test Acc: 0.910
Validation loss decreased (-0.849987 --> -0.909997).  Saving model ...
Epoch: 4 cost time: 0.9434566497802734
Epoch: 4, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
Validation loss decreased (-0.909997 --> -0.943332).  Saving model ...
Epoch: 5 cost time: 0.8545045852661133
Epoch: 5, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.262 Vali Acc: 0.940 Test Loss: 0.262 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6821043491363525
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.943332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.3003604412078857
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2075300216674805
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2771391868591309
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7003626823425293
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3424291610717773
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.960 Test Loss: 0.107 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2203986644744873
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.963 Test Loss: 0.099 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6368350982666016
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4675421714782715
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.967 Test Loss: 0.094 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2332472801208496
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.967 Test Loss: 0.095 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.188779354095459
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6638891696929932
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0370464324951172
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 23105305
model size : 102.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6876766681671143
Epoch: 1, Steps: 18 | Train Loss: 3.226 Vali Loss: 2.796 Vali Acc: 0.440 Test Loss: 2.796 Test Acc: 0.440
Validation loss decreased (inf --> -0.439972).  Saving model ...
Epoch: 2 cost time: 0.9777929782867432
Epoch: 2, Steps: 18 | Train Loss: 2.414 Vali Loss: 1.784 Vali Acc: 0.870 Test Loss: 1.784 Test Acc: 0.870
Validation loss decreased (-0.439972 --> -0.869982).  Saving model ...
Epoch: 3 cost time: 0.8191103935241699
Epoch: 3, Steps: 18 | Train Loss: 1.264 Vali Loss: 0.546 Vali Acc: 0.893 Test Loss: 0.546 Test Acc: 0.893
Validation loss decreased (-0.869982 --> -0.893328).  Saving model ...
Epoch: 4 cost time: 0.895770788192749
Epoch: 4, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.893328 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 1.7340126037597656
Epoch: 5, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3254244327545166
Epoch: 6, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.949998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6088674068450928
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9757757186889648
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.631727695465088
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.429455280303955
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9537909030914307
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5939114093780518
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2507991790771484
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9931161403656006
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4627435207366943
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2271461486816406
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6744470596313477
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1669294834136963
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9569506645202637
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0284130573272705
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8938593864440918
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5668342113494873
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.256941556930542
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.251772165298462
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1977248191833496
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4495556354522705
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1274919509887695
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2346019744873047
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22815001
model size : 101.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3160672187805176
Epoch: 1, Steps: 18 | Train Loss: 3.320 Vali Loss: 3.036 Vali Acc: 0.173 Test Loss: 3.036 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 1.1960952281951904
Epoch: 2, Steps: 18 | Train Loss: 2.812 Vali Loss: 2.429 Vali Acc: 0.823 Test Loss: 2.429 Test Acc: 0.823
Validation loss decreased (-0.173303 --> -0.823309).  Saving model ...
Epoch: 3 cost time: 1.0012595653533936
Epoch: 3, Steps: 18 | Train Loss: 2.076 Vali Loss: 1.336 Vali Acc: 0.943 Test Loss: 1.336 Test Acc: 0.943
Validation loss decreased (-0.823309 --> -0.943320).  Saving model ...
Epoch: 4 cost time: 1.1039764881134033
Epoch: 4, Steps: 18 | Train Loss: 0.971 Vali Loss: 0.322 Vali Acc: 0.953 Test Loss: 0.322 Test Acc: 0.953
Validation loss decreased (-0.943320 --> -0.953330).  Saving model ...
Epoch: 5 cost time: 0.9518430233001709
Epoch: 5, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7967119216918945
Epoch: 6, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.953330 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.8669130802154541
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.8921639919281006
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6694056987762451
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7768831253051758
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8415975570678711
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8685550689697266
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9259307384490967
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0720698833465576
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8294599056243896
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1714472770690918
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7632839679718018
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6499550342559814
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6630923748016357
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.6298763751983643
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7268342971801758
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8436353206634521
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.047135829925537
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9300007820129395
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8086121082305908
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7121758460998535
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7320239543914795
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8885364532470703
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.0042312145233154
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0283143520355225
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9360744953155518
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9741702079772949
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8077797889709473
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7768335342407227
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.084167718887329
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7102937698364258
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0946402549743652
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.826643705368042
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7411031723022461
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.0445067882537842
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.9842851161956787
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7623252868652344
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6883194446563721
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.890678882598877
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8948795795440674
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9335777759552002
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8477780818939209
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6048855781555176
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7132067680358887
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8763031959533691
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22628377
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2320940494537354
Epoch: 1, Steps: 18 | Train Loss: 3.139 Vali Loss: 2.618 Vali Acc: 0.460 Test Loss: 2.618 Test Acc: 0.460
Validation loss decreased (inf --> -0.459974).  Saving model ...
Epoch: 2 cost time: 0.872004508972168
Epoch: 2, Steps: 18 | Train Loss: 2.091 Vali Loss: 1.283 Vali Acc: 0.847 Test Loss: 1.283 Test Acc: 0.847
Validation loss decreased (-0.459974 --> -0.846654).  Saving model ...
Epoch: 3 cost time: 1.4165096282958984
Epoch: 3, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.307 Vali Acc: 0.923 Test Loss: 0.307 Test Acc: 0.923
Validation loss decreased (-0.846654 --> -0.923330).  Saving model ...
Epoch: 4 cost time: 1.4057815074920654
Epoch: 4, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.923330 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.5066630840301514
Epoch: 5, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.327 Vali Acc: 0.897 Test Loss: 0.327 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.444474220275879
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.2022264003753662
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8064084053039551
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8490216732025146
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2633867263793945
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6041834354400635
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1895217895507812
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0908339023590088
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.957 Test Loss: 0.218 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3632962703704834
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9758782386779785
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.6204612255096436
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8797512054443359
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6457698345184326
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2363767623901367
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1496622562408447
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7566883563995361
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1426386833190918
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.213465690612793
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7799837589263916
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2233364582061768
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 23126041
model size : 102.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.40702486038208
Epoch: 1, Steps: 18 | Train Loss: 3.275 Vali Loss: 2.895 Vali Acc: 0.340 Test Loss: 2.895 Test Acc: 0.340
Validation loss decreased (inf --> -0.339971).  Saving model ...
Epoch: 2 cost time: 0.9351553916931152
Epoch: 2, Steps: 18 | Train Loss: 2.534 Vali Loss: 1.999 Vali Acc: 0.847 Test Loss: 1.999 Test Acc: 0.847
Validation loss decreased (-0.339971 --> -0.846647).  Saving model ...
Epoch: 3 cost time: 1.2032952308654785
Epoch: 3, Steps: 18 | Train Loss: 1.502 Vali Loss: 0.693 Vali Acc: 0.917 Test Loss: 0.693 Test Acc: 0.917
Validation loss decreased (-0.846647 --> -0.916660).  Saving model ...
Epoch: 4 cost time: 1.0178978443145752
Epoch: 4, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
Validation loss decreased (-0.916660 --> -0.926664).  Saving model ...
Epoch: 5 cost time: 0.9726545810699463
Epoch: 5, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.148 Vali Acc: 0.950 Test Loss: 0.148 Test Acc: 0.950
Validation loss decreased (-0.926664 --> -0.949999).  Saving model ...
Epoch: 6 cost time: 0.8668365478515625
Epoch: 6, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
Validation loss decreased (-0.949999 --> -0.959999).  Saving model ...
Epoch: 7 cost time: 0.9002859592437744
Epoch: 7, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.959999 --> -0.963332).  Saving model ...
Epoch: 8 cost time: 0.9508647918701172
Epoch: 8, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.0103087425231934
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.7324948310852051
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8890655040740967
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7581446170806885
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9021141529083252
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7335717678070068
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.910902738571167
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0371105670928955
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9471328258514404
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.8121511936187744
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.030275821685791
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4659221172332764
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0783188343048096
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.286823034286499
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7055892944335938
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4633469581604004
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.754941701889038
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3295700550079346
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6096978187561035
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.444756031036377
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22794265
model size : 101.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2338006496429443
Epoch: 1, Steps: 18 | Train Loss: 3.275 Vali Loss: 2.955 Vali Acc: 0.230 Test Loss: 2.955 Test Acc: 0.230
Validation loss decreased (inf --> -0.229970).  Saving model ...
Epoch: 2 cost time: 0.8374755382537842
Epoch: 2, Steps: 18 | Train Loss: 2.745 Vali Loss: 2.356 Vali Acc: 0.727 Test Loss: 2.356 Test Acc: 0.727
Validation loss decreased (-0.229970 --> -0.726643).  Saving model ...
Epoch: 3 cost time: 0.822650671005249
Epoch: 3, Steps: 18 | Train Loss: 2.042 Vali Loss: 1.343 Vali Acc: 0.880 Test Loss: 1.343 Test Acc: 0.880
Validation loss decreased (-0.726643 --> -0.879987).  Saving model ...
Epoch: 4 cost time: 0.852135181427002
Epoch: 4, Steps: 18 | Train Loss: 1.012 Vali Loss: 0.435 Vali Acc: 0.933 Test Loss: 0.435 Test Acc: 0.933
Validation loss decreased (-0.879987 --> -0.933329).  Saving model ...
Epoch: 5 cost time: 1.0192015171051025
Epoch: 5, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.933329 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 1.01377534866333
Epoch: 6, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.180 Vali Acc: 0.940 Test Loss: 0.180 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0464603900909424
Epoch: 7, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959999).  Saving model ...
Epoch: 8 cost time: 0.9633281230926514
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.959999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1098377704620361
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9103071689605713
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0860652923583984
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7086598873138428
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9852418899536133
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8713135719299316
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8851547241210938
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8938119411468506
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8723909854888916
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8752179145812988
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.8723764419555664
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.9287128448486328
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8855364322662354
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8709285259246826
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.025404691696167
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8713204860687256
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8150608539581299
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9812006950378418
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.820826530456543
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8257498741149902
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.019615888595581
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9078981876373291
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.985588788986206
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8165862560272217
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0187454223632812
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0611357688903809
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22628377
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0694808959960938
Epoch: 1, Steps: 18 | Train Loss: 3.301 Vali Loss: 2.644 Vali Acc: 0.430 Test Loss: 2.644 Test Acc: 0.430
Validation loss decreased (inf --> -0.429974).  Saving model ...
Epoch: 2 cost time: 1.316129446029663
Epoch: 2, Steps: 18 | Train Loss: 2.094 Vali Loss: 1.174 Vali Acc: 0.900 Test Loss: 1.174 Test Acc: 0.900
Validation loss decreased (-0.429974 --> -0.899988).  Saving model ...
Epoch: 3 cost time: 1.4103779792785645
Epoch: 3, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.899988 --> -0.916664).  Saving model ...
Epoch: 4 cost time: 1.365095615386963
Epoch: 4, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.916664 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.3261396884918213
Epoch: 5, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3729643821716309
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3493859767913818
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3225793838500977
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.2410352230072021
Epoch: 9, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.3358170986175537
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.428055763244629
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3194983005523682
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.0144531726837158
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2360174655914307
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2755358219146729
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3157174587249756
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.496567726135254
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2971930503845215
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8488891124725342
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.382988691329956
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0815372467041016
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3262529373168945
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 23146777
model size : 102.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6017980575561523
Epoch: 1, Steps: 18 | Train Loss: 3.223 Vali Loss: 2.830 Vali Acc: 0.450 Test Loss: 2.830 Test Acc: 0.450
Validation loss decreased (inf --> -0.449972).  Saving model ...
Epoch: 2 cost time: 1.0650606155395508
Epoch: 2, Steps: 18 | Train Loss: 2.526 Vali Loss: 1.884 Vali Acc: 0.830 Test Loss: 1.884 Test Acc: 0.830
Validation loss decreased (-0.449972 --> -0.829981).  Saving model ...
Epoch: 3 cost time: 1.4385387897491455
Epoch: 3, Steps: 18 | Train Loss: 1.405 Vali Loss: 0.595 Vali Acc: 0.907 Test Loss: 0.595 Test Acc: 0.907
Validation loss decreased (-0.829981 --> -0.906661).  Saving model ...
Epoch: 4 cost time: 1.3254551887512207
Epoch: 4, Steps: 18 | Train Loss: 0.444 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.906661 --> -0.949998).  Saving model ...
Epoch: 5 cost time: 1.3078815937042236
Epoch: 5, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959999).  Saving model ...
Epoch: 6 cost time: 1.6041405200958252
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.569455862045288
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.208676815032959
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1209115982055664
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.6224806308746338
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3673105239868164
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1186764240264893
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7103996276855469
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6599493026733398
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1005709171295166
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9863612651824951
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0687403678894043
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1801369190216064
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.303034782409668
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.003232479095459
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2158141136169434
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1974842548370361
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2807254791259766
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3493235111236572
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1082165241241455
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22815001
model size : 101.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.365540027618408
Epoch: 1, Steps: 18 | Train Loss: 3.270 Vali Loss: 3.017 Vali Acc: 0.167 Test Loss: 3.017 Test Acc: 0.167
Validation loss decreased (inf --> -0.166636).  Saving model ...
Epoch: 2 cost time: 0.7907087802886963
Epoch: 2, Steps: 18 | Train Loss: 2.834 Vali Loss: 2.419 Vali Acc: 0.737 Test Loss: 2.419 Test Acc: 0.737
Validation loss decreased (-0.166636 --> -0.736642).  Saving model ...
Epoch: 3 cost time: 0.8431785106658936
Epoch: 3, Steps: 18 | Train Loss: 2.074 Vali Loss: 1.372 Vali Acc: 0.907 Test Loss: 1.372 Test Acc: 0.907
Validation loss decreased (-0.736642 --> -0.906653).  Saving model ...
Epoch: 4 cost time: 1.0176448822021484
Epoch: 4, Steps: 18 | Train Loss: 0.987 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.906653 --> -0.949996).  Saving model ...
Epoch: 5 cost time: 0.8916537761688232
Epoch: 5, Steps: 18 | Train Loss: 0.284 Vali Loss: 0.177 Vali Acc: 0.947 Test Loss: 0.177 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.71567702293396
Epoch: 6, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
Validation loss decreased (-0.949996 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 0.9586923122406006
Epoch: 7, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0924324989318848
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.897594690322876
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8249166011810303
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0101876258850098
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8020920753479004
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0140135288238525
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8024461269378662
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8227527141571045
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8055109977722168
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8690004348754883
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0471580028533936
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6744904518127441
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5967705249786377
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0206637382507324
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8981809616088867
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0314977169036865
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.955890417098999
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.9190318584442139
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9234158992767334
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9383363723754883
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.9590141773223877
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0842280387878418
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9291749000549316
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1063969135284424
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0355751514434814
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9639506340026855
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0481452941894531
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8863232135772705
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0286099910736084
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.009382724761963
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.0210280418395996
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7462255954742432
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0603373050689697
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9288270473480225
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9739165306091309
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9125638008117676
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.866217851638794
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7985117435455322
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9039285182952881
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.8781425952911377
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.8653934001922607
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.8584816455841064
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9051380157470703
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22649113
model size : 101.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9649593830108643
Epoch: 1, Steps: 18 | Train Loss: 3.246 Vali Loss: 2.764 Vali Acc: 0.443 Test Loss: 2.764 Test Acc: 0.443
Validation loss decreased (inf --> -0.443306).  Saving model ...
Epoch: 2 cost time: 0.9747717380523682
Epoch: 2, Steps: 18 | Train Loss: 2.289 Vali Loss: 1.528 Vali Acc: 0.827 Test Loss: 1.528 Test Acc: 0.827
Validation loss decreased (-0.443306 --> -0.826651).  Saving model ...
Epoch: 3 cost time: 0.7140927314758301
Epoch: 3, Steps: 18 | Train Loss: 0.994 Vali Loss: 0.324 Vali Acc: 0.943 Test Loss: 0.324 Test Acc: 0.943
Validation loss decreased (-0.826651 --> -0.943330).  Saving model ...
Epoch: 4 cost time: 1.1844367980957031
Epoch: 4, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1022164821624756
Epoch: 5, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.181 Vali Acc: 0.940 Test Loss: 0.181 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4516971111297607
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.943330 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.1780116558074951
Epoch: 7, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6252729892730713
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2755327224731445
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.1830224990844727
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.5888655185699463
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2852766513824463
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.474433183670044
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.4359362125396729
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.3791630268096924
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4545118808746338
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.503246784210205
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1703300476074219
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.943 Test Loss: 0.347 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4804110527038574
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1989779472351074
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.681056261062622
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4005506038665771
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5822558403015137
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1094129085540771
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 23043097
model size : 102.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.123751163482666
Epoch: 1, Steps: 18 | Train Loss: 3.257 Vali Loss: 2.907 Vali Acc: 0.340 Test Loss: 2.907 Test Acc: 0.340
Validation loss decreased (inf --> -0.339971).  Saving model ...
Epoch: 2 cost time: 0.7115390300750732
Epoch: 2, Steps: 18 | Train Loss: 2.618 Vali Loss: 2.098 Vali Acc: 0.790 Test Loss: 2.098 Test Acc: 0.790
Validation loss decreased (-0.339971 --> -0.789979).  Saving model ...
Epoch: 3 cost time: 0.8760247230529785
Epoch: 3, Steps: 18 | Train Loss: 1.611 Vali Loss: 0.748 Vali Acc: 0.947 Test Loss: 0.748 Test Acc: 0.947
Validation loss decreased (-0.789979 --> -0.946659).  Saving model ...
Epoch: 4 cost time: 0.9575438499450684
Epoch: 4, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.278 Vali Acc: 0.927 Test Loss: 0.278 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9291670322418213
Epoch: 5, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.946659 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.9636101722717285
Epoch: 6, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7719297409057617
Epoch: 7, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9942114353179932
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.22823166847229
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.1863288879394531
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9603633880615234
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 0.9384756088256836
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3729841709136963
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0102550983428955
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2373313903808594
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1183860301971436
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2119693756103516
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9868535995483398
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0881388187408447
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 0.9725964069366455
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.4303648471832275
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 0.8199801445007324
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8188424110412598
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9819157123565674
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7205791473388672
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.1119208335876465
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8639378547668457
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3230855464935303
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0662930011749268
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2102222442626953
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0352592468261719
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8784472942352295
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9501564502716064
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2633147239685059
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7745163440704346
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 22815001
model size : 101.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1088054180145264
Epoch: 1, Steps: 18 | Train Loss: 3.262 Vali Loss: 3.023 Vali Acc: 0.210 Test Loss: 3.023 Test Acc: 0.210
Validation loss decreased (inf --> -0.209970).  Saving model ...
Epoch: 2 cost time: 0.9395248889923096
Epoch: 2, Steps: 18 | Train Loss: 2.817 Vali Loss: 2.437 Vali Acc: 0.707 Test Loss: 2.437 Test Acc: 0.707
Validation loss decreased (-0.209970 --> -0.706642).  Saving model ...
Epoch: 3 cost time: 0.8619980812072754
Epoch: 3, Steps: 18 | Train Loss: 2.083 Vali Loss: 1.357 Vali Acc: 0.880 Test Loss: 1.357 Test Acc: 0.880
Validation loss decreased (-0.706642 --> -0.879986).  Saving model ...
Epoch: 4 cost time: 0.823810338973999
Epoch: 4, Steps: 18 | Train Loss: 1.069 Vali Loss: 0.367 Vali Acc: 0.947 Test Loss: 0.367 Test Acc: 0.947
Validation loss decreased (-0.879986 --> -0.946663).  Saving model ...
Epoch: 5 cost time: 0.7854790687561035
Epoch: 5, Steps: 18 | Train Loss: 0.277 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0171403884887695
Epoch: 6, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.946663 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 0.8498733043670654
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.8764259815216064
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0557146072387695
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.0192596912384033
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.859809160232544
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8618428707122803
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8421957492828369
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8402998447418213
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7731473445892334
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8437082767486572
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8539085388183594
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8424389362335205
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.874457836151123
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8253493309020996
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7960307598114014
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.759268045425415
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7540733814239502
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7121763229370117
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7565169334411621
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.6678414344787598
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9628026485443115
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7387256622314453
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7093241214752197
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9862849712371826
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6117920875549316
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8781991004943848
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.8691091537475586
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.9489212036132812
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9933512210845947
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7342429161071777
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7250711917877197
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7673325538635254
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9946880340576172
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9853382110595703
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9109714031219482
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.881112813949585
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.9693877696990967
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0099849700927734
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9687900543212891
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.074427843093872
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.883549690246582
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.9260191917419434
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0149524211883545
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.9320588111877441
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22669849
model size : 101.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1492395401000977
Epoch: 1, Steps: 18 | Train Loss: 3.290 Vali Loss: 2.828 Vali Acc: 0.453 Test Loss: 2.828 Test Acc: 0.453
Validation loss decreased (inf --> -0.453305).  Saving model ...
Epoch: 2 cost time: 1.2497351169586182
Epoch: 2, Steps: 18 | Train Loss: 2.426 Vali Loss: 1.741 Vali Acc: 0.853 Test Loss: 1.741 Test Acc: 0.853
Validation loss decreased (-0.453305 --> -0.853316).  Saving model ...
Epoch: 3 cost time: 1.7052347660064697
Epoch: 3, Steps: 18 | Train Loss: 1.124 Vali Loss: 0.395 Vali Acc: 0.923 Test Loss: 0.395 Test Acc: 0.923
Validation loss decreased (-0.853316 --> -0.923329).  Saving model ...
Epoch: 4 cost time: 0.7696280479431152
Epoch: 4, Steps: 18 | Train Loss: 0.232 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
Validation loss decreased (-0.923329 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 1.0590205192565918
Epoch: 5, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
Validation loss decreased (-0.943331 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.1071560382843018
Epoch: 6, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 7 cost time: 1.3209314346313477
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9539997577667236
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.378129482269287
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1686444282531738
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6623494625091553
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 1.5070374011993408
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.4857406616210938
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.9477665424346924
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0371811389923096
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8819766044616699
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.5737028121948242
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.4965934753417969
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7787630558013916
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4837677478790283
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.142146110534668
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.15916109085083
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6840429306030273
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7190392017364502
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.030608892440796
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.030106782913208
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1280145645141602
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8876972198486328
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 23001625
model size : 102.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4316418170928955
Epoch: 1, Steps: 18 | Train Loss: 3.263 Vali Loss: 2.921 Vali Acc: 0.337 Test Loss: 2.921 Test Acc: 0.337
Validation loss decreased (inf --> -0.336637).  Saving model ...
Epoch: 2 cost time: 0.8611047267913818
Epoch: 2, Steps: 18 | Train Loss: 2.642 Vali Loss: 2.173 Vali Acc: 0.763 Test Loss: 2.173 Test Acc: 0.763
Validation loss decreased (-0.336637 --> -0.763312).  Saving model ...
Epoch: 3 cost time: 0.9980173110961914
Epoch: 3, Steps: 18 | Train Loss: 1.706 Vali Loss: 0.925 Vali Acc: 0.907 Test Loss: 0.925 Test Acc: 0.907
Validation loss decreased (-0.763312 --> -0.906657).  Saving model ...
Epoch: 4 cost time: 1.248020887374878
Epoch: 4, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
Validation loss decreased (-0.906657 --> -0.933331).  Saving model ...
Epoch: 5 cost time: 0.9458649158477783
Epoch: 5, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.152 Vali Acc: 0.953 Test Loss: 0.152 Test Acc: 0.953
Validation loss decreased (-0.933331 --> -0.953332).  Saving model ...
Epoch: 6 cost time: 0.7766005992889404
Epoch: 6, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.7460765838623047
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.110682487487793
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7950353622436523
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9968569278717041
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9477038383483887
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.0753452777862549
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.0788803100585938
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9596407413482666
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8266582489013672
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8756382465362549
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.878260612487793
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0624372959136963
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9162039756774902
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.079883098602295
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7919561862945557
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1423497200012207
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7934775352478027
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8059604167938232
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1706023216247559
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9228100776672363
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0000743865966797
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.80735182762146
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0040993690490723
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7732176780700684
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9047155380249023
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9710540771484375
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9376962184906006
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9884271621704102
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22815001
model size : 101.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3112776279449463
Epoch: 1, Steps: 18 | Train Loss: 3.327 Vali Loss: 3.064 Vali Acc: 0.197 Test Loss: 3.064 Test Acc: 0.197
Validation loss decreased (inf --> -0.196636).  Saving model ...
Epoch: 2 cost time: 0.7991418838500977
Epoch: 2, Steps: 18 | Train Loss: 2.900 Vali Loss: 2.540 Vali Acc: 0.667 Test Loss: 2.540 Test Acc: 0.667
Validation loss decreased (-0.196636 --> -0.666641).  Saving model ...
Epoch: 3 cost time: 0.7463726997375488
Epoch: 3, Steps: 18 | Train Loss: 2.270 Vali Loss: 1.674 Vali Acc: 0.860 Test Loss: 1.674 Test Acc: 0.860
Validation loss decreased (-0.666641 --> -0.859983).  Saving model ...
Epoch: 4 cost time: 0.6299741268157959
Epoch: 4, Steps: 18 | Train Loss: 1.319 Vali Loss: 0.596 Vali Acc: 0.927 Test Loss: 0.596 Test Acc: 0.927
Validation loss decreased (-0.859983 --> -0.926661).  Saving model ...
Epoch: 5 cost time: 0.7323007583618164
Epoch: 5, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
Validation loss decreased (-0.926661 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.7772538661956787
Epoch: 6, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.831587553024292
Epoch: 7, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.902167558670044
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1187224388122559
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.8394274711608887
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9740338325500488
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7937605381011963
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7632839679718018
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0489115715026855
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7031097412109375
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0662195682525635
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8541710376739502
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9848012924194336
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0316162109375
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0453133583068848
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.916344404220581
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1352407932281494
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8729045391082764
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.03190016746521
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8672168254852295
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9677073955535889
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7931168079376221
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8020195960998535
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7874207496643066
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9737532138824463
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.86393141746521
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9668745994567871
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22690585
model size : 101.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2843897342681885
Epoch: 1, Steps: 18 | Train Loss: 3.256 Vali Loss: 2.823 Vali Acc: 0.363 Test Loss: 2.823 Test Acc: 0.363
Validation loss decreased (inf --> -0.363305).  Saving model ...
Epoch: 2 cost time: 1.2932085990905762
Epoch: 2, Steps: 18 | Train Loss: 2.352 Vali Loss: 1.584 Vali Acc: 0.870 Test Loss: 1.584 Test Acc: 0.870
Validation loss decreased (-0.363305 --> -0.869984).  Saving model ...
Epoch: 3 cost time: 1.1691884994506836
Epoch: 3, Steps: 18 | Train Loss: 1.044 Vali Loss: 0.368 Vali Acc: 0.933 Test Loss: 0.368 Test Acc: 0.933
Validation loss decreased (-0.869984 --> -0.933330).  Saving model ...
Epoch: 4 cost time: 1.3049530982971191
Epoch: 4, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.185 Vali Acc: 0.947 Test Loss: 0.185 Test Acc: 0.947
Validation loss decreased (-0.933330 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.7716155052185059
Epoch: 5, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
Validation loss decreased (-0.946665 --> -0.956665).  Saving model ...
Epoch: 6 cost time: 1.7136640548706055
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.2924659252166748
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.9540531635284424
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2233514785766602
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9766750335693359
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9562368392944336
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1277430057525635
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9749755859375
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.997835636138916
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1848158836364746
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4736993312835693
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.250840425491333
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.93662428855896
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6199584007263184
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3830080032348633
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0945310592651367
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.02093505859375
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 23063833
model size : 102.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5882346630096436
Epoch: 1, Steps: 18 | Train Loss: 3.336 Vali Loss: 3.039 Vali Acc: 0.123 Test Loss: 3.039 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 0.8309781551361084
Epoch: 2, Steps: 18 | Train Loss: 2.732 Vali Loss: 2.317 Vali Acc: 0.747 Test Loss: 2.317 Test Acc: 0.747
Validation loss decreased (-0.123303 --> -0.746643).  Saving model ...
Epoch: 3 cost time: 0.8194823265075684
Epoch: 3, Steps: 18 | Train Loss: 1.822 Vali Loss: 1.004 Vali Acc: 0.933 Test Loss: 1.004 Test Acc: 0.933
Validation loss decreased (-0.746643 --> -0.933323).  Saving model ...
Epoch: 4 cost time: 0.8382420539855957
Epoch: 4, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.254 Vali Acc: 0.960 Test Loss: 0.254 Test Acc: 0.960
Validation loss decreased (-0.933323 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 1.124647855758667
Epoch: 5, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8488960266113281
Epoch: 6, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.1551601886749268
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9998123645782471
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.963 Test Loss: 0.096 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7014408111572266
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0996532440185547
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.057666540145874
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2171776294708252
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8624715805053711
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9267685413360596
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0051476955413818
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7998101711273193
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0234184265136719
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.805361270904541
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.075791835784912
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2505083084106445
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0725908279418945
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.238335132598877
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0241844654083252
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2843694686889648
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1636183261871338
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22856473
model size : 101.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.201977491378784
Epoch: 1, Steps: 18 | Train Loss: 3.261 Vali Loss: 3.017 Vali Acc: 0.187 Test Loss: 3.017 Test Acc: 0.187
Validation loss decreased (inf --> -0.186636).  Saving model ...
Epoch: 2 cost time: 0.7932462692260742
Epoch: 2, Steps: 18 | Train Loss: 2.798 Vali Loss: 2.421 Vali Acc: 0.700 Test Loss: 2.421 Test Acc: 0.700
Validation loss decreased (-0.186636 --> -0.699976).  Saving model ...
Epoch: 3 cost time: 0.7653903961181641
Epoch: 3, Steps: 18 | Train Loss: 2.166 Vali Loss: 1.460 Vali Acc: 0.893 Test Loss: 1.460 Test Acc: 0.893
Validation loss decreased (-0.699976 --> -0.893319).  Saving model ...
Epoch: 4 cost time: 0.8341801166534424
Epoch: 4, Steps: 18 | Train Loss: 1.188 Vali Loss: 0.526 Vali Acc: 0.927 Test Loss: 0.526 Test Acc: 0.927
Validation loss decreased (-0.893319 --> -0.926661).  Saving model ...
Epoch: 5 cost time: 1.0246045589447021
Epoch: 5, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
Validation loss decreased (-0.926661 --> -0.943331).  Saving model ...
Epoch: 6 cost time: 0.8380098342895508
Epoch: 6, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.943331 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.9973526000976562
Epoch: 7, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.8974430561065674
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7892506122589111
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7266788482666016
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.045975685119629
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.999006986618042
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8320631980895996
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8424265384674072
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8408544063568115
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8235695362091064
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7694478034973145
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0477418899536133
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9483249187469482
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.040663480758667
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9647033214569092
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8658139705657959
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.9170396327972412
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9272210597991943
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0411975383758545
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.973 Test Loss: 0.067 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.847123384475708
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0069975852966309
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8540163040161133
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.0389978885650635
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9079861640930176
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9990818500518799
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8334779739379883
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9515683650970459
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0296320915222168
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8412139415740967
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9376475811004639
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8740758895874023
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9757184982299805
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22752793
model size : 101.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.397388458251953
Epoch: 1, Steps: 18 | Train Loss: 3.258 Vali Loss: 2.860 Vali Acc: 0.373 Test Loss: 2.860 Test Acc: 0.373
Validation loss decreased (inf --> -0.373305).  Saving model ...
Epoch: 2 cost time: 0.9451196193695068
Epoch: 2, Steps: 18 | Train Loss: 2.536 Vali Loss: 1.908 Vali Acc: 0.793 Test Loss: 1.908 Test Acc: 0.793
Validation loss decreased (-0.373305 --> -0.793314).  Saving model ...
Epoch: 3 cost time: 0.8290247917175293
Epoch: 3, Steps: 18 | Train Loss: 1.367 Vali Loss: 0.581 Vali Acc: 0.903 Test Loss: 0.581 Test Acc: 0.903
Validation loss decreased (-0.793314 --> -0.903328).  Saving model ...
Epoch: 4 cost time: 0.9043295383453369
Epoch: 4, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.903328 --> -0.933331).  Saving model ...
Epoch: 5 cost time: 1.0525407791137695
Epoch: 5, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.202 Vali Acc: 0.947 Test Loss: 0.202 Test Acc: 0.947
Validation loss decreased (-0.933331 --> -0.946665).  Saving model ...
Epoch: 6 cost time: 1.2804977893829346
Epoch: 6, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.946665 --> -0.956665).  Saving model ...
Epoch: 7 cost time: 1.0177156925201416
Epoch: 7, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3158469200134277
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9914112091064453
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.2131538391113281
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.226245403289795
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.296569585800171
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9567105770111084
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0318281650543213
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3749198913574219
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1784379482269287
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.9059445858001709
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7510623931884766
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.91656494140625
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8342752456665039
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9066658020019531
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7946453094482422
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1835827827453613
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9138331413269043
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1806552410125732
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.965059757232666
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 23043097
model size : 102.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.333207845687866
Epoch: 1, Steps: 18 | Train Loss: 3.311 Vali Loss: 3.021 Vali Acc: 0.187 Test Loss: 3.021 Test Acc: 0.187
Validation loss decreased (inf --> -0.186636).  Saving model ...
Epoch: 2 cost time: 0.8461225032806396
Epoch: 2, Steps: 18 | Train Loss: 2.815 Vali Loss: 2.361 Vali Acc: 0.757 Test Loss: 2.361 Test Acc: 0.757
Validation loss decreased (-0.186636 --> -0.756643).  Saving model ...
Epoch: 3 cost time: 0.8335487842559814
Epoch: 3, Steps: 18 | Train Loss: 1.972 Vali Loss: 1.188 Vali Acc: 0.853 Test Loss: 1.188 Test Acc: 0.853
Validation loss decreased (-0.756643 --> -0.853321).  Saving model ...
Epoch: 4 cost time: 0.921062707901001
Epoch: 4, Steps: 18 | Train Loss: 0.869 Vali Loss: 0.399 Vali Acc: 0.940 Test Loss: 0.399 Test Acc: 0.940
Validation loss decreased (-0.853321 --> -0.939996).  Saving model ...
Epoch: 5 cost time: 0.8745031356811523
Epoch: 5, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
Validation loss decreased (-0.939996 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 0.8247785568237305
Epoch: 6, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.8980729579925537
Epoch: 7, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9755525588989258
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1364953517913818
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8314616680145264
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.9712677001953125
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.97989821434021
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8668279647827148
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.029667854309082
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8456172943115234
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8007922172546387
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7466566562652588
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0106561183929443
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1310322284698486
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9330196380615234
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1043663024902344
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9995801448822021
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9335598945617676
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1021289825439453
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22897945
model size : 102.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0817742347717285
Epoch: 1, Steps: 18 | Train Loss: 3.408 Vali Loss: 3.146 Vali Acc: 0.120 Test Loss: 3.146 Test Acc: 0.120
Validation loss decreased (inf --> -0.119969).  Saving model ...
Epoch: 2 cost time: 0.9050877094268799
Epoch: 2, Steps: 18 | Train Loss: 2.966 Vali Loss: 2.662 Vali Acc: 0.497 Test Loss: 2.662 Test Acc: 0.497
Validation loss decreased (-0.119969 --> -0.496640).  Saving model ...
Epoch: 3 cost time: 1.0373551845550537
Epoch: 3, Steps: 18 | Train Loss: 2.444 Vali Loss: 1.901 Vali Acc: 0.823 Test Loss: 1.901 Test Acc: 0.823
Validation loss decreased (-0.496640 --> -0.823314).  Saving model ...
Epoch: 4 cost time: 1.121628761291504
Epoch: 4, Steps: 18 | Train Loss: 1.603 Vali Loss: 0.884 Vali Acc: 0.907 Test Loss: 0.884 Test Acc: 0.907
Validation loss decreased (-0.823314 --> -0.906658).  Saving model ...
Epoch: 5 cost time: 0.8405289649963379
Epoch: 5, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.906658 --> -0.949997).  Saving model ...
Epoch: 6 cost time: 1.0796847343444824
Epoch: 6, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.949997 --> -0.956665).  Saving model ...
Epoch: 7 cost time: 0.7499651908874512
Epoch: 7, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959999).  Saving model ...
Epoch: 8 cost time: 0.8453757762908936
Epoch: 8, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.959999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8206722736358643
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.960 Test Loss: 0.119 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7257959842681885
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.7934470176696777
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6457958221435547
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7617509365081787
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.739483118057251
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.784801721572876
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8170559406280518
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7905726432800293
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9583113193511963
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7164762020111084
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.6727750301361084
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9132611751556396
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8334455490112305
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7799022197723389
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8879420757293701
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.8874235153198242
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0403547286987305
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6312780380249023
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9202651977539062
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9507417678833008
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8228964805603027
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9427902698516846
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8398599624633789
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9266080856323242
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9884321689605713
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8121719360351562
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 22815001
model size : 101.70MB
