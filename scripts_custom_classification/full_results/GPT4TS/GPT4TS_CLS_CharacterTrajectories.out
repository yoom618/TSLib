Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.6067705154418945
Epoch: 1, Steps: 89 | Train Loss: 1.511 Vali Loss: 0.591 Vali Acc: 0.852 Test Loss: 0.591 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 5.734280109405518
Epoch: 2, Steps: 89 | Train Loss: 0.559 Vali Loss: 0.607 Vali Acc: 0.861 Test Loss: 0.607 Test Acc: 0.861
Validation loss decreased (-0.852362 --> -0.861415).  Saving model ...
Epoch: 3 cost time: 8.78129506111145
Epoch: 3, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.718 Vali Acc: 0.843 Test Loss: 0.718 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.120166540145874
Epoch: 4, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.291 Vali Acc: 0.939 Test Loss: 0.291 Test Acc: 0.939
Validation loss decreased (-0.861415 --> -0.939412).  Saving model ...
Epoch: 5 cost time: 8.59654712677002
Epoch: 5, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.284 Vali Acc: 0.942 Test Loss: 0.284 Test Acc: 0.942
Validation loss decreased (-0.939412 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 8.862715005874634
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.360 Vali Acc: 0.926 Test Loss: 0.360 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.042829990386963
Epoch: 7, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.306 Vali Acc: 0.949 Test Loss: 0.306 Test Acc: 0.949
Validation loss decreased (-0.942198 --> -0.949161).  Saving model ...
Epoch: 8 cost time: 8.982425928115845
Epoch: 8, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.277 Vali Acc: 0.960 Test Loss: 0.277 Test Acc: 0.960
Validation loss decreased (-0.949161 --> -0.959607).  Saving model ...
Epoch: 9 cost time: 8.90238881111145
Epoch: 9, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.462 Vali Acc: 0.933 Test Loss: 0.462 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.030601978302002
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.449 Vali Acc: 0.933 Test Loss: 0.449 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.979349613189697
Epoch: 11, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.388 Vali Acc: 0.942 Test Loss: 0.388 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.384000062942505
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.448 Vali Acc: 0.946 Test Loss: 0.448 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.542925119400024
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.322 Vali Acc: 0.966 Test Loss: 0.322 Test Acc: 0.966
Validation loss decreased (-0.959607 --> -0.965874).  Saving model ...
Epoch: 14 cost time: 7.24043083190918
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.423 Vali Acc: 0.966 Test Loss: 0.423 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.56810474395752
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.345 Vali Acc: 0.961 Test Loss: 0.345 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.810039281845093
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.740 Vali Acc: 0.945 Test Loss: 0.740 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.1331706047058105
Epoch: 17, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.487 Vali Acc: 0.942 Test Loss: 0.487 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.065753698348999
Epoch: 18, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.321 Vali Acc: 0.959 Test Loss: 0.321 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.8891212940216064
Epoch: 19, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.397 Vali Acc: 0.954 Test Loss: 0.397 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.480844974517822
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.340 Vali Acc: 0.973 Test Loss: 0.340 Test Acc: 0.973
Validation loss decreased (-0.965874 --> -0.972838).  Saving model ...
Epoch: 21 cost time: 7.794643402099609
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.439 Vali Acc: 0.964 Test Loss: 0.439 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.989290714263916
Epoch: 22, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.413 Vali Acc: 0.956 Test Loss: 0.413 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.289046764373779
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.435 Vali Acc: 0.969 Test Loss: 0.435 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.128525972366333
Epoch: 24, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.689 Vali Acc: 0.939 Test Loss: 0.689 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.789156913757324
Epoch: 25, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.466 Vali Acc: 0.964 Test Loss: 0.466 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.543017625808716
Epoch: 26, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.379 Vali Acc: 0.956 Test Loss: 0.379 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.305510759353638
Epoch: 27, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.519 Vali Acc: 0.960 Test Loss: 0.519 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.716322183609009
Epoch: 28, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.563 Vali Acc: 0.962 Test Loss: 0.563 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 9.043735265731812
Epoch: 29, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.491 Vali Acc: 0.953 Test Loss: 0.491 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.901672601699829
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.849 Vali Acc: 0.954 Test Loss: 0.849 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 44932628
model size : 186.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.239227533340454
Epoch: 1, Steps: 89 | Train Loss: 1.571 Vali Loss: 0.615 Vali Acc: 0.813 Test Loss: 0.615 Test Acc: 0.813
Validation loss decreased (inf --> -0.812668).  Saving model ...
Epoch: 2 cost time: 4.334817409515381
Epoch: 2, Steps: 89 | Train Loss: 0.483 Vali Loss: 0.466 Vali Acc: 0.895 Test Loss: 0.466 Test Acc: 0.895
Validation loss decreased (-0.812668 --> -0.894842).  Saving model ...
Epoch: 3 cost time: 4.518628835678101
Epoch: 3, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.491 Vali Acc: 0.898 Test Loss: 0.491 Test Acc: 0.898
Validation loss decreased (-0.894842 --> -0.898324).  Saving model ...
Epoch: 4 cost time: 4.580537557601929
Epoch: 4, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
Validation loss decreased (-0.898324 --> -0.947769).  Saving model ...
Epoch: 5 cost time: 4.8249194622039795
Epoch: 5, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.314 Vali Acc: 0.945 Test Loss: 0.314 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.772138833999634
Epoch: 6, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.704230546951294
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.408 Vali Acc: 0.938 Test Loss: 0.408 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.524142026901245
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.781 Vali Acc: 0.910 Test Loss: 0.781 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3729865550994873
Epoch: 9, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.295 Vali Acc: 0.953 Test Loss: 0.295 Test Acc: 0.953
Validation loss decreased (-0.947769 --> -0.952643).  Saving model ...
Epoch: 10 cost time: 3.3247056007385254
Epoch: 10, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.294 Vali Acc: 0.963 Test Loss: 0.294 Test Acc: 0.963
Validation loss decreased (-0.952643 --> -0.963089).  Saving model ...
Epoch: 11 cost time: 3.317141056060791
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.336 Vali Acc: 0.963 Test Loss: 0.336 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.395587921142578
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.668 Vali Acc: 0.937 Test Loss: 0.668 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.432949542999268
Epoch: 13, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.544 Vali Acc: 0.948 Test Loss: 0.544 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.421357154846191
Epoch: 14, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
Validation loss decreased (-0.963089 --> -0.972142).  Saving model ...
Epoch: 15 cost time: 3.553629159927368
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.400 Vali Acc: 0.960 Test Loss: 0.400 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.540976524353027
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.361 Vali Acc: 0.961 Test Loss: 0.361 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.439348459243774
Epoch: 17, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.325 Vali Acc: 0.964 Test Loss: 0.325 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.499113082885742
Epoch: 18, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.737 Vali Acc: 0.932 Test Loss: 0.737 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.425326585769653
Epoch: 19, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.314 Vali Acc: 0.971 Test Loss: 0.314 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.535271167755127
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.487 Vali Acc: 0.960 Test Loss: 0.487 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.4978952407836914
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.272 Vali Acc: 0.976 Test Loss: 0.272 Test Acc: 0.976
Validation loss decreased (-0.972142 --> -0.975624).  Saving model ...
Epoch: 22 cost time: 3.266716718673706
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.438 Vali Acc: 0.962 Test Loss: 0.438 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7241222858428955
Epoch: 23, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.398 Vali Acc: 0.961 Test Loss: 0.398 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.433047294616699
Epoch: 24, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.925353050231934
Epoch: 25, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.338 Vali Acc: 0.976 Test Loss: 0.338 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.681697368621826
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.427 Vali Acc: 0.964 Test Loss: 0.427 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.6237130165100098
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.528 Vali Acc: 0.953 Test Loss: 0.528 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.373411417007446
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.976 Test Loss: 0.368 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.749046802520752
Epoch: 29, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.387 Vali Acc: 0.961 Test Loss: 0.387 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.53836727142334
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.488 Vali Acc: 0.954 Test Loss: 0.488 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.676934242248535
Epoch: 31, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.490 Vali Acc: 0.974 Test Loss: 0.490 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 44189204
model size : 183.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5105953216552734
Epoch: 1, Steps: 89 | Train Loss: 1.847 Vali Loss: 0.638 Vali Acc: 0.829 Test Loss: 0.638 Test Acc: 0.829
Validation loss decreased (inf --> -0.829381).  Saving model ...
Epoch: 2 cost time: 2.558537483215332
Epoch: 2, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.355 Vali Acc: 0.901 Test Loss: 0.355 Test Acc: 0.901
Validation loss decreased (-0.829381 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 3.3874640464782715
Epoch: 3, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
Validation loss decreased (-0.901111 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 3.37707257270813
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.256 Vali Acc: 0.939 Test Loss: 0.256 Test Acc: 0.939
Validation loss decreased (-0.929663 --> -0.939412).  Saving model ...
Epoch: 5 cost time: 2.700272560119629
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.214 Vali Acc: 0.947 Test Loss: 0.214 Test Acc: 0.947
Validation loss decreased (-0.939412 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 2.455378293991089
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.947073 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 2.8031954765319824
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.319936513900757
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4230763912200928
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 3.1155970096588135
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 2.399510145187378
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7363414764404297
Epoch: 12, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.283 Vali Acc: 0.949 Test Loss: 0.283 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0091004371643066
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 2.7472333908081055
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.654003620147705
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.227 Vali Acc: 0.969 Test Loss: 0.227 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2260303497314453
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981196).  Saving model ...
Epoch: 17 cost time: 2.86892032623291
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.059211492538452
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.753783702850342
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.987 Test Loss: 0.121 Test Acc: 0.987
Validation loss decreased (-0.981196 --> -0.987464).  Saving model ...
Epoch: 20 cost time: 3.04347562789917
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.353 Vali Acc: 0.953 Test Loss: 0.353 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0458767414093018
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.488642930984497
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.974 Test Loss: 0.238 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5538923740386963
Epoch: 23, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.978 Test Loss: 0.234 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5690176486968994
Epoch: 24, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.260 Vali Acc: 0.971 Test Loss: 0.260 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4693737030029297
Epoch: 25, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.344 Vali Acc: 0.972 Test Loss: 0.344 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.5137038230895996
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.980 Test Loss: 0.210 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.1148974895477295
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.986 Test Loss: 0.174 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.933410406112671
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.976 Test Loss: 0.242 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.082911729812622
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.981 Test Loss: 0.204 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 43817492
model size : 181.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.527416706085205
Epoch: 1, Steps: 89 | Train Loss: 1.588 Vali Loss: 0.454 Vali Acc: 0.893 Test Loss: 0.454 Test Acc: 0.893
Validation loss decreased (inf --> -0.892753).  Saving model ...
Epoch: 2 cost time: 6.526515245437622
Epoch: 2, Steps: 89 | Train Loss: 0.490 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.121741771697998
Epoch: 3, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.892753 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 4.083829879760742
Epoch: 4, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.268 Vali Acc: 0.942 Test Loss: 0.268 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.130247354507446
Epoch: 5, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
Validation loss decreased (-0.943591 --> -0.961697).  Saving model ...
Epoch: 6 cost time: 4.348022222518921
Epoch: 6, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.014456033706665
Epoch: 7, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.438 Vali Acc: 0.940 Test Loss: 0.438 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.048536539077759
Epoch: 8, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.323 Vali Acc: 0.962 Test Loss: 0.323 Test Acc: 0.962
Validation loss decreased (-0.961697 --> -0.962392).  Saving model ...
Epoch: 9 cost time: 5.625298738479614
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.332 Vali Acc: 0.952 Test Loss: 0.332 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.173907041549683
Epoch: 10, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.744 Vali Acc: 0.929 Test Loss: 0.744 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.59516453742981
Epoch: 11, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.223 Vali Acc: 0.969 Test Loss: 0.223 Test Acc: 0.969
Validation loss decreased (-0.962392 --> -0.968661).  Saving model ...
Epoch: 12 cost time: 6.307722568511963
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.243 Vali Acc: 0.972 Test Loss: 0.243 Test Acc: 0.972
Validation loss decreased (-0.968661 --> -0.972142).  Saving model ...
Epoch: 13 cost time: 5.719170570373535
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.427 Vali Acc: 0.946 Test Loss: 0.427 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.934329032897949
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.272 Vali Acc: 0.964 Test Loss: 0.272 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.071980237960815
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.303 Vali Acc: 0.964 Test Loss: 0.303 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.970819711685181
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.396 Vali Acc: 0.960 Test Loss: 0.396 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.162078380584717
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.976 Test Loss: 0.255 Test Acc: 0.976
Validation loss decreased (-0.972142 --> -0.976321).  Saving model ...
Epoch: 18 cost time: 5.085076332092285
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.976 Test Loss: 0.209 Test Acc: 0.976
Validation loss decreased (-0.976321 --> -0.976321).  Saving model ...
Epoch: 19 cost time: 5.559154987335205
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.295 Vali Acc: 0.967 Test Loss: 0.295 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.4704461097717285
Epoch: 20, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.393 Vali Acc: 0.964 Test Loss: 0.393 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.151448488235474
Epoch: 21, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.254 Vali Acc: 0.978 Test Loss: 0.254 Test Acc: 0.978
Validation loss decreased (-0.976321 --> -0.978410).  Saving model ...
Epoch: 22 cost time: 3.9447765350341797
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.262 Vali Acc: 0.980 Test Loss: 0.262 Test Acc: 0.980
Validation loss decreased (-0.978410 --> -0.979802).  Saving model ...
Epoch: 23 cost time: 3.9789130687713623
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.978 Test Loss: 0.261 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.411693334579468
Epoch: 24, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.255 Vali Acc: 0.981 Test Loss: 0.255 Test Acc: 0.981
Validation loss decreased (-0.979802 --> -0.980499).  Saving model ...
Epoch: 25 cost time: 7.569159507751465
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.566 Vali Acc: 0.964 Test Loss: 0.566 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.752148389816284
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.621332406997681
Epoch: 27, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.304 Vali Acc: 0.971 Test Loss: 0.304 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.419690847396851
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.138113498687744
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.798 Vali Acc: 0.937 Test Loss: 0.798 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.013214111328125
Epoch: 30, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.711 Vali Acc: 0.947 Test Loss: 0.711 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.16287088394165
Epoch: 31, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.501 Vali Acc: 0.967 Test Loss: 0.501 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.405679702758789
Epoch: 32, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.411 Vali Acc: 0.974 Test Loss: 0.411 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.586461782455444
Epoch: 33, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.849245309829712
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.344 Vali Acc: 0.979 Test Loss: 0.344 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 44432660
model size : 184.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.023979902267456
Epoch: 1, Steps: 89 | Train Loss: 1.717 Vali Loss: 0.439 Vali Acc: 0.868 Test Loss: 0.439 Test Acc: 0.868
Validation loss decreased (inf --> -0.868380).  Saving model ...
Epoch: 2 cost time: 3.852468967437744
Epoch: 2, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.868380 --> -0.940806).  Saving model ...
Epoch: 3 cost time: 3.7179458141326904
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.437 Vali Acc: 0.903 Test Loss: 0.437 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6431796550750732
Epoch: 4, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
Validation loss decreased (-0.940806 --> -0.960304).  Saving model ...
Epoch: 5 cost time: 3.9177231788635254
Epoch: 5, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.238 Vali Acc: 0.951 Test Loss: 0.238 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0920650959014893
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
Validation loss decreased (-0.960304 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.7534103393554688
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.961001 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 2.8150794506073
Epoch: 8, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.752077102661133
Epoch: 9, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.471 Vali Acc: 0.932 Test Loss: 0.471 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6951239109039307
Epoch: 10, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
Validation loss decreased (-0.965180 --> -0.980500).  Saving model ...
Epoch: 11 cost time: 2.9367282390594482
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7850396633148193
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.287580728530884
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.224 Vali Acc: 0.966 Test Loss: 0.224 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.610908031463623
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.231 Vali Acc: 0.971 Test Loss: 0.231 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8141396045684814
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.358 Vali Acc: 0.953 Test Loss: 0.358 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.7901089191436768
Epoch: 16, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1811580657958984
Epoch: 17, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.198 Vali Acc: 0.974 Test Loss: 0.198 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9576797485351562
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9753611087799072
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.010875940322876
Epoch: 20, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.167 Vali Acc: 0.976 Test Loss: 0.167 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 44044052
model size : 182.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.225639820098877
Epoch: 1, Steps: 89 | Train Loss: 1.890 Vali Loss: 0.520 Vali Acc: 0.842 Test Loss: 0.520 Test Acc: 0.842
Validation loss decreased (inf --> -0.841917).  Saving model ...
Epoch: 2 cost time: 3.7603039741516113
Epoch: 2, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.322 Vali Acc: 0.908 Test Loss: 0.322 Test Acc: 0.908
Validation loss decreased (-0.841917 --> -0.908075).  Saving model ...
Epoch: 3 cost time: 4.0001912117004395
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.232 Vali Acc: 0.938 Test Loss: 0.232 Test Acc: 0.938
Validation loss decreased (-0.908075 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 3.8159897327423096
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.254 Vali Acc: 0.947 Test Loss: 0.254 Test Acc: 0.947
Validation loss decreased (-0.938020 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 3.472041130065918
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
Validation loss decreased (-0.947073 --> -0.963786).  Saving model ...
Epoch: 6 cost time: 3.0685970783233643
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
Validation loss decreased (-0.963786 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 2.4948129653930664
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.533679962158203
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.191 Vali Acc: 0.966 Test Loss: 0.191 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4577605724334717
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
Validation loss decreased (-0.970751 --> -0.979108).  Saving model ...
Epoch: 10 cost time: 3.1855998039245605
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6111629009246826
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3243892192840576
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.434 Vali Acc: 0.942 Test Loss: 0.434 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.472024917602539
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3096365928649902
Epoch: 14, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.5510904788970947
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.982 Test Loss: 0.144 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 16 cost time: 3.463761806488037
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3854119777679443
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 18 cost time: 2.4351139068603516
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.270 Vali Acc: 0.967 Test Loss: 0.270 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.371068000793457
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.976 Test Loss: 0.184 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0066707134246826
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.981 Test Loss: 0.144 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3151042461395264
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.212258815765381
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.984678).  Saving model ...
Epoch: 23 cost time: 2.7375917434692383
Epoch: 23, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1536264419555664
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.970 Test Loss: 0.299 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.033539056777954
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.982 Test Loss: 0.215 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.714810848236084
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.972 Test Loss: 0.269 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.33149790763855
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.981 Test Loss: 0.173 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.270261287689209
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.305 Vali Acc: 0.953 Test Loss: 0.305 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3914453983306885
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.549 Vali Acc: 0.947 Test Loss: 0.549 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.083479404449463
Epoch: 30, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.978 Test Loss: 0.252 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.142160415649414
Epoch: 31, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.210 Vali Acc: 0.983 Test Loss: 0.210 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.8591089248657227
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.986 Test Loss: 0.204 Test Acc: 0.986
Validation loss decreased (-0.984678 --> -0.986070).  Saving model ...
Epoch: 33 cost time: 3.1076698303222656
Epoch: 33, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.984 Test Loss: 0.208 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.668177843093872
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.982 Test Loss: 0.230 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6692161560058594
Epoch: 35, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.986 Test Loss: 0.201 Test Acc: 0.986
Validation loss decreased (-0.986070 --> -0.986070).  Saving model ...
Epoch: 36 cost time: 2.411684989929199
Epoch: 36, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.986 Test Loss: 0.227 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.999826192855835
Epoch: 37, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.983 Test Loss: 0.226 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.011899471282959
Epoch: 38, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.983 Test Loss: 0.225 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.559217929840088
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.982 Test Loss: 0.194 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.5491878986358643
Epoch: 40, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.982 Test Loss: 0.219 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.6994564533233643
Epoch: 41, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.271 Vali Acc: 0.981 Test Loss: 0.271 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.2309820652008057
Epoch: 42, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.580368757247925
Epoch: 43, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.984 Test Loss: 0.155 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.145856618881226
Epoch: 44, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.981 Test Loss: 0.153 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.194662094116211
Epoch: 45, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 43790612
model size : 181.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.629338264465332
Epoch: 1, Steps: 89 | Train Loss: 1.509 Vali Loss: 0.768 Vali Acc: 0.836 Test Loss: 0.768 Test Acc: 0.836
Validation loss decreased (inf --> -0.836343).  Saving model ...
Epoch: 2 cost time: 4.117323637008667
Epoch: 2, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.675 Vali Acc: 0.849 Test Loss: 0.675 Test Acc: 0.849
Validation loss decreased (-0.836343 --> -0.848879).  Saving model ...
Epoch: 3 cost time: 4.034143447875977
Epoch: 3, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.372 Vali Acc: 0.919 Test Loss: 0.372 Test Acc: 0.919
Validation loss decreased (-0.848879 --> -0.918520).  Saving model ...
Epoch: 4 cost time: 4.316769599914551
Epoch: 4, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
Validation loss decreased (-0.918520 --> -0.922002).  Saving model ...
Epoch: 5 cost time: 6.137080430984497
Epoch: 5, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.244 Vali Acc: 0.960 Test Loss: 0.244 Test Acc: 0.960
Validation loss decreased (-0.922002 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 5.762172222137451
Epoch: 6, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.574 Vali Acc: 0.945 Test Loss: 0.574 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.243051052093506
Epoch: 7, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.336 Vali Acc: 0.964 Test Loss: 0.336 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.964481).  Saving model ...
Epoch: 8 cost time: 4.099248886108398
Epoch: 8, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.324 Vali Acc: 0.962 Test Loss: 0.324 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.090450048446655
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.304 Vali Acc: 0.960 Test Loss: 0.304 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.874788284301758
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.321 Vali Acc: 0.967 Test Loss: 0.321 Test Acc: 0.967
Validation loss decreased (-0.964481 --> -0.966571).  Saving model ...
Epoch: 11 cost time: 5.06832218170166
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.279 Vali Acc: 0.974 Test Loss: 0.279 Test Acc: 0.974
Validation loss decreased (-0.966571 --> -0.974231).  Saving model ...
Epoch: 12 cost time: 5.835952997207642
Epoch: 12, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.418 Vali Acc: 0.963 Test Loss: 0.418 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.890251398086548
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.553 Vali Acc: 0.958 Test Loss: 0.553 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.115745544433594
Epoch: 14, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.313 Vali Acc: 0.969 Test Loss: 0.313 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.129317998886108
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.296 Vali Acc: 0.976 Test Loss: 0.296 Test Acc: 0.976
Validation loss decreased (-0.974231 --> -0.975624).  Saving model ...
Epoch: 16 cost time: 5.9995276927948
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.980 Test Loss: 0.250 Test Acc: 0.980
Validation loss decreased (-0.975624 --> -0.979803).  Saving model ...
Epoch: 17 cost time: 6.37438702583313
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.266 Vali Acc: 0.979 Test Loss: 0.266 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.400224924087524
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.327 Vali Acc: 0.969 Test Loss: 0.327 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.56298303604126
Epoch: 19, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.366 Vali Acc: 0.965 Test Loss: 0.366 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.045283555984497
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.306 Vali Acc: 0.974 Test Loss: 0.306 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.03342604637146
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.352 Vali Acc: 0.968 Test Loss: 0.352 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.6317198276519775
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.407 Vali Acc: 0.971 Test Loss: 0.407 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.04871392250061
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.335 Vali Acc: 0.969 Test Loss: 0.335 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.4584641456604
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.698 Vali Acc: 0.948 Test Loss: 0.698 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.719246864318848
Epoch: 25, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.449 Vali Acc: 0.961 Test Loss: 0.449 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.050198793411255
Epoch: 26, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.743 Vali Acc: 0.947 Test Loss: 0.743 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 44439572
model size : 184.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.650842189788818
Epoch: 1, Steps: 89 | Train Loss: 1.646 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
Validation loss decreased (inf --> -0.849577).  Saving model ...
Epoch: 2 cost time: 3.4306015968322754
Epoch: 2, Steps: 89 | Train Loss: 0.495 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.849577 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 2.8571622371673584
Epoch: 3, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.335 Vali Acc: 0.920 Test Loss: 0.335 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9123775959014893
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.889855146408081
Epoch: 5, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.318 Vali Acc: 0.936 Test Loss: 0.318 Test Acc: 0.936
Validation loss decreased (-0.930359 --> -0.935930).  Saving model ...
Epoch: 6 cost time: 3.578096866607666
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.334 Vali Acc: 0.946 Test Loss: 0.334 Test Acc: 0.946
Validation loss decreased (-0.935930 --> -0.945679).  Saving model ...
Epoch: 7 cost time: 3.409086227416992
Epoch: 7, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.251 Vali Acc: 0.962 Test Loss: 0.251 Test Acc: 0.962
Validation loss decreased (-0.945679 --> -0.961697).  Saving model ...
Epoch: 8 cost time: 3.063927173614502
Epoch: 8, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.437 Vali Acc: 0.916 Test Loss: 0.437 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1353466510772705
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.333 Vali Acc: 0.961 Test Loss: 0.333 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.842863082885742
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.371 Vali Acc: 0.951 Test Loss: 0.371 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.104691505432129
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.265 Vali Acc: 0.960 Test Loss: 0.265 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.174599647521973
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.370 Vali Acc: 0.953 Test Loss: 0.370 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.119246244430542
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.217 Vali Acc: 0.974 Test Loss: 0.217 Test Acc: 0.974
Validation loss decreased (-0.961697 --> -0.973535).  Saving model ...
Epoch: 14 cost time: 3.082590341567993
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.235 Vali Acc: 0.966 Test Loss: 0.235 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0091681480407715
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.240 Vali Acc: 0.971 Test Loss: 0.240 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.933084487915039
Epoch: 16, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.306 Vali Acc: 0.963 Test Loss: 0.306 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.923907995223999
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.980 Test Loss: 0.227 Test Acc: 0.980
Validation loss decreased (-0.973535 --> -0.979803).  Saving model ...
Epoch: 18 cost time: 2.9930856227874756
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.518 Vali Acc: 0.946 Test Loss: 0.518 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.656500816345215
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.882446765899658
Epoch: 20, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.394 Vali Acc: 0.956 Test Loss: 0.394 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.765984535217285
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.570 Vali Acc: 0.953 Test Loss: 0.570 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.8326876163482666
Epoch: 22, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.231 Vali Acc: 0.978 Test Loss: 0.231 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.138962745666504
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.340 Vali Acc: 0.960 Test Loss: 0.340 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.023447275161743
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.309 Vali Acc: 0.969 Test Loss: 0.309 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0373425483703613
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.486 Vali Acc: 0.960 Test Loss: 0.486 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.895897150039673
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.455 Vali Acc: 0.962 Test Loss: 0.455 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9884705543518066
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.373 Vali Acc: 0.969 Test Loss: 0.373 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 44050964
model size : 182.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.9771528244018555
Epoch: 1, Steps: 89 | Train Loss: 1.861 Vali Loss: 0.598 Vali Acc: 0.834 Test Loss: 0.598 Test Acc: 0.834
Validation loss decreased (inf --> -0.834256).  Saving model ...
Epoch: 2 cost time: 2.8632335662841797
Epoch: 2, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.834256 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 3.2204363346099854
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
Validation loss decreased (-0.930360 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 3.6882617473602295
Epoch: 4, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.702148914337158
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.960305 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 2.395620107650757
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.168757677078247
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3768441677093506
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
Validation loss decreased (-0.973536 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 3.2537267208099365
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1584010124206543
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8382182121276855
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.510850191116333
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2610790729522705
Epoch: 13, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 14 cost time: 3.2701148986816406
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 15 cost time: 3.5603535175323486
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.019758701324463
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4960765838623047
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.983 Test Loss: 0.156 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4312655925750732
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.981 Test Loss: 0.149 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.732414960861206
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.287 Vali Acc: 0.960 Test Loss: 0.287 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9804811477661133
Epoch: 20, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.156 Vali Acc: 0.979 Test Loss: 0.156 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7699058055877686
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.982 Test Loss: 0.190 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8155269622802734
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.982 Test Loss: 0.140 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.010629653930664
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.982 Test Loss: 0.140 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2900352478027344
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.988 Test Loss: 0.119 Test Acc: 0.988
Validation loss decreased (-0.983982 --> -0.988160).  Saving model ...
Epoch: 25 cost time: 2.5303659439086914
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.981 Test Loss: 0.165 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6799700260162354
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.983 Test Loss: 0.164 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6007654666900635
Epoch: 27, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.985 Test Loss: 0.138 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.234733819961548
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.224367618560791
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.982 Test Loss: 0.177 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.1574599742889404
Epoch: 30, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.417410373687744
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.2576467990875244
Epoch: 32, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.3541781902313232
Epoch: 33, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.982 Test Loss: 0.185 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.2165169715881348
Epoch: 34, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.176 Vali Acc: 0.979 Test Loss: 0.176 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 43763732
model size : 181.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.175880432128906
Epoch: 1, Steps: 89 | Train Loss: 1.590 Vali Loss: 0.562 Vali Acc: 0.857 Test Loss: 0.562 Test Acc: 0.857
Validation loss decreased (inf --> -0.856540).  Saving model ...
Epoch: 2 cost time: 4.04659628868103
Epoch: 2, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
Validation loss decreased (-0.856540 --> -0.877432).  Saving model ...
Epoch: 3 cost time: 5.068822860717773
Epoch: 3, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.590 Vali Acc: 0.902 Test Loss: 0.590 Test Acc: 0.902
Validation loss decreased (-0.877432 --> -0.901805).  Saving model ...
Epoch: 4 cost time: 4.9206016063690186
Epoch: 4, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.538 Vali Acc: 0.904 Test Loss: 0.538 Test Acc: 0.904
Validation loss decreased (-0.901805 --> -0.903894).  Saving model ...
Epoch: 5 cost time: 6.541763067245483
Epoch: 5, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.212 Vali Acc: 0.962 Test Loss: 0.212 Test Acc: 0.962
Validation loss decreased (-0.903894 --> -0.962393).  Saving model ...
Epoch: 6 cost time: 5.1552300453186035
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.370 Vali Acc: 0.948 Test Loss: 0.370 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.2385618686676025
Epoch: 7, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.407 Vali Acc: 0.939 Test Loss: 0.407 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.192896366119385
Epoch: 8, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.301 Vali Acc: 0.955 Test Loss: 0.301 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.1828718185424805
Epoch: 9, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.737366199493408
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.358 Vali Acc: 0.970 Test Loss: 0.358 Test Acc: 0.970
Validation loss decreased (-0.962393 --> -0.970052).  Saving model ...
Epoch: 11 cost time: 4.112458229064941
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.252 Vali Acc: 0.968 Test Loss: 0.252 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.286212205886841
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.383 Vali Acc: 0.948 Test Loss: 0.383 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.339416742324829
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.351 Vali Acc: 0.951 Test Loss: 0.351 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.6874823570251465
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.453 Vali Acc: 0.939 Test Loss: 0.453 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.560682773590088
Epoch: 15, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.287 Vali Acc: 0.974 Test Loss: 0.287 Test Acc: 0.974
Validation loss decreased (-0.970052 --> -0.974231).  Saving model ...
Epoch: 16 cost time: 5.482182502746582
Epoch: 16, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.318 Vali Acc: 0.965 Test Loss: 0.318 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.049097537994385
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.253 Vali Acc: 0.965 Test Loss: 0.253 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.20245099067688
Epoch: 18, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.520 Vali Acc: 0.940 Test Loss: 0.520 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.825327396392822
Epoch: 19, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.339 Vali Acc: 0.958 Test Loss: 0.339 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.197465896606445
Epoch: 20, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.308 Vali Acc: 0.969 Test Loss: 0.308 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.955655336380005
Epoch: 21, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.401 Vali Acc: 0.948 Test Loss: 0.401 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.533496141433716
Epoch: 22, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.337 Vali Acc: 0.953 Test Loss: 0.337 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.350967168807983
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.259 Vali Acc: 0.974 Test Loss: 0.259 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.0425872802734375
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.313 Vali Acc: 0.967 Test Loss: 0.313 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.06888222694397
Epoch: 25, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.392 Vali Acc: 0.962 Test Loss: 0.392 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 44446484
model size : 184.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.769132137298584
Epoch: 1, Steps: 89 | Train Loss: 1.677 Vali Loss: 0.698 Vali Acc: 0.806 Test Loss: 0.698 Test Acc: 0.806
Validation loss decreased (inf --> -0.806400).  Saving model ...
Epoch: 2 cost time: 3.989248037338257
Epoch: 2, Steps: 89 | Train Loss: 0.464 Vali Loss: 0.403 Vali Acc: 0.916 Test Loss: 0.403 Test Acc: 0.916
Validation loss decreased (-0.806400 --> -0.916431).  Saving model ...
Epoch: 3 cost time: 4.195319175720215
Epoch: 3, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.006298780441284
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.245 Vali Acc: 0.951 Test Loss: 0.245 Test Acc: 0.951
Validation loss decreased (-0.916431 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 3.059497356414795
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.958215).  Saving model ...
Epoch: 6 cost time: 2.654369354248047
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.303 Vali Acc: 0.946 Test Loss: 0.303 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.641293525695801
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.632187843322754
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
Validation loss decreased (-0.958215 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 2.6438148021698
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.251 Vali Acc: 0.967 Test Loss: 0.251 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7889184951782227
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.331 Vali Acc: 0.951 Test Loss: 0.331 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4159648418426514
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.234 Vali Acc: 0.955 Test Loss: 0.234 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2287118434906006
Epoch: 12, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.241 Vali Acc: 0.972 Test Loss: 0.241 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972142).  Saving model ...
Epoch: 13 cost time: 3.8181204795837402
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.227 Vali Acc: 0.968 Test Loss: 0.227 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.610322952270508
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
Validation loss decreased (-0.972142 --> -0.972839).  Saving model ...
Epoch: 15 cost time: 3.7442638874053955
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
Validation loss decreased (-0.972839 --> -0.975625).  Saving model ...
Epoch: 16 cost time: 3.4298932552337646
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.173 Vali Acc: 0.984 Test Loss: 0.173 Test Acc: 0.984
Validation loss decreased (-0.975625 --> -0.983982).  Saving model ...
Epoch: 17 cost time: 3.9329686164855957
Epoch: 17, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.164 Vali Acc: 0.984 Test Loss: 0.164 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 18 cost time: 3.871936559677124
Epoch: 18, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.375 Vali Acc: 0.964 Test Loss: 0.375 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6481258869171143
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.306 Vali Acc: 0.968 Test Loss: 0.306 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6197566986083984
Epoch: 20, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.328 Vali Acc: 0.970 Test Loss: 0.328 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7644715309143066
Epoch: 21, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.349 Vali Acc: 0.953 Test Loss: 0.349 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6457455158233643
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.252 Vali Acc: 0.976 Test Loss: 0.252 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5983314514160156
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.304 Vali Acc: 0.968 Test Loss: 0.304 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.5607850551605225
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.296 Vali Acc: 0.970 Test Loss: 0.296 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.743145704269409
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.972 Test Loss: 0.240 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.724963665008545
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.1964328289031982
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.976 Test Loss: 0.248 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 43956500
model size : 182.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5377044677734375
Epoch: 1, Steps: 89 | Train Loss: 1.882 Vali Loss: 0.665 Vali Acc: 0.820 Test Loss: 0.665 Test Acc: 0.820
Validation loss decreased (inf --> -0.819631).  Saving model ...
Epoch: 2 cost time: 2.2083795070648193
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.819631 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 3.1038026809692383
Epoch: 3, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.926181 --> -0.970054).  Saving model ...
Epoch: 4 cost time: 2.4843549728393555
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0859196186065674
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 2.8783912658691406
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.893655776977539
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
Validation loss decreased (-0.973536 --> -0.981197).  Saving model ...
Epoch: 8 cost time: 2.4542019367218018
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4611928462982178
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8156750202178955
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.981197 --> -0.986768).  Saving model ...
Epoch: 11 cost time: 3.539090633392334
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7251808643341064
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.042353391647339
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5252444744110107
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.450887680053711
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.0033488273620605
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.8881828784942627
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5739316940307617
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.49406361579895
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.976 Test Loss: 0.196 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.690042495727539
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.984 Test Loss: 0.193 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 43736852
model size : 181.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.526661396026611
Epoch: 1, Steps: 89 | Train Loss: 1.534 Vali Loss: 0.472 Vali Acc: 0.882 Test Loss: 0.472 Test Acc: 0.882
Validation loss decreased (inf --> -0.881611).  Saving model ...
Epoch: 2 cost time: 5.8955254554748535
Epoch: 2, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.323 Vali Acc: 0.923 Test Loss: 0.323 Test Acc: 0.923
Validation loss decreased (-0.881611 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 5.641458511352539
Epoch: 3, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.379 Vali Acc: 0.927 Test Loss: 0.379 Test Acc: 0.927
Validation loss decreased (-0.922699 --> -0.926876).  Saving model ...
Epoch: 4 cost time: 5.808164596557617
Epoch: 4, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.926876 --> -0.949858).  Saving model ...
Epoch: 5 cost time: 5.529204607009888
Epoch: 5, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.334 Vali Acc: 0.946 Test Loss: 0.334 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.916727542877197
Epoch: 6, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.201 Vali Acc: 0.969 Test Loss: 0.201 Test Acc: 0.969
Validation loss decreased (-0.949858 --> -0.968661).  Saving model ...
Epoch: 7 cost time: 4.428234100341797
Epoch: 7, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.266 Vali Acc: 0.960 Test Loss: 0.266 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9698903560638428
Epoch: 8, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.941 Vali Acc: 0.923 Test Loss: 0.941 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.050357341766357
Epoch: 9, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.968661 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 4.160633325576782
Epoch: 10, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.510316371917725
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.279 Vali Acc: 0.961 Test Loss: 0.279 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.134955167770386
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.381 Vali Acc: 0.944 Test Loss: 0.381 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.356581687927246
Epoch: 13, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.253 Vali Acc: 0.960 Test Loss: 0.253 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.304436445236206
Epoch: 14, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.541 Vali Acc: 0.951 Test Loss: 0.541 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.150371074676514
Epoch: 15, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.178 Vali Acc: 0.980 Test Loss: 0.178 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979803).  Saving model ...
Epoch: 16 cost time: 4.046051979064941
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.054020404815674
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.971 Test Loss: 0.259 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.339841365814209
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.246 Vali Acc: 0.974 Test Loss: 0.246 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.353783369064331
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.250 Vali Acc: 0.976 Test Loss: 0.250 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.923162460327148
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.344 Vali Acc: 0.959 Test Loss: 0.344 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.258719444274902
Epoch: 21, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.291 Vali Acc: 0.969 Test Loss: 0.291 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.148387432098389
Epoch: 22, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.258 Vali Acc: 0.971 Test Loss: 0.258 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.9735424518585205
Epoch: 23, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.414 Vali Acc: 0.960 Test Loss: 0.414 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.081104040145874
Epoch: 24, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.259 Vali Acc: 0.966 Test Loss: 0.259 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.112387418746948
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.976 Test Loss: 0.234 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 44436500
model size : 184.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.258934736251831
Epoch: 1, Steps: 89 | Train Loss: 1.737 Vali Loss: 0.488 Vali Acc: 0.887 Test Loss: 0.488 Test Acc: 0.887
Validation loss decreased (inf --> -0.887182).  Saving model ...
Epoch: 2 cost time: 2.574183702468872
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.289 Vali Acc: 0.924 Test Loss: 0.289 Test Acc: 0.924
Validation loss decreased (-0.887182 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 3.6880950927734375
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.304 Vali Acc: 0.948 Test Loss: 0.304 Test Acc: 0.948
Validation loss decreased (-0.924092 --> -0.948465).  Saving model ...
Epoch: 4 cost time: 3.3437342643737793
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.323 Vali Acc: 0.951 Test Loss: 0.323 Test Acc: 0.951
Validation loss decreased (-0.948465 --> -0.950554).  Saving model ...
Epoch: 5 cost time: 3.915189027786255
Epoch: 5, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.278 Vali Acc: 0.953 Test Loss: 0.278 Test Acc: 0.953
Validation loss decreased (-0.950554 --> -0.953340).  Saving model ...
Epoch: 6 cost time: 3.4217894077301025
Epoch: 6, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.953340 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 2.7244880199432373
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.568880319595337
Epoch: 8, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.588813304901123
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.256 Vali Acc: 0.951 Test Loss: 0.256 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7307722568511963
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0602052211761475
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.139 Vali Acc: 0.981 Test Loss: 0.139 Test Acc: 0.981
Validation loss decreased (-0.970054 --> -0.980500).  Saving model ...
Epoch: 12 cost time: 2.8558082580566406
Epoch: 12, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980500).  Saving model ...
Epoch: 13 cost time: 2.828382730484009
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.763604164123535
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.46822190284729
Epoch: 15, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.230 Vali Acc: 0.968 Test Loss: 0.230 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.147495985031128
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.480642795562744
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.316 Vali Acc: 0.964 Test Loss: 0.316 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.830073595046997
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.319 Vali Acc: 0.969 Test Loss: 0.319 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.808849811553955
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.181 Vali Acc: 0.983 Test Loss: 0.181 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983285).  Saving model ...
Epoch: 20 cost time: 3.545745372772217
Epoch: 20, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.207 Vali Acc: 0.974 Test Loss: 0.207 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5640299320220947
Epoch: 21, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.268 Vali Acc: 0.963 Test Loss: 0.268 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.860790252685547
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7752249240875244
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.977 Test Loss: 0.220 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.705138921737671
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.523231267929077
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.201 Vali Acc: 0.981 Test Loss: 0.201 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.6981747150421143
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.971 Test Loss: 0.243 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.9847023487091064
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.985 Test Loss: 0.164 Test Acc: 0.985
Validation loss decreased (-0.983285 --> -0.985374).  Saving model ...
Epoch: 28 cost time: 3.0923068523406982
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.406 Vali Acc: 0.967 Test Loss: 0.406 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.921116828918457
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.3341493606567383
Epoch: 30, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.459 Vali Acc: 0.959 Test Loss: 0.459 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.993685007095337
Epoch: 31, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.202 Vali Acc: 0.981 Test Loss: 0.202 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.123245477676392
Epoch: 32, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.976 Test Loss: 0.238 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.892155647277832
Epoch: 33, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.416 Vali Acc: 0.965 Test Loss: 0.416 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.8417742252349854
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.984 Test Loss: 0.213 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.315145492553711
Epoch: 35, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.987 Test Loss: 0.183 Test Acc: 0.987
Validation loss decreased (-0.985374 --> -0.986767).  Saving model ...
Epoch: 36 cost time: 3.656235933303833
Epoch: 36, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.184 Vali Acc: 0.985 Test Loss: 0.184 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.4994471073150635
Epoch: 37, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.977 Test Loss: 0.281 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.0213329792022705
Epoch: 38, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.977 Test Loss: 0.211 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.985626697540283
Epoch: 39, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.982 Test Loss: 0.191 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.833540916442871
Epoch: 40, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.177 Vali Acc: 0.983 Test Loss: 0.177 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.979217052459717
Epoch: 41, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.1840975284576416
Epoch: 42, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.981 Test Loss: 0.176 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.7738003730773926
Epoch: 43, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.256 Vali Acc: 0.980 Test Loss: 0.256 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.8062188625335693
Epoch: 44, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.978 Test Loss: 0.240 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.543499231338501
Epoch: 45, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.610 Vali Acc: 0.951 Test Loss: 0.610 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 43963412
model size : 182.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.030530214309692
Epoch: 1, Steps: 89 | Train Loss: 1.966 Vali Loss: 0.577 Vali Acc: 0.832 Test Loss: 0.577 Test Acc: 0.832
Validation loss decreased (inf --> -0.832167).  Saving model ...
Epoch: 2 cost time: 2.590653419494629
Epoch: 2, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.293 Vali Acc: 0.926 Test Loss: 0.293 Test Acc: 0.926
Validation loss decreased (-0.832167 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 2.490751028060913
Epoch: 3, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.926181 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 2.2998785972595215
Epoch: 4, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.543250322341919
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 2.463789463043213
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 2.453676223754883
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.054988145828247
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.033543348312378
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 3.1191272735595703
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 11 cost time: 2.798872709274292
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983982).  Saving model ...
Epoch: 12 cost time: 2.350034236907959
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.969 Test Loss: 0.211 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.49522066116333
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4679689407348633
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.678044319152832
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.981 Test Loss: 0.207 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6886749267578125
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.974 Test Loss: 0.152 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3159031867980957
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.412811517715454
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.983 Test Loss: 0.132 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5035881996154785
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.864244222640991
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.312005043029785
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.968 Test Loss: 0.242 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 43726868
model size : 181.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.03209376335144
Epoch: 1, Steps: 89 | Train Loss: 1.582 Vali Loss: 0.467 Vali Acc: 0.874 Test Loss: 0.467 Test Acc: 0.874
Validation loss decreased (inf --> -0.873951).  Saving model ...
Epoch: 2 cost time: 3.143134355545044
Epoch: 2, Steps: 89 | Train Loss: 0.502 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
Validation loss decreased (-0.873951 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 3.089066743850708
Epoch: 3, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.271 Vali Acc: 0.943 Test Loss: 0.271 Test Acc: 0.943
Validation loss decreased (-0.926181 --> -0.942894).  Saving model ...
Epoch: 4 cost time: 3.0829572677612305
Epoch: 4, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5046231746673584
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.299 Vali Acc: 0.948 Test Loss: 0.299 Test Acc: 0.948
Validation loss decreased (-0.942894 --> -0.947769).  Saving model ...
Epoch: 6 cost time: 4.733306169509888
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.238 Vali Acc: 0.964 Test Loss: 0.238 Test Acc: 0.964
Validation loss decreased (-0.947769 --> -0.963786).  Saving model ...
Epoch: 7 cost time: 4.816919326782227
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.090771198272705
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.260 Vali Acc: 0.947 Test Loss: 0.260 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.6582634449005127
Epoch: 9, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
Validation loss decreased (-0.963786 --> -0.970750).  Saving model ...
Epoch: 10 cost time: 3.3252804279327393
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
Validation loss decreased (-0.970750 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 3.154052257537842
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.467003107070923
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974232).  Saving model ...
Epoch: 13 cost time: 3.2910866737365723
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974232 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 3.1509957313537598
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.329 Vali Acc: 0.949 Test Loss: 0.329 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.904176950454712
Epoch: 15, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.319 Vali Acc: 0.953 Test Loss: 0.319 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.59502100944519
Epoch: 16, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.296 Vali Acc: 0.970 Test Loss: 0.296 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.664931535720825
Epoch: 17, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.302 Vali Acc: 0.961 Test Loss: 0.302 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6913857460021973
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.291 Vali Acc: 0.962 Test Loss: 0.291 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.004044055938721
Epoch: 19, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.284 Vali Acc: 0.969 Test Loss: 0.284 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.604724168777466
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.652 Vali Acc: 0.924 Test Loss: 0.652 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.418154001235962
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.299 Vali Acc: 0.981 Test Loss: 0.299 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.980498).  Saving model ...
Epoch: 22 cost time: 4.497071027755737
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.265 Vali Acc: 0.981 Test Loss: 0.265 Test Acc: 0.981
Validation loss decreased (-0.980498 --> -0.981195).  Saving model ...
Epoch: 23 cost time: 3.264807939529419
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.311 Vali Acc: 0.970 Test Loss: 0.311 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2942800521850586
Epoch: 24, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.248 Vali Acc: 0.981 Test Loss: 0.248 Test Acc: 0.981
Validation loss decreased (-0.981195 --> -0.981195).  Saving model ...
Epoch: 25 cost time: 3.3181111812591553
Epoch: 25, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.258 Vali Acc: 0.978 Test Loss: 0.258 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.08524751663208
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.981 Test Loss: 0.213 Test Acc: 0.981
Validation loss decreased (-0.981195 --> -0.981196).  Saving model ...
Epoch: 27 cost time: 3.29266619682312
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.984 Test Loss: 0.213 Test Acc: 0.984
Validation loss decreased (-0.981196 --> -0.983981).  Saving model ...
Epoch: 28 cost time: 3.3398287296295166
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.259 Vali Acc: 0.981 Test Loss: 0.259 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.28517484664917
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.981 Test Loss: 0.258 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.348423957824707
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.286 Vali Acc: 0.971 Test Loss: 0.286 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.027798652648926
Epoch: 31, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.297 Vali Acc: 0.974 Test Loss: 0.297 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.369837284088135
Epoch: 32, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.219 Vali Acc: 0.979 Test Loss: 0.219 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.234184980392456
Epoch: 33, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.312 Vali Acc: 0.978 Test Loss: 0.312 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.8506858348846436
Epoch: 34, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.268 Vali Acc: 0.974 Test Loss: 0.268 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.436829328536987
Epoch: 35, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.276 Vali Acc: 0.985 Test Loss: 0.276 Test Acc: 0.985
Validation loss decreased (-0.983981 --> -0.985373).  Saving model ...
Epoch: 36 cost time: 3.4042866230010986
Epoch: 36, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.986 Test Loss: 0.235 Test Acc: 0.986
Validation loss decreased (-0.985373 --> -0.986070).  Saving model ...
Epoch: 37 cost time: 3.198759078979492
Epoch: 37, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.300 Vali Acc: 0.983 Test Loss: 0.300 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.3113811016082764
Epoch: 38, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.316 Vali Acc: 0.964 Test Loss: 0.316 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.3556225299835205
Epoch: 39, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.282 Vali Acc: 0.983 Test Loss: 0.282 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.5117247104644775
Epoch: 40, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.985 Test Loss: 0.211 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 4.105854034423828
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.987 Test Loss: 0.207 Test Acc: 0.987
Validation loss decreased (-0.986070 --> -0.987463).  Saving model ...
Epoch: 42 cost time: 4.5585267543792725
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.990 Test Loss: 0.205 Test Acc: 0.990
Validation loss decreased (-0.987463 --> -0.989552).  Saving model ...
Epoch: 43 cost time: 4.69813871383667
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.989 Test Loss: 0.197 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.6744115352630615
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.988 Test Loss: 0.197 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.984082221984863
Epoch: 45, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.325 Vali Acc: 0.966 Test Loss: 0.325 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.3965818881988525
Epoch: 46, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.252 Vali Acc: 0.985 Test Loss: 0.252 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.3924920558929443
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.987 Test Loss: 0.244 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.435924768447876
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.987 Test Loss: 0.240 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.3548500537872314
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.987 Test Loss: 0.237 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.5383195877075195
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.986 Test Loss: 0.240 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 44206868
model size : 183.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.6628735065460205
Epoch: 1, Steps: 89 | Train Loss: 1.692 Vali Loss: 0.495 Vali Acc: 0.846 Test Loss: 0.495 Test Acc: 0.846
Validation loss decreased (inf --> -0.846095).  Saving model ...
Epoch: 2 cost time: 3.6029105186462402
Epoch: 2, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.846095 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 2.9448602199554443
Epoch: 3, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
Validation loss decreased (-0.936627 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 3.40228271484375
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
Validation loss decreased (-0.949162 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 2.4751622676849365
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
Validation loss decreased (-0.961001 --> -0.975625).  Saving model ...
Epoch: 6 cost time: 2.5211315155029297
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.975625).  Saving model ...
Epoch: 7 cost time: 2.653991937637329
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.46242356300354
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.236 Vali Acc: 0.970 Test Loss: 0.236 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8209104537963867
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.229 Vali Acc: 0.964 Test Loss: 0.229 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.002638101577759
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.253 Vali Acc: 0.961 Test Loss: 0.253 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.3013224601745605
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.311 Vali Acc: 0.961 Test Loss: 0.311 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.5891647338867188
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
Validation loss decreased (-0.975625 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 4.232497453689575
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.307 Vali Acc: 0.953 Test Loss: 0.307 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3901407718658447
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.303403377532959
Epoch: 15, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.999361038208008
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.193 Vali Acc: 0.976 Test Loss: 0.193 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7005419731140137
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.971 Test Loss: 0.246 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.742079973220825
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.983 Test Loss: 0.169 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982589).  Saving model ...
Epoch: 19 cost time: 3.937466621398926
Epoch: 19, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.294 Vali Acc: 0.971 Test Loss: 0.294 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8939318656921387
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.984 Test Loss: 0.162 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 21 cost time: 2.564361810684204
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.120406627655029
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.985 Test Loss: 0.160 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 23 cost time: 2.6154372692108154
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.980 Test Loss: 0.188 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.158517837524414
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.322 Vali Acc: 0.977 Test Loss: 0.322 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6231305599212646
Epoch: 25, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.456 Vali Acc: 0.959 Test Loss: 0.456 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.198427438735962
Epoch: 26, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.271 Vali Acc: 0.978 Test Loss: 0.271 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.141040086746216
Epoch: 27, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.338 Vali Acc: 0.976 Test Loss: 0.338 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.1999831199645996
Epoch: 28, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.299 Vali Acc: 0.974 Test Loss: 0.299 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.6473371982574463
Epoch: 29, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.217 Vali Acc: 0.984 Test Loss: 0.217 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.652448892593384
Epoch: 30, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.983 Test Loss: 0.225 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.7972300052642822
Epoch: 31, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.286 Vali Acc: 0.980 Test Loss: 0.286 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.657378673553467
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.987 Test Loss: 0.207 Test Acc: 0.987
Validation loss decreased (-0.984678 --> -0.987463).  Saving model ...
Epoch: 33 cost time: 2.614440679550171
Epoch: 33, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.449 Vali Acc: 0.959 Test Loss: 0.449 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.268104314804077
Epoch: 34, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.984 Test Loss: 0.195 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.589940309524536
Epoch: 35, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.318 Vali Acc: 0.979 Test Loss: 0.318 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.5458459854125977
Epoch: 36, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.834538459777832
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.188 Vali Acc: 0.985 Test Loss: 0.188 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.646099328994751
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.986 Test Loss: 0.162 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.69791579246521
Epoch: 39, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.986 Test Loss: 0.153 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.799501657485962
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.987 Test Loss: 0.148 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.707219123840332
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.983 Test Loss: 0.192 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.47127103805542
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.987 Test Loss: 0.149 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 43902740
model size : 182.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.47072696685791
Epoch: 1, Steps: 89 | Train Loss: 1.934 Vali Loss: 0.475 Vali Acc: 0.866 Test Loss: 0.475 Test Acc: 0.866
Validation loss decreased (inf --> -0.866291).  Saving model ...
Epoch: 2 cost time: 2.518183946609497
Epoch: 2, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
Validation loss decreased (-0.866291 --> -0.922002).  Saving model ...
Epoch: 3 cost time: 2.3374714851379395
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.922002 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 2.5447678565979004
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5272085666656494
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.952644 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 2.4547617435455322
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.962394 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 2.7940382957458496
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.001568555831909
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.554375648498535
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.04150652885437
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982589).  Saving model ...
Epoch: 11 cost time: 3.2158854007720947
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.05583119392395
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.065 Vali Acc: 0.989 Test Loss: 0.065 Test Acc: 0.989
Validation loss decreased (-0.982589 --> -0.988857).  Saving model ...
Epoch: 13 cost time: 3.0396478176116943
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.990 Test Loss: 0.067 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989554).  Saving model ...
Epoch: 14 cost time: 2.547309160232544
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.463705539703369
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3361971378326416
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6241824626922607
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.307 Vali Acc: 0.967 Test Loss: 0.307 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6119234561920166
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.981 Test Loss: 0.144 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2289984226226807
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4232537746429443
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.4445900917053223
Epoch: 21, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.583225727081299
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.997393846511841
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 43716884
model size : 181.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.1623547077178955
Epoch: 1, Steps: 89 | Train Loss: 1.583 Vali Loss: 0.674 Vali Acc: 0.824 Test Loss: 0.674 Test Acc: 0.824
Validation loss decreased (inf --> -0.823809).  Saving model ...
Epoch: 2 cost time: 3.7902004718780518
Epoch: 2, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.346 Vali Acc: 0.914 Test Loss: 0.346 Test Acc: 0.914
Validation loss decreased (-0.823809 --> -0.913646).  Saving model ...
Epoch: 3 cost time: 3.209920644760132
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
Validation loss decreased (-0.913646 --> -0.937323).  Saving model ...
Epoch: 4 cost time: 3.3243978023529053
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
Validation loss decreased (-0.937323 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 4.0393218994140625
Epoch: 5, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.465618133544922
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.604 Vali Acc: 0.914 Test Loss: 0.604 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.348435401916504
Epoch: 7, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
Validation loss decreased (-0.959608 --> -0.961697).  Saving model ...
Epoch: 8 cost time: 3.229586601257324
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.961697 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 4.197403907775879
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
Validation loss decreased (-0.966572 --> -0.977714).  Saving model ...
Epoch: 10 cost time: 5.30888557434082
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.272 Vali Acc: 0.959 Test Loss: 0.272 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.93317174911499
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
Validation loss decreased (-0.977714 --> -0.978411).  Saving model ...
Epoch: 12 cost time: 5.326019048690796
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.381 Vali Acc: 0.953 Test Loss: 0.381 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.673877716064453
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979803).  Saving model ...
Epoch: 14 cost time: 3.2753381729125977
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.317 Vali Acc: 0.960 Test Loss: 0.317 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.460597038269043
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.193 Vali Acc: 0.964 Test Loss: 0.193 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.501108884811401
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.194 Vali Acc: 0.978 Test Loss: 0.194 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.14456582069397
Epoch: 17, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.242 Vali Acc: 0.972 Test Loss: 0.242 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.370181322097778
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.995 Vali Acc: 0.919 Test Loss: 0.995 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.581792116165161
Epoch: 19, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.203 Vali Acc: 0.978 Test Loss: 0.203 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.259020566940308
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.971 Test Loss: 0.239 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.415786027908325
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.981 Test Loss: 0.224 Test Acc: 0.981
Validation loss decreased (-0.979803 --> -0.980499).  Saving model ...
Epoch: 22 cost time: 5.0007164478302
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.336 Vali Acc: 0.966 Test Loss: 0.336 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.1989336013793945
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.981 Test Loss: 0.230 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.098686695098877
Epoch: 24, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.508 Vali Acc: 0.958 Test Loss: 0.508 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.418200969696045
Epoch: 25, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.227 Vali Acc: 0.980 Test Loss: 0.227 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.7965357303619385
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.5340068340301514
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.978 Test Loss: 0.210 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.3035361766815186
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.356 Vali Acc: 0.966 Test Loss: 0.356 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.4334168434143066
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.396 Vali Acc: 0.949 Test Loss: 0.396 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.1532158851623535
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.249 Vali Acc: 0.982 Test Loss: 0.249 Test Acc: 0.982
Validation loss decreased (-0.980499 --> -0.981892).  Saving model ...
Epoch: 31 cost time: 3.6682093143463135
Epoch: 31, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.295 Vali Acc: 0.979 Test Loss: 0.295 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.9112162590026855
Epoch: 32, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.204 Vali Acc: 0.976 Test Loss: 0.204 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.700362205505371
Epoch: 33, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.201 Vali Acc: 0.978 Test Loss: 0.201 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.049504041671753
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.985 Test Loss: 0.184 Test Acc: 0.985
Validation loss decreased (-0.981892 --> -0.984678).  Saving model ...
Epoch: 35 cost time: 5.032902717590332
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.971 Test Loss: 0.237 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.293591022491455
Epoch: 36, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.971 Test Loss: 0.321 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.424206256866455
Epoch: 37, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.269 Vali Acc: 0.979 Test Loss: 0.269 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.356301307678223
Epoch: 38, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.280 Vali Acc: 0.976 Test Loss: 0.280 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.166368246078491
Epoch: 39, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.338 Vali Acc: 0.976 Test Loss: 0.338 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.3220672607421875
Epoch: 40, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.381206274032593
Epoch: 41, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.981 Test Loss: 0.227 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.809344530105591
Epoch: 42, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.984 Test Loss: 0.174 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.3524458408355713
Epoch: 43, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.982 Test Loss: 0.215 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.408449649810791
Epoch: 44, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.978 Test Loss: 0.223 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 44213780
model size : 183.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.795698642730713
Epoch: 1, Steps: 89 | Train Loss: 1.660 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (inf --> -0.875344).  Saving model ...
Epoch: 2 cost time: 3.5520503520965576
Epoch: 2, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.255 Vali Acc: 0.938 Test Loss: 0.255 Test Acc: 0.938
Validation loss decreased (-0.875344 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 4.006678581237793
Epoch: 3, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.938020 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.668058156967163
Epoch: 4, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 3.8160858154296875
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.05326771736145
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.275050640106201
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
Validation loss decreased (-0.969358 --> -0.979107).  Saving model ...
Epoch: 8 cost time: 3.6124281883239746
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8810932636260986
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
Validation loss decreased (-0.979107 --> -0.980500).  Saving model ...
Epoch: 10 cost time: 2.508197069168091
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.186 Vali Acc: 0.976 Test Loss: 0.186 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6355669498443604
Epoch: 11, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.586449384689331
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.973 Test Loss: 0.227 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5067050457000732
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.323 Vali Acc: 0.952 Test Loss: 0.323 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.828707456588745
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.275 Vali Acc: 0.970 Test Loss: 0.275 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.591385126113892
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.560955047607422
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.204 Vali Acc: 0.976 Test Loss: 0.204 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.702565431594849
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.171942949295044
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
Validation loss decreased (-0.980500 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 4.793389558792114
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.081041097640991
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.122 Vali Acc: 0.987 Test Loss: 0.122 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 4.78383731842041
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.913966417312622
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.179 Vali Acc: 0.984 Test Loss: 0.179 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.044959783554077
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.985 Test Loss: 0.170 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7128353118896484
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.984 Test Loss: 0.150 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6688663959503174
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.177 Vali Acc: 0.978 Test Loss: 0.177 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.8403801918029785
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.601715564727783
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.366 Vali Acc: 0.952 Test Loss: 0.366 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.6093788146972656
Epoch: 28, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.158 Vali Acc: 0.983 Test Loss: 0.158 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.319671392440796
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.982 Test Loss: 0.171 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.549373149871826
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.177 Vali Acc: 0.987 Test Loss: 0.177 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 43909652
model size : 182.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9258406162261963
Epoch: 1, Steps: 89 | Train Loss: 1.954 Vali Loss: 0.531 Vali Acc: 0.852 Test Loss: 0.531 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 2.916712760925293
Epoch: 2, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.215 Vali Acc: 0.938 Test Loss: 0.215 Test Acc: 0.938
Validation loss decreased (-0.852362 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 3.1079609394073486
Epoch: 3, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
Validation loss decreased (-0.938020 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 3.475074052810669
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.958216 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.4752719402313232
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4317057132720947
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.48114013671875
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.974929 --> -0.983286).  Saving model ...
Epoch: 8 cost time: 2.2704503536224365
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.250013828277588
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1736392974853516
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.229721784591675
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.829747438430786
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.791503429412842
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 14 cost time: 3.4457144737243652
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1286938190460205
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4943368434906006
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.020052433013916
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.986 Test Loss: 0.096 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986071).  Saving model ...
Epoch: 18 cost time: 3.117582082748413
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.978 Test Loss: 0.170 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0243444442749023
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.644915819168091
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.987 Test Loss: 0.110 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 2.5226223468780518
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4389405250549316
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.053 Vali Acc: 0.994 Test Loss: 0.053 Test Acc: 0.994
Validation loss decreased (-0.986768 --> -0.993732).  Saving model ...
Epoch: 23 cost time: 2.3559184074401855
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4947426319122314
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.085 Vali Acc: 0.988 Test Loss: 0.085 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.510810613632202
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.991 Test Loss: 0.067 Test Acc: 0.991
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2914633750915527
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.49941349029541
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.986 Test Loss: 0.102 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4338927268981934
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.333503007888794
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.017285585403442
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.155496835708618
Epoch: 31, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.161 Vali Acc: 0.976 Test Loss: 0.161 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.372706413269043
Epoch: 32, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.204 Vali Acc: 0.981 Test Loss: 0.204 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9937325905292479
model parameter : 43706900
model size : 181.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.7778480052948
Epoch: 1, Steps: 89 | Train Loss: 1.549 Vali Loss: 0.428 Vali Acc: 0.868 Test Loss: 0.428 Test Acc: 0.868
Validation loss decreased (inf --> -0.867684).  Saving model ...
Epoch: 2 cost time: 6.138624906539917
Epoch: 2, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.867684 --> -0.877433).  Saving model ...
Epoch: 3 cost time: 5.1533567905426025
Epoch: 3, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.877433 --> -0.948465).  Saving model ...
Epoch: 4 cost time: 5.476607084274292
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.948465 --> -0.958215).  Saving model ...
Epoch: 5 cost time: 5.587489366531372
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.958215 --> -0.972143).  Saving model ...
Epoch: 6 cost time: 5.911660194396973
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.926073789596558
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
Validation loss decreased (-0.972143 --> -0.975625).  Saving model ...
Epoch: 8 cost time: 3.3822500705718994
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.315962791442871
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 3.242337703704834
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.318 Vali Acc: 0.940 Test Loss: 0.318 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3900792598724365
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.250 Vali Acc: 0.960 Test Loss: 0.250 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.551370143890381
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.6267828941345215
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4154136180877686
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.725424289703369
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.484187602996826
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 5.318153142929077
Epoch: 17, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.307 Vali Acc: 0.955 Test Loss: 0.307 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.840573072433472
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.180 Vali Acc: 0.983 Test Loss: 0.180 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983285).  Saving model ...
Epoch: 19 cost time: 5.521416187286377
Epoch: 19, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.781030654907227
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.983 Test Loss: 0.161 Test Acc: 0.983
Validation loss decreased (-0.983285 --> -0.983285).  Saving model ...
Epoch: 21 cost time: 3.567793846130371
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.572764873504639
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.971 Test Loss: 0.183 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.801689147949219
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.294 Vali Acc: 0.964 Test Loss: 0.294 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.310891389846802
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.194 Vali Acc: 0.978 Test Loss: 0.194 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.5221967697143555
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.961 Test Loss: 0.219 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.333468914031982
Epoch: 26, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.260 Vali Acc: 0.973 Test Loss: 0.260 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.38954496383667
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.972 Test Loss: 0.248 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3681342601776123
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.3892898559570312
Epoch: 29, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.3706130981445312
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.981 Test Loss: 0.213 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 44210708
model size : 183.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.176356792449951
Epoch: 1, Steps: 89 | Train Loss: 1.786 Vali Loss: 0.523 Vali Acc: 0.836 Test Loss: 0.523 Test Acc: 0.836
Validation loss decreased (inf --> -0.836346).  Saving model ...
Epoch: 2 cost time: 3.266645669937134
Epoch: 2, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.268 Vali Acc: 0.932 Test Loss: 0.268 Test Acc: 0.932
Validation loss decreased (-0.836346 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 2.844385862350464
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.261 Vali Acc: 0.939 Test Loss: 0.261 Test Acc: 0.939
Validation loss decreased (-0.931752 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 3.968838930130005
Epoch: 4, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.938716 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 3.685483694076538
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
Validation loss decreased (-0.940806 --> -0.951251).  Saving model ...
Epoch: 6 cost time: 4.390246629714966
Epoch: 6, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.257 Vali Acc: 0.943 Test Loss: 0.257 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.934983015060425
Epoch: 7, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.227 Vali Acc: 0.945 Test Loss: 0.227 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.332992076873779
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
Validation loss decreased (-0.951251 --> -0.970750).  Saving model ...
Epoch: 9 cost time: 4.349785566329956
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
Validation loss decreased (-0.970750 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 4.499454736709595
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.224 Vali Acc: 0.965 Test Loss: 0.224 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.682549238204956
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6826157569885254
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.816018581390381
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6658148765563965
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4439451694488525
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6631994247436523
Epoch: 16, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 4.261449098587036
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982589).  Saving model ...
Epoch: 18 cost time: 2.7111172676086426
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.197 Vali Acc: 0.978 Test Loss: 0.197 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.291109561920166
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.073448657989502
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983286).  Saving model ...
Epoch: 21 cost time: 3.8077683448791504
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.30914306640625
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.47385573387146
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 24 cost time: 2.62086820602417
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.747558832168579
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.986 Test Loss: 0.116 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 26 cost time: 2.5639166831970215
Epoch: 26, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.186 Vali Acc: 0.977 Test Loss: 0.186 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.693523406982422
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.141 Vali Acc: 0.984 Test Loss: 0.141 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.531888246536255
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.514202833175659
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.976 Test Loss: 0.207 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.843677043914795
Epoch: 30, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.247 Vali Acc: 0.962 Test Loss: 0.247 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.4468202590942383
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3833680152893066
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.985 Test Loss: 0.148 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4130823612213135
Epoch: 33, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.979 Test Loss: 0.186 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.7192318439483643
Epoch: 34, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.983 Test Loss: 0.187 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.0162956714630127
Epoch: 35, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 43855892
model size : 181.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.064734220504761
Epoch: 1, Steps: 89 | Train Loss: 2.083 Vali Loss: 0.535 Vali Acc: 0.853 Test Loss: 0.535 Test Acc: 0.853
Validation loss decreased (inf --> -0.853059).  Saving model ...
Epoch: 2 cost time: 2.3294005393981934
Epoch: 2, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
Validation loss decreased (-0.853059 --> -0.932449).  Saving model ...
Epoch: 3 cost time: 2.815077304840088
Epoch: 3, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
Validation loss decreased (-0.932449 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 2.867594003677368
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
Validation loss decreased (-0.955430 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 2.6222410202026367
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.534315586090088
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.968662 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 2.499844789505005
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3211395740509033
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.48003888130188
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.593630075454712
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.323 Vali Acc: 0.933 Test Loss: 0.323 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5659830570220947
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 12 cost time: 2.7406888008117676
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.450322389602661
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.772824764251709
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 2.488051176071167
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6916348934173584
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.597160577774048
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.982 Test Loss: 0.112 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5603959560394287
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.984 Test Loss: 0.112 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4948394298553467
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5755269527435303
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8686892986297607
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8192684650421143
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4533588886260986
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.979 Test Loss: 0.179 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4489099979400635
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.981 Test Loss: 0.142 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 43686932
model size : 181.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9710772037506104
Epoch: 1, Steps: 89 | Train Loss: 1.669 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (inf --> -0.855844).  Saving model ...
Epoch: 2 cost time: 3.284674882888794
Epoch: 2, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
Validation loss decreased (-0.855844 --> -0.876736).  Saving model ...
Epoch: 3 cost time: 4.101245403289795
Epoch: 3, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
Validation loss decreased (-0.876736 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 4.853308439254761
Epoch: 4, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.579 Vali Acc: 0.894 Test Loss: 0.579 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.19926118850708
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.942895 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 4.64145040512085
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.636 Vali Acc: 0.907 Test Loss: 0.636 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3418140411376953
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9112582206726074
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.958912 --> -0.965179).  Saving model ...
Epoch: 9 cost time: 2.9167914390563965
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
Validation loss decreased (-0.965179 --> -0.972839).  Saving model ...
Epoch: 10 cost time: 2.8020389080047607
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.221 Vali Acc: 0.966 Test Loss: 0.221 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.887751817703247
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
Validation loss decreased (-0.972839 --> -0.982589).  Saving model ...
Epoch: 12 cost time: 3.75606107711792
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.289 Vali Acc: 0.953 Test Loss: 0.289 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.008336305618286
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.322 Vali Acc: 0.949 Test Loss: 0.322 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.037639141082764
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.204 Vali Acc: 0.966 Test Loss: 0.204 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.002654075622559
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.185 Vali Acc: 0.979 Test Loss: 0.185 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.5595431327819824
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.327 Vali Acc: 0.951 Test Loss: 0.327 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.533886432647705
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.220 Vali Acc: 0.977 Test Loss: 0.220 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3616726398468018
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.357 Vali Acc: 0.955 Test Loss: 0.357 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5756726264953613
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9938764572143555
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.982 Test Loss: 0.193 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.885976552963257
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 44082452
model size : 182.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.239713191986084
Epoch: 1, Steps: 89 | Train Loss: 1.831 Vali Loss: 0.489 Vali Acc: 0.845 Test Loss: 0.489 Test Acc: 0.845
Validation loss decreased (inf --> -0.845399).  Saving model ...
Epoch: 2 cost time: 2.848137140274048
Epoch: 2, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.222 Vali Acc: 0.940 Test Loss: 0.222 Test Acc: 0.940
Validation loss decreased (-0.845399 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 3.069002151489258
Epoch: 3, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.940109 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 3.012275457382202
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0508008003234863
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
Validation loss decreased (-0.963090 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 3.0622005462646484
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 3.0444583892822266
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975625).  Saving model ...
Epoch: 8 cost time: 2.951756477355957
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.975625).  Saving model ...
Epoch: 9 cost time: 2.6963062286376953
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
Validation loss decreased (-0.975625 --> -0.983982).  Saving model ...
Epoch: 10 cost time: 2.7831766605377197
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7179484367370605
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.633974313735962
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8210883140563965
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.654993772506714
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.224 Vali Acc: 0.955 Test Loss: 0.224 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.682992935180664
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.236 Vali Acc: 0.974 Test Loss: 0.236 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.7129697799682617
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.317 Vali Acc: 0.939 Test Loss: 0.317 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.529379367828369
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.443113327026367
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.926586627960205
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984679).  Saving model ...
Epoch: 20 cost time: 4.065187215805054
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.966 Test Loss: 0.265 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6160576343536377
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.989 Test Loss: 0.086 Test Acc: 0.989
Validation loss decreased (-0.984679 --> -0.988857).  Saving model ...
Epoch: 22 cost time: 3.3502535820007324
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.328 Vali Acc: 0.976 Test Loss: 0.328 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9956634044647217
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.978 Test Loss: 0.201 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.252479553222656
Epoch: 24, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.027468204498291
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.178 Vali Acc: 0.983 Test Loss: 0.178 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2226028442382812
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.985 Test Loss: 0.150 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.5374510288238525
Epoch: 27, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.977 Test Loss: 0.210 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.437648296356201
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.974 Test Loss: 0.234 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.530484437942505
Epoch: 29, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.292 Vali Acc: 0.962 Test Loss: 0.292 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.538083076477051
Epoch: 30, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.638185501098633
Epoch: 31, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.986 Test Loss: 0.106 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 43829012
model size : 181.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6530394554138184
Epoch: 1, Steps: 89 | Train Loss: 2.123 Vali Loss: 0.557 Vali Acc: 0.847 Test Loss: 0.557 Test Acc: 0.847
Validation loss decreased (inf --> -0.847487).  Saving model ...
Epoch: 2 cost time: 3.0589587688446045
Epoch: 2, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.222 Vali Acc: 0.938 Test Loss: 0.222 Test Acc: 0.938
Validation loss decreased (-0.847487 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 2.7748708724975586
Epoch: 3, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
Validation loss decreased (-0.938020 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 2.407978057861328
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
Validation loss decreased (-0.963787 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 2.5620343685150146
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.974233 --> -0.983983).  Saving model ...
Epoch: 6 cost time: 2.3407747745513916
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 7 cost time: 2.3172264099121094
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 2.5640671253204346
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6856775283813477
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9132182598114014
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 2.5346786975860596
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6739892959594727
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.630415439605713
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 14 cost time: 2.608484983444214
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.508859872817993
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4890973567962646
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4531962871551514
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.427184581756592
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9151222705841064
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7925429344177246
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.525411605834961
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4067904949188232
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.172935724258423
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.986 Test Loss: 0.131 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 43676948
model size : 181.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.0093958377838135
Epoch: 1, Steps: 89 | Train Loss: 1.606 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
Validation loss decreased (inf --> -0.860718).  Saving model ...
Epoch: 2 cost time: 3.9155561923980713
Epoch: 2, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.392 Vali Acc: 0.893 Test Loss: 0.392 Test Acc: 0.893
Validation loss decreased (-0.860718 --> -0.893450).  Saving model ...
Epoch: 3 cost time: 2.8569259643554688
Epoch: 3, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.893450 --> -0.944287).  Saving model ...
Epoch: 4 cost time: 2.815451145172119
Epoch: 4, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.501 Vali Acc: 0.924 Test Loss: 0.501 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8292558193206787
Epoch: 5, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.694462537765503
Epoch: 6, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.944287 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 3.7003636360168457
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.288 Vali Acc: 0.955 Test Loss: 0.288 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.840245485305786
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.291 Vali Acc: 0.952 Test Loss: 0.291 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.007633447647095
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8039605617523193
Epoch: 10, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.240 Vali Acc: 0.962 Test Loss: 0.240 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.049298524856567
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.245 Vali Acc: 0.971 Test Loss: 0.245 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971446).  Saving model ...
Epoch: 12 cost time: 4.057265758514404
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.319 Vali Acc: 0.964 Test Loss: 0.319 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.03066611289978
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.559 Vali Acc: 0.940 Test Loss: 0.559 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.686660051345825
Epoch: 14, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.277 Vali Acc: 0.966 Test Loss: 0.277 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.021867036819458
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.971446 --> -0.974928).  Saving model ...
Epoch: 16 cost time: 2.807980537414551
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
Validation loss decreased (-0.974928 --> -0.977018).  Saving model ...
Epoch: 17 cost time: 2.875967264175415
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.978 Test Loss: 0.233 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977714).  Saving model ...
Epoch: 18 cost time: 3.5696756839752197
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.187 Vali Acc: 0.980 Test Loss: 0.187 Test Acc: 0.980
Validation loss decreased (-0.977714 --> -0.979803).  Saving model ...
Epoch: 19 cost time: 3.67631459236145
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.174 Vali Acc: 0.979 Test Loss: 0.174 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.669210433959961
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.189 Vali Acc: 0.981 Test Loss: 0.189 Test Acc: 0.981
Validation loss decreased (-0.979803 --> -0.981196).  Saving model ...
Epoch: 21 cost time: 3.584808111190796
Epoch: 21, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2943694591522217
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.257 Vali Acc: 0.980 Test Loss: 0.257 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9393887519836426
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.323 Vali Acc: 0.972 Test Loss: 0.323 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.851712942123413
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.981 Test Loss: 0.223 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.734315872192383
Epoch: 25, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.325 Vali Acc: 0.971 Test Loss: 0.325 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.8809666633605957
Epoch: 26, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.186 Vali Acc: 0.983 Test Loss: 0.186 Test Acc: 0.983
Validation loss decreased (-0.981196 --> -0.983285).  Saving model ...
Epoch: 27 cost time: 4.173827648162842
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.976 Test Loss: 0.284 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.866463899612427
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.289 Vali Acc: 0.976 Test Loss: 0.289 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.344273090362549
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.981 Test Loss: 0.262 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.609077453613281
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.982 Test Loss: 0.225 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.733519554138184
Epoch: 31, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.979 Test Loss: 0.242 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.879943609237671
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.972 Test Loss: 0.284 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.609828472137451
Epoch: 33, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.283 Vali Acc: 0.977 Test Loss: 0.283 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.536219358444214
Epoch: 34, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.981 Test Loss: 0.259 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.8606667518615723
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.986 Test Loss: 0.177 Test Acc: 0.986
Validation loss decreased (-0.983285 --> -0.986071).  Saving model ...
Epoch: 36 cost time: 2.874990940093994
Epoch: 36, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.213 Vali Acc: 0.983 Test Loss: 0.213 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.9112203121185303
Epoch: 37, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.983 Test Loss: 0.240 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4278182983398438
Epoch: 38, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.983 Test Loss: 0.211 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.9788031578063965
Epoch: 39, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.317 Vali Acc: 0.971 Test Loss: 0.317 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.162539958953857
Epoch: 40, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.338 Vali Acc: 0.967 Test Loss: 0.338 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.8577964305877686
Epoch: 41, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.210 Vali Acc: 0.982 Test Loss: 0.210 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.129112482070923
Epoch: 42, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.389 Vali Acc: 0.971 Test Loss: 0.389 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.6953372955322266
Epoch: 43, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.337 Vali Acc: 0.978 Test Loss: 0.337 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.3460285663604736
Epoch: 44, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.414 Vali Acc: 0.973 Test Loss: 0.414 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.075892448425293
Epoch: 45, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.270 Vali Acc: 0.983 Test Loss: 0.270 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 44079380
model size : 182.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.754444122314453
Epoch: 1, Steps: 89 | Train Loss: 1.906 Vali Loss: 0.647 Vali Acc: 0.815 Test Loss: 0.647 Test Acc: 0.815
Validation loss decreased (inf --> -0.814757).  Saving model ...
Epoch: 2 cost time: 2.4314630031585693
Epoch: 2, Steps: 89 | Train Loss: 0.377 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
Validation loss decreased (-0.814757 --> -0.949162).  Saving model ...
Epoch: 3 cost time: 2.41803240776062
Epoch: 3, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.949162 --> -0.970054).  Saving model ...
Epoch: 4 cost time: 2.690845489501953
Epoch: 4, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.002363681793213
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.349196434020996
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.970054 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 2.778550624847412
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1946849822998047
Epoch: 8, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 2.738960027694702
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.030160427093506
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8972790241241455
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1968882083892822
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.920827865600586
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.983 Test Loss: 0.140 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982589).  Saving model ...
Epoch: 14 cost time: 2.641577959060669
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4139750003814697
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5630416870117188
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6026690006256104
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.7707254886627197
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.357 Vali Acc: 0.947 Test Loss: 0.357 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6439239978790283
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.985375).  Saving model ...
Epoch: 20 cost time: 2.6975014209747314
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.217 Vali Acc: 0.966 Test Loss: 0.217 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4048826694488525
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.167 Vali Acc: 0.976 Test Loss: 0.167 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2752695083618164
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 23 cost time: 3.45123553276062
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.984 Test Loss: 0.126 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.531710147857666
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.9331674575805664
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.372 Vali Acc: 0.964 Test Loss: 0.372 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.120229244232178
Epoch: 26, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.137 Vali Acc: 0.984 Test Loss: 0.137 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.9716880321502686
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3134303092956543
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.235943555831909
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.5403151512145996
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.986 Test Loss: 0.121 Test Acc: 0.986
Validation loss decreased (-0.986071 --> -0.986071).  Saving model ...
Epoch: 31 cost time: 2.272561550140381
Epoch: 31, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.990 Test Loss: 0.121 Test Acc: 0.990
Validation loss decreased (-0.986071 --> -0.989553).  Saving model ...
Epoch: 32 cost time: 3.142176628112793
Epoch: 32, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.987 Test Loss: 0.110 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.0789711475372314
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.303 Vali Acc: 0.976 Test Loss: 0.303 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.7528116703033447
Epoch: 34, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.216 Vali Acc: 0.977 Test Loss: 0.216 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.5946426391601562
Epoch: 35, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.209 Vali Acc: 0.980 Test Loss: 0.209 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.0979716777801514
Epoch: 36, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.354 Vali Acc: 0.962 Test Loss: 0.354 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.3306174278259277
Epoch: 37, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.191 Vali Acc: 0.983 Test Loss: 0.191 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.3273627758026123
Epoch: 38, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.279 Vali Acc: 0.976 Test Loss: 0.279 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.2378480434417725
Epoch: 39, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.5369887351989746
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.990 Test Loss: 0.104 Test Acc: 0.990
Validation loss decreased (-0.989553 --> -0.990250).  Saving model ...
Epoch: 41 cost time: 2.353275775909424
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.991 Test Loss: 0.110 Test Acc: 0.991
Validation loss decreased (-0.990250 --> -0.990946).  Saving model ...
Epoch: 42 cost time: 2.4201650619506836
Epoch: 42, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.987 Test Loss: 0.154 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.005014657974243
Epoch: 43, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.985 Test Loss: 0.128 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.247572183609009
Epoch: 44, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.990 Test Loss: 0.122 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.1061127185821533
Epoch: 45, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.985 Test Loss: 0.238 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.0575015544891357
Epoch: 46, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.154 Vali Acc: 0.985 Test Loss: 0.154 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.233516216278076
Epoch: 47, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.151 Vali Acc: 0.987 Test Loss: 0.151 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.38786244392395
Epoch: 48, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.158 Vali Acc: 0.988 Test Loss: 0.158 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.9296681880950928
Epoch: 49, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.991 Test Loss: 0.140 Test Acc: 0.991
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.033643960952759
Epoch: 50, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.985 Test Loss: 0.181 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9909470752089137
model parameter : 43809044
model size : 181.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6212007999420166
Epoch: 1, Steps: 89 | Train Loss: 2.123 Vali Loss: 0.682 Vali Acc: 0.801 Test Loss: 0.682 Test Acc: 0.801
Validation loss decreased (inf --> -0.800829).  Saving model ...
Epoch: 2 cost time: 2.444453716278076
Epoch: 2, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.800829 --> -0.956126).  Saving model ...
Epoch: 3 cost time: 2.497849702835083
Epoch: 3, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 2.879443883895874
Epoch: 4, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.960305 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.71222186088562
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.975626 --> -0.982590).  Saving model ...
Epoch: 6 cost time: 2.5272974967956543
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0916683673858643
Epoch: 7, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9708311557769775
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.188387393951416
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1559882164001465
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
Validation loss decreased (-0.982590 --> -0.986072).  Saving model ...
Epoch: 11 cost time: 2.983135461807251
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9238498210906982
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.907621383666992
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2451248168945312
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.376960515975952
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.090120553970337
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8492133617401123
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.423135995864868
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5140178203582764
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.984 Test Loss: 0.092 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4849789142608643
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.208 Vali Acc: 0.969 Test Loss: 0.208 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 43673876
model size : 181.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.596434831619263
Epoch: 1, Steps: 89 | Train Loss: 1.617 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
Validation loss decreased (inf --> -0.825203).  Saving model ...
Epoch: 2 cost time: 3.193267345428467
Epoch: 2, Steps: 89 | Train Loss: 0.379 Vali Loss: 0.294 Vali Acc: 0.934 Test Loss: 0.294 Test Acc: 0.934
Validation loss decreased (-0.825203 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 3.746938943862915
Epoch: 3, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.933841 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 3.3757987022399902
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.241 Vali Acc: 0.955 Test Loss: 0.241 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7872633934020996
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
Validation loss decreased (-0.960305 --> -0.965179).  Saving model ...
Epoch: 6 cost time: 2.650590181350708
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
Validation loss decreased (-0.965179 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 2.753079652786255
Epoch: 7, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.192 Vali Acc: 0.964 Test Loss: 0.192 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.636981964111328
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.225 Vali Acc: 0.954 Test Loss: 0.225 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2342960834503174
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.295 Vali Acc: 0.951 Test Loss: 0.295 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.351520299911499
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.211 Vali Acc: 0.968 Test Loss: 0.211 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.266976833343506
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982589).  Saving model ...
Epoch: 12 cost time: 3.3404650688171387
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.23284912109375
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6041815280914307
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.688227891921997
Epoch: 15, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.219 Vali Acc: 0.974 Test Loss: 0.219 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0412051677703857
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.985 Test Loss: 0.132 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 3.4681904315948486
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.170 Vali Acc: 0.985 Test Loss: 0.170 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.350939989089966
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.989 Test Loss: 0.103 Test Acc: 0.989
Validation loss decreased (-0.985375 --> -0.988857).  Saving model ...
Epoch: 19 cost time: 3.409067392349243
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.154 Vali Acc: 0.985 Test Loss: 0.154 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.653144359588623
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.153 Vali Acc: 0.981 Test Loss: 0.153 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.620062828063965
Epoch: 21, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.273 Vali Acc: 0.977 Test Loss: 0.273 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5766961574554443
Epoch: 22, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.720517873764038
Epoch: 23, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.226 Vali Acc: 0.978 Test Loss: 0.226 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.719501256942749
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.987 Test Loss: 0.110 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.717740774154663
Epoch: 25, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.125619888305664
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.986 Test Loss: 0.146 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.8652076721191406
Epoch: 27, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.210 Vali Acc: 0.973 Test Loss: 0.210 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.0353200435638428
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.189 Vali Acc: 0.982 Test Loss: 0.189 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 43991828
model size : 182.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.112889766693115
Epoch: 1, Steps: 89 | Train Loss: 1.859 Vali Loss: 0.778 Vali Acc: 0.785 Test Loss: 0.778 Test Acc: 0.785
Validation loss decreased (inf --> -0.784811).  Saving model ...
Epoch: 2 cost time: 2.9453446865081787
Epoch: 2, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.266 Vali Acc: 0.946 Test Loss: 0.266 Test Acc: 0.946
Validation loss decreased (-0.784811 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 2.901780366897583
Epoch: 3, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.359 Vali Acc: 0.928 Test Loss: 0.359 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2692432403564453
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.945680 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 3.0525054931640625
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.958912 --> -0.977018).  Saving model ...
Epoch: 6 cost time: 2.7985565662384033
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
Validation loss decreased (-0.977018 --> -0.981893).  Saving model ...
Epoch: 7 cost time: 2.7478508949279785
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.434190034866333
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9334685802459717
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3375966548919678
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.882664680480957
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.133 Vali Acc: 0.982 Test Loss: 0.133 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.359936237335205
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 13 cost time: 3.3206214904785156
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7352781295776367
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.713381052017212
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.828 Vali Acc: 0.930 Test Loss: 0.828 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.474799156188965
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3590376377105713
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.096 Vali Acc: 0.988 Test Loss: 0.096 Test Acc: 0.988
Validation loss decreased (-0.983286 --> -0.988161).  Saving model ...
Epoch: 18 cost time: 2.4768123626708984
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.987 Test Loss: 0.107 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.514840602874756
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.276 Vali Acc: 0.962 Test Loss: 0.276 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9990220069885254
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9445745944976807
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.977 Test Loss: 0.177 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5451323986053467
Epoch: 22, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.192 Vali Acc: 0.977 Test Loss: 0.192 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6682958602905273
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.366 Vali Acc: 0.955 Test Loss: 0.366 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.864253282546997
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.202 Vali Acc: 0.973 Test Loss: 0.202 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.905606508255005
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.239 Vali Acc: 0.972 Test Loss: 0.239 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.255545139312744
Epoch: 26, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.170 Vali Acc: 0.980 Test Loss: 0.170 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.8841605186462402
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 43789076
model size : 181.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.00755763053894
Epoch: 1, Steps: 89 | Train Loss: 2.232 Vali Loss: 0.662 Vali Acc: 0.797 Test Loss: 0.662 Test Acc: 0.797
Validation loss decreased (inf --> -0.796651).  Saving model ...
Epoch: 2 cost time: 2.8329989910125732
Epoch: 2, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.796651 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 2.7340774536132812
Epoch: 3, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.930360 --> -0.974929).  Saving model ...
Epoch: 4 cost time: 2.48870849609375
Epoch: 4, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.574018716812134
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.975626 --> -0.980500).  Saving model ...
Epoch: 6 cost time: 2.486819267272949
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7225637435913086
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.29939341545105
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.636046886444092
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6370034217834473
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.6841092109680176
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5056896209716797
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.73271107673645
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.980500 --> -0.986768).  Saving model ...
Epoch: 14 cost time: 2.446180820465088
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.553112506866455
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4172523021698
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4509336948394775
Epoch: 17, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.392791986465454
Epoch: 18, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.190 Vali Acc: 0.968 Test Loss: 0.190 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4135005474090576
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.984 Test Loss: 0.108 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.68756103515625
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6432347297668457
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7832791805267334
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5439083576202393
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 43670804
model size : 181.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.952582597732544
Epoch: 1, Steps: 89 | Train Loss: 1.756 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
Validation loss decreased (inf --> -0.818935).  Saving model ...
Epoch: 2 cost time: 3.6620945930480957
Epoch: 2, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
Validation loss decreased (-0.818935 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 3.9823856353759766
Epoch: 3, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.512295722961426
Epoch: 4, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.955430 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 4.0345306396484375
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.475668430328369
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.218 Vali Acc: 0.962 Test Loss: 0.218 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.804157257080078
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5398542881011963
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977714).  Saving model ...
Epoch: 9 cost time: 2.7478644847869873
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.977714 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 2.63997483253479
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6077308654785156
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.738469362258911
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8704097270965576
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.415794849395752
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.218 Vali Acc: 0.976 Test Loss: 0.218 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.968438148498535
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 16 cost time: 3.6669838428497314
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4822983741760254
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.986 Test Loss: 0.125 Test Acc: 0.986
Validation loss decreased (-0.983982 --> -0.986071).  Saving model ...
Epoch: 18 cost time: 3.6440765857696533
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.392515182495117
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5993547439575195
Epoch: 20, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.186 Vali Acc: 0.981 Test Loss: 0.186 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.631906747817993
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.280 Vali Acc: 0.956 Test Loss: 0.280 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6313247680664062
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.251 Vali Acc: 0.981 Test Loss: 0.251 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.654153347015381
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.978 Test Loss: 0.222 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5878703594207764
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.985 Test Loss: 0.170 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3593175411224365
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.983 Test Loss: 0.205 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.2499217987060547
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.3330371379852295
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.987 Test Loss: 0.134 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.986767).  Saving model ...
Epoch: 28 cost time: 3.0521724224090576
Epoch: 28, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.980 Test Loss: 0.237 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0656678676605225
Epoch: 29, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.180 Vali Acc: 0.979 Test Loss: 0.180 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.943448781967163
Epoch: 30, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.7051024436950684
Epoch: 31, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.702066659927368
Epoch: 32, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.088 Vali Acc: 0.988 Test Loss: 0.088 Test Acc: 0.988
Validation loss decreased (-0.986767 --> -0.988161).  Saving model ...
Epoch: 33 cost time: 2.8655598163604736
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.988 Test Loss: 0.070 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 34 cost time: 3.0113394260406494
Epoch: 34, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.985 Test Loss: 0.150 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.039464950561523
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.178649663925171
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.987 Test Loss: 0.105 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.819265365600586
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.7794480323791504
Epoch: 38, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.985 Test Loss: 0.128 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.739072322845459
Epoch: 39, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.214 Vali Acc: 0.978 Test Loss: 0.214 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.4477009773254395
Epoch: 40, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.228 Vali Acc: 0.981 Test Loss: 0.228 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.9897215366363525
Epoch: 41, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.098530530929565
Epoch: 42, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.987 Test Loss: 0.141 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.199111461639404
Epoch: 43, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.985 Test Loss: 0.144 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 44005652
model size : 182.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.0760486125946045
Epoch: 1, Steps: 89 | Train Loss: 1.913 Vali Loss: 0.621 Vali Acc: 0.806 Test Loss: 0.621 Test Acc: 0.806
Validation loss decreased (inf --> -0.805704).  Saving model ...
Epoch: 2 cost time: 2.922271251678467
Epoch: 2, Steps: 89 | Train Loss: 0.377 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.805704 --> -0.962394).  Saving model ...
Epoch: 3 cost time: 2.35608172416687
Epoch: 3, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 3.031162977218628
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.697143793106079
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2323009967803955
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 2.586026191711426
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.338 Vali Acc: 0.946 Test Loss: 0.338 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9380369186401367
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9511075019836426
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
Validation loss decreased (-0.978411 --> -0.983982).  Saving model ...
Epoch: 10 cost time: 2.7690441608428955
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 2.5527868270874023
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.883535623550415
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.145522117614746
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 2.4746992588043213
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7477052211761475
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7394134998321533
Epoch: 16, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.72475528717041
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8797078132629395
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.479156970977783
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.254504442214966
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.560236692428589
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.070190906524658
Epoch: 22, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.93060564994812
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.986 Test Loss: 0.135 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 24 cost time: 2.7283105850219727
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.730865240097046
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.984 Test Loss: 0.122 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.076164960861206
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.992 Test Loss: 0.075 Test Acc: 0.992
Validation loss decreased (-0.986071 --> -0.991643).  Saving model ...
Epoch: 27 cost time: 2.6622438430786133
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3877241611480713
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.5058467388153076
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.4440619945526123
Epoch: 30, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.984 Test Loss: 0.114 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.6111443042755127
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.6489923000335693
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.980 Test Loss: 0.163 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.3114445209503174
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.989 Test Loss: 0.103 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.589966297149658
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.971 Test Loss: 0.191 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.1656763553619385
Epoch: 35, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.478529691696167
Epoch: 36, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.528 Vali Acc: 0.946 Test Loss: 0.528 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9916434540389972
model parameter : 43786004
model size : 181.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5441977977752686
Epoch: 1, Steps: 89 | Train Loss: 2.177 Vali Loss: 0.646 Vali Acc: 0.800 Test Loss: 0.646 Test Acc: 0.800
Validation loss decreased (inf --> -0.800133).  Saving model ...
Epoch: 2 cost time: 2.8033506870269775
Epoch: 2, Steps: 89 | Train Loss: 0.449 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.800133 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 2.781665802001953
Epoch: 3, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.936627 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.6248838901519775
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.962394 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.6185805797576904
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5929791927337646
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.975626 --> -0.981893).  Saving model ...
Epoch: 7 cost time: 2.619812250137329
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3944952487945557
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 2.3849093914031982
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.982590 --> -0.987465).  Saving model ...
Epoch: 10 cost time: 2.625603437423706
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5810678005218506
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5526485443115234
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.785038709640503
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.986 Test Loss: 0.084 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5797624588012695
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3810176849365234
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.340837240219116
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.337707757949829
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4859869480133057
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.673577308654785
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.969 Test Loss: 0.210 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 43667732
model size : 181.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.608537673950195
Epoch: 1, Steps: 89 | Train Loss: 1.625 Vali Loss: 0.414 Vali Acc: 0.873 Test Loss: 0.414 Test Acc: 0.873
Validation loss decreased (inf --> -0.872559).  Saving model ...
Epoch: 2 cost time: 2.6984448432922363
Epoch: 2, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.872559 --> -0.963090).  Saving model ...
Epoch: 3 cost time: 2.4004476070404053
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 2.604234457015991
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.372424840927124
Epoch: 5, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.964483 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 2.774655342102051
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.161 Vali Acc: 0.976 Test Loss: 0.161 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975625).  Saving model ...
Epoch: 7 cost time: 3.3109257221221924
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.48357892036438
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
Validation loss decreased (-0.975625 --> -0.980500).  Saving model ...
Epoch: 9 cost time: 3.3290534019470215
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2723052501678467
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.168 Vali Acc: 0.976 Test Loss: 0.168 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.400571346282959
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3138720989227295
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2694976329803467
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.184 Vali Acc: 0.976 Test Loss: 0.184 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.191185235977173
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.263592481613159
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.193 Vali Acc: 0.976 Test Loss: 0.193 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0995190143585205
Epoch: 16, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5344250202178955
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.185 Vali Acc: 0.980 Test Loss: 0.185 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3593649864196777
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.268 Vali Acc: 0.971 Test Loss: 0.268 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 43958804
model size : 182.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3083765506744385
Epoch: 1, Steps: 89 | Train Loss: 1.844 Vali Loss: 0.440 Vali Acc: 0.891 Test Loss: 0.440 Test Acc: 0.891
Validation loss decreased (inf --> -0.890664).  Saving model ...
Epoch: 2 cost time: 2.4484829902648926
Epoch: 2, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
Validation loss decreased (-0.890664 --> -0.960305).  Saving model ...
Epoch: 3 cost time: 2.2380692958831787
Epoch: 3, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.960305 --> -0.970054).  Saving model ...
Epoch: 4 cost time: 2.4806857109069824
Epoch: 4, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.970054 --> -0.981893).  Saving model ...
Epoch: 5 cost time: 2.623746156692505
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3065147399902344
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8633172512054443
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4278087615966797
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2401068210601807
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.940387010574341
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 11 cost time: 2.955554723739624
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3163623809814453
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.995962142944336
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.244831085205078
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.978 Test Loss: 0.152 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.332469940185547
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.670354127883911
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.362 Vali Acc: 0.942 Test Loss: 0.362 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.451921224594116
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.982 Test Loss: 0.123 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.342470407485962
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 19 cost time: 3.011624813079834
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.984679).  Saving model ...
Epoch: 20 cost time: 2.9349443912506104
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.987 Test Loss: 0.109 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 2.6509127616882324
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8544492721557617
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.202 Vali Acc: 0.978 Test Loss: 0.202 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1748626232147217
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.339 Vali Acc: 0.961 Test Loss: 0.339 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.010258436203003
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.984 Test Loss: 0.111 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.585433006286621
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.986 Test Loss: 0.101 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.9931061267852783
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 27 cost time: 2.590273857116699
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4397189617156982
Epoch: 28, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.6935603618621826
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.740142345428467
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.162 Vali Acc: 0.981 Test Loss: 0.162 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.6783287525177
Epoch: 31, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.218 Vali Acc: 0.968 Test Loss: 0.218 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.8579375743865967
Epoch: 32, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.9637811183929443
Epoch: 33, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.4583704471588135
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.982 Test Loss: 0.124 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.3683700561523438
Epoch: 35, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 36 cost time: 2.4482405185699463
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.674851179122925
Epoch: 37, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.9829728603363037
Epoch: 38, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.977 Test Loss: 0.191 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.971658945083618
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.0739643573760986
Epoch: 40, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.9539051055908203
Epoch: 41, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.038043737411499
Epoch: 42, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.989 Test Loss: 0.103 Test Acc: 0.989
Validation loss decreased (-0.987464 --> -0.988857).  Saving model ...
Epoch: 43 cost time: 2.7417938709259033
Epoch: 43, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.3392820358276367
Epoch: 44, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.987 Test Loss: 0.105 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.516652822494507
Epoch: 45, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.987 Test Loss: 0.118 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.413039207458496
Epoch: 46, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.4419591426849365
Epoch: 47, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.2771780490875244
Epoch: 48, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.050860643386841
Epoch: 49, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.984 Test Loss: 0.121 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.131577730178833
Epoch: 50, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 43789844
model size : 181.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7051405906677246
Epoch: 1, Steps: 89 | Train Loss: 2.120 Vali Loss: 0.601 Vali Acc: 0.834 Test Loss: 0.601 Test Acc: 0.834
Validation loss decreased (inf --> -0.834256).  Saving model ...
Epoch: 2 cost time: 2.857961654663086
Epoch: 2, Steps: 89 | Train Loss: 0.409 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.834256 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 2.463292121887207
Epoch: 3, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.937324 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 2.4997806549072266
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.951948 --> -0.966573).  Saving model ...
Epoch: 5 cost time: 2.788999319076538
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.966573 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 2.5280332565307617
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.466585397720337
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.065 Vali Acc: 0.986 Test Loss: 0.065 Test Acc: 0.986
Validation loss decreased (-0.979804 --> -0.986072).  Saving model ...
Epoch: 8 cost time: 2.417335271835327
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9101176261901855
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.986072 --> -0.986072).  Saving model ...
Epoch: 10 cost time: 2.5949878692626953
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4926817417144775
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.506474018096924
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.459519863128662
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7197704315185547
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4828402996063232
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8097586631774902
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.493579864501953
Epoch: 17, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6400129795074463
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.988 Test Loss: 0.080 Test Acc: 0.988
Validation loss decreased (-0.986072 --> -0.988161).  Saving model ...
Epoch: 19 cost time: 2.526409149169922
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7885372638702393
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4954423904418945
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6236069202423096
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.751894235610962
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8551156520843506
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5885636806488037
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.985 Test Loss: 0.139 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7759759426116943
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.989 Test Loss: 0.089 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 27 cost time: 2.7190029621124268
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.398 Vali Acc: 0.944 Test Loss: 0.398 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3691515922546387
Epoch: 28, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.409489870071411
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.6942555904388428
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.990 Test Loss: 0.089 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989553).  Saving model ...
Epoch: 31 cost time: 2.69559645652771
Epoch: 31, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.984 Test Loss: 0.112 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.6642189025878906
Epoch: 32, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.660430908203125
Epoch: 33, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.4162473678588867
Epoch: 34, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.554682493209839
Epoch: 35, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.192 Vali Acc: 0.982 Test Loss: 0.192 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.6836400032043457
Epoch: 36, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.752551317214966
Epoch: 37, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.215 Vali Acc: 0.969 Test Loss: 0.215 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.4536843299865723
Epoch: 38, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.7924203872680664
Epoch: 39, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.990 Test Loss: 0.104 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.7214202880859375
Epoch: 40, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.990 Test Loss: 0.087 Test Acc: 0.990
Validation loss decreased (-0.989553 --> -0.989553).  Saving model ...
Epoch: 41 cost time: 2.726196527481079
Epoch: 41, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.989 Test Loss: 0.090 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.8425564765930176
Epoch: 42, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.058 Vali Acc: 0.992 Test Loss: 0.058 Test Acc: 0.992
Validation loss decreased (-0.989553 --> -0.992339).  Saving model ...
Epoch: 43 cost time: 2.810014009475708
Epoch: 43, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.992 Test Loss: 0.075 Test Acc: 0.992
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.5583934783935547
Epoch: 44, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.988 Test Loss: 0.077 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.620091676712036
Epoch: 45, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.991 Test Loss: 0.069 Test Acc: 0.991
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.576322317123413
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.991 Test Loss: 0.065 Test Acc: 0.991
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.8029260635375977
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.992 Test Loss: 0.059 Test Acc: 0.992
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.640717029571533
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.992 Test Loss: 0.060 Test Acc: 0.992
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.647282600402832
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.993 Test Loss: 0.060 Test Acc: 0.993
Validation loss decreased (-0.992339 --> -0.993036).  Saving model ...
Epoch: 50 cost time: 2.4234437942504883
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.993 Test Loss: 0.058 Test Acc: 0.993
Validation loss decreased (-0.993036 --> -0.993036).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9930362116991643
model parameter : 43688468
model size : 181.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4265635013580322
Epoch: 1, Steps: 89 | Train Loss: 1.716 Vali Loss: 0.566 Vali Acc: 0.836 Test Loss: 0.566 Test Acc: 0.836
Validation loss decreased (inf --> -0.836345).  Saving model ...
Epoch: 2 cost time: 3.4976296424865723
Epoch: 2, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
Validation loss decreased (-0.836345 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 3.6128451824188232
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.939413 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 3.5835416316986084
Epoch: 4, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3830983638763428
Epoch: 5, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 2.749312400817871
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 3.2873780727386475
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.969358 --> -0.983286).  Saving model ...
Epoch: 8 cost time: 3.605454206466675
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.704190254211426
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7208621501922607
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6355831623077393
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0753936767578125
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6340150833129883
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.798365354537964
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.866281032562256
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.02532696723938
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.987 Test Loss: 0.109 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.986768).  Saving model ...
Epoch: 17 cost time: 3.174823522567749
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7415895462036133
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.150 Vali Acc: 0.983 Test Loss: 0.150 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7496631145477295
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.991 Test Loss: 0.110 Test Acc: 0.991
Validation loss decreased (-0.986768 --> -0.990946).  Saving model ...
Epoch: 20 cost time: 2.4974091053009033
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2419896125793457
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.151 Vali Acc: 0.983 Test Loss: 0.151 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7396652698516846
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.665212631225586
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.328718662261963
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.985 Test Loss: 0.093 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3956990242004395
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.177 Vali Acc: 0.978 Test Loss: 0.177 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.8576836585998535
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.464 Vali Acc: 0.953 Test Loss: 0.464 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.532623767852783
Epoch: 27, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.9039146900177
Epoch: 28, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.325 Vali Acc: 0.964 Test Loss: 0.325 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5429439544677734
Epoch: 29, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.984 Test Loss: 0.102 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9909470752089137
model parameter : 43925780
model size : 182.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8270046710968018
Epoch: 1, Steps: 89 | Train Loss: 1.968 Vali Loss: 0.486 Vali Acc: 0.857 Test Loss: 0.486 Test Acc: 0.857
Validation loss decreased (inf --> -0.856541).  Saving model ...
Epoch: 2 cost time: 2.604861259460449
Epoch: 2, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.209 Vali Acc: 0.938 Test Loss: 0.209 Test Acc: 0.938
Validation loss decreased (-0.856541 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 2.6678972244262695
Epoch: 3, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.938020 --> -0.966573).  Saving model ...
Epoch: 4 cost time: 2.54636549949646
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 2.3552911281585693
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0007588863372803
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.968662 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 2.3314554691314697
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4059174060821533
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3012077808380127
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3222036361694336
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7204365730285645
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.966 Test Loss: 0.255 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.426098108291626
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 13 cost time: 2.2611167430877686
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.541361093521118
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7818453311920166
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6422808170318604
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.987464).  Saving model ...
Epoch: 17 cost time: 2.898550033569336
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.935581684112549
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.929185152053833
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6953673362731934
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.402385950088501
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.990 Test Loss: 0.086 Test Acc: 0.990
Validation loss decreased (-0.987464 --> -0.989553).  Saving model ...
Epoch: 22 cost time: 2.9315924644470215
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.744880437850952
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.986 Test Loss: 0.121 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.044562816619873
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.983 Test Loss: 0.150 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0327041149139404
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.138 Vali Acc: 0.990 Test Loss: 0.138 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.4369211196899414
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.985 Test Loss: 0.167 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.032562494277954
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.988 Test Loss: 0.111 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2827188968658447
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.976 Test Loss: 0.173 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.289611339569092
Epoch: 29, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.425208330154419
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.153 Vali Acc: 0.986 Test Loss: 0.153 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.463684558868408
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.986 Test Loss: 0.108 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 43773716
model size : 181.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.030399322509766
Epoch: 1, Steps: 89 | Train Loss: 2.222 Vali Loss: 0.746 Vali Acc: 0.753 Test Loss: 0.746 Test Acc: 0.753
Validation loss decreased (inf --> -0.753474).  Saving model ...
Epoch: 2 cost time: 2.7343475818634033
Epoch: 2, Steps: 89 | Train Loss: 0.449 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.753474 --> -0.950555).  Saving model ...
Epoch: 3 cost time: 2.7415497303009033
Epoch: 3, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 3.0555355548858643
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.955430 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 3.056626319885254
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 2.8002519607543945
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 2.9187512397766113
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.608384847640991
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 2.5364749431610107
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 2.660679340362549
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.46561598777771
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4710865020751953
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6101391315460205
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 14 cost time: 2.7718303203582764
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.48244309425354
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6810765266418457
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.363330364227295
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.986 Test Loss: 0.087 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9067046642303467
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.612560510635376
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.650036334991455
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.862144947052002
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5202696323394775
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.874049425125122
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 43689236
model size : 181.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.799452066421509
Epoch: 1, Steps: 89 | Train Loss: 1.779 Vali Loss: 0.444 Vali Acc: 0.876 Test Loss: 0.444 Test Acc: 0.876
Validation loss decreased (inf --> -0.876040).  Saving model ...
Epoch: 2 cost time: 2.390859365463257
Epoch: 2, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.876040 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 2.303342580795288
Epoch: 3, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
Validation loss decreased (-0.937324 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 2.449404239654541
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.954734 --> -0.979108).  Saving model ...
Epoch: 5 cost time: 2.5009686946868896
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1419389247894287
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6259500980377197
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.534458637237549
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.012895107269287
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9744811058044434
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.118262529373169
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9039695262908936
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.979108 --> -0.986768).  Saving model ...
Epoch: 13 cost time: 2.797504425048828
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9350321292877197
Epoch: 14, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 15 cost time: 2.6924164295196533
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5668246746063232
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.356520175933838
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1297755241394043
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.289405107498169
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1602065563201904
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6875569820404053
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 22 cost time: 2.9483470916748047
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.058 Vali Acc: 0.990 Test Loss: 0.058 Test Acc: 0.990
Validation loss decreased (-0.987464 --> -0.989554).  Saving model ...
Epoch: 23 cost time: 2.8373966217041016
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.057 Vali Acc: 0.992 Test Loss: 0.057 Test Acc: 0.992
Validation loss decreased (-0.989554 --> -0.991643).  Saving model ...
Epoch: 24 cost time: 2.671053647994995
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.079 Vali Acc: 0.990 Test Loss: 0.079 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6384758949279785
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0684940814971924
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.215911388397217
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.989 Test Loss: 0.078 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3020360469818115
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.974 Test Loss: 0.188 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.783139944076538
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.181 Vali Acc: 0.981 Test Loss: 0.181 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.472933769226074
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.195 Vali Acc: 0.977 Test Loss: 0.195 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.4721217155456543
Epoch: 31, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.2197017669677734
Epoch: 32, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.38919734954834
Epoch: 33, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.109 Vali Acc: 0.985 Test Loss: 0.109 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9916434540389972
model parameter : 43899668
model size : 182.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.0027992725372314
Epoch: 1, Steps: 89 | Train Loss: 2.040 Vali Loss: 0.591 Vali Acc: 0.818 Test Loss: 0.591 Test Acc: 0.818
Validation loss decreased (inf --> -0.818239).  Saving model ...
Epoch: 2 cost time: 2.647794246673584
Epoch: 2, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
Validation loss decreased (-0.818239 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 2.438661575317383
Epoch: 3, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.938716 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 2.4969582557678223
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.963787 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 2.4409852027893066
Epoch: 5, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977019).  Saving model ...
Epoch: 6 cost time: 2.57035231590271
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 7 cost time: 2.6889359951019287
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.467128276824951
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.053 Vali Acc: 0.986 Test Loss: 0.053 Test Acc: 0.986
Validation loss decreased (-0.981893 --> -0.986072).  Saving model ...
Epoch: 9 cost time: 2.3203794956207275
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.907773971557617
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4425783157348633
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 12 cost time: 2.7551355361938477
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 13 cost time: 2.9483299255371094
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4014062881469727
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8711345195770264
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9055917263031006
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5719668865203857
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.073157787322998
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.064 Vali Acc: 0.989 Test Loss: 0.064 Test Acc: 0.989
Validation loss decreased (-0.987465 --> -0.988857).  Saving model ...
Epoch: 19 cost time: 2.5651261806488037
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.085815906524658
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.710819721221924
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.762697696685791
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.7459876537323
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.683688163757324
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.95295786857605
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.5991008281707764
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.6274173259735107
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.756180763244629
Epoch: 28, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.173 Vali Acc: 0.978 Test Loss: 0.173 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 43781396
model size : 181.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.866621255874634
Epoch: 1, Steps: 89 | Train Loss: 2.245 Vali Loss: 0.727 Vali Acc: 0.794 Test Loss: 0.727 Test Acc: 0.794
Validation loss decreased (inf --> -0.793865).  Saving model ...
Epoch: 2 cost time: 2.475560188293457
Epoch: 2, Steps: 89 | Train Loss: 0.482 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
Validation loss decreased (-0.793865 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 2.6614272594451904
Epoch: 3, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.924092 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 2.9829413890838623
Epoch: 4, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 2.918651819229126
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.967269 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.6523172855377197
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.112060785293579
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4187512397766113
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.784773111343384
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 2.6183323860168457
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.557657480239868
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 2.836764335632324
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3915786743164062
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 14 cost time: 2.386608362197876
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8671083450317383
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.329759359359741
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.880557060241699
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6493279933929443
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.670210599899292
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 20 cost time: 2.491619348526001
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8971199989318848
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4093410968780518
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3358068466186523
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.6086413860321045
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.986 Test Loss: 0.065 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3714659214019775
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.6300125122070312
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5012080669403076
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.317584991455078
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.885126829147339
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 30 cost time: 2.4038774967193604
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.987464 --> -0.987464).  Saving model ...
Epoch: 31 cost time: 2.504789352416992
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.986 Test Loss: 0.080 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.8328468799591064
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.6325535774230957
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.987464 --> -0.987464).  Saving model ...
Epoch: 34 cost time: 2.9085636138916016
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.988 Test Loss: 0.078 Test Acc: 0.988
Validation loss decreased (-0.987464 --> -0.988161).  Saving model ...
Epoch: 35 cost time: 2.873544216156006
Epoch: 35, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.959 Test Loss: 0.229 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.5196123123168945
Epoch: 36, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.9913246631622314
Epoch: 37, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.274 Vali Acc: 0.957 Test Loss: 0.274 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.323657512664795
Epoch: 38, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.2898006439208984
Epoch: 39, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.4176015853881836
Epoch: 40, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.2861740589141846
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.990 Test Loss: 0.068 Test Acc: 0.990
Validation loss decreased (-0.988161 --> -0.989554).  Saving model ...
Epoch: 42 cost time: 1.9986906051635742
Epoch: 42, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.736590623855591
Epoch: 43, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.234233856201172
Epoch: 44, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.335611581802368
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.988 Test Loss: 0.071 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.982671022415161
Epoch: 46, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.978 Test Loss: 0.169 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.4329400062561035
Epoch: 47, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.769796848297119
Epoch: 48, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.8362364768981934
Epoch: 49, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.2758114337921143
Epoch: 50, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el6_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 43713812
model size : 181.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.61275839805603
Epoch: 1, Steps: 89 | Train Loss: 1.490 Vali Loss: 0.483 Vali Acc: 0.866 Test Loss: 0.483 Test Acc: 0.866
Validation loss decreased (inf --> -0.866290).  Saving model ...
Epoch: 2 cost time: 7.6522135734558105
Epoch: 2, Steps: 89 | Train Loss: 0.608 Vali Loss: 0.410 Vali Acc: 0.898 Test Loss: 0.410 Test Acc: 0.898
Validation loss decreased (-0.866290 --> -0.898325).  Saving model ...
Epoch: 3 cost time: 5.212689399719238
Epoch: 3, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.572 Vali Acc: 0.897 Test Loss: 0.572 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.208379745483398
Epoch: 4, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.633 Vali Acc: 0.903 Test Loss: 0.633 Test Acc: 0.903
Validation loss decreased (-0.898325 --> -0.903197).  Saving model ...
Epoch: 5 cost time: 4.9874348640441895
Epoch: 5, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
Validation loss decreased (-0.903197 --> -0.910859).  Saving model ...
Epoch: 6 cost time: 6.802855491638184
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
Validation loss decreased (-0.910859 --> -0.937323).  Saving model ...
Epoch: 7 cost time: 5.226888418197632
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.426 Vali Acc: 0.933 Test Loss: 0.426 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.925661325454712
Epoch: 8, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.363 Vali Acc: 0.958 Test Loss: 0.363 Test Acc: 0.958
Validation loss decreased (-0.937323 --> -0.957517).  Saving model ...
Epoch: 9 cost time: 6.892141342163086
Epoch: 9, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.349 Vali Acc: 0.951 Test Loss: 0.349 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.155625581741333
Epoch: 10, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.353 Vali Acc: 0.955 Test Loss: 0.353 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.356174468994141
Epoch: 11, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.355 Vali Acc: 0.963 Test Loss: 0.355 Test Acc: 0.963
Validation loss decreased (-0.957517 --> -0.963088).  Saving model ...
Epoch: 12 cost time: 5.2601234912872314
Epoch: 12, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.387 Vali Acc: 0.954 Test Loss: 0.387 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.2285754680633545
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.368 Vali Acc: 0.970 Test Loss: 0.368 Test Acc: 0.970
Validation loss decreased (-0.963088 --> -0.970052).  Saving model ...
Epoch: 14 cost time: 5.157840251922607
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.396 Vali Acc: 0.970 Test Loss: 0.396 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.754757642745972
Epoch: 15, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.305 Vali Acc: 0.969 Test Loss: 0.305 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.449593782424927
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.307 Vali Acc: 0.969 Test Loss: 0.307 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.279391527175903
Epoch: 17, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.353 Vali Acc: 0.969 Test Loss: 0.353 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.85859227180481
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.417 Vali Acc: 0.964 Test Loss: 0.417 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.091686010360718
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.445 Vali Acc: 0.959 Test Loss: 0.445 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.654562473297119
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.693 Vali Acc: 0.940 Test Loss: 0.693 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.1885809898376465
Epoch: 21, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.445 Vali Acc: 0.963 Test Loss: 0.445 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.195842504501343
Epoch: 22, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.413 Vali Acc: 0.969 Test Loss: 0.413 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.24560546875
Epoch: 23, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.863 Vali Acc: 0.939 Test Loss: 0.863 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 37844756
model size : 159.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.521346092224121
Epoch: 1, Steps: 89 | Train Loss: 1.582 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
Validation loss decreased (inf --> -0.816150).  Saving model ...
Epoch: 2 cost time: 4.033077955245972
Epoch: 2, Steps: 89 | Train Loss: 0.486 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
Validation loss decreased (-0.816150 --> -0.883004).  Saving model ...
Epoch: 3 cost time: 4.940343379974365
Epoch: 3, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
Validation loss decreased (-0.883004 --> -0.922002).  Saving model ...
Epoch: 4 cost time: 4.568346738815308
Epoch: 4, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.385 Vali Acc: 0.918 Test Loss: 0.385 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.55432915687561
Epoch: 5, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
Validation loss decreased (-0.922002 --> -0.951251).  Saving model ...
Epoch: 6 cost time: 4.967947006225586
Epoch: 6, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.353 Vali Acc: 0.936 Test Loss: 0.353 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2012431621551514
Epoch: 7, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.806 Vali Acc: 0.891 Test Loss: 0.806 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9701390266418457
Epoch: 8, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.479 Vali Acc: 0.929 Test Loss: 0.479 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.951263904571533
Epoch: 9, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.347 Vali Acc: 0.951 Test Loss: 0.347 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.864762544631958
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.279 Vali Acc: 0.959 Test Loss: 0.279 Test Acc: 0.959
Validation loss decreased (-0.951251 --> -0.958911).  Saving model ...
Epoch: 11 cost time: 2.801811695098877
Epoch: 11, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.482 Vali Acc: 0.940 Test Loss: 0.482 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.07391095161438
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.287 Vali Acc: 0.971 Test Loss: 0.287 Test Acc: 0.971
Validation loss decreased (-0.958911 --> -0.970749).  Saving model ...
Epoch: 13 cost time: 3.115201711654663
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.294 Vali Acc: 0.965 Test Loss: 0.294 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.079751253128052
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.395 Vali Acc: 0.962 Test Loss: 0.395 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.65818190574646
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.371 Vali Acc: 0.967 Test Loss: 0.371 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2651286125183105
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.285 Vali Acc: 0.964 Test Loss: 0.285 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.8800623416900635
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.354 Vali Acc: 0.953 Test Loss: 0.354 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.716415643692017
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.532 Vali Acc: 0.947 Test Loss: 0.532 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4949569702148438
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.480 Vali Acc: 0.961 Test Loss: 0.480 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.662506818771362
Epoch: 20, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.429 Vali Acc: 0.955 Test Loss: 0.429 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.160340070724487
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.496 Vali Acc: 0.957 Test Loss: 0.496 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.343206405639648
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.280 Vali Acc: 0.981 Test Loss: 0.280 Test Acc: 0.981
Validation loss decreased (-0.970749 --> -0.980499).  Saving model ...
Epoch: 23 cost time: 4.09196662902832
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.301 Vali Acc: 0.980 Test Loss: 0.301 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0014095306396484
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.460 Vali Acc: 0.964 Test Loss: 0.460 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.895967483520508
Epoch: 25, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.372 Vali Acc: 0.966 Test Loss: 0.372 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.921647548675537
Epoch: 26, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.375 Vali Acc: 0.973 Test Loss: 0.375 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.760655164718628
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.974 Test Loss: 0.346 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.9297702312469482
Epoch: 28, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.375 Vali Acc: 0.964 Test Loss: 0.375 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.3385796546936035
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.338 Vali Acc: 0.969 Test Loss: 0.338 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.445842981338501
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.485 Vali Acc: 0.962 Test Loss: 0.485 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.588616132736206
Epoch: 31, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.515 Vali Acc: 0.958 Test Loss: 0.515 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.772982597351074
Epoch: 32, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.832 Vali Acc: 0.931 Test Loss: 0.832 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 37101332
model size : 156.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5868241786956787
Epoch: 1, Steps: 89 | Train Loss: 1.837 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (inf --> -0.810579).  Saving model ...
Epoch: 2 cost time: 2.3544485569000244
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.344 Vali Acc: 0.895 Test Loss: 0.344 Test Acc: 0.895
Validation loss decreased (-0.810579 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 2.36230206489563
Epoch: 3, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
Validation loss decreased (-0.894843 --> -0.942198).  Saving model ...
Epoch: 4 cost time: 2.335545301437378
Epoch: 4, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
Validation loss decreased (-0.942198 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 2.199390172958374
Epoch: 5, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1837942600250244
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.389 Vali Acc: 0.926 Test Loss: 0.389 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1674530506134033
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3202805519104004
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
Validation loss decreased (-0.959608 --> -0.972143).  Saving model ...
Epoch: 9 cost time: 2.329414129257202
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
Validation loss decreased (-0.972143 --> -0.977714).  Saving model ...
Epoch: 10 cost time: 2.2351133823394775
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2758727073669434
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.266 Vali Acc: 0.960 Test Loss: 0.266 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.257458209991455
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.229 Vali Acc: 0.968 Test Loss: 0.229 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3715362548828125
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.270 Vali Acc: 0.960 Test Loss: 0.270 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.138913869857788
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.295 Vali Acc: 0.956 Test Loss: 0.295 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8679497241973877
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.214 Vali Acc: 0.966 Test Loss: 0.214 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.13895583152771
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.180 Vali Acc: 0.978 Test Loss: 0.180 Test Acc: 0.978
Validation loss decreased (-0.977714 --> -0.978410).  Saving model ...
Epoch: 17 cost time: 3.079235076904297
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.172 Vali Acc: 0.981 Test Loss: 0.172 Test Acc: 0.981
Validation loss decreased (-0.978410 --> -0.980500).  Saving model ...
Epoch: 18 cost time: 4.033649921417236
Epoch: 18, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.238 Vali Acc: 0.976 Test Loss: 0.238 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8015706539154053
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.225 Vali Acc: 0.980 Test Loss: 0.225 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1194958686828613
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.349 Vali Acc: 0.968 Test Loss: 0.349 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3432602882385254
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.437 Vali Acc: 0.954 Test Loss: 0.437 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1189775466918945
Epoch: 22, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.176095724105835
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.333 Vali Acc: 0.969 Test Loss: 0.333 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1960747241973877
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.980 Test Loss: 0.170 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3085505962371826
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.981 Test Loss: 0.189 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2761733531951904
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.983 Test Loss: 0.178 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983285).  Saving model ...
Epoch: 27 cost time: 2.452812433242798
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.981 Test Loss: 0.185 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.435241937637329
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.978 Test Loss: 0.221 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9636006355285645
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.205 Vali Acc: 0.985 Test Loss: 0.205 Test Acc: 0.985
Validation loss decreased (-0.983285 --> -0.985374).  Saving model ...
Epoch: 30 cost time: 3.848435640335083
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.981 Test Loss: 0.194 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.2766144275665283
Epoch: 31, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.290 Vali Acc: 0.972 Test Loss: 0.290 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.6486730575561523
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.247 Vali Acc: 0.969 Test Loss: 0.247 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4317080974578857
Epoch: 33, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.234 Vali Acc: 0.979 Test Loss: 0.234 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.8230812549591064
Epoch: 34, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.979 Test Loss: 0.176 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.9545819759368896
Epoch: 35, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.262 Vali Acc: 0.971 Test Loss: 0.262 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.9873716831207275
Epoch: 36, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.217 Vali Acc: 0.977 Test Loss: 0.217 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.5205771923065186
Epoch: 37, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.983 Test Loss: 0.184 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.37662935256958
Epoch: 38, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.170 Vali Acc: 0.987 Test Loss: 0.170 Test Acc: 0.987
Validation loss decreased (-0.985374 --> -0.986767).  Saving model ...
Epoch: 39 cost time: 2.200051784515381
Epoch: 39, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.264 Vali Acc: 0.971 Test Loss: 0.264 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.140925407409668
Epoch: 40, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.454 Vali Acc: 0.966 Test Loss: 0.454 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.2544353008270264
Epoch: 41, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.298 Vali Acc: 0.969 Test Loss: 0.298 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.5257623195648193
Epoch: 42, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.234 Vali Acc: 0.986 Test Loss: 0.234 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.4742929935455322
Epoch: 43, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.244 Vali Acc: 0.978 Test Loss: 0.244 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.2941553592681885
Epoch: 44, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.205 Vali Acc: 0.984 Test Loss: 0.205 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.3262760639190674
Epoch: 45, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.2608091831207275
Epoch: 46, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.328 Vali Acc: 0.971 Test Loss: 0.328 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.32326340675354
Epoch: 47, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.984 Test Loss: 0.215 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.3017356395721436
Epoch: 48, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.985 Test Loss: 0.187 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 36729620
model size : 154.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.304259538650513
Epoch: 1, Steps: 89 | Train Loss: 1.574 Vali Loss: 0.522 Vali Acc: 0.866 Test Loss: 0.522 Test Acc: 0.866
Validation loss decreased (inf --> -0.865594).  Saving model ...
Epoch: 2 cost time: 5.6638147830963135
Epoch: 2, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.456 Vali Acc: 0.880 Test Loss: 0.456 Test Acc: 0.880
Validation loss decreased (-0.865594 --> -0.879522).  Saving model ...
Epoch: 3 cost time: 5.290367841720581
Epoch: 3, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.330 Vali Acc: 0.945 Test Loss: 0.330 Test Acc: 0.945
Validation loss decreased (-0.879522 --> -0.944983).  Saving model ...
Epoch: 4 cost time: 3.4469783306121826
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5105559825897217
Epoch: 5, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.944983 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 3.546513795852661
Epoch: 6, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.239 Vali Acc: 0.960 Test Loss: 0.239 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5240278244018555
Epoch: 7, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.327 Vali Acc: 0.939 Test Loss: 0.327 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9421162605285645
Epoch: 8, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.215 Vali Acc: 0.966 Test Loss: 0.215 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.067932844161987
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.416 Vali Acc: 0.944 Test Loss: 0.416 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4621310234069824
Epoch: 10, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.622567892074585
Epoch: 11, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.400 Vali Acc: 0.946 Test Loss: 0.400 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.81175971031189
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.428 Vali Acc: 0.944 Test Loss: 0.428 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.7426300048828125
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.965 Test Loss: 0.227 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.672069549560547
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.274 Vali Acc: 0.974 Test Loss: 0.274 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974231).  Saving model ...
Epoch: 15 cost time: 5.948105335235596
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.440 Vali Acc: 0.965 Test Loss: 0.440 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.133934259414673
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.496 Vali Acc: 0.955 Test Loss: 0.496 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.503817558288574
Epoch: 17, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.530 Vali Acc: 0.951 Test Loss: 0.530 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4711203575134277
Epoch: 18, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.222 Vali Acc: 0.974 Test Loss: 0.222 Test Acc: 0.974
Validation loss decreased (-0.974231 --> -0.974232).  Saving model ...
Epoch: 19 cost time: 4.4313249588012695
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.221 Vali Acc: 0.974 Test Loss: 0.221 Test Acc: 0.974
Validation loss decreased (-0.974232 --> -0.974232).  Saving model ...
Epoch: 20 cost time: 3.4248921871185303
Epoch: 20, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.262 Vali Acc: 0.977 Test Loss: 0.262 Test Acc: 0.977
Validation loss decreased (-0.974232 --> -0.977017).  Saving model ...
Epoch: 21 cost time: 5.6813178062438965
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.404 Vali Acc: 0.964 Test Loss: 0.404 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6330902576446533
Epoch: 22, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.284 Vali Acc: 0.976 Test Loss: 0.284 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.955289602279663
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.290 Vali Acc: 0.969 Test Loss: 0.290 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.044151782989502
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.685 Vali Acc: 0.950 Test Loss: 0.685 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.939830541610718
Epoch: 25, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.258 Vali Acc: 0.971 Test Loss: 0.258 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.09164571762085
Epoch: 26, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.316 Vali Acc: 0.969 Test Loss: 0.316 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.564435005187988
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.270 Vali Acc: 0.978 Test Loss: 0.270 Test Acc: 0.978
Validation loss decreased (-0.977017 --> -0.977713).  Saving model ...
Epoch: 28 cost time: 5.8947227001190186
Epoch: 28, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.295 Vali Acc: 0.971 Test Loss: 0.295 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.965770244598389
Epoch: 29, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.249 Vali Acc: 0.976 Test Loss: 0.249 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5476932525634766
Epoch: 30, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.307 Vali Acc: 0.973 Test Loss: 0.307 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.4857659339904785
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.212 Vali Acc: 0.977 Test Loss: 0.212 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.4883346557617188
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.275 Vali Acc: 0.976 Test Loss: 0.275 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.550213575363159
Epoch: 33, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.272 Vali Acc: 0.981 Test Loss: 0.272 Test Acc: 0.981
Validation loss decreased (-0.977713 --> -0.980499).  Saving model ...
Epoch: 34 cost time: 5.7890002727508545
Epoch: 34, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.329 Vali Acc: 0.976 Test Loss: 0.329 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.756885528564453
Epoch: 35, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.282 Vali Acc: 0.979 Test Loss: 0.282 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.6118080615997314
Epoch: 36, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.355 Vali Acc: 0.969 Test Loss: 0.355 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.634806156158447
Epoch: 37, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.377 Vali Acc: 0.974 Test Loss: 0.377 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.559664726257324
Epoch: 38, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.342 Vali Acc: 0.976 Test Loss: 0.342 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 5.948876857757568
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.977 Test Loss: 0.348 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.4958701133728027
Epoch: 40, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.455 Vali Acc: 0.967 Test Loss: 0.455 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.8945152759552
Epoch: 41, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.330 Vali Acc: 0.978 Test Loss: 0.330 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 5.817530393600464
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.969 Test Loss: 0.414 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 6.147736549377441
Epoch: 43, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.677 Vali Acc: 0.960 Test Loss: 0.677 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 37344788
model size : 157.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.001955986022949
Epoch: 1, Steps: 89 | Train Loss: 1.715 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (inf --> -0.848184).  Saving model ...
Epoch: 2 cost time: 2.3677902221679688
Epoch: 2, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.214 Vali Acc: 0.940 Test Loss: 0.214 Test Acc: 0.940
Validation loss decreased (-0.848184 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 4.064826011657715
Epoch: 3, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.940109 --> -0.949858).  Saving model ...
Epoch: 4 cost time: 3.4195480346679688
Epoch: 4, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.949858 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 4.215062856674194
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.956126 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 4.300006628036499
Epoch: 6, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.317725419998169
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 8 cost time: 4.281177043914795
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.556 Vali Acc: 0.898 Test Loss: 0.556 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.532087802886963
Epoch: 9, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.031633615493774
Epoch: 10, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.972143 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 3.5890581607818604
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.282336950302124
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.187 Vali Acc: 0.980 Test Loss: 0.187 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979803).  Saving model ...
Epoch: 13 cost time: 3.322021245956421
Epoch: 13, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.193 Vali Acc: 0.969 Test Loss: 0.193 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.082726716995239
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.976 Test Loss: 0.171 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.632160186767578
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.186 Vali Acc: 0.980 Test Loss: 0.186 Test Acc: 0.980
Validation loss decreased (-0.979803 --> -0.979803).  Saving model ...
Epoch: 16 cost time: 2.544877052307129
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5282905101776123
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.983 Test Loss: 0.140 Test Acc: 0.983
Validation loss decreased (-0.979803 --> -0.983286).  Saving model ...
Epoch: 18 cost time: 3.1860435009002686
Epoch: 18, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.771735668182373
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.983 Test Loss: 0.146 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7455129623413086
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.972 Test Loss: 0.224 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4570624828338623
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4158406257629395
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.961 Test Loss: 0.240 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.569192886352539
Epoch: 23, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2947335243225098
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.164 Vali Acc: 0.984 Test Loss: 0.164 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 25 cost time: 3.0012545585632324
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.980 Test Loss: 0.185 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5952155590057373
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.974 Test Loss: 0.235 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.5256659984588623
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.425187110900879
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.977 Test Loss: 0.239 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.540593147277832
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.978 Test Loss: 0.169 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.549837112426758
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.981 Test Loss: 0.208 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.195265769958496
Epoch: 31, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.981 Test Loss: 0.221 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.3720669746398926
Epoch: 32, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.985 Test Loss: 0.177 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985374).  Saving model ...
Epoch: 33 cost time: 3.012899875640869
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.982 Test Loss: 0.185 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.295340061187744
Epoch: 34, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.981 Test Loss: 0.201 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.22684907913208
Epoch: 35, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.314 Vali Acc: 0.971 Test Loss: 0.314 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.097733497619629
Epoch: 36, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.211447238922119
Epoch: 37, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.642 Vali Acc: 0.944 Test Loss: 0.642 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.1249709129333496
Epoch: 38, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.970 Test Loss: 0.279 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.415931224822998
Epoch: 39, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.957167863845825
Epoch: 40, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.5446243286132812
Epoch: 41, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.165 Vali Acc: 0.983 Test Loss: 0.165 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.932792901992798
Epoch: 42, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.979 Test Loss: 0.236 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 36956180
model size : 155.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6435134410858154
Epoch: 1, Steps: 89 | Train Loss: 1.855 Vali Loss: 0.500 Vali Acc: 0.854 Test Loss: 0.500 Test Acc: 0.854
Validation loss decreased (inf --> -0.854452).  Saving model ...
Epoch: 2 cost time: 2.215655565261841
Epoch: 2, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.230 Vali Acc: 0.939 Test Loss: 0.230 Test Acc: 0.939
Validation loss decreased (-0.854452 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 2.676663875579834
Epoch: 3, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.226 Vali Acc: 0.942 Test Loss: 0.226 Test Acc: 0.942
Validation loss decreased (-0.938716 --> -0.942198).  Saving model ...
Epoch: 4 cost time: 3.2597274780273438
Epoch: 4, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.230 Vali Acc: 0.957 Test Loss: 0.230 Test Acc: 0.957
Validation loss decreased (-0.942198 --> -0.956822).  Saving model ...
Epoch: 5 cost time: 2.761307954788208
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.238 Vali Acc: 0.955 Test Loss: 0.238 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4227991104125977
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
Validation loss decreased (-0.956822 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 3.466177225112915
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.501052141189575
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 3.3067712783813477
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5877015590667725
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.56783127784729
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.984 Test Loss: 0.111 Test Acc: 0.984
Validation loss decreased (-0.976322 --> -0.983982).  Saving model ...
Epoch: 12 cost time: 3.6833837032318115
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0512654781341553
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 14 cost time: 3.615447998046875
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4861185550689697
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.271 Vali Acc: 0.964 Test Loss: 0.271 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.101691961288452
Epoch: 16, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.273 Vali Acc: 0.964 Test Loss: 0.273 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.13987398147583
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.231 Vali Acc: 0.964 Test Loss: 0.231 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.217315435409546
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2585737705230713
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.980 Test Loss: 0.290 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.221881151199341
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.987 Test Loss: 0.129 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 2.4036929607391357
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.246 Vali Acc: 0.962 Test Loss: 0.246 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4456019401550293
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1264147758483887
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.467503786087036
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.985 Test Loss: 0.124 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8286867141723633
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.978 Test Loss: 0.219 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4274680614471436
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.980 Test Loss: 0.203 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9819138050079346
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.194 Vali Acc: 0.977 Test Loss: 0.194 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.0845847129821777
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.985 Test Loss: 0.145 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2530336380004883
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.276 Vali Acc: 0.969 Test Loss: 0.276 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.9646661281585693
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.985 Test Loss: 0.148 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 36702740
model size : 154.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.472560167312622
Epoch: 1, Steps: 89 | Train Loss: 1.486 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
Validation loss decreased (inf --> -0.844004).  Saving model ...
Epoch: 2 cost time: 4.153371572494507
Epoch: 2, Steps: 89 | Train Loss: 0.533 Vali Loss: 0.496 Vali Acc: 0.895 Test Loss: 0.496 Test Acc: 0.895
Validation loss decreased (-0.844004 --> -0.894842).  Saving model ...
Epoch: 3 cost time: 4.284189701080322
Epoch: 3, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.363 Vali Acc: 0.936 Test Loss: 0.363 Test Acc: 0.936
Validation loss decreased (-0.894842 --> -0.935930).  Saving model ...
Epoch: 4 cost time: 4.388021230697632
Epoch: 4, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.407864093780518
Epoch: 5, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.407 Vali Acc: 0.948 Test Loss: 0.407 Test Acc: 0.948
Validation loss decreased (-0.935930 --> -0.948464).  Saving model ...
Epoch: 6 cost time: 4.385515213012695
Epoch: 6, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.291 Vali Acc: 0.959 Test Loss: 0.291 Test Acc: 0.959
Validation loss decreased (-0.948464 --> -0.958911).  Saving model ...
Epoch: 7 cost time: 3.524420976638794
Epoch: 7, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.212 Vali Acc: 0.974 Test Loss: 0.212 Test Acc: 0.974
Validation loss decreased (-0.958911 --> -0.973535).  Saving model ...
Epoch: 8 cost time: 3.4928948879241943
Epoch: 8, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.394 Vali Acc: 0.958 Test Loss: 0.394 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8179781436920166
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.388 Vali Acc: 0.970 Test Loss: 0.388 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.304233074188232
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.281 Vali Acc: 0.970 Test Loss: 0.281 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.8779754638671875
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.524 Vali Acc: 0.946 Test Loss: 0.524 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.351742744445801
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.575 Vali Acc: 0.946 Test Loss: 0.575 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.499202251434326
Epoch: 13, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.452 Vali Acc: 0.967 Test Loss: 0.452 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.290654420852661
Epoch: 14, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.355 Vali Acc: 0.969 Test Loss: 0.355 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.783330202102661
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.328 Vali Acc: 0.974 Test Loss: 0.328 Test Acc: 0.974
Validation loss decreased (-0.973535 --> -0.974231).  Saving model ...
Epoch: 16 cost time: 3.4966843128204346
Epoch: 16, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.434 Vali Acc: 0.964 Test Loss: 0.434 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5474588871002197
Epoch: 17, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.227 Vali Acc: 0.978 Test Loss: 0.227 Test Acc: 0.978
Validation loss decreased (-0.974231 --> -0.977714).  Saving model ...
Epoch: 18 cost time: 3.596130609512329
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.344 Vali Acc: 0.966 Test Loss: 0.344 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.612433910369873
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.978 Test Loss: 0.248 Test Acc: 0.978
Validation loss decreased (-0.977714 --> -0.978410).  Saving model ...
Epoch: 20 cost time: 4.94795560836792
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.296 Vali Acc: 0.983 Test Loss: 0.296 Test Acc: 0.983
Validation loss decreased (-0.978410 --> -0.982588).  Saving model ...
Epoch: 21 cost time: 4.949577331542969
Epoch: 21, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.347 Vali Acc: 0.978 Test Loss: 0.347 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.391411066055298
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.309 Vali Acc: 0.974 Test Loss: 0.309 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.4880423545837402
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.414 Vali Acc: 0.968 Test Loss: 0.414 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4924871921539307
Epoch: 24, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.378 Vali Acc: 0.968 Test Loss: 0.378 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4945762157440186
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.370 Vali Acc: 0.974 Test Loss: 0.370 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.189533472061157
Epoch: 26, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.342 Vali Acc: 0.974 Test Loss: 0.342 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.339534521102905
Epoch: 27, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.841 Vali Acc: 0.948 Test Loss: 0.841 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.584103107452393
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.484 Vali Acc: 0.972 Test Loss: 0.484 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.692287445068359
Epoch: 29, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.377 Vali Acc: 0.976 Test Loss: 0.377 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.460981130599976
Epoch: 30, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.476 Vali Acc: 0.971 Test Loss: 0.476 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 37351700
model size : 157.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6224024295806885
Epoch: 1, Steps: 89 | Train Loss: 1.648 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
Validation loss decreased (inf --> -0.825203).  Saving model ...
Epoch: 2 cost time: 2.4601709842681885
Epoch: 2, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.673 Vali Acc: 0.861 Test Loss: 0.673 Test Acc: 0.861
Validation loss decreased (-0.825203 --> -0.860718).  Saving model ...
Epoch: 3 cost time: 2.462893009185791
Epoch: 3, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.301 Vali Acc: 0.923 Test Loss: 0.301 Test Acc: 0.923
Validation loss decreased (-0.860718 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 2.670302391052246
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
Validation loss decreased (-0.922699 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 2.5322070121765137
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.263 Vali Acc: 0.947 Test Loss: 0.263 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.555213689804077
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.450 Vali Acc: 0.944 Test Loss: 0.450 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3944249153137207
Epoch: 7, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.353 Vali Acc: 0.953 Test Loss: 0.353 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.489408254623413
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.99890398979187
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.246 Vali Acc: 0.969 Test Loss: 0.246 Test Acc: 0.969
Validation loss decreased (-0.959608 --> -0.969357).  Saving model ...
Epoch: 10 cost time: 3.7370126247406006
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.964 Test Loss: 0.267 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1237969398498535
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.310 Vali Acc: 0.965 Test Loss: 0.310 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.036951780319214
Epoch: 12, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.339 Vali Acc: 0.964 Test Loss: 0.339 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.08262825012207
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.179 Vali Acc: 0.979 Test Loss: 0.179 Test Acc: 0.979
Validation loss decreased (-0.969357 --> -0.979107).  Saving model ...
Epoch: 14 cost time: 2.5789356231689453
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4230167865753174
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.317 Vali Acc: 0.962 Test Loss: 0.317 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.577230930328369
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.223 Vali Acc: 0.978 Test Loss: 0.223 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5566112995147705
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.346 Vali Acc: 0.967 Test Loss: 0.346 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.288835048675537
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.242 Vali Acc: 0.971 Test Loss: 0.242 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8709869384765625
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.408 Vali Acc: 0.956 Test Loss: 0.408 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.124772548675537
Epoch: 20, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.318 Vali Acc: 0.964 Test Loss: 0.318 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.4398601055145264
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.287 Vali Acc: 0.963 Test Loss: 0.287 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.504169225692749
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.979 Test Loss: 0.216 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5506293773651123
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.275 Vali Acc: 0.972 Test Loss: 0.275 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 36963092
model size : 155.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1817686557769775
Epoch: 1, Steps: 89 | Train Loss: 1.837 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
Validation loss decreased (inf --> -0.844006).  Saving model ...
Epoch: 2 cost time: 2.418546438217163
Epoch: 2, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.844006 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 2.2398221492767334
Epoch: 3, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
Validation loss decreased (-0.934538 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 2.156161308288574
Epoch: 4, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3977608680725098
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.955430 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 2.3720717430114746
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 2.704163074493408
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8612430095672607
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 2.1681923866271973
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0078160762786865
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2201437950134277
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1965904235839844
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.122457981109619
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 14 cost time: 3.344949960708618
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.984 Test Loss: 0.174 Test Acc: 0.984
Validation loss decreased (-0.980500 --> -0.983982).  Saving model ...
Epoch: 15 cost time: 3.5073795318603516
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.966 Test Loss: 0.223 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.801570177078247
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.140 Vali Acc: 0.979 Test Loss: 0.140 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.51926851272583
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4997470378875732
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 19 cost time: 3.0889363288879395
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.277782917022705
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.980 Test Loss: 0.178 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1123316287994385
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2809057235717773
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.249 Vali Acc: 0.971 Test Loss: 0.249 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1726114749908447
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.336 Vali Acc: 0.971 Test Loss: 0.336 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7707571983337402
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.150 Vali Acc: 0.983 Test Loss: 0.150 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.144946575164795
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.983 Test Loss: 0.188 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.185607433319092
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.979 Test Loss: 0.237 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7500736713409424
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.979 Test Loss: 0.175 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9171667098999023
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.979 Test Loss: 0.189 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 36675860
model size : 154.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.807052850723267
Epoch: 1, Steps: 89 | Train Loss: 1.575 Vali Loss: 0.506 Vali Acc: 0.871 Test Loss: 0.506 Test Acc: 0.871
Validation loss decreased (inf --> -0.871165).  Saving model ...
Epoch: 2 cost time: 3.6278128623962402
Epoch: 2, Steps: 89 | Train Loss: 0.522 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.871165 --> -0.899717).  Saving model ...
Epoch: 3 cost time: 3.3901309967041016
Epoch: 3, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.467 Vali Acc: 0.907 Test Loss: 0.467 Test Acc: 0.907
Validation loss decreased (-0.899717 --> -0.907377).  Saving model ...
Epoch: 4 cost time: 4.345097541809082
Epoch: 4, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.907377 --> -0.944287).  Saving model ...
Epoch: 5 cost time: 4.288361549377441
Epoch: 5, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.294 Vali Acc: 0.942 Test Loss: 0.294 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.65183424949646
Epoch: 6, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.322 Vali Acc: 0.957 Test Loss: 0.322 Test Acc: 0.957
Validation loss decreased (-0.944287 --> -0.956821).  Saving model ...
Epoch: 7 cost time: 4.802403450012207
Epoch: 7, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.313 Vali Acc: 0.947 Test Loss: 0.313 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.777741432189941
Epoch: 8, Steps: 89 | Train Loss: 0.160 Vali Loss: 1.140 Vali Acc: 0.903 Test Loss: 1.140 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.49791407585144
Epoch: 9, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.469 Vali Acc: 0.924 Test Loss: 0.469 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5743980407714844
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.209 Vali Acc: 0.978 Test Loss: 0.209 Test Acc: 0.978
Validation loss decreased (-0.956821 --> -0.978410).  Saving model ...
Epoch: 11 cost time: 3.5354135036468506
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.393 Vali Acc: 0.956 Test Loss: 0.393 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.569582223892212
Epoch: 12, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.363 Vali Acc: 0.955 Test Loss: 0.363 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.143072128295898
Epoch: 13, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.458 Vali Acc: 0.942 Test Loss: 0.458 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.863667726516724
Epoch: 14, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.350 Vali Acc: 0.952 Test Loss: 0.350 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8674914836883545
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
Validation loss decreased (-0.978410 --> -0.978410).  Saving model ...
Epoch: 16 cost time: 5.289166212081909
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.981 Test Loss: 0.206 Test Acc: 0.981
Validation loss decreased (-0.978410 --> -0.981196).  Saving model ...
Epoch: 17 cost time: 5.398550033569336
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.266 Vali Acc: 0.974 Test Loss: 0.266 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.723130702972412
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.241 Vali Acc: 0.978 Test Loss: 0.241 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.174491882324219
Epoch: 19, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.257 Vali Acc: 0.971 Test Loss: 0.257 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.49202823638916
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.981 Test Loss: 0.186 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.551509141921997
Epoch: 21, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.235 Vali Acc: 0.978 Test Loss: 0.235 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.415065050125122
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.346 Vali Acc: 0.965 Test Loss: 0.346 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.4729042053222656
Epoch: 23, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.350 Vali Acc: 0.964 Test Loss: 0.350 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.1782917976379395
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.331 Vali Acc: 0.967 Test Loss: 0.331 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.659815073013306
Epoch: 25, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.423 Vali Acc: 0.960 Test Loss: 0.423 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.612014532089233
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.697 Vali Acc: 0.947 Test Loss: 0.697 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 37358612
model size : 157.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6079323291778564
Epoch: 1, Steps: 89 | Train Loss: 1.651 Vali Loss: 0.775 Vali Acc: 0.799 Test Loss: 0.775 Test Acc: 0.799
Validation loss decreased (inf --> -0.799435).  Saving model ...
Epoch: 2 cost time: 2.2752370834350586
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.333 Vali Acc: 0.923 Test Loss: 0.333 Test Acc: 0.923
Validation loss decreased (-0.799435 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 2.390749454498291
Epoch: 3, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.923395 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 2.253889560699463
Epoch: 4, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.582 Vali Acc: 0.895 Test Loss: 0.582 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9441487789154053
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
Validation loss decreased (-0.948466 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 3.0452630519866943
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.296 Vali Acc: 0.946 Test Loss: 0.296 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.902850389480591
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
Validation loss decreased (-0.954037 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 3.1047439575195312
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.281 Vali Acc: 0.954 Test Loss: 0.281 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9213154315948486
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.376 Vali Acc: 0.955 Test Loss: 0.376 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5021069049835205
Epoch: 10, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3780324459075928
Epoch: 11, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.410 Vali Acc: 0.941 Test Loss: 0.410 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.47334623336792
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.970 Test Loss: 0.246 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970053).  Saving model ...
Epoch: 13 cost time: 2.2663824558258057
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.294 Vali Acc: 0.967 Test Loss: 0.294 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3920624256134033
Epoch: 14, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.298 Vali Acc: 0.967 Test Loss: 0.298 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3051650524139404
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.970053 --> -0.974928).  Saving model ...
Epoch: 16 cost time: 3.161100387573242
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.337 Vali Acc: 0.961 Test Loss: 0.337 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.001561403274536
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.974 Test Loss: 0.224 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0253162384033203
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.325 Vali Acc: 0.959 Test Loss: 0.325 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.832953929901123
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.290 Vali Acc: 0.966 Test Loss: 0.290 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7496514320373535
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.331 Vali Acc: 0.969 Test Loss: 0.331 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.7798798084259033
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.305 Vali Acc: 0.972 Test Loss: 0.305 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.593252420425415
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.309 Vali Acc: 0.976 Test Loss: 0.309 Test Acc: 0.976
Validation loss decreased (-0.974928 --> -0.976320).  Saving model ...
Epoch: 23 cost time: 2.2950990200042725
Epoch: 23, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.548 Vali Acc: 0.948 Test Loss: 0.548 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3170130252838135
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.984 Test Loss: 0.215 Test Acc: 0.984
Validation loss decreased (-0.976320 --> -0.983981).  Saving model ...
Epoch: 25 cost time: 2.2933878898620605
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.983 Test Loss: 0.204 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3800549507141113
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.969 Test Loss: 0.271 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.248880624771118
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.473 Vali Acc: 0.966 Test Loss: 0.473 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2914299964904785
Epoch: 28, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.237 Vali Acc: 0.978 Test Loss: 0.237 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.2500579357147217
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.981 Test Loss: 0.219 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.358346939086914
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.982 Test Loss: 0.213 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.130479097366333
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.983 Test Loss: 0.212 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.173563003540039
Epoch: 32, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4424796104431152
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.371752977371216
Epoch: 34, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.355 Vali Acc: 0.974 Test Loss: 0.355 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 36868628
model size : 155.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.996939182281494
Epoch: 1, Steps: 89 | Train Loss: 1.888 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
Validation loss decreased (inf --> -0.814757).  Saving model ...
Epoch: 2 cost time: 2.5784029960632324
Epoch: 2, Steps: 89 | Train Loss: 0.401 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
Validation loss decreased (-0.814757 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 2.782217264175415
Epoch: 3, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.935234 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 2.7305593490600586
Epoch: 4, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 2.328389883041382
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.972144 --> -0.983286).  Saving model ...
Epoch: 6 cost time: 2.234081745147705
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7413430213928223
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.096048355102539
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7729530334472656
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6735055446624756
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4324867725372314
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4934661388397217
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1144392490386963
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1510794162750244
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.235405206680298
Epoch: 15, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 36648980
model size : 154.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.165532350540161
Epoch: 1, Steps: 89 | Train Loss: 1.534 Vali Loss: 0.491 Vali Acc: 0.866 Test Loss: 0.491 Test Acc: 0.866
Validation loss decreased (inf --> -0.866290).  Saving model ...
Epoch: 2 cost time: 4.521962642669678
Epoch: 2, Steps: 89 | Train Loss: 0.525 Vali Loss: 0.247 Vali Acc: 0.940 Test Loss: 0.247 Test Acc: 0.940
Validation loss decreased (-0.866290 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 5.381905794143677
Epoch: 3, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.341 Vali Acc: 0.933 Test Loss: 0.341 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.0425121784210205
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.940109 --> -0.944287).  Saving model ...
Epoch: 5 cost time: 4.9000327587127686
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.242 Vali Acc: 0.945 Test Loss: 0.242 Test Acc: 0.945
Validation loss decreased (-0.944287 --> -0.944984).  Saving model ...
Epoch: 6 cost time: 5.004187107086182
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
Validation loss decreased (-0.944984 --> -0.970750).  Saving model ...
Epoch: 7 cost time: 5.025319576263428
Epoch: 7, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.099417686462402
Epoch: 8, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.679583549499512
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.227 Vali Acc: 0.973 Test Loss: 0.227 Test Acc: 0.973
Validation loss decreased (-0.970750 --> -0.972839).  Saving model ...
Epoch: 10 cost time: 3.7330801486968994
Epoch: 10, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.241 Vali Acc: 0.974 Test Loss: 0.241 Test Acc: 0.974
Validation loss decreased (-0.972839 --> -0.974232).  Saving model ...
Epoch: 11 cost time: 3.5111920833587646
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.228 Vali Acc: 0.973 Test Loss: 0.228 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4703209400177
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.247 Vali Acc: 0.974 Test Loss: 0.247 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.475328207015991
Epoch: 13, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.212 Vali Acc: 0.978 Test Loss: 0.212 Test Acc: 0.978
Validation loss decreased (-0.974232 --> -0.977714).  Saving model ...
Epoch: 14 cost time: 4.603800058364868
Epoch: 14, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.006718397140503
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.296 Vali Acc: 0.968 Test Loss: 0.296 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.63274621963501
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.296 Vali Acc: 0.971 Test Loss: 0.296 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.368930816650391
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.358 Vali Acc: 0.967 Test Loss: 0.358 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.470342397689819
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.395 Vali Acc: 0.961 Test Loss: 0.395 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.551467657089233
Epoch: 19, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.479 Vali Acc: 0.951 Test Loss: 0.479 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.6717379093170166
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.369 Vali Acc: 0.970 Test Loss: 0.369 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.525541305541992
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.254 Vali Acc: 0.974 Test Loss: 0.254 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.456087589263916
Epoch: 22, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.589353322982788
Epoch: 23, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 37348628
model size : 157.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5078933238983154
Epoch: 1, Steps: 89 | Train Loss: 1.724 Vali Loss: 0.510 Vali Acc: 0.860 Test Loss: 0.510 Test Acc: 0.860
Validation loss decreased (inf --> -0.860023).  Saving model ...
Epoch: 2 cost time: 2.314913272857666
Epoch: 2, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.260 Vali Acc: 0.935 Test Loss: 0.260 Test Acc: 0.935
Validation loss decreased (-0.860023 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 2.2621307373046875
Epoch: 3, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
Validation loss decreased (-0.934538 --> -0.942198).  Saving model ...
Epoch: 4 cost time: 2.9357645511627197
Epoch: 4, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
Validation loss decreased (-0.942198 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 2.804622173309326
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.248 Vali Acc: 0.961 Test Loss: 0.248 Test Acc: 0.961
Validation loss decreased (-0.945680 --> -0.961000).  Saving model ...
Epoch: 6 cost time: 2.921848773956299
Epoch: 6, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.200 Vali Acc: 0.965 Test Loss: 0.200 Test Acc: 0.965
Validation loss decreased (-0.961000 --> -0.965179).  Saving model ...
Epoch: 7 cost time: 2.370640516281128
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
Validation loss decreased (-0.965179 --> -0.965179).  Saving model ...
Epoch: 8 cost time: 3.1193337440490723
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.179 Vali Acc: 0.974 Test Loss: 0.179 Test Acc: 0.974
Validation loss decreased (-0.965179 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 2.8991992473602295
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.251 Vali Acc: 0.962 Test Loss: 0.251 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6460161209106445
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 3.272170305252075
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.181 Vali Acc: 0.976 Test Loss: 0.181 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975625).  Saving model ...
Epoch: 12 cost time: 2.278055429458618
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.457930088043213
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.251 Vali Acc: 0.968 Test Loss: 0.251 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2941646575927734
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.981 Test Loss: 0.194 Test Acc: 0.981
Validation loss decreased (-0.975625 --> -0.980499).  Saving model ...
Epoch: 15 cost time: 3.5745410919189453
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.184 Vali Acc: 0.983 Test Loss: 0.184 Test Acc: 0.983
Validation loss decreased (-0.980499 --> -0.983285).  Saving model ...
Epoch: 16 cost time: 2.4852828979492188
Epoch: 16, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.324 Vali Acc: 0.971 Test Loss: 0.324 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.528566360473633
Epoch: 17, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.324 Vali Acc: 0.955 Test Loss: 0.324 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.253357410430908
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.327 Vali Acc: 0.964 Test Loss: 0.327 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6611380577087402
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.278 Vali Acc: 0.971 Test Loss: 0.278 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6596474647521973
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.453638792037964
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.3893816471099854
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.8663828372955322
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.183908700942993
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.231 Vali Acc: 0.978 Test Loss: 0.231 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.672964572906494
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.345 Vali Acc: 0.962 Test Loss: 0.345 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 36875540
model size : 155.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2588648796081543
Epoch: 1, Steps: 89 | Train Loss: 1.968 Vali Loss: 0.541 Vali Acc: 0.842 Test Loss: 0.541 Test Acc: 0.842
Validation loss decreased (inf --> -0.841917).  Saving model ...
Epoch: 2 cost time: 2.0801000595092773
Epoch: 2, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
Validation loss decreased (-0.841917 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 2.6250126361846924
Epoch: 3, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (-0.945680 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 2.58524751663208
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.955430 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 2.1279098987579346
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.218 Vali Acc: 0.947 Test Loss: 0.218 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6251230239868164
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.969358 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 2.0811767578125
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.270318031311035
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7888171672821045
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 2.4311227798461914
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0919787883758545
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1124701499938965
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.336 Vali Acc: 0.955 Test Loss: 0.336 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.776251792907715
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7321290969848633
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.974 Test Loss: 0.162 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7422893047332764
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.990 Test Loss: 0.080 Test Acc: 0.990
Validation loss decreased (-0.981893 --> -0.990250).  Saving model ...
Epoch: 16 cost time: 2.8072071075439453
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.988 Test Loss: 0.074 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.412146806716919
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.990 Test Loss: 0.087 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.043192148208618
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1044728755950928
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6500494480133057
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.987 Test Loss: 0.111 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.438082695007324
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.957 Test Loss: 0.275 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.220710515975952
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.981 Test Loss: 0.158 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.468045234680176
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.985 Test Loss: 0.140 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5314764976501465
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.338442802429199
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.981 Test Loss: 0.215 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 36638996
model size : 154.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.04948878288269
Epoch: 1, Steps: 89 | Train Loss: 1.565 Vali Loss: 0.425 Vali Acc: 0.894 Test Loss: 0.425 Test Acc: 0.894
Validation loss decreased (inf --> -0.894146).  Saving model ...
Epoch: 2 cost time: 3.7251222133636475
Epoch: 2, Steps: 89 | Train Loss: 0.493 Vali Loss: 0.347 Vali Acc: 0.896 Test Loss: 0.347 Test Acc: 0.896
Validation loss decreased (-0.894146 --> -0.895540).  Saving model ...
Epoch: 3 cost time: 3.5220131874084473
Epoch: 3, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.895540 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 3.70155668258667
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.440 Vali Acc: 0.903 Test Loss: 0.440 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3033227920532227
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.904442071914673
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
Validation loss decreased (-0.943591 --> -0.963786).  Saving model ...
Epoch: 7 cost time: 2.894594430923462
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.288 Vali Acc: 0.947 Test Loss: 0.288 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.137459993362427
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.225 Vali Acc: 0.960 Test Loss: 0.225 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.353697299957275
Epoch: 9, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
Validation loss decreased (-0.963786 --> -0.967268).  Saving model ...
Epoch: 10 cost time: 3.977299928665161
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.306 Vali Acc: 0.976 Test Loss: 0.306 Test Acc: 0.976
Validation loss decreased (-0.967268 --> -0.975624).  Saving model ...
Epoch: 11 cost time: 4.2959394454956055
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.971 Test Loss: 0.277 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.96150541305542
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.350 Vali Acc: 0.955 Test Loss: 0.350 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.509666681289673
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.236 Vali Acc: 0.968 Test Loss: 0.236 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2734134197235107
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
Validation loss decreased (-0.975624 --> -0.976321).  Saving model ...
Epoch: 15 cost time: 2.865957498550415
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.430 Vali Acc: 0.944 Test Loss: 0.430 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.830383062362671
Epoch: 16, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9344825744628906
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.977 Test Loss: 0.224 Test Acc: 0.977
Validation loss decreased (-0.976321 --> -0.977017).  Saving model ...
Epoch: 18 cost time: 2.7237610816955566
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.378 Vali Acc: 0.935 Test Loss: 0.378 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9317846298217773
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.008328199386597
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.403 Vali Acc: 0.969 Test Loss: 0.403 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.8375091552734375
Epoch: 21, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.245 Vali Acc: 0.973 Test Loss: 0.245 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.0417139530181885
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.233 Vali Acc: 0.985 Test Loss: 0.233 Test Acc: 0.985
Validation loss decreased (-0.977017 --> -0.985374).  Saving model ...
Epoch: 23 cost time: 4.080810546875
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.369 Vali Acc: 0.974 Test Loss: 0.369 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.803610324859619
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.334 Vali Acc: 0.968 Test Loss: 0.334 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8969690799713135
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.020374298095703
Epoch: 26, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.503 Vali Acc: 0.953 Test Loss: 0.503 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.8402280807495117
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.226 Vali Acc: 0.978 Test Loss: 0.226 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.9027462005615234
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.576 Vali Acc: 0.948 Test Loss: 0.576 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.695826292037964
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.977 Test Loss: 0.264 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.808616876602173
Epoch: 30, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.570 Vali Acc: 0.950 Test Loss: 0.570 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.8290839195251465
Epoch: 31, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.383 Vali Acc: 0.974 Test Loss: 0.383 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.627678632736206
Epoch: 32, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.341 Vali Acc: 0.980 Test Loss: 0.341 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 37118996
model size : 156.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.864609718322754
Epoch: 1, Steps: 89 | Train Loss: 1.682 Vali Loss: 0.496 Vali Acc: 0.845 Test Loss: 0.496 Test Acc: 0.845
Validation loss decreased (inf --> -0.845399).  Saving model ...
Epoch: 2 cost time: 2.148315906524658
Epoch: 2, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.398 Vali Acc: 0.890 Test Loss: 0.398 Test Acc: 0.890
Validation loss decreased (-0.845399 --> -0.889968).  Saving model ...
Epoch: 3 cost time: 2.118878126144409
Epoch: 3, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
Validation loss decreased (-0.889968 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 2.0940940380096436
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
Validation loss decreased (-0.961001 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 2.1968696117401123
Epoch: 5, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0924158096313477
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1337454319000244
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.216794490814209
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.146 Vali Acc: 0.979 Test Loss: 0.146 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979107).  Saving model ...
Epoch: 9 cost time: 2.7151739597320557
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.965 Test Loss: 0.217 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6028027534484863
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5050768852233887
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
Validation loss decreased (-0.979107 --> -0.980500).  Saving model ...
Epoch: 12 cost time: 2.349318265914917
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
Validation loss decreased (-0.980500 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 2.277547836303711
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1503653526306152
Epoch: 14, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.254 Vali Acc: 0.974 Test Loss: 0.254 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2579355239868164
Epoch: 15, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.068525791168213
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.135530710220337
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.984 Test Loss: 0.118 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 18 cost time: 2.2537262439727783
Epoch: 18, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.985 Test Loss: 0.135 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 19 cost time: 2.8244283199310303
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.948 Test Loss: 0.530 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.79685378074646
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.201 Vali Acc: 0.974 Test Loss: 0.201 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2408344745635986
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.514 Vali Acc: 0.941 Test Loss: 0.514 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.957730770111084
Epoch: 22, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.190 Vali Acc: 0.979 Test Loss: 0.190 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6176698207855225
Epoch: 23, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.886 Vali Acc: 0.919 Test Loss: 0.886 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8823351860046387
Epoch: 24, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.166 Vali Acc: 0.981 Test Loss: 0.166 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.022698402404785
Epoch: 25, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.184 Vali Acc: 0.983 Test Loss: 0.184 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.701446771621704
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.986 Test Loss: 0.150 Test Acc: 0.986
Validation loss decreased (-0.984678 --> -0.986071).  Saving model ...
Epoch: 27 cost time: 2.3173677921295166
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.174 Vali Acc: 0.983 Test Loss: 0.174 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1737663745880127
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3146345615386963
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.213 Vali Acc: 0.967 Test Loss: 0.213 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.4731733798980713
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.978 Test Loss: 0.239 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.265618324279785
Epoch: 31, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.253 Vali Acc: 0.969 Test Loss: 0.253 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.2664248943328857
Epoch: 32, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.172 Vali Acc: 0.983 Test Loss: 0.172 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.0842103958129883
Epoch: 33, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.981 Test Loss: 0.212 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.082261800765991
Epoch: 34, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.984 Test Loss: 0.142 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.139322519302368
Epoch: 35, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.1441073417663574
Epoch: 36, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.978 Test Loss: 0.277 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 36814868
model size : 155.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.097801446914673
Epoch: 1, Steps: 89 | Train Loss: 1.937 Vali Loss: 0.477 Vali Acc: 0.866 Test Loss: 0.477 Test Acc: 0.866
Validation loss decreased (inf --> -0.866290).  Saving model ...
Epoch: 2 cost time: 2.4992456436157227
Epoch: 2, Steps: 89 | Train Loss: 0.367 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.866290 --> -0.929663).  Saving model ...
Epoch: 3 cost time: 2.1828129291534424
Epoch: 3, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.929663 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 2.3697104454040527
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (-0.949162 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 2.2538275718688965
Epoch: 5, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8607940673828125
Epoch: 6, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.963787 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.738532066345215
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7181942462921143
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7160308361053467
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.885468006134033
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1631357669830322
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.9491167068481445
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.32381272315979
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982589).  Saving model ...
Epoch: 14 cost time: 2.644996404647827
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.693307399749756
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
Validation loss decreased (-0.982589 --> -0.987464).  Saving model ...
Epoch: 16 cost time: 2.250145673751831
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.989 Test Loss: 0.090 Test Acc: 0.989
Validation loss decreased (-0.987464 --> -0.988857).  Saving model ...
Epoch: 17 cost time: 2.2723441123962402
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2260665893554688
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.985 Test Loss: 0.108 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0863466262817383
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.984 Test Loss: 0.101 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2733330726623535
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.985 Test Loss: 0.139 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1197493076324463
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.106604814529419
Epoch: 22, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4709854125976562
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.298 Vali Acc: 0.967 Test Loss: 0.298 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3171167373657227
Epoch: 24, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.741485834121704
Epoch: 25, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.976 Test Loss: 0.240 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9847242832183838
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.982 Test Loss: 0.194 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 36629012
model size : 154.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.039226055145264
Epoch: 1, Steps: 89 | Train Loss: 1.578 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
Validation loss decreased (inf --> -0.805703).  Saving model ...
Epoch: 2 cost time: 3.8323211669921875
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
Validation loss decreased (-0.805703 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 2.948815107345581
Epoch: 3, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.331 Vali Acc: 0.923 Test Loss: 0.331 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.975031614303589
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
Validation loss decreased (-0.930359 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 2.783195734024048
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.962394 --> -0.977018).  Saving model ...
Epoch: 6 cost time: 2.978013753890991
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6461825370788574
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 3.169691562652588
Epoch: 8, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.178 Vali Acc: 0.966 Test Loss: 0.178 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.947056293487549
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.865156412124634
Epoch: 10, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.249 Vali Acc: 0.963 Test Loss: 0.249 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9302175045013428
Epoch: 11, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.62437105178833
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.0805423259735107
Epoch: 13, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.169 Vali Acc: 0.979 Test Loss: 0.169 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979107).  Saving model ...
Epoch: 14 cost time: 2.8926479816436768
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.196 Vali Acc: 0.981 Test Loss: 0.196 Test Acc: 0.981
Validation loss decreased (-0.979107 --> -0.980499).  Saving model ...
Epoch: 15 cost time: 2.7224011421203613
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8812482357025146
Epoch: 16, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.199 Vali Acc: 0.983 Test Loss: 0.199 Test Acc: 0.983
Validation loss decreased (-0.980499 --> -0.982589).  Saving model ...
Epoch: 17 cost time: 3.642214775085449
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.98590087890625
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.202 Vali Acc: 0.977 Test Loss: 0.202 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.216020584106445
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.397269248962402
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.338 Vali Acc: 0.972 Test Loss: 0.338 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.158620357513428
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.292 Vali Acc: 0.974 Test Loss: 0.292 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.213208198547363
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.266 Vali Acc: 0.976 Test Loss: 0.266 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.522267580032349
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.492631196975708
Epoch: 24, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.263 Vali Acc: 0.983 Test Loss: 0.263 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983284).  Saving model ...
Epoch: 25 cost time: 4.179404973983765
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.312 Vali Acc: 0.981 Test Loss: 0.312 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.9647228717803955
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.8556530475616455
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.982 Test Loss: 0.277 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.868678569793701
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.978 Test Loss: 0.309 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.819788694381714
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.982 Test Loss: 0.207 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.972527503967285
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.978 Test Loss: 0.225 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.241816282272339
Epoch: 31, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.344 Vali Acc: 0.967 Test Loss: 0.344 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.134751319885254
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.978 Test Loss: 0.249 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.9799907207489014
Epoch: 33, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.275 Vali Acc: 0.981 Test Loss: 0.275 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.932835578918457
Epoch: 34, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.379 Vali Acc: 0.969 Test Loss: 0.379 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 37125908
model size : 156.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.161359071731567
Epoch: 1, Steps: 89 | Train Loss: 1.653 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (inf --> -0.874647).  Saving model ...
Epoch: 2 cost time: 2.421867847442627
Epoch: 2, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.297 Vali Acc: 0.923 Test Loss: 0.297 Test Acc: 0.923
Validation loss decreased (-0.874647 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 2.27278470993042
Epoch: 3, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.923395 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 2.2801408767700195
Epoch: 4, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.151834487915039
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.957519 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 3.1512649059295654
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9609439373016357
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.176 Vali Acc: 0.966 Test Loss: 0.176 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6342854499816895
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1227049827575684
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7422096729278564
Epoch: 10, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.227 Vali Acc: 0.962 Test Loss: 0.227 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.458777666091919
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.677360773086548
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 13 cost time: 3.1846957206726074
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.161 Vali Acc: 0.976 Test Loss: 0.161 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3394269943237305
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.970494270324707
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.244189739227295
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.259 Vali Acc: 0.978 Test Loss: 0.259 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.126103162765503
Epoch: 17, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2220938205718994
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.120314359664917
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.198 Vali Acc: 0.976 Test Loss: 0.198 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.352053165435791
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.981 Test Loss: 0.171 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981196).  Saving model ...
Epoch: 21 cost time: 3.0943095684051514
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.212 Vali Acc: 0.977 Test Loss: 0.212 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.267118453979492
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.985 Test Loss: 0.178 Test Acc: 0.985
Validation loss decreased (-0.981196 --> -0.985374).  Saving model ...
Epoch: 23 cost time: 2.783006191253662
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.984 Test Loss: 0.135 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9222962856292725
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.380296230316162
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.985 Test Loss: 0.169 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3029258251190186
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.983 Test Loss: 0.205 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.2918941974639893
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.981 Test Loss: 0.186 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1781017780303955
Epoch: 28, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.243 Vali Acc: 0.981 Test Loss: 0.243 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.5549890995025635
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.367 Vali Acc: 0.955 Test Loss: 0.367 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.0930233001708984
Epoch: 30, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.160 Vali Acc: 0.981 Test Loss: 0.160 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.364220142364502
Epoch: 31, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.375 Vali Acc: 0.977 Test Loss: 0.375 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.3452951908111572
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.974 Test Loss: 0.288 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 36821780
model size : 155.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.830340623855591
Epoch: 1, Steps: 89 | Train Loss: 1.925 Vali Loss: 0.541 Vali Acc: 0.829 Test Loss: 0.541 Test Acc: 0.829
Validation loss decreased (inf --> -0.828685).  Saving model ...
Epoch: 2 cost time: 2.7624709606170654
Epoch: 2, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.828685 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 2.2059757709503174
Epoch: 3, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.948466 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 2.4180049896240234
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 2.1770577430725098
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 2.4256319999694824
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2045376300811768
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 2.174137830734253
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.979108 --> -0.986768).  Saving model ...
Epoch: 9 cost time: 2.2720019817352295
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9908463954925537
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.70314359664917
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5920441150665283
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.561579704284668
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.820049285888672
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1935031414031982
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.984 Test Loss: 0.116 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.792283535003662
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3356387615203857
Epoch: 17, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.177 Vali Acc: 0.976 Test Loss: 0.177 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.746415138244629
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 36619028
model size : 154.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.171177864074707
Epoch: 1, Steps: 89 | Train Loss: 1.534 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
Validation loss decreased (inf --> -0.859327).  Saving model ...
Epoch: 2 cost time: 2.7865097522735596
Epoch: 2, Steps: 89 | Train Loss: 0.386 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
Validation loss decreased (-0.859327 --> -0.902504).  Saving model ...
Epoch: 3 cost time: 2.9552621841430664
Epoch: 3, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.266 Vali Acc: 0.932 Test Loss: 0.266 Test Acc: 0.932
Validation loss decreased (-0.902504 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 4.040241718292236
Epoch: 4, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.311 Vali Acc: 0.924 Test Loss: 0.311 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.03285551071167
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
Validation loss decreased (-0.932449 --> -0.938020).  Saving model ...
Epoch: 6 cost time: 3.560046434402466
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.243 Vali Acc: 0.954 Test Loss: 0.243 Test Acc: 0.954
Validation loss decreased (-0.938020 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 4.020191669464111
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.954037 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 2.9393470287323
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.850534439086914
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8424088954925537
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 2.841116189956665
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.914536714553833
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.962 Test Loss: 0.229 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.018744707107544
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.381 Vali Acc: 0.928 Test Loss: 0.381 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.200677156448364
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 4.036084413528442
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.248 Vali Acc: 0.963 Test Loss: 0.248 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.507085084915161
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 3.9487876892089844
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980500).  Saving model ...
Epoch: 18 cost time: 4.038616418838501
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.978 Test Loss: 0.167 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.302168130874634
Epoch: 19, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.207 Vali Acc: 0.973 Test Loss: 0.207 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.166481971740723
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.228 Vali Acc: 0.978 Test Loss: 0.228 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.580256462097168
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.258 Vali Acc: 0.972 Test Loss: 0.258 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.489805221557617
Epoch: 22, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.1017980575561523
Epoch: 23, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.372 Vali Acc: 0.948 Test Loss: 0.372 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.905918598175049
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.316 Vali Acc: 0.962 Test Loss: 0.316 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.817072629928589
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.312 Vali Acc: 0.966 Test Loss: 0.312 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.875131368637085
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.704829216003418
Epoch: 27, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.269 Vali Acc: 0.961 Test Loss: 0.269 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 37122836
model size : 156.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.147395610809326
Epoch: 1, Steps: 89 | Train Loss: 1.759 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (inf --> -0.838435).  Saving model ...
Epoch: 2 cost time: 2.4184608459472656
Epoch: 2, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.260 Vali Acc: 0.934 Test Loss: 0.260 Test Acc: 0.934
Validation loss decreased (-0.838435 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 2.4045724868774414
Epoch: 3, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.933841 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 2.8705356121063232
Epoch: 4, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
Validation loss decreased (-0.947770 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 2.995826005935669
Epoch: 5, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
Validation loss decreased (-0.959608 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 3.1958885192871094
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.328 Vali Acc: 0.932 Test Loss: 0.328 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.616950511932373
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 2.2371597290039062
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3493218421936035
Epoch: 9, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.395 Vali Acc: 0.929 Test Loss: 0.395 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0546927452087402
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.273 Vali Acc: 0.953 Test Loss: 0.273 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.301514148712158
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.970751 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 2.3341915607452393
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.221 Vali Acc: 0.965 Test Loss: 0.221 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.653696060180664
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0333797931671143
Epoch: 14, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.000887632369995
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6960320472717285
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.292 Vali Acc: 0.953 Test Loss: 0.292 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.118917465209961
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0250542163848877
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.898747444152832
Epoch: 19, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 20 cost time: 3.16898250579834
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.232 Vali Acc: 0.960 Test Loss: 0.232 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.267949342727661
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0762550830841064
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9203219413757324
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.974 Test Loss: 0.162 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.6176531314849854
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1695139408111572
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.981893 --> -0.987464).  Saving model ...
Epoch: 26 cost time: 2.621731758117676
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.976 Test Loss: 0.199 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9295384883880615
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.984 Test Loss: 0.120 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9435179233551025
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1154932975769043
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.984 Test Loss: 0.109 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2854506969451904
Epoch: 30, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.987 Test Loss: 0.113 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.084648847579956
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.020190477371216
Epoch: 32, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.163268804550171
Epoch: 33, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.976 Test Loss: 0.225 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.1277379989624023
Epoch: 34, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.310 Vali Acc: 0.953 Test Loss: 0.310 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.5020089149475098
Epoch: 35, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.169 Vali Acc: 0.979 Test Loss: 0.169 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 36768020
model size : 154.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.763446569442749
Epoch: 1, Steps: 89 | Train Loss: 2.064 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
Validation loss decreased (inf --> -0.847488).  Saving model ...
Epoch: 2 cost time: 2.874664306640625
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.847488 --> -0.917128).  Saving model ...
Epoch: 3 cost time: 2.9729135036468506
Epoch: 3, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.233 Vali Acc: 0.939 Test Loss: 0.233 Test Acc: 0.939
Validation loss decreased (-0.917128 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 2.6963343620300293
Epoch: 4, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.938716 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 2.2711310386657715
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 2.192983627319336
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.968662 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 2.238973379135132
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4893908500671387
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9603445529937744
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.089 Vali Acc: 0.986 Test Loss: 0.089 Test Acc: 0.986
Validation loss decreased (-0.978411 --> -0.986072).  Saving model ...
Epoch: 10 cost time: 2.777414083480835
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.944770574569702
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2009129524230957
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1427459716796875
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.987464).  Saving model ...
Epoch: 14 cost time: 2.0971059799194336
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.103621482849121
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2791662216186523
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1929636001586914
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.085 Vali Acc: 0.986 Test Loss: 0.085 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.646188259124756
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8261499404907227
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1863057613372803
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1390023231506348
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.204 Vali Acc: 0.969 Test Loss: 0.204 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.846644401550293
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.274500846862793
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 36599060
model size : 154.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.851870775222778
Epoch: 1, Steps: 89 | Train Loss: 1.655 Vali Loss: 0.488 Vali Acc: 0.876 Test Loss: 0.488 Test Acc: 0.876
Validation loss decreased (inf --> -0.876040).  Saving model ...
Epoch: 2 cost time: 2.680377244949341
Epoch: 2, Steps: 89 | Train Loss: 0.367 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
Validation loss decreased (-0.876040 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 2.6566522121429443
Epoch: 3, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.204 Vali Acc: 0.955 Test Loss: 0.204 Test Acc: 0.955
Validation loss decreased (-0.942198 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 2.4758591651916504
Epoch: 4, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5526416301727295
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
Validation loss decreased (-0.954733 --> -0.963786).  Saving model ...
Epoch: 6 cost time: 2.5274219512939453
Epoch: 6, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.356 Vali Acc: 0.920 Test Loss: 0.356 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.688136577606201
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
Validation loss decreased (-0.963786 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 2.6425492763519287
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.490 Vali Acc: 0.929 Test Loss: 0.490 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.589789390563965
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.256 Vali Acc: 0.969 Test Loss: 0.256 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968660).  Saving model ...
Epoch: 10 cost time: 2.6490421295166016
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.300 Vali Acc: 0.961 Test Loss: 0.300 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.741162061691284
Epoch: 11, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.326 Vali Acc: 0.958 Test Loss: 0.326 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5596137046813965
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.200 Vali Acc: 0.976 Test Loss: 0.200 Test Acc: 0.976
Validation loss decreased (-0.968660 --> -0.976321).  Saving model ...
Epoch: 13 cost time: 2.6502554416656494
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.261 Vali Acc: 0.974 Test Loss: 0.261 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.201840877532959
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.359 Vali Acc: 0.960 Test Loss: 0.359 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4358863830566406
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.268 Vali Acc: 0.966 Test Loss: 0.268 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.834174156188965
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.352 Vali Acc: 0.971 Test Loss: 0.352 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8208794593811035
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.372 Vali Acc: 0.958 Test Loss: 0.372 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7790849208831787
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.337 Vali Acc: 0.976 Test Loss: 0.337 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6358766555786133
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5407254695892334
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.969 Test Loss: 0.249 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.585228681564331
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.272 Vali Acc: 0.968 Test Loss: 0.272 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.598879337310791
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.375 Vali Acc: 0.967 Test Loss: 0.375 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 36994580
model size : 155.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8225929737091064
Epoch: 1, Steps: 89 | Train Loss: 1.835 Vali Loss: 0.445 Vali Acc: 0.864 Test Loss: 0.445 Test Acc: 0.864
Validation loss decreased (inf --> -0.863505).  Saving model ...
Epoch: 2 cost time: 3.3675551414489746
Epoch: 2, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.863505 --> -0.910860).  Saving model ...
Epoch: 3 cost time: 3.433203935623169
Epoch: 3, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.910860 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 3.56964111328125
Epoch: 4, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 3.3883588314056396
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.179 Vali Acc: 0.960 Test Loss: 0.179 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.073976755142212
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.290050506591797
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 3.3424205780029297
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 2.360178232192993
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.182762384414673
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.188873052597046
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
Validation loss decreased (-0.978411 --> -0.983982).  Saving model ...
Epoch: 12 cost time: 2.2638025283813477
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.228811502456665
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5794129371643066
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.089 Vali Acc: 0.987 Test Loss: 0.089 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.987464).  Saving model ...
Epoch: 15 cost time: 3.2381808757781982
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8423514366149902
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9658637046813965
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.027956962585449
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.986 Test Loss: 0.096 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.828253984451294
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.350 Vali Acc: 0.956 Test Loss: 0.350 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.397463321685791
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.619154691696167
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1176295280456543
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8324503898620605
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.024106740951538
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.173 Vali Acc: 0.976 Test Loss: 0.173 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 36741140
model size : 154.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2392802238464355
Epoch: 1, Steps: 89 | Train Loss: 2.124 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
Validation loss decreased (inf --> -0.827989).  Saving model ...
Epoch: 2 cost time: 2.046224355697632
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.262 Vali Acc: 0.921 Test Loss: 0.262 Test Acc: 0.921
Validation loss decreased (-0.827989 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 2.4222328662872314
Epoch: 3, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.920610 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 2.342104911804199
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.958912 --> -0.977715).  Saving model ...
Epoch: 5 cost time: 2.6066460609436035
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.977715 --> -0.984679).  Saving model ...
Epoch: 6 cost time: 2.8455240726470947
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 7 cost time: 2.137709617614746
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8712410926818848
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6542463302612305
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8465702533721924
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.055 Vali Acc: 0.989 Test Loss: 0.055 Test Acc: 0.989
Validation loss decreased (-0.984679 --> -0.988857).  Saving model ...
Epoch: 11 cost time: 2.7901268005371094
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0377731323242188
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9717001914978027
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.583397388458252
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8611319065093994
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.433457136154175
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.009770631790161
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.485050916671753
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1914987564086914
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.388319492340088
Epoch: 20, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.160 Vali Acc: 0.979 Test Loss: 0.160 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 36589076
model size : 154.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.300607442855835
Epoch: 1, Steps: 89 | Train Loss: 1.592 Vali Loss: 0.635 Vali Acc: 0.849 Test Loss: 0.635 Test Acc: 0.849
Validation loss decreased (inf --> -0.848879).  Saving model ...
Epoch: 2 cost time: 3.8070616722106934
Epoch: 2, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.643 Vali Acc: 0.864 Test Loss: 0.643 Test Acc: 0.864
Validation loss decreased (-0.848879 --> -0.863503).  Saving model ...
Epoch: 3 cost time: 2.477466583251953
Epoch: 3, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.863503 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 2.482470750808716
Epoch: 4, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.344 Vali Acc: 0.929 Test Loss: 0.344 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.201655864715576
Epoch: 5, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.419 Vali Acc: 0.946 Test Loss: 0.419 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.939760446548462
Epoch: 6, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.351 Vali Acc: 0.945 Test Loss: 0.351 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.476386308670044
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.390 Vali Acc: 0.948 Test Loss: 0.390 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.0793492794036865
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.951 Test Loss: 0.282 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.13187837600708
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.374 Vali Acc: 0.946 Test Loss: 0.374 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.665525197982788
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.956126 --> -0.979803).  Saving model ...
Epoch: 11 cost time: 4.058484792709351
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.978 Test Loss: 0.173 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.885786771774292
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.196571111679077
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.212 Vali Acc: 0.976 Test Loss: 0.212 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.028428077697754
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.283 Vali Acc: 0.962 Test Loss: 0.283 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.547668218612671
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.249 Vali Acc: 0.970 Test Loss: 0.249 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.590883255004883
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.449782371520996
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.346 Vali Acc: 0.963 Test Loss: 0.346 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.4165725708007812
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.978 Test Loss: 0.191 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.441631555557251
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.984 Test Loss: 0.173 Test Acc: 0.984
Validation loss decreased (-0.979803 --> -0.983982).  Saving model ...
Epoch: 20 cost time: 2.3697898387908936
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.393 Vali Acc: 0.960 Test Loss: 0.393 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7782959938049316
Epoch: 21, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.830439567565918
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.263 Vali Acc: 0.976 Test Loss: 0.263 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.066490173339844
Epoch: 23, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.238 Vali Acc: 0.974 Test Loss: 0.238 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.996635675430298
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.250 Vali Acc: 0.976 Test Loss: 0.250 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.06758975982666
Epoch: 25, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.177 Vali Acc: 0.979 Test Loss: 0.177 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.029184818267822
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.978 Test Loss: 0.201 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.841397523880005
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.287 Vali Acc: 0.972 Test Loss: 0.287 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.7007057666778564
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.540064811706543
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.430 Vali Acc: 0.963 Test Loss: 0.430 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 36991508
model size : 155.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.8152241706848145
Epoch: 1, Steps: 89 | Train Loss: 1.890 Vali Loss: 0.582 Vali Acc: 0.835 Test Loss: 0.582 Test Acc: 0.835
Validation loss decreased (inf --> -0.834952).  Saving model ...
Epoch: 2 cost time: 3.3357489109039307
Epoch: 2, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
Validation loss decreased (-0.834952 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 3.307656764984131
Epoch: 3, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.930359 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 2.279045581817627
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.951252 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 3.3552541732788086
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.981898069381714
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.144355058670044
Epoch: 7, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 2.2303714752197266
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.347393274307251
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1377577781677246
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.975625).  Saving model ...
Epoch: 11 cost time: 2.308406114578247
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 2.2682366371154785
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979107).  Saving model ...
Epoch: 13 cost time: 2.026688814163208
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.139 Vali Acc: 0.981 Test Loss: 0.139 Test Acc: 0.981
Validation loss decreased (-0.979107 --> -0.981196).  Saving model ...
Epoch: 14 cost time: 2.135286331176758
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4133245944976807
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8074393272399902
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.228576183319092
Epoch: 17, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6227355003356934
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.982 Test Loss: 0.111 Test Acc: 0.982
Validation loss decreased (-0.981196 --> -0.981893).  Saving model ...
Epoch: 19 cost time: 3.5730295181274414
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3964552879333496
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.643 Vali Acc: 0.929 Test Loss: 0.643 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3824009895324707
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.784949779510498
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.154 Vali Acc: 0.984 Test Loss: 0.154 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 23 cost time: 2.2747249603271484
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.985 Test Loss: 0.161 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 24 cost time: 2.5812106132507324
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5995945930480957
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.167 Vali Acc: 0.987 Test Loss: 0.167 Test Acc: 0.987
Validation loss decreased (-0.984678 --> -0.987464).  Saving model ...
Epoch: 26 cost time: 3.7324399948120117
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.986 Test Loss: 0.139 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.455683946609497
Epoch: 27, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.188 Vali Acc: 0.978 Test Loss: 0.188 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.718127965927124
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.202 Vali Acc: 0.982 Test Loss: 0.202 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.814148426055908
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.987 Test Loss: 0.140 Test Acc: 0.987
Validation loss decreased (-0.987464 --> -0.987464).  Saving model ...
Epoch: 30 cost time: 2.2933127880096436
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.166 Vali Acc: 0.983 Test Loss: 0.166 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.146989345550537
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.984 Test Loss: 0.134 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1728944778442383
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.980 Test Loss: 0.188 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9579756259918213
Epoch: 33, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.983 Test Loss: 0.172 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2634201049804688
Epoch: 34, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.987 Test Loss: 0.145 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.071990489959717
Epoch: 35, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.437185525894165
Epoch: 36, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.987 Test Loss: 0.172 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.530517101287842
Epoch: 37, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.590 Vali Acc: 0.944 Test Loss: 0.590 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.265084743499756
Epoch: 38, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.143 Vali Acc: 0.990 Test Loss: 0.143 Test Acc: 0.990
Validation loss decreased (-0.987464 --> -0.990249).  Saving model ...
Epoch: 39 cost time: 2.3329596519470215
Epoch: 39, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.987 Test Loss: 0.148 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.4060332775115967
Epoch: 40, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.987 Test Loss: 0.183 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.2131621837615967
Epoch: 41, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.573427200317383
Epoch: 42, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.984 Test Loss: 0.158 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.096266984939575
Epoch: 43, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.145 Vali Acc: 0.985 Test Loss: 0.145 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.340035915374756
Epoch: 44, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.983 Test Loss: 0.170 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.5990564823150635
Epoch: 45, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.264 Vali Acc: 0.982 Test Loss: 0.264 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.3813679218292236
Epoch: 46, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.200 Vali Acc: 0.979 Test Loss: 0.200 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.31874680519104
Epoch: 47, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.182 Vali Acc: 0.984 Test Loss: 0.182 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.4338066577911377
Epoch: 48, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.983 Test Loss: 0.214 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 36721172
model size : 154.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.225088596343994
Epoch: 1, Steps: 89 | Train Loss: 2.103 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
Validation loss decreased (inf --> -0.818935).  Saving model ...
Epoch: 2 cost time: 2.34078049659729
Epoch: 2, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
Validation loss decreased (-0.818935 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 2.711742401123047
Epoch: 3, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
Validation loss decreased (-0.953341 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 2.0816547870635986
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.317622661590576
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.964483 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 2.297844648361206
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980500).  Saving model ...
Epoch: 7 cost time: 2.8502862453460693
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.431881904602051
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0680007934570312
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 2.4544055461883545
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
Validation loss decreased (-0.983286 --> -0.986072).  Saving model ...
Epoch: 11 cost time: 1.9198050498962402
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3176863193511963
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9763307571411133
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 14 cost time: 2.716465950012207
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3188843727111816
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2535507678985596
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8063981533050537
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5795042514801025
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0241641998291016
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1383626461029053
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1185967922210693
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2453324794769287
Epoch: 22, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.101163625717163
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 36586004
model size : 154.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.367708206176758
Epoch: 1, Steps: 89 | Train Loss: 1.611 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (inf --> -0.900414).  Saving model ...
Epoch: 2 cost time: 3.6538355350494385
Epoch: 2, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.387 Vali Acc: 0.890 Test Loss: 0.387 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.402181625366211
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.900414 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 2.70223331451416
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.433 Vali Acc: 0.918 Test Loss: 0.433 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.326485633850098
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.246 Vali Acc: 0.951 Test Loss: 0.246 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7529401779174805
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
Validation loss decreased (-0.963090 --> -0.965179).  Saving model ...
Epoch: 7 cost time: 3.551389217376709
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.264 Vali Acc: 0.962 Test Loss: 0.264 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4247844219207764
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
Validation loss decreased (-0.965179 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 2.3058536052703857
Epoch: 9, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.299067497253418
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.187 Vali Acc: 0.976 Test Loss: 0.187 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.195502519607544
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 12 cost time: 2.373356580734253
Epoch: 12, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.627760887145996
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.0122785568237305
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.29483962059021
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979803).  Saving model ...
Epoch: 16 cost time: 2.1547322273254395
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.734867572784424
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.982 Test Loss: 0.162 Test Acc: 0.982
Validation loss decreased (-0.979803 --> -0.981893).  Saving model ...
Epoch: 18 cost time: 2.8717713356018066
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.286 Vali Acc: 0.956 Test Loss: 0.286 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.110824346542358
Epoch: 19, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.268 Vali Acc: 0.971 Test Loss: 0.268 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8672842979431152
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.243 Vali Acc: 0.974 Test Loss: 0.243 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.177279233932495
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.254 Vali Acc: 0.979 Test Loss: 0.254 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.055940389633179
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.148 Vali Acc: 0.984 Test Loss: 0.148 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 23 cost time: 4.074143648147583
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.424333095550537
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.333 Vali Acc: 0.969 Test Loss: 0.333 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2921459674835205
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.323 Vali Acc: 0.969 Test Loss: 0.323 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3104960918426514
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.182 Vali Acc: 0.985 Test Loss: 0.182 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 27 cost time: 2.3431169986724854
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.986 Test Loss: 0.185 Test Acc: 0.986
Validation loss decreased (-0.984678 --> -0.986071).  Saving model ...
Epoch: 28 cost time: 3.954800605773926
Epoch: 28, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.985 Test Loss: 0.212 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2231059074401855
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.233 Vali Acc: 0.982 Test Loss: 0.233 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3270771503448486
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.980 Test Loss: 0.195 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.020282745361328
Epoch: 31, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.280 Vali Acc: 0.974 Test Loss: 0.280 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.5923240184783936
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.983 Test Loss: 0.138 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.3224477767944336
Epoch: 33, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.215274095535278
Epoch: 34, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.48824143409729
Epoch: 35, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.766 Vali Acc: 0.923 Test Loss: 0.766 Test Acc: 0.923
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.3450584411621094
Epoch: 36, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.197 Vali Acc: 0.979 Test Loss: 0.197 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.169756889343262
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 36903956
model size : 155.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1964797973632812
Epoch: 1, Steps: 89 | Train Loss: 1.854 Vali Loss: 0.752 Vali Acc: 0.797 Test Loss: 0.752 Test Acc: 0.797
Validation loss decreased (inf --> -0.797346).  Saving model ...
Epoch: 2 cost time: 2.3799901008605957
Epoch: 2, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.237 Vali Acc: 0.945 Test Loss: 0.237 Test Acc: 0.945
Validation loss decreased (-0.797346 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 2.1449458599090576
Epoch: 3, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.250 Vali Acc: 0.943 Test Loss: 0.250 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.678008556365967
Epoch: 4, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.944984 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.0370993614196777
Epoch: 5, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.977715).  Saving model ...
Epoch: 6 cost time: 2.117176055908203
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1988141536712646
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0191726684570312
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6173131465911865
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 10 cost time: 2.869513750076294
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.717857599258423
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.085 Vali Acc: 0.986 Test Loss: 0.085 Test Acc: 0.986
Validation loss decreased (-0.981197 --> -0.986072).  Saving model ...
Epoch: 12 cost time: 2.4291515350341797
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4835782051086426
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3954946994781494
Epoch: 14, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6007583141326904
Epoch: 15, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.340 Vali Acc: 0.948 Test Loss: 0.340 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7944090366363525
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0884993076324463
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.030223846435547
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.178 Vali Acc: 0.983 Test Loss: 0.178 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.761941432952881
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.196 Vali Acc: 0.977 Test Loss: 0.196 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.4211416244506836
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.989 Test Loss: 0.103 Test Acc: 0.989
Validation loss decreased (-0.986072 --> -0.988857).  Saving model ...
Epoch: 21 cost time: 2.212320566177368
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.990 Test Loss: 0.082 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989553).  Saving model ...
Epoch: 22 cost time: 2.1766562461853027
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.160 Vali Acc: 0.985 Test Loss: 0.160 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4002907276153564
Epoch: 23, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.309208869934082
Epoch: 24, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.986 Test Loss: 0.102 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4320640563964844
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.244 Vali Acc: 0.974 Test Loss: 0.244 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6024954319000244
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.465 Vali Acc: 0.961 Test Loss: 0.465 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.080038547515869
Epoch: 27, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.153 Vali Acc: 0.983 Test Loss: 0.153 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.7111363410949707
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.6403708457946777
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.988 Test Loss: 0.124 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.3091135025024414
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.985 Test Loss: 0.206 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.524867057800293
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.982 Test Loss: 0.187 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 36701204
model size : 154.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.271498918533325
Epoch: 1, Steps: 89 | Train Loss: 2.208 Vali Loss: 0.663 Vali Acc: 0.806 Test Loss: 0.663 Test Acc: 0.806
Validation loss decreased (inf --> -0.806400).  Saving model ...
Epoch: 2 cost time: 2.775428533554077
Epoch: 2, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
Validation loss decreased (-0.806400 --> -0.925485).  Saving model ...
Epoch: 3 cost time: 2.2282087802886963
Epoch: 3, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
Validation loss decreased (-0.925485 --> -0.971447).  Saving model ...
Epoch: 4 cost time: 2.4189751148223877
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4484641551971436
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.971447 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 2.4508841037750244
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2403151988983154
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4245519638061523
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.679868221282959
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.076 Vali Acc: 0.986 Test Loss: 0.076 Test Acc: 0.986
Validation loss decreased (-0.979804 --> -0.986072).  Saving model ...
Epoch: 10 cost time: 2.48043155670166
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2111124992370605
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.059213638305664
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.016141653060913
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.149202823638916
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2536227703094482
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0885190963745117
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.986072 --> -0.986072).  Saving model ...
Epoch: 17 cost time: 2.295989513397217
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.173666000366211
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.604329824447632
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6824357509613037
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.987 Test Loss: 0.114 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 2.2138333320617676
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5844883918762207
Epoch: 22, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0830788612365723
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.079 Vali Acc: 0.986 Test Loss: 0.079 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.579024076461792
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.199016809463501
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1985816955566406
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.539095401763916
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.064 Vali Acc: 0.990 Test Loss: 0.064 Test Acc: 0.990
Validation loss decreased (-0.986768 --> -0.990250).  Saving model ...
Epoch: 28 cost time: 2.2968339920043945
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.511538028717041
Epoch: 29, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3356709480285645
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.986 Test Loss: 0.110 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.3052423000335693
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.983 Test Loss: 0.145 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.8615670204162598
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.1711113452911377
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.990 Test Loss: 0.077 Test Acc: 0.990
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.774613380432129
Epoch: 34, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.257 Vali Acc: 0.965 Test Loss: 0.257 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.3192365169525146
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.244 Vali Acc: 0.966 Test Loss: 0.244 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.5446135997772217
Epoch: 36, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.3158087730407715
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 36582932
model size : 154.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.979934215545654
Epoch: 1, Steps: 89 | Train Loss: 1.728 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
Validation loss decreased (inf --> -0.839131).  Saving model ...
Epoch: 2 cost time: 4.1594014167785645
Epoch: 2, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (-0.839131 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 4.068368196487427
Epoch: 3, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.954037 --> -0.976322).  Saving model ...
Epoch: 4 cost time: 4.2986226081848145
Epoch: 4, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.367584705352783
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.323112726211548
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.340 Vali Acc: 0.945 Test Loss: 0.340 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.227485179901123
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 2.444959878921509
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.334 Vali Acc: 0.942 Test Loss: 0.334 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2580816745758057
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 2.5942437648773193
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.207 Vali Acc: 0.969 Test Loss: 0.207 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4445114135742188
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.195396661758423
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.264887809753418
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4383633136749268
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.972 Test Loss: 0.260 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6623709201812744
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6252779960632324
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.243 Vali Acc: 0.972 Test Loss: 0.243 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.747786521911621
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.169 Vali Acc: 0.982 Test Loss: 0.169 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4951109886169434
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.983 Test Loss: 0.170 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.6009483337402344
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 36917780
model size : 155.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.451982021331787
Epoch: 1, Steps: 89 | Train Loss: 1.901 Vali Loss: 0.628 Vali Acc: 0.808 Test Loss: 0.628 Test Acc: 0.808
Validation loss decreased (inf --> -0.808490).  Saving model ...
Epoch: 2 cost time: 2.283808469772339
Epoch: 2, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.196 Vali Acc: 0.934 Test Loss: 0.196 Test Acc: 0.934
Validation loss decreased (-0.808490 --> -0.933842).  Saving model ...
Epoch: 3 cost time: 2.690725803375244
Epoch: 3, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.933842 --> -0.966572).  Saving model ...
Epoch: 4 cost time: 2.2645950317382812
Epoch: 4, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 2.5821990966796875
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 2.7148680686950684
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 2.4137275218963623
Epoch: 7, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.964 Test Loss: 0.237 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.636165142059326
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 2.734668731689453
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 2.401045799255371
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 2.4880549907684326
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5483405590057373
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.984 Test Loss: 0.107 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 13 cost time: 2.6207969188690186
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2698192596435547
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4434642791748047
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.483793020248413
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 2.2248528003692627
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.978689432144165
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0047245025634766
Epoch: 19, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 20 cost time: 2.276127815246582
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.145212411880493
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2728450298309326
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 23 cost time: 2.6410348415374756
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.990 Test Loss: 0.099 Test Acc: 0.990
Validation loss decreased (-0.987464 --> -0.989553).  Saving model ...
Epoch: 24 cost time: 2.3909316062927246
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0768380165100098
Epoch: 25, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5027785301208496
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.988 Test Loss: 0.128 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4398305416107178
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.985 Test Loss: 0.138 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4336037635803223
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.989 Test Loss: 0.120 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.562654495239258
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.321 Vali Acc: 0.968 Test Loss: 0.321 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.416940450668335
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.987 Test Loss: 0.150 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.292067527770996
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.986 Test Loss: 0.131 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8863980770111084
Epoch: 32, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.983 Test Loss: 0.139 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.2707059383392334
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.985 Test Loss: 0.132 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 36698132
model size : 154.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1204235553741455
Epoch: 1, Steps: 89 | Train Loss: 2.145 Vali Loss: 0.653 Vali Acc: 0.812 Test Loss: 0.653 Test Acc: 0.812
Validation loss decreased (inf --> -0.811971).  Saving model ...
Epoch: 2 cost time: 1.880319356918335
Epoch: 2, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.234 Vali Acc: 0.929 Test Loss: 0.234 Test Acc: 0.929
Validation loss decreased (-0.811971 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 2.585620641708374
Epoch: 3, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.928967 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.1895430088043213
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
Validation loss decreased (-0.961698 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 2.182671308517456
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 2.4044549465179443
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.6098854541778564
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.985375).  Saving model ...
Epoch: 8 cost time: 2.171152353286743
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0804073810577393
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.042229413986206
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 11 cost time: 2.2821054458618164
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1813318729400635
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1855790615081787
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.263603925704956
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.918252944946289
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3180935382843018
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.131098747253418
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3532371520996094
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.095503568649292
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.430424451828003
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.981 Test Loss: 0.190 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 36579860
model size : 154.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2463200092315674
Epoch: 1, Steps: 89 | Train Loss: 1.617 Vali Loss: 0.362 Vali Acc: 0.892 Test Loss: 0.362 Test Acc: 0.892
Validation loss decreased (inf --> -0.892058).  Saving model ...
Epoch: 2 cost time: 2.722517490386963
Epoch: 2, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
Validation loss decreased (-0.892058 --> -0.968662).  Saving model ...
Epoch: 3 cost time: 2.6575887203216553
Epoch: 3, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6181399822235107
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.249 Vali Acc: 0.947 Test Loss: 0.249 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.214935541152954
Epoch: 5, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.968662 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 2.7475624084472656
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.258079767227173
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3645124435424805
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.387441873550415
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2875311374664307
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.332820415496826
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 2.6016945838928223
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.228 Vali Acc: 0.969 Test Loss: 0.228 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.180540084838867
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.112 Vali Acc: 0.984 Test Loss: 0.112 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 14 cost time: 2.5382304191589355
Epoch: 14, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.268 Vali Acc: 0.953 Test Loss: 0.268 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.474442720413208
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.241 Vali Acc: 0.963 Test Loss: 0.241 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3366990089416504
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.258 Vali Acc: 0.964 Test Loss: 0.258 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3304202556610107
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.173 Vali Acc: 0.983 Test Loss: 0.173 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.004849433898926
Epoch: 18, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.136 Vali Acc: 0.984 Test Loss: 0.136 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.234313488006592
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.987 Test Loss: 0.149 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.986767).  Saving model ...
Epoch: 20 cost time: 2.7789998054504395
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.983 Test Loss: 0.175 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.399235486984253
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.158 Vali Acc: 0.983 Test Loss: 0.158 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2740161418914795
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.984 Test Loss: 0.176 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3295865058898926
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.125 Vali Acc: 0.987 Test Loss: 0.125 Test Acc: 0.987
Validation loss decreased (-0.986767 --> -0.987464).  Saving model ...
Epoch: 24 cost time: 2.1842257976531982
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2407987117767334
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8688530921936035
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.144 Vali Acc: 0.984 Test Loss: 0.144 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.84419322013855
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.092 Vali Acc: 0.988 Test Loss: 0.092 Test Acc: 0.988
Validation loss decreased (-0.987464 --> -0.988161).  Saving model ...
Epoch: 28 cost time: 2.663759708404541
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.988 Test Loss: 0.095 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7985994815826416
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.985 Test Loss: 0.101 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8747024536132812
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.987 Test Loss: 0.139 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.226621627807617
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.985 Test Loss: 0.118 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.340015172958374
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.982 Test Loss: 0.139 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.25744366645813
Epoch: 33, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.165736436843872
Epoch: 34, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.2866461277008057
Epoch: 35, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.989 Test Loss: 0.151 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988856).  Saving model ...
Epoch: 36 cost time: 1.9603855609893799
Epoch: 36, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.176 Vali Acc: 0.986 Test Loss: 0.176 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.8042969703674316
Epoch: 37, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.985 Test Loss: 0.173 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.8370447158813477
Epoch: 38, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.503 Vali Acc: 0.954 Test Loss: 0.503 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.734710454940796
Epoch: 39, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.303 Vali Acc: 0.965 Test Loss: 0.303 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.589576482772827
Epoch: 40, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.978 Test Loss: 0.183 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.6392924785614014
Epoch: 41, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.982 Test Loss: 0.204 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9917469024658203
Epoch: 42, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.982 Test Loss: 0.141 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.1832962036132812
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.988 Test Loss: 0.105 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.1962459087371826
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.991 Test Loss: 0.103 Test Acc: 0.991
Validation loss decreased (-0.988856 --> -0.990946).  Saving model ...
Epoch: 45 cost time: 2.252079963684082
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.991 Test Loss: 0.102 Test Acc: 0.991
Validation loss decreased (-0.990946 --> -0.990946).  Saving model ...
Epoch: 46 cost time: 2.2403132915496826
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.991 Test Loss: 0.102 Test Acc: 0.991
Validation loss decreased (-0.990946 --> -0.990946).  Saving model ...
Epoch: 47 cost time: 2.837380886077881
Epoch: 47, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.988 Test Loss: 0.119 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.680142641067505
Epoch: 48, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.126 Vali Acc: 0.989 Test Loss: 0.126 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.4069886207580566
Epoch: 49, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.983 Test Loss: 0.142 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.2804229259490967
Epoch: 50, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.189 Vali Acc: 0.984 Test Loss: 0.189 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9909470752089137
model parameter : 36870932
model size : 155.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.0021631717681885
Epoch: 1, Steps: 89 | Train Loss: 1.846 Vali Loss: 0.474 Vali Acc: 0.873 Test Loss: 0.474 Test Acc: 0.873
Validation loss decreased (inf --> -0.872558).  Saving model ...
Epoch: 2 cost time: 2.9659852981567383
Epoch: 2, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.872558 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 2.143216609954834
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.948466 --> -0.974233).  Saving model ...
Epoch: 4 cost time: 2.147155284881592
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 1.976006269454956
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0620853900909424
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.976322 --> -0.986768).  Saving model ...
Epoch: 7 cost time: 2.155970335006714
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.227828025817871
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3681395053863525
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.541538715362549
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.384077548980713
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1813955307006836
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4395008087158203
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3694865703582764
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.262 Vali Acc: 0.952 Test Loss: 0.262 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1943578720092773
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5348122119903564
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.984 Test Loss: 0.130 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 36701972
model size : 154.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.427517890930176
Epoch: 1, Steps: 89 | Train Loss: 2.126 Vali Loss: 0.626 Vali Acc: 0.834 Test Loss: 0.626 Test Acc: 0.834
Validation loss decreased (inf --> -0.834256).  Saving model ...
Epoch: 2 cost time: 2.148285150527954
Epoch: 2, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
Validation loss decreased (-0.834256 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 2.0708940029144287
Epoch: 3, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.947073 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 1.944941759109497
Epoch: 4, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.949859 --> -0.973537).  Saving model ...
Epoch: 5 cost time: 2.365304708480835
Epoch: 5, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 1.9680042266845703
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.980500).  Saving model ...
Epoch: 7 cost time: 2.3533337116241455
Epoch: 7, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.158039093017578
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.2842600345611572
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.108900308609009
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9475786685943604
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 2.2456235885620117
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 13 cost time: 2.2129366397857666
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3050568103790283
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0964102745056152
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2585561275482178
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 17 cost time: 2.2246358394622803
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.345911979675293
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.984 Test Loss: 0.090 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.675945520401001
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.754192590713501
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.353039026260376
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6904420852661133
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.981 Test Loss: 0.173 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0983493328094482
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6117913722991943
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.506869077682495
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.985 Test Loss: 0.150 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.167780876159668
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.987 Test Loss: 0.126 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 36600596
model size : 154.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.550860643386841
Epoch: 1, Steps: 89 | Train Loss: 1.709 Vali Loss: 0.506 Vali Acc: 0.868 Test Loss: 0.506 Test Acc: 0.868
Validation loss decreased (inf --> -0.867683).  Saving model ...
Epoch: 2 cost time: 2.346620559692383
Epoch: 2, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (-0.867683 --> -0.928270).  Saving model ...
Epoch: 3 cost time: 2.3077399730682373
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.928270 --> -0.972144).  Saving model ...
Epoch: 4 cost time: 2.2234046459198
Epoch: 4, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1156694889068604
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
Validation loss decreased (-0.972144 --> -0.984679).  Saving model ...
Epoch: 6 cost time: 2.469616174697876
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.91922664642334
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9521842002868652
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.073 Vali Acc: 0.986 Test Loss: 0.073 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 9 cost time: 2.6872236728668213
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.446751117706299
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5952506065368652
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.248 Vali Acc: 0.967 Test Loss: 0.248 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5673584938049316
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1756515502929688
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.309717893600464
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.178 Vali Acc: 0.981 Test Loss: 0.178 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3315181732177734
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3645970821380615
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.980 Test Loss: 0.220 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3655104637145996
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.981 Test Loss: 0.160 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.266740083694458
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.415 Vali Acc: 0.962 Test Loss: 0.415 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 36837908
model size : 155.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5016705989837646
Epoch: 1, Steps: 89 | Train Loss: 1.949 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
Validation loss decreased (inf --> -0.866987).  Saving model ...
Epoch: 2 cost time: 2.308225154876709
Epoch: 2, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.866987 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 2.4658732414245605
Epoch: 3, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.943591 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.607680082321167
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.962394 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 2.5011043548583984
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.533328056335449
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.067 Vali Acc: 0.988 Test Loss: 0.067 Test Acc: 0.988
Validation loss decreased (-0.972840 --> -0.988161).  Saving model ...
Epoch: 7 cost time: 2.40545916557312
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4573333263397217
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 9 cost time: 2.312824249267578
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.115194320678711
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1536378860473633
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.989 Test Loss: 0.062 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 12 cost time: 1.8154606819152832
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3084614276885986
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.032121419906616
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.974 Test Loss: 0.180 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.19529390335083
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3454930782318115
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.986 Test Loss: 0.087 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0169517993927
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.943575143814087
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.61633038520813
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.949242353439331
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.079 Vali Acc: 0.986 Test Loss: 0.079 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5774734020233154
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 36685844
model size : 154.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.58862566947937
Epoch: 1, Steps: 89 | Train Loss: 2.246 Vali Loss: 0.736 Vali Acc: 0.777 Test Loss: 0.736 Test Acc: 0.777
Validation loss decreased (inf --> -0.777151).  Saving model ...
Epoch: 2 cost time: 2.205385208129883
Epoch: 2, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.777151 --> -0.936628).  Saving model ...
Epoch: 3 cost time: 2.309788942337036
Epoch: 3, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.936628 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 2.149117946624756
Epoch: 4, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.958216 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.0262668132781982
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.1936681270599365
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 2.1434199810028076
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0028328895568848
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 9 cost time: 2.3244967460632324
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0488240718841553
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.013598680496216
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1132423877716064
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.983983 --> -0.987465).  Saving model ...
Epoch: 13 cost time: 2.0849199295043945
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.241779327392578
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2941970825195312
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.050 Vali Acc: 0.992 Test Loss: 0.050 Test Acc: 0.992
Validation loss decreased (-0.987465 --> -0.992339).  Saving model ...
Epoch: 16 cost time: 2.1437642574310303
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1746103763580322
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0460851192474365
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2614049911499023
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.986 Test Loss: 0.096 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9160816669464111
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2639803886413574
Epoch: 21, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.395113229751587
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.173508405685425
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.303677558898926
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.052196979522705
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9923398328690808
model parameter : 36601364
model size : 154.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2914488315582275
Epoch: 1, Steps: 89 | Train Loss: 1.782 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
Validation loss decreased (inf --> -0.862809).  Saving model ...
Epoch: 2 cost time: 2.1923937797546387
Epoch: 2, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
Validation loss decreased (-0.862809 --> -0.942199).  Saving model ...
Epoch: 3 cost time: 2.341491222381592
Epoch: 3, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.942199 --> -0.966573).  Saving model ...
Epoch: 4 cost time: 1.9932286739349365
Epoch: 4, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9091148376464844
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 2.3747665882110596
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0185301303863525
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 3.014824628829956
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
Validation loss decreased (-0.974233 --> -0.985375).  Saving model ...
Epoch: 9 cost time: 2.1939210891723633
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.935696840286255
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8371362686157227
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0020244121551514
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.165571689605713
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6161580085754395
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.216 Vali Acc: 0.966 Test Loss: 0.216 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8652937412261963
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.150543212890625
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8741495609283447
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.214149236679077
Epoch: 18, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 36811796
model size : 155.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5762741565704346
Epoch: 1, Steps: 89 | Train Loss: 2.017 Vali Loss: 0.558 Vali Acc: 0.821 Test Loss: 0.558 Test Acc: 0.821
Validation loss decreased (inf --> -0.821025).  Saving model ...
Epoch: 2 cost time: 2.379089593887329
Epoch: 2, Steps: 89 | Train Loss: 0.377 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
Validation loss decreased (-0.821025 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 2.110445737838745
Epoch: 3, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
Validation loss decreased (-0.938716 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 1.9733567237854004
Epoch: 4, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0865602493286133
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.965876 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 2.0468664169311523
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.983286).  Saving model ...
Epoch: 7 cost time: 2.127723217010498
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.987465).  Saving model ...
Epoch: 8 cost time: 2.157144069671631
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2206320762634277
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2502355575561523
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.065 Vali Acc: 0.990 Test Loss: 0.065 Test Acc: 0.990
Validation loss decreased (-0.987465 --> -0.990250).  Saving model ...
Epoch: 11 cost time: 2.0725739002227783
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.052 Vali Acc: 0.985 Test Loss: 0.052 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3463144302368164
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.059 Vali Acc: 0.988 Test Loss: 0.059 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.329864978790283
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.238718271255493
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.061 Vali Acc: 0.988 Test Loss: 0.061 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9896423816680908
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4185667037963867
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0078954696655273
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.266 Vali Acc: 0.953 Test Loss: 0.266 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3287487030029297
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.318 Vali Acc: 0.959 Test Loss: 0.318 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.262547731399536
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.303 Vali Acc: 0.953 Test Loss: 0.303 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9153821468353271
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 36693524
model size : 154.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.330462694168091
Epoch: 1, Steps: 89 | Train Loss: 2.257 Vali Loss: 0.682 Vali Acc: 0.810 Test Loss: 0.682 Test Acc: 0.810
Validation loss decreased (inf --> -0.809882).  Saving model ...
Epoch: 2 cost time: 2.4043354988098145
Epoch: 2, Steps: 89 | Train Loss: 0.455 Vali Loss: 0.226 Vali Acc: 0.929 Test Loss: 0.226 Test Acc: 0.929
Validation loss decreased (-0.809882 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 2.0955750942230225
Epoch: 3, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.928967 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 2.0648691654205322
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.956823 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.0138964653015137
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 2.027006149291992
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 2.456160068511963
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
Validation loss decreased (-0.976322 --> -0.986768).  Saving model ...
Epoch: 8 cost time: 2.203991413116455
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.514148235321045
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4884512424468994
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1012871265411377
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3304195404052734
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4959495067596436
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2659928798675537
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0044753551483154
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2478511333465576
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2752931118011475
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el5_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 36625940
model size : 154.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.464543104171753
Epoch: 1, Steps: 89 | Train Loss: 1.500 Vali Loss: 0.542 Vali Acc: 0.857 Test Loss: 0.542 Test Acc: 0.857
Validation loss decreased (inf --> -0.856541).  Saving model ...
Epoch: 2 cost time: 4.575978517532349
Epoch: 2, Steps: 89 | Train Loss: 0.618 Vali Loss: 0.790 Vali Acc: 0.819 Test Loss: 0.790 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.497462749481201
Epoch: 3, Steps: 89 | Train Loss: 0.472 Vali Loss: 0.562 Vali Acc: 0.893 Test Loss: 0.562 Test Acc: 0.893
Validation loss decreased (-0.856541 --> -0.893448).  Saving model ...
Epoch: 4 cost time: 6.138363361358643
Epoch: 4, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.452 Vali Acc: 0.932 Test Loss: 0.452 Test Acc: 0.932
Validation loss decreased (-0.893448 --> -0.932447).  Saving model ...
Epoch: 5 cost time: 4.593263626098633
Epoch: 5, Steps: 89 | Train Loss: 0.314 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
Validation loss decreased (-0.932447 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 5.930506467819214
Epoch: 6, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.299 Vali Acc: 0.959 Test Loss: 0.299 Test Acc: 0.959
Validation loss decreased (-0.956126 --> -0.958911).  Saving model ...
Epoch: 7 cost time: 5.415708541870117
Epoch: 7, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.512 Vali Acc: 0.916 Test Loss: 0.512 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.895247936248779
Epoch: 8, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.348 Vali Acc: 0.954 Test Loss: 0.348 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.335950136184692
Epoch: 9, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.273 Vali Acc: 0.962 Test Loss: 0.273 Test Acc: 0.962
Validation loss decreased (-0.958911 --> -0.962393).  Saving model ...
Epoch: 10 cost time: 4.3545310497283936
Epoch: 10, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.448 Vali Acc: 0.954 Test Loss: 0.448 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.832421541213989
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.654 Vali Acc: 0.935 Test Loss: 0.654 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.497129440307617
Epoch: 12, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.417 Vali Acc: 0.955 Test Loss: 0.417 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.200227499008179
Epoch: 13, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.390 Vali Acc: 0.958 Test Loss: 0.390 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.23352313041687
Epoch: 14, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.375 Vali Acc: 0.962 Test Loss: 0.375 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.421861886978149
Epoch: 15, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.252 Vali Acc: 0.978 Test Loss: 0.252 Test Acc: 0.978
Validation loss decreased (-0.962393 --> -0.977713).  Saving model ...
Epoch: 16 cost time: 4.173321723937988
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.433 Vali Acc: 0.962 Test Loss: 0.433 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.990469932556152
Epoch: 17, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.560 Vali Acc: 0.955 Test Loss: 0.560 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.560474634170532
Epoch: 18, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.561 Vali Acc: 0.942 Test Loss: 0.561 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.406568765640259
Epoch: 19, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.614 Vali Acc: 0.943 Test Loss: 0.614 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.620658874511719
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.374 Vali Acc: 0.967 Test Loss: 0.374 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.139528751373291
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.361 Vali Acc: 0.974 Test Loss: 0.361 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.832839488983154
Epoch: 22, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.577 Vali Acc: 0.959 Test Loss: 0.577 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.784070253372192
Epoch: 23, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.518 Vali Acc: 0.968 Test Loss: 0.518 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.367142915725708
Epoch: 24, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.651 Vali Acc: 0.959 Test Loss: 0.651 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.226456165313721
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.473 Vali Acc: 0.971 Test Loss: 0.473 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 30756884
model size : 132.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5727217197418213
Epoch: 1, Steps: 89 | Train Loss: 1.557 Vali Loss: 0.523 Vali Acc: 0.849 Test Loss: 0.523 Test Acc: 0.849
Validation loss decreased (inf --> -0.848881).  Saving model ...
Epoch: 2 cost time: 3.3438119888305664
Epoch: 2, Steps: 89 | Train Loss: 0.496 Vali Loss: 0.455 Vali Acc: 0.877 Test Loss: 0.455 Test Acc: 0.877
Validation loss decreased (-0.848881 --> -0.877433).  Saving model ...
Epoch: 3 cost time: 2.8762049674987793
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.503 Vali Acc: 0.899 Test Loss: 0.503 Test Acc: 0.899
Validation loss decreased (-0.877433 --> -0.899020).  Saving model ...
Epoch: 4 cost time: 3.183849811553955
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.899020 --> -0.958215).  Saving model ...
Epoch: 5 cost time: 3.2943084239959717
Epoch: 5, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.559556245803833
Epoch: 6, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.275 Vali Acc: 0.948 Test Loss: 0.275 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.524833917617798
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.390 Vali Acc: 0.932 Test Loss: 0.390 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.636713981628418
Epoch: 8, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.296 Vali Acc: 0.954 Test Loss: 0.296 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4654953479766846
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
Validation loss decreased (-0.958215 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 2.469876527786255
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.306 Vali Acc: 0.953 Test Loss: 0.306 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3849165439605713
Epoch: 11, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.337 Vali Acc: 0.953 Test Loss: 0.337 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5895659923553467
Epoch: 12, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.482 Vali Acc: 0.935 Test Loss: 0.482 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0103883743286133
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.293 Vali Acc: 0.963 Test Loss: 0.293 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.370169162750244
Epoch: 14, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2784616947174072
Epoch: 15, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.215 Vali Acc: 0.978 Test Loss: 0.215 Test Acc: 0.978
Validation loss decreased (-0.970054 --> -0.977714).  Saving model ...
Epoch: 16 cost time: 3.3296282291412354
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.330 Vali Acc: 0.953 Test Loss: 0.330 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3313963413238525
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.977 Test Loss: 0.227 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.147918224334717
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.465 Vali Acc: 0.952 Test Loss: 0.465 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8834950923919678
Epoch: 19, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.406 Vali Acc: 0.961 Test Loss: 0.406 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4970176219940186
Epoch: 20, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.362 Vali Acc: 0.976 Test Loss: 0.362 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4606950283050537
Epoch: 21, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.360 Vali Acc: 0.965 Test Loss: 0.360 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.477937698364258
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.977 Test Loss: 0.230 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4689526557922363
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.981 Test Loss: 0.299 Test Acc: 0.981
Validation loss decreased (-0.977714 --> -0.981195).  Saving model ...
Epoch: 24 cost time: 2.39458966255188
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.464 Vali Acc: 0.966 Test Loss: 0.464 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.498704671859741
Epoch: 25, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.389 Vali Acc: 0.973 Test Loss: 0.389 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.433933734893799
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.505 Vali Acc: 0.953 Test Loss: 0.505 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4264888763427734
Epoch: 27, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.382 Vali Acc: 0.973 Test Loss: 0.382 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.470294713973999
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.331 Vali Acc: 0.974 Test Loss: 0.331 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.503290891647339
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.437 Vali Acc: 0.964 Test Loss: 0.437 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.5024685859680176
Epoch: 30, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.608 Vali Acc: 0.937 Test Loss: 0.608 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.5191516876220703
Epoch: 31, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.373 Vali Acc: 0.968 Test Loss: 0.373 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.4601776599884033
Epoch: 32, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.372 Vali Acc: 0.974 Test Loss: 0.372 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.3521130084991455
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.358 Vali Acc: 0.972 Test Loss: 0.358 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 30013460
model size : 129.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8756778240203857
Epoch: 1, Steps: 89 | Train Loss: 1.847 Vali Loss: 0.596 Vali Acc: 0.827 Test Loss: 0.596 Test Acc: 0.827
Validation loss decreased (inf --> -0.827292).  Saving model ...
Epoch: 2 cost time: 2.161231756210327
Epoch: 2, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.827292 --> -0.902504).  Saving model ...
Epoch: 3 cost time: 2.044618844985962
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.281 Vali Acc: 0.929 Test Loss: 0.281 Test Acc: 0.929
Validation loss decreased (-0.902504 --> -0.928967).  Saving model ...
Epoch: 4 cost time: 2.7465741634368896
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.255 Vali Acc: 0.936 Test Loss: 0.255 Test Acc: 0.936
Validation loss decreased (-0.928967 --> -0.935931).  Saving model ...
Epoch: 5 cost time: 2.0183608531951904
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
Validation loss decreased (-0.935931 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 2.699882745742798
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.252 Vali Acc: 0.945 Test Loss: 0.252 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.041581153869629
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.073842763900757
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 1.963670253753662
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974232).  Saving model ...
Epoch: 10 cost time: 1.975996971130371
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
Validation loss decreased (-0.974232 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 2.0455377101898193
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8953890800476074
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.215 Vali Acc: 0.954 Test Loss: 0.215 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9364080429077148
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.015899896621704
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 15 cost time: 2.0834639072418213
Epoch: 15, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.898423671722412
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.090 Vali Acc: 0.988 Test Loss: 0.090 Test Acc: 0.988
Validation loss decreased (-0.977018 --> -0.988161).  Saving model ...
Epoch: 17 cost time: 2.0298819541931152
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.976 Test Loss: 0.171 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0547561645507812
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.159 Vali Acc: 0.976 Test Loss: 0.159 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.924654483795166
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.208 Vali Acc: 0.973 Test Loss: 0.208 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8241896629333496
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.160 Vali Acc: 0.981 Test Loss: 0.160 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0392088890075684
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.246208906173706
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.776170015335083
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8835408687591553
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8176207542419434
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.655343770980835
Epoch: 26, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 29641748
model size : 127.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.8915910720825195
Epoch: 1, Steps: 89 | Train Loss: 1.564 Vali Loss: 0.463 Vali Acc: 0.880 Test Loss: 0.463 Test Acc: 0.880
Validation loss decreased (inf --> -0.879522).  Saving model ...
Epoch: 2 cost time: 3.0506789684295654
Epoch: 2, Steps: 89 | Train Loss: 0.531 Vali Loss: 0.295 Vali Acc: 0.923 Test Loss: 0.295 Test Acc: 0.923
Validation loss decreased (-0.879522 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 2.85437273979187
Epoch: 3, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.609 Vali Acc: 0.886 Test Loss: 0.609 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.955658435821533
Epoch: 4, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.242 Vali Acc: 0.951 Test Loss: 0.242 Test Acc: 0.951
Validation loss decreased (-0.923395 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 2.934159517288208
Epoch: 5, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
Validation loss decreased (-0.951251 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 2.897176504135132
Epoch: 6, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.327 Vali Acc: 0.943 Test Loss: 0.327 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9319214820861816
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.243 Vali Acc: 0.964 Test Loss: 0.243 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.900437831878662
Epoch: 8, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.369 Vali Acc: 0.946 Test Loss: 0.369 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9818451404571533
Epoch: 9, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 3.716191291809082
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.226 Vali Acc: 0.971 Test Loss: 0.226 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970750).  Saving model ...
Epoch: 11 cost time: 3.673612117767334
Epoch: 11, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.334 Vali Acc: 0.955 Test Loss: 0.334 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9244301319122314
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.325 Vali Acc: 0.954 Test Loss: 0.325 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.66733980178833
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.981 Test Loss: 0.206 Test Acc: 0.981
Validation loss decreased (-0.970750 --> -0.980499).  Saving model ...
Epoch: 14 cost time: 3.252976179122925
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.978 Test Loss: 0.221 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.93337082862854
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.273 Vali Acc: 0.971 Test Loss: 0.273 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9754233360290527
Epoch: 16, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.969 Test Loss: 0.259 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8799123764038086
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.973 Test Loss: 0.231 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9447286128997803
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.168 Vali Acc: 0.982 Test Loss: 0.168 Test Acc: 0.982
Validation loss decreased (-0.980499 --> -0.981892).  Saving model ...
Epoch: 19 cost time: 2.969910144805908
Epoch: 19, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.239 Vali Acc: 0.979 Test Loss: 0.239 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.298807859420776
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.235 Vali Acc: 0.981 Test Loss: 0.235 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.225828409194946
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.249 Vali Acc: 0.978 Test Loss: 0.249 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.1883885860443115
Epoch: 22, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.264 Vali Acc: 0.976 Test Loss: 0.264 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9485607147216797
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.330 Vali Acc: 0.965 Test Loss: 0.330 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.329864978790283
Epoch: 24, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.298 Vali Acc: 0.974 Test Loss: 0.298 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.28625750541687
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.292 Vali Acc: 0.978 Test Loss: 0.292 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.28368616104126
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.971 Test Loss: 0.280 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0500428676605225
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.980 Test Loss: 0.221 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.382556200027466
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.288 Vali Acc: 0.976 Test Loss: 0.288 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 30256916
model size : 130.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.274266004562378
Epoch: 1, Steps: 89 | Train Loss: 1.698 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
Validation loss decreased (inf --> -0.841220).  Saving model ...
Epoch: 2 cost time: 2.9589192867279053
Epoch: 2, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.841220 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 2.1775319576263428
Epoch: 3, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
Validation loss decreased (-0.930360 --> -0.956822).  Saving model ...
Epoch: 4 cost time: 2.1251626014709473
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.251 Vali Acc: 0.947 Test Loss: 0.251 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2176671028137207
Epoch: 5, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
Validation loss decreased (-0.956822 --> -0.975625).  Saving model ...
Epoch: 6 cost time: 2.1913862228393555
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.975625).  Saving model ...
Epoch: 7 cost time: 2.2307305335998535
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.975625 --> -0.983286).  Saving model ...
Epoch: 8 cost time: 2.3046998977661133
Epoch: 8, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.020953416824341
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.247 Vali Acc: 0.967 Test Loss: 0.247 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.133713483810425
Epoch: 10, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.256 Vali Acc: 0.960 Test Loss: 0.256 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.195875883102417
Epoch: 11, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1000354290008545
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1778924465179443
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.302 Vali Acc: 0.954 Test Loss: 0.302 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.993882656097412
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.984 Test Loss: 0.159 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 15 cost time: 3.0259320735931396
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.981 Test Loss: 0.167 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.330535650253296
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9972686767578125
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.379 Vali Acc: 0.939 Test Loss: 0.379 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.149498462677002
Epoch: 18, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.343 Vali Acc: 0.947 Test Loss: 0.343 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.328648090362549
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.976 Test Loss: 0.221 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1546645164489746
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.972 Test Loss: 0.225 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.27093505859375
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.221078395843506
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.984 Test Loss: 0.191 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1141250133514404
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.978 Test Loss: 0.221 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1258814334869385
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.300 Vali Acc: 0.967 Test Loss: 0.300 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 29868308
model size : 128.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.818754196166992
Epoch: 1, Steps: 89 | Train Loss: 1.866 Vali Loss: 0.525 Vali Acc: 0.843 Test Loss: 0.525 Test Acc: 0.843
Validation loss decreased (inf --> -0.842613).  Saving model ...
Epoch: 2 cost time: 1.9726839065551758
Epoch: 2, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
Validation loss decreased (-0.842613 --> -0.931753).  Saving model ...
Epoch: 3 cost time: 1.8377563953399658
Epoch: 3, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.931753 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 2.4590606689453125
Epoch: 4, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 2.6083343029022217
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
Validation loss decreased (-0.960305 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 1.7358675003051758
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.841172218322754
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0100958347320557
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.965876 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 1.8819866180419922
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6124236583709717
Epoch: 10, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8747930526733398
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.980500).  Saving model ...
Epoch: 12 cost time: 2.006683349609375
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983286).  Saving model ...
Epoch: 13 cost time: 2.5182571411132812
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9862921237945557
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8745737075805664
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.981 Test Loss: 0.142 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8381450176239014
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8217029571533203
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9392836093902588
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8282191753387451
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9521141052246094
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.964 Test Loss: 0.237 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8823587894439697
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.199 Vali Acc: 0.969 Test Loss: 0.199 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.221982002258301
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 29614868
model size : 127.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.7334442138671875
Epoch: 1, Steps: 89 | Train Loss: 1.490 Vali Loss: 0.754 Vali Acc: 0.838 Test Loss: 0.754 Test Acc: 0.838
Validation loss decreased (inf --> -0.837736).  Saving model ...
Epoch: 2 cost time: 4.018394470214844
Epoch: 2, Steps: 89 | Train Loss: 0.487 Vali Loss: 0.600 Vali Acc: 0.886 Test Loss: 0.600 Test Acc: 0.886
Validation loss decreased (-0.837736 --> -0.885788).  Saving model ...
Epoch: 3 cost time: 4.396759510040283
Epoch: 3, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.335 Vali Acc: 0.923 Test Loss: 0.335 Test Acc: 0.923
Validation loss decreased (-0.885788 --> -0.923395).  Saving model ...
Epoch: 4 cost time: 4.313280344009399
Epoch: 4, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.923395 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 4.229758024215698
Epoch: 5, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.884984254837036
Epoch: 6, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.247 Vali Acc: 0.971 Test Loss: 0.247 Test Acc: 0.971
Validation loss decreased (-0.957519 --> -0.970750).  Saving model ...
Epoch: 7 cost time: 4.257593870162964
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.288 Vali Acc: 0.958 Test Loss: 0.288 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0933444499969482
Epoch: 8, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.306 Vali Acc: 0.963 Test Loss: 0.306 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7548248767852783
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.410 Vali Acc: 0.956 Test Loss: 0.410 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9369473457336426
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.355 Vali Acc: 0.974 Test Loss: 0.355 Test Acc: 0.974
Validation loss decreased (-0.970750 --> -0.974230).  Saving model ...
Epoch: 11 cost time: 2.792311668395996
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.368 Vali Acc: 0.971 Test Loss: 0.368 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8161072731018066
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.312 Vali Acc: 0.966 Test Loss: 0.312 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.787496566772461
Epoch: 13, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.661834955215454
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.311 Vali Acc: 0.974 Test Loss: 0.311 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.978959798812866
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.368 Vali Acc: 0.964 Test Loss: 0.368 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.011439085006714
Epoch: 16, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.420 Vali Acc: 0.966 Test Loss: 0.420 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.410579204559326
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.232 Vali Acc: 0.976 Test Loss: 0.232 Test Acc: 0.976
Validation loss decreased (-0.974230 --> -0.975624).  Saving model ...
Epoch: 18 cost time: 3.1096904277801514
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9427387714385986
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.331 Vali Acc: 0.974 Test Loss: 0.331 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.717496633529663
Epoch: 20, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.279 Vali Acc: 0.974 Test Loss: 0.279 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.0031843185424805
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.271 Vali Acc: 0.978 Test Loss: 0.271 Test Acc: 0.978
Validation loss decreased (-0.975624 --> -0.977713).  Saving model ...
Epoch: 22 cost time: 4.021338701248169
Epoch: 22, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.331 Vali Acc: 0.976 Test Loss: 0.331 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8821940422058105
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.451 Vali Acc: 0.969 Test Loss: 0.451 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9299256801605225
Epoch: 24, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.428 Vali Acc: 0.960 Test Loss: 0.428 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.880490779876709
Epoch: 25, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.403 Vali Acc: 0.967 Test Loss: 0.403 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.884100914001465
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.398 Vali Acc: 0.966 Test Loss: 0.398 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.8586974143981934
Epoch: 27, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.370 Vali Acc: 0.971 Test Loss: 0.370 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.895698070526123
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.288 Vali Acc: 0.976 Test Loss: 0.288 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.0465760231018066
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.309 Vali Acc: 0.971 Test Loss: 0.309 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.7184762954711914
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.978 Test Loss: 0.282 Test Acc: 0.978
Validation loss decreased (-0.977713 --> -0.978409).  Saving model ...
Epoch: 31 cost time: 3.5150341987609863
Epoch: 31, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.319 Vali Acc: 0.978 Test Loss: 0.319 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.991314649581909
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.335 Vali Acc: 0.974 Test Loss: 0.335 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.8815910816192627
Epoch: 33, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.336 Vali Acc: 0.983 Test Loss: 0.336 Test Acc: 0.983
Validation loss decreased (-0.978409 --> -0.982587).  Saving model ...
Epoch: 34 cost time: 3.9059813022613525
Epoch: 34, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.466 Vali Acc: 0.968 Test Loss: 0.466 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.8187379837036133
Epoch: 35, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.383 Vali Acc: 0.970 Test Loss: 0.383 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.9265949726104736
Epoch: 36, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.702 Vali Acc: 0.956 Test Loss: 0.702 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.724597930908203
Epoch: 37, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.861 Vali Acc: 0.939 Test Loss: 0.861 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.9748194217681885
Epoch: 38, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.499 Vali Acc: 0.973 Test Loss: 0.499 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.9102795124053955
Epoch: 39, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.514 Vali Acc: 0.969 Test Loss: 0.514 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.0070109367370605
Epoch: 40, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.775 Vali Acc: 0.964 Test Loss: 0.775 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.9769201278686523
Epoch: 41, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.367 Vali Acc: 0.981 Test Loss: 0.367 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.9294755458831787
Epoch: 42, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.529 Vali Acc: 0.967 Test Loss: 0.529 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.9023327827453613
Epoch: 43, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.340 Vali Acc: 0.983 Test Loss: 0.340 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 30263828
model size : 130.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9549622535705566
Epoch: 1, Steps: 89 | Train Loss: 1.638 Vali Loss: 0.557 Vali Acc: 0.848 Test Loss: 0.557 Test Acc: 0.848
Validation loss decreased (inf --> -0.848184).  Saving model ...
Epoch: 2 cost time: 2.5533900260925293
Epoch: 2, Steps: 89 | Train Loss: 0.477 Vali Loss: 0.518 Vali Acc: 0.886 Test Loss: 0.518 Test Acc: 0.886
Validation loss decreased (-0.848184 --> -0.885789).  Saving model ...
Epoch: 3 cost time: 2.3570590019226074
Epoch: 3, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
Validation loss decreased (-0.885789 --> -0.922002).  Saving model ...
Epoch: 4 cost time: 2.796497106552124
Epoch: 4, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.392 Vali Acc: 0.930 Test Loss: 0.392 Test Acc: 0.930
Validation loss decreased (-0.922002 --> -0.930358).  Saving model ...
Epoch: 5 cost time: 3.4016973972320557
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.315 Vali Acc: 0.946 Test Loss: 0.315 Test Acc: 0.946
Validation loss decreased (-0.930358 --> -0.945679).  Saving model ...
Epoch: 6 cost time: 2.1130454540252686
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.243 Vali Acc: 0.961 Test Loss: 0.243 Test Acc: 0.961
Validation loss decreased (-0.945679 --> -0.961000).  Saving model ...
Epoch: 7 cost time: 2.0585827827453613
Epoch: 7, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.301 Vali Acc: 0.956 Test Loss: 0.301 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1028640270233154
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
Validation loss decreased (-0.961000 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 2.0658702850341797
Epoch: 9, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
Validation loss decreased (-0.961697 --> -0.967268).  Saving model ...
Epoch: 10 cost time: 2.116255521774292
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.310 Vali Acc: 0.951 Test Loss: 0.310 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1007816791534424
Epoch: 11, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.902 Vali Acc: 0.925 Test Loss: 0.902 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0706615447998047
Epoch: 12, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.291 Vali Acc: 0.958 Test Loss: 0.291 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0632519721984863
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
Validation loss decreased (-0.967268 --> -0.970750).  Saving model ...
Epoch: 14 cost time: 2.1035068035125732
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
Validation loss decreased (-0.970750 --> -0.981196).  Saving model ...
Epoch: 15 cost time: 3.0903122425079346
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.236 Vali Acc: 0.969 Test Loss: 0.236 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.208235502243042
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.368 Vali Acc: 0.961 Test Loss: 0.368 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.080288887023926
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.187 Vali Acc: 0.984 Test Loss: 0.187 Test Acc: 0.984
Validation loss decreased (-0.981196 --> -0.983981).  Saving model ...
Epoch: 18 cost time: 2.982848882675171
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.449 Vali Acc: 0.933 Test Loss: 0.449 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1449615955352783
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.272 Vali Acc: 0.969 Test Loss: 0.272 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.925398111343384
Epoch: 20, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.289 Vali Acc: 0.967 Test Loss: 0.289 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.780022144317627
Epoch: 21, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.301 Vali Acc: 0.967 Test Loss: 0.301 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.917630672454834
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.974 Test Loss: 0.251 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2235732078552246
Epoch: 23, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.163 Vali Acc: 0.981 Test Loss: 0.163 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1569459438323975
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.285 Vali Acc: 0.972 Test Loss: 0.285 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0477817058563232
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.303 Vali Acc: 0.968 Test Loss: 0.303 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.308540105819702
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.450 Vali Acc: 0.958 Test Loss: 0.450 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.166482925415039
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.326 Vali Acc: 0.971 Test Loss: 0.326 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 29875220
model size : 128.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0268495082855225
Epoch: 1, Steps: 89 | Train Loss: 1.847 Vali Loss: 0.570 Vali Acc: 0.847 Test Loss: 0.570 Test Acc: 0.847
Validation loss decreased (inf --> -0.846791).  Saving model ...
Epoch: 2 cost time: 2.0118930339813232
Epoch: 2, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.207 Vali Acc: 0.942 Test Loss: 0.207 Test Acc: 0.942
Validation loss decreased (-0.846791 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 1.845719337463379
Epoch: 3, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
Validation loss decreased (-0.941502 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 1.9287910461425781
Epoch: 4, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.953341 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 2.564018964767456
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.957519 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.5837063789367676
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0399725437164307
Epoch: 7, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 8 cost time: 2.044019937515259
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.977018 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 1.9700829982757568
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.681736707687378
Epoch: 10, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5649991035461426
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.277 Vali Acc: 0.957 Test Loss: 0.277 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1861660480499268
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.683164358139038
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8286097049713135
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.985 Test Loss: 0.124 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984678).  Saving model ...
Epoch: 15 cost time: 1.8224947452545166
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6484901905059814
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8707785606384277
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7970123291015625
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.242 Vali Acc: 0.976 Test Loss: 0.242 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0070061683654785
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.984 Test Loss: 0.153 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1566879749298096
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.982 Test Loss: 0.135 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9224011898040771
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.988 Test Loss: 0.138 Test Acc: 0.988
Validation loss decreased (-0.984678 --> -0.988160).  Saving model ...
Epoch: 22 cost time: 1.9651820659637451
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0291242599487305
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.984 Test Loss: 0.134 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.852578639984131
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.990 Test Loss: 0.129 Test Acc: 0.990
Validation loss decreased (-0.988160 --> -0.989553).  Saving model ...
Epoch: 25 cost time: 2.238837480545044
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.988 Test Loss: 0.130 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0402629375457764
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.986 Test Loss: 0.149 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.111555337905884
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.112848997116089
Epoch: 28, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.227 Vali Acc: 0.976 Test Loss: 0.227 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.211588144302368
Epoch: 29, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.971 Test Loss: 0.220 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.7012906074523926
Epoch: 30, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.981 Test Loss: 0.208 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.487339735031128
Epoch: 31, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.035947561264038
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.986 Test Loss: 0.120 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9822747707366943
Epoch: 33, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.342 Vali Acc: 0.967 Test Loss: 0.342 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.9039857387542725
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.983 Test Loss: 0.171 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 29587988
model size : 127.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8649606704711914
Epoch: 1, Steps: 89 | Train Loss: 1.565 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
Validation loss decreased (inf --> -0.891361).  Saving model ...
Epoch: 2 cost time: 2.9260830879211426
Epoch: 2, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.891361 --> -0.900414).  Saving model ...
Epoch: 3 cost time: 2.9413344860076904
Epoch: 3, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
Validation loss decreased (-0.900414 --> -0.936626).  Saving model ...
Epoch: 4 cost time: 2.920891284942627
Epoch: 4, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.260 Vali Acc: 0.953 Test Loss: 0.260 Test Acc: 0.953
Validation loss decreased (-0.936626 --> -0.953340).  Saving model ...
Epoch: 5 cost time: 2.927584171295166
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.301 Vali Acc: 0.958 Test Loss: 0.301 Test Acc: 0.958
Validation loss decreased (-0.953340 --> -0.958214).  Saving model ...
Epoch: 6 cost time: 3.1527833938598633
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.225 Vali Acc: 0.970 Test Loss: 0.225 Test Acc: 0.970
Validation loss decreased (-0.958214 --> -0.970053).  Saving model ...
Epoch: 7 cost time: 4.08483624458313
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.389 Vali Acc: 0.948 Test Loss: 0.389 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.173460006713867
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.297 Vali Acc: 0.967 Test Loss: 0.297 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.151209115982056
Epoch: 9, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.408 Vali Acc: 0.949 Test Loss: 0.408 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.1058759689331055
Epoch: 10, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.389 Vali Acc: 0.955 Test Loss: 0.389 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.042346239089966
Epoch: 11, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.766 Vali Acc: 0.938 Test Loss: 0.766 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8210465908050537
Epoch: 12, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.351 Vali Acc: 0.959 Test Loss: 0.351 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.982069253921509
Epoch: 13, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.485 Vali Acc: 0.946 Test Loss: 0.485 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8570408821105957
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.358 Vali Acc: 0.969 Test Loss: 0.358 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.1192193031311035
Epoch: 15, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.434 Vali Acc: 0.961 Test Loss: 0.434 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.097324371337891
Epoch: 16, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.448 Vali Acc: 0.967 Test Loss: 0.448 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 30270740
model size : 130.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2454938888549805
Epoch: 1, Steps: 89 | Train Loss: 1.649 Vali Loss: 0.677 Vali Acc: 0.813 Test Loss: 0.677 Test Acc: 0.813
Validation loss decreased (inf --> -0.813364).  Saving model ...
Epoch: 2 cost time: 1.8892240524291992
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.373 Vali Acc: 0.921 Test Loss: 0.373 Test Acc: 0.921
Validation loss decreased (-0.813364 --> -0.921305).  Saving model ...
Epoch: 3 cost time: 1.9068927764892578
Epoch: 3, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.377 Vali Acc: 0.916 Test Loss: 0.377 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.089808464050293
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
Validation loss decreased (-0.921305 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 2.218681573867798
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.929663 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 2.0859344005584717
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.359 Vali Acc: 0.947 Test Loss: 0.359 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1821908950805664
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.233 Vali Acc: 0.955 Test Loss: 0.233 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1772854328155518
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0043962001800537
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.364 Vali Acc: 0.939 Test Loss: 0.364 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.713839292526245
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.244 Vali Acc: 0.962 Test Loss: 0.244 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2089903354644775
Epoch: 11, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.470 Vali Acc: 0.923 Test Loss: 0.470 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2837727069854736
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.271 Vali Acc: 0.970 Test Loss: 0.271 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2373313903808594
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.257 Vali Acc: 0.971 Test Loss: 0.257 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.183504581451416
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.175 Vali Acc: 0.974 Test Loss: 0.175 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974232).  Saving model ...
Epoch: 15 cost time: 2.4040400981903076
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.981 Test Loss: 0.178 Test Acc: 0.981
Validation loss decreased (-0.974232 --> -0.981196).  Saving model ...
Epoch: 16 cost time: 1.957658052444458
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.214 Vali Acc: 0.978 Test Loss: 0.214 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8834962844848633
Epoch: 17, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.245 Vali Acc: 0.980 Test Loss: 0.245 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3496384620666504
Epoch: 18, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.136474847793579
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.329 Vali Acc: 0.968 Test Loss: 0.329 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.04665470123291
Epoch: 20, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.347 Vali Acc: 0.965 Test Loss: 0.347 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1837847232818604
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.237 Vali Acc: 0.976 Test Loss: 0.237 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.6109421253204346
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.301 Vali Acc: 0.969 Test Loss: 0.301 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.529188871383667
Epoch: 23, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.230 Vali Acc: 0.982 Test Loss: 0.230 Test Acc: 0.982
Validation loss decreased (-0.981196 --> -0.981892).  Saving model ...
Epoch: 24 cost time: 2.200955390930176
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.369 Vali Acc: 0.974 Test Loss: 0.369 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.337117910385132
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.283 Vali Acc: 0.977 Test Loss: 0.283 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3802525997161865
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.317 Vali Acc: 0.978 Test Loss: 0.317 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.0907812118530273
Epoch: 27, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.363 Vali Acc: 0.963 Test Loss: 0.363 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.7674882411956787
Epoch: 28, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9791197776794434
Epoch: 29, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.976 Test Loss: 0.231 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.9589409828186035
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.983 Test Loss: 0.189 Test Acc: 0.983
Validation loss decreased (-0.981892 --> -0.982589).  Saving model ...
Epoch: 31 cost time: 2.405386447906494
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.985 Test Loss: 0.180 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.985374).  Saving model ...
Epoch: 32 cost time: 2.153825044631958
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.984 Test Loss: 0.187 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0861523151397705
Epoch: 33, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.978 Test Loss: 0.216 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0913498401641846
Epoch: 34, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.984 Test Loss: 0.170 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0716423988342285
Epoch: 35, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.251 Vali Acc: 0.977 Test Loss: 0.251 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0710458755493164
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.238 Vali Acc: 0.978 Test Loss: 0.238 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.186338186264038
Epoch: 37, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.282 Vali Acc: 0.978 Test Loss: 0.282 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.013446807861328
Epoch: 38, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.978 Test Loss: 0.181 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.089754819869995
Epoch: 39, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.984 Test Loss: 0.159 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.462930202484131
Epoch: 40, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.981 Test Loss: 0.189 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.0357446670532227
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.981 Test Loss: 0.228 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 29780756
model size : 128.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8196280002593994
Epoch: 1, Steps: 89 | Train Loss: 1.899 Vali Loss: 0.604 Vali Acc: 0.825 Test Loss: 0.604 Test Acc: 0.825
Validation loss decreased (inf --> -0.825203).  Saving model ...
Epoch: 2 cost time: 1.880056381225586
Epoch: 2, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.825203 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 1.9909608364105225
Epoch: 3, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.937324 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 1.9245188236236572
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8120355606079102
Epoch: 5, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.201 Vali Acc: 0.955 Test Loss: 0.201 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9456708431243896
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.969358 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 1.7569329738616943
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 8 cost time: 2.135695457458496
Epoch: 8, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 2.6083288192749023
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.982590 --> -0.986768).  Saving model ...
Epoch: 10 cost time: 3.1933741569519043
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.295 Vali Acc: 0.954 Test Loss: 0.295 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8312640190124512
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0336103439331055
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3949882984161377
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5264394283294678
Epoch: 14, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0379552841186523
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8088343143463135
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.099 Vali Acc: 0.986 Test Loss: 0.099 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9064955711364746
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.039645195007324
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0748238563537598
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.217 Vali Acc: 0.977 Test Loss: 0.217 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 29561108
model size : 127.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8916962146759033
Epoch: 1, Steps: 89 | Train Loss: 1.512 Vali Loss: 0.532 Vali Acc: 0.872 Test Loss: 0.532 Test Acc: 0.872
Validation loss decreased (inf --> -0.871861).  Saving model ...
Epoch: 2 cost time: 3.191232204437256
Epoch: 2, Steps: 89 | Train Loss: 0.560 Vali Loss: 0.500 Vali Acc: 0.869 Test Loss: 0.500 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.170875072479248
Epoch: 3, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.283 Vali Acc: 0.948 Test Loss: 0.283 Test Acc: 0.948
Validation loss decreased (-0.871861 --> -0.947769).  Saving model ...
Epoch: 4 cost time: 4.291523218154907
Epoch: 4, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.299 Vali Acc: 0.955 Test Loss: 0.299 Test Acc: 0.955
Validation loss decreased (-0.947769 --> -0.955429).  Saving model ...
Epoch: 5 cost time: 4.345754146575928
Epoch: 5, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
Validation loss decreased (-0.955429 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 3.9322805404663086
Epoch: 6, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.296997308731079
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.511 Vali Acc: 0.928 Test Loss: 0.511 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.269881010055542
Epoch: 8, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.316 Vali Acc: 0.953 Test Loss: 0.316 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.180108547210693
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 2.9285473823547363
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.187 Vali Acc: 0.981 Test Loss: 0.187 Test Acc: 0.981
Validation loss decreased (-0.973536 --> -0.980500).  Saving model ...
Epoch: 11 cost time: 2.9549577236175537
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.205 Vali Acc: 0.978 Test Loss: 0.205 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9854345321655273
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.112398386001587
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.873627185821533
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.968 Test Loss: 0.245 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.353351593017578
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.102716684341431
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.960 Test Loss: 0.234 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.235079288482666
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.423 Vali Acc: 0.966 Test Loss: 0.423 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9713478088378906
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.266 Vali Acc: 0.963 Test Loss: 0.266 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.057270765304565
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.318 Vali Acc: 0.965 Test Loss: 0.318 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.17970871925354
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.368 Vali Acc: 0.968 Test Loss: 0.368 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 30260756
model size : 130.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.3764190673828125
Epoch: 1, Steps: 89 | Train Loss: 1.736 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
Validation loss decreased (inf --> -0.883003).  Saving model ...
Epoch: 2 cost time: 2.892148971557617
Epoch: 2, Steps: 89 | Train Loss: 0.401 Vali Loss: 0.236 Vali Acc: 0.934 Test Loss: 0.236 Test Acc: 0.934
Validation loss decreased (-0.883003 --> -0.933842).  Saving model ...
Epoch: 3 cost time: 3.082749366760254
Epoch: 3, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
Validation loss decreased (-0.933842 --> -0.934537).  Saving model ...
Epoch: 4 cost time: 2.147486925125122
Epoch: 4, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
Validation loss decreased (-0.934537 --> -0.936626).  Saving model ...
Epoch: 5 cost time: 2.074924945831299
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
Validation loss decreased (-0.936626 --> -0.965179).  Saving model ...
Epoch: 6 cost time: 1.9770984649658203
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.230 Vali Acc: 0.962 Test Loss: 0.230 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9393186569213867
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.283 Vali Acc: 0.958 Test Loss: 0.283 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3797318935394287
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.968661).  Saving model ...
Epoch: 9 cost time: 2.714674234390259
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.189 Vali Acc: 0.974 Test Loss: 0.189 Test Acc: 0.974
Validation loss decreased (-0.968661 --> -0.974232).  Saving model ...
Epoch: 10 cost time: 2.748667001724243
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.320 Vali Acc: 0.953 Test Loss: 0.320 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9392786026000977
Epoch: 11, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974232 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 3.31502628326416
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7760202884674072
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.211294412612915
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.980500).  Saving model ...
Epoch: 15 cost time: 3.0318105220794678
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4911742210388184
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.981 Test Loss: 0.192 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981196).  Saving model ...
Epoch: 17 cost time: 2.0755693912506104
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.987 Test Loss: 0.142 Test Acc: 0.987
Validation loss decreased (-0.981196 --> -0.987464).  Saving model ...
Epoch: 18 cost time: 2.038151741027832
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0668230056762695
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9553709030151367
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.141 Vali Acc: 0.983 Test Loss: 0.141 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3816637992858887
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.273 Vali Acc: 0.972 Test Loss: 0.273 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8613998889923096
Epoch: 22, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.274 Vali Acc: 0.972 Test Loss: 0.274 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7846903800964355
Epoch: 23, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.313 Vali Acc: 0.970 Test Loss: 0.313 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9433479309082031
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.219 Vali Acc: 0.981 Test Loss: 0.219 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0684404373168945
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.250 Vali Acc: 0.972 Test Loss: 0.250 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0289480686187744
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.198 Vali Acc: 0.980 Test Loss: 0.198 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1454174518585205
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.979 Test Loss: 0.195 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29787668
model size : 128.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1390023231506348
Epoch: 1, Steps: 89 | Train Loss: 1.981 Vali Loss: 0.592 Vali Acc: 0.830 Test Loss: 0.592 Test Acc: 0.830
Validation loss decreased (inf --> -0.830078).  Saving model ...
Epoch: 2 cost time: 2.378849506378174
Epoch: 2, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.300 Vali Acc: 0.927 Test Loss: 0.300 Test Acc: 0.927
Validation loss decreased (-0.830078 --> -0.926877).  Saving model ...
Epoch: 3 cost time: 2.7477786540985107
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
Validation loss decreased (-0.926877 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 2.5745232105255127
Epoch: 4, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.225 Vali Acc: 0.946 Test Loss: 0.225 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.590298891067505
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.953341 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 2.7846152782440186
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.970054 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 1.9478113651275635
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.982589).  Saving model ...
Epoch: 8 cost time: 2.0175247192382812
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.202 Vali Acc: 0.955 Test Loss: 0.202 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0898821353912354
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.236 Vali Acc: 0.953 Test Loss: 0.236 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8957891464233398
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.158 Vali Acc: 0.981 Test Loss: 0.158 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8287312984466553
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.984 Test Loss: 0.107 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 12 cost time: 1.818955898284912
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.984 Test Loss: 0.107 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6012275218963623
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.598163604736328
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.564262866973877
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6239991188049316
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.982 Test Loss: 0.157 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9826710224151611
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.248 Vali Acc: 0.965 Test Loss: 0.248 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.725266933441162
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.985 Test Loss: 0.113 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 2.064316511154175
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.258 Vali Acc: 0.978 Test Loss: 0.258 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7634782791137695
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.408 Vali Acc: 0.939 Test Loss: 0.408 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3769967555999756
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.200 Vali Acc: 0.971 Test Loss: 0.200 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8747596740722656
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.985 Test Loss: 0.108 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 23 cost time: 1.8914482593536377
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.158 Vali Acc: 0.985 Test Loss: 0.158 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9067597389221191
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.985 Test Loss: 0.149 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0812225341796875
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7315518856048584
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.181 Vali Acc: 0.978 Test Loss: 0.181 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8317513465881348
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.168 Vali Acc: 0.983 Test Loss: 0.168 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.6496310234069824
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.152 Vali Acc: 0.987 Test Loss: 0.152 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986767).  Saving model ...
Epoch: 29 cost time: 1.8964498043060303
Epoch: 29, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.233 Vali Acc: 0.979 Test Loss: 0.233 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.894402027130127
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.9984898567199707
Epoch: 31, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.225 Vali Acc: 0.978 Test Loss: 0.225 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.04164981842041
Epoch: 32, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.251 Vali Acc: 0.971 Test Loss: 0.251 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.6070549488067627
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.981 Test Loss: 0.191 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.895402431488037
Epoch: 34, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8224503993988037
Epoch: 35, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.983 Test Loss: 0.158 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.8120319843292236
Epoch: 36, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.986 Test Loss: 0.128 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.6835665702819824
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.0217559337615967
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.988 Test Loss: 0.107 Test Acc: 0.988
Validation loss decreased (-0.986767 --> -0.988160).  Saving model ...
Epoch: 39 cost time: 2.6400983333587646
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.0380306243896484
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.988 Test Loss: 0.103 Test Acc: 0.988
Validation loss decreased (-0.988160 --> -0.988161).  Saving model ...
Epoch: 41 cost time: 2.7870984077453613
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.990 Test Loss: 0.108 Test Acc: 0.990
Validation loss decreased (-0.988161 --> -0.989553).  Saving model ...
Epoch: 42 cost time: 1.922994613647461
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.990 Test Loss: 0.121 Test Acc: 0.990
Validation loss decreased (-0.989553 --> -0.990249).  Saving model ...
Epoch: 43 cost time: 1.8033065795898438
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.990 Test Loss: 0.099 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.225489616394043
Epoch: 44, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.990 Test Loss: 0.126 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.9707765579223633
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.987 Test Loss: 0.122 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.9378514289855957
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.988 Test Loss: 0.119 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.8718624114990234
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.989 Test Loss: 0.121 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.8738656044006348
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.990 Test Loss: 0.120 Test Acc: 0.990
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.1216962337493896
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.990 Test Loss: 0.115 Test Acc: 0.990
Validation loss decreased (-0.990249 --> -0.990250).  Saving model ...
Epoch: 50 cost time: 2.053433656692505
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.990 Test Loss: 0.116 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 29551124
model size : 127.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.861614465713501
Epoch: 1, Steps: 89 | Train Loss: 1.557 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
Validation loss decreased (inf --> -0.869772).  Saving model ...
Epoch: 2 cost time: 3.101815938949585
Epoch: 2, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.869772 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 3.9126439094543457
Epoch: 3, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.941502 --> -0.949858).  Saving model ...
Epoch: 4 cost time: 4.011767148971558
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.233 Vali Acc: 0.954 Test Loss: 0.233 Test Acc: 0.954
Validation loss decreased (-0.949858 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 2.5040671825408936
Epoch: 5, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.231 Vali Acc: 0.964 Test Loss: 0.231 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.963786).  Saving model ...
Epoch: 6 cost time: 2.4769062995910645
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.245 Vali Acc: 0.962 Test Loss: 0.245 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3831918239593506
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.499 Vali Acc: 0.925 Test Loss: 0.499 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4413626194000244
Epoch: 8, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.963786 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 3.867824077606201
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.970054 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 3.7652535438537598
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.285 Vali Acc: 0.965 Test Loss: 0.285 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.027426481246948
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9413349628448486
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.292 Vali Acc: 0.972 Test Loss: 0.292 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7388625144958496
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.182 Vali Acc: 0.981 Test Loss: 0.182 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981196).  Saving model ...
Epoch: 14 cost time: 3.967888355255127
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.251 Vali Acc: 0.972 Test Loss: 0.251 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4657506942749023
Epoch: 15, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.250 Vali Acc: 0.973 Test Loss: 0.250 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.452953338623047
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.383 Vali Acc: 0.962 Test Loss: 0.383 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.458627462387085
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.282 Vali Acc: 0.969 Test Loss: 0.282 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4162447452545166
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.240 Vali Acc: 0.976 Test Loss: 0.240 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4375784397125244
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.532 Vali Acc: 0.946 Test Loss: 0.532 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3977904319763184
Epoch: 20, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.431 Vali Acc: 0.956 Test Loss: 0.431 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.16298246383667
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.168 Vali Acc: 0.984 Test Loss: 0.168 Test Acc: 0.984
Validation loss decreased (-0.981196 --> -0.983982).  Saving model ...
Epoch: 22 cost time: 2.436694860458374
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.984 Test Loss: 0.182 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.404141902923584
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.978 Test Loss: 0.190 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.29050350189209
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.973 Test Loss: 0.227 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.003725051879883
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.979 Test Loss: 0.185 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.704976797103882
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.255 Vali Acc: 0.971 Test Loss: 0.255 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.078495264053345
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.205557823181152
Epoch: 28, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.982 Test Loss: 0.185 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.448225498199463
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.302 Vali Acc: 0.974 Test Loss: 0.302 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.5139858722686768
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.221 Vali Acc: 0.967 Test Loss: 0.221 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.4469082355499268
Epoch: 31, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.211 Vali Acc: 0.983 Test Loss: 0.211 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 30031124
model size : 129.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0390615463256836
Epoch: 1, Steps: 89 | Train Loss: 1.674 Vali Loss: 0.422 Vali Acc: 0.880 Test Loss: 0.422 Test Acc: 0.880
Validation loss decreased (inf --> -0.879522).  Saving model ...
Epoch: 2 cost time: 2.8641011714935303
Epoch: 2, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.245 Vali Acc: 0.932 Test Loss: 0.245 Test Acc: 0.932
Validation loss decreased (-0.879522 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 3.3139305114746094
Epoch: 3, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
Validation loss decreased (-0.931752 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 1.990678310394287
Epoch: 4, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
Validation loss decreased (-0.954733 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 3.3237087726593018
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.301 Vali Acc: 0.936 Test Loss: 0.301 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0282013416290283
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.981874942779541
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975625).  Saving model ...
Epoch: 8 cost time: 2.103381633758545
Epoch: 8, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9576654434204102
Epoch: 9, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8400771617889404
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 2.1383912563323975
Epoch: 11, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.253 Vali Acc: 0.957 Test Loss: 0.253 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0138511657714844
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0228207111358643
Epoch: 13, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0132436752319336
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9782021045684814
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.286 Vali Acc: 0.962 Test Loss: 0.286 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.485590696334839
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.164 Vali Acc: 0.982 Test Loss: 0.164 Test Acc: 0.982
Validation loss decreased (-0.976322 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 3.057680606842041
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.149 Vali Acc: 0.982 Test Loss: 0.149 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 18 cost time: 2.940175771713257
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5347859859466553
Epoch: 19, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.347 Vali Acc: 0.962 Test Loss: 0.347 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.877387523651123
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.985375).  Saving model ...
Epoch: 21 cost time: 3.247502565383911
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.982 Test Loss: 0.174 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.905445098876953
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.966 Test Loss: 0.248 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9097414016723633
Epoch: 23, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.314 Vali Acc: 0.951 Test Loss: 0.314 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.903277635574341
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.225 Vali Acc: 0.973 Test Loss: 0.225 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.881427764892578
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.4690215587615967
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.467 Vali Acc: 0.948 Test Loss: 0.467 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0563573837280273
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.252 Vali Acc: 0.974 Test Loss: 0.252 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7899250984191895
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.978 Test Loss: 0.214 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.100311279296875
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.979 Test Loss: 0.242 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.104031801223755
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.306 Vali Acc: 0.978 Test Loss: 0.306 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 29726996
model size : 128.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.196669340133667
Epoch: 1, Steps: 89 | Train Loss: 1.946 Vali Loss: 0.518 Vali Acc: 0.853 Test Loss: 0.518 Test Acc: 0.853
Validation loss decreased (inf --> -0.853059).  Saving model ...
Epoch: 2 cost time: 3.0467231273651123
Epoch: 2, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.853059 --> -0.944287).  Saving model ...
Epoch: 3 cost time: 2.0465035438537598
Epoch: 3, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.944287 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 2.0137522220611572
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.954037 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 2.6008641719818115
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 2.938981533050537
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.3194003105163574
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.946547508239746
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.216789484024048
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0188207626342773
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.850851058959961
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0247139930725098
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 1.9553546905517578
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9053223133087158
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 15 cost time: 1.961108684539795
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 16 cost time: 1.924060344696045
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7930357456207275
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7927393913269043
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8083233833312988
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983286).  Saving model ...
Epoch: 20 cost time: 1.978851079940796
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8765270709991455
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7636146545410156
Epoch: 22, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.096 Vali Acc: 0.985 Test Loss: 0.096 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 23 cost time: 2.801572561264038
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6699373722076416
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 25 cost time: 1.8845736980438232
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0760726928710938
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.984 Test Loss: 0.133 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.735138416290283
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0333566665649414
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.072169780731201
Epoch: 29, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.979 Test Loss: 0.156 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8181850910186768
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.153 Vali Acc: 0.985 Test Loss: 0.153 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.171135187149048
Epoch: 31, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.981 Test Loss: 0.158 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.9261889457702637
Epoch: 32, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.985 Test Loss: 0.166 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4414055347442627
Epoch: 33, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.981 Test Loss: 0.157 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.8833911418914795
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.260 Vali Acc: 0.969 Test Loss: 0.260 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 29541140
model size : 127.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.566749334335327
Epoch: 1, Steps: 89 | Train Loss: 1.581 Vali Loss: 0.853 Vali Acc: 0.790 Test Loss: 0.853 Test Acc: 0.790
Validation loss decreased (inf --> -0.789685).  Saving model ...
Epoch: 2 cost time: 4.090460538864136
Epoch: 2, Steps: 89 | Train Loss: 0.436 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.789685 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 2.4930179119110107
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
Validation loss decreased (-0.930359 --> -0.934537).  Saving model ...
Epoch: 4 cost time: 3.925427198410034
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.934537 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 4.469096660614014
Epoch: 5, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
Validation loss decreased (-0.958912 --> -0.968661).  Saving model ...
Epoch: 6 cost time: 2.3434648513793945
Epoch: 6, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.406 Vali Acc: 0.939 Test Loss: 0.406 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.643639326095581
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.243 Vali Acc: 0.962 Test Loss: 0.243 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2289867401123047
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.374978303909302
Epoch: 9, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
Validation loss decreased (-0.968661 --> -0.976321).  Saving model ...
Epoch: 10 cost time: 3.427215576171875
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.307 Vali Acc: 0.954 Test Loss: 0.307 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.323836326599121
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6716387271881104
Epoch: 12, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.278 Vali Acc: 0.959 Test Loss: 0.278 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.321122884750366
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.159 Vali Acc: 0.983 Test Loss: 0.159 Test Acc: 0.983
Validation loss decreased (-0.976321 --> -0.982589).  Saving model ...
Epoch: 14 cost time: 2.405574083328247
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.978 Test Loss: 0.176 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5215933322906494
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.251 Vali Acc: 0.976 Test Loss: 0.251 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.134693384170532
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.173 Vali Acc: 0.982 Test Loss: 0.173 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.735935926437378
Epoch: 17, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.976 Test Loss: 0.225 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.008012294769287
Epoch: 18, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.302 Vali Acc: 0.959 Test Loss: 0.302 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.700694561004639
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.261 Vali Acc: 0.974 Test Loss: 0.261 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.377100706100464
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.266 Vali Acc: 0.964 Test Loss: 0.266 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.771679162979126
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.121091604232788
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.965 Test Loss: 0.329 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.39026141166687
Epoch: 23, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.976 Test Loss: 0.246 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 30038036
model size : 129.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.965404033660889
Epoch: 1, Steps: 89 | Train Loss: 1.657 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (inf --> -0.874647).  Saving model ...
Epoch: 2 cost time: 2.190882921218872
Epoch: 2, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.231 Vali Acc: 0.945 Test Loss: 0.231 Test Acc: 0.945
Validation loss decreased (-0.874647 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 3.77775239944458
Epoch: 3, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.944984 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 3.180279016494751
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.963090 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 1.8921072483062744
Epoch: 5, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 1.915405511856079
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.219 Vali Acc: 0.962 Test Loss: 0.219 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.944122076034546
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.967965 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 1.9445536136627197
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.266 Vali Acc: 0.960 Test Loss: 0.266 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0165650844573975
Epoch: 9, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 3.3995673656463623
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.873609781265259
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.280 Vali Acc: 0.961 Test Loss: 0.280 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9608757495880127
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979803).  Saving model ...
Epoch: 13 cost time: 2.9183759689331055
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9903595447540283
Epoch: 14, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.982 Test Loss: 0.150 Test Acc: 0.982
Validation loss decreased (-0.979803 --> -0.981893).  Saving model ...
Epoch: 15 cost time: 2.972275972366333
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.987 Test Loss: 0.119 Test Acc: 0.987
Validation loss decreased (-0.981893 --> -0.987464).  Saving model ...
Epoch: 16 cost time: 1.987293004989624
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.978 Test Loss: 0.186 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7866790294647217
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.021949052810669
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.178 Vali Acc: 0.974 Test Loss: 0.178 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.0622782707214355
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.242 Vali Acc: 0.972 Test Loss: 0.242 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.138685464859009
Epoch: 20, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.305 Vali Acc: 0.969 Test Loss: 0.305 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6043989658355713
Epoch: 21, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.232 Vali Acc: 0.976 Test Loss: 0.232 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.35675311088562
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.977 Test Loss: 0.219 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2660515308380127
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.984 Test Loss: 0.159 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9866878986358643
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.067704200744629
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29733908
model size : 128.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.187593698501587
Epoch: 1, Steps: 89 | Train Loss: 1.918 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
Validation loss decreased (inf --> -0.827989).  Saving model ...
Epoch: 2 cost time: 2.0168297290802
Epoch: 2, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.211 Vali Acc: 0.945 Test Loss: 0.211 Test Acc: 0.945
Validation loss decreased (-0.827989 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 1.9497575759887695
Epoch: 3, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
Validation loss decreased (-0.944984 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 2.5394208431243896
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970055).  Saving model ...
Epoch: 5 cost time: 1.793748378753662
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.970055 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 2.9697365760803223
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.196561574935913
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.928621292114258
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.985375).  Saving model ...
Epoch: 9 cost time: 2.566136121749878
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.238783836364746
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.986 Test Loss: 0.099 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 11 cost time: 2.4150969982147217
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9588868618011475
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.683727741241455
Epoch: 13, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9907822608947754
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7948288917541504
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.083 Vali Acc: 0.988 Test Loss: 0.083 Test Acc: 0.988
Validation loss decreased (-0.986071 --> -0.988161).  Saving model ...
Epoch: 16 cost time: 1.9339118003845215
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.757129192352295
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8387904167175293
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7973949909210205
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.900928020477295
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7861192226409912
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8277933597564697
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.987 Test Loss: 0.129 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8068151473999023
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.196 Vali Acc: 0.969 Test Loss: 0.196 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6689598560333252
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9557068347930908
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.225 Vali Acc: 0.968 Test Loss: 0.225 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 29531156
model size : 127.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.473623275756836
Epoch: 1, Steps: 89 | Train Loss: 1.518 Vali Loss: 0.414 Vali Acc: 0.880 Test Loss: 0.414 Test Acc: 0.880
Validation loss decreased (inf --> -0.879522).  Saving model ...
Epoch: 2 cost time: 2.251739263534546
Epoch: 2, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.879522 --> -0.902504).  Saving model ...
Epoch: 3 cost time: 2.248342275619507
Epoch: 3, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.902504 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 2.268764019012451
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.933145 --> -0.949162).  Saving model ...
Epoch: 5 cost time: 2.2595574855804443
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.949162 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 2.409619092941284
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.334 Vali Acc: 0.919 Test Loss: 0.334 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2807226181030273
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
Validation loss decreased (-0.954037 --> -0.971446).  Saving model ...
Epoch: 8 cost time: 2.2957661151885986
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3166682720184326
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.386730194091797
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.229 Vali Acc: 0.947 Test Loss: 0.229 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.340982437133789
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.971446 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 2.3600869178771973
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4475345611572266
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.326 Vali Acc: 0.948 Test Loss: 0.326 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3537423610687256
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
Validation loss decreased (-0.974233 --> -0.983286).  Saving model ...
Epoch: 15 cost time: 2.387810707092285
Epoch: 15, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.380528450012207
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.964 Test Loss: 0.235 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.361037254333496
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.293 Vali Acc: 0.954 Test Loss: 0.293 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.287229061126709
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.258 Vali Acc: 0.963 Test Loss: 0.258 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4468677043914795
Epoch: 19, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.183 Vali Acc: 0.980 Test Loss: 0.183 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.272874116897583
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.368 Vali Acc: 0.966 Test Loss: 0.368 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.421940803527832
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3519444465637207
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.983 Test Loss: 0.181 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.3958990573883057
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.297 Vali Acc: 0.974 Test Loss: 0.297 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4809083938598633
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.230 Vali Acc: 0.974 Test Loss: 0.230 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 30034964
model size : 129.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1981074810028076
Epoch: 1, Steps: 89 | Train Loss: 1.760 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
Validation loss decreased (inf --> -0.839131).  Saving model ...
Epoch: 2 cost time: 2.041069269180298
Epoch: 2, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
Validation loss decreased (-0.839131 --> -0.918521).  Saving model ...
Epoch: 3 cost time: 2.0288593769073486
Epoch: 3, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.918521 --> -0.925485).  Saving model ...
Epoch: 4 cost time: 2.064304828643799
Epoch: 4, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.925485 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 2.0186612606048584
Epoch: 5, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 1.7292823791503906
Epoch: 6, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 1.9202213287353516
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.964483 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 2.039566993713379
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8000085353851318
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.832 Vali Acc: 0.888 Test Loss: 0.832 Test Acc: 0.888
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9050476551055908
Epoch: 10, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.886709213256836
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.964483 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 1.8882510662078857
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8847477436065674
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.002579689025879
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.224 Vali Acc: 0.961 Test Loss: 0.224 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8940715789794922
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.564 Vali Acc: 0.928 Test Loss: 0.564 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.931959629058838
Epoch: 16, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.220 Vali Acc: 0.969 Test Loss: 0.220 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.895124912261963
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1050920486450195
Epoch: 18, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.314 Vali Acc: 0.958 Test Loss: 0.314 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.886603593826294
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.070490598678589
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
Validation loss decreased (-0.975626 --> -0.982589).  Saving model ...
Epoch: 21 cost time: 1.9360058307647705
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0097475051879883
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9440836906433105
Epoch: 23, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983286).  Saving model ...
Epoch: 24 cost time: 1.8868017196655273
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7704970836639404
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8658277988433838
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.236 Vali Acc: 0.963 Test Loss: 0.236 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0785136222839355
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8628666400909424
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8453404903411865
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.944 Test Loss: 0.418 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.880638837814331
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.026761293411255
Epoch: 31, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.978 Test Loss: 0.189 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.014694929122925
Epoch: 32, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.985 Test Loss: 0.126 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 33 cost time: 1.8690402507781982
Epoch: 33, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.194 Vali Acc: 0.973 Test Loss: 0.194 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9104554653167725
Epoch: 34, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 35 cost time: 1.8492419719696045
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.854341745376587
Epoch: 36, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.237 Vali Acc: 0.971 Test Loss: 0.237 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.131911277770996
Epoch: 37, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.979 Test Loss: 0.183 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.056823253631592
Epoch: 38, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.216 Vali Acc: 0.974 Test Loss: 0.216 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.99344801902771
Epoch: 39, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.002232313156128
Epoch: 40, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 41 cost time: 1.9805078506469727
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9984476566314697
Epoch: 42, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.306 Vali Acc: 0.964 Test Loss: 0.306 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9115052223205566
Epoch: 43, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.999391794204712
Epoch: 44, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9617893695831299
Epoch: 45, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.904402494430542
Epoch: 46, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.8929839134216309
Epoch: 47, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.183 Vali Acc: 0.979 Test Loss: 0.183 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.8243117332458496
Epoch: 48, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.984 Test Loss: 0.170 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.9333105087280273
Epoch: 49, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.340 Vali Acc: 0.965 Test Loss: 0.340 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.8565969467163086
Epoch: 50, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.184 Vali Acc: 0.983 Test Loss: 0.184 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29680148
model size : 127.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8316333293914795
Epoch: 1, Steps: 89 | Train Loss: 2.077 Vali Loss: 0.537 Vali Acc: 0.843 Test Loss: 0.537 Test Acc: 0.843
Validation loss decreased (inf --> -0.843309).  Saving model ...
Epoch: 2 cost time: 2.12722110748291
Epoch: 2, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.269 Vali Acc: 0.921 Test Loss: 0.269 Test Acc: 0.921
Validation loss decreased (-0.843309 --> -0.921307).  Saving model ...
Epoch: 3 cost time: 1.9426145553588867
Epoch: 3, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.921307 --> -0.974233).  Saving model ...
Epoch: 4 cost time: 1.83734130859375
Epoch: 4, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7764687538146973
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9338102340698242
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.184136152267456
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1025166511535645
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9999959468841553
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.934943437576294
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 2.0743730068206787
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9057910442352295
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8973336219787598
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0535974502563477
Epoch: 14, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0563957691192627
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.966 Test Loss: 0.224 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9717230796813965
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
Validation loss decreased (-0.981197 --> -0.983982).  Saving model ...
Epoch: 17 cost time: 1.9399986267089844
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.798659086227417
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.987464).  Saving model ...
Epoch: 19 cost time: 1.8272731304168701
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7414774894714355
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8066880702972412
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.971 Test Loss: 0.186 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9609062671661377
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.275 Vali Acc: 0.956 Test Loss: 0.275 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9583704471588135
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.854691505432129
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.175 Vali Acc: 0.974 Test Loss: 0.175 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9681971073150635
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9559993743896484
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.981 Test Loss: 0.163 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.726719617843628
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0082223415374756
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.204 Vali Acc: 0.971 Test Loss: 0.204 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29511188
model size : 127.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.338379383087158
Epoch: 1, Steps: 89 | Train Loss: 1.650 Vali Loss: 0.535 Vali Acc: 0.852 Test Loss: 0.535 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 2.0080201625823975
Epoch: 2, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.284 Vali Acc: 0.924 Test Loss: 0.284 Test Acc: 0.924
Validation loss decreased (-0.852362 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 1.9953672885894775
Epoch: 3, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
Validation loss decreased (-0.924092 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 2.1781551837921143
Epoch: 4, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.09358811378479
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.247 Vali Acc: 0.953 Test Loss: 0.247 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.953340).  Saving model ...
Epoch: 6 cost time: 2.2529990673065186
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.090550422668457
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.198 Vali Acc: 0.973 Test Loss: 0.198 Test Acc: 0.973
Validation loss decreased (-0.953340 --> -0.972839).  Saving model ...
Epoch: 8 cost time: 2.0945885181427
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.196385145187378
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
Validation loss decreased (-0.972839 --> -0.974232).  Saving model ...
Epoch: 10 cost time: 2.1126654148101807
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.974232 --> -0.979804).  Saving model ...
Epoch: 11 cost time: 2.0437440872192383
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.184 Vali Acc: 0.981 Test Loss: 0.184 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 12 cost time: 2.0561139583587646
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1304359436035156
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.199 Vali Acc: 0.971 Test Loss: 0.199 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1505722999572754
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.142322063446045
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0978925228118896
Epoch: 16, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.009049415588379
Epoch: 17, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.561 Vali Acc: 0.934 Test Loss: 0.561 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.109912395477295
Epoch: 18, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.231950521469116
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.194 Vali Acc: 0.978 Test Loss: 0.194 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1402952671051025
Epoch: 20, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.274 Vali Acc: 0.970 Test Loss: 0.274 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.131274461746216
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.626 Vali Acc: 0.928 Test Loss: 0.626 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 29906708
model size : 128.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9397168159484863
Epoch: 1, Steps: 89 | Train Loss: 1.825 Vali Loss: 0.454 Vali Acc: 0.857 Test Loss: 0.454 Test Acc: 0.857
Validation loss decreased (inf --> -0.856541).  Saving model ...
Epoch: 2 cost time: 1.9748451709747314
Epoch: 2, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.856541 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 1.9378280639648438
Epoch: 3, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.937324 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 2.1106631755828857
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.948466 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.1882777214050293
Epoch: 5, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9861290454864502
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.947819471359253
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.010136842727661
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 2.009619951248169
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8532793521881104
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
Validation loss decreased (-0.977018 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 2.0011117458343506
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9792752265930176
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7105047702789307
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 14 cost time: 2.078139066696167
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.984 Test Loss: 0.109 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.000683546066284
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0834670066833496
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.006190538406372
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0348010063171387
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8436520099639893
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.981 Test Loss: 0.170 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9767980575561523
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.990 Test Loss: 0.093 Test Acc: 0.990
Validation loss decreased (-0.984679 --> -0.990250).  Saving model ...
Epoch: 21 cost time: 1.906783103942871
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.984 Test Loss: 0.128 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9675037860870361
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.132 Vali Acc: 0.983 Test Loss: 0.132 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8915839195251465
Epoch: 23, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.108 Vali Acc: 0.985 Test Loss: 0.108 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9517548084259033
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.981 Test Loss: 0.208 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0195376873016357
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.986 Test Loss: 0.120 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.940436840057373
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9541621208190918
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.985 Test Loss: 0.150 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8395795822143555
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.160 Vali Acc: 0.983 Test Loss: 0.160 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8252177238464355
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8592510223388672
Epoch: 30, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.198 Vali Acc: 0.981 Test Loss: 0.198 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 29653268
model size : 127.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8671936988830566
Epoch: 1, Steps: 89 | Train Loss: 2.119 Vali Loss: 0.577 Vali Acc: 0.827 Test Loss: 0.577 Test Acc: 0.827
Validation loss decreased (inf --> -0.827292).  Saving model ...
Epoch: 2 cost time: 1.7800319194793701
Epoch: 2, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.827292 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 1.9875094890594482
Epoch: 3, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.937324 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 1.936129093170166
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.951948 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 1.7528605461120605
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.974929 --> -0.983983).  Saving model ...
Epoch: 6 cost time: 1.8467576503753662
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.754822015762329
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.741011142730713
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.678189992904663
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8269565105438232
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.983983 --> -0.986768).  Saving model ...
Epoch: 11 cost time: 1.8888351917266846
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6752381324768066
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.055 Vali Acc: 0.992 Test Loss: 0.055 Test Acc: 0.992
Validation loss decreased (-0.986768 --> -0.991643).  Saving model ...
Epoch: 13 cost time: 2.007990598678589
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8912625312805176
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.804290533065796
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.060 Vali Acc: 0.989 Test Loss: 0.060 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8647501468658447
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9738717079162598
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.024168014526367
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0656728744506836
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8216311931610107
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8446006774902344
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.982 Test Loss: 0.111 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8347666263580322
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.989 Test Loss: 0.088 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9916434540389972
model parameter : 29501204
model size : 127.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1990268230438232
Epoch: 1, Steps: 89 | Train Loss: 1.592 Vali Loss: 0.511 Vali Acc: 0.867 Test Loss: 0.511 Test Acc: 0.867
Validation loss decreased (inf --> -0.866987).  Saving model ...
Epoch: 2 cost time: 2.048845052719116
Epoch: 2, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.366 Vali Acc: 0.902 Test Loss: 0.366 Test Acc: 0.902
Validation loss decreased (-0.866987 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 2.1329283714294434
Epoch: 3, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.901807 --> -0.937323).  Saving model ...
Epoch: 4 cost time: 2.036370277404785
Epoch: 4, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.937323 --> -0.943590).  Saving model ...
Epoch: 5 cost time: 2.0158095359802246
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
Validation loss decreased (-0.943590 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 2.0276052951812744
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9530093669891357
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.275 Vali Acc: 0.953 Test Loss: 0.275 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.31459641456604
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.086806535720825
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2124688625335693
Epoch: 10, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1043553352355957
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.248 Vali Acc: 0.969 Test Loss: 0.248 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1299185752868652
Epoch: 12, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.177 Vali Acc: 0.978 Test Loss: 0.177 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.977714).  Saving model ...
Epoch: 13 cost time: 2.1487154960632324
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.251 Vali Acc: 0.960 Test Loss: 0.251 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1260225772857666
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.192 Vali Acc: 0.977 Test Loss: 0.192 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.156212568283081
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.976 Test Loss: 0.208 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1234912872314453
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.282 Vali Acc: 0.967 Test Loss: 0.282 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1266515254974365
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.176 Vali Acc: 0.981 Test Loss: 0.176 Test Acc: 0.981
Validation loss decreased (-0.977714 --> -0.981196).  Saving model ...
Epoch: 18 cost time: 2.127013921737671
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.985 Test Loss: 0.156 Test Acc: 0.985
Validation loss decreased (-0.981196 --> -0.985374).  Saving model ...
Epoch: 19 cost time: 2.1218068599700928
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.990 Test Loss: 0.121 Test Acc: 0.990
Validation loss decreased (-0.985374 --> -0.990249).  Saving model ...
Epoch: 20 cost time: 2.090273141860962
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.282 Vali Acc: 0.970 Test Loss: 0.282 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1170272827148438
Epoch: 21, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.226 Vali Acc: 0.971 Test Loss: 0.226 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0344414710998535
Epoch: 22, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.220 Vali Acc: 0.961 Test Loss: 0.220 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.109349012374878
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.978 Test Loss: 0.226 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.161362409591675
Epoch: 24, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.440 Vali Acc: 0.953 Test Loss: 0.440 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1156277656555176
Epoch: 25, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.292 Vali Acc: 0.962 Test Loss: 0.292 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1513402462005615
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.974 Test Loss: 0.246 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1326181888580322
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.987 Test Loss: 0.164 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.141317367553711
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.191 Vali Acc: 0.984 Test Loss: 0.191 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1223065853118896
Epoch: 29, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.424 Vali Acc: 0.962 Test Loss: 0.424 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 29903636
model size : 128.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1392955780029297
Epoch: 1, Steps: 89 | Train Loss: 1.914 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
Validation loss decreased (inf --> -0.841220).  Saving model ...
Epoch: 2 cost time: 1.8439621925354004
Epoch: 2, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
Validation loss decreased (-0.841220 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 1.921321153640747
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.955430 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 1.925567865371704
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9346976280212402
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 1.8694136142730713
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.970054 --> -0.975626).  Saving model ...
Epoch: 7 cost time: 1.838620662689209
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7431018352508545
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
Validation loss decreased (-0.975626 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 1.829197883605957
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.843585729598999
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.212 Vali Acc: 0.965 Test Loss: 0.212 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5901761054992676
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.913924217224121
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9811880588531494
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.828737735748291
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 15 cost time: 1.757127285003662
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.974 Test Loss: 0.180 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9160561561584473
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.981 Test Loss: 0.136 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6329126358032227
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.985375).  Saving model ...
Epoch: 18 cost time: 1.8607311248779297
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8718326091766357
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.969 Test Loss: 0.192 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6707892417907715
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7010738849639893
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7341055870056152
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.988 Test Loss: 0.094 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 23 cost time: 1.979952096939087
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.984 Test Loss: 0.131 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8053596019744873
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8715925216674805
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.969 Test Loss: 0.213 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.917311668395996
Epoch: 26, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.162 Vali Acc: 0.981 Test Loss: 0.162 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7768957614898682
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7614824771881104
Epoch: 28, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.983 Test Loss: 0.129 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9190666675567627
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8919758796691895
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9053263664245605
Epoch: 31, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.141 Vali Acc: 0.983 Test Loss: 0.141 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9438116550445557
Epoch: 32, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.227 Vali Acc: 0.979 Test Loss: 0.227 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 29633300
model size : 127.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.110846996307373
Epoch: 1, Steps: 89 | Train Loss: 2.102 Vali Loss: 0.619 Vali Acc: 0.834 Test Loss: 0.619 Test Acc: 0.834
Validation loss decreased (inf --> -0.834256).  Saving model ...
Epoch: 2 cost time: 1.756286382675171
Epoch: 2, Steps: 89 | Train Loss: 0.426 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.834256 --> -0.956126).  Saving model ...
Epoch: 3 cost time: 1.9668800830841064
Epoch: 3, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.568124532699585
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.956126 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 1.9393928050994873
Epoch: 5, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.968662 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 1.8691682815551758
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 1.762345314025879
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7088582515716553
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 1.6319844722747803
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.974 Test Loss: 0.165 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6856117248535156
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 1.8415014743804932
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.724456548690796
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7097272872924805
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6727447509765625
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 15 cost time: 1.8593554496765137
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.985 Test Loss: 0.093 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 16 cost time: 1.9298133850097656
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9349167346954346
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8160111904144287
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7237441539764404
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8069427013397217
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.121 Vali Acc: 0.984 Test Loss: 0.121 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7589397430419922
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.988 Test Loss: 0.086 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 22 cost time: 1.8299534320831299
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7657496929168701
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.986 Test Loss: 0.095 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6902844905853271
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.990 Test Loss: 0.088 Test Acc: 0.990
Validation loss decreased (-0.988161 --> -0.990250).  Saving model ...
Epoch: 25 cost time: 1.755690574645996
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.961 Test Loss: 0.310 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.751692771911621
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8736302852630615
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6066434383392334
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9119601249694824
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.796649694442749
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.245 Vali Acc: 0.971 Test Loss: 0.245 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.787290334701538
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7199592590332031
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.096 Vali Acc: 0.989 Test Loss: 0.096 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.625986099243164
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.984 Test Loss: 0.112 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.8395624160766602
Epoch: 34, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 29498132
model size : 127.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.366361618041992
Epoch: 1, Steps: 89 | Train Loss: 1.621 Vali Loss: 0.493 Vali Acc: 0.859 Test Loss: 0.493 Test Acc: 0.859
Validation loss decreased (inf --> -0.858630).  Saving model ...
Epoch: 2 cost time: 1.873596429824829
Epoch: 2, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.300 Vali Acc: 0.928 Test Loss: 0.300 Test Acc: 0.928
Validation loss decreased (-0.858630 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 1.8171792030334473
Epoch: 3, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.927574 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 1.8717615604400635
Epoch: 4, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.337 Vali Acc: 0.931 Test Loss: 0.337 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8879461288452148
Epoch: 5, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972143).  Saving model ...
Epoch: 6 cost time: 1.9071424007415771
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.205 Vali Acc: 0.947 Test Loss: 0.205 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9263885021209717
Epoch: 7, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
Validation loss decreased (-0.972143 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 2.148810625076294
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.975592851638794
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9519734382629395
Epoch: 10, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.846208095550537
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.958 Test Loss: 0.208 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9535443782806396
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 1.9183104038238525
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8790218830108643
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9179120063781738
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9751882553100586
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.144 Vali Acc: 0.981 Test Loss: 0.144 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.007157564163208
Epoch: 17, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.140 Vali Acc: 0.984 Test Loss: 0.140 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 18 cost time: 1.9998981952667236
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.985 Test Loss: 0.132 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 1.9781322479248047
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.341 Vali Acc: 0.955 Test Loss: 0.341 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.047025203704834
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.171 Vali Acc: 0.985 Test Loss: 0.171 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9458529949188232
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.173 Vali Acc: 0.984 Test Loss: 0.173 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9757394790649414
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9740350246429443
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.221 Vali Acc: 0.967 Test Loss: 0.221 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9170022010803223
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8715531826019287
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.099 Vali Acc: 0.986 Test Loss: 0.099 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 26 cost time: 1.8707780838012695
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.987 Test Loss: 0.144 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.987464).  Saving model ...
Epoch: 27 cost time: 1.8678662776947021
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.987 Test Loss: 0.133 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9331250190734863
Epoch: 28, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0811104774475098
Epoch: 29, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7930541038513184
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.985 Test Loss: 0.138 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9303302764892578
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.229038953781128
Epoch: 32, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.188 Vali Acc: 0.978 Test Loss: 0.188 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.2733776569366455
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.290 Vali Acc: 0.958 Test Loss: 0.290 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9348890781402588
Epoch: 34, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.211 Vali Acc: 0.984 Test Loss: 0.211 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.086021661758423
Epoch: 35, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.216 Vali Acc: 0.979 Test Loss: 0.216 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.114302396774292
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.985 Test Loss: 0.212 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29816084
model size : 128.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9291162490844727
Epoch: 1, Steps: 89 | Train Loss: 1.881 Vali Loss: 0.812 Vali Acc: 0.786 Test Loss: 0.812 Test Acc: 0.786
Validation loss decreased (inf --> -0.786204).  Saving model ...
Epoch: 2 cost time: 1.8427813053131104
Epoch: 2, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
Validation loss decreased (-0.786204 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 1.9712252616882324
Epoch: 3, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.267 Vali Acc: 0.935 Test Loss: 0.267 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8222925662994385
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.941502 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 1.8618254661560059
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 1.9770827293395996
Epoch: 6, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.012066602706909
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9679808616638184
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.957132339477539
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7365071773529053
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8569364547729492
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982589).  Saving model ...
Epoch: 12 cost time: 1.8697760105133057
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9846503734588623
Epoch: 13, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9360346794128418
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8418993949890137
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.330 Vali Acc: 0.963 Test Loss: 0.330 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.828645944595337
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.830388069152832
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.985375).  Saving model ...
Epoch: 18 cost time: 1.8592884540557861
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8044850826263428
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987464).  Saving model ...
Epoch: 20 cost time: 1.9118824005126953
Epoch: 20, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9745616912841797
Epoch: 21, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9232816696166992
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.987 Test Loss: 0.099 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7513878345489502
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.990 Test Loss: 0.077 Test Acc: 0.990
Validation loss decreased (-0.987464 --> -0.990250).  Saving model ...
Epoch: 24 cost time: 1.9337172508239746
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.983 Test Loss: 0.153 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9759705066680908
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9610142707824707
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8840487003326416
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7991366386413574
Epoch: 28, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8780996799468994
Epoch: 29, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.810049057006836
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.082 Vali Acc: 0.988 Test Loss: 0.082 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8776593208312988
Epoch: 31, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8638005256652832
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7044947147369385
Epoch: 33, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 29613332
model size : 127.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1371214389801025
Epoch: 1, Steps: 89 | Train Loss: 2.222 Vali Loss: 0.686 Vali Acc: 0.779 Test Loss: 0.686 Test Acc: 0.779
Validation loss decreased (inf --> -0.779241).  Saving model ...
Epoch: 2 cost time: 2.032125473022461
Epoch: 2, Steps: 89 | Train Loss: 0.460 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
Validation loss decreased (-0.779241 --> -0.919914).  Saving model ...
Epoch: 3 cost time: 1.889847755432129
Epoch: 3, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
Validation loss decreased (-0.919914 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 1.924187183380127
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 1.92954683303833
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.972144 --> -0.981197).  Saving model ...
Epoch: 6 cost time: 1.9668989181518555
Epoch: 6, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7142629623413086
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8027095794677734
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 1.6604664325714111
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
Validation loss decreased (-0.982590 --> -0.986072).  Saving model ...
Epoch: 10 cost time: 1.8133912086486816
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8181936740875244
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8058366775512695
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8838868141174316
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.049 Vali Acc: 0.987 Test Loss: 0.049 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.987465).  Saving model ...
Epoch: 14 cost time: 1.684401512145996
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9100067615509033
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.708420753479004
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5691711902618408
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9562709331512451
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.920236349105835
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6982009410858154
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7821104526519775
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.848149299621582
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8820624351501465
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29495060
model size : 127.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.083967924118042
Epoch: 1, Steps: 89 | Train Loss: 1.708 Vali Loss: 0.525 Vali Acc: 0.846 Test Loss: 0.525 Test Acc: 0.846
Validation loss decreased (inf --> -0.846095).  Saving model ...
Epoch: 2 cost time: 1.9798698425292969
Epoch: 2, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.846095 --> -0.949859).  Saving model ...
Epoch: 3 cost time: 1.7691757678985596
Epoch: 3, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.949859 --> -0.966572).  Saving model ...
Epoch: 4 cost time: 1.9129741191864014
Epoch: 4, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.966572 --> -0.970055).  Saving model ...
Epoch: 5 cost time: 1.9743070602416992
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
Validation loss decreased (-0.970055 --> -0.981893).  Saving model ...
Epoch: 6 cost time: 1.8608369827270508
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.959749460220337
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 2.1217494010925293
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0751395225524902
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.837341070175171
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.087 Vali Acc: 0.989 Test Loss: 0.087 Test Acc: 0.989
Validation loss decreased (-0.982590 --> -0.988857).  Saving model ...
Epoch: 11 cost time: 2.023500442504883
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9861016273498535
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.241 Vali Acc: 0.967 Test Loss: 0.241 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2693450450897217
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1831276416778564
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9506335258483887
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.419 Vali Acc: 0.946 Test Loss: 0.419 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9782500267028809
Epoch: 16, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9768404960632324
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0257461071014404
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.979 Test Loss: 0.138 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9875719547271729
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9014465808868408
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 29829908
model size : 128.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.285762071609497
Epoch: 1, Steps: 89 | Train Loss: 1.877 Vali Loss: 0.580 Vali Acc: 0.814 Test Loss: 0.580 Test Acc: 0.814
Validation loss decreased (inf --> -0.814061).  Saving model ...
Epoch: 2 cost time: 1.8430674076080322
Epoch: 2, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.814061 --> -0.960305).  Saving model ...
Epoch: 3 cost time: 1.8813624382019043
Epoch: 3, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.960305 --> -0.970054).  Saving model ...
Epoch: 4 cost time: 2.0254032611846924
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 1.7912232875823975
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8182172775268555
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 1.9385323524475098
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
Validation loss decreased (-0.978411 --> -0.985375).  Saving model ...
Epoch: 8 cost time: 1.9466726779937744
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8888490200042725
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987464).  Saving model ...
Epoch: 10 cost time: 1.9744994640350342
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9164373874664307
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8547427654266357
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.995490312576294
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6821837425231934
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.334 Vali Acc: 0.951 Test Loss: 0.334 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.146540641784668
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.122 Vali Acc: 0.984 Test Loss: 0.122 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9696190357208252
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0882301330566406
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6415133476257324
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.990 Test Loss: 0.084 Test Acc: 0.990
Validation loss decreased (-0.987464 --> -0.989553).  Saving model ...
Epoch: 19 cost time: 1.9037818908691406
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7516067028045654
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.160 Vali Acc: 0.981 Test Loss: 0.160 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8331897258758545
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8720369338989258
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.929748773574829
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8484954833984375
Epoch: 24, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.195 Vali Acc: 0.968 Test Loss: 0.195 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6959724426269531
Epoch: 25, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8003957271575928
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.135 Vali Acc: 0.984 Test Loss: 0.135 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7216343879699707
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.178 Vali Acc: 0.980 Test Loss: 0.178 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8957512378692627
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.984 Test Loss: 0.152 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 29610260
model size : 127.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7980072498321533
Epoch: 1, Steps: 89 | Train Loss: 2.155 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (inf --> -0.811275).  Saving model ...
Epoch: 2 cost time: 1.7618043422698975
Epoch: 2, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.811275 --> -0.929663).  Saving model ...
Epoch: 3 cost time: 1.8025290966033936
Epoch: 3, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.929663 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 1.8382236957550049
Epoch: 4, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.766188383102417
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8610279560089111
Epoch: 6, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.968662 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 1.6936140060424805
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7577877044677734
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 9 cost time: 1.7584221363067627
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6984601020812988
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7598764896392822
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987464).  Saving model ...
Epoch: 12 cost time: 1.7498462200164795
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6830213069915771
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.87229585647583
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.896637201309204
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7510087490081787
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.803398609161377
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7918727397918701
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.842233657836914
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.772928237915039
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6988658905029297
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29491988
model size : 127.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.12092924118042
Epoch: 1, Steps: 89 | Train Loss: 1.633 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
Validation loss decreased (inf --> -0.884397).  Saving model ...
Epoch: 2 cost time: 1.8115382194519043
Epoch: 2, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.884397 --> -0.970054).  Saving model ...
Epoch: 3 cost time: 1.84834623336792
Epoch: 3, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.970054 --> -0.978411).  Saving model ...
Epoch: 4 cost time: 1.9430694580078125
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7293109893798828
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9887189865112305
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983286).  Saving model ...
Epoch: 7 cost time: 2.0296876430511475
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9354395866394043
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9458386898040771
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8276240825653076
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.183 Vali Acc: 0.978 Test Loss: 0.183 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.90753173828125
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.144 Vali Acc: 0.979 Test Loss: 0.144 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8873775005340576
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7915806770324707
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.981 Test Loss: 0.145 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8821585178375244
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7963600158691406
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.870819091796875
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 29783060
model size : 128.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0646586418151855
Epoch: 1, Steps: 89 | Train Loss: 1.844 Vali Loss: 0.438 Vali Acc: 0.886 Test Loss: 0.438 Test Acc: 0.886
Validation loss decreased (inf --> -0.885789).  Saving model ...
Epoch: 2 cost time: 1.8589074611663818
Epoch: 2, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.885789 --> -0.966572).  Saving model ...
Epoch: 3 cost time: 1.8524320125579834
Epoch: 3, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.966572 --> -0.981197).  Saving model ...
Epoch: 4 cost time: 2.0981171131134033
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 5 cost time: 2.0177807807922363
Epoch: 5, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.178 Vali Acc: 0.945 Test Loss: 0.178 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8320069313049316
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 7 cost time: 2.0827722549438477
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8552794456481934
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8064355850219727
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.879744529724121
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9629566669464111
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7731342315673828
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.247 Vali Acc: 0.960 Test Loss: 0.247 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9285435676574707
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9388229846954346
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.852247714996338
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9625520706176758
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.077 Vali Acc: 0.986 Test Loss: 0.077 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 29614100
model size : 127.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0190250873565674
Epoch: 1, Steps: 89 | Train Loss: 2.125 Vali Loss: 0.623 Vali Acc: 0.836 Test Loss: 0.623 Test Acc: 0.836
Validation loss decreased (inf --> -0.835648).  Saving model ...
Epoch: 2 cost time: 1.727109432220459
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.835648 --> -0.944288).  Saving model ...
Epoch: 3 cost time: 1.9199752807617188
Epoch: 3, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.944288 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 1.7787415981292725
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.957519 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 1.8099348545074463
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.042236089706421
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.978411 --> -0.983982).  Saving model ...
Epoch: 7 cost time: 1.7573940753936768
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9235548973083496
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8495712280273438
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 1.8921306133270264
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.053 Vali Acc: 0.986 Test Loss: 0.053 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 11 cost time: 1.860591173171997
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8223216533660889
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7311105728149414
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8152406215667725
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9644901752471924
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7865073680877686
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9320805072784424
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8257405757904053
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.470045566558838
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.981 Test Loss: 0.124 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.052790641784668
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 29512724
model size : 127.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9884939193725586
Epoch: 1, Steps: 89 | Train Loss: 1.710 Vali Loss: 0.499 Vali Acc: 0.869 Test Loss: 0.499 Test Acc: 0.869
Validation loss decreased (inf --> -0.869076).  Saving model ...
Epoch: 2 cost time: 1.8469398021697998
Epoch: 2, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.869076 --> -0.949162).  Saving model ...
Epoch: 3 cost time: 1.9450371265411377
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.949162 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 1.96268892288208
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.956126 --> -0.980500).  Saving model ...
Epoch: 5 cost time: 1.8666443824768066
Epoch: 5, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9163596630096436
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.276 Vali Acc: 0.948 Test Loss: 0.276 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9890248775482178
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
Validation loss decreased (-0.980500 --> -0.983982).  Saving model ...
Epoch: 8 cost time: 1.9683690071105957
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8338181972503662
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8887474536895752
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9033169746398926
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8715178966522217
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.886894702911377
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8357226848602295
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8637924194335938
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8733534812927246
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.898101568222046
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 29750036
model size : 128.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0571484565734863
Epoch: 1, Steps: 89 | Train Loss: 1.967 Vali Loss: 0.501 Vali Acc: 0.857 Test Loss: 0.501 Test Acc: 0.857
Validation loss decreased (inf --> -0.857237).  Saving model ...
Epoch: 2 cost time: 1.6070759296417236
Epoch: 2, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
Validation loss decreased (-0.857237 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 1.800663948059082
Epoch: 3, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.941502 --> -0.966573).  Saving model ...
Epoch: 4 cost time: 1.780385971069336
Epoch: 4, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 1.867241621017456
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 1.8102834224700928
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.979108 --> -0.986768).  Saving model ...
Epoch: 7 cost time: 1.8751304149627686
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8713634014129639
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7826614379882812
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9902195930480957
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9110872745513916
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9387526512145996
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7855010032653809
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9137852191925049
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9427664279937744
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8270866870880127
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.987 Test Loss: 0.089 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 17 cost time: 1.8086657524108887
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8461029529571533
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.981 Test Loss: 0.139 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8319861888885498
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8277323246002197
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6814913749694824
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.982 Test Loss: 0.143 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6926281452178955
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.210 Vali Acc: 0.965 Test Loss: 0.210 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8599870204925537
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7867345809936523
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7780609130859375
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9082942008972168
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 29597972
model size : 127.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8996365070343018
Epoch: 1, Steps: 89 | Train Loss: 2.233 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
Validation loss decreased (inf --> -0.782723).  Saving model ...
Epoch: 2 cost time: 1.7871358394622803
Epoch: 2, Steps: 89 | Train Loss: 0.463 Vali Loss: 0.215 Vali Acc: 0.932 Test Loss: 0.215 Test Acc: 0.932
Validation loss decreased (-0.782723 --> -0.932449).  Saving model ...
Epoch: 3 cost time: 1.8639435768127441
Epoch: 3, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.932449 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 1.858311653137207
Epoch: 4, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.950555 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 1.7624363899230957
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8231287002563477
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 2.005119800567627
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3851525783538818
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 1.7216103076934814
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 1.9201490879058838
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6666955947875977
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0007216930389404
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 2.0015082359313965
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 1.7709720134735107
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7149779796600342
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.760373830795288
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7078473567962646
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8446152210235596
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.945453405380249
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8033735752105713
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.841536521911621
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6756341457366943
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.989 Test Loss: 0.073 Test Acc: 0.989
Validation loss decreased (-0.985375 --> -0.988857).  Saving model ...
Epoch: 23 cost time: 1.782289981842041
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.985 Test Loss: 0.091 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.855731725692749
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8119072914123535
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7006638050079346
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.902275800704956
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.990 Test Loss: 0.069 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.990250).  Saving model ...
Epoch: 28 cost time: 1.8808488845825195
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7821900844573975
Epoch: 29, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7542335987091064
Epoch: 30, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8478889465332031
Epoch: 31, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8294661045074463
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7751123905181885
Epoch: 33, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8307583332061768
Epoch: 34, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7182285785675049
Epoch: 35, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8096559047698975
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.800220012664795
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.989 Test Loss: 0.074 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 29513492
model size : 127.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.025942087173462
Epoch: 1, Steps: 89 | Train Loss: 1.778 Vali Loss: 0.490 Vali Acc: 0.863 Test Loss: 0.490 Test Acc: 0.863
Validation loss decreased (inf --> -0.862808).  Saving model ...
Epoch: 2 cost time: 2.0635180473327637
Epoch: 2, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.183 Vali Acc: 0.939 Test Loss: 0.183 Test Acc: 0.939
Validation loss decreased (-0.862808 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 1.9471583366394043
Epoch: 3, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
Validation loss decreased (-0.939413 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 1.9065890312194824
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.954734 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 1.9772028923034668
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 6 cost time: 1.9689891338348389
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9596800804138184
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
Validation loss decreased (-0.977018 --> -0.986072).  Saving model ...
Epoch: 8 cost time: 1.910322666168213
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2283682823181152
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.224 Vali Acc: 0.969 Test Loss: 0.224 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8265397548675537
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9475939273834229
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8965129852294922
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.875779390335083
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.155003070831299
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.042689085006714
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9217817783355713
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.151031017303467
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 29723924
model size : 128.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0068068504333496
Epoch: 1, Steps: 89 | Train Loss: 2.035 Vali Loss: 0.572 Vali Acc: 0.821 Test Loss: 0.572 Test Acc: 0.821
Validation loss decreased (inf --> -0.821025).  Saving model ...
Epoch: 2 cost time: 1.7858216762542725
Epoch: 2, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.821025 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 1.9902043342590332
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.946377 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 1.846792459487915
Epoch: 4, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.131181478500366
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
Validation loss decreased (-0.963090 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 2.144045829772949
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.051034688949585
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 1.8944823741912842
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.986 Test Loss: 0.078 Test Acc: 0.986
Validation loss decreased (-0.980501 --> -0.986072).  Saving model ...
Epoch: 9 cost time: 1.9895274639129639
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5568645000457764
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9318900108337402
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.051 Vali Acc: 0.987 Test Loss: 0.051 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 12 cost time: 2.0088484287261963
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.069 Vali Acc: 0.988 Test Loss: 0.069 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988161).  Saving model ...
Epoch: 13 cost time: 1.8587310314178467
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6026256084442139
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8044519424438477
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8093674182891846
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9747860431671143
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9203290939331055
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.910733938217163
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7849695682525635
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8774466514587402
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8555490970611572
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.990 Test Loss: 0.094 Test Acc: 0.990
Validation loss decreased (-0.988161 --> -0.989553).  Saving model ...
Epoch: 23 cost time: 1.784430980682373
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.252 Vali Acc: 0.966 Test Loss: 0.252 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.815993309020996
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.861875295639038
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.986 Test Loss: 0.111 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8472363948822021
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.025742292404175
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.987 Test Loss: 0.098 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8819522857666016
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.990 Test Loss: 0.083 Test Acc: 0.990
Validation loss decreased (-0.989553 --> -0.989553).  Saving model ...
Epoch: 29 cost time: 1.8530259132385254
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.988 Test Loss: 0.088 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.829782485961914
Epoch: 30, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.927394151687622
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9031896591186523
Epoch: 32, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8834397792816162
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.323 Vali Acc: 0.961 Test Loss: 0.323 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.831691026687622
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8848252296447754
Epoch: 35, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.062 Vali Acc: 0.992 Test Loss: 0.062 Test Acc: 0.992
Validation loss decreased (-0.989553 --> -0.991643).  Saving model ...
Epoch: 36 cost time: 1.8964426517486572
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.990 Test Loss: 0.083 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9278526306152344
Epoch: 37, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.069 Vali Acc: 0.990 Test Loss: 0.069 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7823724746704102
Epoch: 38, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.987 Test Loss: 0.114 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8423762321472168
Epoch: 39, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.212 Vali Acc: 0.961 Test Loss: 0.212 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7686665058135986
Epoch: 40, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.787217617034912
Epoch: 41, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.878523826599121
Epoch: 42, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.989 Test Loss: 0.101 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.8620765209197998
Epoch: 43, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8270304203033447
Epoch: 44, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.881742238998413
Epoch: 45, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.076 Vali Acc: 0.990 Test Loss: 0.076 Test Acc: 0.990
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9916434540389972
model parameter : 29605652
model size : 127.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8412673473358154
Epoch: 1, Steps: 89 | Train Loss: 2.246 Vali Loss: 0.697 Vali Acc: 0.788 Test Loss: 0.697 Test Acc: 0.788
Validation loss decreased (inf --> -0.788294).  Saving model ...
Epoch: 2 cost time: 1.9381933212280273
Epoch: 2, Steps: 89 | Train Loss: 0.464 Vali Loss: 0.237 Vali Acc: 0.927 Test Loss: 0.237 Test Acc: 0.927
Validation loss decreased (-0.788294 --> -0.926878).  Saving model ...
Epoch: 3 cost time: 1.8332502841949463
Epoch: 3, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (-0.926878 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 1.8275790214538574
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.969358 --> -0.977019).  Saving model ...
Epoch: 5 cost time: 1.8619441986083984
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9646615982055664
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9373383522033691
Epoch: 7, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 2.085648536682129
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9489820003509521
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 2.0234639644622803
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8454036712646484
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0054712295532227
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8923001289367676
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8517613410949707
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.072 Vali Acc: 0.988 Test Loss: 0.072 Test Acc: 0.988
Validation loss decreased (-0.984679 --> -0.988161).  Saving model ...
Epoch: 15 cost time: 1.8502414226531982
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7030775547027588
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.226867914199829
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1062047481536865
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9346611499786377
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.882171392440796
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9513061046600342
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.083073854446411
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.845736026763916
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8242027759552002
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el4_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 29538068
model size : 127.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.2284650802612305
Epoch: 1, Steps: 89 | Train Loss: 1.523 Vali Loss: 0.614 Vali Acc: 0.834 Test Loss: 0.614 Test Acc: 0.834
Validation loss decreased (inf --> -0.834256).  Saving model ...
Epoch: 2 cost time: 3.0432159900665283
Epoch: 2, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.556 Vali Acc: 0.876 Test Loss: 0.556 Test Acc: 0.876
Validation loss decreased (-0.834256 --> -0.876039).  Saving model ...
Epoch: 3 cost time: 3.063645124435425
Epoch: 3, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.966 Vali Acc: 0.842 Test Loss: 0.966 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0493485927581787
Epoch: 4, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.320 Vali Acc: 0.943 Test Loss: 0.320 Test Acc: 0.943
Validation loss decreased (-0.876039 --> -0.942894).  Saving model ...
Epoch: 5 cost time: 3.3438398838043213
Epoch: 5, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.478 Vali Acc: 0.915 Test Loss: 0.478 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.289658784866333
Epoch: 6, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.504 Vali Acc: 0.923 Test Loss: 0.504 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2556002140045166
Epoch: 7, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.327 Vali Acc: 0.958 Test Loss: 0.327 Test Acc: 0.958
Validation loss decreased (-0.942894 --> -0.958214).  Saving model ...
Epoch: 8 cost time: 3.2493908405303955
Epoch: 8, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
Validation loss decreased (-0.958214 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 3.393141031265259
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.257 Vali Acc: 0.969 Test Loss: 0.257 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968660).  Saving model ...
Epoch: 10 cost time: 3.431572198867798
Epoch: 10, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.266 Vali Acc: 0.960 Test Loss: 0.266 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.297714948654175
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.379 Vali Acc: 0.962 Test Loss: 0.379 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1613621711730957
Epoch: 12, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.268 Vali Acc: 0.967 Test Loss: 0.268 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3970205783843994
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.299 Vali Acc: 0.962 Test Loss: 0.299 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3987481594085693
Epoch: 14, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.416 Vali Acc: 0.962 Test Loss: 0.416 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2835423946380615
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.314 Vali Acc: 0.960 Test Loss: 0.314 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.3848636150360107
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.357 Vali Acc: 0.969 Test Loss: 0.357 Test Acc: 0.969
Validation loss decreased (-0.968660 --> -0.969356).  Saving model ...
Epoch: 17 cost time: 3.392810821533203
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.351 Vali Acc: 0.973 Test Loss: 0.351 Test Acc: 0.973
Validation loss decreased (-0.969356 --> -0.972838).  Saving model ...
Epoch: 18 cost time: 3.342146158218384
Epoch: 18, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.340 Vali Acc: 0.969 Test Loss: 0.340 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.305185317993164
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.262 Vali Acc: 0.977 Test Loss: 0.262 Test Acc: 0.977
Validation loss decreased (-0.972838 --> -0.977017).  Saving model ...
Epoch: 20 cost time: 3.2685658931732178
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.311 Vali Acc: 0.965 Test Loss: 0.311 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3753299713134766
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.367 Vali Acc: 0.971 Test Loss: 0.367 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3574936389923096
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.302 Vali Acc: 0.973 Test Loss: 0.302 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.347240447998047
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.585 Vali Acc: 0.962 Test Loss: 0.585 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.14084529876709
Epoch: 24, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.308 Vali Acc: 0.974 Test Loss: 0.308 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.37762188911438
Epoch: 25, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.542 Vali Acc: 0.951 Test Loss: 0.542 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4324662685394287
Epoch: 26, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.415 Vali Acc: 0.965 Test Loss: 0.415 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3845651149749756
Epoch: 27, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.545 Vali Acc: 0.958 Test Loss: 0.545 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.2778024673461914
Epoch: 28, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.531 Vali Acc: 0.960 Test Loss: 0.531 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.3388683795928955
Epoch: 29, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.652 Vali Acc: 0.951 Test Loss: 0.652 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 23669012
model size : 104.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0840003490448
Epoch: 1, Steps: 89 | Train Loss: 1.613 Vali Loss: 0.620 Vali Acc: 0.806 Test Loss: 0.620 Test Acc: 0.806
Validation loss decreased (inf --> -0.806400).  Saving model ...
Epoch: 2 cost time: 1.898806095123291
Epoch: 2, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.463 Vali Acc: 0.868 Test Loss: 0.463 Test Acc: 0.868
Validation loss decreased (-0.806400 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 1.9118835926055908
Epoch: 3, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.868380 --> -0.936627).  Saving model ...
Epoch: 4 cost time: 1.9095771312713623
Epoch: 4, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.320 Vali Acc: 0.924 Test Loss: 0.320 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.986924409866333
Epoch: 5, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.259 Vali Acc: 0.946 Test Loss: 0.259 Test Acc: 0.946
Validation loss decreased (-0.936627 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 1.9186468124389648
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9722321033477783
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.476 Vali Acc: 0.930 Test Loss: 0.476 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0149338245391846
Epoch: 8, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.300 Vali Acc: 0.958 Test Loss: 0.300 Test Acc: 0.958
Validation loss decreased (-0.945680 --> -0.957518).  Saving model ...
Epoch: 9 cost time: 1.9630672931671143
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.287 Vali Acc: 0.951 Test Loss: 0.287 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9962737560272217
Epoch: 10, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.404 Vali Acc: 0.947 Test Loss: 0.404 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.980433464050293
Epoch: 11, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.504 Vali Acc: 0.926 Test Loss: 0.504 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.974987506866455
Epoch: 12, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.476 Vali Acc: 0.932 Test Loss: 0.476 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9088759422302246
Epoch: 13, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.428 Vali Acc: 0.942 Test Loss: 0.428 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9343199729919434
Epoch: 14, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.334 Vali Acc: 0.965 Test Loss: 0.334 Test Acc: 0.965
Validation loss decreased (-0.957518 --> -0.965178).  Saving model ...
Epoch: 15 cost time: 1.987917184829712
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
Validation loss decreased (-0.965178 --> -0.972839).  Saving model ...
Epoch: 16 cost time: 1.9313483238220215
Epoch: 16, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.399 Vali Acc: 0.962 Test Loss: 0.399 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9685556888580322
Epoch: 17, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.279 Vali Acc: 0.964 Test Loss: 0.279 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0069050788879395
Epoch: 18, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.360 Vali Acc: 0.960 Test Loss: 0.360 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8871114253997803
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.976 Test Loss: 0.216 Test Acc: 0.976
Validation loss decreased (-0.972839 --> -0.976321).  Saving model ...
Epoch: 20 cost time: 2.0030243396759033
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.493 Vali Acc: 0.944 Test Loss: 0.493 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.977750301361084
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.284 Vali Acc: 0.974 Test Loss: 0.284 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9600622653961182
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.311 Vali Acc: 0.962 Test Loss: 0.311 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9252448081970215
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.947007417678833
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.328 Vali Acc: 0.962 Test Loss: 0.328 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.989499568939209
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.247 Vali Acc: 0.976 Test Loss: 0.247 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9868354797363281
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.558 Vali Acc: 0.940 Test Loss: 0.558 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9718778133392334
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.661 Vali Acc: 0.939 Test Loss: 0.661 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.0109453201293945
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.967 Test Loss: 0.285 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.988539695739746
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.973 Test Loss: 0.271 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 22925588
model size : 102.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7373576164245605
Epoch: 1, Steps: 89 | Train Loss: 1.868 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
Validation loss decreased (inf --> -0.827988).  Saving model ...
Epoch: 2 cost time: 1.4056730270385742
Epoch: 2, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.230 Vali Acc: 0.929 Test Loss: 0.230 Test Acc: 0.929
Validation loss decreased (-0.827988 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 1.58530592918396
Epoch: 3, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
Validation loss decreased (-0.928967 --> -0.930359).  Saving model ...
Epoch: 4 cost time: 1.5914087295532227
Epoch: 4, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.930359 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 1.586071491241455
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.957519 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 1.5269150733947754
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6630990505218506
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.61568284034729
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6658318042755127
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
Validation loss decreased (-0.968662 --> -0.980500).  Saving model ...
Epoch: 10 cost time: 1.5865216255187988
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.280 Vali Acc: 0.947 Test Loss: 0.280 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6291592121124268
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.245 Vali Acc: 0.962 Test Loss: 0.245 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5845105648040771
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7125542163848877
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5974314212799072
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4138484001159668
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981196).  Saving model ...
Epoch: 16 cost time: 1.5869982242584229
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5596871376037598
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5374321937561035
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.974 Test Loss: 0.213 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.549076795578003
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.173 Vali Acc: 0.977 Test Loss: 0.173 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6312336921691895
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.577601432800293
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.974 Test Loss: 0.193 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5600159168243408
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.974 Test Loss: 0.260 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4924702644348145
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.976 Test Loss: 0.199 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5791492462158203
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5187146663665771
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.971 Test Loss: 0.259 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 22553876
model size : 100.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4246058464050293
Epoch: 1, Steps: 89 | Train Loss: 1.603 Vali Loss: 0.551 Vali Acc: 0.865 Test Loss: 0.551 Test Acc: 0.865
Validation loss decreased (inf --> -0.864897).  Saving model ...
Epoch: 2 cost time: 2.165294885635376
Epoch: 2, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.684 Vali Acc: 0.862 Test Loss: 0.684 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.334279775619507
Epoch: 3, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
Validation loss decreased (-0.864897 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 2.318394422531128
Epoch: 4, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.244 Vali Acc: 0.951 Test Loss: 0.244 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 2.3408467769622803
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
Validation loss decreased (-0.950555 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 2.3544678688049316
Epoch: 6, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.323 Vali Acc: 0.946 Test Loss: 0.323 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.330165147781372
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.266 Vali Acc: 0.960 Test Loss: 0.266 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3673415184020996
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.244 Vali Acc: 0.969 Test Loss: 0.244 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968661).  Saving model ...
Epoch: 9 cost time: 2.2847492694854736
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.462 Vali Acc: 0.940 Test Loss: 0.462 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.397998809814453
Epoch: 10, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.344 Vali Acc: 0.951 Test Loss: 0.344 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.324901580810547
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.391 Vali Acc: 0.949 Test Loss: 0.391 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2848498821258545
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.968661 --> -0.974928).  Saving model ...
Epoch: 13 cost time: 2.329155683517456
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.481 Vali Acc: 0.944 Test Loss: 0.481 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2857894897460938
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.311 Vali Acc: 0.966 Test Loss: 0.311 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3221209049224854
Epoch: 15, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.225 Vali Acc: 0.978 Test Loss: 0.225 Test Acc: 0.978
Validation loss decreased (-0.974928 --> -0.978410).  Saving model ...
Epoch: 16 cost time: 2.3589797019958496
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.240 Vali Acc: 0.979 Test Loss: 0.240 Test Acc: 0.979
Validation loss decreased (-0.978410 --> -0.979106).  Saving model ...
Epoch: 17 cost time: 2.2129454612731934
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.985 Test Loss: 0.184 Test Acc: 0.985
Validation loss decreased (-0.979106 --> -0.985374).  Saving model ...
Epoch: 18 cost time: 2.313164710998535
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.981 Test Loss: 0.204 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3590784072875977
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.378 Vali Acc: 0.963 Test Loss: 0.378 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3543362617492676
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.971 Test Loss: 0.265 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3532629013061523
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.371 Vali Acc: 0.968 Test Loss: 0.371 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.302363157272339
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.260 Vali Acc: 0.977 Test Loss: 0.260 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.353034019470215
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.354 Vali Acc: 0.964 Test Loss: 0.354 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3538103103637695
Epoch: 24, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.351 Vali Acc: 0.973 Test Loss: 0.351 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3087472915649414
Epoch: 25, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.244 Vali Acc: 0.978 Test Loss: 0.244 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3369438648223877
Epoch: 26, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.324 Vali Acc: 0.974 Test Loss: 0.324 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.404458522796631
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.334 Vali Acc: 0.976 Test Loss: 0.334 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 23169044
model size : 103.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.891139268875122
Epoch: 1, Steps: 89 | Train Loss: 1.757 Vali Loss: 0.495 Vali Acc: 0.857 Test Loss: 0.495 Test Acc: 0.857
Validation loss decreased (inf --> -0.856541).  Saving model ...
Epoch: 2 cost time: 1.7126448154449463
Epoch: 2, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
Validation loss decreased (-0.856541 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 1.71342134475708
Epoch: 3, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7093491554260254
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.938716 --> -0.943590).  Saving model ...
Epoch: 5 cost time: 1.766601800918579
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
Validation loss decreased (-0.943590 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 1.7714180946350098
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 1.751129150390625
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 1.8172032833099365
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.259 Vali Acc: 0.951 Test Loss: 0.259 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.749420166015625
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.292 Vali Acc: 0.956 Test Loss: 0.292 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7637779712677002
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7123281955718994
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.790236234664917
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976321).  Saving model ...
Epoch: 13 cost time: 1.8643426895141602
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.237 Vali Acc: 0.965 Test Loss: 0.237 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6641836166381836
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.973 Test Loss: 0.224 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6818485260009766
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.171 Vali Acc: 0.978 Test Loss: 0.171 Test Acc: 0.978
Validation loss decreased (-0.976321 --> -0.977714).  Saving model ...
Epoch: 16 cost time: 1.858243465423584
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.383 Vali Acc: 0.956 Test Loss: 0.383 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8571598529815674
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7487058639526367
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.979 Test Loss: 0.218 Test Acc: 0.979
Validation loss decreased (-0.977714 --> -0.979106).  Saving model ...
Epoch: 19 cost time: 1.7632758617401123
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.983 Test Loss: 0.194 Test Acc: 0.983
Validation loss decreased (-0.979106 --> -0.982589).  Saving model ...
Epoch: 20 cost time: 1.7503998279571533
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.209 Vali Acc: 0.980 Test Loss: 0.209 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8410212993621826
Epoch: 21, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.287 Vali Acc: 0.972 Test Loss: 0.287 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7945923805236816
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.261 Vali Acc: 0.983 Test Loss: 0.261 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983284).  Saving model ...
Epoch: 23 cost time: 1.7223196029663086
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.246 Vali Acc: 0.985 Test Loss: 0.246 Test Acc: 0.985
Validation loss decreased (-0.983284 --> -0.985374).  Saving model ...
Epoch: 24 cost time: 1.7172143459320068
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.537 Vali Acc: 0.960 Test Loss: 0.537 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.752091646194458
Epoch: 25, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.346 Vali Acc: 0.971 Test Loss: 0.346 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.835134506225586
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.217 Vali Acc: 0.976 Test Loss: 0.217 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.741016149520874
Epoch: 27, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.396 Vali Acc: 0.960 Test Loss: 0.396 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8283443450927734
Epoch: 28, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.244 Vali Acc: 0.978 Test Loss: 0.244 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7905619144439697
Epoch: 29, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.246 Vali Acc: 0.969 Test Loss: 0.246 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8277788162231445
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.978 Test Loss: 0.201 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.741581916809082
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.409 Vali Acc: 0.966 Test Loss: 0.409 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7547693252563477
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.248 Vali Acc: 0.974 Test Loss: 0.248 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.783437728881836
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.974 Test Loss: 0.320 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 22780436
model size : 101.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.736861228942871
Epoch: 1, Steps: 89 | Train Loss: 1.911 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
Validation loss decreased (inf --> -0.804311).  Saving model ...
Epoch: 2 cost time: 1.5305991172790527
Epoch: 2, Steps: 89 | Train Loss: 0.478 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.804311 --> -0.931056).  Saving model ...
Epoch: 3 cost time: 1.6353881359100342
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.931056 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 1.602003574371338
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.946377 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 1.6911742687225342
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968661).  Saving model ...
Epoch: 6 cost time: 1.602501392364502
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.968661 --> -0.972143).  Saving model ...
Epoch: 7 cost time: 1.545914888381958
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.40617036819458
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.972143 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 1.4216585159301758
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6907155513763428
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.526784896850586
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5690693855285645
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
Validation loss decreased (-0.978411 --> -0.983982).  Saving model ...
Epoch: 13 cost time: 1.6022827625274658
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.985 Test Loss: 0.109 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 1.5493903160095215
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6224327087402344
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5997674465179443
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7620763778686523
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6329398155212402
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3520591259002686
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.186 Vali Acc: 0.981 Test Loss: 0.186 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.631727933883667
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.216 Vali Acc: 0.981 Test Loss: 0.216 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5632572174072266
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.194 Vali Acc: 0.973 Test Loss: 0.194 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.710918664932251
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.238 Vali Acc: 0.969 Test Loss: 0.238 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6277546882629395
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.268 Vali Acc: 0.969 Test Loss: 0.268 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 22526996
model size : 100.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3204545974731445
Epoch: 1, Steps: 89 | Train Loss: 1.516 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
Validation loss decreased (inf --> -0.850272).  Saving model ...
Epoch: 2 cost time: 2.2418763637542725
Epoch: 2, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.690 Vali Acc: 0.853 Test Loss: 0.690 Test Acc: 0.853
Validation loss decreased (-0.850272 --> -0.853057).  Saving model ...
Epoch: 3 cost time: 2.233205556869507
Epoch: 3, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.309 Vali Acc: 0.938 Test Loss: 0.309 Test Acc: 0.938
Validation loss decreased (-0.853057 --> -0.938019).  Saving model ...
Epoch: 4 cost time: 2.2430500984191895
Epoch: 4, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.938019 --> -0.949858).  Saving model ...
Epoch: 5 cost time: 2.2333924770355225
Epoch: 5, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
Validation loss decreased (-0.949858 --> -0.970750).  Saving model ...
Epoch: 6 cost time: 2.307291269302368
Epoch: 6, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.240 Vali Acc: 0.961 Test Loss: 0.240 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.340996265411377
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.268 Vali Acc: 0.965 Test Loss: 0.268 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.337440252304077
Epoch: 8, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.421 Vali Acc: 0.949 Test Loss: 0.421 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3476288318634033
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.337 Vali Acc: 0.964 Test Loss: 0.337 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3287343978881836
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.283 Vali Acc: 0.963 Test Loss: 0.283 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.340958595275879
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.329 Vali Acc: 0.960 Test Loss: 0.329 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.366877317428589
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.543 Vali Acc: 0.960 Test Loss: 0.543 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.380671501159668
Epoch: 13, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.803 Vali Acc: 0.922 Test Loss: 0.803 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2988312244415283
Epoch: 14, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.492 Vali Acc: 0.952 Test Loss: 0.492 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.340355396270752
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.309 Vali Acc: 0.968 Test Loss: 0.309 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 23175956
model size : 103.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9134325981140137
Epoch: 1, Steps: 89 | Train Loss: 1.707 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (inf --> -0.818935).  Saving model ...
Epoch: 2 cost time: 1.6989552974700928
Epoch: 2, Steps: 89 | Train Loss: 0.507 Vali Loss: 0.450 Vali Acc: 0.884 Test Loss: 0.450 Test Acc: 0.884
Validation loss decreased (-0.818935 --> -0.884397).  Saving model ...
Epoch: 3 cost time: 1.8271477222442627
Epoch: 3, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.432 Vali Acc: 0.920 Test Loss: 0.432 Test Acc: 0.920
Validation loss decreased (-0.884397 --> -0.919912).  Saving model ...
Epoch: 4 cost time: 1.848653793334961
Epoch: 4, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (-0.919912 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 1.7302887439727783
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.310 Vali Acc: 0.956 Test Loss: 0.310 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7286508083343506
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.202 Vali Acc: 0.974 Test Loss: 0.202 Test Acc: 0.974
Validation loss decreased (-0.963090 --> -0.974232).  Saving model ...
Epoch: 7 cost time: 1.7979824542999268
Epoch: 7, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.345 Vali Acc: 0.938 Test Loss: 0.345 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7578322887420654
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.676908254623413
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.322 Vali Acc: 0.958 Test Loss: 0.322 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.839508056640625
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.230 Vali Acc: 0.969 Test Loss: 0.230 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7671968936920166
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
Validation loss decreased (-0.974232 --> -0.976321).  Saving model ...
Epoch: 12 cost time: 1.8077495098114014
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.374 Vali Acc: 0.948 Test Loss: 0.374 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6682202816009521
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.337 Vali Acc: 0.949 Test Loss: 0.337 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.789602279663086
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.229 Vali Acc: 0.973 Test Loss: 0.229 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7583189010620117
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.306 Vali Acc: 0.968 Test Loss: 0.306 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.797912359237671
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.963 Test Loss: 0.296 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6032500267028809
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.361 Vali Acc: 0.961 Test Loss: 0.361 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8212599754333496
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.417 Vali Acc: 0.945 Test Loss: 0.417 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8364613056182861
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.226 Vali Acc: 0.971 Test Loss: 0.226 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.839195966720581
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.267 Vali Acc: 0.971 Test Loss: 0.267 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7886312007904053
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.357 Vali Acc: 0.967 Test Loss: 0.357 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 22787348
model size : 101.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.744252920150757
Epoch: 1, Steps: 89 | Train Loss: 1.891 Vali Loss: 0.580 Vali Acc: 0.840 Test Loss: 0.580 Test Acc: 0.840
Validation loss decreased (inf --> -0.839827).  Saving model ...
Epoch: 2 cost time: 1.63246750831604
Epoch: 2, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.839827 --> -0.940806).  Saving model ...
Epoch: 3 cost time: 1.684492588043213
Epoch: 3, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.324 Vali Acc: 0.914 Test Loss: 0.324 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7111155986785889
Epoch: 4, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
Validation loss decreased (-0.940806 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 1.6631486415863037
Epoch: 5, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.960305 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 1.6050832271575928
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3879034519195557
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4837238788604736
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 1.4940943717956543
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
Validation loss decreased (-0.977018 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 1.6220147609710693
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 1.6013579368591309
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5878376960754395
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5440435409545898
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5672659873962402
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.510622501373291
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
Validation loss decreased (-0.983286 --> -0.986071).  Saving model ...
Epoch: 16 cost time: 1.649965524673462
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5591659545898438
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.346 Vali Acc: 0.953 Test Loss: 0.346 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4779784679412842
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.981 Test Loss: 0.164 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5931084156036377
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.521188735961914
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.984 Test Loss: 0.121 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.597243070602417
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.987 Test Loss: 0.129 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.986768).  Saving model ...
Epoch: 22 cost time: 1.6162679195404053
Epoch: 22, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.207 Vali Acc: 0.973 Test Loss: 0.207 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4974424839019775
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.987 Test Loss: 0.116 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 1.6030855178833008
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.158 Vali Acc: 0.985 Test Loss: 0.158 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6173100471496582
Epoch: 25, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.984 Test Loss: 0.136 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5756335258483887
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.978 Test Loss: 0.213 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.573368787765503
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.976 Test Loss: 0.235 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5737521648406982
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.149 Vali Acc: 0.984 Test Loss: 0.149 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5171759128570557
Epoch: 29, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5759224891662598
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.981 Test Loss: 0.188 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5644946098327637
Epoch: 31, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.174 Vali Acc: 0.977 Test Loss: 0.174 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.494734525680542
Epoch: 32, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.987 Test Loss: 0.136 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6951487064361572
Epoch: 33, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.976 Test Loss: 0.227 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 22500116
model size : 100.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.479397773742676
Epoch: 1, Steps: 89 | Train Loss: 1.622 Vali Loss: 0.554 Vali Acc: 0.853 Test Loss: 0.554 Test Acc: 0.853
Validation loss decreased (inf --> -0.853059).  Saving model ...
Epoch: 2 cost time: 2.1815199851989746
Epoch: 2, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.408 Vali Acc: 0.896 Test Loss: 0.408 Test Acc: 0.896
Validation loss decreased (-0.853059 --> -0.895539).  Saving model ...
Epoch: 3 cost time: 2.20042085647583
Epoch: 3, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.646 Vali Acc: 0.866 Test Loss: 0.646 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1627702713012695
Epoch: 4, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.507 Vali Acc: 0.896 Test Loss: 0.507 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3373475074768066
Epoch: 5, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.895539 --> -0.933145).  Saving model ...
Epoch: 6 cost time: 2.3280622959136963
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.277 Vali Acc: 0.960 Test Loss: 0.277 Test Acc: 0.960
Validation loss decreased (-0.933145 --> -0.959607).  Saving model ...
Epoch: 7 cost time: 2.26326322555542
Epoch: 7, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.274 Vali Acc: 0.945 Test Loss: 0.274 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.309147834777832
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.229 Vali Acc: 0.962 Test Loss: 0.229 Test Acc: 0.962
Validation loss decreased (-0.959607 --> -0.961697).  Saving model ...
Epoch: 9 cost time: 2.3022751808166504
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.285 Vali Acc: 0.955 Test Loss: 0.285 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3449206352233887
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.268 Vali Acc: 0.961 Test Loss: 0.268 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.331606864929199
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.961697 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 2.3559207916259766
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.512 Vali Acc: 0.930 Test Loss: 0.512 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3497955799102783
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.966 Test Loss: 0.229 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.329425573348999
Epoch: 14, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.456 Vali Acc: 0.944 Test Loss: 0.456 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2734971046447754
Epoch: 15, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.387 Vali Acc: 0.961 Test Loss: 0.387 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3280141353607178
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.248 Vali Acc: 0.971 Test Loss: 0.248 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3425142765045166
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.974 Test Loss: 0.274 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973535).  Saving model ...
Epoch: 18 cost time: 2.3421578407287598
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.300 Vali Acc: 0.967 Test Loss: 0.300 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.296555280685425
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.298 Vali Acc: 0.968 Test Loss: 0.298 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3343911170959473
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.351 Vali Acc: 0.963 Test Loss: 0.351 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2700164318084717
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.338 Vali Acc: 0.962 Test Loss: 0.338 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.339252233505249
Epoch: 22, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.440 Vali Acc: 0.958 Test Loss: 0.440 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2939679622650146
Epoch: 23, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.973535 --> -0.974928).  Saving model ...
Epoch: 24 cost time: 2.3483359813690186
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.981 Test Loss: 0.209 Test Acc: 0.981
Validation loss decreased (-0.974928 --> -0.981196).  Saving model ...
Epoch: 25 cost time: 2.30583119392395
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.284 Vali Acc: 0.969 Test Loss: 0.284 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.352094888687134
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.976 Test Loss: 0.236 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.331637144088745
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.334 Vali Acc: 0.964 Test Loss: 0.334 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.260080099105835
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.494 Vali Acc: 0.959 Test Loss: 0.494 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.3662264347076416
Epoch: 29, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.492 Vali Acc: 0.959 Test Loss: 0.492 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.331918716430664
Epoch: 30, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.380 Vali Acc: 0.962 Test Loss: 0.380 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.353156089782715
Epoch: 31, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.388 Vali Acc: 0.962 Test Loss: 0.388 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.3331825733184814
Epoch: 32, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.735 Vali Acc: 0.949 Test Loss: 0.735 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.3084418773651123
Epoch: 33, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.543 Vali Acc: 0.960 Test Loss: 0.543 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.3491737842559814
Epoch: 34, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.569 Vali Acc: 0.960 Test Loss: 0.569 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 23182868
model size : 103.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7433862686157227
Epoch: 1, Steps: 89 | Train Loss: 1.706 Vali Loss: 0.766 Vali Acc: 0.797 Test Loss: 0.766 Test Acc: 0.797
Validation loss decreased (inf --> -0.796650).  Saving model ...
Epoch: 2 cost time: 1.55828857421875
Epoch: 2, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.360 Vali Acc: 0.928 Test Loss: 0.360 Test Acc: 0.928
Validation loss decreased (-0.796650 --> -0.928269).  Saving model ...
Epoch: 3 cost time: 1.7420196533203125
Epoch: 3, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
Validation loss decreased (-0.928269 --> -0.934538).  Saving model ...
Epoch: 4 cost time: 1.7468841075897217
Epoch: 4, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
Validation loss decreased (-0.934538 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 1.6453595161437988
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.935234 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 2.073946237564087
Epoch: 6, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5710275173187256
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 1.7111239433288574
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 1.7589263916015625
Epoch: 9, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.312 Vali Acc: 0.951 Test Loss: 0.312 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.644282579421997
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.216 Vali Acc: 0.969 Test Loss: 0.216 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.744840145111084
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.558 Vali Acc: 0.920 Test Loss: 0.558 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6042277812957764
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.288 Vali Acc: 0.968 Test Loss: 0.288 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.645864725112915
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.189 Vali Acc: 0.972 Test Loss: 0.189 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6440308094024658
Epoch: 14, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.633399248123169
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.178 Vali Acc: 0.978 Test Loss: 0.178 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8527905941009521
Epoch: 16, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.724503517150879
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984678).  Saving model ...
Epoch: 18 cost time: 1.7315871715545654
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.272 Vali Acc: 0.970 Test Loss: 0.272 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6864168643951416
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.261 Vali Acc: 0.971 Test Loss: 0.261 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6976368427276611
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.982 Test Loss: 0.161 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7341809272766113
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.984678).  Saving model ...
Epoch: 22 cost time: 1.6814038753509521
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.615368366241455
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.981 Test Loss: 0.136 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.834970235824585
Epoch: 24, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.321 Vali Acc: 0.977 Test Loss: 0.321 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.69002366065979
Epoch: 25, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.330 Vali Acc: 0.968 Test Loss: 0.330 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.776646375656128
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.274 Vali Acc: 0.976 Test Loss: 0.274 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6230847835540771
Epoch: 27, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.195 Vali Acc: 0.981 Test Loss: 0.195 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8151977062225342
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.338 Vali Acc: 0.960 Test Loss: 0.338 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7720913887023926
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.297 Vali Acc: 0.952 Test Loss: 0.297 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6300795078277588
Epoch: 30, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.192 Vali Acc: 0.984 Test Loss: 0.192 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6278088092803955
Epoch: 31, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.983 Test Loss: 0.246 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 22692884
model size : 101.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0343406200408936
Epoch: 1, Steps: 89 | Train Loss: 1.958 Vali Loss: 0.636 Vali Acc: 0.825 Test Loss: 0.636 Test Acc: 0.825
Validation loss decreased (inf --> -0.825203).  Saving model ...
Epoch: 2 cost time: 1.4996285438537598
Epoch: 2, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
Validation loss decreased (-0.825203 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 1.6514103412628174
Epoch: 3, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.938020 --> -0.970751).  Saving model ...
Epoch: 4 cost time: 1.7039318084716797
Epoch: 4, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5980515480041504
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6249408721923828
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.970751 --> -0.986768).  Saving model ...
Epoch: 7 cost time: 1.6455280780792236
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.547947645187378
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5539524555206299
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5931713581085205
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6173250675201416
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5957062244415283
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.488483190536499
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.424391746520996
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5492451190948486
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.752319574356079
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.987 Test Loss: 0.107 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 22473236
model size : 100.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.445558786392212
Epoch: 1, Steps: 89 | Train Loss: 1.562 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
Validation loss decreased (inf --> -0.841219).  Saving model ...
Epoch: 2 cost time: 2.1678693294525146
Epoch: 2, Steps: 89 | Train Loss: 0.572 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
Validation loss decreased (-0.841219 --> -0.922002).  Saving model ...
Epoch: 3 cost time: 2.2908647060394287
Epoch: 3, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.337 Vali Acc: 0.942 Test Loss: 0.337 Test Acc: 0.942
Validation loss decreased (-0.922002 --> -0.942197).  Saving model ...
Epoch: 4 cost time: 2.216411590576172
Epoch: 4, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.324662446975708
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.436 Vali Acc: 0.918 Test Loss: 0.436 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.223863124847412
Epoch: 6, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.396 Vali Acc: 0.931 Test Loss: 0.396 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2660727500915527
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.289 Vali Acc: 0.954 Test Loss: 0.289 Test Acc: 0.954
Validation loss decreased (-0.942197 --> -0.954036).  Saving model ...
Epoch: 8 cost time: 2.336181879043579
Epoch: 8, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.394 Vali Acc: 0.938 Test Loss: 0.394 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.319606065750122
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.228 Vali Acc: 0.959 Test Loss: 0.228 Test Acc: 0.959
Validation loss decreased (-0.954036 --> -0.958911).  Saving model ...
Epoch: 10 cost time: 2.351426601409912
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.251 Vali Acc: 0.962 Test Loss: 0.251 Test Acc: 0.962
Validation loss decreased (-0.958911 --> -0.961697).  Saving model ...
Epoch: 11 cost time: 2.325685501098633
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.219 Vali Acc: 0.978 Test Loss: 0.219 Test Acc: 0.978
Validation loss decreased (-0.961697 --> -0.978410).  Saving model ...
Epoch: 12 cost time: 2.3375046253204346
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3450887203216553
Epoch: 13, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.291 Vali Acc: 0.964 Test Loss: 0.291 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.446450710296631
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.302 Vali Acc: 0.967 Test Loss: 0.302 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2303457260131836
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.247 Vali Acc: 0.970 Test Loss: 0.247 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2575604915618896
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.250 Vali Acc: 0.971 Test Loss: 0.250 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3337414264678955
Epoch: 17, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.275 Vali Acc: 0.938 Test Loss: 0.275 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.300971508026123
Epoch: 18, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.179 Vali Acc: 0.978 Test Loss: 0.179 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3374767303466797
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.984 Test Loss: 0.190 Test Acc: 0.984
Validation loss decreased (-0.978410 --> -0.983981).  Saving model ...
Epoch: 20 cost time: 2.4019269943237305
Epoch: 20, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.985 Test Loss: 0.168 Test Acc: 0.985
Validation loss decreased (-0.983981 --> -0.984678).  Saving model ...
Epoch: 21 cost time: 2.3218698501586914
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.983 Test Loss: 0.163 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2591283321380615
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3473525047302246
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2245678901672363
Epoch: 24, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.365 Vali Acc: 0.958 Test Loss: 0.365 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.391077756881714
Epoch: 25, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.216 Vali Acc: 0.969 Test Loss: 0.216 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3381149768829346
Epoch: 26, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.216 Vali Acc: 0.980 Test Loss: 0.216 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.3171231746673584
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.235 Vali Acc: 0.979 Test Loss: 0.235 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.388090133666992
Epoch: 28, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.369 Vali Acc: 0.964 Test Loss: 0.369 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3556554317474365
Epoch: 29, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.554 Vali Acc: 0.950 Test Loss: 0.554 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3732192516326904
Epoch: 30, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.763 Vali Acc: 0.937 Test Loss: 0.763 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 23172884
model size : 103.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.883399248123169
Epoch: 1, Steps: 89 | Train Loss: 1.775 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
Validation loss decreased (inf --> -0.838434).  Saving model ...
Epoch: 2 cost time: 1.5952985286712646
Epoch: 2, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.377 Vali Acc: 0.909 Test Loss: 0.377 Test Acc: 0.909
Validation loss decreased (-0.838434 --> -0.909467).  Saving model ...
Epoch: 3 cost time: 1.586881399154663
Epoch: 3, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.248 Vali Acc: 0.954 Test Loss: 0.248 Test Acc: 0.954
Validation loss decreased (-0.909467 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 1.6642563343048096
Epoch: 4, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.246 Vali Acc: 0.956 Test Loss: 0.246 Test Acc: 0.956
Validation loss decreased (-0.954037 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 1.6688237190246582
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.248 Vali Acc: 0.962 Test Loss: 0.248 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.961697).  Saving model ...
Epoch: 6 cost time: 1.6142613887786865
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.321 Vali Acc: 0.946 Test Loss: 0.321 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.688291311264038
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.312 Vali Acc: 0.955 Test Loss: 0.312 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.780304193496704
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.222 Vali Acc: 0.954 Test Loss: 0.222 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6475284099578857
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.971 Test Loss: 0.232 Test Acc: 0.971
Validation loss decreased (-0.961697 --> -0.970750).  Saving model ...
Epoch: 10 cost time: 1.6402535438537598
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6461784839630127
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
Validation loss decreased (-0.970750 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 1.583423376083374
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.709265947341919
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.342 Vali Acc: 0.945 Test Loss: 0.342 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6326875686645508
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6689538955688477
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.291 Vali Acc: 0.954 Test Loss: 0.291 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6442577838897705
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.974 Test Loss: 0.211 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6424689292907715
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7019755840301514
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.978 Test Loss: 0.204 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6183161735534668
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.229 Vali Acc: 0.974 Test Loss: 0.229 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7251381874084473
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.813481330871582
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.163 Vali Acc: 0.984 Test Loss: 0.163 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 22699796
model size : 101.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.80588436126709
Epoch: 1, Steps: 89 | Train Loss: 2.039 Vali Loss: 0.576 Vali Acc: 0.830 Test Loss: 0.576 Test Acc: 0.830
Validation loss decreased (inf --> -0.830078).  Saving model ...
Epoch: 2 cost time: 1.4211218357086182
Epoch: 2, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.830078 --> -0.929663).  Saving model ...
Epoch: 3 cost time: 1.6637449264526367
Epoch: 3, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.929663 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 1.5434975624084473
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5545830726623535
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 1.530364990234375
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.967269 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 1.46315598487854
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 1.5567035675048828
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 9 cost time: 1.5250489711761475
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 1.5674009323120117
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5087735652923584
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.975626 --> -0.981893).  Saving model ...
Epoch: 12 cost time: 1.5012085437774658
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4907736778259277
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4600248336791992
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6332809925079346
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.218 Vali Acc: 0.960 Test Loss: 0.218 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6405084133148193
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.363 Vali Acc: 0.952 Test Loss: 0.363 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7691066265106201
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.978 Test Loss: 0.154 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5067863464355469
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.239938497543335
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 20 cost time: 1.4978690147399902
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.74763822555542
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.096 Vali Acc: 0.985 Test Loss: 0.096 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 22 cost time: 1.6661434173583984
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6620690822601318
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.988 Test Loss: 0.119 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988160).  Saving model ...
Epoch: 24 cost time: 1.5779566764831543
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6958677768707275
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.982 Test Loss: 0.152 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.603759765625
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.235 Vali Acc: 0.977 Test Loss: 0.235 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5465271472930908
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.399 Vali Acc: 0.960 Test Loss: 0.399 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.644486665725708
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.987 Test Loss: 0.130 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7686176300048828
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.985 Test Loss: 0.162 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.892456293106079
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5882434844970703
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.987 Test Loss: 0.099 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5404846668243408
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.989 Test Loss: 0.096 Test Acc: 0.989
Validation loss decreased (-0.988160 --> -0.988857).  Saving model ...
Epoch: 33 cost time: 1.5533833503723145
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.986 Test Loss: 0.126 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5592267513275146
Epoch: 34, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.245 Vali Acc: 0.965 Test Loss: 0.245 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5395264625549316
Epoch: 35, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5279221534729004
Epoch: 36, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.228 Vali Acc: 0.968 Test Loss: 0.228 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4818570613861084
Epoch: 37, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.985 Test Loss: 0.126 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5452070236206055
Epoch: 38, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4173214435577393
Epoch: 39, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.978 Test Loss: 0.182 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3578319549560547
Epoch: 40, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4747180938720703
Epoch: 41, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.222 Vali Acc: 0.974 Test Loss: 0.222 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.5432953834533691
Epoch: 42, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.983 Test Loss: 0.229 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 22463252
model size : 100.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0458121299743652
Epoch: 1, Steps: 89 | Train Loss: 1.603 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (inf --> -0.875344).  Saving model ...
Epoch: 2 cost time: 1.8701088428497314
Epoch: 2, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.245 Vali Acc: 0.939 Test Loss: 0.245 Test Acc: 0.939
Validation loss decreased (-0.875344 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 1.8635423183441162
Epoch: 3, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.245 Vali Acc: 0.947 Test Loss: 0.245 Test Acc: 0.947
Validation loss decreased (-0.939413 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 1.8966593742370605
Epoch: 4, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.695 Vali Acc: 0.869 Test Loss: 0.695 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9976532459259033
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
Validation loss decreased (-0.947073 --> -0.968661).  Saving model ...
Epoch: 6 cost time: 1.9518933296203613
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.246 Vali Acc: 0.955 Test Loss: 0.246 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9236631393432617
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.970750).  Saving model ...
Epoch: 8 cost time: 1.9731593132019043
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
Validation loss decreased (-0.970750 --> -0.977714).  Saving model ...
Epoch: 9 cost time: 1.9210796356201172
Epoch: 9, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9850437641143799
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.291 Vali Acc: 0.961 Test Loss: 0.291 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.962944507598877
Epoch: 11, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.269 Vali Acc: 0.959 Test Loss: 0.269 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.941657543182373
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9367549419403076
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.249 Vali Acc: 0.960 Test Loss: 0.249 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8626987934112549
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.209 Vali Acc: 0.972 Test Loss: 0.209 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0148093700408936
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.283 Vali Acc: 0.973 Test Loss: 0.283 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9519524574279785
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.976 Test Loss: 0.204 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9654555320739746
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.976 Test Loss: 0.229 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9690279960632324
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.308 Vali Acc: 0.969 Test Loss: 0.308 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 22943252
model size : 102.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.6971969604492188
Epoch: 1, Steps: 89 | Train Loss: 1.723 Vali Loss: 0.495 Vali Acc: 0.853 Test Loss: 0.495 Test Acc: 0.853
Validation loss decreased (inf --> -0.853059).  Saving model ...
Epoch: 2 cost time: 1.5246191024780273
Epoch: 2, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
Validation loss decreased (-0.853059 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 1.5489501953125
Epoch: 3, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
Validation loss decreased (-0.938020 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 1.5986294746398926
Epoch: 4, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 1.5810539722442627
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 1.5681769847869873
Epoch: 6, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.376 Vali Acc: 0.926 Test Loss: 0.376 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.713304042816162
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975625).  Saving model ...
Epoch: 8 cost time: 1.5060207843780518
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.312 Vali Acc: 0.936 Test Loss: 0.312 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6408929824829102
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.385 Vali Acc: 0.952 Test Loss: 0.385 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.451784372329712
Epoch: 10, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.159 Vali Acc: 0.979 Test Loss: 0.159 Test Acc: 0.979
Validation loss decreased (-0.975625 --> -0.979107).  Saving model ...
Epoch: 11 cost time: 1.887298822402954
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6741726398468018
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.187 Vali Acc: 0.973 Test Loss: 0.187 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6014485359191895
Epoch: 13, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6482665538787842
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6814777851104736
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6770644187927246
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.982 Test Loss: 0.160 Test Acc: 0.982
Validation loss decreased (-0.979107 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 1.7088944911956787
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.301 Vali Acc: 0.967 Test Loss: 0.301 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7502140998840332
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.188 Vali Acc: 0.979 Test Loss: 0.188 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6430487632751465
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.669013500213623
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.981 Test Loss: 0.193 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6663603782653809
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6528441905975342
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.973 Test Loss: 0.323 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6802666187286377
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.987 Test Loss: 0.123 Test Acc: 0.987
Validation loss decreased (-0.981893 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 1.6092398166656494
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.974 Test Loss: 0.215 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5577590465545654
Epoch: 25, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.984 Test Loss: 0.140 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5781114101409912
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.974 Test Loss: 0.210 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5994136333465576
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.973 Test Loss: 0.232 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5319123268127441
Epoch: 28, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.259 Vali Acc: 0.976 Test Loss: 0.259 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6016430854797363
Epoch: 29, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.388 Vali Acc: 0.964 Test Loss: 0.388 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4339096546173096
Epoch: 30, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.251 Vali Acc: 0.979 Test Loss: 0.251 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5780353546142578
Epoch: 31, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.503 Vali Acc: 0.954 Test Loss: 0.503 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6431353092193604
Epoch: 32, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.197 Vali Acc: 0.984 Test Loss: 0.197 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5656695365905762
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.501 Vali Acc: 0.955 Test Loss: 0.501 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 22639124
model size : 101.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.614246368408203
Epoch: 1, Steps: 89 | Train Loss: 1.994 Vali Loss: 0.518 Vali Acc: 0.849 Test Loss: 0.518 Test Acc: 0.849
Validation loss decreased (inf --> -0.848881).  Saving model ...
Epoch: 2 cost time: 1.5229947566986084
Epoch: 2, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.848881 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 1.5590040683746338
Epoch: 3, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.948466 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 1.6190123558044434
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
Validation loss decreased (-0.949162 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 1.6858243942260742
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6713509559631348
Epoch: 6, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.963787 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 1.6720967292785645
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7435364723205566
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7518301010131836
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6318979263305664
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 1.7058839797973633
Epoch: 11, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.67271089553833
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6860859394073486
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5844011306762695
Epoch: 14, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8445379734039307
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.966 Test Loss: 0.243 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5109763145446777
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.58674955368042
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4740855693817139
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.541651964187622
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.317 Vali Acc: 0.962 Test Loss: 0.317 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4798693656921387
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.335 Vali Acc: 0.960 Test Loss: 0.335 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 22453268
model size : 100.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1012566089630127
Epoch: 1, Steps: 89 | Train Loss: 1.598 Vali Loss: 0.811 Vali Acc: 0.790 Test Loss: 0.811 Test Acc: 0.790
Validation loss decreased (inf --> -0.790382).  Saving model ...
Epoch: 2 cost time: 1.8555452823638916
Epoch: 2, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.297 Vali Acc: 0.932 Test Loss: 0.297 Test Acc: 0.932
Validation loss decreased (-0.790382 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 1.9021790027618408
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.334 Vali Acc: 0.912 Test Loss: 0.334 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8519988059997559
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
Validation loss decreased (-0.931752 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 1.9000945091247559
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 1.926288366317749
Epoch: 6, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.379 Vali Acc: 0.939 Test Loss: 0.379 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.931447982788086
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.217 Vali Acc: 0.961 Test Loss: 0.217 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.020552158355713
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.474 Vali Acc: 0.927 Test Loss: 0.474 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0345678329467773
Epoch: 9, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.236 Vali Acc: 0.968 Test Loss: 0.236 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967964).  Saving model ...
Epoch: 10 cost time: 1.9890518188476562
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.393 Vali Acc: 0.935 Test Loss: 0.393 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.003972291946411
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
Validation loss decreased (-0.967964 --> -0.981893).  Saving model ...
Epoch: 12 cost time: 1.929997205734253
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.978 Test Loss: 0.186 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9659745693206787
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.181 Vali Acc: 0.978 Test Loss: 0.181 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9771521091461182
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.332 Vali Acc: 0.946 Test Loss: 0.332 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9201314449310303
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.972 Test Loss: 0.264 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.044846773147583
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.190 Vali Acc: 0.981 Test Loss: 0.190 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9728808403015137
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.979 Test Loss: 0.232 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9655556678771973
Epoch: 18, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.264 Vali Acc: 0.965 Test Loss: 0.264 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0258443355560303
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.211 Vali Acc: 0.976 Test Loss: 0.211 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9830901622772217
Epoch: 20, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.189 Vali Acc: 0.978 Test Loss: 0.189 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9728937149047852
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.979 Test Loss: 0.232 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 22950164
model size : 102.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.907876968383789
Epoch: 1, Steps: 89 | Train Loss: 1.709 Vali Loss: 0.489 Vali Acc: 0.868 Test Loss: 0.489 Test Acc: 0.868
Validation loss decreased (inf --> -0.867683).  Saving model ...
Epoch: 2 cost time: 1.6635346412658691
Epoch: 2, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.342 Vali Acc: 0.914 Test Loss: 0.342 Test Acc: 0.914
Validation loss decreased (-0.867683 --> -0.914342).  Saving model ...
Epoch: 3 cost time: 1.741194725036621
Epoch: 3, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.914342 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 1.6076335906982422
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6490356922149658
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.194 Vali Acc: 0.961 Test Loss: 0.194 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4630553722381592
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.967269 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 1.6928634643554688
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.241 Vali Acc: 0.961 Test Loss: 0.241 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6182730197906494
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.237 Vali Acc: 0.964 Test Loss: 0.237 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5908262729644775
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 10 cost time: 1.6594064235687256
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6477301120758057
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6709845066070557
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6561415195465088
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980500).  Saving model ...
Epoch: 14 cost time: 1.6172852516174316
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.971 Test Loss: 0.232 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6325023174285889
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.985 Test Loss: 0.124 Test Acc: 0.985
Validation loss decreased (-0.980500 --> -0.984678).  Saving model ...
Epoch: 16 cost time: 1.6539947986602783
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.987 Test Loss: 0.117 Test Acc: 0.987
Validation loss decreased (-0.984678 --> -0.986768).  Saving model ...
Epoch: 17 cost time: 1.634657859802246
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.180 Vali Acc: 0.983 Test Loss: 0.180 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5831363201141357
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.207 Vali Acc: 0.980 Test Loss: 0.207 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6858572959899902
Epoch: 19, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.586632251739502
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.978 Test Loss: 0.195 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6892750263214111
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.214 Vali Acc: 0.976 Test Loss: 0.214 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6985342502593994
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.985 Test Loss: 0.131 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7153801918029785
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.982 Test Loss: 0.126 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5894684791564941
Epoch: 24, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7399346828460693
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6712043285369873
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.984 Test Loss: 0.139 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 22646036
model size : 101.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.799879550933838
Epoch: 1, Steps: 89 | Train Loss: 1.981 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (inf --> -0.860719).  Saving model ...
Epoch: 2 cost time: 1.6924009323120117
Epoch: 2, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
Validation loss decreased (-0.860719 --> -0.926878).  Saving model ...
Epoch: 3 cost time: 1.4910047054290771
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.926878 --> -0.972144).  Saving model ...
Epoch: 4 cost time: 1.5686986446380615
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5305233001708984
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.530776023864746
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5319557189941406
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 1.5977699756622314
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 1.7892732620239258
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6973481178283691
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.284 Vali Acc: 0.953 Test Loss: 0.284 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.578207015991211
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 1.6193976402282715
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6434047222137451
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4030511379241943
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5444211959838867
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5547161102294922
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.988 Test Loss: 0.091 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 17 cost time: 1.645942211151123
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.961 Test Loss: 0.226 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6178362369537354
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6682813167572021
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5993638038635254
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.985 Test Loss: 0.109 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5320968627929688
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.735884428024292
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.982 Test Loss: 0.135 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5583500862121582
Epoch: 23, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.966 Test Loss: 0.211 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6022562980651855
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.193 Vali Acc: 0.983 Test Loss: 0.193 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.64638352394104
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5894556045532227
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.979 Test Loss: 0.215 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 22443284
model size : 100.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.897385835647583
Epoch: 1, Steps: 89 | Train Loss: 1.561 Vali Loss: 0.440 Vali Acc: 0.872 Test Loss: 0.440 Test Acc: 0.872
Validation loss decreased (inf --> -0.871862).  Saving model ...
Epoch: 2 cost time: 1.8999278545379639
Epoch: 2, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.343 Vali Acc: 0.897 Test Loss: 0.343 Test Acc: 0.897
Validation loss decreased (-0.871862 --> -0.896933).  Saving model ...
Epoch: 3 cost time: 1.9026763439178467
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.247 Vali Acc: 0.946 Test Loss: 0.247 Test Acc: 0.946
Validation loss decreased (-0.896933 --> -0.946376).  Saving model ...
Epoch: 4 cost time: 1.8733234405517578
Epoch: 4, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
Validation loss decreased (-0.946376 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 1.8349823951721191
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.232 Vali Acc: 0.957 Test Loss: 0.232 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8904776573181152
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 1.9401025772094727
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.94083833694458
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9335651397705078
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.098 Vali Acc: 0.987 Test Loss: 0.098 Test Acc: 0.987
Validation loss decreased (-0.969358 --> -0.987464).  Saving model ...
Epoch: 10 cost time: 1.9251360893249512
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9471759796142578
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.213 Vali Acc: 0.968 Test Loss: 0.213 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9178040027618408
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.92319655418396
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.981 Test Loss: 0.137 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.934014081954956
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9271128177642822
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.337 Vali Acc: 0.964 Test Loss: 0.337 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8645985126495361
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9478085041046143
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9121277332305908
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.221 Vali Acc: 0.967 Test Loss: 0.221 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8875694274902344
Epoch: 19, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.140 Vali Acc: 0.979 Test Loss: 0.140 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 22947092
model size : 102.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.6525139808654785
Epoch: 1, Steps: 89 | Train Loss: 1.830 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
Validation loss decreased (inf --> -0.824507).  Saving model ...
Epoch: 2 cost time: 1.4589922428131104
Epoch: 2, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
Validation loss decreased (-0.824507 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 1.405257225036621
Epoch: 3, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6864676475524902
Epoch: 4, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.238 Vali Acc: 0.951 Test Loss: 0.238 Test Acc: 0.951
Validation loss decreased (-0.945680 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 1.5478596687316895
Epoch: 5, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.951251 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 1.6404974460601807
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 1.5927784442901611
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6016845703125
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.258 Vali Acc: 0.940 Test Loss: 0.258 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6463146209716797
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.960305 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 1.5195670127868652
Epoch: 10, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 1.494288444519043
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.974233 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 1.5893340110778809
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5616304874420166
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4781970977783203
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4275460243225098
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4681861400604248
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.335 Vali Acc: 0.945 Test Loss: 0.335 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.474961519241333
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5217564105987549
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4579315185546875
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.974 Test Loss: 0.216 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4810609817504883
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.148 Vali Acc: 0.980 Test Loss: 0.148 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4183435440063477
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 22592276
model size : 100.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8621509075164795
Epoch: 1, Steps: 89 | Train Loss: 2.148 Vali Loss: 0.583 Vali Acc: 0.825 Test Loss: 0.583 Test Acc: 0.825
Validation loss decreased (inf --> -0.825203).  Saving model ...
Epoch: 2 cost time: 1.606412649154663
Epoch: 2, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.281 Vali Acc: 0.913 Test Loss: 0.281 Test Acc: 0.913
Validation loss decreased (-0.825203 --> -0.912950).  Saving model ...
Epoch: 3 cost time: 1.6676599979400635
Epoch: 3, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.912950 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 1.619760274887085
Epoch: 4, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.962394 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 1.5204880237579346
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.7695868015289307
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.974233 --> -0.983286).  Saving model ...
Epoch: 7 cost time: 1.6196298599243164
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5631780624389648
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5902109146118164
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.987464).  Saving model ...
Epoch: 10 cost time: 1.4795441627502441
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5897526741027832
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.547633409500122
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6118652820587158
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4654614925384521
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.217 Vali Acc: 0.961 Test Loss: 0.217 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6521944999694824
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6897757053375244
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6697347164154053
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.626089096069336
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5526113510131836
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.985 Test Loss: 0.093 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 22423316
model size : 100.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8406753540039062
Epoch: 1, Steps: 89 | Train Loss: 1.679 Vali Loss: 0.688 Vali Acc: 0.826 Test Loss: 0.688 Test Acc: 0.826
Validation loss decreased (inf --> -0.825898).  Saving model ...
Epoch: 2 cost time: 1.6851325035095215
Epoch: 2, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.335 Vali Acc: 0.898 Test Loss: 0.335 Test Acc: 0.898
Validation loss decreased (-0.825898 --> -0.898325).  Saving model ...
Epoch: 3 cost time: 1.7229385375976562
Epoch: 3, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.219 Vali Acc: 0.947 Test Loss: 0.219 Test Acc: 0.947
Validation loss decreased (-0.898325 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 1.6475324630737305
Epoch: 4, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.201 Vali Acc: 0.955 Test Loss: 0.201 Test Acc: 0.955
Validation loss decreased (-0.947073 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 1.7051784992218018
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.376 Vali Acc: 0.942 Test Loss: 0.376 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.751399278640747
Epoch: 6, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.374 Vali Acc: 0.926 Test Loss: 0.374 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6696035861968994
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7296910285949707
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.960304).  Saving model ...
Epoch: 9 cost time: 1.775003433227539
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.262 Vali Acc: 0.960 Test Loss: 0.262 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7257308959960938
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.250 Vali Acc: 0.964 Test Loss: 0.250 Test Acc: 0.964
Validation loss decreased (-0.960304 --> -0.964482).  Saving model ...
Epoch: 11 cost time: 1.767918348312378
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.964482 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 1.8082654476165771
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.967 Test Loss: 0.213 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7517483234405518
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.299 Vali Acc: 0.969 Test Loss: 0.299 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7283234596252441
Epoch: 14, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.957 Test Loss: 0.295 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7618262767791748
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.268 Vali Acc: 0.976 Test Loss: 0.268 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975624).  Saving model ...
Epoch: 16 cost time: 1.8179547786712646
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.778475046157837
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.664 Vali Acc: 0.957 Test Loss: 0.664 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8099055290222168
Epoch: 18, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.255 Vali Acc: 0.973 Test Loss: 0.255 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7406690120697021
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.313 Vali Acc: 0.967 Test Loss: 0.313 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.760118007659912
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.275 Vali Acc: 0.971 Test Loss: 0.275 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7828271389007568
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.421 Vali Acc: 0.949 Test Loss: 0.421 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7391571998596191
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.978 Test Loss: 0.210 Test Acc: 0.978
Validation loss decreased (-0.975624 --> -0.977714).  Saving model ...
Epoch: 23 cost time: 1.7316648960113525
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.476 Vali Acc: 0.951 Test Loss: 0.476 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7290115356445312
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.973 Test Loss: 0.240 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7601478099822998
Epoch: 25, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7739319801330566
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.316 Vali Acc: 0.966 Test Loss: 0.316 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6712372303009033
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.258 Vali Acc: 0.969 Test Loss: 0.258 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7132203578948975
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.408 Vali Acc: 0.958 Test Loss: 0.408 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6700401306152344
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.978 Test Loss: 0.240 Test Acc: 0.978
Validation loss decreased (-0.977714 --> -0.978410).  Saving model ...
Epoch: 30 cost time: 1.757885456085205
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.981 Test Loss: 0.181 Test Acc: 0.981
Validation loss decreased (-0.978410 --> -0.980500).  Saving model ...
Epoch: 31 cost time: 1.7752761840820312
Epoch: 31, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.987 Test Loss: 0.167 Test Acc: 0.987
Validation loss decreased (-0.980500 --> -0.986767).  Saving model ...
Epoch: 32 cost time: 1.7054784297943115
Epoch: 32, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.427 Vali Acc: 0.968 Test Loss: 0.427 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7143638134002686
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.248 Vali Acc: 0.977 Test Loss: 0.248 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7212460041046143
Epoch: 34, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.226 Vali Acc: 0.977 Test Loss: 0.226 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8823320865631104
Epoch: 35, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.285 Vali Acc: 0.974 Test Loss: 0.285 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7930798530578613
Epoch: 36, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.219 Vali Acc: 0.986 Test Loss: 0.219 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8026123046875
Epoch: 37, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.273 Vali Acc: 0.980 Test Loss: 0.273 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.6930572986602783
Epoch: 38, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.200 Vali Acc: 0.986 Test Loss: 0.200 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.753495693206787
Epoch: 39, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.241 Vali Acc: 0.982 Test Loss: 0.241 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.7840871810913086
Epoch: 40, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.987 Test Loss: 0.192 Test Acc: 0.987
Validation loss decreased (-0.986767 --> -0.987463).  Saving model ...
Epoch: 41 cost time: 1.7383778095245361
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.985 Test Loss: 0.203 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7140185832977295
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.974 Test Loss: 0.265 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7163262367248535
Epoch: 43, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.246 Vali Acc: 0.981 Test Loss: 0.246 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7243986129760742
Epoch: 44, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.377 Vali Acc: 0.978 Test Loss: 0.377 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.7740037441253662
Epoch: 45, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.347 Vali Acc: 0.974 Test Loss: 0.347 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.8517158031463623
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.978 Test Loss: 0.355 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6971523761749268
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.980 Test Loss: 0.339 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.8220324516296387
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.980 Test Loss: 0.332 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.7424840927124023
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.980 Test Loss: 0.331 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.7925810813903809
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.978 Test Loss: 0.326 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 22818836
model size : 101.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.82456374168396
Epoch: 1, Steps: 89 | Train Loss: 1.878 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (inf --> -0.850274).  Saving model ...
Epoch: 2 cost time: 1.5732088088989258
Epoch: 2, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
Validation loss decreased (-0.850274 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 1.675529956817627
Epoch: 3, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.934538 --> -0.974233).  Saving model ...
Epoch: 4 cost time: 1.7143034934997559
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5889348983764648
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5855567455291748
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 1.6338953971862793
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.480694055557251
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.568669319152832
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4198968410491943
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.080 Vali Acc: 0.988 Test Loss: 0.080 Test Acc: 0.988
Validation loss decreased (-0.981197 --> -0.988161).  Saving model ...
Epoch: 11 cost time: 1.584805965423584
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4908745288848877
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6315720081329346
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.49631667137146
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.214 Vali Acc: 0.965 Test Loss: 0.214 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6519749164581299
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.360 Vali Acc: 0.966 Test Loss: 0.360 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6446149349212646
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.269 Vali Acc: 0.970 Test Loss: 0.269 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6290864944458008
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.167 Vali Acc: 0.976 Test Loss: 0.167 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.819110631942749
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6399126052856445
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.543562650680542
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 22565396
model size : 100.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.6292784214019775
Epoch: 1, Steps: 89 | Train Loss: 2.175 Vali Loss: 0.596 Vali Acc: 0.834 Test Loss: 0.596 Test Acc: 0.834
Validation loss decreased (inf --> -0.833559).  Saving model ...
Epoch: 2 cost time: 1.6750125885009766
Epoch: 2, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.251 Vali Acc: 0.936 Test Loss: 0.251 Test Acc: 0.936
Validation loss decreased (-0.833559 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 1.6612834930419922
Epoch: 3, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
Validation loss decreased (-0.935931 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 1.6097745895385742
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.952644 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 1.5098514556884766
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.967965 --> -0.984679).  Saving model ...
Epoch: 6 cost time: 1.5656147003173828
Epoch: 6, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4844520092010498
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985376).  Saving model ...
Epoch: 8 cost time: 1.654834270477295
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5138015747070312
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7110025882720947
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5825836658477783
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
Validation loss decreased (-0.985376 --> -0.986072).  Saving model ...
Epoch: 12 cost time: 1.6538097858428955
Epoch: 12, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.056 Vali Acc: 0.989 Test Loss: 0.056 Test Acc: 0.989
Validation loss decreased (-0.986072 --> -0.988857).  Saving model ...
Epoch: 13 cost time: 1.457028865814209
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5588982105255127
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6427736282348633
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.477501392364502
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5289936065673828
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4420208930969238
Epoch: 18, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.560655117034912
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.450683355331421
Epoch: 20, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6051661968231201
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.547614336013794
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 22413332
model size : 100.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0310909748077393
Epoch: 1, Steps: 89 | Train Loss: 1.641 Vali Loss: 0.668 Vali Acc: 0.836 Test Loss: 0.668 Test Acc: 0.836
Validation loss decreased (inf --> -0.836344).  Saving model ...
Epoch: 2 cost time: 1.6008107662200928
Epoch: 2, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.836344 --> -0.919217).  Saving model ...
Epoch: 3 cost time: 1.7233281135559082
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
Validation loss decreased (-0.919217 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 1.7055394649505615
Epoch: 4, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.540 Vali Acc: 0.906 Test Loss: 0.540 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8064522743225098
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.215 Vali Acc: 0.968 Test Loss: 0.215 Test Acc: 0.968
Validation loss decreased (-0.933145 --> -0.967964).  Saving model ...
Epoch: 6 cost time: 1.6996641159057617
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.221 Vali Acc: 0.962 Test Loss: 0.221 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7710590362548828
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.454 Vali Acc: 0.938 Test Loss: 0.454 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7415413856506348
Epoch: 8, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.967964 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 1.784985065460205
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.227 Vali Acc: 0.960 Test Loss: 0.227 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6946041584014893
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7928814888000488
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7486867904663086
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.978 Test Loss: 0.185 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978410).  Saving model ...
Epoch: 13 cost time: 1.7783074378967285
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.267 Vali Acc: 0.962 Test Loss: 0.267 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7804195880889893
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.971 Test Loss: 0.205 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7672185897827148
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.397 Vali Acc: 0.944 Test Loss: 0.397 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7191746234893799
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.215 Vali Acc: 0.974 Test Loss: 0.215 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7709660530090332
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.978 Test Loss: 0.223 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7554295063018799
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.984 Test Loss: 0.199 Test Acc: 0.984
Validation loss decreased (-0.978410 --> -0.983981).  Saving model ...
Epoch: 19 cost time: 1.7686693668365479
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.983 Test Loss: 0.175 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7299435138702393
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.305 Vali Acc: 0.968 Test Loss: 0.305 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6808326244354248
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.970 Test Loss: 0.250 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6828160285949707
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.988 Test Loss: 0.149 Test Acc: 0.988
Validation loss decreased (-0.983981 --> -0.988160).  Saving model ...
Epoch: 23 cost time: 1.7601630687713623
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.982 Test Loss: 0.181 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7530629634857178
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.979 Test Loss: 0.228 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7140169143676758
Epoch: 25, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.225 Vali Acc: 0.979 Test Loss: 0.225 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.758357286453247
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.257 Vali Acc: 0.967 Test Loss: 0.257 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6635782718658447
Epoch: 27, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.234 Vali Acc: 0.980 Test Loss: 0.234 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.650407075881958
Epoch: 28, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.307 Vali Acc: 0.972 Test Loss: 0.307 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6942472457885742
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.366 Vali Acc: 0.969 Test Loss: 0.366 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7483010292053223
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.288 Vali Acc: 0.973 Test Loss: 0.288 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7727925777435303
Epoch: 31, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.983 Test Loss: 0.200 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7468476295471191
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.976 Test Loss: 0.229 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 22815764
model size : 101.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.498202323913574
Epoch: 1, Steps: 89 | Train Loss: 1.954 Vali Loss: 0.586 Vali Acc: 0.841 Test Loss: 0.586 Test Acc: 0.841
Validation loss decreased (inf --> -0.840523).  Saving model ...
Epoch: 2 cost time: 1.5564007759094238
Epoch: 2, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
Validation loss decreased (-0.840523 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 1.5551612377166748
Epoch: 3, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.955430 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 1.6019792556762695
Epoch: 4, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.967269 --> -0.980500).  Saving model ...
Epoch: 5 cost time: 1.6172881126403809
Epoch: 5, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6293363571166992
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983286).  Saving model ...
Epoch: 7 cost time: 1.5838980674743652
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6601545810699463
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.194 Vali Acc: 0.964 Test Loss: 0.194 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.590561866760254
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.371 Vali Acc: 0.952 Test Loss: 0.371 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.524360179901123
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.984 Test Loss: 0.126 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 11 cost time: 1.5606751441955566
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6358716487884521
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.596780776977539
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5934457778930664
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.59893798828125
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.989 Test Loss: 0.084 Test Acc: 0.989
Validation loss decreased (-0.983982 --> -0.988857).  Saving model ...
Epoch: 16 cost time: 1.518134593963623
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6268765926361084
Epoch: 17, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.224 Vali Acc: 0.965 Test Loss: 0.224 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3871817588806152
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5794379711151123
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6870813369750977
Epoch: 20, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.749420166015625
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7687723636627197
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.630626916885376
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.981 Test Loss: 0.207 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.559870958328247
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.988 Test Loss: 0.112 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.506861686706543
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.981 Test Loss: 0.170 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 22545428
model size : 100.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8230772018432617
Epoch: 1, Steps: 89 | Train Loss: 2.173 Vali Loss: 0.729 Vali Acc: 0.788 Test Loss: 0.729 Test Acc: 0.788
Validation loss decreased (inf --> -0.787597).  Saving model ...
Epoch: 2 cost time: 1.6664927005767822
Epoch: 2, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
Validation loss decreased (-0.787597 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 1.5598716735839844
Epoch: 3, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5958096981048584
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.953341 --> -0.973536).  Saving model ...
Epoch: 5 cost time: 1.7758824825286865
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.973536 --> -0.981197).  Saving model ...
Epoch: 6 cost time: 1.621936559677124
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7531819343566895
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6299426555633545
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.985375).  Saving model ...
Epoch: 9 cost time: 1.637927532196045
Epoch: 9, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6079394817352295
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6638729572296143
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6143014430999756
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6125338077545166
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.982 Test Loss: 0.127 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6074435710906982
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7275054454803467
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.633899211883545
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5452885627746582
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6121349334716797
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 22410260
model size : 100.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.928607225418091
Epoch: 1, Steps: 89 | Train Loss: 1.657 Vali Loss: 0.459 Vali Acc: 0.866 Test Loss: 0.459 Test Acc: 0.866
Validation loss decreased (inf --> -0.866291).  Saving model ...
Epoch: 2 cost time: 1.544264316558838
Epoch: 2, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
Validation loss decreased (-0.866291 --> -0.932448).  Saving model ...
Epoch: 3 cost time: 1.619584560394287
Epoch: 3, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
Validation loss decreased (-0.932448 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 1.6694495677947998
Epoch: 4, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6176540851593018
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.283 Vali Acc: 0.951 Test Loss: 0.283 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6345107555389404
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.162 Vali Acc: 0.974 Test Loss: 0.162 Test Acc: 0.974
Validation loss decreased (-0.954734 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 1.6481854915618896
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.224 Vali Acc: 0.962 Test Loss: 0.224 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.635385513305664
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.234 Vali Acc: 0.960 Test Loss: 0.234 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6972017288208008
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 1.5845108032226562
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 1.6212730407714844
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.196 Vali Acc: 0.976 Test Loss: 0.196 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6362988948822021
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7384114265441895
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 14 cost time: 1.6912779808044434
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7366175651550293
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.284 Vali Acc: 0.951 Test Loss: 0.284 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6140329837799072
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5388541221618652
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7260916233062744
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.711230754852295
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
Validation loss decreased (-0.981197 --> -0.986768).  Saving model ...
Epoch: 20 cost time: 1.7155492305755615
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.065 Vali Acc: 0.992 Test Loss: 0.065 Test Acc: 0.992
Validation loss decreased (-0.986768 --> -0.991643).  Saving model ...
Epoch: 21 cost time: 1.6080214977264404
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6257596015930176
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6907238960266113
Epoch: 23, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.170 Vali Acc: 0.982 Test Loss: 0.170 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5774431228637695
Epoch: 24, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6006932258605957
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.984 Test Loss: 0.114 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6219546794891357
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.983 Test Loss: 0.145 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.62188720703125
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.984 Test Loss: 0.129 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6589887142181396
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6209721565246582
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.985 Test Loss: 0.101 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.686173439025879
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9916434540389972
model parameter : 22728212
model size : 101.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.724560260772705
Epoch: 1, Steps: 89 | Train Loss: 1.935 Vali Loss: 0.846 Vali Acc: 0.761 Test Loss: 0.846 Test Acc: 0.761
Validation loss decreased (inf --> -0.761134).  Saving model ...
Epoch: 2 cost time: 1.6589443683624268
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.761134 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 1.5948731899261475
Epoch: 3, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
Validation loss decreased (-0.943591 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 1.651867151260376
Epoch: 4, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.949162 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 1.7405831813812256
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 1.639207363128662
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.971447 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 1.690675973892212
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6216065883636475
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5979664325714111
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6838209629058838
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5613465309143066
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 1.4881370067596436
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4966890811920166
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6226553916931152
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.984 Test Loss: 0.101 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 15 cost time: 1.6312675476074219
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.538754940032959
Epoch: 16, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.220 Vali Acc: 0.970 Test Loss: 0.220 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5087265968322754
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5476040840148926
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.984 Test Loss: 0.144 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5172743797302246
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.981 Test Loss: 0.149 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7552266120910645
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6363403797149658
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.695122480392456
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.177 Vali Acc: 0.984 Test Loss: 0.177 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5830767154693604
Epoch: 23, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6794164180755615
Epoch: 24, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.097 Vali Acc: 0.986 Test Loss: 0.097 Test Acc: 0.986
Validation loss decreased (-0.983982 --> -0.986071).  Saving model ...
Epoch: 25 cost time: 1.7864243984222412
Epoch: 25, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5692999362945557
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.675828218460083
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.571228265762329
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.991 Test Loss: 0.101 Test Acc: 0.991
Validation loss decreased (-0.986071 --> -0.990946).  Saving model ...
Epoch: 29 cost time: 1.6683993339538574
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.987 Test Loss: 0.137 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.646425724029541
Epoch: 30, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.987 Test Loss: 0.119 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3279383182525635
Epoch: 31, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.988 Test Loss: 0.122 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6949462890625
Epoch: 32, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.987 Test Loss: 0.134 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5137038230895996
Epoch: 33, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5799574851989746
Epoch: 34, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.984 Test Loss: 0.126 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.6112000942230225
Epoch: 35, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.987 Test Loss: 0.122 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5130081176757812
Epoch: 36, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.982 Test Loss: 0.162 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4726300239562988
Epoch: 37, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.970 Test Loss: 0.251 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.4731435775756836
Epoch: 38, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.176 Vali Acc: 0.985 Test Loss: 0.176 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9909470752089137
model parameter : 22525460
model size : 100.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8455166816711426
Epoch: 1, Steps: 89 | Train Loss: 2.291 Vali Loss: 0.758 Vali Acc: 0.770 Test Loss: 0.758 Test Acc: 0.770
Validation loss decreased (inf --> -0.770187).  Saving model ...
Epoch: 2 cost time: 1.5568451881408691
Epoch: 2, Steps: 89 | Train Loss: 0.476 Vali Loss: 0.255 Vali Acc: 0.921 Test Loss: 0.255 Test Acc: 0.921
Validation loss decreased (-0.770187 --> -0.921307).  Saving model ...
Epoch: 3 cost time: 1.6776020526885986
Epoch: 3, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
Validation loss decreased (-0.921307 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 1.446535587310791
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.52775239944458
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 1.598114013671875
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6982388496398926
Epoch: 7, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.973536 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 1.545968770980835
Epoch: 8, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6590871810913086
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7329390048980713
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6096622943878174
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5976171493530273
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7225885391235352
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 1.7830984592437744
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.575002670288086
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6430647373199463
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6715798377990723
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.670409917831421
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.140 Vali Acc: 0.979 Test Loss: 0.140 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6794536113739014
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5870444774627686
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6812615394592285
Epoch: 21, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7097983360290527
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7182316780090332
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 22407188
model size : 100.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.682101249694824
Epoch: 1, Steps: 89 | Train Loss: 1.742 Vali Loss: 0.551 Vali Acc: 0.854 Test Loss: 0.551 Test Acc: 0.854
Validation loss decreased (inf --> -0.853755).  Saving model ...
Epoch: 2 cost time: 1.6743273735046387
Epoch: 2, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.212 Vali Acc: 0.940 Test Loss: 0.212 Test Acc: 0.940
Validation loss decreased (-0.853755 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 1.8139958381652832
Epoch: 3, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.940109 --> -0.973536).  Saving model ...
Epoch: 4 cost time: 1.9305486679077148
Epoch: 4, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 1.7553706169128418
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8544769287109375
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7136876583099365
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.357 Vali Acc: 0.935 Test Loss: 0.357 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8153927326202393
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 1.755748987197876
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6118683815002441
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.639160394668579
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.355 Vali Acc: 0.942 Test Loss: 0.355 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6765224933624268
Epoch: 12, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.227 Vali Acc: 0.973 Test Loss: 0.227 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.881587028503418
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8703513145446777
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.990 Test Loss: 0.084 Test Acc: 0.990
Validation loss decreased (-0.981197 --> -0.989553).  Saving model ...
Epoch: 15 cost time: 1.7921957969665527
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.206 Vali Acc: 0.978 Test Loss: 0.206 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6907305717468262
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6938977241516113
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7240135669708252
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.264 Vali Acc: 0.965 Test Loss: 0.264 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6975691318511963
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.226 Vali Acc: 0.973 Test Loss: 0.226 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7639052867889404
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.319 Vali Acc: 0.968 Test Loss: 0.319 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7502410411834717
Epoch: 21, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.084 Vali Acc: 0.988 Test Loss: 0.084 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5793969631195068
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.988 Test Loss: 0.085 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6395399570465088
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.192 Vali Acc: 0.976 Test Loss: 0.192 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6585173606872559
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.175 Vali Acc: 0.981 Test Loss: 0.175 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 22742036
model size : 101.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.751957893371582
Epoch: 1, Steps: 89 | Train Loss: 1.946 Vali Loss: 0.657 Vali Acc: 0.801 Test Loss: 0.657 Test Acc: 0.801
Validation loss decreased (inf --> -0.800829).  Saving model ...
Epoch: 2 cost time: 1.6097023487091064
Epoch: 2, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
Validation loss decreased (-0.800829 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 1.763246774673462
Epoch: 3, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.955430 --> -0.970055).  Saving model ...
Epoch: 4 cost time: 1.5549898147583008
Epoch: 4, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.814662218093872
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.970055 --> -0.983983).  Saving model ...
Epoch: 6 cost time: 1.8394901752471924
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0229601860046387
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8814966678619385
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6891038417816162
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.095 Vali Acc: 0.986 Test Loss: 0.095 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986071).  Saving model ...
Epoch: 10 cost time: 1.6427509784698486
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.610440731048584
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8380036354064941
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.230052947998047
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4934720993041992
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.985 Test Loss: 0.151 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8150975704193115
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.252 Vali Acc: 0.967 Test Loss: 0.252 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7036044597625732
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.670440912246704
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8225080966949463
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.986768).  Saving model ...
Epoch: 19 cost time: 1.4443469047546387
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 20 cost time: 1.60335111618042
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7262167930603027
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6821372509002686
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.983 Test Loss: 0.187 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.830843448638916
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7793834209442139
Epoch: 24, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.40671706199646
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.158 Vali Acc: 0.981 Test Loss: 0.158 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7406861782073975
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.77457857131958
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6701884269714355
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.981 Test Loss: 0.183 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8009986877441406
Epoch: 29, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.339 Vali Acc: 0.963 Test Loss: 0.339 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 22522388
model size : 100.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8905627727508545
Epoch: 1, Steps: 89 | Train Loss: 2.245 Vali Loss: 0.713 Vali Acc: 0.799 Test Loss: 0.713 Test Acc: 0.799
Validation loss decreased (inf --> -0.798739).  Saving model ...
Epoch: 2 cost time: 1.6203126907348633
Epoch: 2, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.249 Vali Acc: 0.916 Test Loss: 0.249 Test Acc: 0.916
Validation loss decreased (-0.798739 --> -0.916432).  Saving model ...
Epoch: 3 cost time: 1.8012285232543945
Epoch: 3, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.123 Vali Acc: 0.961 Test Loss: 0.123 Test Acc: 0.961
Validation loss decreased (-0.916432 --> -0.961002).  Saving model ...
Epoch: 4 cost time: 1.6336724758148193
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
Validation loss decreased (-0.961002 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 1.5566115379333496
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3679838180541992
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 1.632765293121338
Epoch: 7, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 1.6167778968811035
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5570216178894043
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.975626 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 1.5461533069610596
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5563604831695557
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 1.689363956451416
Epoch: 12, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 13 cost time: 1.8596405982971191
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5515477657318115
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6881651878356934
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5944883823394775
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7046818733215332
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6138041019439697
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6144218444824219
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6930394172668457
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.343407154083252
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.716827154159546
Epoch: 22, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 22404116
model size : 100.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7542805671691895
Epoch: 1, Steps: 89 | Train Loss: 1.678 Vali Loss: 0.484 Vali Acc: 0.855 Test Loss: 0.484 Test Acc: 0.855
Validation loss decreased (inf --> -0.855148).  Saving model ...
Epoch: 2 cost time: 1.5842812061309814
Epoch: 2, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.855148 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 1.77262282371521
Epoch: 3, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
Validation loss decreased (-0.951948 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 1.5498075485229492
Epoch: 4, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4735181331634521
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.967269 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 1.5258336067199707
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6783418655395508
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3925974369049072
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 9 cost time: 1.6838090419769287
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.732283592224121
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8752996921539307
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2901363372802734
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7152259349822998
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.536862850189209
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.54115891456604
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.985 Test Loss: 0.096 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 16 cost time: 1.6343162059783936
Epoch: 16, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.989 Test Loss: 0.101 Test Acc: 0.989
Validation loss decreased (-0.985375 --> -0.988857).  Saving model ...
Epoch: 17 cost time: 1.6700639724731445
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7462310791015625
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7479143142700195
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.984 Test Loss: 0.114 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8331060409545898
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5388102531433105
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.719127893447876
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.183 Vali Acc: 0.977 Test Loss: 0.183 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6881670951843262
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.090 Vali Acc: 0.991 Test Loss: 0.090 Test Acc: 0.991
Validation loss decreased (-0.988857 --> -0.990946).  Saving model ...
Epoch: 24 cost time: 1.5742340087890625
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.991 Test Loss: 0.076 Test Acc: 0.991
Validation loss decreased (-0.990946 --> -0.990946).  Saving model ...
Epoch: 25 cost time: 1.4282503128051758
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6030423641204834
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.984 Test Loss: 0.108 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6805224418640137
Epoch: 27, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6632461547851562
Epoch: 28, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.104 Vali Acc: 0.990 Test Loss: 0.104 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.574429988861084
Epoch: 29, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6436498165130615
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6234519481658936
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.057 Vali Acc: 0.990 Test Loss: 0.057 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5044386386871338
Epoch: 32, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.075 Vali Acc: 0.992 Test Loss: 0.075 Test Acc: 0.992
Validation loss decreased (-0.990946 --> -0.991643).  Saving model ...
Epoch: 33 cost time: 1.6426947116851807
Epoch: 33, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6886906623840332
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5978515148162842
Epoch: 35, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.986 Test Loss: 0.141 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6265769004821777
Epoch: 36, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.983 Test Loss: 0.158 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.409653663635254
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.987 Test Loss: 0.114 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7711493968963623
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.987 Test Loss: 0.110 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.7243220806121826
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.988 Test Loss: 0.110 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6914737224578857
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.988 Test Loss: 0.110 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.587960958480835
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.988 Test Loss: 0.110 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.608823299407959
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9916434540389972
model parameter : 22695188
model size : 101.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.968451738357544
Epoch: 1, Steps: 89 | Train Loss: 1.921 Vali Loss: 0.521 Vali Acc: 0.852 Test Loss: 0.521 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 1.6650300025939941
Epoch: 2, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.852362 --> -0.962394).  Saving model ...
Epoch: 3 cost time: 1.4857380390167236
Epoch: 3, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.962394 --> -0.980500).  Saving model ...
Epoch: 4 cost time: 1.8058178424835205
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5281908512115479
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7447354793548584
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 1.5643322467803955
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.076 Vali Acc: 0.989 Test Loss: 0.076 Test Acc: 0.989
Validation loss decreased (-0.982590 --> -0.988857).  Saving model ...
Epoch: 8 cost time: 1.8616943359375
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.042 Vali Acc: 0.993 Test Loss: 0.042 Test Acc: 0.993
Validation loss decreased (-0.988857 --> -0.993036).  Saving model ...
Epoch: 9 cost time: 1.8532099723815918
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8280003070831299
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9567577838897705
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9191744327545166
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3360626697540283
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5128419399261475
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5888054370880127
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.604973316192627
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6123385429382324
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7401127815246582
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9930362116991643
model parameter : 22526228
model size : 100.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.6989846229553223
Epoch: 1, Steps: 89 | Train Loss: 2.185 Vali Loss: 0.679 Vali Acc: 0.814 Test Loss: 0.679 Test Acc: 0.814
Validation loss decreased (inf --> -0.814060).  Saving model ...
Epoch: 2 cost time: 1.5451152324676514
Epoch: 2, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.814060 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 1.5971670150756836
Epoch: 3, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.937324 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 1.6183221340179443
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.951948 --> -0.979804).  Saving model ...
Epoch: 5 cost time: 1.6264631748199463
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7037546634674072
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.762204647064209
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 1.7107672691345215
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 9 cost time: 1.340965747833252
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 10 cost time: 1.5176010131835938
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 11 cost time: 1.6677615642547607
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7197141647338867
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6335346698760986
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8050510883331299
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8176188468933105
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6417112350463867
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6711268424987793
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7476577758789062
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.056 Vali Acc: 0.989 Test Loss: 0.056 Test Acc: 0.989
Validation loss decreased (-0.986768 --> -0.988857).  Saving model ...
Epoch: 19 cost time: 1.8038997650146484
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6678283214569092
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.976 Test Loss: 0.167 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0358645915985107
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6103999614715576
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.70279860496521
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.062 Vali Acc: 0.992 Test Loss: 0.062 Test Acc: 0.992
Validation loss decreased (-0.988857 --> -0.991643).  Saving model ...
Epoch: 24 cost time: 1.5773868560791016
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.990 Test Loss: 0.084 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.742788553237915
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.987 Test Loss: 0.124 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5898351669311523
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.985 Test Loss: 0.152 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5410616397857666
Epoch: 27, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5042765140533447
Epoch: 28, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6862010955810547
Epoch: 29, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.153 Vali Acc: 0.983 Test Loss: 0.153 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3577964305877686
Epoch: 30, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.983 Test Loss: 0.151 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6723508834838867
Epoch: 31, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7274909019470215
Epoch: 32, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.983 Test Loss: 0.166 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8018484115600586
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.987 Test Loss: 0.128 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9916434540389972
model parameter : 22424852
model size : 100.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.5074243545532227
Epoch: 1, Steps: 89 | Train Loss: 1.771 Vali Loss: 0.535 Vali Acc: 0.854 Test Loss: 0.535 Test Acc: 0.854
Validation loss decreased (inf --> -0.853755).  Saving model ...
Epoch: 2 cost time: 1.5942435264587402
Epoch: 2, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
Validation loss decreased (-0.853755 --> -0.925485).  Saving model ...
Epoch: 3 cost time: 1.6886720657348633
Epoch: 3, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.290 Vali Acc: 0.935 Test Loss: 0.290 Test Acc: 0.935
Validation loss decreased (-0.925485 --> -0.935234).  Saving model ...
Epoch: 4 cost time: 1.646543025970459
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.935234 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 1.5654335021972656
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.795140027999878
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8182544708251953
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.708266258239746
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 1.9586572647094727
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 1.7143540382385254
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.220 Vali Acc: 0.970 Test Loss: 0.220 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6788685321807861
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6417312622070312
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6397294998168945
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7476155757904053
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6672999858856201
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7830467224121094
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 1.4352471828460693
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.186 Vali Acc: 0.980 Test Loss: 0.186 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7469568252563477
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7834324836730957
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.417 Vali Acc: 0.951 Test Loss: 0.417 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.715369462966919
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.244 Vali Acc: 0.971 Test Loss: 0.244 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6217782497406006
Epoch: 21, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8886642456054688
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.148 Vali Acc: 0.983 Test Loss: 0.148 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7397873401641846
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 1.6568102836608887
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8355906009674072
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.650456428527832
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.988 Test Loss: 0.163 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988160).  Saving model ...
Epoch: 27 cost time: 1.8310179710388184
Epoch: 27, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.979 Test Loss: 0.150 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6884987354278564
Epoch: 28, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.131 Vali Acc: 0.985 Test Loss: 0.131 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8522593975067139
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7737762928009033
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.987 Test Loss: 0.121 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6714680194854736
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7036633491516113
Epoch: 32, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.805161952972412
Epoch: 33, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.065 Vali Acc: 0.988 Test Loss: 0.065 Test Acc: 0.988
Validation loss decreased (-0.988160 --> -0.988161).  Saving model ...
Epoch: 34 cost time: 1.6648788452148438
Epoch: 34, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.056 Vali Acc: 0.988 Test Loss: 0.056 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 35 cost time: 1.631711721420288
Epoch: 35, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.854994535446167
Epoch: 36, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.986 Test Loss: 0.114 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5902206897735596
Epoch: 37, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.989 Test Loss: 0.094 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 38 cost time: 2.025343418121338
Epoch: 38, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.990 Test Loss: 0.085 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989553).  Saving model ...
Epoch: 39 cost time: 1.5276472568511963
Epoch: 39, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8280341625213623
Epoch: 40, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.988 Test Loss: 0.098 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7514541149139404
Epoch: 41, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.988 Test Loss: 0.094 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7125177383422852
Epoch: 42, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5648722648620605
Epoch: 43, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.990 Test Loss: 0.102 Test Acc: 0.990
Validation loss decreased (-0.989553 --> -0.990250).  Saving model ...
Epoch: 44 cost time: 1.899235725402832
Epoch: 44, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.983 Test Loss: 0.143 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6109583377838135
Epoch: 45, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.985 Test Loss: 0.199 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7115380764007568
Epoch: 46, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.984 Test Loss: 0.181 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6263620853424072
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.984 Test Loss: 0.158 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.7112350463867188
Epoch: 48, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.986 Test Loss: 0.169 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.7714409828186035
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.987 Test Loss: 0.148 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8071208000183105
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.988 Test Loss: 0.147 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 22662164
model size : 101.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.764443874359131
Epoch: 1, Steps: 89 | Train Loss: 2.007 Vali Loss: 0.536 Vali Acc: 0.848 Test Loss: 0.536 Test Acc: 0.848
Validation loss decreased (inf --> -0.848184).  Saving model ...
Epoch: 2 cost time: 1.6802973747253418
Epoch: 2, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.217 Vali Acc: 0.936 Test Loss: 0.217 Test Acc: 0.936
Validation loss decreased (-0.848184 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 1.6261439323425293
Epoch: 3, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.935931 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 1.6675610542297363
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 1.6742236614227295
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5230200290679932
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 1.5117137432098389
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.061 Vali Acc: 0.989 Test Loss: 0.061 Test Acc: 0.989
Validation loss decreased (-0.978411 --> -0.988857).  Saving model ...
Epoch: 8 cost time: 1.6643500328063965
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4327621459960938
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6839191913604736
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6646852493286133
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.279 Vali Acc: 0.953 Test Loss: 0.279 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6328635215759277
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6161561012268066
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7052240371704102
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7308578491210938
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.069 Vali Acc: 0.989 Test Loss: 0.069 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6993615627288818
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6855056285858154
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 22510100
model size : 100.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.493960380554199
Epoch: 1, Steps: 89 | Train Loss: 2.293 Vali Loss: 0.819 Vali Acc: 0.751 Test Loss: 0.819 Test Acc: 0.751
Validation loss decreased (inf --> -0.751385).  Saving model ...
Epoch: 2 cost time: 1.6321392059326172
Epoch: 2, Steps: 89 | Train Loss: 0.503 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.751385 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 1.6153779029846191
Epoch: 3, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
Validation loss decreased (-0.937324 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 1.4973728656768799
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.961001 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 1.835557460784912
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7137231826782227
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6978685855865479
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 1.8887989521026611
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 9 cost time: 1.4496228694915771
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.598358392715454
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.56911301612854
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.706303358078003
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.064 Vali Acc: 0.988 Test Loss: 0.064 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 13 cost time: 1.659773826599121
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6296427249908447
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6862647533416748
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.730424165725708
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6237940788269043
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4786369800567627
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6199979782104492
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.58072829246521
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.636444091796875
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5504937171936035
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 22425620
model size : 100.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.933499813079834
Epoch: 1, Steps: 89 | Train Loss: 1.847 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
Validation loss decreased (inf --> -0.861416).  Saving model ...
Epoch: 2 cost time: 1.7263786792755127
Epoch: 2, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.222 Vali Acc: 0.927 Test Loss: 0.222 Test Acc: 0.927
Validation loss decreased (-0.861416 --> -0.926878).  Saving model ...
Epoch: 3 cost time: 1.737837314605713
Epoch: 3, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.926878 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 1.6665716171264648
Epoch: 4, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.967269 --> -0.979108).  Saving model ...
Epoch: 5 cost time: 1.7968971729278564
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.055 Vali Acc: 0.984 Test Loss: 0.055 Test Acc: 0.984
Validation loss decreased (-0.979108 --> -0.983983).  Saving model ...
Epoch: 6 cost time: 1.7015893459320068
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 7 cost time: 1.52815842628479
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7961792945861816
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5267553329467773
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5625336170196533
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5317633152008057
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7183127403259277
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4917738437652588
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7033581733703613
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.964 Test Loss: 0.211 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8836123943328857
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.278 Vali Acc: 0.960 Test Loss: 0.278 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9663243293762207
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 22636052
model size : 101.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7362842559814453
Epoch: 1, Steps: 89 | Train Loss: 2.074 Vali Loss: 0.589 Vali Acc: 0.823 Test Loss: 0.589 Test Acc: 0.823
Validation loss decreased (inf --> -0.823114).  Saving model ...
Epoch: 2 cost time: 1.7695879936218262
Epoch: 2, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.192 Vali Acc: 0.947 Test Loss: 0.192 Test Acc: 0.947
Validation loss decreased (-0.823114 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 1.3371365070343018
Epoch: 3, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
Validation loss decreased (-0.947073 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 1.662003517150879
Epoch: 4, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.756486415863037
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 1.638383388519287
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.972840 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 1.62977933883667
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.054 Vali Acc: 0.990 Test Loss: 0.054 Test Acc: 0.990
Validation loss decreased (-0.982590 --> -0.989554).  Saving model ...
Epoch: 8 cost time: 1.6603021621704102
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.984 Test Loss: 0.111 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7064239978790283
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6327106952667236
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5447897911071777
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.581244707107544
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6727375984191895
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4620230197906494
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5136325359344482
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5492558479309082
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4929356575012207
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.984 Test Loss: 0.118 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 22517780
model size : 100.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.4589731693267822
Epoch: 1, Steps: 89 | Train Loss: 2.323 Vali Loss: 0.813 Vali Acc: 0.747 Test Loss: 0.813 Test Acc: 0.747
Validation loss decreased (inf --> -0.747206).  Saving model ...
Epoch: 2 cost time: 1.7099926471710205
Epoch: 2, Steps: 89 | Train Loss: 0.497 Vali Loss: 0.242 Vali Acc: 0.924 Test Loss: 0.242 Test Acc: 0.924
Validation loss decreased (-0.747206 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 1.7248356342315674
Epoch: 3, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.924092 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 1.7725470066070557
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.686765432357788
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.965180 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 1.5726335048675537
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7059502601623535
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 1.6070404052734375
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.974929 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 1.6363396644592285
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 1.2534146308898926
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 11 cost time: 1.6449687480926514
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 12 cost time: 1.6596052646636963
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7533729076385498
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6184937953948975
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.73964524269104
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6900627613067627
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5994212627410889
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6683127880096436
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6972157955169678
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6534314155578613
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6603479385375977
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_GPT4TS_UEA_ftM_sl182_ll0_pl0_el3_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 22450196
model size : 100.31MB
