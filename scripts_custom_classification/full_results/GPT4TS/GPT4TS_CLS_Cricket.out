Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2560930252075195
Epoch: 1, Steps: 7 | Train Loss: 2.668 Vali Loss: 2.355 Vali Acc: 0.306 Test Loss: 2.355 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 1.1849205493927002
Epoch: 2, Steps: 7 | Train Loss: 2.185 Vali Loss: 1.722 Vali Acc: 0.625 Test Loss: 1.722 Test Acc: 0.625
Validation loss decreased (-0.305532 --> -0.624983).  Saving model ...
Epoch: 3 cost time: 1.681394338607788
Epoch: 3, Steps: 7 | Train Loss: 1.343 Vali Loss: 0.877 Vali Acc: 0.819 Test Loss: 0.877 Test Acc: 0.819
Validation loss decreased (-0.624983 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 1.4651539325714111
Epoch: 4, Steps: 7 | Train Loss: 0.528 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 1.7091078758239746
Epoch: 5, Steps: 7 | Train Loss: 0.352 Vali Loss: 0.590 Vali Acc: 0.847 Test Loss: 0.590 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 1.2813105583190918
Epoch: 6, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 2.0642099380493164
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.556328535079956
Epoch: 8, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.2886040210723877
Epoch: 9, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.444 Vali Acc: 0.917 Test Loss: 0.444 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4489219188690186
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.593597650527954
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.903 Test Loss: 0.417 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.038809299468994
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8523197174072266
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4387223720550537
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9773139953613281
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8493168354034424
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.689845085144043
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 1.7525393962860107
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 1.7128913402557373
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.55558443069458
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.551192045211792
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.72591233253479
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6893272399902344
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 1.3975374698638916
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 1.7039108276367188
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 1.9018700122833252
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 1.7174525260925293
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.560586929321289
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7629706859588623
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.9199082851409912
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9098465442657471
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.758239984512329
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.724550485610962
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8803565502166748
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7940723896026611
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8661959171295166
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4750480651855469
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4106988906860352
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2390875816345215
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 45080076
model size : 186.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4483158588409424
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.411 Vali Acc: 0.236 Test Loss: 2.411 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 1.110248327255249
Epoch: 2, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.131 Vali Acc: 0.472 Test Loss: 2.131 Test Acc: 0.472
Validation loss decreased (-0.236087 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 1.1969335079193115
Epoch: 3, Steps: 7 | Train Loss: 1.771 Vali Loss: 1.402 Vali Acc: 0.778 Test Loss: 1.402 Test Acc: 0.778
Validation loss decreased (-0.472201 --> -0.777764).  Saving model ...
Epoch: 4 cost time: 1.3259947299957275
Epoch: 4, Steps: 7 | Train Loss: 1.087 Vali Loss: 0.731 Vali Acc: 0.861 Test Loss: 0.731 Test Acc: 0.861
Validation loss decreased (-0.777764 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.1611974239349365
Epoch: 5, Steps: 7 | Train Loss: 0.439 Vali Loss: 0.540 Vali Acc: 0.833 Test Loss: 0.540 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4118645191192627
Epoch: 6, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.411 Vali Acc: 0.861 Test Loss: 0.411 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 1.4109587669372559
Epoch: 7, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.3006901741027832
Epoch: 8, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.219069480895996
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.0978074073791504
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2325520515441895
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 1.040116786956787
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2446801662445068
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.235239028930664
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2263989448547363
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2681145668029785
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.304650068283081
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0112063884735107
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4587128162384033
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3059651851654053
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2999639511108398
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.447922706604004
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3053195476531982
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 1.3232712745666504
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.2358884811401367
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.2514681816101074
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2635858058929443
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.148744821548462
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 1.373077392578125
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1161277294158936
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2942912578582764
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.266249179840088
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 1.1411662101745605
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.2693352699279785
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.3671860694885254
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 1.1160807609558105
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.0714871883392334
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0136888027191162
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0433320999145508
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.380922794342041
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3253130912780762
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0939102172851562
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.163325548171997
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9417378902435303
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0285861492156982
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2796630859375
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44563980
model size : 184.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4709677696228027
Epoch: 1, Steps: 7 | Train Loss: 2.630 Vali Loss: 2.511 Vali Acc: 0.125 Test Loss: 2.511 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.012573003768921
Epoch: 2, Steps: 7 | Train Loss: 2.393 Vali Loss: 2.222 Vali Acc: 0.292 Test Loss: 2.222 Test Acc: 0.292
Validation loss decreased (-0.124975 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 1.0212574005126953
Epoch: 3, Steps: 7 | Train Loss: 2.039 Vali Loss: 1.827 Vali Acc: 0.597 Test Loss: 1.827 Test Acc: 0.597
Validation loss decreased (-0.291644 --> -0.597204).  Saving model ...
Epoch: 4 cost time: 0.5730154514312744
Epoch: 4, Steps: 7 | Train Loss: 1.559 Vali Loss: 1.282 Vali Acc: 0.819 Test Loss: 1.282 Test Acc: 0.819
Validation loss decreased (-0.597204 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 0.659395694732666
Epoch: 5, Steps: 7 | Train Loss: 0.989 Vali Loss: 0.769 Vali Acc: 0.806 Test Loss: 0.769 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6518335342407227
Epoch: 6, Steps: 7 | Train Loss: 0.504 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 0.6361954212188721
Epoch: 7, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.8637685775756836
Epoch: 8, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.987788200378418
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.8583688735961914
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.0189225673675537
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.9237940311431885
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7930436134338379
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.9669857025146484
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8879468441009521
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 0.9703357219696045
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 17 cost time: 0.6533622741699219
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 0.6096727848052979
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 0.7724626064300537
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 0.9629089832305908
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 0.92755126953125
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8999481201171875
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8509047031402588
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8383893966674805
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9406495094299316
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9588820934295654
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8031744956970215
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9208955764770508
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8404450416564941
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9479618072509766
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 44305932
model size : 183.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.741877794265747
Epoch: 1, Steps: 7 | Train Loss: 2.592 Vali Loss: 2.382 Vali Acc: 0.139 Test Loss: 2.382 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.2832252979278564
Epoch: 2, Steps: 7 | Train Loss: 2.264 Vali Loss: 1.865 Vali Acc: 0.472 Test Loss: 1.865 Test Acc: 0.472
Validation loss decreased (-0.138865 --> -0.472204).  Saving model ...
Epoch: 3 cost time: 1.3007879257202148
Epoch: 3, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.211 Vali Acc: 0.792 Test Loss: 1.211 Test Acc: 0.792
Validation loss decreased (-0.472204 --> -0.791655).  Saving model ...
Epoch: 4 cost time: 1.491032361984253
Epoch: 4, Steps: 7 | Train Loss: 0.760 Vali Loss: 0.652 Vali Acc: 0.861 Test Loss: 0.652 Test Acc: 0.861
Validation loss decreased (-0.791655 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 1.237041711807251
Epoch: 5, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.6364216804504395
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4312748908996582
Epoch: 7, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.395 Vali Acc: 0.917 Test Loss: 0.395 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.6885881423950195
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.889 Test Loss: 0.596 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5422003269195557
Epoch: 9, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.475809097290039
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.917 Test Loss: 0.431 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1569881439208984
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.903 Test Loss: 0.456 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.637068748474121
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.889 Test Loss: 0.481 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6101601123809814
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2321455478668213
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7495238780975342
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7353377342224121
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0840246677398682
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 45032460
model size : 186.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.655339479446411
Epoch: 1, Steps: 7 | Train Loss: 2.706 Vali Loss: 2.462 Vali Acc: 0.111 Test Loss: 2.462 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.8907530307769775
Epoch: 2, Steps: 7 | Train Loss: 2.368 Vali Loss: 2.114 Vali Acc: 0.264 Test Loss: 2.114 Test Acc: 0.264
Validation loss decreased (-0.111086 --> -0.263868).  Saving model ...
Epoch: 3 cost time: 1.3120012283325195
Epoch: 3, Steps: 7 | Train Loss: 1.990 Vali Loss: 1.653 Vali Acc: 0.681 Test Loss: 1.653 Test Acc: 0.681
Validation loss decreased (-0.263868 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 1.1586227416992188
Epoch: 4, Steps: 7 | Train Loss: 1.376 Vali Loss: 1.139 Vali Acc: 0.806 Test Loss: 1.139 Test Acc: 0.806
Validation loss decreased (-0.680539 --> -0.805544).  Saving model ...
Epoch: 5 cost time: 1.3217217922210693
Epoch: 5, Steps: 7 | Train Loss: 0.681 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
Validation loss decreased (-0.805544 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 1.5486879348754883
Epoch: 6, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.252723217010498
Epoch: 7, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2660658359527588
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2010760307312012
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.599 Vali Acc: 0.861 Test Loss: 0.599 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.30373215675354
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8005251884460449
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3862862586975098
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1621334552764893
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.417961835861206
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4532556533813477
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 16 cost time: 1.1431794166564941
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1415536403656006
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1862938404083252
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1425917148590088
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1595239639282227
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.331601858139038
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1092920303344727
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1564624309539795
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2516851425170898
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.108367681503296
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 44570124
model size : 184.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.23577618598938
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.498 Vali Acc: 0.069 Test Loss: 2.498 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.9455733299255371
Epoch: 2, Steps: 7 | Train Loss: 2.410 Vali Loss: 2.291 Vali Acc: 0.278 Test Loss: 2.291 Test Acc: 0.278
Validation loss decreased (-0.069419 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.7508172988891602
Epoch: 3, Steps: 7 | Train Loss: 2.145 Vali Loss: 1.977 Vali Acc: 0.542 Test Loss: 1.977 Test Acc: 0.542
Validation loss decreased (-0.277755 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 1.1142284870147705
Epoch: 4, Steps: 7 | Train Loss: 1.710 Vali Loss: 1.469 Vali Acc: 0.806 Test Loss: 1.469 Test Acc: 0.806
Validation loss decreased (-0.541647 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.8026180267333984
Epoch: 5, Steps: 7 | Train Loss: 1.160 Vali Loss: 0.905 Vali Acc: 0.819 Test Loss: 0.905 Test Acc: 0.819
Validation loss decreased (-0.805541 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 0.910712480545044
Epoch: 6, Steps: 7 | Train Loss: 0.626 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.0287261009216309
Epoch: 7, Steps: 7 | Train Loss: 0.307 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.9036941528320312
Epoch: 8, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.649 Vali Acc: 0.847 Test Loss: 0.649 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8958404064178467
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 1.0280513763427734
Epoch: 10, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.427 Vali Acc: 0.861 Test Loss: 0.427 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7617363929748535
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8614373207092285
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8314454555511475
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 0.7056329250335693
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 0.9843549728393555
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 0.9324109554290771
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 1.0529956817626953
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 0.8514926433563232
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.875 Test Loss: 0.391 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.7651817798614502
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 1.0005991458892822
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 0.8218326568603516
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.8006548881530762
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 23 cost time: 0.9976568222045898
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.751807689666748
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 0.8976788520812988
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 26 cost time: 0.8065502643585205
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.6800673007965088
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6611006259918213
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6841568946838379
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.861 Test Loss: 0.331 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7045366764068604
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8082945346832275
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8385910987854004
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8007693290710449
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8639914989471436
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7966797351837158
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8214848041534424
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 44322828
model size : 183.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.354213237762451
Epoch: 1, Steps: 7 | Train Loss: 2.663 Vali Loss: 2.427 Vali Acc: 0.125 Test Loss: 2.427 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.1267433166503906
Epoch: 2, Steps: 7 | Train Loss: 2.364 Vali Loss: 2.051 Vali Acc: 0.569 Test Loss: 2.051 Test Acc: 0.569
Validation loss decreased (-0.124976 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 1.1699120998382568
Epoch: 3, Steps: 7 | Train Loss: 1.691 Vali Loss: 1.383 Vali Acc: 0.597 Test Loss: 1.383 Test Acc: 0.597
Validation loss decreased (-0.569424 --> -0.597208).  Saving model ...
Epoch: 4 cost time: 1.0915021896362305
Epoch: 4, Steps: 7 | Train Loss: 0.918 Vali Loss: 0.694 Vali Acc: 0.819 Test Loss: 0.694 Test Acc: 0.819
Validation loss decreased (-0.597208 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 1.3057680130004883
Epoch: 5, Steps: 7 | Train Loss: 0.303 Vali Loss: 0.430 Vali Acc: 0.847 Test Loss: 0.430 Test Acc: 0.847
Validation loss decreased (-0.819438 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 1.0326941013336182
Epoch: 6, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.1621835231781006
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.3601469993591309
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.630 Vali Acc: 0.847 Test Loss: 0.630 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3130404949188232
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 1.309175729751587
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.0839593410491943
Epoch: 11, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3278720378875732
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.903 Test Loss: 0.435 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1543879508972168
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0685539245605469
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2086708545684814
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2367219924926758
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.917 Test Loss: 0.452 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1332809925079346
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.875 Test Loss: 0.614 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.332702875137329
Epoch: 18, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3583292961120605
Epoch: 19, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.411 Vali Acc: 0.917 Test Loss: 0.411 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4416399002075195
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.903 Test Loss: 0.508 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 44998668
model size : 186.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5428049564361572
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.393 Vali Acc: 0.139 Test Loss: 2.393 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.8108363151550293
Epoch: 2, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.127 Vali Acc: 0.431 Test Loss: 2.127 Test Acc: 0.431
Validation loss decreased (-0.138865 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.9775011539459229
Epoch: 3, Steps: 7 | Train Loss: 1.920 Vali Loss: 1.631 Vali Acc: 0.750 Test Loss: 1.631 Test Acc: 0.750
Validation loss decreased (-0.430534 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 1.0797233581542969
Epoch: 4, Steps: 7 | Train Loss: 1.339 Vali Loss: 1.002 Vali Acc: 0.847 Test Loss: 1.002 Test Acc: 0.847
Validation loss decreased (-0.749984 --> -0.847212).  Saving model ...
Epoch: 5 cost time: 1.0084054470062256
Epoch: 5, Steps: 7 | Train Loss: 0.694 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
Validation loss decreased (-0.847212 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 1.3219845294952393
Epoch: 6, Steps: 7 | Train Loss: 0.268 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0034875869750977
Epoch: 7, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9711189270019531
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.1423888206481934
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2775819301605225
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9898030757904053
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.379 Vali Acc: 0.847 Test Loss: 0.379 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2079248428344727
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9394474029541016
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1529998779296875
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8673632144927979
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902773).  Saving model ...
Epoch: 16 cost time: 1.4424636363983154
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.903 Test Loss: 0.416 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 17 cost time: 1.3681981563568115
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.149120569229126
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1329801082611084
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2077925205230713
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.310136079788208
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3350632190704346
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.050570011138916
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1958951950073242
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.389155387878418
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9231283664703369
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 44579340
model size : 184.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.291275978088379
Epoch: 1, Steps: 7 | Train Loss: 2.668 Vali Loss: 2.559 Vali Acc: 0.111 Test Loss: 2.559 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.0208158493041992
Epoch: 2, Steps: 7 | Train Loss: 2.451 Vali Loss: 2.253 Vali Acc: 0.250 Test Loss: 2.253 Test Acc: 0.250
Validation loss decreased (-0.111086 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 1.1396334171295166
Epoch: 3, Steps: 7 | Train Loss: 2.117 Vali Loss: 1.955 Vali Acc: 0.500 Test Loss: 1.955 Test Acc: 0.500
Validation loss decreased (-0.249977 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 1.0437395572662354
Epoch: 4, Steps: 7 | Train Loss: 1.734 Vali Loss: 1.605 Vali Acc: 0.736 Test Loss: 1.605 Test Acc: 0.736
Validation loss decreased (-0.499980 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 0.9297668933868408
Epoch: 5, Steps: 7 | Train Loss: 1.256 Vali Loss: 1.084 Vali Acc: 0.833 Test Loss: 1.084 Test Acc: 0.833
Validation loss decreased (-0.736095 --> -0.833322).  Saving model ...
Epoch: 6 cost time: 1.150364637374878
Epoch: 6, Steps: 7 | Train Loss: 0.731 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
Validation loss decreased (-0.833322 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.0496842861175537
Epoch: 7, Steps: 7 | Train Loss: 0.369 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9606592655181885
Epoch: 8, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.9086706638336182
Epoch: 9, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.874997 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.9408924579620361
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0482909679412842
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0259499549865723
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8995616436004639
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1252641677856445
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9792020320892334
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9369900226593018
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8398287296295166
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9025731086730957
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.924382209777832
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0236024856567383
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8801519870758057
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0752601623535156
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44353548
model size : 183.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6402320861816406
Epoch: 1, Steps: 7 | Train Loss: 2.692 Vali Loss: 2.420 Vali Acc: 0.194 Test Loss: 2.420 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 1.40030837059021
Epoch: 2, Steps: 7 | Train Loss: 2.381 Vali Loss: 1.980 Vali Acc: 0.472 Test Loss: 1.980 Test Acc: 0.472
Validation loss decreased (-0.194420 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 1.3297944068908691
Epoch: 3, Steps: 7 | Train Loss: 1.718 Vali Loss: 1.353 Vali Acc: 0.681 Test Loss: 1.353 Test Acc: 0.681
Validation loss decreased (-0.472202 --> -0.680542).  Saving model ...
Epoch: 4 cost time: 1.3006572723388672
Epoch: 4, Steps: 7 | Train Loss: 0.886 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.680542 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.1569769382476807
Epoch: 5, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.400 Vali Acc: 0.847 Test Loss: 0.400 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 1.2757246494293213
Epoch: 6, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.226893424987793
Epoch: 7, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.710 Vali Acc: 0.778 Test Loss: 0.710 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.166050672531128
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.739 Vali Acc: 0.875 Test Loss: 0.739 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.275001049041748
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.875 Test Loss: 0.764 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2715997695922852
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.847 Test Loss: 0.694 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3029694557189941
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.819 Test Loss: 0.816 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2977347373962402
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.861 Test Loss: 0.670 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3381705284118652
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.875 Test Loss: 0.628 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 0.9959640502929688
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.889 Test Loss: 0.637 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 1.350571632385254
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.889 Test Loss: 0.638 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9714560508728027
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.903 Test Loss: 0.636 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902771).  Saving model ...
Epoch: 17 cost time: 1.219928503036499
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.903 Test Loss: 0.634 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902771).  Saving model ...
Epoch: 18 cost time: 1.2085654735565186
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.903 Test Loss: 0.630 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902771).  Saving model ...
Epoch: 19 cost time: 1.441577672958374
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.903 Test Loss: 0.626 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902772).  Saving model ...
Epoch: 20 cost time: 1.3545920848846436
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.903 Test Loss: 0.621 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 21 cost time: 0.8633773326873779
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.903 Test Loss: 0.617 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 22 cost time: 1.0449256896972656
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.903 Test Loss: 0.613 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 23 cost time: 1.1841330528259277
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.903 Test Loss: 0.608 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 24 cost time: 0.8203003406524658
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.903 Test Loss: 0.605 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 25 cost time: 0.9319465160369873
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.903 Test Loss: 0.600 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 26 cost time: 1.3822214603424072
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.903 Test Loss: 0.597 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 27 cost time: 1.1194887161254883
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.903 Test Loss: 0.594 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 28 cost time: 1.2466115951538086
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.903 Test Loss: 0.592 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 29 cost time: 1.0238478183746338
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.903 Test Loss: 0.591 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 30 cost time: 0.9689793586730957
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.903 Test Loss: 0.588 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 31 cost time: 1.176347255706787
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.903 Test Loss: 0.585 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 32 cost time: 1.2953243255615234
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.903 Test Loss: 0.581 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 33 cost time: 1.2724981307983398
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.903 Test Loss: 0.579 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 34 cost time: 1.0888471603393555
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.903 Test Loss: 0.576 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 35 cost time: 1.3475899696350098
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.903 Test Loss: 0.574 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 36 cost time: 1.3745145797729492
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.903 Test Loss: 0.571 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 37 cost time: 0.9417004585266113
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.903 Test Loss: 0.569 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 38 cost time: 1.2966468334197998
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.903 Test Loss: 0.567 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 39 cost time: 1.433786153793335
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.903 Test Loss: 0.566 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 40 cost time: 1.3658127784729004
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.903 Test Loss: 0.566 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 41 cost time: 1.3424811363220215
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.903 Test Loss: 0.565 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 42 cost time: 1.1850109100341797
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.903 Test Loss: 0.563 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 43 cost time: 1.3999953269958496
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.903 Test Loss: 0.562 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 44 cost time: 1.1159405708312988
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.903 Test Loss: 0.561 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 45 cost time: 1.1240789890289307
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.903 Test Loss: 0.560 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902772).  Saving model ...
Epoch: 46 cost time: 1.1785552501678467
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.889 Test Loss: 0.560 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1970140933990479
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.889 Test Loss: 0.560 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1502223014831543
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.889 Test Loss: 0.560 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2247419357299805
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.889 Test Loss: 0.559 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.148606538772583
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.889 Test Loss: 0.559 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 45026316
model size : 186.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.416368007659912
Epoch: 1, Steps: 7 | Train Loss: 2.615 Vali Loss: 2.476 Vali Acc: 0.125 Test Loss: 2.476 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.135936975479126
Epoch: 2, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.159 Vali Acc: 0.403 Test Loss: 2.159 Test Acc: 0.403
Validation loss decreased (-0.124975 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.7998442649841309
Epoch: 3, Steps: 7 | Train Loss: 1.938 Vali Loss: 1.643 Vali Acc: 0.708 Test Loss: 1.643 Test Acc: 0.708
Validation loss decreased (-0.402756 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 1.0273792743682861
Epoch: 4, Steps: 7 | Train Loss: 1.325 Vali Loss: 1.049 Vali Acc: 0.819 Test Loss: 1.049 Test Acc: 0.819
Validation loss decreased (-0.708317 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 1.0792431831359863
Epoch: 5, Steps: 7 | Train Loss: 0.617 Vali Loss: 0.539 Vali Acc: 0.861 Test Loss: 0.539 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 1.0575053691864014
Epoch: 6, Steps: 7 | Train Loss: 0.196 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.028198480606079
Epoch: 7, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.2203199863433838
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1178135871887207
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 1.1030662059783936
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.9364640712738037
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.1147496700286865
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 1.0539209842681885
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.13389253616333
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2599174976348877
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2822272777557373
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1953177452087402
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.096898078918457
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.093238353729248
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1565210819244385
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8814451694488525
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.091336727142334
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44585484
model size : 184.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4156832695007324
Epoch: 1, Steps: 7 | Train Loss: 2.681 Vali Loss: 2.485 Vali Acc: 0.139 Test Loss: 2.485 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.7145109176635742
Epoch: 2, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.268 Vali Acc: 0.389 Test Loss: 2.268 Test Acc: 0.389
Validation loss decreased (-0.138864 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 0.7940983772277832
Epoch: 3, Steps: 7 | Train Loss: 2.147 Vali Loss: 2.004 Vali Acc: 0.472 Test Loss: 2.004 Test Acc: 0.472
Validation loss decreased (-0.388866 --> -0.472202).  Saving model ...
Epoch: 4 cost time: 0.6809554100036621
Epoch: 4, Steps: 7 | Train Loss: 1.788 Vali Loss: 1.582 Vali Acc: 0.778 Test Loss: 1.582 Test Acc: 0.778
Validation loss decreased (-0.472202 --> -0.777762).  Saving model ...
Epoch: 5 cost time: 0.9928317070007324
Epoch: 5, Steps: 7 | Train Loss: 1.260 Vali Loss: 1.103 Vali Acc: 0.847 Test Loss: 1.103 Test Acc: 0.847
Validation loss decreased (-0.777762 --> -0.847211).  Saving model ...
Epoch: 6 cost time: 0.9844567775726318
Epoch: 6, Steps: 7 | Train Loss: 0.724 Vali Loss: 0.585 Vali Acc: 0.917 Test Loss: 0.585 Test Acc: 0.917
Validation loss decreased (-0.847211 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 0.7616164684295654
Epoch: 7, Steps: 7 | Train Loss: 0.297 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8724534511566162
Epoch: 8, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.447 Vali Acc: 0.847 Test Loss: 0.447 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8113863468170166
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.511 Vali Acc: 0.847 Test Loss: 0.511 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8263514041900635
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7465047836303711
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.994253396987915
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.442 Vali Acc: 0.847 Test Loss: 0.442 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8740777969360352
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.69620680809021
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8265862464904785
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8779499530792236
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 44370444
model size : 183.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps57_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.657180070877075
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.414 Vali Acc: 0.167 Test Loss: 2.414 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.3191578388214111
Epoch: 2, Steps: 7 | Train Loss: 2.300 Vali Loss: 1.989 Vali Acc: 0.542 Test Loss: 1.989 Test Acc: 0.542
Validation loss decreased (-0.166643 --> -0.541647).  Saving model ...
Epoch: 3 cost time: 1.2924096584320068
Epoch: 3, Steps: 7 | Train Loss: 1.678 Vali Loss: 1.282 Vali Acc: 0.833 Test Loss: 1.282 Test Acc: 0.833
Validation loss decreased (-0.541647 --> -0.833321).  Saving model ...
Epoch: 4 cost time: 1.3549904823303223
Epoch: 4, Steps: 7 | Train Loss: 0.870 Vali Loss: 0.562 Vali Acc: 0.889 Test Loss: 0.562 Test Acc: 0.889
Validation loss decreased (-0.833321 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 1.3719747066497803
Epoch: 5, Steps: 7 | Train Loss: 0.309 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2269470691680908
Epoch: 6, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.472 Vali Acc: 0.903 Test Loss: 0.472 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 1.2314481735229492
Epoch: 7, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.903 Test Loss: 0.267 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.1217741966247559
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1243054866790771
Epoch: 9, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3718321323394775
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9019930362701416
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.931 Test Loss: 0.488 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930551).  Saving model ...
Epoch: 12 cost time: 0.9789345264434814
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.931 Test Loss: 0.493 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9494867324829102
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.917 Test Loss: 0.490 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9599218368530273
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.917 Test Loss: 0.474 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0001335144042969
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.917 Test Loss: 0.468 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.752476692199707
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.917 Test Loss: 0.460 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2236497402191162
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.917 Test Loss: 0.452 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2465159893035889
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.917 Test Loss: 0.446 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7582910060882568
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.917 Test Loss: 0.444 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2127773761749268
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.917 Test Loss: 0.445 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2436308860778809
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.917 Test Loss: 0.443 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps57_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45000204
model size : 186.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps57_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.206268548965454
Epoch: 1, Steps: 7 | Train Loss: 2.664 Vali Loss: 2.490 Vali Acc: 0.111 Test Loss: 2.490 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.0126042366027832
Epoch: 2, Steps: 7 | Train Loss: 2.359 Vali Loss: 2.152 Vali Acc: 0.431 Test Loss: 2.152 Test Acc: 0.431
Validation loss decreased (-0.111086 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 1.1342885494232178
Epoch: 3, Steps: 7 | Train Loss: 1.943 Vali Loss: 1.688 Vali Acc: 0.653 Test Loss: 1.688 Test Acc: 0.653
Validation loss decreased (-0.430534 --> -0.652761).  Saving model ...
Epoch: 4 cost time: 1.0593411922454834
Epoch: 4, Steps: 7 | Train Loss: 1.365 Vali Loss: 1.076 Vali Acc: 0.792 Test Loss: 1.076 Test Acc: 0.792
Validation loss decreased (-0.652761 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 1.1507861614227295
Epoch: 5, Steps: 7 | Train Loss: 0.669 Vali Loss: 0.570 Vali Acc: 0.889 Test Loss: 0.570 Test Acc: 0.889
Validation loss decreased (-0.791656 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 0.7660870552062988
Epoch: 6, Steps: 7 | Train Loss: 0.255 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.068674087524414
Epoch: 7, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8789796829223633
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.0391247272491455
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7366278171539307
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 1.1263141632080078
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6573605537414551
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7613492012023926
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8788318634033203
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9266602993011475
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.100280523300171
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0881972312927246
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9556281566619873
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9232833385467529
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1557469367980957
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps57_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 44602380
model size : 184.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps57_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.253359794616699
Epoch: 1, Steps: 7 | Train Loss: 2.661 Vali Loss: 2.552 Vali Acc: 0.028 Test Loss: 2.552 Test Acc: 0.028
Validation loss decreased (inf --> -0.027752).  Saving model ...
Epoch: 2 cost time: 0.8310980796813965
Epoch: 2, Steps: 7 | Train Loss: 2.466 Vali Loss: 2.252 Vali Acc: 0.306 Test Loss: 2.252 Test Acc: 0.306
Validation loss decreased (-0.027752 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 0.7846827507019043
Epoch: 3, Steps: 7 | Train Loss: 2.127 Vali Loss: 1.933 Vali Acc: 0.458 Test Loss: 1.933 Test Acc: 0.458
Validation loss decreased (-0.305533 --> -0.458314).  Saving model ...
Epoch: 4 cost time: 1.0540194511413574
Epoch: 4, Steps: 7 | Train Loss: 1.792 Vali Loss: 1.518 Vali Acc: 0.750 Test Loss: 1.518 Test Acc: 0.750
Validation loss decreased (-0.458314 --> -0.749985).  Saving model ...
Epoch: 5 cost time: 0.46939826011657715
Epoch: 5, Steps: 7 | Train Loss: 1.262 Vali Loss: 0.918 Vali Acc: 0.792 Test Loss: 0.918 Test Acc: 0.792
Validation loss decreased (-0.749985 --> -0.791657).  Saving model ...
Epoch: 6 cost time: 1.0053932666778564
Epoch: 6, Steps: 7 | Train Loss: 0.730 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
Validation loss decreased (-0.791657 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.9813098907470703
Epoch: 7, Steps: 7 | Train Loss: 0.323 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.7903075218200684
Epoch: 8, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.8760433197021484
Epoch: 9, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7911872863769531
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6883838176727295
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.875 Test Loss: 0.262 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6637876033782959
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8257620334625244
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6161093711853027
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6332120895385742
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.618668794631958
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 0.6422994136810303
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 0.7644164562225342
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 0.8667190074920654
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 0.7648842334747314
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 0.6661765575408936
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6436660289764404
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.720196008682251
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8566999435424805
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9413180351257324
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 26 cost time: 0.7423782348632812
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 0.7742676734924316
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.807713508605957
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8170549869537354
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8276891708374023
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6347739696502686
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9408648014068604
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9140987396240234
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7474658489227295
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7082061767578125
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8888928890228271
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps57_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 44398092
model size : 184.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.722966432571411
Epoch: 1, Steps: 7 | Train Loss: 2.583 Vali Loss: 2.343 Vali Acc: 0.333 Test Loss: 2.343 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 1.2412433624267578
Epoch: 2, Steps: 7 | Train Loss: 2.237 Vali Loss: 1.877 Vali Acc: 0.500 Test Loss: 1.877 Test Acc: 0.500
Validation loss decreased (-0.333310 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.3755435943603516
Epoch: 3, Steps: 7 | Train Loss: 1.584 Vali Loss: 1.244 Vali Acc: 0.736 Test Loss: 1.244 Test Acc: 0.736
Validation loss decreased (-0.499981 --> -0.736099).  Saving model ...
Epoch: 4 cost time: 1.2045438289642334
Epoch: 4, Steps: 7 | Train Loss: 0.899 Vali Loss: 0.553 Vali Acc: 0.917 Test Loss: 0.553 Test Acc: 0.917
Validation loss decreased (-0.736099 --> -0.916661).  Saving model ...
Epoch: 5 cost time: 1.1462337970733643
Epoch: 5, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1261260509490967
Epoch: 6, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8930468559265137
Epoch: 7, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.614 Vali Acc: 0.875 Test Loss: 0.614 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2202601432800293
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1373112201690674
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.847 Test Loss: 0.462 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3308079242706299
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2306556701660156
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.916661 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.2732577323913574
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.958 Test Loss: 0.289 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 1.3852057456970215
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2610692977905273
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.211256742477417
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.237062931060791
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2246968746185303
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9954173564910889
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
Validation loss decreased (-0.958330 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.3500580787658691
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.958 Test Loss: 0.243 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 20 cost time: 1.2101433277130127
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 21 cost time: 0.7924258708953857
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7615063190460205
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8787393569946289
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0252881050109863
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8560831546783447
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9910919666290283
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0816388130187988
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2494969367980957
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0836362838745117
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.277925729751587
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 45030924
model size : 186.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0706303119659424
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.423 Vali Acc: 0.181 Test Loss: 2.423 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.7575924396514893
Epoch: 2, Steps: 7 | Train Loss: 2.342 Vali Loss: 2.136 Vali Acc: 0.444 Test Loss: 2.136 Test Acc: 0.444
Validation loss decreased (-0.180531 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.6846187114715576
Epoch: 3, Steps: 7 | Train Loss: 1.945 Vali Loss: 1.661 Vali Acc: 0.764 Test Loss: 1.661 Test Acc: 0.764
Validation loss decreased (-0.444423 --> -0.763872).  Saving model ...
Epoch: 4 cost time: 0.9365906715393066
Epoch: 4, Steps: 7 | Train Loss: 1.369 Vali Loss: 1.049 Vali Acc: 0.847 Test Loss: 1.049 Test Acc: 0.847
Validation loss decreased (-0.763872 --> -0.847212).  Saving model ...
Epoch: 5 cost time: 0.6460258960723877
Epoch: 5, Steps: 7 | Train Loss: 0.753 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9676251411437988
Epoch: 6, Steps: 7 | Train Loss: 0.312 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7305169105529785
Epoch: 7, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
Validation loss decreased (-0.847212 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.8392839431762695
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.888884 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.7646524906158447
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.985590934753418
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.7988665103912354
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9264514446258545
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.899254322052002
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9249227046966553
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7563555240631104
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8912670612335205
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9493002891540527
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9336221218109131
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8710744380950928
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7747783660888672
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7950406074523926
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7649571895599365
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5861325263977051
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7444348335266113
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7072188854217529
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.7348039150238037
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.7949891090393066
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.9918742179870605
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.0004758834838867
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 1.0459721088409424
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.8453009128570557
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.6155447959899902
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6793990135192871
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6651957035064697
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6503078937530518
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.9128763675689697
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.9574697017669678
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.8756413459777832
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.9788823127746582
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0629425048828125
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 1.0044960975646973
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.9691696166992188
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8483777046203613
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7707324028015137
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9775381088256836
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8896675109863281
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8749692440032959
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.9646162986755371
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.8988096714019775
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.980954647064209
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 44622348
model size : 184.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3109850883483887
Epoch: 1, Steps: 7 | Train Loss: 2.572 Vali Loss: 2.497 Vali Acc: 0.153 Test Loss: 2.497 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.6316943168640137
Epoch: 2, Steps: 7 | Train Loss: 2.364 Vali Loss: 2.219 Vali Acc: 0.361 Test Loss: 2.219 Test Acc: 0.361
Validation loss decreased (-0.152753 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.8532688617706299
Epoch: 3, Steps: 7 | Train Loss: 2.125 Vali Loss: 1.905 Vali Acc: 0.639 Test Loss: 1.905 Test Acc: 0.639
Validation loss decreased (-0.361089 --> -0.638870).  Saving model ...
Epoch: 4 cost time: 0.8829226493835449
Epoch: 4, Steps: 7 | Train Loss: 1.728 Vali Loss: 1.481 Vali Acc: 0.764 Test Loss: 1.481 Test Acc: 0.764
Validation loss decreased (-0.638870 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 0.578223705291748
Epoch: 5, Steps: 7 | Train Loss: 1.272 Vali Loss: 1.010 Vali Acc: 0.833 Test Loss: 1.010 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.7188727855682373
Epoch: 6, Steps: 7 | Train Loss: 0.751 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 0.8318030834197998
Epoch: 7, Steps: 7 | Train Loss: 0.386 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.8564469814300537
Epoch: 8, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7441017627716064
Epoch: 9, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.8838176727294922
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9060590267181396
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8105647563934326
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6243386268615723
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5929605960845947
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9287686347961426
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8251602649688721
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.874403715133667
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7772238254547119
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8831267356872559
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9648966789245605
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8599202632904053
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8115246295928955
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 44418060
model size : 184.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.216203451156616
Epoch: 1, Steps: 7 | Train Loss: 2.625 Vali Loss: 2.397 Vali Acc: 0.125 Test Loss: 2.397 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.2287650108337402
Epoch: 2, Steps: 7 | Train Loss: 2.243 Vali Loss: 1.908 Vali Acc: 0.556 Test Loss: 1.908 Test Acc: 0.556
Validation loss decreased (-0.124976 --> -0.555536).  Saving model ...
Epoch: 3 cost time: 1.216320514678955
Epoch: 3, Steps: 7 | Train Loss: 1.583 Vali Loss: 1.198 Vali Acc: 0.833 Test Loss: 1.198 Test Acc: 0.833
Validation loss decreased (-0.555536 --> -0.833321).  Saving model ...
Epoch: 4 cost time: 1.04105806350708
Epoch: 4, Steps: 7 | Train Loss: 0.721 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 1.3661434650421143
Epoch: 5, Steps: 7 | Train Loss: 0.194 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 1.2984826564788818
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.3039710521697998
Epoch: 7, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.2710092067718506
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0277798175811768
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.2792034149169922
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.1763980388641357
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1180973052978516
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 1.2363245487213135
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 1.2459149360656738
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.958 Test Loss: 0.264 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.5915772914886475
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 1.1942081451416016
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.456791877746582
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 1.4855165481567383
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 1.349665641784668
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5027360916137695
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5085718631744385
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3042738437652588
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5505235195159912
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3892505168914795
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5518238544464111
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3584568500518799
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 27 cost time: 1.4970200061798096
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3234837055206299
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4863362312316895
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3648402690887451
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4937999248504639
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 32 cost time: 1.297708511352539
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2196016311645508
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 34 cost time: 1.211000680923462
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2035126686096191
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.958 Test Loss: 0.245 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 36 cost time: 1.3365981578826904
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.1920123100280762
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.561586856842041
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.3604042530059814
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 1.1798992156982422
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5287327766418457
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3327524662017822
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.972 Test Loss: 0.238 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 43 cost time: 1.582890510559082
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.972 Test Loss: 0.237 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 44 cost time: 1.4424312114715576
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 45 cost time: 1.0628423690795898
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 46 cost time: 1.2249019145965576
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4184901714324951
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.4298148155212402
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3934822082519531
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2290868759155273
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 45018636
model size : 186.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4481804370880127
Epoch: 1, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.436 Vali Acc: 0.181 Test Loss: 2.436 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.8210797309875488
Epoch: 2, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.112 Vali Acc: 0.431 Test Loss: 2.112 Test Acc: 0.431
Validation loss decreased (-0.180531 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 1.1415061950683594
Epoch: 3, Steps: 7 | Train Loss: 1.841 Vali Loss: 1.472 Vali Acc: 0.764 Test Loss: 1.472 Test Acc: 0.764
Validation loss decreased (-0.430534 --> -0.763874).  Saving model ...
Epoch: 4 cost time: 1.1275839805603027
Epoch: 4, Steps: 7 | Train Loss: 1.132 Vali Loss: 0.905 Vali Acc: 0.792 Test Loss: 0.905 Test Acc: 0.792
Validation loss decreased (-0.763874 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 1.168431043624878
Epoch: 5, Steps: 7 | Train Loss: 0.524 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
Validation loss decreased (-0.791658 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 1.0041987895965576
Epoch: 6, Steps: 7 | Train Loss: 0.190 Vali Loss: 0.518 Vali Acc: 0.903 Test Loss: 0.518 Test Acc: 0.903
Validation loss decreased (-0.833328 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 1.0761094093322754
Epoch: 7, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.0349929332733154
Epoch: 8, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9653520584106445
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.604529619216919
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5677690505981445
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.0223639011383057
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.7868890762329102
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7786548137664795
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.334 Vali Acc: 0.931 Test Loss: 0.334 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6420488357543945
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.931 Test Loss: 0.313 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7072889804840088
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7158422470092773
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.900209903717041
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.8186240196228027
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0320703983306885
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6919896602630615
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9699573516845703
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9896011352539062
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8641724586486816
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9327654838562012
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9212932586669922
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0808615684509277
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.941361665725708
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 44642316
model size : 184.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3255763053894043
Epoch: 1, Steps: 7 | Train Loss: 2.612 Vali Loss: 2.468 Vali Acc: 0.139 Test Loss: 2.468 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.686866044998169
Epoch: 2, Steps: 7 | Train Loss: 2.429 Vali Loss: 2.261 Vali Acc: 0.347 Test Loss: 2.261 Test Acc: 0.347
Validation loss decreased (-0.138864 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.6900463104248047
Epoch: 3, Steps: 7 | Train Loss: 2.177 Vali Loss: 2.001 Vali Acc: 0.708 Test Loss: 2.001 Test Acc: 0.708
Validation loss decreased (-0.347200 --> -0.708313).  Saving model ...
Epoch: 4 cost time: 0.8876755237579346
Epoch: 4, Steps: 7 | Train Loss: 1.779 Vali Loss: 1.603 Vali Acc: 0.833 Test Loss: 1.603 Test Acc: 0.833
Validation loss decreased (-0.708313 --> -0.833317).  Saving model ...
Epoch: 5 cost time: 0.9180231094360352
Epoch: 5, Steps: 7 | Train Loss: 1.255 Vali Loss: 1.009 Vali Acc: 0.847 Test Loss: 1.009 Test Acc: 0.847
Validation loss decreased (-0.833317 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.8700299263000488
Epoch: 6, Steps: 7 | Train Loss: 0.706 Vali Loss: 0.657 Vali Acc: 0.847 Test Loss: 0.657 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 1.0569322109222412
Epoch: 7, Steps: 7 | Train Loss: 0.320 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.948920726776123
Epoch: 8, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6681630611419678
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6629469394683838
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.8702781200408936
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8943259716033936
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8892955780029297
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.8510441780090332
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.903 Test Loss: 0.243 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6375141143798828
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.811549186706543
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8380041122436523
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.889 Test Loss: 0.242 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.816896915435791
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8286252021789551
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.8051083087921143
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.9345824718475342
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9199581146240234
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9810099601745605
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9804894924163818
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.8769485950469971
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.9201614856719971
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9137592315673828
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8839201927185059
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9846317768096924
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9116420745849609
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.9800426959991455
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8251333236694336
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.91141676902771
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9026679992675781
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5523049831390381
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8281247615814209
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8566274642944336
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7969536781311035
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8402891159057617
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7334184646606445
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 41 cost time: 0.6991932392120361
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6837871074676514
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8528323173522949
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6340928077697754
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.903 Test Loss: 0.230 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.029040813446045
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.970073938369751
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6848273277282715
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7227785587310791
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7046990394592285
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8849084377288818
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44459532
model size : 184.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.781022787094116
Epoch: 1, Steps: 7 | Train Loss: 2.636 Vali Loss: 2.439 Vali Acc: 0.194 Test Loss: 2.439 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.9308500289916992
Epoch: 2, Steps: 7 | Train Loss: 2.302 Vali Loss: 1.997 Vali Acc: 0.583 Test Loss: 1.997 Test Acc: 0.583
Validation loss decreased (-0.194420 --> -0.583313).  Saving model ...
Epoch: 3 cost time: 0.9135024547576904
Epoch: 3, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.352 Vali Acc: 0.736 Test Loss: 1.352 Test Acc: 0.736
Validation loss decreased (-0.583313 --> -0.736098).  Saving model ...
Epoch: 4 cost time: 1.0272440910339355
Epoch: 4, Steps: 7 | Train Loss: 0.901 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
Validation loss decreased (-0.736098 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 0.9081892967224121
Epoch: 5, Steps: 7 | Train Loss: 0.277 Vali Loss: 0.429 Vali Acc: 0.847 Test Loss: 0.429 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4136075973510742
Epoch: 6, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.360 Vali Acc: 0.917 Test Loss: 0.360 Test Acc: 0.917
Validation loss decreased (-0.861104 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.4520328044891357
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3671514987945557
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.469 Vali Acc: 0.875 Test Loss: 0.469 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.179243564605713
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.222724199295044
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2200031280517578
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.917 Test Loss: 0.434 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.20686936378479
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.931 Test Loss: 0.414 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930551).  Saving model ...
Epoch: 13 cost time: 0.8872816562652588
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.944 Test Loss: 0.405 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 1.3223166465759277
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.931 Test Loss: 0.404 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4062819480895996
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.903 Test Loss: 0.403 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2732610702514648
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.303987741470337
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2783057689666748
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.931 Test Loss: 0.400 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8070032596588135
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.931 Test Loss: 0.397 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2095377445220947
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.931 Test Loss: 0.392 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0362520217895508
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.931 Test Loss: 0.388 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8724045753479004
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0621356964111328
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.931 Test Loss: 0.383 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 45030924
model size : 186.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8960721492767334
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.484 Vali Acc: 0.208 Test Loss: 2.484 Test Acc: 0.208
Validation loss decreased (inf --> -0.208308).  Saving model ...
Epoch: 2 cost time: 0.8596270084381104
Epoch: 2, Steps: 7 | Train Loss: 2.312 Vali Loss: 2.090 Vali Acc: 0.500 Test Loss: 2.090 Test Acc: 0.500
Validation loss decreased (-0.208308 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 0.8485231399536133
Epoch: 3, Steps: 7 | Train Loss: 1.917 Vali Loss: 1.638 Vali Acc: 0.708 Test Loss: 1.638 Test Acc: 0.708
Validation loss decreased (-0.499979 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 0.8491032123565674
Epoch: 4, Steps: 7 | Train Loss: 1.378 Vali Loss: 1.158 Vali Acc: 0.764 Test Loss: 1.158 Test Acc: 0.764
Validation loss decreased (-0.708317 --> -0.763877).  Saving model ...
Epoch: 5 cost time: 0.6527450084686279
Epoch: 5, Steps: 7 | Train Loss: 0.787 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
Validation loss decreased (-0.763877 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 0.5429031848907471
Epoch: 6, Steps: 7 | Train Loss: 0.302 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874997).  Saving model ...
Epoch: 7 cost time: 0.6886193752288818
Epoch: 7, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.874997 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.9124505519866943
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.794543981552124
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.7428531646728516
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.903 Test Loss: 0.193 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9407668113708496
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.8495621681213379
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9097843170166016
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6062185764312744
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.8010473251342773
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 0.7886984348297119
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.8018133640289307
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.9813816547393799
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.9498255252838135
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.947056770324707
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9451329708099365
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8836066722869873
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7926614284515381
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7417025566101074
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8394579887390137
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7052180767059326
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.683312177658081
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9442446231842041
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8027570247650146
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 44676108
model size : 185.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.316411018371582
Epoch: 1, Steps: 7 | Train Loss: 2.664 Vali Loss: 2.503 Vali Acc: 0.111 Test Loss: 2.503 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.7883374691009521
Epoch: 2, Steps: 7 | Train Loss: 2.416 Vali Loss: 2.256 Vali Acc: 0.347 Test Loss: 2.256 Test Acc: 0.347
Validation loss decreased (-0.111086 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.6921184062957764
Epoch: 3, Steps: 7 | Train Loss: 2.206 Vali Loss: 2.023 Vali Acc: 0.486 Test Loss: 2.023 Test Acc: 0.486
Validation loss decreased (-0.347200 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 0.6078095436096191
Epoch: 4, Steps: 7 | Train Loss: 1.836 Vali Loss: 1.644 Vali Acc: 0.861 Test Loss: 1.644 Test Acc: 0.861
Validation loss decreased (-0.486091 --> -0.861095).  Saving model ...
Epoch: 5 cost time: 0.7502093315124512
Epoch: 5, Steps: 7 | Train Loss: 1.401 Vali Loss: 1.150 Vali Acc: 0.917 Test Loss: 1.150 Test Acc: 0.917
Validation loss decreased (-0.861095 --> -0.916655).  Saving model ...
Epoch: 6 cost time: 0.8979876041412354
Epoch: 6, Steps: 7 | Train Loss: 0.835 Vali Loss: 0.662 Vali Acc: 0.889 Test Loss: 0.662 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6692755222320557
Epoch: 7, Steps: 7 | Train Loss: 0.370 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7648980617523193
Epoch: 8, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.916655 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.7739372253417969
Epoch: 9, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.826573371887207
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.7611327171325684
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.6942198276519775
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.704575777053833
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.7733404636383057
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 0.8435580730438232
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 0.7658746242523193
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6844131946563721
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7574954032897949
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7911767959594727
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8438456058502197
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8093760013580322
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 0.8706369400024414
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 23 cost time: 0.8730392456054688
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 24 cost time: 0.7162191867828369
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 25 cost time: 0.8126621246337891
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 0.7054898738861084
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7188692092895508
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6895616054534912
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5204434394836426
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.764594316482544
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7945678234100342
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8325049877166748
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6784107685089111
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6468141078948975
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5881800651550293
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 44493324
model size : 184.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0315768718719482
Epoch: 1, Steps: 7 | Train Loss: 2.625 Vali Loss: 2.366 Vali Acc: 0.264 Test Loss: 2.366 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.9834485054016113
Epoch: 2, Steps: 7 | Train Loss: 2.239 Vali Loss: 1.934 Vali Acc: 0.472 Test Loss: 1.934 Test Acc: 0.472
Validation loss decreased (-0.263865 --> -0.472203).  Saving model ...
Epoch: 3 cost time: 0.8712594509124756
Epoch: 3, Steps: 7 | Train Loss: 1.654 Vali Loss: 1.294 Vali Acc: 0.792 Test Loss: 1.294 Test Acc: 0.792
Validation loss decreased (-0.472203 --> -0.791654).  Saving model ...
Epoch: 4 cost time: 0.8462674617767334
Epoch: 4, Steps: 7 | Train Loss: 0.926 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
Validation loss decreased (-0.791654 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.8788318634033203
Epoch: 5, Steps: 7 | Train Loss: 0.328 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.7976119518280029
Epoch: 6, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 0.7101726531982422
Epoch: 7, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.1601240634918213
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.419 Vali Acc: 0.917 Test Loss: 0.419 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.229353904724121
Epoch: 9, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.04803466796875
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1068120002746582
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.351879596710205
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.211730718612671
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.3552188873291016
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9494996070861816
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0468342304229736
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0729248523712158
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.1872682571411133
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2434141635894775
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.866945743560791
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.1563529968261719
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.801142692565918
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.4377882480621338
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 1.145993709564209
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.1233975887298584
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0865819454193115
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.28175687789917
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.3305940628051758
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.319828987121582
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1632087230682373
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1903281211853027
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1369760036468506
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.163048267364502
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2190637588500977
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7175037860870361
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 1.3841547966003418
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1563849449157715
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8362035751342773
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8529162406921387
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 1.222229242324829
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 41 cost time: 1.364800214767456
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2246160507202148
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 43 cost time: 0.9144411087036133
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 1.271826982498169
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8273026943206787
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 46 cost time: 0.9384074211120605
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 47 cost time: 1.416520595550537
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3347537517547607
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3095049858093262
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2892529964447021
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 45043212
model size : 186.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.157195806503296
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.411 Vali Acc: 0.194 Test Loss: 2.411 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.9255063533782959
Epoch: 2, Steps: 7 | Train Loss: 2.286 Vali Loss: 2.115 Vali Acc: 0.486 Test Loss: 2.115 Test Acc: 0.486
Validation loss decreased (-0.194420 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 0.8354589939117432
Epoch: 3, Steps: 7 | Train Loss: 1.935 Vali Loss: 1.672 Vali Acc: 0.681 Test Loss: 1.672 Test Acc: 0.681
Validation loss decreased (-0.486090 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 0.9546065330505371
Epoch: 4, Steps: 7 | Train Loss: 1.353 Vali Loss: 1.099 Vali Acc: 0.792 Test Loss: 1.099 Test Acc: 0.792
Validation loss decreased (-0.680539 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 0.7014114856719971
Epoch: 5, Steps: 7 | Train Loss: 0.763 Vali Loss: 0.660 Vali Acc: 0.861 Test Loss: 0.660 Test Acc: 0.861
Validation loss decreased (-0.791656 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 1.0397520065307617
Epoch: 6, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.396 Vali Acc: 0.847 Test Loss: 0.396 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8620486259460449
Epoch: 7, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.9839520454406738
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8353989124298096
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8240106105804443
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.029102087020874
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 0.9475851058959961
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 13 cost time: 1.0292577743530273
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0264649391174316
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.944 Test Loss: 0.150 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8832776546478271
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 16 cost time: 0.5255322456359863
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 17 cost time: 1.0031561851501465
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 18 cost time: 0.9666342735290527
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9171252250671387
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8574321269989014
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6949925422668457
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7649350166320801
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8284828662872314
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.817903995513916
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9581460952758789
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2413487434387207
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1441235542297363
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.931 Test Loss: 0.142 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 44709900
model size : 185.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0184736251831055
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.425 Vali Acc: 0.167 Test Loss: 2.425 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.9039092063903809
Epoch: 2, Steps: 7 | Train Loss: 2.388 Vali Loss: 2.218 Vali Acc: 0.528 Test Loss: 2.218 Test Acc: 0.528
Validation loss decreased (-0.166642 --> -0.527756).  Saving model ...
Epoch: 3 cost time: 0.8441288471221924
Epoch: 3, Steps: 7 | Train Loss: 2.202 Vali Loss: 1.971 Vali Acc: 0.667 Test Loss: 1.971 Test Acc: 0.667
Validation loss decreased (-0.527756 --> -0.666647).  Saving model ...
Epoch: 4 cost time: 0.9377222061157227
Epoch: 4, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.645 Vali Acc: 0.736 Test Loss: 1.645 Test Acc: 0.736
Validation loss decreased (-0.666647 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 0.7551920413970947
Epoch: 5, Steps: 7 | Train Loss: 1.409 Vali Loss: 1.189 Vali Acc: 0.764 Test Loss: 1.189 Test Acc: 0.764
Validation loss decreased (-0.736095 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.8816008567810059
Epoch: 6, Steps: 7 | Train Loss: 0.884 Vali Loss: 0.725 Vali Acc: 0.889 Test Loss: 0.725 Test Acc: 0.889
Validation loss decreased (-0.763877 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 1.0157644748687744
Epoch: 7, Steps: 7 | Train Loss: 0.393 Vali Loss: 0.461 Vali Acc: 0.931 Test Loss: 0.461 Test Acc: 0.931
Validation loss decreased (-0.888882 --> -0.930551).  Saving model ...
Epoch: 8 cost time: 0.7865321636199951
Epoch: 8, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.930551 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.9155659675598145
Epoch: 9, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8126554489135742
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.724043607711792
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6581246852874756
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6816864013671875
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0220611095428467
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.885927677154541
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8628864288330078
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0429472923278809
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8791611194610596
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 1.0599849224090576
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6246387958526611
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 1.0394947528839111
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.9878818988800049
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.8841774463653564
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9782016277313232
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.051781415939331
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8139176368713379
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0301151275634766
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8898909091949463
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8218586444854736
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8177444934844971
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8518638610839844
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8800094127655029
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 1.02296781539917
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.9062502384185791
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.9386625289916992
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.9053924083709717
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.7817800045013428
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8326709270477295
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9182720184326172
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.818444013595581
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8809707164764404
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.8012230396270752
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0187804698944092
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0402791500091553
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.127669095993042
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 1.0036864280700684
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 1.0358319282531738
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 1.039973497390747
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.8230223655700684
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 50 cost time: 0.9219653606414795
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 44537868
model size : 184.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7678439617156982
Epoch: 1, Steps: 7 | Train Loss: 2.633 Vali Loss: 2.469 Vali Acc: 0.139 Test Loss: 2.469 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.4024920463562012
Epoch: 2, Steps: 7 | Train Loss: 2.291 Vali Loss: 1.979 Vali Acc: 0.625 Test Loss: 1.979 Test Acc: 0.625
Validation loss decreased (-0.138864 --> -0.624980).  Saving model ...
Epoch: 3 cost time: 1.394510269165039
Epoch: 3, Steps: 7 | Train Loss: 1.742 Vali Loss: 1.432 Vali Acc: 0.708 Test Loss: 1.432 Test Acc: 0.708
Validation loss decreased (-0.624980 --> -0.708319).  Saving model ...
Epoch: 4 cost time: 1.3436648845672607
Epoch: 4, Steps: 7 | Train Loss: 0.984 Vali Loss: 0.724 Vali Acc: 0.847 Test Loss: 0.724 Test Acc: 0.847
Validation loss decreased (-0.708319 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 1.096146821975708
Epoch: 5, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.416210651397705
Epoch: 6, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4392509460449219
Epoch: 7, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.091902256011963
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916665).  Saving model ...
Epoch: 9 cost time: 1.0507302284240723
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2344307899475098
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1165685653686523
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.457679033279419
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1009962558746338
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4829177856445312
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4053914546966553
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3028345108032227
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3567240238189697
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3858869075775146
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 45066252
model size : 186.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5039072036743164
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.457 Vali Acc: 0.125 Test Loss: 2.457 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.8522653579711914
Epoch: 2, Steps: 7 | Train Loss: 2.350 Vali Loss: 2.139 Vali Acc: 0.431 Test Loss: 2.139 Test Acc: 0.431
Validation loss decreased (-0.124975 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 1.0670993328094482
Epoch: 3, Steps: 7 | Train Loss: 1.975 Vali Loss: 1.734 Vali Acc: 0.764 Test Loss: 1.734 Test Acc: 0.764
Validation loss decreased (-0.430534 --> -0.763872).  Saving model ...
Epoch: 4 cost time: 0.7974750995635986
Epoch: 4, Steps: 7 | Train Loss: 1.488 Vali Loss: 1.202 Vali Acc: 0.819 Test Loss: 1.202 Test Acc: 0.819
Validation loss decreased (-0.763872 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 1.1279454231262207
Epoch: 5, Steps: 7 | Train Loss: 0.882 Vali Loss: 0.622 Vali Acc: 0.917 Test Loss: 0.622 Test Acc: 0.917
Validation loss decreased (-0.819432 --> -0.916660).  Saving model ...
Epoch: 6 cost time: 1.0568604469299316
Epoch: 6, Steps: 7 | Train Loss: 0.359 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0453770160675049
Epoch: 7, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.048142910003662
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9969334602355957
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8085863590240479
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8157601356506348
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0708281993865967
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.034651756286621
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 0.8606729507446289
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 0.9677422046661377
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 0.9578754901885986
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.062877893447876
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0836842060089111
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8872101306915283
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 0.9354982376098633
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 1.0188589096069336
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 0.9787628650665283
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9991116523742676
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6893587112426758
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.9728131294250488
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 0.8398630619049072
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 1.0223689079284668
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.931 Test Loss: 0.166 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 1.0181231498718262
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.9913036823272705
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9730863571166992
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.931 Test Loss: 0.162 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7709383964538574
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.984398365020752
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8981113433837891
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9207088947296143
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9530134201049805
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.931 Test Loss: 0.166 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8875360488891602
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0043251514434814
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.022202491760254
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 44743692
model size : 185.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0217444896698
Epoch: 1, Steps: 7 | Train Loss: 2.578 Vali Loss: 2.509 Vali Acc: 0.083 Test Loss: 2.509 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7634778022766113
Epoch: 2, Steps: 7 | Train Loss: 2.461 Vali Loss: 2.317 Vali Acc: 0.319 Test Loss: 2.317 Test Acc: 0.319
Validation loss decreased (-0.083308 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 0.6169562339782715
Epoch: 3, Steps: 7 | Train Loss: 2.179 Vali Loss: 2.057 Vali Acc: 0.625 Test Loss: 2.057 Test Acc: 0.625
Validation loss decreased (-0.319421 --> -0.624979).  Saving model ...
Epoch: 4 cost time: 0.7535965442657471
Epoch: 4, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.709 Vali Acc: 0.722 Test Loss: 1.709 Test Acc: 0.722
Validation loss decreased (-0.624979 --> -0.722205).  Saving model ...
Epoch: 5 cost time: 0.7069926261901855
Epoch: 5, Steps: 7 | Train Loss: 1.470 Vali Loss: 1.224 Vali Acc: 0.736 Test Loss: 1.224 Test Acc: 0.736
Validation loss decreased (-0.722205 --> -0.736099).  Saving model ...
Epoch: 6 cost time: 0.7232282161712646
Epoch: 6, Steps: 7 | Train Loss: 0.944 Vali Loss: 0.788 Vali Acc: 0.764 Test Loss: 0.788 Test Acc: 0.764
Validation loss decreased (-0.736099 --> -0.763881).  Saving model ...
Epoch: 7 cost time: 0.688403844833374
Epoch: 7, Steps: 7 | Train Loss: 0.502 Vali Loss: 0.481 Vali Acc: 0.889 Test Loss: 0.481 Test Acc: 0.889
Validation loss decreased (-0.763881 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.7542219161987305
Epoch: 8, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.6783633232116699
Epoch: 9, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.690150260925293
Epoch: 10, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7108256816864014
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.8160750865936279
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7018129825592041
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6957921981811523
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7041804790496826
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6176965236663818
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6889913082122803
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 18 cost time: 0.6851625442504883
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.889 Test Loss: 0.214 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7146897315979004
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.889 Test Loss: 0.217 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6533353328704834
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5819902420043945
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5687263011932373
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6729719638824463
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.875 Test Loss: 0.238 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5385584831237793
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.875 Test Loss: 0.243 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6364176273345947
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6561398506164551
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5358898639678955
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.6969602108001709
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6187047958374023
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.729729175567627
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.889 Test Loss: 0.208 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7721362113952637
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.889 Test Loss: 0.205 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6590547561645508
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.889 Test Loss: 0.212 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5628335475921631
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6829714775085449
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7754490375518799
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7180516719818115
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7528455257415771
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.889 Test Loss: 0.219 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 44582412
model size : 184.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.654635429382324
Epoch: 1, Steps: 7 | Train Loss: 2.654 Vali Loss: 2.412 Vali Acc: 0.111 Test Loss: 2.412 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.301497459411621
Epoch: 2, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.030 Vali Acc: 0.528 Test Loss: 2.030 Test Acc: 0.528
Validation loss decreased (-0.111087 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.9246692657470703
Epoch: 3, Steps: 7 | Train Loss: 1.767 Vali Loss: 1.530 Vali Acc: 0.667 Test Loss: 1.530 Test Acc: 0.667
Validation loss decreased (-0.527757 --> -0.666651).  Saving model ...
Epoch: 4 cost time: 1.0924997329711914
Epoch: 4, Steps: 7 | Train Loss: 1.076 Vali Loss: 0.873 Vali Acc: 0.847 Test Loss: 0.873 Test Acc: 0.847
Validation loss decreased (-0.666651 --> -0.847213).  Saving model ...
Epoch: 5 cost time: 0.877643346786499
Epoch: 5, Steps: 7 | Train Loss: 0.477 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0648119449615479
Epoch: 6, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
Validation loss decreased (-0.847213 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.0546753406524658
Epoch: 7, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.8672137260437012
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.0989751815795898
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.6175835132598877
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5811705589294434
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.546196699142456
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5667946338653564
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.1968414783477783
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6247544288635254
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.1561996936798096
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0290918350219727
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1954045295715332
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9289567470550537
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8639659881591797
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2034482955932617
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.194983959197998
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2514445781707764
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.0705409049987793
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.306631088256836
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.6645424365997314
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.2868866920471191
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6054322719573975
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.024770736694336
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.9540793895721436
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.0672118663787842
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0088355541229248
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1554319858551025
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9394943714141846
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0593178272247314
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0384953022003174
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 37 cost time: 1.2722132205963135
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 38 cost time: 1.0955722332000732
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 39 cost time: 1.0224454402923584
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 40 cost time: 1.040480375289917
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 41 cost time: 1.2335798740386963
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.958 Test Loss: 0.242 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 42 cost time: 1.0482099056243896
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.026766300201416
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.298304557800293
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0295240879058838
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0293889045715332
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2267181873321533
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9479727745056152
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.2576158046722412
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2519521713256836
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 45092364
model size : 186.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4109342098236084
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.407 Vali Acc: 0.264 Test Loss: 2.407 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.7332844734191895
Epoch: 2, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.113 Vali Acc: 0.569 Test Loss: 2.113 Test Acc: 0.569
Validation loss decreased (-0.263865 --> -0.569423).  Saving model ...
Epoch: 3 cost time: 0.853402853012085
Epoch: 3, Steps: 7 | Train Loss: 1.896 Vali Loss: 1.709 Vali Acc: 0.722 Test Loss: 1.709 Test Acc: 0.722
Validation loss decreased (-0.569423 --> -0.722205).  Saving model ...
Epoch: 4 cost time: 0.999845027923584
Epoch: 4, Steps: 7 | Train Loss: 1.370 Vali Loss: 1.175 Vali Acc: 0.833 Test Loss: 1.175 Test Acc: 0.833
Validation loss decreased (-0.722205 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 0.8381650447845459
Epoch: 5, Steps: 7 | Train Loss: 0.771 Vali Loss: 0.653 Vali Acc: 0.889 Test Loss: 0.653 Test Acc: 0.889
Validation loss decreased (-0.833322 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 0.8860723972320557
Epoch: 6, Steps: 7 | Train Loss: 0.330 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.0771453380584717
Epoch: 7, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7410616874694824
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.412 Vali Acc: 0.917 Test Loss: 0.412 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.6772551536560059
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.289 Vali Acc: 0.931 Test Loss: 0.289 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9997110366821289
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.8592691421508789
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.8387789726257324
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8408598899841309
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8790500164031982
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9092333316802979
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9232316017150879
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8450946807861328
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8733086585998535
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8434247970581055
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.800255298614502
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7515521049499512
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44791308
model size : 185.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1267106533050537
Epoch: 1, Steps: 7 | Train Loss: 2.617 Vali Loss: 2.453 Vali Acc: 0.097 Test Loss: 2.453 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6624696254730225
Epoch: 2, Steps: 7 | Train Loss: 2.387 Vali Loss: 2.265 Vali Acc: 0.403 Test Loss: 2.265 Test Acc: 0.403
Validation loss decreased (-0.097198 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.5825395584106445
Epoch: 3, Steps: 7 | Train Loss: 2.138 Vali Loss: 2.043 Vali Acc: 0.597 Test Loss: 2.043 Test Acc: 0.597
Validation loss decreased (-0.402755 --> -0.597202).  Saving model ...
Epoch: 4 cost time: 0.5160994529724121
Epoch: 4, Steps: 7 | Train Loss: 1.822 Vali Loss: 1.699 Vali Acc: 0.736 Test Loss: 1.699 Test Acc: 0.736
Validation loss decreased (-0.597202 --> -0.736094).  Saving model ...
Epoch: 5 cost time: 0.5932796001434326
Epoch: 5, Steps: 7 | Train Loss: 1.400 Vali Loss: 1.163 Vali Acc: 0.819 Test Loss: 1.163 Test Acc: 0.819
Validation loss decreased (-0.736094 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 0.638390064239502
Epoch: 6, Steps: 7 | Train Loss: 0.946 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.6330533027648926
Epoch: 7, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.565990686416626
Epoch: 8, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.6350400447845459
Epoch: 9, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6658127307891846
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.5653395652770996
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6391501426696777
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.565850019454956
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.5184779167175293
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.45314741134643555
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4886317253112793
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5597290992736816
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6072530746459961
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6651432514190674
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6436522006988525
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6487762928009033
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5999717712402344
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5437371730804443
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6251780986785889
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7022600173950195
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6705343723297119
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.768226146697998
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6494364738464355
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6469550132751465
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6695132255554199
Epoch: 30, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6373653411865234
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.49137067794799805
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6583936214447021
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7409923076629639
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7177345752716064
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5716817378997803
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7452640533447266
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44640780
model size : 184.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps86_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.368372917175293
Epoch: 1, Steps: 7 | Train Loss: 2.651 Vali Loss: 2.487 Vali Acc: 0.181 Test Loss: 2.487 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.8571114540100098
Epoch: 2, Steps: 7 | Train Loss: 2.286 Vali Loss: 2.033 Vali Acc: 0.514 Test Loss: 2.033 Test Acc: 0.514
Validation loss decreased (-0.180531 --> -0.513869).  Saving model ...
Epoch: 3 cost time: 0.9452705383300781
Epoch: 3, Steps: 7 | Train Loss: 1.706 Vali Loss: 1.381 Vali Acc: 0.819 Test Loss: 1.381 Test Acc: 0.819
Validation loss decreased (-0.513869 --> -0.819431).  Saving model ...
Epoch: 4 cost time: 1.0336167812347412
Epoch: 4, Steps: 7 | Train Loss: 0.894 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
Validation loss decreased (-0.819431 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 1.04486083984375
Epoch: 5, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
Validation loss decreased (-0.874994 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.0707669258117676
Epoch: 6, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.013871669769287
Epoch: 7, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9179611206054688
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.0273387432098389
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.350 Vali Acc: 0.875 Test Loss: 0.350 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.038072109222412
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9777209758758545
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.861 Test Loss: 0.440 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9459786415100098
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9328863620758057
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9688794612884521
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8863310813903809
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0758287906646729
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.903 Test Loss: 0.456 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0272305011749268
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8509294986724854
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps86_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 45121548
model size : 186.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps86_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2664194107055664
Epoch: 1, Steps: 7 | Train Loss: 2.659 Vali Loss: 2.479 Vali Acc: 0.014 Test Loss: 2.479 Test Acc: 0.014
Validation loss decreased (inf --> -0.013864).  Saving model ...
Epoch: 2 cost time: 0.9356563091278076
Epoch: 2, Steps: 7 | Train Loss: 2.414 Vali Loss: 2.211 Vali Acc: 0.361 Test Loss: 2.211 Test Acc: 0.361
Validation loss decreased (-0.013864 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.6584262847900391
Epoch: 3, Steps: 7 | Train Loss: 2.055 Vali Loss: 1.877 Vali Acc: 0.653 Test Loss: 1.877 Test Acc: 0.653
Validation loss decreased (-0.361089 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.5832335948944092
Epoch: 4, Steps: 7 | Train Loss: 1.594 Vali Loss: 1.296 Vali Acc: 0.708 Test Loss: 1.296 Test Acc: 0.708
Validation loss decreased (-0.652759 --> -0.708320).  Saving model ...
Epoch: 5 cost time: 0.5951642990112305
Epoch: 5, Steps: 7 | Train Loss: 0.852 Vali Loss: 0.683 Vali Acc: 0.819 Test Loss: 0.683 Test Acc: 0.819
Validation loss decreased (-0.708320 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 0.6084606647491455
Epoch: 6, Steps: 7 | Train Loss: 0.333 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
Validation loss decreased (-0.819438 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.94362473487854
Epoch: 7, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.7402744293212891
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.7247753143310547
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7258665561676025
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.751429557800293
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.5711779594421387
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8270134925842285
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.848703145980835
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8040742874145508
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.816502571105957
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7899794578552246
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7525477409362793
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8280260562896729
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9023492336273193
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7781589031219482
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7166249752044678
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps86_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 44852748
model size : 185.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps86_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.147726535797119
Epoch: 1, Steps: 7 | Train Loss: 2.641 Vali Loss: 2.504 Vali Acc: 0.097 Test Loss: 2.504 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.755063533782959
Epoch: 2, Steps: 7 | Train Loss: 2.457 Vali Loss: 2.300 Vali Acc: 0.333 Test Loss: 2.300 Test Acc: 0.333
Validation loss decreased (-0.097197 --> -0.333310).  Saving model ...
Epoch: 3 cost time: 0.5273420810699463
Epoch: 3, Steps: 7 | Train Loss: 2.209 Vali Loss: 2.021 Vali Acc: 0.611 Test Loss: 2.021 Test Acc: 0.611
Validation loss decreased (-0.333310 --> -0.611091).  Saving model ...
Epoch: 4 cost time: 0.7456064224243164
Epoch: 4, Steps: 7 | Train Loss: 1.806 Vali Loss: 1.608 Vali Acc: 0.764 Test Loss: 1.608 Test Acc: 0.764
Validation loss decreased (-0.611091 --> -0.763873).  Saving model ...
Epoch: 5 cost time: 0.6388468742370605
Epoch: 5, Steps: 7 | Train Loss: 1.291 Vali Loss: 0.994 Vali Acc: 0.847 Test Loss: 0.994 Test Acc: 0.847
Validation loss decreased (-0.763873 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.7345569133758545
Epoch: 6, Steps: 7 | Train Loss: 0.682 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
Validation loss decreased (-0.847212 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.6724891662597656
Epoch: 7, Steps: 7 | Train Loss: 0.309 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.6716644763946533
Epoch: 8, Steps: 7 | Train Loss: 0.128 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7010624408721924
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.778010368347168
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.378 Vali Acc: 0.917 Test Loss: 0.378 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.6514642238616943
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.384 Vali Acc: 0.931 Test Loss: 0.384 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.809889554977417
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5645382404327393
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6309435367584229
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6606564521789551
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.343 Vali Acc: 0.903 Test Loss: 0.343 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7652735710144043
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6202809810638428
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7160384654998779
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7642629146575928
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6033284664154053
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5394730567932129
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps86_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44712972
model size : 185.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.225282669067383
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.449 Vali Acc: 0.139 Test Loss: 2.449 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.9239411354064941
Epoch: 2, Steps: 7 | Train Loss: 2.283 Vali Loss: 2.032 Vali Acc: 0.542 Test Loss: 2.032 Test Acc: 0.542
Validation loss decreased (-0.138864 --> -0.541646).  Saving model ...
Epoch: 3 cost time: 1.1446263790130615
Epoch: 3, Steps: 7 | Train Loss: 1.703 Vali Loss: 1.328 Vali Acc: 0.694 Test Loss: 1.328 Test Acc: 0.694
Validation loss decreased (-0.541646 --> -0.694431).  Saving model ...
Epoch: 4 cost time: 1.0973057746887207
Epoch: 4, Steps: 7 | Train Loss: 0.986 Vali Loss: 0.684 Vali Acc: 0.778 Test Loss: 0.684 Test Acc: 0.778
Validation loss decreased (-0.694431 --> -0.777771).  Saving model ...
Epoch: 5 cost time: 1.0310540199279785
Epoch: 5, Steps: 7 | Train Loss: 0.365 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
Validation loss decreased (-0.777771 --> -0.819440).  Saving model ...
Epoch: 6 cost time: 1.2387683391571045
Epoch: 6, Steps: 7 | Train Loss: 0.110 Vali Loss: 0.379 Vali Acc: 0.847 Test Loss: 0.379 Test Acc: 0.847
Validation loss decreased (-0.819440 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 1.0696022510528564
Epoch: 7, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.2519404888153076
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.446 Vali Acc: 0.861 Test Loss: 0.446 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0308902263641357
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 1.0096993446350098
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8169848918914795
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0049002170562744
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.889 Test Loss: 0.449 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9345433712005615
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8727190494537354
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8462092876434326
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.9851269721984863
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 0.9884614944458008
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.8714983463287354
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 0.6166343688964844
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.8298778533935547
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.073817491531372
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9149880409240723
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9486403465270996
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.8272321224212646
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.025554895401001
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9385466575622559
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9438889026641846
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0593163967132568
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.101923942565918
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9647617340087891
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.034475326538086
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8795921802520752
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0673942565917969
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 45175308
model size : 187.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.74369740486145
Epoch: 1, Steps: 7 | Train Loss: 2.726 Vali Loss: 2.552 Vali Acc: 0.069 Test Loss: 2.552 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.9696533679962158
Epoch: 2, Steps: 7 | Train Loss: 2.354 Vali Loss: 2.218 Vali Acc: 0.375 Test Loss: 2.218 Test Acc: 0.375
Validation loss decreased (-0.069419 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.704836368560791
Epoch: 3, Steps: 7 | Train Loss: 2.061 Vali Loss: 1.835 Vali Acc: 0.569 Test Loss: 1.835 Test Acc: 0.569
Validation loss decreased (-0.374978 --> -0.569426).  Saving model ...
Epoch: 4 cost time: 0.6789448261260986
Epoch: 4, Steps: 7 | Train Loss: 1.512 Vali Loss: 1.184 Vali Acc: 0.819 Test Loss: 1.184 Test Acc: 0.819
Validation loss decreased (-0.569426 --> -0.819433).  Saving model ...
Epoch: 5 cost time: 1.0380189418792725
Epoch: 5, Steps: 7 | Train Loss: 0.847 Vali Loss: 0.579 Vali Acc: 0.847 Test Loss: 0.579 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.9544987678527832
Epoch: 6, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.8790144920349121
Epoch: 7, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.9321422576904297
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.9449841976165771
Epoch: 9, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.384 Vali Acc: 0.847 Test Loss: 0.384 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.743380069732666
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.372 Vali Acc: 0.847 Test Loss: 0.372 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8515853881835938
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.7345819473266602
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.7710692882537842
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.6844699382781982
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.790799617767334
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7746634483337402
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.133042573928833
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9163727760314941
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.022625207901001
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0497572422027588
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8863770961761475
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.922914981842041
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9683349132537842
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44928012
model size : 186.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.17077374458313
Epoch: 1, Steps: 7 | Train Loss: 2.659 Vali Loss: 2.513 Vali Acc: 0.083 Test Loss: 2.513 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7591876983642578
Epoch: 2, Steps: 7 | Train Loss: 2.475 Vali Loss: 2.260 Vali Acc: 0.361 Test Loss: 2.260 Test Acc: 0.361
Validation loss decreased (-0.083308 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.7406227588653564
Epoch: 3, Steps: 7 | Train Loss: 2.231 Vali Loss: 1.999 Vali Acc: 0.611 Test Loss: 1.999 Test Acc: 0.611
Validation loss decreased (-0.361089 --> -0.611091).  Saving model ...
Epoch: 4 cost time: 0.5561010837554932
Epoch: 4, Steps: 7 | Train Loss: 1.902 Vali Loss: 1.682 Vali Acc: 0.681 Test Loss: 1.682 Test Acc: 0.681
Validation loss decreased (-0.611091 --> -0.680539).  Saving model ...
Epoch: 5 cost time: 0.6856896877288818
Epoch: 5, Steps: 7 | Train Loss: 1.482 Vali Loss: 1.213 Vali Acc: 0.778 Test Loss: 1.213 Test Acc: 0.778
Validation loss decreased (-0.680539 --> -0.777766).  Saving model ...
Epoch: 6 cost time: 0.6696341037750244
Epoch: 6, Steps: 7 | Train Loss: 0.973 Vali Loss: 0.763 Vali Acc: 0.792 Test Loss: 0.763 Test Acc: 0.792
Validation loss decreased (-0.777766 --> -0.791659).  Saving model ...
Epoch: 7 cost time: 0.5773241519927979
Epoch: 7, Steps: 7 | Train Loss: 0.493 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.791659 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.5800619125366211
Epoch: 8, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5426497459411621
Epoch: 9, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.428 Vali Acc: 0.861 Test Loss: 0.428 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5296802520751953
Epoch: 10, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.391 Vali Acc: 0.847 Test Loss: 0.391 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7392451763153076
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6836695671081543
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 0.6436011791229248
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6255702972412109
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.5322086811065674
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.632875919342041
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6859486103057861
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6487669944763184
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5211365222930908
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6899445056915283
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6435577869415283
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6713676452636719
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6392192840576172
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5769033432006836
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6567134857177734
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6787188053131104
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 44798988
model size : 185.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.709569215774536
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.447 Vali Acc: 0.097 Test Loss: 2.447 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.7333066463470459
Epoch: 2, Steps: 7 | Train Loss: 2.309 Vali Loss: 2.052 Vali Acc: 0.472 Test Loss: 2.052 Test Acc: 0.472
Validation loss decreased (-0.097198 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 0.8646397590637207
Epoch: 3, Steps: 7 | Train Loss: 1.808 Vali Loss: 1.519 Vali Acc: 0.819 Test Loss: 1.519 Test Acc: 0.819
Validation loss decreased (-0.472202 --> -0.819429).  Saving model ...
Epoch: 4 cost time: 0.8644835948944092
Epoch: 4, Steps: 7 | Train Loss: 1.084 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
Validation loss decreased (-0.819429 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 0.8299908638000488
Epoch: 5, Steps: 7 | Train Loss: 0.381 Vali Loss: 0.405 Vali Acc: 0.847 Test Loss: 0.405 Test Acc: 0.847
Validation loss decreased (-0.833326 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 1.0039546489715576
Epoch: 6, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 1.0233891010284424
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.9347825050354004
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916665).  Saving model ...
Epoch: 9 cost time: 1.0919928550720215
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.875 Test Loss: 0.240 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1532022953033447
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 11 cost time: 1.0402803421020508
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.916665 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 1.1277999877929688
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0709197521209717
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1478745937347412
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9648070335388184
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0785658359527588
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0896461009979248
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1576423645019531
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0923080444335938
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.210505485534668
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.239229679107666
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 45239820
model size : 187.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4473698139190674
Epoch: 1, Steps: 7 | Train Loss: 2.655 Vali Loss: 2.465 Vali Acc: 0.222 Test Loss: 2.465 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.9629042148590088
Epoch: 2, Steps: 7 | Train Loss: 2.365 Vali Loss: 2.187 Vali Acc: 0.347 Test Loss: 2.187 Test Acc: 0.347
Validation loss decreased (-0.222198 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.7820627689361572
Epoch: 3, Steps: 7 | Train Loss: 1.996 Vali Loss: 1.808 Vali Acc: 0.694 Test Loss: 1.808 Test Acc: 0.694
Validation loss decreased (-0.347200 --> -0.694426).  Saving model ...
Epoch: 4 cost time: 1.0586225986480713
Epoch: 4, Steps: 7 | Train Loss: 1.539 Vali Loss: 1.301 Vali Acc: 0.833 Test Loss: 1.301 Test Acc: 0.833
Validation loss decreased (-0.694426 --> -0.833320).  Saving model ...
Epoch: 5 cost time: 1.0020356178283691
Epoch: 5, Steps: 7 | Train Loss: 0.974 Vali Loss: 0.763 Vali Acc: 0.833 Test Loss: 0.763 Test Acc: 0.833
Validation loss decreased (-0.833320 --> -0.833326).  Saving model ...
Epoch: 6 cost time: 0.7539637088775635
Epoch: 6, Steps: 7 | Train Loss: 0.484 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.833326 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.8075509071350098
Epoch: 7, Steps: 7 | Train Loss: 0.164 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6782116889953613
Epoch: 8, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.7437746524810791
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.6554908752441406
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.9047186374664307
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8041305541992188
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7281606197357178
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6928019523620605
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6274154186248779
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6906232833862305
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6849117279052734
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.7958180904388428
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.6220955848693848
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.0085022449493408
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5930972099304199
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6735739707946777
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7214260101318359
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8046305179595947
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.834287166595459
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6382989883422852
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.632347583770752
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.546623945236206
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.7877516746520996
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9285256862640381
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6652379035949707
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.665515661239624
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7381558418273926
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6182100772857666
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.559173583984375
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5622572898864746
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6025869846343994
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6128134727478027
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 45003276
model size : 186.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.99245023727417
Epoch: 1, Steps: 7 | Train Loss: 2.664 Vali Loss: 2.555 Vali Acc: 0.111 Test Loss: 2.555 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6515178680419922
Epoch: 2, Steps: 7 | Train Loss: 2.469 Vali Loss: 2.320 Vali Acc: 0.403 Test Loss: 2.320 Test Acc: 0.403
Validation loss decreased (-0.111086 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.6500651836395264
Epoch: 3, Steps: 7 | Train Loss: 2.170 Vali Loss: 2.041 Vali Acc: 0.653 Test Loss: 2.041 Test Acc: 0.653
Validation loss decreased (-0.402755 --> -0.652757).  Saving model ...
Epoch: 4 cost time: 0.7879598140716553
Epoch: 4, Steps: 7 | Train Loss: 1.853 Vali Loss: 1.660 Vali Acc: 0.750 Test Loss: 1.660 Test Acc: 0.750
Validation loss decreased (-0.652757 --> -0.749983).  Saving model ...
Epoch: 5 cost time: 0.7704586982727051
Epoch: 5, Steps: 7 | Train Loss: 1.404 Vali Loss: 1.128 Vali Acc: 0.833 Test Loss: 1.128 Test Acc: 0.833
Validation loss decreased (-0.749983 --> -0.833322).  Saving model ...
Epoch: 6 cost time: 0.651874303817749
Epoch: 6, Steps: 7 | Train Loss: 0.865 Vali Loss: 0.769 Vali Acc: 0.847 Test Loss: 0.769 Test Acc: 0.847
Validation loss decreased (-0.833322 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 0.6433980464935303
Epoch: 7, Steps: 7 | Train Loss: 0.442 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.6599996089935303
Epoch: 8, Steps: 7 | Train Loss: 0.195 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.6569063663482666
Epoch: 9, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.5671365261077881
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.600898265838623
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6196165084838867
Epoch: 12, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.5932784080505371
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.5807604789733887
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6013658046722412
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.614647388458252
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6698915958404541
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5697495937347412
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.591339111328125
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5667939186096191
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.7292513847351074
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.5748863220214844
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.52516770362854
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4906425476074219
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5669891834259033
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6024112701416016
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6398963928222656
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.6175355911254883
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.68135666847229
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.6715424060821533
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.6513049602508545
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5813577175140381
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7577486038208008
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.741673469543457
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 0.7564618587493896
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5658986568450928
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5933480262756348
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5759661197662354
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6418795585632324
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5322420597076416
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6361551284790039
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6818256378173828
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5974478721618652
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6003189086914062
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 44885004
model size : 185.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2830283641815186
Epoch: 1, Steps: 7 | Train Loss: 2.566 Vali Loss: 2.419 Vali Acc: 0.208 Test Loss: 2.419 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.8657658100128174
Epoch: 2, Steps: 7 | Train Loss: 2.262 Vali Loss: 1.997 Vali Acc: 0.417 Test Loss: 1.997 Test Acc: 0.417
Validation loss decreased (-0.208309 --> -0.416647).  Saving model ...
Epoch: 3 cost time: 0.9117066860198975
Epoch: 3, Steps: 7 | Train Loss: 1.810 Vali Loss: 1.480 Vali Acc: 0.736 Test Loss: 1.480 Test Acc: 0.736
Validation loss decreased (-0.416647 --> -0.736096).  Saving model ...
Epoch: 4 cost time: 0.802436351776123
Epoch: 4, Steps: 7 | Train Loss: 1.083 Vali Loss: 0.831 Vali Acc: 0.833 Test Loss: 0.831 Test Acc: 0.833
Validation loss decreased (-0.736096 --> -0.833325).  Saving model ...
Epoch: 5 cost time: 1.0011565685272217
Epoch: 5, Steps: 7 | Train Loss: 0.444 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.8602855205535889
Epoch: 6, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9243526458740234
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.917384147644043
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.7312829494476318
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6433885097503662
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6277632713317871
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7653915882110596
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.881666898727417
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9726114273071289
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.8238875865936279
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.0970139503479004
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0125834941864014
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0188913345336914
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1072759628295898
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8832831382751465
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9245719909667969
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0445637702941895
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9433929920196533
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9581637382507324
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0563111305236816
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 45310476
model size : 187.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2345783710479736
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.466 Vali Acc: 0.139 Test Loss: 2.466 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.838364839553833
Epoch: 2, Steps: 7 | Train Loss: 2.358 Vali Loss: 2.163 Vali Acc: 0.375 Test Loss: 2.163 Test Acc: 0.375
Validation loss decreased (-0.138864 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 1.0024833679199219
Epoch: 3, Steps: 7 | Train Loss: 2.028 Vali Loss: 1.798 Vali Acc: 0.625 Test Loss: 1.798 Test Acc: 0.625
Validation loss decreased (-0.374978 --> -0.624982).  Saving model ...
Epoch: 4 cost time: 0.6483018398284912
Epoch: 4, Steps: 7 | Train Loss: 1.533 Vali Loss: 1.256 Vali Acc: 0.819 Test Loss: 1.256 Test Acc: 0.819
Validation loss decreased (-0.624982 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 0.9833567142486572
Epoch: 5, Steps: 7 | Train Loss: 0.938 Vali Loss: 0.725 Vali Acc: 0.847 Test Loss: 0.725 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 0.8103692531585693
Epoch: 6, Steps: 7 | Train Loss: 0.510 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.6328237056732178
Epoch: 7, Steps: 7 | Train Loss: 0.210 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7311713695526123
Epoch: 8, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.9616012573242188
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.8161141872406006
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9622726440429688
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9720299243927002
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8168070316314697
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9987118244171143
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.942096471786499
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.903 Test Loss: 0.426 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7330529689788818
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7905397415161133
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.903 Test Loss: 0.380 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0665433406829834
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.979926586151123
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0008947849273682
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7639856338500977
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6556899547576904
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 45106188
model size : 186.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8969495296478271
Epoch: 1, Steps: 7 | Train Loss: 2.676 Vali Loss: 2.531 Vali Acc: 0.111 Test Loss: 2.531 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5175259113311768
Epoch: 2, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.286 Vali Acc: 0.375 Test Loss: 2.286 Test Acc: 0.375
Validation loss decreased (-0.111086 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.6262228488922119
Epoch: 3, Steps: 7 | Train Loss: 2.178 Vali Loss: 2.040 Vali Acc: 0.625 Test Loss: 2.040 Test Acc: 0.625
Validation loss decreased (-0.374977 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 0.5899553298950195
Epoch: 4, Steps: 7 | Train Loss: 1.858 Vali Loss: 1.703 Vali Acc: 0.778 Test Loss: 1.703 Test Acc: 0.778
Validation loss decreased (-0.624980 --> -0.777761).  Saving model ...
Epoch: 5 cost time: 0.7504482269287109
Epoch: 5, Steps: 7 | Train Loss: 1.451 Vali Loss: 1.251 Vali Acc: 0.806 Test Loss: 1.251 Test Acc: 0.806
Validation loss decreased (-0.777761 --> -0.805543).  Saving model ...
Epoch: 6 cost time: 0.7344977855682373
Epoch: 6, Steps: 7 | Train Loss: 1.038 Vali Loss: 0.832 Vali Acc: 0.819 Test Loss: 0.832 Test Acc: 0.819
Validation loss decreased (-0.805543 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 0.6254000663757324
Epoch: 7, Steps: 7 | Train Loss: 0.551 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.6935956478118896
Epoch: 8, Steps: 7 | Train Loss: 0.262 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.66977858543396
Epoch: 9, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.6638941764831543
Epoch: 10, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6476311683654785
Epoch: 11, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.44509458541870117
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.7114870548248291
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.5536460876464844
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.7037596702575684
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.6687610149383545
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7371881008148193
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7327835559844971
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5922372341156006
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7431740760803223
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7231905460357666
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7684426307678223
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6693832874298096
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6332049369812012
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7863185405731201
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 44998668
model size : 186.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.197018623352051
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.477 Vali Acc: 0.097 Test Loss: 2.477 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.9486486911773682
Epoch: 2, Steps: 7 | Train Loss: 2.320 Vali Loss: 2.077 Vali Acc: 0.486 Test Loss: 2.077 Test Acc: 0.486
Validation loss decreased (-0.097197 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 1.1074695587158203
Epoch: 3, Steps: 7 | Train Loss: 1.777 Vali Loss: 1.420 Vali Acc: 0.722 Test Loss: 1.420 Test Acc: 0.722
Validation loss decreased (-0.486090 --> -0.722208).  Saving model ...
Epoch: 4 cost time: 0.9531664848327637
Epoch: 4, Steps: 7 | Train Loss: 1.042 Vali Loss: 0.835 Vali Acc: 0.764 Test Loss: 0.835 Test Acc: 0.764
Validation loss decreased (-0.722208 --> -0.763881).  Saving model ...
Epoch: 5 cost time: 1.030055046081543
Epoch: 5, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.517 Vali Acc: 0.806 Test Loss: 0.517 Test Acc: 0.806
Validation loss decreased (-0.763881 --> -0.805550).  Saving model ...
Epoch: 6 cost time: 1.04081392288208
Epoch: 6, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
Validation loss decreased (-0.805550 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.9552340507507324
Epoch: 7, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.0744853019714355
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.928577184677124
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.074913501739502
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9606273174285889
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.7993788719177246
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8066902160644531
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7929999828338623
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6978898048400879
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1013309955596924
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.903 Test Loss: 0.235 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0995354652404785
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7759726047515869
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7864630222320557
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7656617164611816
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0369291305541992
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9410665035247803
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.890479326248169
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9511876106262207
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45430284
model size : 187.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3895719051361084
Epoch: 1, Steps: 7 | Train Loss: 2.560 Vali Loss: 2.434 Vali Acc: 0.167 Test Loss: 2.434 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.6119446754455566
Epoch: 2, Steps: 7 | Train Loss: 2.356 Vali Loss: 2.122 Vali Acc: 0.528 Test Loss: 2.122 Test Acc: 0.528
Validation loss decreased (-0.166642 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.8801486492156982
Epoch: 3, Steps: 7 | Train Loss: 1.994 Vali Loss: 1.559 Vali Acc: 0.694 Test Loss: 1.559 Test Acc: 0.694
Validation loss decreased (-0.527757 --> -0.694429).  Saving model ...
Epoch: 4 cost time: 0.48822641372680664
Epoch: 4, Steps: 7 | Train Loss: 1.436 Vali Loss: 1.098 Vali Acc: 0.750 Test Loss: 1.098 Test Acc: 0.750
Validation loss decreased (-0.694429 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 0.9419941902160645
Epoch: 5, Steps: 7 | Train Loss: 0.890 Vali Loss: 0.766 Vali Acc: 0.806 Test Loss: 0.766 Test Acc: 0.806
Validation loss decreased (-0.749989 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 0.8743131160736084
Epoch: 6, Steps: 7 | Train Loss: 0.438 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.805548 --> -0.819439).  Saving model ...
Epoch: 7 cost time: 0.6828744411468506
Epoch: 7, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.819439 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 0.9456973075866699
Epoch: 8, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.968151330947876
Epoch: 9, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.373 Vali Acc: 0.903 Test Loss: 0.373 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.9803128242492676
Epoch: 10, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.976311445236206
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8867073059082031
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.688715934753418
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.0056698322296143
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9153716564178467
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8682022094726562
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7753918170928955
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0366442203521729
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.7078232765197754
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.7507784366607666
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9728734493255615
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8700850009918213
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7595553398132324
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9708428382873535
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.892784833908081
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8404738903045654
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7508969306945801
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8493976593017578
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8399310111999512
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45236748
model size : 187.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.074434518814087
Epoch: 1, Steps: 7 | Train Loss: 2.568 Vali Loss: 2.494 Vali Acc: 0.042 Test Loss: 2.494 Test Acc: 0.042
Validation loss decreased (inf --> -0.041642).  Saving model ...
Epoch: 2 cost time: 0.594078779220581
Epoch: 2, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.309 Vali Acc: 0.250 Test Loss: 2.309 Test Acc: 0.250
Validation loss decreased (-0.041642 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 0.562507152557373
Epoch: 3, Steps: 7 | Train Loss: 2.150 Vali Loss: 2.045 Vali Acc: 0.556 Test Loss: 2.045 Test Acc: 0.556
Validation loss decreased (-0.249977 --> -0.555535).  Saving model ...
Epoch: 4 cost time: 0.6031749248504639
Epoch: 4, Steps: 7 | Train Loss: 1.856 Vali Loss: 1.689 Vali Acc: 0.694 Test Loss: 1.689 Test Acc: 0.694
Validation loss decreased (-0.555535 --> -0.694428).  Saving model ...
Epoch: 5 cost time: 0.5974292755126953
Epoch: 5, Steps: 7 | Train Loss: 1.408 Vali Loss: 1.238 Vali Acc: 0.750 Test Loss: 1.238 Test Acc: 0.750
Validation loss decreased (-0.694428 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.6311254501342773
Epoch: 6, Steps: 7 | Train Loss: 0.918 Vali Loss: 0.817 Vali Acc: 0.833 Test Loss: 0.817 Test Acc: 0.833
Validation loss decreased (-0.749988 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.6625335216522217
Epoch: 7, Steps: 7 | Train Loss: 0.498 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.6441717147827148
Epoch: 8, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6922605037689209
Epoch: 9, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.6993780136108398
Epoch: 10, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6618649959564209
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.6853618621826172
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.7096946239471436
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6360001564025879
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5381407737731934
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5802221298217773
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5509989261627197
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.47797322273254395
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.550922155380249
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6166789531707764
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.579864501953125
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6833865642547607
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5612401962280273
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 45139980
model size : 186.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps133_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.175510883331299
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.372 Vali Acc: 0.319 Test Loss: 2.372 Test Acc: 0.319
Validation loss decreased (inf --> -0.319421).  Saving model ...
Epoch: 2 cost time: 0.7140257358551025
Epoch: 2, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.016 Vali Acc: 0.472 Test Loss: 2.016 Test Acc: 0.472
Validation loss decreased (-0.319421 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 0.8677828311920166
Epoch: 3, Steps: 7 | Train Loss: 1.862 Vali Loss: 1.530 Vali Acc: 0.778 Test Loss: 1.530 Test Acc: 0.778
Validation loss decreased (-0.472202 --> -0.777762).  Saving model ...
Epoch: 4 cost time: 0.669684886932373
Epoch: 4, Steps: 7 | Train Loss: 1.276 Vali Loss: 0.868 Vali Acc: 0.833 Test Loss: 0.868 Test Acc: 0.833
Validation loss decreased (-0.777762 --> -0.833325).  Saving model ...
Epoch: 5 cost time: 0.7405354976654053
Epoch: 5, Steps: 7 | Train Loss: 0.551 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.8973796367645264
Epoch: 6, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.7426414489746094
Epoch: 7, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.897444486618042
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7689371109008789
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.9834678173065186
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.903 Test Loss: 0.236 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.884918212890625
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8185980319976807
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.7471559047698975
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.929668664932251
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0070252418518066
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 0.7919328212738037
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 0.8955707550048828
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8259320259094238
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9260897636413574
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6997570991516113
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.903 Test Loss: 0.212 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8366286754608154
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 0.6897435188293457
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 0.7700269222259521
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6988832950592041
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.9154489040374756
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 0.9122171401977539
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.883195161819458
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.699235200881958
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7902688980102539
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9853527545928955
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6768989562988281
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7989814281463623
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0144147872924805
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9375708103179932
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.666039228439331
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps133_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45566988
model size : 188.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps133_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2675395011901855
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.451 Vali Acc: 0.097 Test Loss: 2.451 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.7972784042358398
Epoch: 2, Steps: 7 | Train Loss: 2.379 Vali Loss: 2.187 Vali Acc: 0.417 Test Loss: 2.187 Test Acc: 0.417
Validation loss decreased (-0.097198 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.8538956642150879
Epoch: 3, Steps: 7 | Train Loss: 2.096 Vali Loss: 1.892 Vali Acc: 0.569 Test Loss: 1.892 Test Acc: 0.569
Validation loss decreased (-0.416645 --> -0.569426).  Saving model ...
Epoch: 4 cost time: 0.6440989971160889
Epoch: 4, Steps: 7 | Train Loss: 1.706 Vali Loss: 1.477 Vali Acc: 0.764 Test Loss: 1.477 Test Acc: 0.764
Validation loss decreased (-0.569426 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 0.8129799365997314
Epoch: 5, Steps: 7 | Train Loss: 1.162 Vali Loss: 0.894 Vali Acc: 0.847 Test Loss: 0.894 Test Acc: 0.847
Validation loss decreased (-0.763874 --> -0.847213).  Saving model ...
Epoch: 6 cost time: 0.8005106449127197
Epoch: 6, Steps: 7 | Train Loss: 0.608 Vali Loss: 0.640 Vali Acc: 0.806 Test Loss: 0.640 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7686591148376465
Epoch: 7, Steps: 7 | Train Loss: 0.273 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.7907257080078125
Epoch: 8, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.48853611946105957
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.7176229953765869
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.7457966804504395
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9128034114837646
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8039486408233643
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7733252048492432
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7385189533233643
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8781538009643555
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5642461776733398
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6508753299713135
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8277091979980469
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9300863742828369
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7526144981384277
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps133_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45394956
model size : 187.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps133_str133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.94974946975708
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.486 Vali Acc: 0.111 Test Loss: 2.486 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5896785259246826
Epoch: 2, Steps: 7 | Train Loss: 2.421 Vali Loss: 2.251 Vali Acc: 0.486 Test Loss: 2.251 Test Acc: 0.486
Validation loss decreased (-0.111086 --> -0.486089).  Saving model ...
Epoch: 3 cost time: 0.5969164371490479
Epoch: 3, Steps: 7 | Train Loss: 2.132 Vali Loss: 2.017 Vali Acc: 0.514 Test Loss: 2.017 Test Acc: 0.514
Validation loss decreased (-0.486089 --> -0.513869).  Saving model ...
Epoch: 4 cost time: 0.6123223304748535
Epoch: 4, Steps: 7 | Train Loss: 1.814 Vali Loss: 1.706 Vali Acc: 0.694 Test Loss: 1.706 Test Acc: 0.694
Validation loss decreased (-0.513869 --> -0.694427).  Saving model ...
Epoch: 5 cost time: 0.6629838943481445
Epoch: 5, Steps: 7 | Train Loss: 1.407 Vali Loss: 1.208 Vali Acc: 0.819 Test Loss: 1.208 Test Acc: 0.819
Validation loss decreased (-0.694427 --> -0.819432).  Saving model ...
Epoch: 6 cost time: 0.542353630065918
Epoch: 6, Steps: 7 | Train Loss: 0.914 Vali Loss: 0.767 Vali Acc: 0.861 Test Loss: 0.767 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.6392393112182617
Epoch: 7, Steps: 7 | Train Loss: 0.490 Vali Loss: 0.506 Vali Acc: 0.903 Test Loss: 0.506 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.6137337684631348
Epoch: 8, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6526894569396973
Epoch: 9, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.5976052284240723
Epoch: 10, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6870620250701904
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.589576005935669
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6182630062103271
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.5535895824432373
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.573331356048584
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5778491497039795
Epoch: 16, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5840582847595215
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.889 Test Loss: 0.223 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.603215217590332
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 0.5956907272338867
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6769306659698486
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.558990478515625
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5455818176269531
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.47819018363952637
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5924997329711914
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5520622730255127
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 0.5706408023834229
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 0.5778961181640625
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5701851844787598
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5324258804321289
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6101067066192627
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5835063457489014
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5757648944854736
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 0.6010358333587646
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6140472888946533
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5546388626098633
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5877163410186768
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.6467716693878174
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 0.5315546989440918
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 39 cost time: 0.691178560256958
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5834202766418457
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5724334716796875
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5390341281890869
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5851240158081055
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6383826732635498
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6423509120941162
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5727145671844482
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6413049697875977
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.671860933303833
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps133_str133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45319692
model size : 187.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2383015155792236
Epoch: 1, Steps: 7 | Train Loss: 2.552 Vali Loss: 2.378 Vali Acc: 0.167 Test Loss: 2.378 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.7297587394714355
Epoch: 2, Steps: 7 | Train Loss: 2.318 Vali Loss: 2.060 Vali Acc: 0.736 Test Loss: 2.060 Test Acc: 0.736
Validation loss decreased (-0.166643 --> -0.736091).  Saving model ...
Epoch: 3 cost time: 0.9441664218902588
Epoch: 3, Steps: 7 | Train Loss: 1.879 Vali Loss: 1.642 Vali Acc: 0.750 Test Loss: 1.642 Test Acc: 0.750
Validation loss decreased (-0.736091 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 0.9439384937286377
Epoch: 4, Steps: 7 | Train Loss: 1.295 Vali Loss: 0.954 Vali Acc: 0.847 Test Loss: 0.954 Test Acc: 0.847
Validation loss decreased (-0.749984 --> -0.847213).  Saving model ...
Epoch: 5 cost time: 0.989215612411499
Epoch: 5, Steps: 7 | Train Loss: 0.577 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.750180721282959
Epoch: 6, Steps: 7 | Train Loss: 0.168 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
Validation loss decreased (-0.847213 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.8720262050628662
Epoch: 7, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9536459445953369
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.9155187606811523
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.954221248626709
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8235909938812256
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.8979439735412598
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.901599645614624
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7742764949798584
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7653000354766846
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8282365798950195
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9415161609649658
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.048584222793579
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9972078800201416
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9077823162078857
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0980491638183594
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45758988
model size : 189.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2001993656158447
Epoch: 1, Steps: 7 | Train Loss: 2.608 Vali Loss: 2.490 Vali Acc: 0.069 Test Loss: 2.490 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.705035924911499
Epoch: 2, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.268 Vali Acc: 0.403 Test Loss: 2.268 Test Acc: 0.403
Validation loss decreased (-0.069420 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.7330563068389893
Epoch: 3, Steps: 7 | Train Loss: 2.116 Vali Loss: 1.953 Vali Acc: 0.625 Test Loss: 1.953 Test Acc: 0.625
Validation loss decreased (-0.402755 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 0.666795015335083
Epoch: 4, Steps: 7 | Train Loss: 1.648 Vali Loss: 1.486 Vali Acc: 0.819 Test Loss: 1.486 Test Acc: 0.819
Validation loss decreased (-0.624980 --> -0.819430).  Saving model ...
Epoch: 5 cost time: 0.7958192825317383
Epoch: 5, Steps: 7 | Train Loss: 1.069 Vali Loss: 0.892 Vali Acc: 0.819 Test Loss: 0.892 Test Acc: 0.819
Validation loss decreased (-0.819430 --> -0.819436).  Saving model ...
Epoch: 6 cost time: 0.7892916202545166
Epoch: 6, Steps: 7 | Train Loss: 0.526 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 0.7363498210906982
Epoch: 7, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.429 Vali Acc: 0.861 Test Loss: 0.429 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.8348302841186523
Epoch: 8, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.7736496925354004
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
Validation loss decreased (-0.861107 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.7529432773590088
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6026356220245361
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6739566326141357
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.642911434173584
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6532783508300781
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.847 Test Loss: 0.322 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6487913131713867
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.334 Vali Acc: 0.847 Test Loss: 0.334 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6486432552337646
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8393583297729492
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6757824420928955
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.861 Test Loss: 0.338 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7200071811676025
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 45608460
model size : 188.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.905806303024292
Epoch: 1, Steps: 7 | Train Loss: 2.636 Vali Loss: 2.519 Vali Acc: 0.097 Test Loss: 2.519 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6117458343505859
Epoch: 2, Steps: 7 | Train Loss: 2.457 Vali Loss: 2.284 Vali Acc: 0.389 Test Loss: 2.284 Test Acc: 0.389
Validation loss decreased (-0.097197 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 0.6668221950531006
Epoch: 3, Steps: 7 | Train Loss: 2.150 Vali Loss: 2.013 Vali Acc: 0.542 Test Loss: 2.013 Test Acc: 0.542
Validation loss decreased (-0.388866 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 0.6664943695068359
Epoch: 4, Steps: 7 | Train Loss: 1.800 Vali Loss: 1.654 Vali Acc: 0.736 Test Loss: 1.654 Test Acc: 0.736
Validation loss decreased (-0.541647 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 0.6577913761138916
Epoch: 5, Steps: 7 | Train Loss: 1.386 Vali Loss: 1.171 Vali Acc: 0.875 Test Loss: 1.171 Test Acc: 0.875
Validation loss decreased (-0.736095 --> -0.874988).  Saving model ...
Epoch: 6 cost time: 0.6568822860717773
Epoch: 6, Steps: 7 | Train Loss: 0.868 Vali Loss: 0.810 Vali Acc: 0.833 Test Loss: 0.810 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5963344573974609
Epoch: 7, Steps: 7 | Train Loss: 0.538 Vali Loss: 0.577 Vali Acc: 0.847 Test Loss: 0.577 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6211509704589844
Epoch: 8, Steps: 7 | Train Loss: 0.249 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6384022235870361
Epoch: 9, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6413393020629883
Epoch: 10, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.427 Vali Acc: 0.847 Test Loss: 0.427 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5752308368682861
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5941321849822998
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5630884170532227
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.554558277130127
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5189192295074463
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 45533196
model size : 188.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps171_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9448657035827637
Epoch: 1, Steps: 7 | Train Loss: 2.674 Vali Loss: 2.424 Vali Acc: 0.222 Test Loss: 2.424 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.649378776550293
Epoch: 2, Steps: 7 | Train Loss: 2.345 Vali Loss: 2.108 Vali Acc: 0.444 Test Loss: 2.108 Test Acc: 0.444
Validation loss decreased (-0.222198 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.5800228118896484
Epoch: 3, Steps: 7 | Train Loss: 1.927 Vali Loss: 1.660 Vali Acc: 0.722 Test Loss: 1.660 Test Acc: 0.722
Validation loss decreased (-0.444423 --> -0.722206).  Saving model ...
Epoch: 4 cost time: 0.6765365600585938
Epoch: 4, Steps: 7 | Train Loss: 1.313 Vali Loss: 1.053 Vali Acc: 0.819 Test Loss: 1.053 Test Acc: 0.819
Validation loss decreased (-0.722206 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 0.7731592655181885
Epoch: 5, Steps: 7 | Train Loss: 0.669 Vali Loss: 0.653 Vali Acc: 0.806 Test Loss: 0.653 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8423936367034912
Epoch: 6, Steps: 7 | Train Loss: 0.261 Vali Loss: 0.482 Vali Acc: 0.861 Test Loss: 0.482 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 0.8075246810913086
Epoch: 7, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.992072582244873
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.861106 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7917943000793457
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8212041854858398
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.917 Test Loss: 0.405 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.6755392551422119
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.8810710906982422
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 0.8327293395996094
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.917 Test Loss: 0.356 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 0.6645317077636719
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.8900485038757324
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.8811836242675781
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.6063945293426514
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.6942613124847412
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7107875347137451
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7561542987823486
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7503106594085693
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8051011562347412
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6814956665039062
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6144390106201172
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7986021041870117
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0550363063812256
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.931 Test Loss: 0.335 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 1.1366169452667236
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.9263551235198975
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7685787677764893
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8118753433227539
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9599714279174805
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8166885375976562
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9147496223449707
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9324109554290771
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8884124755859375
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7544291019439697
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8831229209899902
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps171_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 46006284
model size : 190.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps171_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8580858707427979
Epoch: 1, Steps: 7 | Train Loss: 2.638 Vali Loss: 2.487 Vali Acc: 0.083 Test Loss: 2.487 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.636660099029541
Epoch: 2, Steps: 7 | Train Loss: 2.420 Vali Loss: 2.240 Vali Acc: 0.472 Test Loss: 2.240 Test Acc: 0.472
Validation loss decreased (-0.083308 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 0.7108583450317383
Epoch: 3, Steps: 7 | Train Loss: 2.069 Vali Loss: 1.920 Vali Acc: 0.597 Test Loss: 1.920 Test Acc: 0.597
Validation loss decreased (-0.472200 --> -0.597203).  Saving model ...
Epoch: 4 cost time: 0.5935571193695068
Epoch: 4, Steps: 7 | Train Loss: 1.591 Vali Loss: 1.457 Vali Acc: 0.722 Test Loss: 1.457 Test Acc: 0.722
Validation loss decreased (-0.597203 --> -0.722208).  Saving model ...
Epoch: 5 cost time: 0.6962442398071289
Epoch: 5, Steps: 7 | Train Loss: 1.070 Vali Loss: 0.929 Vali Acc: 0.819 Test Loss: 0.929 Test Acc: 0.819
Validation loss decreased (-0.722208 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 0.6364631652832031
Epoch: 6, Steps: 7 | Train Loss: 0.520 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
Validation loss decreased (-0.819435 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 0.5926876068115234
Epoch: 7, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46204042434692383
Epoch: 8, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.685377836227417
Epoch: 9, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.732696533203125
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.799095869064331
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7015221118927002
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6708099842071533
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6191248893737793
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6450364589691162
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6631364822387695
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6062707901000977
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6480298042297363
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6928431987762451
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6748831272125244
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6951520442962646
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.685164213180542
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.7406959533691406
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6486077308654785
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6572339534759521
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5229742527008057
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6729855537414551
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7139458656311035
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.6241395473480225
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6952841281890869
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7344510555267334
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7132489681243896
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6641082763671875
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7902929782867432
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7052226066589355
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6252961158752441
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7226042747497559
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.671065092086792
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps171_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 45877260
model size : 189.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps171_str171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8094546794891357
Epoch: 1, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.536 Vali Acc: 0.139 Test Loss: 2.536 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.5835604667663574
Epoch: 2, Steps: 7 | Train Loss: 2.368 Vali Loss: 2.213 Vali Acc: 0.361 Test Loss: 2.213 Test Acc: 0.361
Validation loss decreased (-0.138864 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.6433389186859131
Epoch: 3, Steps: 7 | Train Loss: 2.052 Vali Loss: 1.857 Vali Acc: 0.611 Test Loss: 1.857 Test Acc: 0.611
Validation loss decreased (-0.361089 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 0.658489465713501
Epoch: 4, Steps: 7 | Train Loss: 1.691 Vali Loss: 1.527 Vali Acc: 0.708 Test Loss: 1.527 Test Acc: 0.708
Validation loss decreased (-0.611093 --> -0.708318).  Saving model ...
Epoch: 5 cost time: 0.6558277606964111
Epoch: 5, Steps: 7 | Train Loss: 1.325 Vali Loss: 1.156 Vali Acc: 0.764 Test Loss: 1.156 Test Acc: 0.764
Validation loss decreased (-0.708318 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.6532425880432129
Epoch: 6, Steps: 7 | Train Loss: 0.856 Vali Loss: 0.813 Vali Acc: 0.792 Test Loss: 0.813 Test Acc: 0.792
Validation loss decreased (-0.763877 --> -0.791659).  Saving model ...
Epoch: 7 cost time: 0.6740288734436035
Epoch: 7, Steps: 7 | Train Loss: 0.440 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.791659 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.6546669006347656
Epoch: 8, Steps: 7 | Train Loss: 0.208 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847218).  Saving model ...
Epoch: 9 cost time: 0.6311643123626709
Epoch: 9, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.6306548118591309
Epoch: 10, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.6158607006072998
Epoch: 11, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.6819283962249756
Epoch: 12, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.59783935546875
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5511863231658936
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5948493480682373
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6374421119689941
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6508963108062744
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5766501426696777
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.5147697925567627
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.5618948936462402
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5683088302612305
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 22 cost time: 0.6077098846435547
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6161432266235352
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5943355560302734
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.541811466217041
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5672347545623779
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5390503406524658
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.61411452293396
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 29 cost time: 0.5510084629058838
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5382275581359863
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 31 cost time: 0.679774284362793
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5905466079711914
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5277490615844727
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.529224157333374
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5557575225830078
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5604674816131592
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5832695960998535
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.875 Test Loss: 0.305 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5723676681518555
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6784467697143555
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6089963912963867
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps171_str171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 45823500
model size : 189.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0116348266601562
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.477 Vali Acc: 0.167 Test Loss: 2.477 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.7968640327453613
Epoch: 2, Steps: 7 | Train Loss: 2.304 Vali Loss: 2.039 Vali Acc: 0.500 Test Loss: 2.039 Test Acc: 0.500
Validation loss decreased (-0.166642 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 0.7238314151763916
Epoch: 3, Steps: 7 | Train Loss: 1.829 Vali Loss: 1.543 Vali Acc: 0.653 Test Loss: 1.543 Test Acc: 0.653
Validation loss decreased (-0.499980 --> -0.652762).  Saving model ...
Epoch: 4 cost time: 0.5490643978118896
Epoch: 4, Steps: 7 | Train Loss: 1.211 Vali Loss: 1.021 Vali Acc: 0.708 Test Loss: 1.021 Test Acc: 0.708
Validation loss decreased (-0.652762 --> -0.708323).  Saving model ...
Epoch: 5 cost time: 0.869509220123291
Epoch: 5, Steps: 7 | Train Loss: 0.611 Vali Loss: 0.625 Vali Acc: 0.847 Test Loss: 0.625 Test Acc: 0.847
Validation loss decreased (-0.708323 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.7550449371337891
Epoch: 6, Steps: 7 | Train Loss: 0.234 Vali Loss: 0.467 Vali Acc: 0.819 Test Loss: 0.467 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7076575756072998
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.5330100059509277
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.9621288776397705
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.7163209915161133
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6772847175598145
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6963622570037842
Epoch: 12, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8541727066040039
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.9331207275390625
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.003220558166504
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.01454758644104
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.9855906963348389
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9456996917724609
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.849017858505249
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7689547538757324
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.0053789615631104
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 0.8998024463653564
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.994687557220459
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 24 cost time: 1.007727861404419
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 25 cost time: 0.9708132743835449
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9323253631591797
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.889 Test Loss: 0.206 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9129867553710938
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.903 Test Loss: 0.206 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7208571434020996
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7530734539031982
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7618505954742432
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7902846336364746
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7461752891540527
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7520699501037598
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7892234325408936
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 46364172
model size : 191.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.470010280609131
Epoch: 1, Steps: 7 | Train Loss: 2.735 Vali Loss: 2.578 Vali Acc: 0.181 Test Loss: 2.578 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 0.5791211128234863
Epoch: 2, Steps: 7 | Train Loss: 2.415 Vali Loss: 2.218 Vali Acc: 0.375 Test Loss: 2.218 Test Acc: 0.375
Validation loss decreased (-0.180530 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.5970454216003418
Epoch: 3, Steps: 7 | Train Loss: 2.041 Vali Loss: 1.883 Vali Acc: 0.653 Test Loss: 1.883 Test Acc: 0.653
Validation loss decreased (-0.374978 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.6042351722717285
Epoch: 4, Steps: 7 | Train Loss: 1.688 Vali Loss: 1.480 Vali Acc: 0.792 Test Loss: 1.480 Test Acc: 0.792
Validation loss decreased (-0.652759 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.5679478645324707
Epoch: 5, Steps: 7 | Train Loss: 1.185 Vali Loss: 1.001 Vali Acc: 0.833 Test Loss: 1.001 Test Acc: 0.833
Validation loss decreased (-0.791652 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.6997964382171631
Epoch: 6, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.6758568286895752
Epoch: 7, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
Validation loss decreased (-0.874993 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.6641366481781006
Epoch: 8, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5903005599975586
Epoch: 9, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6290185451507568
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7536396980285645
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 0.7866325378417969
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.903 Test Loss: 0.182 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8202304840087891
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6771900653839111
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 0.833611249923706
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 0.6719834804534912
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.6791794300079346
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.917 Test Loss: 0.165 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6177971363067627
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.917 Test Loss: 0.160 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6408138275146484
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.917 Test Loss: 0.157 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7075192928314209
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.7232129573822021
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.931 Test Loss: 0.156 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6039981842041016
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.944 Test Loss: 0.145 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.6877377033233643
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 0.638892650604248
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 0.707310676574707
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7360973358154297
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6043479442596436
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.675544023513794
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.944 Test Loss: 0.148 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5690481662750244
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.931 Test Loss: 0.154 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7737360000610352
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.931 Test Loss: 0.152 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6477699279785156
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.931 Test Loss: 0.148 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6754326820373535
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.931 Test Loss: 0.146 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6846110820770264
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.931 Test Loss: 0.146 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.754899263381958
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.931 Test Loss: 0.144 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 46256652
model size : 191.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9941143989562988
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.434 Vali Acc: 0.069 Test Loss: 2.434 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.6623308658599854
Epoch: 2, Steps: 7 | Train Loss: 2.383 Vali Loss: 2.172 Vali Acc: 0.431 Test Loss: 2.172 Test Acc: 0.431
Validation loss decreased (-0.069420 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.5512804985046387
Epoch: 3, Steps: 7 | Train Loss: 2.017 Vali Loss: 1.860 Vali Acc: 0.750 Test Loss: 1.860 Test Acc: 0.750
Validation loss decreased (-0.430534 --> -0.749981).  Saving model ...
Epoch: 4 cost time: 0.5639300346374512
Epoch: 4, Steps: 7 | Train Loss: 1.666 Vali Loss: 1.496 Vali Acc: 0.806 Test Loss: 1.496 Test Acc: 0.806
Validation loss decreased (-0.749981 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.5751614570617676
Epoch: 5, Steps: 7 | Train Loss: 1.217 Vali Loss: 1.053 Vali Acc: 0.833 Test Loss: 1.053 Test Acc: 0.833
Validation loss decreased (-0.805541 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.5168368816375732
Epoch: 6, Steps: 7 | Train Loss: 0.749 Vali Loss: 0.704 Vali Acc: 0.875 Test Loss: 0.704 Test Acc: 0.875
Validation loss decreased (-0.833323 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.5516345500946045
Epoch: 7, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.6111197471618652
Epoch: 8, Steps: 7 | Train Loss: 0.195 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.6501474380493164
Epoch: 9, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.5757920742034912
Epoch: 10, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6025600433349609
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6563882827758789
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.621074914932251
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6135218143463135
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6079502105712891
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6357674598693848
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6135261058807373
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5995442867279053
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6342408657073975
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 46202892
model size : 190.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps240_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.216555118560791
Epoch: 1, Steps: 7 | Train Loss: 2.584 Vali Loss: 2.396 Vali Acc: 0.208 Test Loss: 2.396 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.932471752166748
Epoch: 2, Steps: 7 | Train Loss: 2.298 Vali Loss: 2.003 Vali Acc: 0.639 Test Loss: 2.003 Test Acc: 0.639
Validation loss decreased (-0.208309 --> -0.638869).  Saving model ...
Epoch: 3 cost time: 0.7145645618438721
Epoch: 3, Steps: 7 | Train Loss: 1.839 Vali Loss: 1.454 Vali Acc: 0.708 Test Loss: 1.454 Test Acc: 0.708
Validation loss decreased (-0.638869 --> -0.708319).  Saving model ...
Epoch: 4 cost time: 0.8807826042175293
Epoch: 4, Steps: 7 | Train Loss: 1.234 Vali Loss: 0.881 Vali Acc: 0.792 Test Loss: 0.881 Test Acc: 0.792
Validation loss decreased (-0.708319 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 0.7754132747650146
Epoch: 5, Steps: 7 | Train Loss: 0.595 Vali Loss: 0.533 Vali Acc: 0.847 Test Loss: 0.533 Test Acc: 0.847
Validation loss decreased (-0.791658 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 0.6728286743164062
Epoch: 6, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.6055023670196533
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.5666608810424805
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
Validation loss decreased (-0.916664 --> -0.958331).  Saving model ...
Epoch: 9 cost time: 0.6549499034881592
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 10 cost time: 0.9431664943695068
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.846135139465332
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 0.85282301902771
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0188732147216797
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.042814016342163
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7402682304382324
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9000184535980225
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8404684066772461
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8276183605194092
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.788748025894165
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.931 Test Loss: 0.154 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8092529773712158
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.931 Test Loss: 0.153 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8317773342132568
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.931 Test Loss: 0.151 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps240_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 46874124
model size : 193.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.03311824798584
Epoch: 1, Steps: 7 | Train Loss: 2.612 Vali Loss: 2.523 Vali Acc: 0.069 Test Loss: 2.523 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.6010403633117676
Epoch: 2, Steps: 7 | Train Loss: 2.406 Vali Loss: 2.197 Vali Acc: 0.431 Test Loss: 2.197 Test Acc: 0.431
Validation loss decreased (-0.069419 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.5131983757019043
Epoch: 3, Steps: 7 | Train Loss: 2.012 Vali Loss: 1.809 Vali Acc: 0.681 Test Loss: 1.809 Test Acc: 0.681
Validation loss decreased (-0.430534 --> -0.680537).  Saving model ...
Epoch: 4 cost time: 0.5698494911193848
Epoch: 4, Steps: 7 | Train Loss: 1.502 Vali Loss: 1.192 Vali Acc: 0.847 Test Loss: 1.192 Test Acc: 0.847
Validation loss decreased (-0.680537 --> -0.847210).  Saving model ...
Epoch: 5 cost time: 0.6956789493560791
Epoch: 5, Steps: 7 | Train Loss: 0.908 Vali Loss: 0.795 Vali Acc: 0.847 Test Loss: 0.795 Test Acc: 0.847
Validation loss decreased (-0.847210 --> -0.847214).  Saving model ...
Epoch: 6 cost time: 0.6769928932189941
Epoch: 6, Steps: 7 | Train Loss: 0.472 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 0.5500679016113281
Epoch: 7, Steps: 7 | Train Loss: 0.200 Vali Loss: 0.436 Vali Acc: 0.875 Test Loss: 0.436 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.6940212249755859
Epoch: 8, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5265650749206543
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.6108982563018799
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.889 Test Loss: 0.270 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5976135730743408
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4857628345489502
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6038920879364014
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4618518352508545
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.6676316261291504
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.875 Test Loss: 0.268 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7566616535186768
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.875 Test Loss: 0.265 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6046197414398193
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6666982173919678
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7065370082855225
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6278727054595947
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6833994388580322
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.889 Test Loss: 0.256 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5983860492706299
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.711254358291626
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.591597318649292
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 46788108
model size : 193.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps240_str240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.814206600189209
Epoch: 1, Steps: 7 | Train Loss: 2.611 Vali Loss: 2.510 Vali Acc: 0.125 Test Loss: 2.510 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.5387053489685059
Epoch: 2, Steps: 7 | Train Loss: 2.381 Vali Loss: 2.231 Vali Acc: 0.319 Test Loss: 2.231 Test Acc: 0.319
Validation loss decreased (-0.124975 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 0.5777919292449951
Epoch: 3, Steps: 7 | Train Loss: 2.061 Vali Loss: 1.911 Vali Acc: 0.625 Test Loss: 1.911 Test Acc: 0.625
Validation loss decreased (-0.319422 --> -0.624981).  Saving model ...
Epoch: 4 cost time: 0.6052088737487793
Epoch: 4, Steps: 7 | Train Loss: 1.643 Vali Loss: 1.566 Vali Acc: 0.694 Test Loss: 1.566 Test Acc: 0.694
Validation loss decreased (-0.624981 --> -0.694429).  Saving model ...
Epoch: 5 cost time: 0.7318770885467529
Epoch: 5, Steps: 7 | Train Loss: 1.252 Vali Loss: 1.202 Vali Acc: 0.722 Test Loss: 1.202 Test Acc: 0.722
Validation loss decreased (-0.694429 --> -0.722210).  Saving model ...
Epoch: 6 cost time: 0.676494836807251
Epoch: 6, Steps: 7 | Train Loss: 0.832 Vali Loss: 0.898 Vali Acc: 0.722 Test Loss: 0.898 Test Acc: 0.722
Validation loss decreased (-0.722210 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 0.6825962066650391
Epoch: 7, Steps: 7 | Train Loss: 0.491 Vali Loss: 0.707 Vali Acc: 0.778 Test Loss: 0.707 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777771).  Saving model ...
Epoch: 8 cost time: 0.6544735431671143
Epoch: 8, Steps: 7 | Train Loss: 0.230 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
Validation loss decreased (-0.777771 --> -0.819439).  Saving model ...
Epoch: 9 cost time: 0.6736369132995605
Epoch: 9, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
Validation loss decreased (-0.819439 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.7464854717254639
Epoch: 10, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.537 Vali Acc: 0.847 Test Loss: 0.537 Test Acc: 0.847
Validation loss decreased (-0.833328 --> -0.847217).  Saving model ...
Epoch: 11 cost time: 0.5401632785797119
Epoch: 11, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5163393020629883
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5463354587554932
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.435 Vali Acc: 0.847 Test Loss: 0.435 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 14 cost time: 0.6743431091308594
Epoch: 14, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.428 Vali Acc: 0.847 Test Loss: 0.428 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 15 cost time: 0.6804118156433105
Epoch: 15, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 0.689453125
Epoch: 16, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.429 Vali Acc: 0.847 Test Loss: 0.429 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6791832447052002
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.710991621017456
Epoch: 18, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.484 Vali Acc: 0.819 Test Loss: 0.484 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5756301879882812
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6694576740264893
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5964980125427246
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6379575729370117
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6420130729675293
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6498303413391113
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6164586544036865
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el6_dm768_df768_ps240_str240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 46745100
model size : 193.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6345107555389404
Epoch: 1, Steps: 7 | Train Loss: 2.631 Vali Loss: 2.346 Vali Acc: 0.292 Test Loss: 2.346 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 1.2846760749816895
Epoch: 2, Steps: 7 | Train Loss: 2.180 Vali Loss: 1.690 Vali Acc: 0.653 Test Loss: 1.690 Test Acc: 0.653
Validation loss decreased (-0.291643 --> -0.652761).  Saving model ...
Epoch: 3 cost time: 1.2492904663085938
Epoch: 3, Steps: 7 | Train Loss: 1.319 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
Validation loss decreased (-0.652761 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 1.184615135192871
Epoch: 4, Steps: 7 | Train Loss: 0.494 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847217).  Saving model ...
Epoch: 5 cost time: 1.3088462352752686
Epoch: 5, Steps: 7 | Train Loss: 0.265 Vali Loss: 0.549 Vali Acc: 0.847 Test Loss: 0.549 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.124729871749878
Epoch: 6, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.06264066696167
Epoch: 7, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.1263272762298584
Epoch: 8, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.0801773071289062
Epoch: 9, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2203304767608643
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.903 Test Loss: 0.445 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1827540397644043
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.903 Test Loss: 0.441 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2468156814575195
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.944 Test Loss: 0.329 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 1.1781766414642334
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.163827657699585
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.931 Test Loss: 0.420 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.249690055847168
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.917 Test Loss: 0.451 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2832467555999756
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.917 Test Loss: 0.468 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0411834716796875
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.917 Test Loss: 0.475 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.161111831665039
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.917 Test Loss: 0.473 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2858128547668457
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.917 Test Loss: 0.470 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2597880363464355
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.917 Test Loss: 0.459 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.253551959991455
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2651324272155762
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.917 Test Loss: 0.441 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37992204
model size : 159.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.242007255554199
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.404 Vali Acc: 0.250 Test Loss: 2.404 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 0.7580127716064453
Epoch: 2, Steps: 7 | Train Loss: 2.336 Vali Loss: 2.104 Vali Acc: 0.472 Test Loss: 2.104 Test Acc: 0.472
Validation loss decreased (-0.249976 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 0.7803077697753906
Epoch: 3, Steps: 7 | Train Loss: 1.733 Vali Loss: 1.376 Vali Acc: 0.833 Test Loss: 1.376 Test Acc: 0.833
Validation loss decreased (-0.472201 --> -0.833320).  Saving model ...
Epoch: 4 cost time: 0.8559610843658447
Epoch: 4, Steps: 7 | Train Loss: 1.056 Vali Loss: 0.722 Vali Acc: 0.861 Test Loss: 0.722 Test Acc: 0.861
Validation loss decreased (-0.833320 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 0.8955113887786865
Epoch: 5, Steps: 7 | Train Loss: 0.418 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.8739235401153564
Epoch: 6, Steps: 7 | Train Loss: 0.199 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.0488018989562988
Epoch: 7, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.7723479270935059
Epoch: 8, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.874996 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.7353677749633789
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8927674293518066
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8992245197296143
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9395453929901123
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8730738162994385
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6759800910949707
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6484560966491699
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.7150299549102783
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 1.0243556499481201
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8543746471405029
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.9254488945007324
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 0.9506864547729492
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 0.9907803535461426
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 0.9212784767150879
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 0.9439201354980469
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.983351469039917
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.8673505783081055
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.9587152004241943
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.9653923511505127
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8657481670379639
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.8403494358062744
Epoch: 29, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8404357433319092
Epoch: 30, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.675330400466919
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7325255870819092
Epoch: 32, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.931 Test Loss: 0.380 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7755827903747559
Epoch: 33, Steps: 7 | Train Loss: 0.069 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0075976848602295
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.931 Test Loss: 0.351 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9288756847381592
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7888212203979492
Epoch: 36, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8223860263824463
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0592842102050781
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37476108
model size : 157.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.288404941558838
Epoch: 1, Steps: 7 | Train Loss: 2.612 Vali Loss: 2.514 Vali Acc: 0.111 Test Loss: 2.514 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6842629909515381
Epoch: 2, Steps: 7 | Train Loss: 2.368 Vali Loss: 2.213 Vali Acc: 0.306 Test Loss: 2.213 Test Acc: 0.306
Validation loss decreased (-0.111086 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 0.8106801509857178
Epoch: 3, Steps: 7 | Train Loss: 2.021 Vali Loss: 1.806 Vali Acc: 0.611 Test Loss: 1.806 Test Acc: 0.611
Validation loss decreased (-0.305533 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 0.9279460906982422
Epoch: 4, Steps: 7 | Train Loss: 1.540 Vali Loss: 1.264 Vali Acc: 0.819 Test Loss: 1.264 Test Acc: 0.819
Validation loss decreased (-0.611093 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 0.7984447479248047
Epoch: 5, Steps: 7 | Train Loss: 1.020 Vali Loss: 0.760 Vali Acc: 0.806 Test Loss: 0.760 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6346564292907715
Epoch: 6, Steps: 7 | Train Loss: 0.487 Vali Loss: 0.486 Vali Acc: 0.847 Test Loss: 0.486 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 0.8726027011871338
Epoch: 7, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.9228992462158203
Epoch: 8, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.7458078861236572
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.874996 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.7105023860931396
Epoch: 10, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.6595523357391357
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7982921600341797
Epoch: 12, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8698379993438721
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.741727352142334
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8964853286743164
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8346681594848633
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9194481372833252
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.930321455001831
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8346912860870361
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.800865650177002
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37218060
model size : 156.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.231537342071533
Epoch: 1, Steps: 7 | Train Loss: 2.561 Vali Loss: 2.367 Vali Acc: 0.139 Test Loss: 2.367 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.942486047744751
Epoch: 2, Steps: 7 | Train Loss: 2.229 Vali Loss: 1.824 Vali Acc: 0.472 Test Loss: 1.824 Test Acc: 0.472
Validation loss decreased (-0.138865 --> -0.472204).  Saving model ...
Epoch: 3 cost time: 1.0177292823791504
Epoch: 3, Steps: 7 | Train Loss: 1.490 Vali Loss: 1.171 Vali Acc: 0.792 Test Loss: 1.171 Test Acc: 0.792
Validation loss decreased (-0.472204 --> -0.791655).  Saving model ...
Epoch: 4 cost time: 0.9771404266357422
Epoch: 4, Steps: 7 | Train Loss: 0.724 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.791655 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.1148698329925537
Epoch: 5, Steps: 7 | Train Loss: 0.212 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.1629176139831543
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.018850564956665
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.557 Vali Acc: 0.903 Test Loss: 0.557 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902772).  Saving model ...
Epoch: 8 cost time: 0.9992241859436035
Epoch: 8, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.661 Vali Acc: 0.889 Test Loss: 0.661 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0518560409545898
Epoch: 9, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.475 Vali Acc: 0.917 Test Loss: 0.475 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916662).  Saving model ...
Epoch: 10 cost time: 1.0921719074249268
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.452 Vali Acc: 0.903 Test Loss: 0.452 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0694646835327148
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2309787273406982
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.077315092086792
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1981966495513916
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.917 Test Loss: 0.433 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 15 cost time: 0.9532990455627441
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.917 Test Loss: 0.433 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 16 cost time: 1.2923338413238525
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.917 Test Loss: 0.437 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1289758682250977
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.903 Test Loss: 0.437 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2483794689178467
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.903 Test Loss: 0.441 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1467313766479492
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3025693893432617
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1215715408325195
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.903 Test Loss: 0.449 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0000202655792236
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1031136512756348
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.078397512435913
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1133532524108887
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37944588
model size : 159.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9355432987213135
Epoch: 1, Steps: 7 | Train Loss: 2.682 Vali Loss: 2.456 Vali Acc: 0.111 Test Loss: 2.456 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.8984165191650391
Epoch: 2, Steps: 7 | Train Loss: 2.342 Vali Loss: 2.086 Vali Acc: 0.333 Test Loss: 2.086 Test Acc: 0.333
Validation loss decreased (-0.111087 --> -0.333312).  Saving model ...
Epoch: 3 cost time: 0.7528510093688965
Epoch: 3, Steps: 7 | Train Loss: 1.970 Vali Loss: 1.591 Vali Acc: 0.708 Test Loss: 1.591 Test Acc: 0.708
Validation loss decreased (-0.333312 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 0.7020163536071777
Epoch: 4, Steps: 7 | Train Loss: 1.287 Vali Loss: 1.058 Vali Acc: 0.833 Test Loss: 1.058 Test Acc: 0.833
Validation loss decreased (-0.708317 --> -0.833323).  Saving model ...
Epoch: 5 cost time: 0.6832702159881592
Epoch: 5, Steps: 7 | Train Loss: 0.630 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.8915913105010986
Epoch: 6, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.80415940284729
Epoch: 7, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.6794824600219727
Epoch: 8, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.510 Vali Acc: 0.889 Test Loss: 0.510 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8235156536102295
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.546 Vali Acc: 0.903 Test Loss: 0.546 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902772).  Saving model ...
Epoch: 10 cost time: 0.8473174571990967
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.903 Test Loss: 0.577 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8349699974060059
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.917 Test Loss: 0.635 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916660).  Saving model ...
Epoch: 12 cost time: 0.7937898635864258
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.580 Vali Acc: 0.917 Test Loss: 0.580 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916661).  Saving model ...
Epoch: 13 cost time: 0.9646511077880859
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.917 Test Loss: 0.552 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916661).  Saving model ...
Epoch: 14 cost time: 0.7736179828643799
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.917 Test Loss: 0.560 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9162652492523193
Epoch: 15, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.516 Vali Acc: 0.917 Test Loss: 0.516 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916662).  Saving model ...
Epoch: 16 cost time: 0.7759487628936768
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916662).  Saving model ...
Epoch: 17 cost time: 0.9749832153320312
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.903 Test Loss: 0.482 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9131972789764404
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.889 Test Loss: 0.449 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7605948448181152
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.889 Test Loss: 0.437 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8030197620391846
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6240212917327881
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7717657089233398
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6042520999908447
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7816810607910156
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.903 Test Loss: 0.434 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7122716903686523
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.903 Test Loss: 0.429 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7540602684020996
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.903 Test Loss: 0.428 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37482252
model size : 157.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9692323207855225
Epoch: 1, Steps: 7 | Train Loss: 2.613 Vali Loss: 2.496 Vali Acc: 0.069 Test Loss: 2.496 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.662757396697998
Epoch: 2, Steps: 7 | Train Loss: 2.421 Vali Loss: 2.279 Vali Acc: 0.250 Test Loss: 2.279 Test Acc: 0.250
Validation loss decreased (-0.069419 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 0.6565694808959961
Epoch: 3, Steps: 7 | Train Loss: 2.111 Vali Loss: 1.952 Vali Acc: 0.556 Test Loss: 1.952 Test Acc: 0.556
Validation loss decreased (-0.249977 --> -0.555536).  Saving model ...
Epoch: 4 cost time: 0.7688050270080566
Epoch: 4, Steps: 7 | Train Loss: 1.653 Vali Loss: 1.429 Vali Acc: 0.792 Test Loss: 1.429 Test Acc: 0.792
Validation loss decreased (-0.555536 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.6976726055145264
Epoch: 5, Steps: 7 | Train Loss: 1.110 Vali Loss: 0.875 Vali Acc: 0.847 Test Loss: 0.875 Test Acc: 0.847
Validation loss decreased (-0.791652 --> -0.847213).  Saving model ...
Epoch: 6 cost time: 0.744903564453125
Epoch: 6, Steps: 7 | Train Loss: 0.625 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7413234710693359
Epoch: 7, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.435 Vali Acc: 0.889 Test Loss: 0.435 Test Acc: 0.889
Validation loss decreased (-0.847213 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.7410497665405273
Epoch: 8, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7874219417572021
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.6413202285766602
Epoch: 10, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7510950565338135
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7097041606903076
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.763075590133667
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7442786693572998
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5781948566436768
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.697075366973877
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7769241333007812
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7750535011291504
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8024673461914062
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 37234956
model size : 156.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9679381847381592
Epoch: 1, Steps: 7 | Train Loss: 2.679 Vali Loss: 2.422 Vali Acc: 0.139 Test Loss: 2.422 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.8376286029815674
Epoch: 2, Steps: 7 | Train Loss: 2.343 Vali Loss: 2.028 Vali Acc: 0.569 Test Loss: 2.028 Test Acc: 0.569
Validation loss decreased (-0.138865 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 0.9009616374969482
Epoch: 3, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.349 Vali Acc: 0.611 Test Loss: 1.349 Test Acc: 0.611
Validation loss decreased (-0.569424 --> -0.611098).  Saving model ...
Epoch: 4 cost time: 1.0311927795410156
Epoch: 4, Steps: 7 | Train Loss: 0.890 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.611098 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.803699254989624
Epoch: 5, Steps: 7 | Train Loss: 0.294 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.9823219776153564
Epoch: 6, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.9804651737213135
Epoch: 7, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9870936870574951
Epoch: 8, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9907217025756836
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2005105018615723
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0389070510864258
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.903 Test Loss: 0.453 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 1.081350326538086
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.903 Test Loss: 0.447 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.8230915069580078
Epoch: 13, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.8413817882537842
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 1.1692771911621094
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9734444618225098
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.903 Test Loss: 0.410 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8899643421173096
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.902907133102417
Epoch: 18, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0446491241455078
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.406 Vali Acc: 0.875 Test Loss: 0.406 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0363759994506836
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9636204242706299
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.917 Test Loss: 0.529 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1990551948547363
Epoch: 22, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.338 Vali Acc: 0.931 Test Loss: 0.338 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 23 cost time: 0.9773726463317871
Epoch: 23, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.931 Test Loss: 0.568 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9243354797363281
Epoch: 24, Steps: 7 | Train Loss: 0.184 Vali Loss: 1.102 Vali Acc: 0.889 Test Loss: 1.102 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8525857925415039
Epoch: 25, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 1.0476715564727783
Epoch: 26, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.489 Vali Acc: 0.903 Test Loss: 0.489 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9294350147247314
Epoch: 27, Steps: 7 | Train Loss: 0.006 Vali Loss: 1.051 Vali Acc: 0.819 Test Loss: 1.051 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9301517009735107
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.875 Test Loss: 0.927 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.154006004333496
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.889 Test Loss: 0.832 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0289511680603027
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.889 Test Loss: 0.845 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.162956953048706
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 1.111 Vali Acc: 0.847 Test Loss: 1.111 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1281821727752686
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.833 Test Loss: 1.146 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1079373359680176
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.917 Test Loss: 0.628 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1274261474609375
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.917 Test Loss: 0.624 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9411616325378418
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.889 Test Loss: 0.652 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37910796
model size : 159.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.351738214492798
Epoch: 1, Steps: 7 | Train Loss: 2.630 Vali Loss: 2.392 Vali Acc: 0.153 Test Loss: 2.392 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.9085898399353027
Epoch: 2, Steps: 7 | Train Loss: 2.306 Vali Loss: 2.110 Vali Acc: 0.417 Test Loss: 2.110 Test Acc: 0.417
Validation loss decreased (-0.152754 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 0.8493125438690186
Epoch: 3, Steps: 7 | Train Loss: 1.913 Vali Loss: 1.585 Vali Acc: 0.736 Test Loss: 1.585 Test Acc: 0.736
Validation loss decreased (-0.416646 --> -0.736095).  Saving model ...
Epoch: 4 cost time: 1.0741033554077148
Epoch: 4, Steps: 7 | Train Loss: 1.283 Vali Loss: 0.972 Vali Acc: 0.861 Test Loss: 0.972 Test Acc: 0.861
Validation loss decreased (-0.736095 --> -0.861101).  Saving model ...
Epoch: 5 cost time: 0.7981264591217041
Epoch: 5, Steps: 7 | Train Loss: 0.624 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
Validation loss decreased (-0.861101 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.7639913558959961
Epoch: 6, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888886).  Saving model ...
Epoch: 7 cost time: 0.8558511734008789
Epoch: 7, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8618597984313965
Epoch: 8, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6757352352142334
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.9140336513519287
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8732061386108398
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1329176425933838
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.931 Test Loss: 0.124 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 0.8127546310424805
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.931 Test Loss: 0.119 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 0.7455923557281494
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.903 Test Loss: 0.144 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8886969089508057
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.931 Test Loss: 0.148 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8745200634002686
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6539285182952881
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.903 Test Loss: 0.190 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7957761287689209
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.903 Test Loss: 0.204 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6724486351013184
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5943193435668945
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9565274715423584
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9336552619934082
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7602062225341797
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37491468
model size : 157.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2108607292175293
Epoch: 1, Steps: 7 | Train Loss: 2.675 Vali Loss: 2.556 Vali Acc: 0.069 Test Loss: 2.556 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.5750153064727783
Epoch: 2, Steps: 7 | Train Loss: 2.442 Vali Loss: 2.249 Vali Acc: 0.278 Test Loss: 2.249 Test Acc: 0.278
Validation loss decreased (-0.069419 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.5766000747680664
Epoch: 3, Steps: 7 | Train Loss: 2.110 Vali Loss: 1.943 Vali Acc: 0.569 Test Loss: 1.943 Test Acc: 0.569
Validation loss decreased (-0.277755 --> -0.569425).  Saving model ...
Epoch: 4 cost time: 0.7870032787322998
Epoch: 4, Steps: 7 | Train Loss: 1.730 Vali Loss: 1.575 Vali Acc: 0.736 Test Loss: 1.575 Test Acc: 0.736
Validation loss decreased (-0.569425 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 0.6969192028045654
Epoch: 5, Steps: 7 | Train Loss: 1.230 Vali Loss: 1.060 Vali Acc: 0.833 Test Loss: 1.060 Test Acc: 0.833
Validation loss decreased (-0.736095 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.6776726245880127
Epoch: 6, Steps: 7 | Train Loss: 0.731 Vali Loss: 0.565 Vali Acc: 0.861 Test Loss: 0.565 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 0.5099103450775146
Epoch: 7, Steps: 7 | Train Loss: 0.351 Vali Loss: 0.455 Vali Acc: 0.861 Test Loss: 0.455 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.7620296478271484
Epoch: 8, Steps: 7 | Train Loss: 0.146 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.693889856338501
Epoch: 9, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.5727078914642334
Epoch: 10, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6708569526672363
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.712538480758667
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.574622392654419
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6453475952148438
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5832862854003906
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7735574245452881
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7409131526947021
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5723104476928711
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6726639270782471
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7544717788696289
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 37265676
model size : 156.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1439030170440674
Epoch: 1, Steps: 7 | Train Loss: 2.703 Vali Loss: 2.417 Vali Acc: 0.181 Test Loss: 2.417 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.9077723026275635
Epoch: 2, Steps: 7 | Train Loss: 2.406 Vali Loss: 1.952 Vali Acc: 0.472 Test Loss: 1.952 Test Acc: 0.472
Validation loss decreased (-0.180531 --> -0.472203).  Saving model ...
Epoch: 3 cost time: 1.1343624591827393
Epoch: 3, Steps: 7 | Train Loss: 1.639 Vali Loss: 1.329 Vali Acc: 0.681 Test Loss: 1.329 Test Acc: 0.681
Validation loss decreased (-0.472203 --> -0.680542).  Saving model ...
Epoch: 4 cost time: 1.0553154945373535
Epoch: 4, Steps: 7 | Train Loss: 0.871 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
Validation loss decreased (-0.680542 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 0.8605575561523438
Epoch: 5, Steps: 7 | Train Loss: 0.250 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.8727805614471436
Epoch: 6, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9270682334899902
Epoch: 7, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.729 Vali Acc: 0.861 Test Loss: 0.729 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8145487308502197
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.734 Vali Acc: 0.875 Test Loss: 0.734 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8778331279754639
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.875 Test Loss: 0.808 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9829585552215576
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.875 Test Loss: 0.857 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7801558971405029
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.875 Test Loss: 0.866 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7977509498596191
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.875 Test Loss: 0.786 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.668848991394043
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.889 Test Loss: 0.765 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 0.8918335437774658
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.889 Test Loss: 0.761 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 15 cost time: 0.9636631011962891
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.889 Test Loss: 0.763 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9483823776245117
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.889 Test Loss: 0.766 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.003063440322876
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.889 Test Loss: 0.767 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8321537971496582
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.889 Test Loss: 0.767 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.820958137512207
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.889 Test Loss: 0.766 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8323643207550049
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.889 Test Loss: 0.764 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8462924957275391
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.889 Test Loss: 0.761 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 22 cost time: 1.154820203781128
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.889 Test Loss: 0.759 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 23 cost time: 1.0554835796356201
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.889 Test Loss: 0.757 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 24 cost time: 0.928713321685791
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.889 Test Loss: 0.755 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 25 cost time: 1.0226292610168457
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.889 Test Loss: 0.751 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 26 cost time: 0.9778931140899658
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.889 Test Loss: 0.749 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 27 cost time: 0.9785599708557129
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 28 cost time: 0.9731225967407227
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1127371788024902
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.889 Test Loss: 0.747 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 30 cost time: 0.940558910369873
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.889 Test Loss: 0.746 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 31 cost time: 0.8918941020965576
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.889 Test Loss: 0.744 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 32 cost time: 0.8766946792602539
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.889 Test Loss: 0.744 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 33 cost time: 0.9282808303833008
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.889 Test Loss: 0.744 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 34 cost time: 1.0271291732788086
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.889 Test Loss: 0.743 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 35 cost time: 0.9224750995635986
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.889 Test Loss: 0.742 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 36 cost time: 1.1223220825195312
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.889 Test Loss: 0.741 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 37 cost time: 1.010462999343872
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.889 Test Loss: 0.741 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 38 cost time: 0.9829146862030029
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.889 Test Loss: 0.741 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9594266414642334
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.889 Test Loss: 0.741 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9174807071685791
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.889 Test Loss: 0.741 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 41 cost time: 1.0642213821411133
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.889 Test Loss: 0.740 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 42 cost time: 0.913170337677002
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.889 Test Loss: 0.738 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 43 cost time: 1.108752965927124
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.889 Test Loss: 0.736 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 44 cost time: 1.143909215927124
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.889 Test Loss: 0.735 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 45 cost time: 0.9280390739440918
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.889 Test Loss: 0.732 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 46 cost time: 1.1236374378204346
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.889 Test Loss: 0.730 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 47 cost time: 0.9887256622314453
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.889 Test Loss: 0.728 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 48 cost time: 0.968313455581665
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 49 cost time: 1.0322809219360352
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.889 Test Loss: 0.728 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0138754844665527
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.889 Test Loss: 0.728 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 37938444
model size : 159.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.345705270767212
Epoch: 1, Steps: 7 | Train Loss: 2.637 Vali Loss: 2.476 Vali Acc: 0.125 Test Loss: 2.476 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.8302676677703857
Epoch: 2, Steps: 7 | Train Loss: 2.359 Vali Loss: 2.141 Vali Acc: 0.403 Test Loss: 2.141 Test Acc: 0.403
Validation loss decreased (-0.124975 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.7081592082977295
Epoch: 3, Steps: 7 | Train Loss: 1.924 Vali Loss: 1.605 Vali Acc: 0.750 Test Loss: 1.605 Test Acc: 0.750
Validation loss decreased (-0.402756 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 0.9743776321411133
Epoch: 4, Steps: 7 | Train Loss: 1.314 Vali Loss: 1.009 Vali Acc: 0.833 Test Loss: 1.009 Test Acc: 0.833
Validation loss decreased (-0.749984 --> -0.833323).  Saving model ...
Epoch: 5 cost time: 1.0649926662445068
Epoch: 5, Steps: 7 | Train Loss: 0.597 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.7685914039611816
Epoch: 6, Steps: 7 | Train Loss: 0.192 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.8579671382904053
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.376 Vali Acc: 0.917 Test Loss: 0.376 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.9197802543640137
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.399 Vali Acc: 0.917 Test Loss: 0.399 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9163200855255127
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.00431489944458
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0115177631378174
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.9977412223815918
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7656042575836182
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.8453209400177002
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9413633346557617
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8620569705963135
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0472118854522705
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9375612735748291
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9624853134155273
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9658544063568115
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9086716175079346
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.850339412689209
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9295055866241455
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8147449493408203
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37497612
model size : 157.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3392422199249268
Epoch: 1, Steps: 7 | Train Loss: 2.691 Vali Loss: 2.483 Vali Acc: 0.139 Test Loss: 2.483 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.5970447063446045
Epoch: 2, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.257 Vali Acc: 0.417 Test Loss: 2.257 Test Acc: 0.417
Validation loss decreased (-0.138864 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 0.8496313095092773
Epoch: 3, Steps: 7 | Train Loss: 2.144 Vali Loss: 1.983 Vali Acc: 0.486 Test Loss: 1.983 Test Acc: 0.486
Validation loss decreased (-0.416644 --> -0.486091).  Saving model ...
Epoch: 4 cost time: 0.595970869064331
Epoch: 4, Steps: 7 | Train Loss: 1.735 Vali Loss: 1.547 Vali Acc: 0.806 Test Loss: 1.547 Test Acc: 0.806
Validation loss decreased (-0.486091 --> -0.805540).  Saving model ...
Epoch: 5 cost time: 0.8935766220092773
Epoch: 5, Steps: 7 | Train Loss: 1.225 Vali Loss: 1.060 Vali Acc: 0.875 Test Loss: 1.060 Test Acc: 0.875
Validation loss decreased (-0.805540 --> -0.874989).  Saving model ...
Epoch: 6 cost time: 0.8179731369018555
Epoch: 6, Steps: 7 | Train Loss: 0.697 Vali Loss: 0.573 Vali Acc: 0.917 Test Loss: 0.573 Test Acc: 0.917
Validation loss decreased (-0.874989 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 0.716217041015625
Epoch: 7, Steps: 7 | Train Loss: 0.284 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.863680362701416
Epoch: 8, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5969510078430176
Epoch: 9, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7583932876586914
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8885014057159424
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8262920379638672
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6015884876251221
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7237939834594727
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.373 Vali Acc: 0.847 Test Loss: 0.373 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8676974773406982
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.847 Test Loss: 0.378 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7872140407562256
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37282572
model size : 156.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps57_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.667739152908325
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.404 Vali Acc: 0.139 Test Loss: 2.404 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.0790297985076904
Epoch: 2, Steps: 7 | Train Loss: 2.306 Vali Loss: 1.971 Vali Acc: 0.542 Test Loss: 1.971 Test Acc: 0.542
Validation loss decreased (-0.138865 --> -0.541647).  Saving model ...
Epoch: 3 cost time: 1.081045150756836
Epoch: 3, Steps: 7 | Train Loss: 1.623 Vali Loss: 1.260 Vali Acc: 0.819 Test Loss: 1.260 Test Acc: 0.819
Validation loss decreased (-0.541647 --> -0.819432).  Saving model ...
Epoch: 4 cost time: 1.1279032230377197
Epoch: 4, Steps: 7 | Train Loss: 0.827 Vali Loss: 0.540 Vali Acc: 0.861 Test Loss: 0.540 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 1.0849902629852295
Epoch: 5, Steps: 7 | Train Loss: 0.278 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.0450780391693115
Epoch: 6, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2096869945526123
Epoch: 7, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.401 Vali Acc: 0.903 Test Loss: 0.401 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.0703821182250977
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2065868377685547
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.875 Test Loss: 0.395 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1450457572937012
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 1.21644926071167
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.917 Test Loss: 0.383 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.0343682765960693
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.109104871749878
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 1.0847845077514648
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.9988653659820557
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 1.1782965660095215
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 0.9666073322296143
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.9386398792266846
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0883183479309082
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 1.0546798706054688
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 21 cost time: 1.2464478015899658
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 22 cost time: 1.004178762435913
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 23 cost time: 1.0072271823883057
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 24 cost time: 1.087390422821045
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.917 Test Loss: 0.322 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 1.1045198440551758
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 1.0595903396606445
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9863917827606201
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 28 cost time: 1.0303919315338135
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 29 cost time: 1.0894155502319336
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7312130928039551
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 31 cost time: 1.094426155090332
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.6895794868469238
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.8409132957458496
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0519490242004395
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1592557430267334
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2707996368408203
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0125367641448975
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2224655151367188
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 39 cost time: 0.9053764343261719
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9018309116363525
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.910454273223877
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0409789085388184
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9952285289764404
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8901770114898682
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9769675731658936
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8622245788574219
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7748723030090332
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0586214065551758
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps57_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37912332
model size : 159.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps57_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3545985221862793
Epoch: 1, Steps: 7 | Train Loss: 2.637 Vali Loss: 2.487 Vali Acc: 0.111 Test Loss: 2.487 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.8185238838195801
Epoch: 2, Steps: 7 | Train Loss: 2.349 Vali Loss: 2.122 Vali Acc: 0.444 Test Loss: 2.122 Test Acc: 0.444
Validation loss decreased (-0.111086 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.8823037147521973
Epoch: 3, Steps: 7 | Train Loss: 1.917 Vali Loss: 1.621 Vali Acc: 0.639 Test Loss: 1.621 Test Acc: 0.639
Validation loss decreased (-0.444423 --> -0.638873).  Saving model ...
Epoch: 4 cost time: 1.0078155994415283
Epoch: 4, Steps: 7 | Train Loss: 1.286 Vali Loss: 1.022 Vali Acc: 0.792 Test Loss: 1.022 Test Acc: 0.792
Validation loss decreased (-0.638873 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 0.8602907657623291
Epoch: 5, Steps: 7 | Train Loss: 0.644 Vali Loss: 0.533 Vali Acc: 0.861 Test Loss: 0.533 Test Acc: 0.861
Validation loss decreased (-0.791656 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.8538827896118164
Epoch: 6, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.9909834861755371
Epoch: 7, Steps: 7 | Train Loss: 0.085 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.792461633682251
Epoch: 8, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.6999273300170898
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 0.6708133220672607
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.944 Test Loss: 0.125 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.6659173965454102
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6389048099517822
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.709470272064209
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6447820663452148
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6796162128448486
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8196356296539307
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.782926082611084
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.931 Test Loss: 0.149 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6648988723754883
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.944 Test Loss: 0.144 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8420982360839844
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 0.5395541191101074
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.944 Test Loss: 0.140 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5040385723114014
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.944 Test Loss: 0.138 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5163466930389404
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.944 Test Loss: 0.141 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5165174007415771
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5607755184173584
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5974276065826416
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7520151138305664
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 0.8933022022247314
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 0.5982255935668945
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7744956016540527
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8518345355987549
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8722579479217529
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.944 Test Loss: 0.146 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9331731796264648
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8425736427307129
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8786401748657227
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.9196274280548096
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 36 cost time: 0.9522664546966553
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9426829814910889
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7598772048950195
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7825965881347656
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.86421799659729
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7556402683258057
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8230319023132324
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.791006326675415
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.85843825340271
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7877190113067627
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps57_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 37514508
model size : 157.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps57_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.223590135574341
Epoch: 1, Steps: 7 | Train Loss: 2.670 Vali Loss: 2.548 Vali Acc: 0.056 Test Loss: 2.548 Test Acc: 0.056
Validation loss decreased (inf --> -0.055530).  Saving model ...
Epoch: 2 cost time: 0.5919809341430664
Epoch: 2, Steps: 7 | Train Loss: 2.447 Vali Loss: 2.234 Vali Acc: 0.333 Test Loss: 2.234 Test Acc: 0.333
Validation loss decreased (-0.055530 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.8147242069244385
Epoch: 3, Steps: 7 | Train Loss: 2.104 Vali Loss: 1.893 Vali Acc: 0.458 Test Loss: 1.893 Test Acc: 0.458
Validation loss decreased (-0.333311 --> -0.458314).  Saving model ...
Epoch: 4 cost time: 0.5962295532226562
Epoch: 4, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.461 Vali Acc: 0.722 Test Loss: 1.461 Test Acc: 0.722
Validation loss decreased (-0.458314 --> -0.722208).  Saving model ...
Epoch: 5 cost time: 0.6776232719421387
Epoch: 5, Steps: 7 | Train Loss: 1.218 Vali Loss: 0.892 Vali Acc: 0.806 Test Loss: 0.892 Test Acc: 0.806
Validation loss decreased (-0.722208 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 0.618621826171875
Epoch: 6, Steps: 7 | Train Loss: 0.699 Vali Loss: 0.518 Vali Acc: 0.917 Test Loss: 0.518 Test Acc: 0.917
Validation loss decreased (-0.805547 --> -0.916661).  Saving model ...
Epoch: 7 cost time: 0.6206262111663818
Epoch: 7, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
Validation loss decreased (-0.916661 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.5960879325866699
Epoch: 8, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.5941259860992432
Epoch: 9, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6220321655273438
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5502543449401855
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 0.5986912250518799
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 0.7394883632659912
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
Validation loss decreased (-0.916665 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 0.8750748634338379
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 15 cost time: 0.8568696975708008
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8474464416503906
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5720479488372803
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.917 Test Loss: 0.157 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5272247791290283
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.917 Test Loss: 0.161 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5660300254821777
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.917 Test Loss: 0.160 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6420609951019287
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.917 Test Loss: 0.157 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5158724784851074
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.917 Test Loss: 0.154 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4964287281036377
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.917 Test Loss: 0.156 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5956053733825684
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.917 Test Loss: 0.157 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5185046195983887
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.931 Test Loss: 0.155 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps57_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 37310220
model size : 157.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5673179626464844
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.340 Vali Acc: 0.319 Test Loss: 2.340 Test Acc: 0.319
Validation loss decreased (inf --> -0.319421).  Saving model ...
Epoch: 2 cost time: 0.9806208610534668
Epoch: 2, Steps: 7 | Train Loss: 2.190 Vali Loss: 1.848 Vali Acc: 0.556 Test Loss: 1.848 Test Acc: 0.556
Validation loss decreased (-0.319421 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 1.0210647583007812
Epoch: 3, Steps: 7 | Train Loss: 1.567 Vali Loss: 1.217 Vali Acc: 0.722 Test Loss: 1.217 Test Acc: 0.722
Validation loss decreased (-0.555537 --> -0.722210).  Saving model ...
Epoch: 4 cost time: 0.8024041652679443
Epoch: 4, Steps: 7 | Train Loss: 0.857 Vali Loss: 0.538 Vali Acc: 0.903 Test Loss: 0.538 Test Acc: 0.903
Validation loss decreased (-0.722210 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 1.0000104904174805
Epoch: 5, Steps: 7 | Train Loss: 0.239 Vali Loss: 0.376 Vali Acc: 0.903 Test Loss: 0.376 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.8681180477142334
Epoch: 6, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 0.68247389793396
Epoch: 7, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.443 Vali Acc: 0.903 Test Loss: 0.443 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8697755336761475
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8248195648193359
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6200137138366699
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8993632793426514
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.8781020641326904
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.0185363292694092
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7224879264831543
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6814882755279541
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6733348369598389
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6415183544158936
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6698670387268066
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8752977848052979
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8014769554138184
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.9567179679870605
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.9762427806854248
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8745443820953369
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.804685115814209
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 1.0179409980773926
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.9481894969940186
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.977442741394043
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 1.0140306949615479
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0706100463867188
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9394314289093018
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.877068281173706
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.957003116607666
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9690148830413818
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 34 cost time: 1.0447478294372559
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 35 cost time: 1.0248355865478516
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 36 cost time: 0.8581621646881104
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 1.0251884460449219
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.969597578048706
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.9519927501678467
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 40 cost time: 1.1566798686981201
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.1757991313934326
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.210230827331543
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1320757865905762
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.197847843170166
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1158967018127441
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.380253553390503
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.520658016204834
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4492321014404297
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5246024131774902
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4130303859710693
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37943052
model size : 159.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2171590328216553
Epoch: 1, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.416 Vali Acc: 0.194 Test Loss: 2.416 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 1.064680576324463
Epoch: 2, Steps: 7 | Train Loss: 2.312 Vali Loss: 2.113 Vali Acc: 0.486 Test Loss: 2.113 Test Acc: 0.486
Validation loss decreased (-0.194420 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 1.154256820678711
Epoch: 3, Steps: 7 | Train Loss: 1.919 Vali Loss: 1.617 Vali Acc: 0.778 Test Loss: 1.617 Test Acc: 0.778
Validation loss decreased (-0.486090 --> -0.777762).  Saving model ...
Epoch: 4 cost time: 0.5393557548522949
Epoch: 4, Steps: 7 | Train Loss: 1.335 Vali Loss: 1.007 Vali Acc: 0.847 Test Loss: 1.007 Test Acc: 0.847
Validation loss decreased (-0.777762 --> -0.847212).  Saving model ...
Epoch: 5 cost time: 0.8709151744842529
Epoch: 5, Steps: 7 | Train Loss: 0.714 Vali Loss: 0.588 Vali Acc: 0.847 Test Loss: 0.588 Test Acc: 0.847
Validation loss decreased (-0.847212 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 1.4401278495788574
Epoch: 6, Steps: 7 | Train Loss: 0.302 Vali Loss: 0.467 Vali Acc: 0.819 Test Loss: 0.467 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2989521026611328
Epoch: 7, Steps: 7 | Train Loss: 0.081 Vali Loss: 0.473 Vali Acc: 0.903 Test Loss: 0.473 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 1.3955464363098145
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.0500409603118896
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.4373092651367188
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972221).  Saving model ...
Epoch: 11 cost time: 1.1599986553192139
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.50553560256958
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4834043979644775
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.123119592666626
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3057379722595215
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.497671365737915
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1805522441864014
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0776300430297852
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0694968700408936
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.469778299331665
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 37534476
model size : 157.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.170928478240967
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.497 Vali Acc: 0.153 Test Loss: 2.497 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.9961528778076172
Epoch: 2, Steps: 7 | Train Loss: 2.375 Vali Loss: 2.205 Vali Acc: 0.389 Test Loss: 2.205 Test Acc: 0.389
Validation loss decreased (-0.152753 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 1.2893390655517578
Epoch: 3, Steps: 7 | Train Loss: 2.084 Vali Loss: 1.884 Vali Acc: 0.653 Test Loss: 1.884 Test Acc: 0.653
Validation loss decreased (-0.388867 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.9949395656585693
Epoch: 4, Steps: 7 | Train Loss: 1.679 Vali Loss: 1.460 Vali Acc: 0.764 Test Loss: 1.460 Test Acc: 0.764
Validation loss decreased (-0.652759 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 1.3061740398406982
Epoch: 5, Steps: 7 | Train Loss: 1.241 Vali Loss: 1.004 Vali Acc: 0.833 Test Loss: 1.004 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 1.2203729152679443
Epoch: 6, Steps: 7 | Train Loss: 0.760 Vali Loss: 0.629 Vali Acc: 0.847 Test Loss: 0.629 Test Acc: 0.847
Validation loss decreased (-0.833323 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 1.1466851234436035
Epoch: 7, Steps: 7 | Train Loss: 0.396 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.1002840995788574
Epoch: 8, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.345 Vali Acc: 0.903 Test Loss: 0.345 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.2819361686706543
Epoch: 9, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.0541777610778809
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8048803806304932
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8256161212921143
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.0630910396575928
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 1.080195426940918
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1142139434814453
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1030755043029785
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0331945419311523
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8878397941589355
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2120084762573242
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0692760944366455
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0893430709838867
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7207658290863037
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2255849838256836
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37330188
model size : 157.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.787428617477417
Epoch: 1, Steps: 7 | Train Loss: 2.602 Vali Loss: 2.388 Vali Acc: 0.153 Test Loss: 2.388 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.693120002746582
Epoch: 2, Steps: 7 | Train Loss: 2.224 Vali Loss: 1.877 Vali Acc: 0.542 Test Loss: 1.877 Test Acc: 0.542
Validation loss decreased (-0.152754 --> -0.541648).  Saving model ...
Epoch: 3 cost time: 1.4466795921325684
Epoch: 3, Steps: 7 | Train Loss: 1.508 Vali Loss: 1.128 Vali Acc: 0.833 Test Loss: 1.128 Test Acc: 0.833
Validation loss decreased (-0.541648 --> -0.833322).  Saving model ...
Epoch: 4 cost time: 1.5303866863250732
Epoch: 4, Steps: 7 | Train Loss: 0.714 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6071317195892334
Epoch: 5, Steps: 7 | Train Loss: 0.202 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
Validation loss decreased (-0.833322 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 1.3057427406311035
Epoch: 6, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 1.6696088314056396
Epoch: 7, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.6077487468719482
Epoch: 8, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6298632621765137
Epoch: 9, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.642761468887329
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6552250385284424
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.875 Test Loss: 0.694 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3134729862213135
Epoch: 12, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.371 Vali Acc: 0.958 Test Loss: 0.371 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958330).  Saving model ...
Epoch: 13 cost time: 1.4251306056976318
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.533289909362793
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.307 Vali Acc: 0.972 Test Loss: 0.307 Test Acc: 0.972
Validation loss decreased (-0.958330 --> -0.972219).  Saving model ...
Epoch: 15 cost time: 1.6653087139129639
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.972 Test Loss: 0.335 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6938459873199463
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.356 Vali Acc: 0.958 Test Loss: 0.356 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5972542762756348
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.958 Test Loss: 0.341 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5914244651794434
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.958 Test Loss: 0.329 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6464016437530518
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.958 Test Loss: 0.321 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4175159931182861
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.958 Test Loss: 0.314 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.730952262878418
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.958 Test Loss: 0.310 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3768131732940674
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.958 Test Loss: 0.307 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5837054252624512
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.958 Test Loss: 0.306 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.761246919631958
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.958 Test Loss: 0.307 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 37930764
model size : 159.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6550960540771484
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.432 Vali Acc: 0.181 Test Loss: 2.432 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 1.0737886428833008
Epoch: 2, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.100 Vali Acc: 0.444 Test Loss: 2.100 Test Acc: 0.444
Validation loss decreased (-0.180531 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 1.1132068634033203
Epoch: 3, Steps: 7 | Train Loss: 1.793 Vali Loss: 1.448 Vali Acc: 0.819 Test Loss: 1.448 Test Acc: 0.819
Validation loss decreased (-0.444423 --> -0.819430).  Saving model ...
Epoch: 4 cost time: 0.9766576290130615
Epoch: 4, Steps: 7 | Train Loss: 1.080 Vali Loss: 0.861 Vali Acc: 0.778 Test Loss: 0.861 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9721004962921143
Epoch: 5, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
Validation loss decreased (-0.819430 --> -0.819439).  Saving model ...
Epoch: 6 cost time: 0.9834702014923096
Epoch: 6, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.819439 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.1007776260375977
Epoch: 7, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.8645436763763428
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.0496110916137695
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0997250080108643
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.033052682876587
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.9409050941467285
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.141334056854248
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.253981113433838
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0025708675384521
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1455657482147217
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1754531860351562
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.1270325183868408
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.171438217163086
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2840735912322998
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.021796703338623
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2560861110687256
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0378079414367676
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.100574254989624
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2664823532104492
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.063749074935913
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1982104778289795
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0350167751312256
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37554444
model size : 157.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3331732749938965
Epoch: 1, Steps: 7 | Train Loss: 2.610 Vali Loss: 2.466 Vali Acc: 0.125 Test Loss: 2.466 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.8717060089111328
Epoch: 2, Steps: 7 | Train Loss: 2.434 Vali Loss: 2.251 Vali Acc: 0.375 Test Loss: 2.251 Test Acc: 0.375
Validation loss decreased (-0.124975 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.9451792240142822
Epoch: 3, Steps: 7 | Train Loss: 2.147 Vali Loss: 1.985 Vali Acc: 0.639 Test Loss: 1.985 Test Acc: 0.639
Validation loss decreased (-0.374977 --> -0.638869).  Saving model ...
Epoch: 4 cost time: 0.9047918319702148
Epoch: 4, Steps: 7 | Train Loss: 1.778 Vali Loss: 1.574 Vali Acc: 0.819 Test Loss: 1.574 Test Acc: 0.819
Validation loss decreased (-0.638869 --> -0.819429).  Saving model ...
Epoch: 5 cost time: 0.980095624923706
Epoch: 5, Steps: 7 | Train Loss: 1.261 Vali Loss: 0.997 Vali Acc: 0.819 Test Loss: 0.997 Test Acc: 0.819
Validation loss decreased (-0.819429 --> -0.819434).  Saving model ...
Epoch: 6 cost time: 0.8628532886505127
Epoch: 6, Steps: 7 | Train Loss: 0.673 Vali Loss: 0.650 Vali Acc: 0.847 Test Loss: 0.650 Test Acc: 0.847
Validation loss decreased (-0.819434 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 1.3156800270080566
Epoch: 7, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
Validation loss decreased (-0.847216 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.0542945861816406
Epoch: 8, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2426717281341553
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2268683910369873
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.2218477725982666
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.9864346981048584
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.3692939281463623
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 1.1707072257995605
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 1.0631816387176514
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 1.3900227546691895
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 1.0926125049591064
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9918310642242432
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.369159460067749
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 1.2723376750946045
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 1.3608942031860352
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 1.2729079723358154
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 1.4421508312225342
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 1.2597763538360596
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.2340002059936523
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 26 cost time: 1.3194944858551025
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4139444828033447
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.196686029434204
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2836589813232422
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.399620771408081
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.724560022354126
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1946516036987305
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.342663049697876
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3500640392303467
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.120929479598999
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 37371660
model size : 157.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.015559673309326
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.434 Vali Acc: 0.222 Test Loss: 2.434 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 1.7438654899597168
Epoch: 2, Steps: 7 | Train Loss: 2.251 Vali Loss: 1.973 Vali Acc: 0.625 Test Loss: 1.973 Test Acc: 0.625
Validation loss decreased (-0.222198 --> -0.624980).  Saving model ...
Epoch: 3 cost time: 1.542069911956787
Epoch: 3, Steps: 7 | Train Loss: 1.659 Vali Loss: 1.331 Vali Acc: 0.750 Test Loss: 1.331 Test Acc: 0.750
Validation loss decreased (-0.624980 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 1.4468715190887451
Epoch: 4, Steps: 7 | Train Loss: 0.870 Vali Loss: 0.695 Vali Acc: 0.861 Test Loss: 0.695 Test Acc: 0.861
Validation loss decreased (-0.749987 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.174497365951538
Epoch: 5, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.400 Vali Acc: 0.903 Test Loss: 0.400 Test Acc: 0.903
Validation loss decreased (-0.861104 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.4244194030761719
Epoch: 6, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2854478359222412
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.272759199142456
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4299254417419434
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5079174041748047
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4735620021820068
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5639970302581787
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6875791549682617
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.331002950668335
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3418996334075928
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 37943052
model size : 159.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7446389198303223
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.479 Vali Acc: 0.208 Test Loss: 2.479 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.0894317626953125
Epoch: 2, Steps: 7 | Train Loss: 2.276 Vali Loss: 2.073 Vali Acc: 0.486 Test Loss: 2.073 Test Acc: 0.486
Validation loss decreased (-0.208309 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 1.0772154331207275
Epoch: 3, Steps: 7 | Train Loss: 1.914 Vali Loss: 1.617 Vali Acc: 0.708 Test Loss: 1.617 Test Acc: 0.708
Validation loss decreased (-0.486090 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 1.1892218589782715
Epoch: 4, Steps: 7 | Train Loss: 1.330 Vali Loss: 1.148 Vali Acc: 0.778 Test Loss: 1.148 Test Acc: 0.778
Validation loss decreased (-0.708317 --> -0.777766).  Saving model ...
Epoch: 5 cost time: 1.137108325958252
Epoch: 5, Steps: 7 | Train Loss: 0.783 Vali Loss: 0.643 Vali Acc: 0.847 Test Loss: 0.643 Test Acc: 0.847
Validation loss decreased (-0.777766 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 1.0465161800384521
Epoch: 6, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.386 Vali Acc: 0.833 Test Loss: 0.386 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1000185012817383
Epoch: 7, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.868614912033081
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.6962709426879883
Epoch: 9, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8956513404846191
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.888886 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.0250537395477295
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0699403285980225
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8154840469360352
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0796449184417725
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9339237213134766
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8279380798339844
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0714104175567627
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.959587574005127
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.922637939453125
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0510733127593994
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37588236
model size : 158.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6470654010772705
Epoch: 1, Steps: 7 | Train Loss: 2.663 Vali Loss: 2.503 Vali Acc: 0.097 Test Loss: 2.503 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.0209321975708008
Epoch: 2, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.244 Vali Acc: 0.389 Test Loss: 2.244 Test Acc: 0.389
Validation loss decreased (-0.097197 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 1.0096850395202637
Epoch: 3, Steps: 7 | Train Loss: 2.151 Vali Loss: 2.001 Vali Acc: 0.458 Test Loss: 2.001 Test Acc: 0.458
Validation loss decreased (-0.388866 --> -0.458313).  Saving model ...
Epoch: 4 cost time: 1.0059211254119873
Epoch: 4, Steps: 7 | Train Loss: 1.777 Vali Loss: 1.607 Vali Acc: 0.847 Test Loss: 1.607 Test Acc: 0.847
Validation loss decreased (-0.458313 --> -0.847206).  Saving model ...
Epoch: 5 cost time: 0.6129274368286133
Epoch: 5, Steps: 7 | Train Loss: 1.343 Vali Loss: 1.103 Vali Acc: 0.917 Test Loss: 1.103 Test Acc: 0.917
Validation loss decreased (-0.847206 --> -0.916656).  Saving model ...
Epoch: 6 cost time: 0.9184603691101074
Epoch: 6, Steps: 7 | Train Loss: 0.773 Vali Loss: 0.653 Vali Acc: 0.889 Test Loss: 0.653 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8073885440826416
Epoch: 7, Steps: 7 | Train Loss: 0.350 Vali Loss: 0.441 Vali Acc: 0.917 Test Loss: 0.441 Test Acc: 0.917
Validation loss decreased (-0.916656 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.7499597072601318
Epoch: 8, Steps: 7 | Train Loss: 0.158 Vali Loss: 0.286 Vali Acc: 0.931 Test Loss: 0.286 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.7186200618743896
Epoch: 9, Steps: 7 | Train Loss: 0.067 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 1.0113623142242432
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9947831630706787
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8491077423095703
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8732378482818604
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9532318115234375
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 0.6475570201873779
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972221).  Saving model ...
Epoch: 16 cost time: 0.6369426250457764
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 17 cost time: 0.8631296157836914
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8301053047180176
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6826293468475342
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7959215641021729
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7641260623931885
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0642404556274414
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8687474727630615
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7421841621398926
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8712790012359619
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7025198936462402
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 37405452
model size : 157.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7663373947143555
Epoch: 1, Steps: 7 | Train Loss: 2.611 Vali Loss: 2.357 Vali Acc: 0.264 Test Loss: 2.357 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 1.1109395027160645
Epoch: 2, Steps: 7 | Train Loss: 2.220 Vali Loss: 1.902 Vali Acc: 0.500 Test Loss: 1.902 Test Acc: 0.500
Validation loss decreased (-0.263865 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 1.056185245513916
Epoch: 3, Steps: 7 | Train Loss: 1.610 Vali Loss: 1.245 Vali Acc: 0.819 Test Loss: 1.245 Test Acc: 0.819
Validation loss decreased (-0.499981 --> -0.819432).  Saving model ...
Epoch: 4 cost time: 1.0649528503417969
Epoch: 4, Steps: 7 | Train Loss: 0.858 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.819432 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.4425742626190186
Epoch: 5, Steps: 7 | Train Loss: 0.293 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
Validation loss decreased (-0.833327 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.4456820487976074
Epoch: 6, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1338541507720947
Epoch: 7, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.136131763458252
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.366 Vali Acc: 0.931 Test Loss: 0.366 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 1.1000034809112549
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.425 Vali Acc: 0.931 Test Loss: 0.425 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9461793899536133
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2679743766784668
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.440 Vali Acc: 0.903 Test Loss: 0.440 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0594213008880615
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0496740341186523
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1860806941986084
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2011044025421143
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.158759355545044
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.970001220703125
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0392959117889404
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8175899982452393
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9420821666717529
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7789089679718018
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9283981323242188
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9278213977813721
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9306869506835938
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.71559739112854
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9897637367248535
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37955340
model size : 159.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.335742712020874
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.405 Vali Acc: 0.208 Test Loss: 2.405 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.7312037944793701
Epoch: 2, Steps: 7 | Train Loss: 2.294 Vali Loss: 2.089 Vali Acc: 0.528 Test Loss: 2.089 Test Acc: 0.528
Validation loss decreased (-0.208309 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.9622209072113037
Epoch: 3, Steps: 7 | Train Loss: 1.880 Vali Loss: 1.637 Vali Acc: 0.681 Test Loss: 1.637 Test Acc: 0.681
Validation loss decreased (-0.527757 --> -0.680539).  Saving model ...
Epoch: 4 cost time: 0.7936365604400635
Epoch: 4, Steps: 7 | Train Loss: 1.322 Vali Loss: 1.063 Vali Acc: 0.806 Test Loss: 1.063 Test Acc: 0.806
Validation loss decreased (-0.680539 --> -0.805545).  Saving model ...
Epoch: 5 cost time: 0.7972650527954102
Epoch: 5, Steps: 7 | Train Loss: 0.742 Vali Loss: 0.650 Vali Acc: 0.889 Test Loss: 0.650 Test Acc: 0.889
Validation loss decreased (-0.805545 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 1.3035800457000732
Epoch: 6, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.128326416015625
Epoch: 7, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.888882 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.2357256412506104
Epoch: 8, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2171874046325684
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9476687908172607
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 11 cost time: 0.6974954605102539
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7897765636444092
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 0.9978816509246826
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6724882125854492
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7193951606750488
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.917 Test Loss: 0.160 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7901923656463623
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.8603270053863525
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.931 Test Loss: 0.155 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 1.1049795150756836
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.931 Test Loss: 0.155 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 1.2930731773376465
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.931 Test Loss: 0.154 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 1.2616968154907227
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.931 Test Loss: 0.155 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9942812919616699
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.131077527999878
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.143385887145996
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.101841926574707
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.931 Test Loss: 0.162 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8951809406280518
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2770719528198242
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.931 Test Loss: 0.166 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.09226655960083
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.917 Test Loss: 0.168 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2902677059173584
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2109181880950928
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.931 Test Loss: 0.168 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37622028
model size : 158.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.449378252029419
Epoch: 1, Steps: 7 | Train Loss: 2.589 Vali Loss: 2.421 Vali Acc: 0.153 Test Loss: 2.421 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.9385998249053955
Epoch: 2, Steps: 7 | Train Loss: 2.389 Vali Loss: 2.206 Vali Acc: 0.500 Test Loss: 2.206 Test Acc: 0.500
Validation loss decreased (-0.152754 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 1.0364501476287842
Epoch: 3, Steps: 7 | Train Loss: 2.157 Vali Loss: 1.947 Vali Acc: 0.667 Test Loss: 1.947 Test Acc: 0.667
Validation loss decreased (-0.499978 --> -0.666647).  Saving model ...
Epoch: 4 cost time: 0.8042147159576416
Epoch: 4, Steps: 7 | Train Loss: 1.852 Vali Loss: 1.608 Vali Acc: 0.708 Test Loss: 1.608 Test Acc: 0.708
Validation loss decreased (-0.666647 --> -0.708317).  Saving model ...
Epoch: 5 cost time: 0.9938418865203857
Epoch: 5, Steps: 7 | Train Loss: 1.377 Vali Loss: 1.162 Vali Acc: 0.792 Test Loss: 1.162 Test Acc: 0.792
Validation loss decreased (-0.708317 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 0.8506064414978027
Epoch: 6, Steps: 7 | Train Loss: 0.855 Vali Loss: 0.702 Vali Acc: 0.889 Test Loss: 0.702 Test Acc: 0.889
Validation loss decreased (-0.791655 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 0.8780286312103271
Epoch: 7, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8246018886566162
Epoch: 8, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.6642303466796875
Epoch: 9, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.0055205821990967
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.0231196880340576
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1053898334503174
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9165041446685791
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8230500221252441
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1576223373413086
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.106630802154541
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 1.1325647830963135
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7761809825897217
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9830689430236816
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.5636723041534424
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5071711540222168
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5082442760467529
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6226763725280762
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7339968681335449
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6731960773468018
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8145742416381836
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0919711589813232
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.904116153717041
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0420498847961426
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37449996
model size : 157.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.289682388305664
Epoch: 1, Steps: 7 | Train Loss: 2.624 Vali Loss: 2.462 Vali Acc: 0.153 Test Loss: 2.462 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 1.0626220703125
Epoch: 2, Steps: 7 | Train Loss: 2.289 Vali Loss: 1.961 Vali Acc: 0.611 Test Loss: 1.961 Test Acc: 0.611
Validation loss decreased (-0.152753 --> -0.611091).  Saving model ...
Epoch: 3 cost time: 1.3465080261230469
Epoch: 3, Steps: 7 | Train Loss: 1.726 Vali Loss: 1.408 Vali Acc: 0.736 Test Loss: 1.408 Test Acc: 0.736
Validation loss decreased (-0.611091 --> -0.736097).  Saving model ...
Epoch: 4 cost time: 1.5373823642730713
Epoch: 4, Steps: 7 | Train Loss: 0.969 Vali Loss: 0.719 Vali Acc: 0.861 Test Loss: 0.719 Test Acc: 0.861
Validation loss decreased (-0.736097 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.0834245681762695
Epoch: 5, Steps: 7 | Train Loss: 0.312 Vali Loss: 0.359 Vali Acc: 0.847 Test Loss: 0.359 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5521457195281982
Epoch: 6, Steps: 7 | Train Loss: 0.093 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 1.5475490093231201
Epoch: 7, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.273 Vali Acc: 0.861 Test Loss: 0.273 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 1.318638801574707
Epoch: 8, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.861108 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.2959179878234863
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.875 Test Loss: 0.276 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5710828304290771
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3853294849395752
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3193402290344238
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4366202354431152
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3464553356170654
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2635505199432373
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5270376205444336
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3273899555206299
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1507492065429688
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37978380
model size : 159.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1441750526428223
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.448 Vali Acc: 0.125 Test Loss: 2.448 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.8573291301727295
Epoch: 2, Steps: 7 | Train Loss: 2.300 Vali Loss: 2.119 Vali Acc: 0.444 Test Loss: 2.119 Test Acc: 0.444
Validation loss decreased (-0.124976 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.8815760612487793
Epoch: 3, Steps: 7 | Train Loss: 1.928 Vali Loss: 1.692 Vali Acc: 0.778 Test Loss: 1.692 Test Acc: 0.778
Validation loss decreased (-0.444423 --> -0.777761).  Saving model ...
Epoch: 4 cost time: 1.070359468460083
Epoch: 4, Steps: 7 | Train Loss: 1.458 Vali Loss: 1.148 Vali Acc: 0.819 Test Loss: 1.148 Test Acc: 0.819
Validation loss decreased (-0.777761 --> -0.819433).  Saving model ...
Epoch: 5 cost time: 1.0639584064483643
Epoch: 5, Steps: 7 | Train Loss: 0.820 Vali Loss: 0.581 Vali Acc: 0.903 Test Loss: 0.581 Test Acc: 0.903
Validation loss decreased (-0.819433 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 0.8714809417724609
Epoch: 6, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8691864013671875
Epoch: 7, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.9875059127807617
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.875 Test Loss: 0.283 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0325510501861572
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1650259494781494
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.043506145477295
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.875 Test Loss: 0.215 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9566917419433594
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.903 Test Loss: 0.198 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 13 cost time: 1.1783685684204102
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 0.8445358276367188
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 0.9344022274017334
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9836645126342773
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7443304061889648
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7973368167877197
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 1.0522198677062988
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7689647674560547
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7698061466217041
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9383974075317383
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6758053302764893
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9508373737335205
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8965175151824951
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7510778903961182
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9624886512756348
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8978607654571533
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37655820
model size : 158.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.373121500015259
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.511 Vali Acc: 0.083 Test Loss: 2.511 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.6974122524261475
Epoch: 2, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.307 Vali Acc: 0.333 Test Loss: 2.307 Test Acc: 0.333
Validation loss decreased (-0.083308 --> -0.333310).  Saving model ...
Epoch: 3 cost time: 0.960871696472168
Epoch: 3, Steps: 7 | Train Loss: 2.153 Vali Loss: 2.034 Vali Acc: 0.639 Test Loss: 2.034 Test Acc: 0.639
Validation loss decreased (-0.333310 --> -0.638869).  Saving model ...
Epoch: 4 cost time: 0.7685482501983643
Epoch: 4, Steps: 7 | Train Loss: 1.801 Vali Loss: 1.661 Vali Acc: 0.708 Test Loss: 1.661 Test Acc: 0.708
Validation loss decreased (-0.638869 --> -0.708317).  Saving model ...
Epoch: 5 cost time: 0.9322137832641602
Epoch: 5, Steps: 7 | Train Loss: 1.399 Vali Loss: 1.136 Vali Acc: 0.736 Test Loss: 1.136 Test Acc: 0.736
Validation loss decreased (-0.708317 --> -0.736100).  Saving model ...
Epoch: 6 cost time: 0.7243518829345703
Epoch: 6, Steps: 7 | Train Loss: 0.859 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
Validation loss decreased (-0.736100 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 0.921630859375
Epoch: 7, Steps: 7 | Train Loss: 0.450 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
Validation loss decreased (-0.777770 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 0.9779970645904541
Epoch: 8, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.8821258544921875
Epoch: 9, Steps: 7 | Train Loss: 0.108 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.7896804809570312
Epoch: 10, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8706152439117432
Epoch: 11, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.7861883640289307
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 13 cost time: 0.9120285511016846
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 1.009230136871338
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 0.9107792377471924
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 1.0613980293273926
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9693834781646729
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8003754615783691
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.03338623046875
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9328343868255615
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7515697479248047
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 22 cost time: 0.9022097587585449
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8559529781341553
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.704540491104126
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9114360809326172
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8988885879516602
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6048052310943604
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7380244731903076
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7522573471069336
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.669100284576416
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6440606117248535
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 37494540
model size : 157.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.871337413787842
Epoch: 1, Steps: 7 | Train Loss: 2.656 Vali Loss: 2.413 Vali Acc: 0.125 Test Loss: 2.413 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.3385212421417236
Epoch: 2, Steps: 7 | Train Loss: 2.310 Vali Loss: 2.010 Vali Acc: 0.542 Test Loss: 2.010 Test Acc: 0.542
Validation loss decreased (-0.124976 --> -0.541647).  Saving model ...
Epoch: 3 cost time: 1.47983980178833
Epoch: 3, Steps: 7 | Train Loss: 1.710 Vali Loss: 1.496 Vali Acc: 0.639 Test Loss: 1.496 Test Acc: 0.639
Validation loss decreased (-0.541647 --> -0.638874).  Saving model ...
Epoch: 4 cost time: 1.211292028427124
Epoch: 4, Steps: 7 | Train Loss: 1.035 Vali Loss: 0.835 Vali Acc: 0.806 Test Loss: 0.835 Test Acc: 0.806
Validation loss decreased (-0.638874 --> -0.805547).  Saving model ...
Epoch: 5 cost time: 1.0760483741760254
Epoch: 5, Steps: 7 | Train Loss: 0.408 Vali Loss: 0.599 Vali Acc: 0.792 Test Loss: 0.599 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0744266510009766
Epoch: 6, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
Validation loss decreased (-0.805547 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.1226332187652588
Epoch: 7, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.046396255493164
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.4552602767944336
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.4738893508911133
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.2183988094329834
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2988708019256592
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3586914539337158
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1993372440338135
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1499934196472168
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.431791067123413
Epoch: 16, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3533384799957275
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.46114182472229
Epoch: 18, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.45058012008667
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.385540246963501
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 38004492
model size : 159.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5369439125061035
Epoch: 1, Steps: 7 | Train Loss: 2.547 Vali Loss: 2.400 Vali Acc: 0.278 Test Loss: 2.400 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 1.1652004718780518
Epoch: 2, Steps: 7 | Train Loss: 2.252 Vali Loss: 2.090 Vali Acc: 0.556 Test Loss: 2.090 Test Acc: 0.556
Validation loss decreased (-0.277754 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 1.203270435333252
Epoch: 3, Steps: 7 | Train Loss: 1.893 Vali Loss: 1.661 Vali Acc: 0.736 Test Loss: 1.661 Test Acc: 0.736
Validation loss decreased (-0.555535 --> -0.736095).  Saving model ...
Epoch: 4 cost time: 0.9713015556335449
Epoch: 4, Steps: 7 | Train Loss: 1.299 Vali Loss: 1.099 Vali Acc: 0.806 Test Loss: 1.099 Test Acc: 0.806
Validation loss decreased (-0.736095 --> -0.805545).  Saving model ...
Epoch: 5 cost time: 0.6324892044067383
Epoch: 5, Steps: 7 | Train Loss: 0.731 Vali Loss: 0.630 Vali Acc: 0.903 Test Loss: 0.630 Test Acc: 0.903
Validation loss decreased (-0.805545 --> -0.902771).  Saving model ...
Epoch: 6 cost time: 0.6905784606933594
Epoch: 6, Steps: 7 | Train Loss: 0.292 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
Validation loss decreased (-0.902771 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.0488314628601074
Epoch: 7, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0570342540740967
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.393 Vali Acc: 0.931 Test Loss: 0.393 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.9352192878723145
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9400873184204102
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.0334620475769043
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9711298942565918
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.1711831092834473
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8080625534057617
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1456429958343506
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.123741865158081
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.986802339553833
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0661351680755615
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0590291023254395
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8778088092803955
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0384716987609863
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7549545764923096
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37703436
model size : 158.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0109283924102783
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.448 Vali Acc: 0.097 Test Loss: 2.448 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6863114833831787
Epoch: 2, Steps: 7 | Train Loss: 2.380 Vali Loss: 2.253 Vali Acc: 0.375 Test Loss: 2.253 Test Acc: 0.375
Validation loss decreased (-0.097198 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.6762192249298096
Epoch: 3, Steps: 7 | Train Loss: 2.115 Vali Loss: 2.022 Vali Acc: 0.583 Test Loss: 2.022 Test Acc: 0.583
Validation loss decreased (-0.374977 --> -0.583313).  Saving model ...
Epoch: 4 cost time: 0.7570176124572754
Epoch: 4, Steps: 7 | Train Loss: 1.790 Vali Loss: 1.676 Vali Acc: 0.750 Test Loss: 1.676 Test Acc: 0.750
Validation loss decreased (-0.583313 --> -0.749983).  Saving model ...
Epoch: 5 cost time: 0.5911648273468018
Epoch: 5, Steps: 7 | Train Loss: 1.382 Vali Loss: 1.189 Vali Acc: 0.819 Test Loss: 1.189 Test Acc: 0.819
Validation loss decreased (-0.749983 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 0.6742329597473145
Epoch: 6, Steps: 7 | Train Loss: 0.921 Vali Loss: 0.756 Vali Acc: 0.875 Test Loss: 0.756 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.8368027210235596
Epoch: 7, Steps: 7 | Train Loss: 0.498 Vali Loss: 0.486 Vali Acc: 0.903 Test Loss: 0.486 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.7279336452484131
Epoch: 8, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7658562660217285
Epoch: 9, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.6216721534729004
Epoch: 10, Steps: 7 | Train Loss: 0.056 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7423341274261475
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8119409084320068
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.6265144348144531
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7035167217254639
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7054843902587891
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6662459373474121
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6117815971374512
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8340272903442383
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.680046558380127
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6708502769470215
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8510639667510986
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6491959095001221
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7045083045959473
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7464644908905029
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37552908
model size : 157.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps86_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3806869983673096
Epoch: 1, Steps: 7 | Train Loss: 2.636 Vali Loss: 2.487 Vali Acc: 0.181 Test Loss: 2.487 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 1.008335828781128
Epoch: 2, Steps: 7 | Train Loss: 2.330 Vali Loss: 2.008 Vali Acc: 0.514 Test Loss: 2.008 Test Acc: 0.514
Validation loss decreased (-0.180531 --> -0.513869).  Saving model ...
Epoch: 3 cost time: 0.9861733913421631
Epoch: 3, Steps: 7 | Train Loss: 1.675 Vali Loss: 1.350 Vali Acc: 0.819 Test Loss: 1.350 Test Acc: 0.819
Validation loss decreased (-0.513869 --> -0.819431).  Saving model ...
Epoch: 4 cost time: 0.9647715091705322
Epoch: 4, Steps: 7 | Train Loss: 0.865 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.819431 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.9984719753265381
Epoch: 5, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.833327 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 1.0097310543060303
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9988386631011963
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.5103952884674072
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.3139867782592773
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0854687690734863
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.861 Test Loss: 0.433 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3466286659240723
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8953704833984375
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9841277599334717
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3089609146118164
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.113792896270752
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3981714248657227
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.498966932296753
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.813040018081665
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps86_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 38033676
model size : 159.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps86_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.533965826034546
Epoch: 1, Steps: 7 | Train Loss: 2.691 Vali Loss: 2.478 Vali Acc: 0.000 Test Loss: 2.478 Test Acc: 0.000
Validation loss decreased (inf --> 0.000025).  Saving model ...
Epoch: 2 cost time: 1.068627119064331
Epoch: 2, Steps: 7 | Train Loss: 2.408 Vali Loss: 2.195 Vali Acc: 0.375 Test Loss: 2.195 Test Acc: 0.375
Validation loss decreased (0.000025 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.7316713333129883
Epoch: 3, Steps: 7 | Train Loss: 2.060 Vali Loss: 1.847 Vali Acc: 0.667 Test Loss: 1.847 Test Acc: 0.667
Validation loss decreased (-0.374978 --> -0.666648).  Saving model ...
Epoch: 4 cost time: 0.8773398399353027
Epoch: 4, Steps: 7 | Train Loss: 1.542 Vali Loss: 1.234 Vali Acc: 0.736 Test Loss: 1.234 Test Acc: 0.736
Validation loss decreased (-0.666648 --> -0.736099).  Saving model ...
Epoch: 5 cost time: 0.6564218997955322
Epoch: 5, Steps: 7 | Train Loss: 0.808 Vali Loss: 0.647 Vali Acc: 0.847 Test Loss: 0.647 Test Acc: 0.847
Validation loss decreased (-0.736099 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.730571985244751
Epoch: 6, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.9128632545471191
Epoch: 7, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.7882134914398193
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.772627592086792
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7221875190734863
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7157948017120361
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.0870153903961182
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8481564521789551
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.136885166168213
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7657690048217773
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0362603664398193
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.9310958385467529
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.7352139949798584
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0589828491210938
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.9745848178863525
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 1.0913691520690918
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.8485922813415527
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9686892032623291
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.7040128707885742
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1699285507202148
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0203168392181396
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.900935173034668
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.099299430847168
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8941326141357422
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0722084045410156
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9011318683624268
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1510887145996094
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1938002109527588
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps86_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 37764876
model size : 158.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps86_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.333723783493042
Epoch: 1, Steps: 7 | Train Loss: 2.644 Vali Loss: 2.503 Vali Acc: 0.083 Test Loss: 2.503 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.8262374401092529
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.285 Vali Acc: 0.319 Test Loss: 2.285 Test Acc: 0.319
Validation loss decreased (-0.083308 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 0.7265529632568359
Epoch: 3, Steps: 7 | Train Loss: 2.178 Vali Loss: 1.974 Vali Acc: 0.667 Test Loss: 1.974 Test Acc: 0.667
Validation loss decreased (-0.319422 --> -0.666647).  Saving model ...
Epoch: 4 cost time: 0.6695964336395264
Epoch: 4, Steps: 7 | Train Loss: 1.749 Vali Loss: 1.459 Vali Acc: 0.792 Test Loss: 1.459 Test Acc: 0.792
Validation loss decreased (-0.666647 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.6034297943115234
Epoch: 5, Steps: 7 | Train Loss: 1.165 Vali Loss: 0.913 Vali Acc: 0.847 Test Loss: 0.913 Test Acc: 0.847
Validation loss decreased (-0.791652 --> -0.847213).  Saving model ...
Epoch: 6 cost time: 0.5218780040740967
Epoch: 6, Steps: 7 | Train Loss: 0.598 Vali Loss: 0.651 Vali Acc: 0.875 Test Loss: 0.651 Test Acc: 0.875
Validation loss decreased (-0.847213 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.5828356742858887
Epoch: 7, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.457 Vali Acc: 0.903 Test Loss: 0.457 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.7281155586242676
Epoch: 8, Steps: 7 | Train Loss: 0.098 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.5674424171447754
Epoch: 9, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.7874960899353027
Epoch: 10, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7617080211639404
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6047849655151367
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6471388339996338
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.710801362991333
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7278881072998047
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6864275932312012
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6979379653930664
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6163654327392578
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7245135307312012
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7156696319580078
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.731461763381958
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps86_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37625100
model size : 158.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8844032287597656
Epoch: 1, Steps: 7 | Train Loss: 2.634 Vali Loss: 2.447 Vali Acc: 0.139 Test Loss: 2.447 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.9335856437683105
Epoch: 2, Steps: 7 | Train Loss: 2.280 Vali Loss: 2.018 Vali Acc: 0.556 Test Loss: 2.018 Test Acc: 0.556
Validation loss decreased (-0.138864 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 1.1205735206604004
Epoch: 3, Steps: 7 | Train Loss: 1.678 Vali Loss: 1.320 Vali Acc: 0.750 Test Loss: 1.320 Test Acc: 0.750
Validation loss decreased (-0.555535 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 1.1063134670257568
Epoch: 4, Steps: 7 | Train Loss: 0.956 Vali Loss: 0.681 Vali Acc: 0.819 Test Loss: 0.681 Test Acc: 0.819
Validation loss decreased (-0.749987 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 0.9305086135864258
Epoch: 5, Steps: 7 | Train Loss: 0.318 Vali Loss: 0.437 Vali Acc: 0.819 Test Loss: 0.437 Test Acc: 0.819
Validation loss decreased (-0.819438 --> -0.819440).  Saving model ...
Epoch: 6 cost time: 0.9396679401397705
Epoch: 6, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.399 Vali Acc: 0.847 Test Loss: 0.399 Test Acc: 0.847
Validation loss decreased (-0.819440 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.9490928649902344
Epoch: 7, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7867414951324463
Epoch: 8, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.431 Vali Acc: 0.847 Test Loss: 0.431 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9520039558410645
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.847 Test Loss: 0.509 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9100503921508789
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.861 Test Loss: 0.415 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 1.2331151962280273
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.7934622764587402
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 0.8574764728546143
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.7054610252380371
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.966850757598877
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.875 Test Loss: 0.381 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0048155784606934
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2015395164489746
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3246469497680664
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.050954818725586
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0819787979125977
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3145663738250732
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1583821773529053
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7165029048919678
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 38087436
model size : 159.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9076368808746338
Epoch: 1, Steps: 7 | Train Loss: 2.702 Vali Loss: 2.551 Vali Acc: 0.083 Test Loss: 2.551 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.8254194259643555
Epoch: 2, Steps: 7 | Train Loss: 2.364 Vali Loss: 2.204 Vali Acc: 0.347 Test Loss: 2.204 Test Acc: 0.347
Validation loss decreased (-0.083308 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 1.0718104839324951
Epoch: 3, Steps: 7 | Train Loss: 2.052 Vali Loss: 1.800 Vali Acc: 0.542 Test Loss: 1.800 Test Acc: 0.542
Validation loss decreased (-0.347200 --> -0.541649).  Saving model ...
Epoch: 4 cost time: 0.8583343029022217
Epoch: 4, Steps: 7 | Train Loss: 1.484 Vali Loss: 1.125 Vali Acc: 0.806 Test Loss: 1.125 Test Acc: 0.806
Validation loss decreased (-0.541649 --> -0.805544).  Saving model ...
Epoch: 5 cost time: 0.7777082920074463
Epoch: 5, Steps: 7 | Train Loss: 0.817 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
Validation loss decreased (-0.805544 --> -0.819439).  Saving model ...
Epoch: 6 cost time: 0.7694723606109619
Epoch: 6, Steps: 7 | Train Loss: 0.324 Vali Loss: 0.471 Vali Acc: 0.847 Test Loss: 0.471 Test Acc: 0.847
Validation loss decreased (-0.819439 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.8760263919830322
Epoch: 7, Steps: 7 | Train Loss: 0.136 Vali Loss: 0.341 Vali Acc: 0.861 Test Loss: 0.341 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 0.9253585338592529
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.366 Vali Acc: 0.847 Test Loss: 0.366 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0086023807525635
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.376 Vali Acc: 0.875 Test Loss: 0.376 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.769676923751831
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.01491379737854
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.9556479454040527
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 1.0890560150146484
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8336482048034668
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.025477647781372
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9876034259796143
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9627175331115723
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0962121486663818
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7589066028594971
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7433159351348877
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7906129360198975
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7182347774505615
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 37840140
model size : 159.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0455758571624756
Epoch: 1, Steps: 7 | Train Loss: 2.681 Vali Loss: 2.517 Vali Acc: 0.083 Test Loss: 2.517 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7463498115539551
Epoch: 2, Steps: 7 | Train Loss: 2.497 Vali Loss: 2.267 Vali Acc: 0.375 Test Loss: 2.267 Test Acc: 0.375
Validation loss decreased (-0.083308 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.7613174915313721
Epoch: 3, Steps: 7 | Train Loss: 2.236 Vali Loss: 1.999 Vali Acc: 0.639 Test Loss: 1.999 Test Acc: 0.639
Validation loss decreased (-0.374977 --> -0.638869).  Saving model ...
Epoch: 4 cost time: 0.8136401176452637
Epoch: 4, Steps: 7 | Train Loss: 1.912 Vali Loss: 1.674 Vali Acc: 0.653 Test Loss: 1.674 Test Acc: 0.653
Validation loss decreased (-0.638869 --> -0.652761).  Saving model ...
Epoch: 5 cost time: 0.5811038017272949
Epoch: 5, Steps: 7 | Train Loss: 1.495 Vali Loss: 1.221 Vali Acc: 0.778 Test Loss: 1.221 Test Acc: 0.778
Validation loss decreased (-0.652761 --> -0.777766).  Saving model ...
Epoch: 6 cost time: 0.5270335674285889
Epoch: 6, Steps: 7 | Train Loss: 0.965 Vali Loss: 0.784 Vali Acc: 0.833 Test Loss: 0.784 Test Acc: 0.833
Validation loss decreased (-0.777766 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.6715006828308105
Epoch: 7, Steps: 7 | Train Loss: 0.516 Vali Loss: 0.539 Vali Acc: 0.847 Test Loss: 0.539 Test Acc: 0.847
Validation loss decreased (-0.833325 --> -0.847217).  Saving model ...
Epoch: 8 cost time: 0.6838512420654297
Epoch: 8, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.618582010269165
Epoch: 9, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.7513210773468018
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7585995197296143
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6148021221160889
Epoch: 12, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.7787811756134033
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6281218528747559
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.6379823684692383
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5998892784118652
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6725947856903076
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.889 Test Loss: 0.266 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7399997711181641
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.638453483581543
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6468374729156494
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7860500812530518
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5913984775543213
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6057498455047607
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5915224552154541
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 37711116
model size : 158.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.075955390930176
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.447 Vali Acc: 0.097 Test Loss: 2.447 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.6579329967498779
Epoch: 2, Steps: 7 | Train Loss: 2.313 Vali Loss: 2.037 Vali Acc: 0.528 Test Loss: 2.037 Test Acc: 0.528
Validation loss decreased (-0.097198 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.9563617706298828
Epoch: 3, Steps: 7 | Train Loss: 1.761 Vali Loss: 1.489 Vali Acc: 0.833 Test Loss: 1.489 Test Acc: 0.833
Validation loss decreased (-0.527757 --> -0.833318).  Saving model ...
Epoch: 4 cost time: 1.1593866348266602
Epoch: 4, Steps: 7 | Train Loss: 0.994 Vali Loss: 0.698 Vali Acc: 0.847 Test Loss: 0.698 Test Acc: 0.847
Validation loss decreased (-0.833318 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 1.112180233001709
Epoch: 5, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.2763242721557617
Epoch: 6, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1531853675842285
Epoch: 7, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 1.2480027675628662
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.5469424724578857
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4118115901947021
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3052465915679932
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.384427785873413
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.390902042388916
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9040341377258301
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.2211344242095947
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 1.23073148727417
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2430543899536133
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2078239917755127
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0438666343688965
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2491545677185059
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1867854595184326
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1895570755004883
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.119006872177124
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1270623207092285
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9138319492340088
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 38151948
model size : 160.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.492190361022949
Epoch: 1, Steps: 7 | Train Loss: 2.667 Vali Loss: 2.467 Vali Acc: 0.208 Test Loss: 2.467 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.0838942527770996
Epoch: 2, Steps: 7 | Train Loss: 2.374 Vali Loss: 2.178 Vali Acc: 0.347 Test Loss: 2.178 Test Acc: 0.347
Validation loss decreased (-0.208309 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.9144985675811768
Epoch: 3, Steps: 7 | Train Loss: 1.984 Vali Loss: 1.787 Vali Acc: 0.681 Test Loss: 1.787 Test Acc: 0.681
Validation loss decreased (-0.347200 --> -0.680538).  Saving model ...
Epoch: 4 cost time: 1.3537840843200684
Epoch: 4, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.279 Vali Acc: 0.819 Test Loss: 1.279 Test Acc: 0.819
Validation loss decreased (-0.680538 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 0.8719878196716309
Epoch: 5, Steps: 7 | Train Loss: 0.953 Vali Loss: 0.742 Vali Acc: 0.847 Test Loss: 0.742 Test Acc: 0.847
Validation loss decreased (-0.819432 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 1.2753584384918213
Epoch: 6, Steps: 7 | Train Loss: 0.470 Vali Loss: 0.462 Vali Acc: 0.903 Test Loss: 0.462 Test Acc: 0.903
Validation loss decreased (-0.847215 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.931427001953125
Epoch: 7, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0101423263549805
Epoch: 8, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.2861309051513672
Epoch: 9, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.2372252941131592
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 11 cost time: 1.3449320793151855
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 12 cost time: 1.3805818557739258
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1692900657653809
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2789275646209717
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.314894199371338
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7792611122131348
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1101412773132324
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3779163360595703
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.903 Test Loss: 0.203 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.165384292602539
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9590175151824951
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.994788408279419
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.903 Test Loss: 0.205 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 37915404
model size : 159.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.997079610824585
Epoch: 1, Steps: 7 | Train Loss: 2.671 Vali Loss: 2.555 Vali Acc: 0.111 Test Loss: 2.555 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6967818737030029
Epoch: 2, Steps: 7 | Train Loss: 2.470 Vali Loss: 2.310 Vali Acc: 0.417 Test Loss: 2.310 Test Acc: 0.417
Validation loss decreased (-0.111086 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 0.7293984889984131
Epoch: 3, Steps: 7 | Train Loss: 2.174 Vali Loss: 2.030 Vali Acc: 0.625 Test Loss: 2.030 Test Acc: 0.625
Validation loss decreased (-0.416644 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 0.7511022090911865
Epoch: 4, Steps: 7 | Train Loss: 1.843 Vali Loss: 1.661 Vali Acc: 0.722 Test Loss: 1.661 Test Acc: 0.722
Validation loss decreased (-0.624980 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 0.6234028339385986
Epoch: 5, Steps: 7 | Train Loss: 1.399 Vali Loss: 1.179 Vali Acc: 0.792 Test Loss: 1.179 Test Acc: 0.792
Validation loss decreased (-0.722206 --> -0.791655).  Saving model ...
Epoch: 6 cost time: 0.7499933242797852
Epoch: 6, Steps: 7 | Train Loss: 0.906 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
Validation loss decreased (-0.791655 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 0.7828555107116699
Epoch: 7, Steps: 7 | Train Loss: 0.480 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
Validation loss decreased (-0.819436 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.8526475429534912
Epoch: 8, Steps: 7 | Train Loss: 0.220 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.855889081954956
Epoch: 9, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9156596660614014
Epoch: 10, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8358297348022461
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6517736911773682
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8986995220184326
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8724343776702881
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8781425952911377
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7708063125610352
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.8452873229980469
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8607120513916016
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5933878421783447
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.8780200481414795
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.8998069763183594
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9260640144348145
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8519887924194336
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8942136764526367
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7307083606719971
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8628785610198975
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9306764602661133
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8031916618347168
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8956291675567627
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6191577911376953
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7444307804107666
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7170484066009521
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7986831665039062
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37797132
model size : 158.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.559441089630127
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.416 Vali Acc: 0.208 Test Loss: 2.416 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.2440481185913086
Epoch: 2, Steps: 7 | Train Loss: 2.245 Vali Loss: 1.991 Vali Acc: 0.417 Test Loss: 1.991 Test Acc: 0.417
Validation loss decreased (-0.208309 --> -0.416647).  Saving model ...
Epoch: 3 cost time: 1.082763433456421
Epoch: 3, Steps: 7 | Train Loss: 1.816 Vali Loss: 1.465 Vali Acc: 0.736 Test Loss: 1.465 Test Acc: 0.736
Validation loss decreased (-0.416647 --> -0.736096).  Saving model ...
Epoch: 4 cost time: 1.193934679031372
Epoch: 4, Steps: 7 | Train Loss: 1.066 Vali Loss: 0.832 Vali Acc: 0.833 Test Loss: 0.832 Test Acc: 0.833
Validation loss decreased (-0.736096 --> -0.833325).  Saving model ...
Epoch: 5 cost time: 1.1805291175842285
Epoch: 5, Steps: 7 | Train Loss: 0.426 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 1.041118860244751
Epoch: 6, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.2382135391235352
Epoch: 7, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944441).  Saving model ...
Epoch: 8 cost time: 1.1831588745117188
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3690142631530762
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2785499095916748
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0927858352661133
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.287604808807373
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9742248058319092
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1427667140960693
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9322371482849121
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9715983867645264
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.000304937362671
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 38222604
model size : 160.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.746147394180298
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.464 Vali Acc: 0.139 Test Loss: 2.464 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.0651392936706543
Epoch: 2, Steps: 7 | Train Loss: 2.329 Vali Loss: 2.150 Vali Acc: 0.389 Test Loss: 2.150 Test Acc: 0.389
Validation loss decreased (-0.138864 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 1.3193187713623047
Epoch: 3, Steps: 7 | Train Loss: 2.017 Vali Loss: 1.772 Vali Acc: 0.611 Test Loss: 1.772 Test Acc: 0.611
Validation loss decreased (-0.388867 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 1.2942638397216797
Epoch: 4, Steps: 7 | Train Loss: 1.502 Vali Loss: 1.240 Vali Acc: 0.819 Test Loss: 1.240 Test Acc: 0.819
Validation loss decreased (-0.611093 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 1.1083765029907227
Epoch: 5, Steps: 7 | Train Loss: 0.944 Vali Loss: 0.718 Vali Acc: 0.861 Test Loss: 0.718 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 1.2524399757385254
Epoch: 6, Steps: 7 | Train Loss: 0.468 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 1.081033706665039
Epoch: 7, Steps: 7 | Train Loss: 0.160 Vali Loss: 0.350 Vali Acc: 0.861 Test Loss: 0.350 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 1.337278127670288
Epoch: 8, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 0.970787525177002
Epoch: 9, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
Validation loss decreased (-0.874997 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.8940029144287109
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2161617279052734
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.096644401550293
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8972244262695312
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 1.0340776443481445
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.1527819633483887
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9412808418273926
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.069096565246582
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2089602947235107
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.8414642810821533
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.9856116771697998
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8100934028625488
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 1.2881801128387451
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.1249713897705078
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2127673625946045
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8496658802032471
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7004044055938721
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2209136486053467
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2596781253814697
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2046058177947998
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9329273700714111
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7171416282653809
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8887312412261963
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 38018316
model size : 159.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5577940940856934
Epoch: 1, Steps: 7 | Train Loss: 2.666 Vali Loss: 2.532 Vali Acc: 0.111 Test Loss: 2.532 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6070981025695801
Epoch: 2, Steps: 7 | Train Loss: 2.467 Vali Loss: 2.269 Vali Acc: 0.375 Test Loss: 2.269 Test Acc: 0.375
Validation loss decreased (-0.111086 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.7127819061279297
Epoch: 3, Steps: 7 | Train Loss: 2.201 Vali Loss: 2.017 Vali Acc: 0.583 Test Loss: 2.017 Test Acc: 0.583
Validation loss decreased (-0.374977 --> -0.583313).  Saving model ...
Epoch: 4 cost time: 0.7753264904022217
Epoch: 4, Steps: 7 | Train Loss: 1.844 Vali Loss: 1.677 Vali Acc: 0.764 Test Loss: 1.677 Test Acc: 0.764
Validation loss decreased (-0.583313 --> -0.763872).  Saving model ...
Epoch: 5 cost time: 0.7392086982727051
Epoch: 5, Steps: 7 | Train Loss: 1.425 Vali Loss: 1.226 Vali Acc: 0.833 Test Loss: 1.226 Test Acc: 0.833
Validation loss decreased (-0.763872 --> -0.833321).  Saving model ...
Epoch: 6 cost time: 0.6356055736541748
Epoch: 6, Steps: 7 | Train Loss: 0.931 Vali Loss: 0.815 Vali Acc: 0.833 Test Loss: 0.815 Test Acc: 0.833
Validation loss decreased (-0.833321 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.6176228523254395
Epoch: 7, Steps: 7 | Train Loss: 0.518 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.752723217010498
Epoch: 8, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
Validation loss decreased (-0.833328 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.7800791263580322
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.6221973896026611
Epoch: 10, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6825525760650635
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 0.9720346927642822
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 0.8115334510803223
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8198564052581787
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.893704891204834
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7209184169769287
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.7317755222320557
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.8201329708099365
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.7846024036407471
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.817878246307373
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7690615653991699
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.7180776596069336
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7009778022766113
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6934347152709961
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5835418701171875
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.604517936706543
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6749725341796875
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6897563934326172
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7115750312805176
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7034134864807129
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6366887092590332
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 37910796
model size : 159.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7042126655578613
Epoch: 1, Steps: 7 | Train Loss: 2.643 Vali Loss: 2.482 Vali Acc: 0.097 Test Loss: 2.482 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.1930713653564453
Epoch: 2, Steps: 7 | Train Loss: 2.308 Vali Loss: 2.074 Vali Acc: 0.500 Test Loss: 2.074 Test Acc: 0.500
Validation loss decreased (-0.097197 --> -0.499979).  Saving model ...
Epoch: 3 cost time: 0.7487525939941406
Epoch: 3, Steps: 7 | Train Loss: 1.774 Vali Loss: 1.462 Vali Acc: 0.722 Test Loss: 1.462 Test Acc: 0.722
Validation loss decreased (-0.499979 --> -0.722208).  Saving model ...
Epoch: 4 cost time: 0.5827591419219971
Epoch: 4, Steps: 7 | Train Loss: 1.069 Vali Loss: 0.778 Vali Acc: 0.819 Test Loss: 0.778 Test Acc: 0.819
Validation loss decreased (-0.722208 --> -0.819437).  Saving model ...
Epoch: 5 cost time: 0.6914339065551758
Epoch: 5, Steps: 7 | Train Loss: 0.418 Vali Loss: 0.513 Vali Acc: 0.819 Test Loss: 0.513 Test Acc: 0.819
Validation loss decreased (-0.819437 --> -0.819439).  Saving model ...
Epoch: 6 cost time: 1.003154993057251
Epoch: 6, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.383 Vali Acc: 0.847 Test Loss: 0.383 Test Acc: 0.847
Validation loss decreased (-0.819439 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.9740660190582275
Epoch: 7, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.9794678688049316
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9934906959533691
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1740634441375732
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.9498655796051025
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.12943696975708
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0432567596435547
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1658425331115723
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1302006244659424
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8947899341583252
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0991196632385254
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1472461223602295
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7852084636688232
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2345447540283203
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2280128002166748
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 38342412
model size : 160.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.437605857849121
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.431 Vali Acc: 0.167 Test Loss: 2.431 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 1.059427261352539
Epoch: 2, Steps: 7 | Train Loss: 2.323 Vali Loss: 2.104 Vali Acc: 0.556 Test Loss: 2.104 Test Acc: 0.556
Validation loss decreased (-0.166642 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 1.110351800918579
Epoch: 3, Steps: 7 | Train Loss: 1.935 Vali Loss: 1.512 Vali Acc: 0.736 Test Loss: 1.512 Test Acc: 0.736
Validation loss decreased (-0.555535 --> -0.736096).  Saving model ...
Epoch: 4 cost time: 0.9745352268218994
Epoch: 4, Steps: 7 | Train Loss: 1.462 Vali Loss: 1.040 Vali Acc: 0.819 Test Loss: 1.040 Test Acc: 0.819
Validation loss decreased (-0.736096 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 1.1097991466522217
Epoch: 5, Steps: 7 | Train Loss: 0.848 Vali Loss: 0.735 Vali Acc: 0.861 Test Loss: 0.735 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 0.8058879375457764
Epoch: 6, Steps: 7 | Train Loss: 0.402 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.9444525241851807
Epoch: 7, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9324777126312256
Epoch: 8, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.9197776317596436
Epoch: 9, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.7296128273010254
Epoch: 10, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.80757737159729
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8251421451568604
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.094404935836792
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.9164772033691406
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0169155597686768
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9930210113525391
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0091743469238281
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9184596538543701
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6211972236633301
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1318891048431396
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.131518840789795
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7831864356994629
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1170084476470947
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8667385578155518
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 38148876
model size : 160.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2010374069213867
Epoch: 1, Steps: 7 | Train Loss: 2.617 Vali Loss: 2.491 Vali Acc: 0.056 Test Loss: 2.491 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.7274918556213379
Epoch: 2, Steps: 7 | Train Loss: 2.441 Vali Loss: 2.294 Vali Acc: 0.278 Test Loss: 2.294 Test Acc: 0.278
Validation loss decreased (-0.055531 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.6587820053100586
Epoch: 3, Steps: 7 | Train Loss: 2.163 Vali Loss: 2.031 Vali Acc: 0.556 Test Loss: 2.031 Test Acc: 0.556
Validation loss decreased (-0.277755 --> -0.555535).  Saving model ...
Epoch: 4 cost time: 0.6169242858886719
Epoch: 4, Steps: 7 | Train Loss: 1.864 Vali Loss: 1.696 Vali Acc: 0.708 Test Loss: 1.696 Test Acc: 0.708
Validation loss decreased (-0.555535 --> -0.708316).  Saving model ...
Epoch: 5 cost time: 0.588860273361206
Epoch: 5, Steps: 7 | Train Loss: 1.452 Vali Loss: 1.260 Vali Acc: 0.750 Test Loss: 1.260 Test Acc: 0.750
Validation loss decreased (-0.708316 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 0.5954709053039551
Epoch: 6, Steps: 7 | Train Loss: 0.935 Vali Loss: 0.833 Vali Acc: 0.847 Test Loss: 0.833 Test Acc: 0.847
Validation loss decreased (-0.749987 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 0.6472549438476562
Epoch: 7, Steps: 7 | Train Loss: 0.547 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 0.6810121536254883
Epoch: 8, Steps: 7 | Train Loss: 0.254 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.6558444499969482
Epoch: 9, Steps: 7 | Train Loss: 0.129 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 0.8692820072174072
Epoch: 10, Steps: 7 | Train Loss: 0.052 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 0.7001996040344238
Epoch: 11, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 0.7311854362487793
Epoch: 12, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7253909111022949
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5323240756988525
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.645582914352417
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.6579828262329102
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.6487069129943848
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.7717194557189941
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 19 cost time: 0.6292648315429688
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6115801334381104
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5747442245483398
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6467206478118896
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.875 Test Loss: 0.272 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7684869766235352
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7103431224822998
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7608363628387451
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7550289630889893
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7264368534088135
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7294182777404785
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 38052108
model size : 159.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps133_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3881359100341797
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.366 Vali Acc: 0.292 Test Loss: 2.366 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 0.9911587238311768
Epoch: 2, Steps: 7 | Train Loss: 2.244 Vali Loss: 1.996 Vali Acc: 0.500 Test Loss: 1.996 Test Acc: 0.500
Validation loss decreased (-0.291643 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 0.8277950286865234
Epoch: 3, Steps: 7 | Train Loss: 1.824 Vali Loss: 1.486 Vali Acc: 0.764 Test Loss: 1.486 Test Acc: 0.764
Validation loss decreased (-0.499980 --> -0.763874).  Saving model ...
Epoch: 4 cost time: 0.9421212673187256
Epoch: 4, Steps: 7 | Train Loss: 1.208 Vali Loss: 0.850 Vali Acc: 0.847 Test Loss: 0.850 Test Acc: 0.847
Validation loss decreased (-0.763874 --> -0.847214).  Saving model ...
Epoch: 5 cost time: 0.9263558387756348
Epoch: 5, Steps: 7 | Train Loss: 0.531 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.030318260192871
Epoch: 6, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.362 Vali Acc: 0.917 Test Loss: 0.362 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.9834308624267578
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7628998756408691
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.8864381313323975
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.8678555488586426
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 0.5696673393249512
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 0.8332316875457764
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.917 Test Loss: 0.163 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8605854511260986
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.917 Test Loss: 0.171 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8189730644226074
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8347771167755127
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8516936302185059
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2558212280273438
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1709368228912354
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9309234619140625
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0596022605895996
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6321451663970947
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps133_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 38479116
model size : 161.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps133_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.258086681365967
Epoch: 1, Steps: 7 | Train Loss: 2.616 Vali Loss: 2.445 Vali Acc: 0.097 Test Loss: 2.445 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.5212817192077637
Epoch: 2, Steps: 7 | Train Loss: 2.383 Vali Loss: 2.173 Vali Acc: 0.417 Test Loss: 2.173 Test Acc: 0.417
Validation loss decreased (-0.097198 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.6796703338623047
Epoch: 3, Steps: 7 | Train Loss: 2.101 Vali Loss: 1.882 Vali Acc: 0.583 Test Loss: 1.882 Test Acc: 0.583
Validation loss decreased (-0.416645 --> -0.583315).  Saving model ...
Epoch: 4 cost time: 0.6066975593566895
Epoch: 4, Steps: 7 | Train Loss: 1.716 Vali Loss: 1.481 Vali Acc: 0.764 Test Loss: 1.481 Test Acc: 0.764
Validation loss decreased (-0.583315 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 0.5535528659820557
Epoch: 5, Steps: 7 | Train Loss: 1.200 Vali Loss: 0.915 Vali Acc: 0.847 Test Loss: 0.915 Test Acc: 0.847
Validation loss decreased (-0.763874 --> -0.847213).  Saving model ...
Epoch: 6 cost time: 0.6764817237854004
Epoch: 6, Steps: 7 | Train Loss: 0.656 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
Validation loss decreased (-0.847213 --> -0.861105).  Saving model ...
Epoch: 7 cost time: 0.908703088760376
Epoch: 7, Steps: 7 | Train Loss: 0.313 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.861105 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.8285582065582275
Epoch: 8, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8142023086547852
Epoch: 9, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9579305648803711
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.7569291591644287
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.092085599899292
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.011723518371582
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8180301189422607
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8705551624298096
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.089738130569458
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6579408645629883
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5379495620727539
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7506499290466309
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5142438411712646
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.80816650390625
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.837470293045044
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.903 Test Loss: 0.247 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps133_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 38307084
model size : 160.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps133_str133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0852224826812744
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.486 Vali Acc: 0.097 Test Loss: 2.486 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5619616508483887
Epoch: 2, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.239 Vali Acc: 0.444 Test Loss: 2.239 Test Acc: 0.444
Validation loss decreased (-0.097197 --> -0.444422).  Saving model ...
Epoch: 3 cost time: 0.6769280433654785
Epoch: 3, Steps: 7 | Train Loss: 2.133 Vali Loss: 1.992 Vali Acc: 0.583 Test Loss: 1.992 Test Acc: 0.583
Validation loss decreased (-0.444422 --> -0.583313).  Saving model ...
Epoch: 4 cost time: 0.5279316902160645
Epoch: 4, Steps: 7 | Train Loss: 1.785 Vali Loss: 1.670 Vali Acc: 0.708 Test Loss: 1.670 Test Acc: 0.708
Validation loss decreased (-0.583313 --> -0.708317).  Saving model ...
Epoch: 5 cost time: 0.6749730110168457
Epoch: 5, Steps: 7 | Train Loss: 1.365 Vali Loss: 1.174 Vali Acc: 0.847 Test Loss: 1.174 Test Acc: 0.847
Validation loss decreased (-0.708317 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 0.5967147350311279
Epoch: 6, Steps: 7 | Train Loss: 0.858 Vali Loss: 0.715 Vali Acc: 0.861 Test Loss: 0.715 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.6611659526824951
Epoch: 7, Steps: 7 | Train Loss: 0.447 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.6433076858520508
Epoch: 8, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.5306692123413086
Epoch: 9, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.346 Vali Acc: 0.903 Test Loss: 0.346 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.6276497840881348
Epoch: 10, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.624589204788208
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5902285575866699
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902776).  Saving model ...
Epoch: 13 cost time: 0.7345094680786133
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.903 Test Loss: 0.197 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 14 cost time: 0.5623533725738525
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916665).  Saving model ...
Epoch: 15 cost time: 0.6205770969390869
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6722109317779541
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8374443054199219
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6049654483795166
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.917 Test Loss: 0.184 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6678574085235596
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 0.6124627590179443
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6000938415527344
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.903 Test Loss: 0.178 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5655627250671387
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7245280742645264
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.903 Test Loss: 0.201 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6681180000305176
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.903 Test Loss: 0.181 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5686187744140625
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.917 Test Loss: 0.173 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6940822601318359
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.6853921413421631
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.6102921962738037
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6572132110595703
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.698991060256958
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6012136936187744
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.576063871383667
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6301174163818359
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6308948993682861
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5988297462463379
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5440905094146729
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.931 Test Loss: 0.166 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6649684906005859
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps133_str133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 38231820
model size : 160.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.651024580001831
Epoch: 1, Steps: 7 | Train Loss: 2.585 Vali Loss: 2.376 Vali Acc: 0.167 Test Loss: 2.376 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.9110002517700195
Epoch: 2, Steps: 7 | Train Loss: 2.297 Vali Loss: 2.046 Vali Acc: 0.681 Test Loss: 2.046 Test Acc: 0.681
Validation loss decreased (-0.166643 --> -0.680535).  Saving model ...
Epoch: 3 cost time: 0.9579026699066162
Epoch: 3, Steps: 7 | Train Loss: 1.870 Vali Loss: 1.625 Vali Acc: 0.750 Test Loss: 1.625 Test Acc: 0.750
Validation loss decreased (-0.680535 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 1.080843448638916
Epoch: 4, Steps: 7 | Train Loss: 1.299 Vali Loss: 0.996 Vali Acc: 0.833 Test Loss: 0.996 Test Acc: 0.833
Validation loss decreased (-0.749984 --> -0.833323).  Saving model ...
Epoch: 5 cost time: 1.1851983070373535
Epoch: 5, Steps: 7 | Train Loss: 0.576 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 0.9484896659851074
Epoch: 6, Steps: 7 | Train Loss: 0.180 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.7454164028167725
Epoch: 7, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.8736851215362549
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.006087064743042
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.8868191242218018
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9506971836090088
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.0993375778198242
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.1361877918243408
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2105762958526611
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2409436702728271
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0515587329864502
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9114649295806885
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8995521068572998
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7690677642822266
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6680397987365723
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.153003215789795
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8388285636901855
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 38671116
model size : 162.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2823688983917236
Epoch: 1, Steps: 7 | Train Loss: 2.593 Vali Loss: 2.489 Vali Acc: 0.069 Test Loss: 2.489 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.8345515727996826
Epoch: 2, Steps: 7 | Train Loss: 2.391 Vali Loss: 2.258 Vali Acc: 0.347 Test Loss: 2.258 Test Acc: 0.347
Validation loss decreased (-0.069420 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.8161497116088867
Epoch: 3, Steps: 7 | Train Loss: 2.045 Vali Loss: 1.912 Vali Acc: 0.653 Test Loss: 1.912 Test Acc: 0.653
Validation loss decreased (-0.347200 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.6076633930206299
Epoch: 4, Steps: 7 | Train Loss: 1.616 Vali Loss: 1.419 Vali Acc: 0.819 Test Loss: 1.419 Test Acc: 0.819
Validation loss decreased (-0.652759 --> -0.819430).  Saving model ...
Epoch: 5 cost time: 0.9151265621185303
Epoch: 5, Steps: 7 | Train Loss: 0.987 Vali Loss: 0.847 Vali Acc: 0.806 Test Loss: 0.847 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7749152183532715
Epoch: 6, Steps: 7 | Train Loss: 0.507 Vali Loss: 0.514 Vali Acc: 0.847 Test Loss: 0.514 Test Acc: 0.847
Validation loss decreased (-0.819430 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 0.7150352001190186
Epoch: 7, Steps: 7 | Train Loss: 0.201 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.7535004615783691
Epoch: 8, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.388 Vali Acc: 0.847 Test Loss: 0.388 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.824120283126831
Epoch: 9, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 0.9867949485778809
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8387110233306885
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.861108 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.8832988739013672
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.9883673191070557
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7801744937896729
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7328064441680908
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8075125217437744
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.861 Test Loss: 0.352 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.865642786026001
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6982855796813965
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8472542762756348
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8995151519775391
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.947500467300415
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8041830062866211
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 38520588
model size : 161.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2568657398223877
Epoch: 1, Steps: 7 | Train Loss: 2.659 Vali Loss: 2.515 Vali Acc: 0.097 Test Loss: 2.515 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.598106861114502
Epoch: 2, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.268 Vali Acc: 0.375 Test Loss: 2.268 Test Acc: 0.375
Validation loss decreased (-0.097197 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.6445209980010986
Epoch: 3, Steps: 7 | Train Loss: 2.151 Vali Loss: 1.988 Vali Acc: 0.556 Test Loss: 1.988 Test Acc: 0.556
Validation loss decreased (-0.374977 --> -0.555536).  Saving model ...
Epoch: 4 cost time: 0.7457714080810547
Epoch: 4, Steps: 7 | Train Loss: 1.777 Vali Loss: 1.636 Vali Acc: 0.722 Test Loss: 1.636 Test Acc: 0.722
Validation loss decreased (-0.555536 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 0.6934118270874023
Epoch: 5, Steps: 7 | Train Loss: 1.362 Vali Loss: 1.186 Vali Acc: 0.847 Test Loss: 1.186 Test Acc: 0.847
Validation loss decreased (-0.722206 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 0.6621813774108887
Epoch: 6, Steps: 7 | Train Loss: 0.864 Vali Loss: 0.827 Vali Acc: 0.861 Test Loss: 0.827 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.6851024627685547
Epoch: 7, Steps: 7 | Train Loss: 0.520 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.861103 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.7825970649719238
Epoch: 8, Steps: 7 | Train Loss: 0.252 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7501430511474609
Epoch: 9, Steps: 7 | Train Loss: 0.134 Vali Loss: 0.458 Vali Acc: 0.806 Test Loss: 0.458 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7326202392578125
Epoch: 10, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.358 Vali Acc: 0.861 Test Loss: 0.358 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 0.8021438121795654
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 0.7532634735107422
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.351 Vali Acc: 0.847 Test Loss: 0.351 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6551828384399414
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.371 Vali Acc: 0.847 Test Loss: 0.371 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.679462194442749
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.677687406539917
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6742284297943115
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.651231050491333
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5904428958892822
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.800701379776001
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6480565071105957
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7600953578948975
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 38445324
model size : 161.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps171_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5107061862945557
Epoch: 1, Steps: 7 | Train Loss: 2.645 Vali Loss: 2.418 Vali Acc: 0.222 Test Loss: 2.418 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.8102748394012451
Epoch: 2, Steps: 7 | Train Loss: 2.299 Vali Loss: 2.081 Vali Acc: 0.444 Test Loss: 2.081 Test Acc: 0.444
Validation loss decreased (-0.222198 --> -0.444424).  Saving model ...
Epoch: 3 cost time: 0.8233692646026611
Epoch: 3, Steps: 7 | Train Loss: 1.905 Vali Loss: 1.604 Vali Acc: 0.722 Test Loss: 1.604 Test Acc: 0.722
Validation loss decreased (-0.444424 --> -0.722206).  Saving model ...
Epoch: 4 cost time: 0.8224732875823975
Epoch: 4, Steps: 7 | Train Loss: 1.248 Vali Loss: 0.960 Vali Acc: 0.819 Test Loss: 0.960 Test Acc: 0.819
Validation loss decreased (-0.722206 --> -0.819435).  Saving model ...
Epoch: 5 cost time: 0.9953746795654297
Epoch: 5, Steps: 7 | Train Loss: 0.600 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
Validation loss decreased (-0.819435 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 0.9155423641204834
Epoch: 6, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
Validation loss decreased (-0.819438 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 0.9842147827148438
Epoch: 7, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 1.0278260707855225
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.858177661895752
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.9162929058074951
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0104999542236328
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.8151423931121826
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.7994499206542969
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.903 Test Loss: 0.342 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 14 cost time: 0.8556506633758545
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 15 cost time: 1.0521035194396973
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 16 cost time: 0.9485921859741211
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 17 cost time: 1.0619838237762451
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 1.0167899131774902
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.7772271633148193
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.751129150390625
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.7834756374359131
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.6905910968780518
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.9814481735229492
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8469808101654053
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0057499408721924
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8933796882629395
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9421606063842773
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0943682193756104
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1154663562774658
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8855955600738525
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2185330390930176
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 1.0828945636749268
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2035696506500244
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7833542823791504
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9984493255615234
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8271427154541016
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 37 cost time: 0.9032495021820068
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 1.1210947036743164
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8067786693572998
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9487106800079346
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.217463493347168
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9763927459716797
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 43 cost time: 1.0956830978393555
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.931 Test Loss: 0.302 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 44 cost time: 0.9152309894561768
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.7106199264526367
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.935230016708374
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.8193166255950928
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 48 cost time: 0.762214183807373
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.9445493221282959
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.864769697189331
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps171_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 38918412
model size : 163.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps171_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0563764572143555
Epoch: 1, Steps: 7 | Train Loss: 2.657 Vali Loss: 2.488 Vali Acc: 0.139 Test Loss: 2.488 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.542062520980835
Epoch: 2, Steps: 7 | Train Loss: 2.423 Vali Loss: 2.240 Vali Acc: 0.458 Test Loss: 2.240 Test Acc: 0.458
Validation loss decreased (-0.138864 --> -0.458311).  Saving model ...
Epoch: 3 cost time: 0.6887798309326172
Epoch: 3, Steps: 7 | Train Loss: 2.067 Vali Loss: 1.928 Vali Acc: 0.639 Test Loss: 1.928 Test Acc: 0.639
Validation loss decreased (-0.458311 --> -0.638870).  Saving model ...
Epoch: 4 cost time: 0.6040775775909424
Epoch: 4, Steps: 7 | Train Loss: 1.641 Vali Loss: 1.492 Vali Acc: 0.708 Test Loss: 1.492 Test Acc: 0.708
Validation loss decreased (-0.638870 --> -0.708318).  Saving model ...
Epoch: 5 cost time: 0.6853458881378174
Epoch: 5, Steps: 7 | Train Loss: 1.081 Vali Loss: 1.009 Vali Acc: 0.806 Test Loss: 1.009 Test Acc: 0.806
Validation loss decreased (-0.708318 --> -0.805545).  Saving model ...
Epoch: 6 cost time: 0.6375777721405029
Epoch: 6, Steps: 7 | Train Loss: 0.563 Vali Loss: 0.647 Vali Acc: 0.819 Test Loss: 0.647 Test Acc: 0.819
Validation loss decreased (-0.805545 --> -0.819438).  Saving model ...
Epoch: 7 cost time: 0.7670421600341797
Epoch: 7, Steps: 7 | Train Loss: 0.257 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.819438 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.58514404296875
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.5857870578765869
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6837611198425293
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8288149833679199
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7497029304504395
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7213582992553711
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6887621879577637
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8243639469146729
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.6309905052185059
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.6597809791564941
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.5528900623321533
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5453574657440186
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7431461811065674
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.668388843536377
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6116006374359131
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6942832469940186
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6761984825134277
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5210592746734619
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5133626461029053
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.5848574638366699
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.6245245933532715
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.7678942680358887
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.6318378448486328
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.6625704765319824
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.5094878673553467
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.49425697326660156
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5111064910888672
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.48662233352661133
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.7483134269714355
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.723829984664917
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.5651965141296387
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4830961227416992
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5586915016174316
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7486605644226074
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8365702629089355
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6414318084716797
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6029272079467773
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6074838638305664
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5693278312683105
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7311093807220459
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps171_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 38789388
model size : 162.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps171_str171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1405067443847656
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.533 Vali Acc: 0.139 Test Loss: 2.533 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.6015586853027344
Epoch: 2, Steps: 7 | Train Loss: 2.397 Vali Loss: 2.195 Vali Acc: 0.375 Test Loss: 2.195 Test Acc: 0.375
Validation loss decreased (-0.138864 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.7221322059631348
Epoch: 3, Steps: 7 | Train Loss: 2.039 Vali Loss: 1.840 Vali Acc: 0.625 Test Loss: 1.840 Test Acc: 0.625
Validation loss decreased (-0.374978 --> -0.624982).  Saving model ...
Epoch: 4 cost time: 0.606886625289917
Epoch: 4, Steps: 7 | Train Loss: 1.680 Vali Loss: 1.526 Vali Acc: 0.708 Test Loss: 1.526 Test Acc: 0.708
Validation loss decreased (-0.624982 --> -0.708318).  Saving model ...
Epoch: 5 cost time: 0.5774307250976562
Epoch: 5, Steps: 7 | Train Loss: 1.282 Vali Loss: 1.139 Vali Acc: 0.819 Test Loss: 1.139 Test Acc: 0.819
Validation loss decreased (-0.708318 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 0.7079429626464844
Epoch: 6, Steps: 7 | Train Loss: 0.811 Vali Loss: 0.775 Vali Acc: 0.792 Test Loss: 0.775 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7351691722869873
Epoch: 7, Steps: 7 | Train Loss: 0.430 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.819433 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 0.6857266426086426
Epoch: 8, Steps: 7 | Train Loss: 0.198 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 0.7410879135131836
Epoch: 9, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.420 Vali Acc: 0.861 Test Loss: 0.420 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 0.7115988731384277
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.8385219573974609
Epoch: 11, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.7608284950256348
Epoch: 12, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.6806426048278809
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7541513442993164
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.6795718669891357
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8034236431121826
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8923783302307129
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7436048984527588
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.854428768157959
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7284786701202393
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7079567909240723
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7521698474884033
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8076329231262207
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6778206825256348
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps171_str171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 38735628
model size : 162.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.436084032058716
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.472 Vali Acc: 0.194 Test Loss: 2.472 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.6930818557739258
Epoch: 2, Steps: 7 | Train Loss: 2.356 Vali Loss: 2.023 Vali Acc: 0.556 Test Loss: 2.023 Test Acc: 0.556
Validation loss decreased (-0.194420 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 0.7945606708526611
Epoch: 3, Steps: 7 | Train Loss: 1.763 Vali Loss: 1.513 Vali Acc: 0.653 Test Loss: 1.513 Test Acc: 0.653
Validation loss decreased (-0.555535 --> -0.652763).  Saving model ...
Epoch: 4 cost time: 0.7739012241363525
Epoch: 4, Steps: 7 | Train Loss: 1.173 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
Validation loss decreased (-0.652763 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 0.5622634887695312
Epoch: 5, Steps: 7 | Train Loss: 0.562 Vali Loss: 0.582 Vali Acc: 0.847 Test Loss: 0.582 Test Acc: 0.847
Validation loss decreased (-0.749990 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.750037431716919
Epoch: 6, Steps: 7 | Train Loss: 0.206 Vali Loss: 0.457 Vali Acc: 0.819 Test Loss: 0.457 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6197507381439209
Epoch: 7, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.8067154884338379
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.0886108875274658
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 1.0113003253936768
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.00789475440979
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8077194690704346
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9435815811157227
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9974532127380371
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.127274513244629
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8877131938934326
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9399163722991943
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.908832311630249
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9155287742614746
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 39276300
model size : 164.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.148343324661255
Epoch: 1, Steps: 7 | Train Loss: 2.728 Vali Loss: 2.577 Vali Acc: 0.181 Test Loss: 2.577 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 0.6824719905853271
Epoch: 2, Steps: 7 | Train Loss: 2.412 Vali Loss: 2.198 Vali Acc: 0.417 Test Loss: 2.198 Test Acc: 0.417
Validation loss decreased (-0.180530 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.8215034008026123
Epoch: 3, Steps: 7 | Train Loss: 2.004 Vali Loss: 1.862 Vali Acc: 0.653 Test Loss: 1.862 Test Acc: 0.653
Validation loss decreased (-0.416645 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.8445017337799072
Epoch: 4, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.432 Vali Acc: 0.778 Test Loss: 1.432 Test Acc: 0.778
Validation loss decreased (-0.652759 --> -0.777763).  Saving model ...
Epoch: 5 cost time: 0.7705578804016113
Epoch: 5, Steps: 7 | Train Loss: 1.139 Vali Loss: 0.958 Vali Acc: 0.819 Test Loss: 0.958 Test Acc: 0.819
Validation loss decreased (-0.777763 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 0.6890575885772705
Epoch: 6, Steps: 7 | Train Loss: 0.613 Vali Loss: 0.648 Vali Acc: 0.819 Test Loss: 0.648 Test Acc: 0.819
Validation loss decreased (-0.819435 --> -0.819438).  Saving model ...
Epoch: 7 cost time: 0.7868475914001465
Epoch: 7, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.399 Vali Acc: 0.931 Test Loss: 0.399 Test Acc: 0.931
Validation loss decreased (-0.819438 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.7907483577728271
Epoch: 8, Steps: 7 | Train Loss: 0.109 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7068936824798584
Epoch: 9, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7121849060058594
Epoch: 10, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.6732966899871826
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5862538814544678
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6392543315887451
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
Validation loss decreased (-0.944442 --> -0.972221).  Saving model ...
Epoch: 14 cost time: 0.8573081493377686
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 15 cost time: 0.9123516082763672
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8742904663085938
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7730429172515869
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7836894989013672
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9604144096374512
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9370036125183105
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6531908512115479
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8525121212005615
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6792798042297363
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6883535385131836
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 39168780
model size : 164.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9425654411315918
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.430 Vali Acc: 0.069 Test Loss: 2.430 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.7397670745849609
Epoch: 2, Steps: 7 | Train Loss: 2.371 Vali Loss: 2.154 Vali Acc: 0.472 Test Loss: 2.154 Test Acc: 0.472
Validation loss decreased (-0.069420 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 0.6320455074310303
Epoch: 3, Steps: 7 | Train Loss: 2.029 Vali Loss: 1.843 Vali Acc: 0.736 Test Loss: 1.843 Test Acc: 0.736
Validation loss decreased (-0.472201 --> -0.736093).  Saving model ...
Epoch: 4 cost time: 0.5786058902740479
Epoch: 4, Steps: 7 | Train Loss: 1.627 Vali Loss: 1.465 Vali Acc: 0.792 Test Loss: 1.465 Test Acc: 0.792
Validation loss decreased (-0.736093 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.6917433738708496
Epoch: 5, Steps: 7 | Train Loss: 1.207 Vali Loss: 1.028 Vali Acc: 0.833 Test Loss: 1.028 Test Acc: 0.833
Validation loss decreased (-0.791652 --> -0.833323).  Saving model ...
Epoch: 6 cost time: 0.5843038558959961
Epoch: 6, Steps: 7 | Train Loss: 0.750 Vali Loss: 0.712 Vali Acc: 0.889 Test Loss: 0.712 Test Acc: 0.889
Validation loss decreased (-0.833323 --> -0.888882).  Saving model ...
Epoch: 7 cost time: 0.7211644649505615
Epoch: 7, Steps: 7 | Train Loss: 0.417 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.8100109100341797
Epoch: 8, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6580643653869629
Epoch: 9, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7364044189453125
Epoch: 10, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6546165943145752
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6252570152282715
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.766157865524292
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.7370264530181885
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7549552917480469
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7402112483978271
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6590251922607422
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.5605325698852539
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7199428081512451
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.5729873180389404
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 0.5685009956359863
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5546858310699463
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7754807472229004
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.6662299633026123
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.8286223411560059
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 26 cost time: 0.6612768173217773
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 0.7537796497344971
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6221590042114258
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6863558292388916
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8126945495605469
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.889 Test Loss: 0.301 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7690327167510986
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6454763412475586
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.889 Test Loss: 0.311 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6174101829528809
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6991217136383057
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7025504112243652
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7742152214050293
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 37 cost time: 0.6779770851135254
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 38 cost time: 0.7620835304260254
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7084534168243408
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6909217834472656
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5836455821990967
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6122608184814453
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.625450611114502
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6472876071929932
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7199318408966064
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6170036792755127
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6623926162719727
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 39115020
model size : 163.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps240_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1558837890625
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.389 Vali Acc: 0.208 Test Loss: 2.389 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.6792495250701904
Epoch: 2, Steps: 7 | Train Loss: 2.282 Vali Loss: 1.967 Vali Acc: 0.653 Test Loss: 1.967 Test Acc: 0.653
Validation loss decreased (-0.208309 --> -0.652758).  Saving model ...
Epoch: 3 cost time: 0.9981014728546143
Epoch: 3, Steps: 7 | Train Loss: 1.789 Vali Loss: 1.344 Vali Acc: 0.722 Test Loss: 1.344 Test Acc: 0.722
Validation loss decreased (-0.652758 --> -0.722209).  Saving model ...
Epoch: 4 cost time: 0.9033310413360596
Epoch: 4, Steps: 7 | Train Loss: 1.118 Vali Loss: 0.834 Vali Acc: 0.847 Test Loss: 0.834 Test Acc: 0.847
Validation loss decreased (-0.722209 --> -0.847214).  Saving model ...
Epoch: 5 cost time: 1.1589596271514893
Epoch: 5, Steps: 7 | Train Loss: 0.556 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.8620874881744385
Epoch: 6, Steps: 7 | Train Loss: 0.187 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.7925395965576172
Epoch: 7, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 1.0602219104766846
Epoch: 8, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.203927993774414
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.8503830432891846
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.7186939716339111
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 0.8748431205749512
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1779966354370117
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8652973175048828
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7437872886657715
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9837849140167236
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7620260715484619
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7517192363739014
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0814599990844727
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8326609134674072
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9965636730194092
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps240_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 39786252
model size : 166.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1810216903686523
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.523 Vali Acc: 0.083 Test Loss: 2.523 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.7705821990966797
Epoch: 2, Steps: 7 | Train Loss: 2.362 Vali Loss: 2.174 Vali Acc: 0.431 Test Loss: 2.174 Test Acc: 0.431
Validation loss decreased (-0.083308 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.6664266586303711
Epoch: 3, Steps: 7 | Train Loss: 1.960 Vali Loss: 1.754 Vali Acc: 0.694 Test Loss: 1.754 Test Acc: 0.694
Validation loss decreased (-0.430534 --> -0.694427).  Saving model ...
Epoch: 4 cost time: 0.7969250679016113
Epoch: 4, Steps: 7 | Train Loss: 1.424 Vali Loss: 1.133 Vali Acc: 0.819 Test Loss: 1.133 Test Acc: 0.819
Validation loss decreased (-0.694427 --> -0.819433).  Saving model ...
Epoch: 5 cost time: 0.784632682800293
Epoch: 5, Steps: 7 | Train Loss: 0.862 Vali Loss: 0.728 Vali Acc: 0.889 Test Loss: 0.728 Test Acc: 0.889
Validation loss decreased (-0.819433 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 0.7453320026397705
Epoch: 6, Steps: 7 | Train Loss: 0.440 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.703035831451416
Epoch: 7, Steps: 7 | Train Loss: 0.179 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.7909085750579834
Epoch: 8, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.361 Vali Acc: 0.847 Test Loss: 0.361 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7029483318328857
Epoch: 9, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.660531759262085
Epoch: 10, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8159651756286621
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5573940277099609
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7478957176208496
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7108745574951172
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7483570575714111
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.875 Test Loss: 0.278 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5737841129302979
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5645227432250977
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.875 Test Loss: 0.272 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 39700236
model size : 166.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps240_str240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1680071353912354
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.509 Vali Acc: 0.125 Test Loss: 2.509 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.704430341720581
Epoch: 2, Steps: 7 | Train Loss: 2.417 Vali Loss: 2.230 Vali Acc: 0.319 Test Loss: 2.230 Test Acc: 0.319
Validation loss decreased (-0.124975 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 0.6548008918762207
Epoch: 3, Steps: 7 | Train Loss: 2.030 Vali Loss: 1.914 Vali Acc: 0.611 Test Loss: 1.914 Test Acc: 0.611
Validation loss decreased (-0.319422 --> -0.611092).  Saving model ...
Epoch: 4 cost time: 0.560683012008667
Epoch: 4, Steps: 7 | Train Loss: 1.645 Vali Loss: 1.583 Vali Acc: 0.681 Test Loss: 1.583 Test Acc: 0.681
Validation loss decreased (-0.611092 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 0.7860124111175537
Epoch: 5, Steps: 7 | Train Loss: 1.247 Vali Loss: 1.204 Vali Acc: 0.750 Test Loss: 1.204 Test Acc: 0.750
Validation loss decreased (-0.680540 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.6622323989868164
Epoch: 6, Steps: 7 | Train Loss: 0.806 Vali Loss: 0.871 Vali Acc: 0.778 Test Loss: 0.871 Test Acc: 0.778
Validation loss decreased (-0.749988 --> -0.777769).  Saving model ...
Epoch: 7 cost time: 0.8080556392669678
Epoch: 7, Steps: 7 | Train Loss: 0.467 Vali Loss: 0.682 Vali Acc: 0.792 Test Loss: 0.682 Test Acc: 0.792
Validation loss decreased (-0.777769 --> -0.791660).  Saving model ...
Epoch: 8 cost time: 0.6061773300170898
Epoch: 8, Steps: 7 | Train Loss: 0.213 Vali Loss: 0.531 Vali Acc: 0.806 Test Loss: 0.531 Test Acc: 0.806
Validation loss decreased (-0.791660 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 0.6737327575683594
Epoch: 9, Steps: 7 | Train Loss: 0.104 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.805550 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 0.5837373733520508
Epoch: 10, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.502 Vali Acc: 0.833 Test Loss: 0.502 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.573566198348999
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.465 Vali Acc: 0.833 Test Loss: 0.465 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.7254600524902344
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 0.6645932197570801
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.433 Vali Acc: 0.847 Test Loss: 0.433 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6514160633087158
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.438 Vali Acc: 0.847 Test Loss: 0.438 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6186504364013672
Epoch: 15, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7416462898254395
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.847 Test Loss: 0.440 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7296850681304932
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 0.6798708438873291
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.421 Vali Acc: 0.861 Test Loss: 0.421 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 0.8567187786102295
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7530176639556885
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7314648628234863
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.847 Test Loss: 0.458 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6922578811645508
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.847 Test Loss: 0.444 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6059069633483887
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.847 Test Loss: 0.436 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.791745662689209
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.847 Test Loss: 0.432 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6743912696838379
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.437 Vali Acc: 0.847 Test Loss: 0.437 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6768708229064941
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.847 Test Loss: 0.433 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6173765659332275
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.847 Test Loss: 0.434 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6700036525726318
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.861 Test Loss: 0.435 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el5_dm768_df768_ps240_str240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 39657228
model size : 165.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8438055515289307
Epoch: 1, Steps: 7 | Train Loss: 2.609 Vali Loss: 2.338 Vali Acc: 0.250 Test Loss: 2.338 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 1.2625908851623535
Epoch: 2, Steps: 7 | Train Loss: 2.168 Vali Loss: 1.644 Vali Acc: 0.667 Test Loss: 1.644 Test Acc: 0.667
Validation loss decreased (-0.249977 --> -0.666650).  Saving model ...
Epoch: 3 cost time: 1.185741901397705
Epoch: 3, Steps: 7 | Train Loss: 1.271 Vali Loss: 0.805 Vali Acc: 0.819 Test Loss: 0.805 Test Acc: 0.819
Validation loss decreased (-0.666650 --> -0.819436).  Saving model ...
Epoch: 4 cost time: 1.2411909103393555
Epoch: 4, Steps: 7 | Train Loss: 0.464 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
Validation loss decreased (-0.819436 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 1.4074780941009521
Epoch: 5, Steps: 7 | Train Loss: 0.359 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 1.151829719543457
Epoch: 6, Steps: 7 | Train Loss: 0.088 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 1.1377043724060059
Epoch: 7, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.3700072765350342
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.917 Test Loss: 0.439 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 1.0870964527130127
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.889 Test Loss: 0.680 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0650837421417236
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.917 Test Loss: 0.477 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0270960330963135
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 1.3206987380981445
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4764039516448975
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3514957427978516
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.931 Test Loss: 0.493 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4689407348632812
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.917 Test Loss: 0.475 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3327882289886475
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.903 Test Loss: 0.461 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2076425552368164
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.931 Test Loss: 0.421 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3602325916290283
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.931 Test Loss: 0.359 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 1.2493209838867188
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.931 Test Loss: 0.327 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 20 cost time: 1.0523886680603027
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 21 cost time: 1.4145188331604004
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 22 cost time: 1.5434792041778564
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 1.1220812797546387
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.304 Vali Acc: 0.931 Test Loss: 0.304 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.434737205505371
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2414867877960205
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2135393619537354
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1209564208984375
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1168558597564697
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3496782779693604
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1661734580993652
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.931 Test Loss: 0.313 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.206162452697754
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1510255336761475
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30904332
model size : 132.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3556315898895264
Epoch: 1, Steps: 7 | Train Loss: 2.592 Vali Loss: 2.396 Vali Acc: 0.264 Test Loss: 2.396 Test Acc: 0.264
Validation loss decreased (inf --> -0.263865).  Saving model ...
Epoch: 2 cost time: 0.7417130470275879
Epoch: 2, Steps: 7 | Train Loss: 2.313 Vali Loss: 2.085 Vali Acc: 0.472 Test Loss: 2.085 Test Acc: 0.472
Validation loss decreased (-0.263865 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 0.6420400142669678
Epoch: 3, Steps: 7 | Train Loss: 1.684 Vali Loss: 1.348 Vali Acc: 0.750 Test Loss: 1.348 Test Acc: 0.750
Validation loss decreased (-0.472201 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 1.0952990055084229
Epoch: 4, Steps: 7 | Train Loss: 1.037 Vali Loss: 0.696 Vali Acc: 0.875 Test Loss: 0.696 Test Acc: 0.875
Validation loss decreased (-0.749987 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 1.160728931427002
Epoch: 5, Steps: 7 | Train Loss: 0.413 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1448485851287842
Epoch: 6, Steps: 7 | Train Loss: 0.181 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0095453262329102
Epoch: 7, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.0947551727294922
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0446481704711914
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.407 Vali Acc: 0.903 Test Loss: 0.407 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 1.10506010055542
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 1.4250907897949219
Epoch: 11, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.916663 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.1249358654022217
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3933701515197754
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.035451889038086
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0174753665924072
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.032088279724121
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7826509475708008
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7538857460021973
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.931 Test Loss: 0.266 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0370616912841797
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6847653388977051
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2637372016906738
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30388236
model size : 130.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.626406669616699
Epoch: 1, Steps: 7 | Train Loss: 2.641 Vali Loss: 2.515 Vali Acc: 0.111 Test Loss: 2.515 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 1.2357606887817383
Epoch: 2, Steps: 7 | Train Loss: 2.367 Vali Loss: 2.205 Vali Acc: 0.306 Test Loss: 2.205 Test Acc: 0.306
Validation loss decreased (-0.111086 --> -0.305534).  Saving model ...
Epoch: 3 cost time: 0.9887242317199707
Epoch: 3, Steps: 7 | Train Loss: 2.031 Vali Loss: 1.787 Vali Acc: 0.625 Test Loss: 1.787 Test Acc: 0.625
Validation loss decreased (-0.305534 --> -0.624982).  Saving model ...
Epoch: 4 cost time: 1.205610752105713
Epoch: 4, Steps: 7 | Train Loss: 1.527 Vali Loss: 1.246 Vali Acc: 0.833 Test Loss: 1.246 Test Acc: 0.833
Validation loss decreased (-0.624982 --> -0.833321).  Saving model ...
Epoch: 5 cost time: 1.26114821434021
Epoch: 5, Steps: 7 | Train Loss: 0.947 Vali Loss: 0.748 Vali Acc: 0.806 Test Loss: 0.748 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0635039806365967
Epoch: 6, Steps: 7 | Train Loss: 0.493 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
Validation loss decreased (-0.833321 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.7650938034057617
Epoch: 7, Steps: 7 | Train Loss: 0.229 Vali Loss: 0.424 Vali Acc: 0.861 Test Loss: 0.424 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 1.2039332389831543
Epoch: 8, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 1.0404317378997803
Epoch: 9, Steps: 7 | Train Loss: 0.051 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.2142822742462158
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.9527642726898193
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.137352466583252
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9995231628417969
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1008036136627197
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9834215641021729
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.48369860649108887
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.9677276611328125
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.2362258434295654
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.848945140838623
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.042468786239624
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 21 cost time: 0.9162106513977051
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 1.2626967430114746
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 1.1612205505371094
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 0.9676952362060547
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 1.1909904479980469
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0909879207611084
Epoch: 26, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2115960121154785
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.124910593032837
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1407034397125244
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 1.2265980243682861
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 1.1785991191864014
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 32 cost time: 1.2489261627197266
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 33 cost time: 0.9170689582824707
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 0.8591561317443848
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9887452125549316
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9232833385467529
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0171327590942383
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8003330230712891
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0427048206329346
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1797642707824707
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 41 cost time: 1.0005271434783936
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 42 cost time: 1.0058627128601074
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 43 cost time: 0.8388552665710449
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.9809324741363525
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7538683414459229
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0390150547027588
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1705174446105957
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1412534713745117
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2108030319213867
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2033352851867676
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30130188
model size : 129.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8125364780426025
Epoch: 1, Steps: 7 | Train Loss: 2.588 Vali Loss: 2.359 Vali Acc: 0.139 Test Loss: 2.359 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.3155837059020996
Epoch: 2, Steps: 7 | Train Loss: 2.218 Vali Loss: 1.803 Vali Acc: 0.444 Test Loss: 1.803 Test Acc: 0.444
Validation loss decreased (-0.138865 --> -0.444426).  Saving model ...
Epoch: 3 cost time: 1.2559123039245605
Epoch: 3, Steps: 7 | Train Loss: 1.455 Vali Loss: 1.155 Vali Acc: 0.806 Test Loss: 1.155 Test Acc: 0.806
Validation loss decreased (-0.444426 --> -0.805544).  Saving model ...
Epoch: 4 cost time: 1.5759646892547607
Epoch: 4, Steps: 7 | Train Loss: 0.678 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
Validation loss decreased (-0.805544 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 1.3735363483428955
Epoch: 5, Steps: 7 | Train Loss: 0.219 Vali Loss: 0.419 Vali Acc: 0.875 Test Loss: 0.419 Test Acc: 0.875
Validation loss decreased (-0.833327 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.4252026081085205
Epoch: 6, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.448 Vali Acc: 0.861 Test Loss: 0.448 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.539275884628296
Epoch: 7, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.411 Vali Acc: 0.917 Test Loss: 0.411 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 1.559185266494751
Epoch: 8, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5487685203552246
Epoch: 9, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.331132411956787
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.903 Test Loss: 0.496 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4424686431884766
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4500627517700195
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.917 Test Loss: 0.542 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5209686756134033
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.917 Test Loss: 0.492 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4513182640075684
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.917 Test Loss: 0.447 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.399916648864746
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.903 Test Loss: 0.413 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3539214134216309
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.931 Test Loss: 0.396 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 17 cost time: 1.6853220462799072
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 1.489616870880127
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.931 Test Loss: 0.379 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 19 cost time: 1.2430040836334229
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.917 Test Loss: 0.375 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2028536796569824
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2797191143035889
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.917 Test Loss: 0.372 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.558335781097412
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2940936088562012
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.231248378753662
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.679772138595581
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6020832061767578
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4297189712524414
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6471903324127197
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30856716
model size : 132.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.1334996223449707
Epoch: 1, Steps: 7 | Train Loss: 2.670 Vali Loss: 2.448 Vali Acc: 0.125 Test Loss: 2.448 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.149724006652832
Epoch: 2, Steps: 7 | Train Loss: 2.368 Vali Loss: 2.075 Vali Acc: 0.306 Test Loss: 2.075 Test Acc: 0.306
Validation loss decreased (-0.124976 --> -0.305535).  Saving model ...
Epoch: 3 cost time: 1.2846438884735107
Epoch: 3, Steps: 7 | Train Loss: 1.936 Vali Loss: 1.590 Vali Acc: 0.694 Test Loss: 1.590 Test Acc: 0.694
Validation loss decreased (-0.305535 --> -0.694429).  Saving model ...
Epoch: 4 cost time: 1.3694183826446533
Epoch: 4, Steps: 7 | Train Loss: 1.288 Vali Loss: 1.084 Vali Acc: 0.833 Test Loss: 1.084 Test Acc: 0.833
Validation loss decreased (-0.694429 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 1.2077178955078125
Epoch: 5, Steps: 7 | Train Loss: 0.628 Vali Loss: 0.535 Vali Acc: 0.889 Test Loss: 0.535 Test Acc: 0.889
Validation loss decreased (-0.833322 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 1.1733801364898682
Epoch: 6, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 1.1915485858917236
Epoch: 7, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 1.2354393005371094
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916662).  Saving model ...
Epoch: 9 cost time: 1.3240845203399658
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.664 Vali Acc: 0.903 Test Loss: 0.664 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3723649978637695
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3008372783660889
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.917 Test Loss: 0.398 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.2561297416687012
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.9262347221374512
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 1.3095088005065918
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.931 Test Loss: 0.323 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0120668411254883
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.931 Test Loss: 0.319 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1683661937713623
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.931 Test Loss: 0.324 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.117600440979004
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.931 Test Loss: 0.328 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9496293067932129
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1042695045471191
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9766807556152344
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.931 Test Loss: 0.332 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9317021369934082
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0750401020050049
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9237251281738281
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.931 Test Loss: 0.330 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30394380
model size : 130.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6122865676879883
Epoch: 1, Steps: 7 | Train Loss: 2.615 Vali Loss: 2.493 Vali Acc: 0.069 Test Loss: 2.493 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.9685928821563721
Epoch: 2, Steps: 7 | Train Loss: 2.433 Vali Loss: 2.270 Vali Acc: 0.264 Test Loss: 2.270 Test Acc: 0.264
Validation loss decreased (-0.069420 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.8342223167419434
Epoch: 3, Steps: 7 | Train Loss: 2.095 Vali Loss: 1.936 Vali Acc: 0.528 Test Loss: 1.936 Test Acc: 0.528
Validation loss decreased (-0.263866 --> -0.527758).  Saving model ...
Epoch: 4 cost time: 0.9208643436431885
Epoch: 4, Steps: 7 | Train Loss: 1.643 Vali Loss: 1.403 Vali Acc: 0.778 Test Loss: 1.403 Test Acc: 0.778
Validation loss decreased (-0.527758 --> -0.777764).  Saving model ...
Epoch: 5 cost time: 0.871351957321167
Epoch: 5, Steps: 7 | Train Loss: 1.079 Vali Loss: 0.870 Vali Acc: 0.819 Test Loss: 0.870 Test Acc: 0.819
Validation loss decreased (-0.777764 --> -0.819436).  Saving model ...
Epoch: 6 cost time: 1.0965149402618408
Epoch: 6, Steps: 7 | Train Loss: 0.605 Vali Loss: 0.551 Vali Acc: 0.847 Test Loss: 0.551 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 0.8913912773132324
Epoch: 7, Steps: 7 | Train Loss: 0.317 Vali Loss: 0.468 Vali Acc: 0.861 Test Loss: 0.468 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.7859804630279541
Epoch: 8, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7831103801727295
Epoch: 9, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.358 Vali Acc: 0.875 Test Loss: 0.358 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 1.0735750198364258
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9194164276123047
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.0657241344451904
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.1361234188079834
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.993945837020874
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8905575275421143
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9669663906097412
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9829177856445312
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0842602252960205
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9437975883483887
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0040946006774902
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0497276782989502
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1226937770843506
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 30147084
model size : 129.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6834537982940674
Epoch: 1, Steps: 7 | Train Loss: 2.679 Vali Loss: 2.417 Vali Acc: 0.125 Test Loss: 2.417 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.0319199562072754
Epoch: 2, Steps: 7 | Train Loss: 2.338 Vali Loss: 2.004 Vali Acc: 0.569 Test Loss: 2.004 Test Acc: 0.569
Validation loss decreased (-0.124976 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 1.1808416843414307
Epoch: 3, Steps: 7 | Train Loss: 1.603 Vali Loss: 1.313 Vali Acc: 0.597 Test Loss: 1.313 Test Acc: 0.597
Validation loss decreased (-0.569424 --> -0.597209).  Saving model ...
Epoch: 4 cost time: 1.3300449848175049
Epoch: 4, Steps: 7 | Train Loss: 0.834 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
Validation loss decreased (-0.597209 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 1.4685297012329102
Epoch: 5, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.4269640445709229
Epoch: 6, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 7 cost time: 1.2408602237701416
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4752390384674072
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3121764659881592
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.384 Vali Acc: 0.931 Test Loss: 0.384 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.1233999729156494
Epoch: 10, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.931 Test Loss: 0.533 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0583248138427734
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.931 Test Loss: 0.545 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9140987396240234
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.931 Test Loss: 0.489 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1830449104309082
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.931 Test Loss: 0.444 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1784272193908691
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.931 Test Loss: 0.423 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9722976684570312
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.931 Test Loss: 0.410 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.341548204421997
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.931 Test Loss: 0.401 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0787386894226074
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.931 Test Loss: 0.396 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.215116262435913
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.944 Test Loss: 0.391 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 1.0047943592071533
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.944 Test Loss: 0.385 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 1.261476993560791
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.931 Test Loss: 0.380 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0858988761901855
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.931 Test Loss: 0.378 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3068699836730957
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.931 Test Loss: 0.375 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4244236946105957
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.371 Vali Acc: 0.931 Test Loss: 0.371 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2629351615905762
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.931 Test Loss: 0.368 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1770625114440918
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.367 Vali Acc: 0.931 Test Loss: 0.367 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0755314826965332
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.931 Test Loss: 0.366 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.120842456817627
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.931 Test Loss: 0.362 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0337035655975342
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.931 Test Loss: 0.359 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1730666160583496
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30822924
model size : 132.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2093071937561035
Epoch: 1, Steps: 7 | Train Loss: 2.575 Vali Loss: 2.385 Vali Acc: 0.167 Test Loss: 2.385 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.0726134777069092
Epoch: 2, Steps: 7 | Train Loss: 2.296 Vali Loss: 2.095 Vali Acc: 0.444 Test Loss: 2.095 Test Acc: 0.444
Validation loss decreased (-0.166643 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.8124871253967285
Epoch: 3, Steps: 7 | Train Loss: 1.887 Vali Loss: 1.570 Vali Acc: 0.722 Test Loss: 1.570 Test Acc: 0.722
Validation loss decreased (-0.444423 --> -0.722207).  Saving model ...
Epoch: 4 cost time: 0.6695263385772705
Epoch: 4, Steps: 7 | Train Loss: 1.250 Vali Loss: 0.957 Vali Acc: 0.819 Test Loss: 0.957 Test Acc: 0.819
Validation loss decreased (-0.722207 --> -0.819435).  Saving model ...
Epoch: 5 cost time: 0.8853881359100342
Epoch: 5, Steps: 7 | Train Loss: 0.616 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
Validation loss decreased (-0.819435 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 1.3467388153076172
Epoch: 6, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.010176658630371
Epoch: 7, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.819880485534668
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7603561878204346
Epoch: 9, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1873149871826172
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.1543679237365723
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.200359582901001
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0629119873046875
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.908430814743042
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9142837524414062
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.903 Test Loss: 0.314 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.760051965713501
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6936917304992676
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.8060815334320068
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7958164215087891
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1783883571624756
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.096017837524414
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.072232961654663
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.893639087677002
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.081573486328125
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7825925350189209
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8119063377380371
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 27 cost time: 1.1896908283233643
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9952900409698486
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9399371147155762
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1600863933563232
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1028001308441162
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8971655368804932
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.19559907913208
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2094042301177979
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8443202972412109
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3066465854644775
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 30403596
model size : 130.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.442330837249756
Epoch: 1, Steps: 7 | Train Loss: 2.667 Vali Loss: 2.558 Vali Acc: 0.097 Test Loss: 2.558 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.8054659366607666
Epoch: 2, Steps: 7 | Train Loss: 2.468 Vali Loss: 2.236 Vali Acc: 0.264 Test Loss: 2.236 Test Acc: 0.264
Validation loss decreased (-0.097197 --> -0.263867).  Saving model ...
Epoch: 3 cost time: 0.9845986366271973
Epoch: 3, Steps: 7 | Train Loss: 2.074 Vali Loss: 1.924 Vali Acc: 0.569 Test Loss: 1.924 Test Acc: 0.569
Validation loss decreased (-0.263867 --> -0.569425).  Saving model ...
Epoch: 4 cost time: 0.8302288055419922
Epoch: 4, Steps: 7 | Train Loss: 1.678 Vali Loss: 1.570 Vali Acc: 0.736 Test Loss: 1.570 Test Acc: 0.736
Validation loss decreased (-0.569425 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 1.0093696117401123
Epoch: 5, Steps: 7 | Train Loss: 1.206 Vali Loss: 1.078 Vali Acc: 0.847 Test Loss: 1.078 Test Acc: 0.847
Validation loss decreased (-0.736095 --> -0.847211).  Saving model ...
Epoch: 6 cost time: 0.9999818801879883
Epoch: 6, Steps: 7 | Train Loss: 0.708 Vali Loss: 0.574 Vali Acc: 0.875 Test Loss: 0.574 Test Acc: 0.875
Validation loss decreased (-0.847211 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 0.8857355117797852
Epoch: 7, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.8091738224029541
Epoch: 8, Steps: 7 | Train Loss: 0.145 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.8605780601501465
Epoch: 9, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.0298917293548584
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0588440895080566
Epoch: 11, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 12 cost time: 1.0589115619659424
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 0.7188122272491455
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6058695316314697
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7860627174377441
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7881169319152832
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.817542552947998
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.917 Test Loss: 0.315 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.985476016998291
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8122551441192627
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7959034442901611
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6454672813415527
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8971982002258301
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9689359664916992
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8455536365509033
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0565011501312256
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8113415241241455
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8321046829223633
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 30177804
model size : 129.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4709300994873047
Epoch: 1, Steps: 7 | Train Loss: 2.725 Vali Loss: 2.404 Vali Acc: 0.167 Test Loss: 2.404 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.9562156200408936
Epoch: 2, Steps: 7 | Train Loss: 2.340 Vali Loss: 1.928 Vali Acc: 0.486 Test Loss: 1.928 Test Acc: 0.486
Validation loss decreased (-0.166643 --> -0.486092).  Saving model ...
Epoch: 3 cost time: 0.9301865100860596
Epoch: 3, Steps: 7 | Train Loss: 1.629 Vali Loss: 1.299 Vali Acc: 0.681 Test Loss: 1.299 Test Acc: 0.681
Validation loss decreased (-0.486092 --> -0.680543).  Saving model ...
Epoch: 4 cost time: 1.0291926860809326
Epoch: 4, Steps: 7 | Train Loss: 0.858 Vali Loss: 0.661 Vali Acc: 0.819 Test Loss: 0.661 Test Acc: 0.819
Validation loss decreased (-0.680543 --> -0.819438).  Saving model ...
Epoch: 5 cost time: 1.0780820846557617
Epoch: 5, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
Validation loss decreased (-0.819438 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 0.9713912010192871
Epoch: 6, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.440 Vali Acc: 0.847 Test Loss: 0.440 Test Acc: 0.847
Validation loss decreased (-0.833329 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 1.1163697242736816
Epoch: 7, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.585 Vali Acc: 0.847 Test Loss: 0.585 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0830836296081543
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.0932645797729492
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.889 Test Loss: 0.658 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888882).  Saving model ...
Epoch: 10 cost time: 0.9034934043884277
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.875 Test Loss: 0.779 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9420680999755859
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2995340824127197
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.903 Test Loss: 0.524 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902773).  Saving model ...
Epoch: 13 cost time: 0.8464710712432861
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.663 Vali Acc: 0.875 Test Loss: 0.663 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9233143329620361
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.861 Test Loss: 0.787 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8465480804443359
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.889 Test Loss: 0.629 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8372287750244141
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.903 Test Loss: 0.575 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8090240955352783
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.903 Test Loss: 0.554 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7477767467498779
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7500662803649902
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.903 Test Loss: 0.541 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7946083545684814
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.903 Test Loss: 0.540 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1521625518798828
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9014525413513184
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 30850572
model size : 132.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.274559259414673
Epoch: 1, Steps: 7 | Train Loss: 2.643 Vali Loss: 2.472 Vali Acc: 0.125 Test Loss: 2.472 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.6457641124725342
Epoch: 2, Steps: 7 | Train Loss: 2.393 Vali Loss: 2.126 Vali Acc: 0.431 Test Loss: 2.126 Test Acc: 0.431
Validation loss decreased (-0.124975 --> -0.430534).  Saving model ...
Epoch: 3 cost time: 0.8521947860717773
Epoch: 3, Steps: 7 | Train Loss: 1.917 Vali Loss: 1.601 Vali Acc: 0.722 Test Loss: 1.601 Test Acc: 0.722
Validation loss decreased (-0.430534 --> -0.722206).  Saving model ...
Epoch: 4 cost time: 1.1125361919403076
Epoch: 4, Steps: 7 | Train Loss: 1.276 Vali Loss: 1.027 Vali Acc: 0.819 Test Loss: 1.027 Test Acc: 0.819
Validation loss decreased (-0.722206 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 1.1120193004608154
Epoch: 5, Steps: 7 | Train Loss: 0.618 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.819434 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 1.0750436782836914
Epoch: 6, Steps: 7 | Train Loss: 0.207 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.8472208976745605
Epoch: 7, Steps: 7 | Train Loss: 0.054 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.9212262630462646
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9221491813659668
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0759992599487305
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7450218200683594
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.9300141334533691
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 1.2104246616363525
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.966116189956665
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.065542459487915
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9408144950866699
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7750132083892822
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0057556629180908
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7921237945556641
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9233095645904541
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1200401782989502
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6922421455383301
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0479249954223633
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.136054277420044
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30409740
model size : 130.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4052886962890625
Epoch: 1, Steps: 7 | Train Loss: 2.668 Vali Loss: 2.481 Vali Acc: 0.125 Test Loss: 2.481 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7990350723266602
Epoch: 2, Steps: 7 | Train Loss: 2.457 Vali Loss: 2.242 Vali Acc: 0.403 Test Loss: 2.242 Test Acc: 0.403
Validation loss decreased (-0.124975 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.5928890705108643
Epoch: 3, Steps: 7 | Train Loss: 2.119 Vali Loss: 1.948 Vali Acc: 0.556 Test Loss: 1.948 Test Acc: 0.556
Validation loss decreased (-0.402755 --> -0.555536).  Saving model ...
Epoch: 4 cost time: 0.7204439640045166
Epoch: 4, Steps: 7 | Train Loss: 1.712 Vali Loss: 1.512 Vali Acc: 0.806 Test Loss: 1.512 Test Acc: 0.806
Validation loss decreased (-0.555536 --> -0.805540).  Saving model ...
Epoch: 5 cost time: 1.1177058219909668
Epoch: 5, Steps: 7 | Train Loss: 1.224 Vali Loss: 1.031 Vali Acc: 0.861 Test Loss: 1.031 Test Acc: 0.861
Validation loss decreased (-0.805540 --> -0.861101).  Saving model ...
Epoch: 6 cost time: 0.8307497501373291
Epoch: 6, Steps: 7 | Train Loss: 0.672 Vali Loss: 0.554 Vali Acc: 0.903 Test Loss: 0.554 Test Acc: 0.903
Validation loss decreased (-0.861101 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.9969820976257324
Epoch: 7, Steps: 7 | Train Loss: 0.274 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8826406002044678
Epoch: 8, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6872463226318359
Epoch: 9, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.413 Vali Acc: 0.847 Test Loss: 0.413 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7763950824737549
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8655767440795898
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7367672920227051
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7716109752655029
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6730608940124512
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9801809787750244
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.861 Test Loss: 0.371 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9137616157531738
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.861 Test Loss: 0.365 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 30194700
model size : 129.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps57_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6498851776123047
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.402 Vali Acc: 0.139 Test Loss: 2.402 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.0993003845214844
Epoch: 2, Steps: 7 | Train Loss: 2.277 Vali Loss: 1.949 Vali Acc: 0.583 Test Loss: 1.949 Test Acc: 0.583
Validation loss decreased (-0.138865 --> -0.583314).  Saving model ...
Epoch: 3 cost time: 0.8367919921875
Epoch: 3, Steps: 7 | Train Loss: 1.624 Vali Loss: 1.253 Vali Acc: 0.819 Test Loss: 1.253 Test Acc: 0.819
Validation loss decreased (-0.583314 --> -0.819432).  Saving model ...
Epoch: 4 cost time: 1.2657740116119385
Epoch: 4, Steps: 7 | Train Loss: 0.863 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
Validation loss decreased (-0.819432 --> -0.861106).  Saving model ...
Epoch: 5 cost time: 1.1406254768371582
Epoch: 5, Steps: 7 | Train Loss: 0.285 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.9435412883758545
Epoch: 6, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9205021858215332
Epoch: 7, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 1.335848093032837
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3075525760650635
Epoch: 9, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0809047222137451
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9472229480743408
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.931 Test Loss: 0.407 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930551).  Saving model ...
Epoch: 12 cost time: 1.034776210784912
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.931 Test Loss: 0.378 Test Acc: 0.931
Validation loss decreased (-0.930551 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 1.1689863204956055
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.917 Test Loss: 0.454 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1856389045715332
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.467017650604248
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.903 Test Loss: 0.482 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2489683628082275
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.185798168182373
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.931 Test Loss: 0.414 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3595356941223145
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.931 Test Loss: 0.407 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2625665664672852
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.931 Test Loss: 0.400 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2317631244659424
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.931 Test Loss: 0.395 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1329691410064697
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.931 Test Loss: 0.399 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3591976165771484
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.931 Test Loss: 0.399 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps57_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30824460
model size : 132.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps57_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.003810405731201
Epoch: 1, Steps: 7 | Train Loss: 2.670 Vali Loss: 2.486 Vali Acc: 0.125 Test Loss: 2.486 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 1.1887390613555908
Epoch: 2, Steps: 7 | Train Loss: 2.335 Vali Loss: 2.112 Vali Acc: 0.486 Test Loss: 2.112 Test Acc: 0.486
Validation loss decreased (-0.124975 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 1.2524425983428955
Epoch: 3, Steps: 7 | Train Loss: 1.901 Vali Loss: 1.605 Vali Acc: 0.667 Test Loss: 1.605 Test Acc: 0.667
Validation loss decreased (-0.486090 --> -0.666651).  Saving model ...
Epoch: 4 cost time: 1.1037518978118896
Epoch: 4, Steps: 7 | Train Loss: 1.228 Vali Loss: 0.989 Vali Acc: 0.833 Test Loss: 0.989 Test Acc: 0.833
Validation loss decreased (-0.666651 --> -0.833323).  Saving model ...
Epoch: 5 cost time: 1.2142045497894287
Epoch: 5, Steps: 7 | Train Loss: 0.627 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
Validation loss decreased (-0.833323 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 1.2115733623504639
Epoch: 6, Steps: 7 | Train Loss: 0.231 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.6653499603271484
Epoch: 7, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.939885139465332
Epoch: 8, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.8860945701599121
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.830286979675293
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 1.0717060565948486
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 12 cost time: 0.9974267482757568
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8204400539398193
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5801799297332764
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5285334587097168
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.903 Test Loss: 0.182 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8323714733123779
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.903 Test Loss: 0.183 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0061671733856201
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.903 Test Loss: 0.183 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0679025650024414
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.903 Test Loss: 0.178 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.740624189376831
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8138957023620605
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0535509586334229
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps57_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 30426636
model size : 130.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps57_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1831214427948
Epoch: 1, Steps: 7 | Train Loss: 2.656 Vali Loss: 2.544 Vali Acc: 0.028 Test Loss: 2.544 Test Acc: 0.028
Validation loss decreased (inf --> -0.027752).  Saving model ...
Epoch: 2 cost time: 0.7535190582275391
Epoch: 2, Steps: 7 | Train Loss: 2.476 Vali Loss: 2.223 Vali Acc: 0.292 Test Loss: 2.223 Test Acc: 0.292
Validation loss decreased (-0.027752 --> -0.291644).  Saving model ...
Epoch: 3 cost time: 0.9453320503234863
Epoch: 3, Steps: 7 | Train Loss: 2.051 Vali Loss: 1.865 Vali Acc: 0.472 Test Loss: 1.865 Test Acc: 0.472
Validation loss decreased (-0.291644 --> -0.472204).  Saving model ...
Epoch: 4 cost time: 0.9906060695648193
Epoch: 4, Steps: 7 | Train Loss: 1.743 Vali Loss: 1.427 Vali Acc: 0.750 Test Loss: 1.427 Test Acc: 0.750
Validation loss decreased (-0.472204 --> -0.749986).  Saving model ...
Epoch: 5 cost time: 0.8708968162536621
Epoch: 5, Steps: 7 | Train Loss: 1.203 Vali Loss: 0.854 Vali Acc: 0.833 Test Loss: 0.854 Test Acc: 0.833
Validation loss decreased (-0.749986 --> -0.833325).  Saving model ...
Epoch: 6 cost time: 0.8175215721130371
Epoch: 6, Steps: 7 | Train Loss: 0.651 Vali Loss: 0.509 Vali Acc: 0.889 Test Loss: 0.509 Test Acc: 0.889
Validation loss decreased (-0.833325 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.5770390033721924
Epoch: 7, Steps: 7 | Train Loss: 0.298 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.743633508682251
Epoch: 8, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.888885 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.8924038410186768
Epoch: 9, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6747035980224609
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958332).  Saving model ...
Epoch: 11 cost time: 0.7669277191162109
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.903 Test Loss: 0.216 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9086556434631348
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.007347583770752
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.903 Test Loss: 0.215 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8755881786346436
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.903 Test Loss: 0.202 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.76076340675354
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9672870635986328
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.931 Test Loss: 0.167 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.012937068939209
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.917 Test Loss: 0.161 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8488290309906006
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.945537805557251
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9388546943664551
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps57_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 30222348
model size : 129.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4386308193206787
Epoch: 1, Steps: 7 | Train Loss: 2.576 Vali Loss: 2.329 Vali Acc: 0.347 Test Loss: 2.329 Test Acc: 0.347
Validation loss decreased (inf --> -0.347199).  Saving model ...
Epoch: 2 cost time: 1.0071864128112793
Epoch: 2, Steps: 7 | Train Loss: 2.174 Vali Loss: 1.820 Vali Acc: 0.611 Test Loss: 1.820 Test Acc: 0.611
Validation loss decreased (-0.347199 --> -0.611093).  Saving model ...
Epoch: 3 cost time: 1.1010708808898926
Epoch: 3, Steps: 7 | Train Loss: 1.530 Vali Loss: 1.201 Vali Acc: 0.750 Test Loss: 1.201 Test Acc: 0.750
Validation loss decreased (-0.611093 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 1.1088359355926514
Epoch: 4, Steps: 7 | Train Loss: 0.858 Vali Loss: 0.545 Vali Acc: 0.903 Test Loss: 0.545 Test Acc: 0.903
Validation loss decreased (-0.749988 --> -0.902772).  Saving model ...
Epoch: 5 cost time: 1.2637724876403809
Epoch: 5, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1766552925109863
Epoch: 6, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.243584156036377
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0585837364196777
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.381 Vali Acc: 0.903 Test Loss: 0.381 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.115567684173584
Epoch: 9, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3209946155548096
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 1.146751880645752
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 1.3282582759857178
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.226140022277832
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1712517738342285
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 1.0468637943267822
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0154449939727783
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 1.0422711372375488
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.231377124786377
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2132582664489746
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1091623306274414
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.302478313446045
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2064402103424072
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.16322660446167
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2749018669128418
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.030172348022461
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2919487953186035
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30855180
model size : 132.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3526852130889893
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.411 Vali Acc: 0.181 Test Loss: 2.411 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.8885226249694824
Epoch: 2, Steps: 7 | Train Loss: 2.307 Vali Loss: 2.094 Vali Acc: 0.514 Test Loss: 2.094 Test Acc: 0.514
Validation loss decreased (-0.180531 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 0.8631100654602051
Epoch: 3, Steps: 7 | Train Loss: 1.886 Vali Loss: 1.592 Vali Acc: 0.750 Test Loss: 1.592 Test Acc: 0.750
Validation loss decreased (-0.513868 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 0.8386542797088623
Epoch: 4, Steps: 7 | Train Loss: 1.309 Vali Loss: 0.996 Vali Acc: 0.861 Test Loss: 0.996 Test Acc: 0.861
Validation loss decreased (-0.749984 --> -0.861101).  Saving model ...
Epoch: 5 cost time: 0.7883367538452148
Epoch: 5, Steps: 7 | Train Loss: 0.685 Vali Loss: 0.573 Vali Acc: 0.847 Test Loss: 0.573 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8844361305236816
Epoch: 6, Steps: 7 | Train Loss: 0.315 Vali Loss: 0.448 Vali Acc: 0.833 Test Loss: 0.448 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8273541927337646
Epoch: 7, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.861101 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.0507824420928955
Epoch: 8, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.9141659736633301
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.7042427062988281
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.0239782333374023
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 1.0530822277069092
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 0.9769055843353271
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0008628368377686
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 0.9100189208984375
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0058543682098389
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9644010066986084
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9682703018188477
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0263476371765137
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0281219482421875
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.078033685684204
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8045923709869385
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0620622634887695
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0693316459655762
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 30446604
model size : 130.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3452494144439697
Epoch: 1, Steps: 7 | Train Loss: 2.567 Vali Loss: 2.495 Vali Acc: 0.139 Test Loss: 2.495 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.9574530124664307
Epoch: 2, Steps: 7 | Train Loss: 2.355 Vali Loss: 2.189 Vali Acc: 0.333 Test Loss: 2.189 Test Acc: 0.333
Validation loss decreased (-0.138864 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.7958734035491943
Epoch: 3, Steps: 7 | Train Loss: 2.075 Vali Loss: 1.860 Vali Acc: 0.653 Test Loss: 1.860 Test Acc: 0.653
Validation loss decreased (-0.333311 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.8383376598358154
Epoch: 4, Steps: 7 | Train Loss: 1.693 Vali Loss: 1.446 Vali Acc: 0.792 Test Loss: 1.446 Test Acc: 0.792
Validation loss decreased (-0.652759 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.8055198192596436
Epoch: 5, Steps: 7 | Train Loss: 1.252 Vali Loss: 1.012 Vali Acc: 0.847 Test Loss: 1.012 Test Acc: 0.847
Validation loss decreased (-0.791652 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.736208438873291
Epoch: 6, Steps: 7 | Train Loss: 0.736 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8767662048339844
Epoch: 7, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.431 Vali Acc: 0.903 Test Loss: 0.431 Test Acc: 0.903
Validation loss decreased (-0.847212 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.7552018165588379
Epoch: 8, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.382 Vali Acc: 0.917 Test Loss: 0.382 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.93729567527771
Epoch: 9, Steps: 7 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.9584817886352539
Epoch: 10, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.731001615524292
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8787102699279785
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8992922306060791
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.8379552364349365
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7986190319061279
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.945162296295166
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.757831335067749
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.017549991607666
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9266073703765869
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0329301357269287
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9431052207946777
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9762568473815918
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7684037685394287
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 0.7381746768951416
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.9352860450744629
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6271560192108154
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7018218040466309
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8458585739135742
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9415111541748047
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7307896614074707
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8952629566192627
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9696307182312012
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8314263820648193
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8048498630523682
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30242316
model size : 130.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.8065106868743896
Epoch: 1, Steps: 7 | Train Loss: 2.609 Vali Loss: 2.383 Vali Acc: 0.139 Test Loss: 2.383 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 1.0567090511322021
Epoch: 2, Steps: 7 | Train Loss: 2.180 Vali Loss: 1.854 Vali Acc: 0.556 Test Loss: 1.854 Test Acc: 0.556
Validation loss decreased (-0.138865 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 1.158764123916626
Epoch: 3, Steps: 7 | Train Loss: 1.493 Vali Loss: 1.121 Vali Acc: 0.819 Test Loss: 1.121 Test Acc: 0.819
Validation loss decreased (-0.555537 --> -0.819433).  Saving model ...
Epoch: 4 cost time: 1.174048662185669
Epoch: 4, Steps: 7 | Train Loss: 0.685 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874995).  Saving model ...
Epoch: 5 cost time: 1.2744572162628174
Epoch: 5, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.9631083011627197
Epoch: 6, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.177567720413208
Epoch: 7, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.888885 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 1.0631418228149414
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.378 Vali Acc: 0.917 Test Loss: 0.378 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.096506118774414
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.931 Test Loss: 0.409 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1034739017486572
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.944 Test Loss: 0.363 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1300745010375977
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.021559238433838
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.0860915184020996
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.97519850730896
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.279815673828125
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 1.3822824954986572
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.1009852886199951
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 1.1583976745605469
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 0.7301023006439209
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 20 cost time: 1.1640558242797852
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9897046089172363
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
Validation loss decreased (-0.958332 --> -0.972220).  Saving model ...
Epoch: 22 cost time: 0.9923591613769531
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0314586162567139
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2572369575500488
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.17372465133667
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0272185802459717
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0669834613800049
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9467153549194336
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3127598762512207
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.972 Test Loss: 0.180 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9615349769592285
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9518570899963379
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 30842892
model size : 132.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4286041259765625
Epoch: 1, Steps: 7 | Train Loss: 2.565 Vali Loss: 2.430 Vali Acc: 0.194 Test Loss: 2.430 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 1.0431044101715088
Epoch: 2, Steps: 7 | Train Loss: 2.278 Vali Loss: 2.091 Vali Acc: 0.444 Test Loss: 2.091 Test Acc: 0.444
Validation loss decreased (-0.194420 --> -0.444424).  Saving model ...
Epoch: 3 cost time: 1.056013822555542
Epoch: 3, Steps: 7 | Train Loss: 1.799 Vali Loss: 1.445 Vali Acc: 0.806 Test Loss: 1.445 Test Acc: 0.806
Validation loss decreased (-0.444424 --> -0.805541).  Saving model ...
Epoch: 4 cost time: 0.7686243057250977
Epoch: 4, Steps: 7 | Train Loss: 1.092 Vali Loss: 0.834 Vali Acc: 0.847 Test Loss: 0.834 Test Acc: 0.847
Validation loss decreased (-0.805541 --> -0.847214).  Saving model ...
Epoch: 5 cost time: 1.0496432781219482
Epoch: 5, Steps: 7 | Train Loss: 0.505 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0059006214141846
Epoch: 6, Steps: 7 | Train Loss: 0.155 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.847214 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.0765721797943115
Epoch: 7, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.266 Vali Acc: 0.903 Test Loss: 0.266 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.8865451812744141
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.0215723514556885
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.773439884185791
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7223286628723145
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0585989952087402
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.8755862712860107
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8491299152374268
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.795377254486084
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7901937961578369
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.068647861480713
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8423271179199219
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7956428527832031
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7041490077972412
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6918282508850098
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6938419342041016
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 0.6558640003204346
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 0.731961727142334
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5927944183349609
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6517758369445801
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8627629280090332
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9063467979431152
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8387188911437988
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8519046306610107
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8289997577667236
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.817924976348877
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8278303146362305
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30466572
model size : 130.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.573336601257324
Epoch: 1, Steps: 7 | Train Loss: 2.569 Vali Loss: 2.468 Vali Acc: 0.125 Test Loss: 2.468 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.9819550514221191
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.244 Vali Acc: 0.417 Test Loss: 2.244 Test Acc: 0.417
Validation loss decreased (-0.124975 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 0.7195196151733398
Epoch: 3, Steps: 7 | Train Loss: 2.151 Vali Loss: 1.963 Vali Acc: 0.667 Test Loss: 1.963 Test Acc: 0.667
Validation loss decreased (-0.416644 --> -0.666647).  Saving model ...
Epoch: 4 cost time: 0.6678731441497803
Epoch: 4, Steps: 7 | Train Loss: 1.762 Vali Loss: 1.522 Vali Acc: 0.792 Test Loss: 1.522 Test Acc: 0.792
Validation loss decreased (-0.666647 --> -0.791651).  Saving model ...
Epoch: 5 cost time: 0.7139921188354492
Epoch: 5, Steps: 7 | Train Loss: 1.199 Vali Loss: 0.965 Vali Acc: 0.819 Test Loss: 0.965 Test Acc: 0.819
Validation loss decreased (-0.791651 --> -0.819435).  Saving model ...
Epoch: 6 cost time: 0.6005153656005859
Epoch: 6, Steps: 7 | Train Loss: 0.653 Vali Loss: 0.608 Vali Acc: 0.847 Test Loss: 0.608 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 0.7285549640655518
Epoch: 7, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
Validation loss decreased (-0.847216 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.9301774501800537
Epoch: 8, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.013460636138916
Epoch: 9, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.670241117477417
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 1.0594921112060547
Epoch: 11, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.041102647781372
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8634030818939209
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9665055274963379
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9670627117156982
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8233075141906738
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8483536243438721
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0365939140319824
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0848901271820068
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9456198215484619
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8865172863006592
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.049055576324463
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30283788
model size : 130.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.751375198364258
Epoch: 1, Steps: 7 | Train Loss: 2.624 Vali Loss: 2.428 Vali Acc: 0.222 Test Loss: 2.428 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 1.1320905685424805
Epoch: 2, Steps: 7 | Train Loss: 2.249 Vali Loss: 1.950 Vali Acc: 0.639 Test Loss: 1.950 Test Acc: 0.639
Validation loss decreased (-0.222198 --> -0.638869).  Saving model ...
Epoch: 3 cost time: 1.4850258827209473
Epoch: 3, Steps: 7 | Train Loss: 1.602 Vali Loss: 1.270 Vali Acc: 0.764 Test Loss: 1.270 Test Acc: 0.764
Validation loss decreased (-0.638869 --> -0.763876).  Saving model ...
Epoch: 4 cost time: 1.3674602508544922
Epoch: 4, Steps: 7 | Train Loss: 0.865 Vali Loss: 0.690 Vali Acc: 0.847 Test Loss: 0.690 Test Acc: 0.847
Validation loss decreased (-0.763876 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 1.4402685165405273
Epoch: 5, Steps: 7 | Train Loss: 0.272 Vali Loss: 0.401 Vali Acc: 0.917 Test Loss: 0.401 Test Acc: 0.917
Validation loss decreased (-0.847215 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.2382292747497559
Epoch: 6, Steps: 7 | Train Loss: 0.099 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2897918224334717
Epoch: 7, Steps: 7 | Train Loss: 0.053 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4763503074645996
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.507 Vali Acc: 0.917 Test Loss: 0.507 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2625679969787598
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.903 Test Loss: 0.512 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2301809787750244
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.875 Test Loss: 0.602 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.217057466506958
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.250699520111084
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.861 Test Loss: 0.511 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1727228164672852
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.903 Test Loss: 0.435 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1291229724884033
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.903 Test Loss: 0.420 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.141075849533081
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.903 Test Loss: 0.417 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 30855180
model size : 132.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5560457706451416
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.473 Vali Acc: 0.208 Test Loss: 2.473 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.8000826835632324
Epoch: 2, Steps: 7 | Train Loss: 2.253 Vali Loss: 2.057 Vali Acc: 0.528 Test Loss: 2.057 Test Acc: 0.528
Validation loss decreased (-0.208309 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.8181664943695068
Epoch: 3, Steps: 7 | Train Loss: 1.878 Vali Loss: 1.585 Vali Acc: 0.764 Test Loss: 1.585 Test Acc: 0.764
Validation loss decreased (-0.527757 --> -0.763873).  Saving model ...
Epoch: 4 cost time: 1.131800651550293
Epoch: 4, Steps: 7 | Train Loss: 1.297 Vali Loss: 1.119 Vali Acc: 0.764 Test Loss: 1.119 Test Acc: 0.764
Validation loss decreased (-0.763873 --> -0.763878).  Saving model ...
Epoch: 5 cost time: 0.8996202945709229
Epoch: 5, Steps: 7 | Train Loss: 0.747 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
Validation loss decreased (-0.763878 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 1.0723872184753418
Epoch: 6, Steps: 7 | Train Loss: 0.289 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.134373426437378
Epoch: 7, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.7545850276947021
Epoch: 8, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1145412921905518
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902776).  Saving model ...
Epoch: 10 cost time: 0.9376232624053955
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.902776 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 1.0657970905303955
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.06685471534729
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1057970523834229
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.196214199066162
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0884597301483154
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1401679515838623
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1002027988433838
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9977066516876221
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9012174606323242
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9204049110412598
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.12308669090271
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30500364
model size : 131.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.482304096221924
Epoch: 1, Steps: 7 | Train Loss: 2.644 Vali Loss: 2.501 Vali Acc: 0.097 Test Loss: 2.501 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 1.0512113571166992
Epoch: 2, Steps: 7 | Train Loss: 2.395 Vali Loss: 2.231 Vali Acc: 0.403 Test Loss: 2.231 Test Acc: 0.403
Validation loss decreased (-0.097197 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 1.114452600479126
Epoch: 3, Steps: 7 | Train Loss: 2.120 Vali Loss: 1.977 Vali Acc: 0.500 Test Loss: 1.977 Test Acc: 0.500
Validation loss decreased (-0.402755 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 1.2034518718719482
Epoch: 4, Steps: 7 | Train Loss: 1.753 Vali Loss: 1.578 Vali Acc: 0.819 Test Loss: 1.578 Test Acc: 0.819
Validation loss decreased (-0.499980 --> -0.819429).  Saving model ...
Epoch: 5 cost time: 0.9340879917144775
Epoch: 5, Steps: 7 | Train Loss: 1.303 Vali Loss: 1.092 Vali Acc: 0.917 Test Loss: 1.092 Test Acc: 0.917
Validation loss decreased (-0.819429 --> -0.916656).  Saving model ...
Epoch: 6 cost time: 0.995753288269043
Epoch: 6, Steps: 7 | Train Loss: 0.813 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7066202163696289
Epoch: 7, Steps: 7 | Train Loss: 0.399 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9435975551605225
Epoch: 8, Steps: 7 | Train Loss: 0.177 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1233179569244385
Epoch: 9, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.916656 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.8875346183776855
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 1.1381199359893799
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.931 Test Loss: 0.247 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.9039185047149658
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.1038920879364014
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.8862979412078857
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 1.2134480476379395
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.862635612487793
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 17 cost time: 1.150984287261963
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.9649660587310791
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 19 cost time: 0.6518778800964355
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9604623317718506
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8723695278167725
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7743391990661621
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8364918231964111
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9526016712188721
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8018758296966553
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8393058776855469
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9469034671783447
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9493272304534912
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 30317580
model size : 130.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4862418174743652
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.347 Vali Acc: 0.278 Test Loss: 2.347 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 1.5681726932525635
Epoch: 2, Steps: 7 | Train Loss: 2.189 Vali Loss: 1.873 Vali Acc: 0.556 Test Loss: 1.873 Test Acc: 0.556
Validation loss decreased (-0.277754 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 1.4750146865844727
Epoch: 3, Steps: 7 | Train Loss: 1.558 Vali Loss: 1.222 Vali Acc: 0.806 Test Loss: 1.222 Test Acc: 0.806
Validation loss decreased (-0.555537 --> -0.805543).  Saving model ...
Epoch: 4 cost time: 1.0012459754943848
Epoch: 4, Steps: 7 | Train Loss: 0.850 Vali Loss: 0.624 Vali Acc: 0.847 Test Loss: 0.624 Test Acc: 0.847
Validation loss decreased (-0.805543 --> -0.847216).  Saving model ...
Epoch: 5 cost time: 0.6609377861022949
Epoch: 5, Steps: 7 | Train Loss: 0.292 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 1.3483450412750244
Epoch: 6, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.311 Vali Acc: 0.903 Test Loss: 0.311 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 0.741671085357666
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.380 Vali Acc: 0.903 Test Loss: 0.380 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8714613914489746
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.387 Vali Acc: 0.903 Test Loss: 0.387 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8012006282806396
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.9909358024597168
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.491086483001709
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1790673732757568
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.917 Test Loss: 0.369 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1993324756622314
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9065461158752441
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9953234195709229
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3376030921936035
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.9924674034118652
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 1.4986824989318848
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 1.4758265018463135
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 1.0631163120269775
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 1.4054486751556396
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 1.150162696838379
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 1.2921366691589355
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 1.0968043804168701
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 1.133376121520996
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 1.4256653785705566
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 1.2642276287078857
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 1.3987181186676025
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 29 cost time: 1.208287239074707
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 1.190229892730713
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 31 cost time: 1.095792531967163
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9994630813598633
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1181426048278809
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9714093208312988
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7875995635986328
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0908544063568115
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3841595649719238
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3131754398345947
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.047849416732788
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.008127212524414
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30867468
model size : 132.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.608605146408081
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.402 Vali Acc: 0.208 Test Loss: 2.402 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.0246632099151611
Epoch: 2, Steps: 7 | Train Loss: 2.265 Vali Loss: 2.083 Vali Acc: 0.514 Test Loss: 2.083 Test Acc: 0.514
Validation loss decreased (-0.208309 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 1.0531744956970215
Epoch: 3, Steps: 7 | Train Loss: 1.917 Vali Loss: 1.627 Vali Acc: 0.708 Test Loss: 1.627 Test Acc: 0.708
Validation loss decreased (-0.513868 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 1.0609328746795654
Epoch: 4, Steps: 7 | Train Loss: 1.311 Vali Loss: 1.063 Vali Acc: 0.819 Test Loss: 1.063 Test Acc: 0.819
Validation loss decreased (-0.708317 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 0.8574895858764648
Epoch: 5, Steps: 7 | Train Loss: 0.740 Vali Loss: 0.628 Vali Acc: 0.889 Test Loss: 0.628 Test Acc: 0.889
Validation loss decreased (-0.819434 --> -0.888883).  Saving model ...
Epoch: 6 cost time: 1.0098240375518799
Epoch: 6, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.402 Vali Acc: 0.847 Test Loss: 0.402 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.996631383895874
Epoch: 7, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.9392542839050293
Epoch: 8, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0342819690704346
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9589581489562988
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 11 cost time: 1.080866813659668
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9462518692016602
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.889 Test Loss: 0.212 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1197524070739746
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 14 cost time: 0.998499870300293
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.902776 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0783982276916504
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 0.8769035339355469
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.8244683742523193
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.930554 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 0.9036478996276855
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 19 cost time: 1.1397311687469482
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.071545124053955
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0344359874725342
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.96169114112854
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.06504487991333
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9990696907043457
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9782958030700684
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0047061443328857
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9875032901763916
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0087358951568604
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 30534156
model size : 131.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2101597785949707
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.419 Vali Acc: 0.153 Test Loss: 2.419 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.7456941604614258
Epoch: 2, Steps: 7 | Train Loss: 2.404 Vali Loss: 2.191 Vali Acc: 0.500 Test Loss: 2.191 Test Acc: 0.500
Validation loss decreased (-0.152754 --> -0.499978).  Saving model ...
Epoch: 3 cost time: 0.852679967880249
Epoch: 3, Steps: 7 | Train Loss: 2.134 Vali Loss: 1.929 Vali Acc: 0.681 Test Loss: 1.929 Test Acc: 0.681
Validation loss decreased (-0.499978 --> -0.680536).  Saving model ...
Epoch: 4 cost time: 0.8570156097412109
Epoch: 4, Steps: 7 | Train Loss: 1.819 Vali Loss: 1.605 Vali Acc: 0.694 Test Loss: 1.605 Test Acc: 0.694
Validation loss decreased (-0.680536 --> -0.694428).  Saving model ...
Epoch: 5 cost time: 1.008676528930664
Epoch: 5, Steps: 7 | Train Loss: 1.385 Vali Loss: 1.169 Vali Acc: 0.764 Test Loss: 1.169 Test Acc: 0.764
Validation loss decreased (-0.694428 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 1.0145902633666992
Epoch: 6, Steps: 7 | Train Loss: 0.944 Vali Loss: 0.722 Vali Acc: 0.875 Test Loss: 0.722 Test Acc: 0.875
Validation loss decreased (-0.763877 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 1.0746679306030273
Epoch: 7, Steps: 7 | Train Loss: 0.408 Vali Loss: 0.433 Vali Acc: 0.903 Test Loss: 0.433 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.9477717876434326
Epoch: 8, Steps: 7 | Train Loss: 0.173 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.902773 --> -0.944441).  Saving model ...
Epoch: 9 cost time: 1.0328478813171387
Epoch: 9, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9787025451660156
Epoch: 10, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.931 Test Loss: 0.287 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9908175468444824
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7478899955749512
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 1.0540826320648193
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7424204349517822
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7813973426818848
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9386990070343018
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.79891037940979
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8254959583282471
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.67909836769104
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8367519378662109
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7643764019012451
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8355841636657715
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8574404716491699
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8271656036376953
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7505805492401123
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6965959072113037
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8213233947753906
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8710722923278809
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 1.1015081405639648
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7731971740722656
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8519153594970703
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1564011573791504
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9185466766357422
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8456366062164307
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7625119686126709
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8087944984436035
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7802948951721191
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8279948234558105
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0660016536712646
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.0029585361480713
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 1.0084991455078125
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.8930437564849854
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0384819507598877
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.939084529876709
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.784193754196167
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6874465942382812
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5911402702331543
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5513916015625
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.7276122570037842
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9378297328948975
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30362124
model size : 130.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5157265663146973
Epoch: 1, Steps: 7 | Train Loss: 2.637 Vali Loss: 2.449 Vali Acc: 0.139 Test Loss: 2.449 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.396524429321289
Epoch: 2, Steps: 7 | Train Loss: 2.299 Vali Loss: 1.943 Vali Acc: 0.639 Test Loss: 1.943 Test Acc: 0.639
Validation loss decreased (-0.138864 --> -0.638869).  Saving model ...
Epoch: 3 cost time: 1.1524784564971924
Epoch: 3, Steps: 7 | Train Loss: 1.701 Vali Loss: 1.396 Vali Acc: 0.708 Test Loss: 1.396 Test Acc: 0.708
Validation loss decreased (-0.638869 --> -0.708319).  Saving model ...
Epoch: 4 cost time: 1.4352433681488037
Epoch: 4, Steps: 7 | Train Loss: 0.931 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
Validation loss decreased (-0.708319 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 1.0188610553741455
Epoch: 5, Steps: 7 | Train Loss: 0.321 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.043851375579834
Epoch: 6, Steps: 7 | Train Loss: 0.107 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3427388668060303
Epoch: 7, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 1.048490285873413
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 1.399712085723877
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0402021408081055
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9549195766448975
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1814510822296143
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1422350406646729
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.847 Test Loss: 0.375 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4797515869140625
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3317747116088867
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1165874004364014
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.889 Test Loss: 0.362 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5196950435638428
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0287609100341797
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 30890508
model size : 132.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4346468448638916
Epoch: 1, Steps: 7 | Train Loss: 2.538 Vali Loss: 2.440 Vali Acc: 0.111 Test Loss: 2.440 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.0689334869384766
Epoch: 2, Steps: 7 | Train Loss: 2.314 Vali Loss: 2.097 Vali Acc: 0.444 Test Loss: 2.097 Test Acc: 0.444
Validation loss decreased (-0.111087 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.7815940380096436
Epoch: 3, Steps: 7 | Train Loss: 1.893 Vali Loss: 1.655 Vali Acc: 0.778 Test Loss: 1.655 Test Acc: 0.778
Validation loss decreased (-0.444423 --> -0.777761).  Saving model ...
Epoch: 4 cost time: 0.9634394645690918
Epoch: 4, Steps: 7 | Train Loss: 1.397 Vali Loss: 1.131 Vali Acc: 0.806 Test Loss: 1.131 Test Acc: 0.806
Validation loss decreased (-0.777761 --> -0.805544).  Saving model ...
Epoch: 5 cost time: 0.7969686985015869
Epoch: 5, Steps: 7 | Train Loss: 0.837 Vali Loss: 0.592 Vali Acc: 0.903 Test Loss: 0.592 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902772).  Saving model ...
Epoch: 6 cost time: 0.9904229640960693
Epoch: 6, Steps: 7 | Train Loss: 0.316 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.9267089366912842
Epoch: 7, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9582114219665527
Epoch: 8, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9540326595306396
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.7562904357910156
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0509891510009766
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.889 Test Loss: 0.231 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0025978088378906
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8527874946594238
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.889 Test Loss: 0.246 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9781653881072998
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9745042324066162
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 0.8567578792572021
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 0.7917461395263672
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 0.7831821441650391
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.916665 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.8631751537322998
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.7605743408203125
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.6770405769348145
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.8240480422973633
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6105844974517822
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7168214321136475
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7853250503540039
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7788064479827881
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7083384990692139
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6376850605010986
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8284385204315186
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6894659996032715
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5918905735015869
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30567948
model size : 131.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.772456169128418
Epoch: 1, Steps: 7 | Train Loss: 2.606 Vali Loss: 2.511 Vali Acc: 0.069 Test Loss: 2.511 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.5940985679626465
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.306 Vali Acc: 0.319 Test Loss: 2.306 Test Acc: 0.319
Validation loss decreased (-0.069419 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 0.7345125675201416
Epoch: 3, Steps: 7 | Train Loss: 2.192 Vali Loss: 2.031 Vali Acc: 0.611 Test Loss: 2.031 Test Acc: 0.611
Validation loss decreased (-0.319421 --> -0.611091).  Saving model ...
Epoch: 4 cost time: 0.6138637065887451
Epoch: 4, Steps: 7 | Train Loss: 1.828 Vali Loss: 1.664 Vali Acc: 0.708 Test Loss: 1.664 Test Acc: 0.708
Validation loss decreased (-0.611091 --> -0.708317).  Saving model ...
Epoch: 5 cost time: 0.5626411437988281
Epoch: 5, Steps: 7 | Train Loss: 1.410 Vali Loss: 1.175 Vali Acc: 0.722 Test Loss: 1.175 Test Acc: 0.722
Validation loss decreased (-0.708317 --> -0.722210).  Saving model ...
Epoch: 6 cost time: 0.6063003540039062
Epoch: 6, Steps: 7 | Train Loss: 0.907 Vali Loss: 0.778 Vali Acc: 0.792 Test Loss: 0.778 Test Acc: 0.792
Validation loss decreased (-0.722210 --> -0.791659).  Saving model ...
Epoch: 7 cost time: 0.666736364364624
Epoch: 7, Steps: 7 | Train Loss: 0.482 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.791659 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.6862413883209229
Epoch: 8, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.7193727493286133
Epoch: 9, Steps: 7 | Train Loss: 0.117 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7944858074188232
Epoch: 10, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.6088483333587646
Epoch: 11, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8029744625091553
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.251 Vali Acc: 0.875 Test Loss: 0.251 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.589000940322876
Epoch: 13, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5374524593353271
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.875 Test Loss: 0.281 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5076322555541992
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5775604248046875
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5894513130187988
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5952126979827881
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5851659774780273
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.734832763671875
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30406668
model size : 130.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2823197841644287
Epoch: 1, Steps: 7 | Train Loss: 2.664 Vali Loss: 2.408 Vali Acc: 0.111 Test Loss: 2.408 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.217418909072876
Epoch: 2, Steps: 7 | Train Loss: 2.284 Vali Loss: 1.994 Vali Acc: 0.611 Test Loss: 1.994 Test Acc: 0.611
Validation loss decreased (-0.111087 --> -0.611091).  Saving model ...
Epoch: 3 cost time: 0.904916524887085
Epoch: 3, Steps: 7 | Train Loss: 1.700 Vali Loss: 1.489 Vali Acc: 0.653 Test Loss: 1.489 Test Acc: 0.653
Validation loss decreased (-0.611091 --> -0.652763).  Saving model ...
Epoch: 4 cost time: 0.8144419193267822
Epoch: 4, Steps: 7 | Train Loss: 1.027 Vali Loss: 0.833 Vali Acc: 0.792 Test Loss: 0.833 Test Acc: 0.792
Validation loss decreased (-0.652763 --> -0.791658).  Saving model ...
Epoch: 5 cost time: 1.2001276016235352
Epoch: 5, Steps: 7 | Train Loss: 0.407 Vali Loss: 0.552 Vali Acc: 0.833 Test Loss: 0.552 Test Acc: 0.833
Validation loss decreased (-0.791658 --> -0.833328).  Saving model ...
Epoch: 6 cost time: 0.9192731380462646
Epoch: 6, Steps: 7 | Train Loss: 0.147 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
Validation loss decreased (-0.833328 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.7280189990997314
Epoch: 7, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.021294116973877
Epoch: 8, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1337461471557617
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.353 Vali Acc: 0.931 Test Loss: 0.353 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 1.238306999206543
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.389 Vali Acc: 0.944 Test Loss: 0.389 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 1.0587220191955566
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.917 Test Loss: 0.403 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0663070678710938
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.917 Test Loss: 0.428 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8057079315185547
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.931 Test Loss: 0.412 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8255300521850586
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.931 Test Loss: 0.385 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7038307189941406
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.793574333190918
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.9082698822021484
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.9092490673065186
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.7926933765411377
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.8428504467010498
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.8894870281219482
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.8262097835540771
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.740037202835083
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.1844327449798584
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.9408555030822754
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7631981372833252
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 1.288520097732544
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.9788763523101807
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.824486255645752
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.86895751953125
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 1.0262954235076904
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.2347614765167236
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 1.1417009830474854
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2087974548339844
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1734554767608643
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8796203136444092
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 1.0856716632843018
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.9530720710754395
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.0649900436401367
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 1.213942050933838
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2700061798095703
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 1.2873003482818604
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 1.3724472522735596
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.9344801902770996
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 45 cost time: 1.1467070579528809
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 46 cost time: 1.2932369709014893
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 47 cost time: 0.9763147830963135
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 48 cost time: 1.0779869556427002
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 49 cost time: 0.9782619476318359
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2734665870666504
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 30916620
model size : 132.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2016079425811768
Epoch: 1, Steps: 7 | Train Loss: 2.554 Vali Loss: 2.392 Vali Acc: 0.278 Test Loss: 2.392 Test Acc: 0.278
Validation loss decreased (inf --> -0.277754).  Saving model ...
Epoch: 2 cost time: 0.784113883972168
Epoch: 2, Steps: 7 | Train Loss: 2.258 Vali Loss: 2.079 Vali Acc: 0.542 Test Loss: 2.079 Test Acc: 0.542
Validation loss decreased (-0.277754 --> -0.541646).  Saving model ...
Epoch: 3 cost time: 0.6876530647277832
Epoch: 3, Steps: 7 | Train Loss: 1.865 Vali Loss: 1.655 Vali Acc: 0.736 Test Loss: 1.655 Test Acc: 0.736
Validation loss decreased (-0.541646 --> -0.736095).  Saving model ...
Epoch: 4 cost time: 0.6900510787963867
Epoch: 4, Steps: 7 | Train Loss: 1.343 Vali Loss: 1.110 Vali Acc: 0.833 Test Loss: 1.110 Test Acc: 0.833
Validation loss decreased (-0.736095 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 0.715346097946167
Epoch: 5, Steps: 7 | Train Loss: 0.755 Vali Loss: 0.644 Vali Acc: 0.917 Test Loss: 0.644 Test Acc: 0.917
Validation loss decreased (-0.833322 --> -0.916660).  Saving model ...
Epoch: 6 cost time: 0.7856316566467285
Epoch: 6, Steps: 7 | Train Loss: 0.328 Vali Loss: 0.403 Vali Acc: 0.903 Test Loss: 0.403 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9165022373199463
Epoch: 7, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8283159732818604
Epoch: 8, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7372734546661377
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916660 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.8120079040527344
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 11 cost time: 0.8573849201202393
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.903 Test Loss: 0.268 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8373198509216309
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9089300632476807
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8704972267150879
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8508429527282715
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9402415752410889
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.931 Test Loss: 0.255 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9509220123291016
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.102410078048706
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9889583587646484
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.931 Test Loss: 0.257 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9761009216308594
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.931 Test Loss: 0.259 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30615564
model size : 131.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.553941249847412
Epoch: 1, Steps: 7 | Train Loss: 2.574 Vali Loss: 2.448 Vali Acc: 0.111 Test Loss: 2.448 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.8249249458312988
Epoch: 2, Steps: 7 | Train Loss: 2.354 Vali Loss: 2.244 Vali Acc: 0.375 Test Loss: 2.244 Test Acc: 0.375
Validation loss decreased (-0.111087 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.7149217128753662
Epoch: 3, Steps: 7 | Train Loss: 2.132 Vali Loss: 2.001 Vali Acc: 0.611 Test Loss: 2.001 Test Acc: 0.611
Validation loss decreased (-0.374978 --> -0.611091).  Saving model ...
Epoch: 4 cost time: 0.5642495155334473
Epoch: 4, Steps: 7 | Train Loss: 1.804 Vali Loss: 1.638 Vali Acc: 0.736 Test Loss: 1.638 Test Acc: 0.736
Validation loss decreased (-0.611091 --> -0.736095).  Saving model ...
Epoch: 5 cost time: 0.6795403957366943
Epoch: 5, Steps: 7 | Train Loss: 1.361 Vali Loss: 1.138 Vali Acc: 0.806 Test Loss: 1.138 Test Acc: 0.806
Validation loss decreased (-0.736095 --> -0.805544).  Saving model ...
Epoch: 6 cost time: 0.6186356544494629
Epoch: 6, Steps: 7 | Train Loss: 0.885 Vali Loss: 0.730 Vali Acc: 0.903 Test Loss: 0.730 Test Acc: 0.903
Validation loss decreased (-0.805544 --> -0.902770).  Saving model ...
Epoch: 7 cost time: 0.8030416965484619
Epoch: 7, Steps: 7 | Train Loss: 0.506 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.698951244354248
Epoch: 8, Steps: 7 | Train Loss: 0.251 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.902770 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.6885173320770264
Epoch: 9, Steps: 7 | Train Loss: 0.112 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.7322876453399658
Epoch: 10, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.7344200611114502
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.8970019817352295
Epoch: 12, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7227401733398438
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7947778701782227
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7852504253387451
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9022326469421387
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8103818893432617
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8385632038116455
Epoch: 18, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6727774143218994
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7925214767456055
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8926031589508057
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.763080358505249
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7169818878173828
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.8134257793426514
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.7118813991546631
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.844841480255127
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8427696228027344
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7274107933044434
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7060937881469727
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8024551868438721
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6779773235321045
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6361939907073975
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6065552234649658
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6295173168182373
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30465036
model size : 130.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps86_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.282219886779785
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.484 Vali Acc: 0.194 Test Loss: 2.484 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.9589664936065674
Epoch: 2, Steps: 7 | Train Loss: 2.319 Vali Loss: 1.990 Vali Acc: 0.514 Test Loss: 1.990 Test Acc: 0.514
Validation loss decreased (-0.194420 --> -0.513869).  Saving model ...
Epoch: 3 cost time: 1.0527467727661133
Epoch: 3, Steps: 7 | Train Loss: 1.630 Vali Loss: 1.310 Vali Acc: 0.792 Test Loss: 1.310 Test Acc: 0.792
Validation loss decreased (-0.513869 --> -0.791654).  Saving model ...
Epoch: 4 cost time: 0.9895405769348145
Epoch: 4, Steps: 7 | Train Loss: 0.831 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
Validation loss decreased (-0.791654 --> -0.888883).  Saving model ...
Epoch: 5 cost time: 1.3661422729492188
Epoch: 5, Steps: 7 | Train Loss: 0.247 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
Validation loss decreased (-0.888883 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 1.0828015804290771
Epoch: 6, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9527075290679932
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3019640445709229
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.931 Test Loss: 0.299 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.9691710472106934
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0110065937042236
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.847 Test Loss: 0.341 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9928767681121826
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9726872444152832
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9407827854156494
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 1.2370812892913818
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.2820475101470947
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.302403211593628
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0125019550323486
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1138677597045898
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2869377136230469
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1282403469085693
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9850361347198486
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2888281345367432
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4292142391204834
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.002516269683838
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps86_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30945804
model size : 132.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps86_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.294964075088501
Epoch: 1, Steps: 7 | Train Loss: 2.662 Vali Loss: 2.477 Vali Acc: 0.028 Test Loss: 2.477 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.9098258018493652
Epoch: 2, Steps: 7 | Train Loss: 2.424 Vali Loss: 2.181 Vali Acc: 0.403 Test Loss: 2.181 Test Acc: 0.403
Validation loss decreased (-0.027753 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.9971237182617188
Epoch: 3, Steps: 7 | Train Loss: 2.034 Vali Loss: 1.828 Vali Acc: 0.667 Test Loss: 1.828 Test Acc: 0.667
Validation loss decreased (-0.402756 --> -0.666648).  Saving model ...
Epoch: 4 cost time: 1.0650634765625
Epoch: 4, Steps: 7 | Train Loss: 1.532 Vali Loss: 1.255 Vali Acc: 0.792 Test Loss: 1.255 Test Acc: 0.792
Validation loss decreased (-0.666648 --> -0.791654).  Saving model ...
Epoch: 5 cost time: 0.7839031219482422
Epoch: 5, Steps: 7 | Train Loss: 0.851 Vali Loss: 0.683 Vali Acc: 0.847 Test Loss: 0.683 Test Acc: 0.847
Validation loss decreased (-0.791654 --> -0.847215).  Saving model ...
Epoch: 6 cost time: 0.7445063591003418
Epoch: 6, Steps: 7 | Train Loss: 0.314 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.847215 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 1.1656911373138428
Epoch: 7, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.8224523067474365
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 1.0994393825531006
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7411420345306396
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.986933708190918
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 1.0629630088806152
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0895953178405762
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9184579849243164
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9052553176879883
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.7232911586761475
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8321068286895752
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.010894775390625
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1364974975585938
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9387722015380859
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7993674278259277
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.01582670211792
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0002086162567139
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9536726474761963
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9307048320770264
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps86_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 30677004
model size : 131.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps86_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3119194507598877
Epoch: 1, Steps: 7 | Train Loss: 2.642 Vali Loss: 2.503 Vali Acc: 0.097 Test Loss: 2.503 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.7405819892883301
Epoch: 2, Steps: 7 | Train Loss: 2.423 Vali Loss: 2.282 Vali Acc: 0.347 Test Loss: 2.282 Test Acc: 0.347
Validation loss decreased (-0.097197 --> -0.347199).  Saving model ...
Epoch: 3 cost time: 0.7444055080413818
Epoch: 3, Steps: 7 | Train Loss: 2.167 Vali Loss: 1.991 Vali Acc: 0.639 Test Loss: 1.991 Test Acc: 0.639
Validation loss decreased (-0.347199 --> -0.638869).  Saving model ...
Epoch: 4 cost time: 0.7530801296234131
Epoch: 4, Steps: 7 | Train Loss: 1.774 Vali Loss: 1.572 Vali Acc: 0.764 Test Loss: 1.572 Test Acc: 0.764
Validation loss decreased (-0.638869 --> -0.763873).  Saving model ...
Epoch: 5 cost time: 0.772230863571167
Epoch: 5, Steps: 7 | Train Loss: 1.247 Vali Loss: 0.985 Vali Acc: 0.847 Test Loss: 0.985 Test Acc: 0.847
Validation loss decreased (-0.763873 --> -0.847212).  Saving model ...
Epoch: 6 cost time: 0.8471841812133789
Epoch: 6, Steps: 7 | Train Loss: 0.651 Vali Loss: 0.693 Vali Acc: 0.861 Test Loss: 0.693 Test Acc: 0.861
Validation loss decreased (-0.847212 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.8944730758666992
Epoch: 7, Steps: 7 | Train Loss: 0.314 Vali Loss: 0.471 Vali Acc: 0.917 Test Loss: 0.471 Test Acc: 0.917
Validation loss decreased (-0.861104 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.924231767654419
Epoch: 8, Steps: 7 | Train Loss: 0.122 Vali Loss: 0.409 Vali Acc: 0.903 Test Loss: 0.409 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9821341037750244
Epoch: 9, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8453974723815918
Epoch: 10, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6762797832489014
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7386209964752197
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.320 Vali Acc: 0.931 Test Loss: 0.320 Test Acc: 0.931
Validation loss decreased (-0.916662 --> -0.930552).  Saving model ...
Epoch: 13 cost time: 0.8371255397796631
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.836430549621582
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5759634971618652
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6900229454040527
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.648535966873169
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.931 Test Loss: 0.300 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.656836986541748
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.309 Vali Acc: 0.917 Test Loss: 0.309 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6202783584594727
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6024084091186523
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7505362033843994
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7966206073760986
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8747777938842773
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7633242607116699
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6634392738342285
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8431329727172852
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps86_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30537228
model size : 131.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6709632873535156
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.441 Vali Acc: 0.139 Test Loss: 2.441 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 1.179607629776001
Epoch: 2, Steps: 7 | Train Loss: 2.272 Vali Loss: 2.009 Vali Acc: 0.556 Test Loss: 2.009 Test Acc: 0.556
Validation loss decreased (-0.138864 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 0.6703987121582031
Epoch: 3, Steps: 7 | Train Loss: 1.685 Vali Loss: 1.332 Vali Acc: 0.750 Test Loss: 1.332 Test Acc: 0.750
Validation loss decreased (-0.555535 --> -0.749987).  Saving model ...
Epoch: 4 cost time: 0.6776139736175537
Epoch: 4, Steps: 7 | Train Loss: 0.925 Vali Loss: 0.705 Vali Acc: 0.806 Test Loss: 0.705 Test Acc: 0.806
Validation loss decreased (-0.749987 --> -0.805549).  Saving model ...
Epoch: 5 cost time: 1.3203482627868652
Epoch: 5, Steps: 7 | Train Loss: 0.334 Vali Loss: 0.453 Vali Acc: 0.819 Test Loss: 0.453 Test Acc: 0.819
Validation loss decreased (-0.805549 --> -0.819440).  Saving model ...
Epoch: 6 cost time: 1.3090124130249023
Epoch: 6, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.284 Vali Acc: 0.875 Test Loss: 0.284 Test Acc: 0.875
Validation loss decreased (-0.819440 --> -0.874997).  Saving model ...
Epoch: 7 cost time: 0.9661960601806641
Epoch: 7, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.396 Vali Acc: 0.847 Test Loss: 0.396 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.034353494644165
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9727427959442139
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.861 Test Loss: 0.431 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9625849723815918
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2351531982421875
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2595834732055664
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3112828731536865
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 1.0670750141143799
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 1.197399616241455
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 1.128443717956543
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 1.2738792896270752
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 1.203371286392212
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8666796684265137
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0884509086608887
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2787389755249023
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.378697395324707
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2244055271148682
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 24 cost time: 1.306194543838501
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 25 cost time: 1.3508684635162354
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 26 cost time: 1.112394094467163
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 27 cost time: 1.2422595024108887
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 28 cost time: 1.334162712097168
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 1.333871603012085
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 30 cost time: 1.2265491485595703
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 31 cost time: 1.1440327167510986
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.903 Test Loss: 0.388 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 32 cost time: 1.0814120769500732
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1759262084960938
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.903 Test Loss: 0.393 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2315070629119873
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2913818359375
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.169358730316162
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1451637744903564
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3323471546173096
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2692310810089111
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.23500394821167
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1059186458587646
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.903 Test Loss: 0.396 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 30999564
model size : 132.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.6903040409088135
Epoch: 1, Steps: 7 | Train Loss: 2.703 Vali Loss: 2.553 Vali Acc: 0.069 Test Loss: 2.553 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 1.2269446849822998
Epoch: 2, Steps: 7 | Train Loss: 2.379 Vali Loss: 2.194 Vali Acc: 0.389 Test Loss: 2.194 Test Acc: 0.389
Validation loss decreased (-0.069419 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 1.1488697528839111
Epoch: 3, Steps: 7 | Train Loss: 2.060 Vali Loss: 1.788 Vali Acc: 0.569 Test Loss: 1.788 Test Acc: 0.569
Validation loss decreased (-0.388867 --> -0.569427).  Saving model ...
Epoch: 4 cost time: 1.167870283126831
Epoch: 4, Steps: 7 | Train Loss: 1.486 Vali Loss: 1.162 Vali Acc: 0.792 Test Loss: 1.162 Test Acc: 0.792
Validation loss decreased (-0.569427 --> -0.791655).  Saving model ...
Epoch: 5 cost time: 1.0233826637268066
Epoch: 5, Steps: 7 | Train Loss: 0.798 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
Validation loss decreased (-0.791655 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 1.0759599208831787
Epoch: 6, Steps: 7 | Train Loss: 0.296 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.9765751361846924
Epoch: 7, Steps: 7 | Train Loss: 0.124 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 1.0360116958618164
Epoch: 8, Steps: 7 | Train Loss: 0.037 Vali Loss: 0.368 Vali Acc: 0.847 Test Loss: 0.368 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0785958766937256
Epoch: 9, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 1.004751443862915
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0863194465637207
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0601141452789307
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1045396327972412
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0045371055603027
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.002131462097168
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.176290512084961
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2268121242523193
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9107823371887207
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.0410246849060059
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9294688701629639
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9224116802215576
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.946782112121582
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8870134353637695
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8886005878448486
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.0154545307159424
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.954561710357666
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9597575664520264
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9086782932281494
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9931697845458984
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9952404499053955
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.218078851699829
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2872693538665771
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9737541675567627
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8487522602081299
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.889 Test Loss: 0.316 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 30752268
model size : 131.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.262237787246704
Epoch: 1, Steps: 7 | Train Loss: 2.682 Vali Loss: 2.516 Vali Acc: 0.097 Test Loss: 2.516 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.7354669570922852
Epoch: 2, Steps: 7 | Train Loss: 2.466 Vali Loss: 2.255 Vali Acc: 0.375 Test Loss: 2.255 Test Acc: 0.375
Validation loss decreased (-0.097197 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.8864560127258301
Epoch: 3, Steps: 7 | Train Loss: 2.198 Vali Loss: 1.982 Vali Acc: 0.667 Test Loss: 1.982 Test Acc: 0.667
Validation loss decreased (-0.374977 --> -0.666647).  Saving model ...
Epoch: 4 cost time: 0.8582158088684082
Epoch: 4, Steps: 7 | Train Loss: 1.891 Vali Loss: 1.669 Vali Acc: 0.653 Test Loss: 1.669 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7899703979492188
Epoch: 5, Steps: 7 | Train Loss: 1.477 Vali Loss: 1.234 Vali Acc: 0.764 Test Loss: 1.234 Test Acc: 0.764
Validation loss decreased (-0.666647 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.8601799011230469
Epoch: 6, Steps: 7 | Train Loss: 0.983 Vali Loss: 0.800 Vali Acc: 0.778 Test Loss: 0.800 Test Acc: 0.778
Validation loss decreased (-0.763877 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 0.5869019031524658
Epoch: 7, Steps: 7 | Train Loss: 0.540 Vali Loss: 0.561 Vali Acc: 0.861 Test Loss: 0.561 Test Acc: 0.861
Validation loss decreased (-0.777770 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.7976467609405518
Epoch: 8, Steps: 7 | Train Loss: 0.264 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7791244983673096
Epoch: 9, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.454 Vali Acc: 0.847 Test Loss: 0.454 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6626138687133789
Epoch: 10, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 0.879474401473999
Epoch: 11, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.364 Vali Acc: 0.847 Test Loss: 0.364 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7348124980926514
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 0.663156270980835
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6109600067138672
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7743992805480957
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7487008571624756
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6534366607666016
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7597994804382324
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8757410049438477
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8586602210998535
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.8970825672149658
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8258185386657715
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.868201494216919
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8532443046569824
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.604844331741333
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.889 Test Loss: 0.274 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8164255619049072
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8447666168212891
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8544454574584961
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7153265476226807
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7927584648132324
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 30623244
model size : 131.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.708447217941284
Epoch: 1, Steps: 7 | Train Loss: 2.593 Vali Loss: 2.448 Vali Acc: 0.125 Test Loss: 2.448 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 1.2794616222381592
Epoch: 2, Steps: 7 | Train Loss: 2.258 Vali Loss: 2.015 Vali Acc: 0.528 Test Loss: 2.015 Test Acc: 0.528
Validation loss decreased (-0.124976 --> -0.527758).  Saving model ...
Epoch: 3 cost time: 1.1012849807739258
Epoch: 3, Steps: 7 | Train Loss: 1.749 Vali Loss: 1.456 Vali Acc: 0.819 Test Loss: 1.456 Test Acc: 0.819
Validation loss decreased (-0.527758 --> -0.819430).  Saving model ...
Epoch: 4 cost time: 1.2113466262817383
Epoch: 4, Steps: 7 | Train Loss: 0.963 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
Validation loss decreased (-0.819430 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 1.00213623046875
Epoch: 5, Steps: 7 | Train Loss: 0.345 Vali Loss: 0.397 Vali Acc: 0.847 Test Loss: 0.397 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0370233058929443
Epoch: 6, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.3299360275268555
Epoch: 7, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 8 cost time: 0.9489295482635498
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 9 cost time: 1.2094411849975586
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0685782432556152
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.143977165222168
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0397374629974365
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7591001987457275
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1219727993011475
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2750606536865234
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2369890213012695
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9055094718933105
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2875087261199951
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 31064076
model size : 133.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.481541395187378
Epoch: 1, Steps: 7 | Train Loss: 2.643 Vali Loss: 2.459 Vali Acc: 0.236 Test Loss: 2.459 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 1.1094443798065186
Epoch: 2, Steps: 7 | Train Loss: 2.355 Vali Loss: 2.147 Vali Acc: 0.375 Test Loss: 2.147 Test Acc: 0.375
Validation loss decreased (-0.236087 --> -0.374979).  Saving model ...
Epoch: 3 cost time: 0.8939111232757568
Epoch: 3, Steps: 7 | Train Loss: 1.959 Vali Loss: 1.738 Vali Acc: 0.708 Test Loss: 1.738 Test Acc: 0.708
Validation loss decreased (-0.374979 --> -0.708316).  Saving model ...
Epoch: 4 cost time: 1.094778299331665
Epoch: 4, Steps: 7 | Train Loss: 1.451 Vali Loss: 1.244 Vali Acc: 0.833 Test Loss: 1.244 Test Acc: 0.833
Validation loss decreased (-0.708316 --> -0.833321).  Saving model ...
Epoch: 5 cost time: 1.0896227359771729
Epoch: 5, Steps: 7 | Train Loss: 0.951 Vali Loss: 0.739 Vali Acc: 0.861 Test Loss: 0.739 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 0.8736732006072998
Epoch: 6, Steps: 7 | Train Loss: 0.468 Vali Loss: 0.439 Vali Acc: 0.917 Test Loss: 0.439 Test Acc: 0.917
Validation loss decreased (-0.861104 --> -0.916662).  Saving model ...
Epoch: 7 cost time: 1.0858652591705322
Epoch: 7, Steps: 7 | Train Loss: 0.183 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7856323719024658
Epoch: 8, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.710413932800293
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916662 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 1.0155398845672607
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 11 cost time: 0.9354724884033203
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8161568641662598
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.291 Vali Acc: 0.903 Test Loss: 0.291 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.042381763458252
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.090174913406372
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9116404056549072
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1489636898040771
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1360349655151367
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0249273777008057
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 1.0741510391235352
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 1.1167917251586914
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 0.9491457939147949
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 0.7730185985565186
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.917 Test Loss: 0.173 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 23 cost time: 0.812537670135498
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.917 Test Loss: 0.173 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8915116786956787
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8206977844238281
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8228318691253662
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8508901596069336
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7770607471466064
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.917 Test Loss: 0.174 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9099667072296143
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 30 cost time: 0.8729219436645508
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.917 Test Loss: 0.170 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 0.8135395050048828
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 0.9917914867401123
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.917 Test Loss: 0.168 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 33 cost time: 0.7675905227661133
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.917 Test Loss: 0.167 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 34 cost time: 0.7518517971038818
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.917 Test Loss: 0.167 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9893124103546143
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.002091884613037
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5673062801361084
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.917 Test Loss: 0.168 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7442877292633057
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.917 Test Loss: 0.164 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 39 cost time: 1.065476417541504
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.917 Test Loss: 0.163 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 40 cost time: 1.1532940864562988
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.917 Test Loss: 0.161 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 41 cost time: 0.980170488357544
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.917 Test Loss: 0.160 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 42 cost time: 1.0992326736450195
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.917 Test Loss: 0.161 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1320686340332031
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.931 Test Loss: 0.162 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.8424162864685059
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.931 Test Loss: 0.161 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 1.135528802871704
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.931 Test Loss: 0.160 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 46 cost time: 0.9118947982788086
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 47 cost time: 0.8078031539916992
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.931 Test Loss: 0.157 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 48 cost time: 0.5186402797698975
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.755427360534668
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.993272066116333
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.931 Test Loss: 0.159 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 30827532
model size : 132.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.997312307357788
Epoch: 1, Steps: 7 | Train Loss: 2.640 Vali Loss: 2.551 Vali Acc: 0.125 Test Loss: 2.551 Test Acc: 0.125
Validation loss decreased (inf --> -0.124974).  Saving model ...
Epoch: 2 cost time: 0.6668455600738525
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.303 Vali Acc: 0.431 Test Loss: 2.303 Test Acc: 0.431
Validation loss decreased (-0.124974 --> -0.430533).  Saving model ...
Epoch: 3 cost time: 0.5108346939086914
Epoch: 3, Steps: 7 | Train Loss: 2.150 Vali Loss: 2.008 Vali Acc: 0.625 Test Loss: 2.008 Test Acc: 0.625
Validation loss decreased (-0.430533 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 0.5925207138061523
Epoch: 4, Steps: 7 | Train Loss: 1.786 Vali Loss: 1.636 Vali Acc: 0.722 Test Loss: 1.636 Test Acc: 0.722
Validation loss decreased (-0.624980 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 0.8494851589202881
Epoch: 5, Steps: 7 | Train Loss: 1.378 Vali Loss: 1.181 Vali Acc: 0.778 Test Loss: 1.181 Test Acc: 0.778
Validation loss decreased (-0.722206 --> -0.777766).  Saving model ...
Epoch: 6 cost time: 0.7803120613098145
Epoch: 6, Steps: 7 | Train Loss: 0.859 Vali Loss: 0.795 Vali Acc: 0.833 Test Loss: 0.795 Test Acc: 0.833
Validation loss decreased (-0.777766 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.7449545860290527
Epoch: 7, Steps: 7 | Train Loss: 0.479 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
Validation loss decreased (-0.833325 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.8132786750793457
Epoch: 8, Steps: 7 | Train Loss: 0.214 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.6615216732025146
Epoch: 9, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7789261341094971
Epoch: 10, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8538172245025635
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7330441474914551
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7333543300628662
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.7244052886962891
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.7647955417633057
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.721341609954834
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.931 Test Loss: 0.235 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7691497802734375
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8074386119842529
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5750157833099365
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.7034072875976562
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7434501647949219
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7584443092346191
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.5922844409942627
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6737873554229736
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6255886554718018
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5807681083679199
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.566373348236084
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6157639026641846
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6294353008270264
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7517790794372559
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6714894771575928
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5974311828613281
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6282336711883545
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6360676288604736
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7195727825164795
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.931 Test Loss: 0.220 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7554025650024414
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30709260
model size : 131.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.369948387145996
Epoch: 1, Steps: 7 | Train Loss: 2.558 Vali Loss: 2.416 Vali Acc: 0.181 Test Loss: 2.416 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.8088185787200928
Epoch: 2, Steps: 7 | Train Loss: 2.262 Vali Loss: 1.971 Vali Acc: 0.403 Test Loss: 1.971 Test Acc: 0.403
Validation loss decreased (-0.180531 --> -0.402758).  Saving model ...
Epoch: 3 cost time: 0.7558460235595703
Epoch: 3, Steps: 7 | Train Loss: 1.738 Vali Loss: 1.417 Vali Acc: 0.764 Test Loss: 1.417 Test Acc: 0.764
Validation loss decreased (-0.402758 --> -0.763875).  Saving model ...
Epoch: 4 cost time: 1.1721513271331787
Epoch: 4, Steps: 7 | Train Loss: 1.029 Vali Loss: 0.789 Vali Acc: 0.806 Test Loss: 0.789 Test Acc: 0.806
Validation loss decreased (-0.763875 --> -0.805548).  Saving model ...
Epoch: 5 cost time: 1.147397756576538
Epoch: 5, Steps: 7 | Train Loss: 0.398 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.805548 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.778801441192627
Epoch: 6, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.378 Vali Acc: 0.903 Test Loss: 0.378 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.8875448703765869
Epoch: 7, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.335 Vali Acc: 0.903 Test Loss: 0.335 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.1403446197509766
Epoch: 8, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 1.0649211406707764
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1324272155761719
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.903 Test Loss: 0.352 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.085160255432129
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.0457749366760254
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.98464035987854
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.0627014636993408
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9047222137451172
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1259772777557373
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1598987579345703
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9306566715240479
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8937668800354004
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9686856269836426
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7984321117401123
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7631018161773682
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8617386817932129
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.849492073059082
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 31134732
model size : 133.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4365272521972656
Epoch: 1, Steps: 7 | Train Loss: 2.577 Vali Loss: 2.463 Vali Acc: 0.139 Test Loss: 2.463 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.5217845439910889
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.138 Vali Acc: 0.403 Test Loss: 2.138 Test Acc: 0.403
Validation loss decreased (-0.138864 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.8147528171539307
Epoch: 3, Steps: 7 | Train Loss: 2.007 Vali Loss: 1.761 Vali Acc: 0.611 Test Loss: 1.761 Test Acc: 0.611
Validation loss decreased (-0.402756 --> -0.611094).  Saving model ...
Epoch: 4 cost time: 0.7782840728759766
Epoch: 4, Steps: 7 | Train Loss: 1.497 Vali Loss: 1.244 Vali Acc: 0.819 Test Loss: 1.244 Test Acc: 0.819
Validation loss decreased (-0.611094 --> -0.819432).  Saving model ...
Epoch: 5 cost time: 0.7375311851501465
Epoch: 5, Steps: 7 | Train Loss: 0.947 Vali Loss: 0.752 Vali Acc: 0.875 Test Loss: 0.752 Test Acc: 0.875
Validation loss decreased (-0.819432 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.6250290870666504
Epoch: 6, Steps: 7 | Train Loss: 0.490 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
Validation loss decreased (-0.874992 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.6031041145324707
Epoch: 7, Steps: 7 | Train Loss: 0.188 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7747900485992432
Epoch: 8, Steps: 7 | Train Loss: 0.058 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.70699143409729
Epoch: 9, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7468464374542236
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7024776935577393
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9995322227478027
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.7926886081695557
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.8362345695495605
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8155224323272705
Epoch: 15, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7010836601257324
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.736168384552002
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9690351486206055
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7193310260772705
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7802877426147461
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8892431259155273
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8921942710876465
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.917 Test Loss: 0.280 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6834836006164551
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 30930444
model size : 132.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0834925174713135
Epoch: 1, Steps: 7 | Train Loss: 2.671 Vali Loss: 2.534 Vali Acc: 0.111 Test Loss: 2.534 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6819612979888916
Epoch: 2, Steps: 7 | Train Loss: 2.456 Vali Loss: 2.265 Vali Acc: 0.361 Test Loss: 2.265 Test Acc: 0.361
Validation loss decreased (-0.111086 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 0.6348216533660889
Epoch: 3, Steps: 7 | Train Loss: 2.145 Vali Loss: 2.003 Vali Acc: 0.653 Test Loss: 2.003 Test Acc: 0.653
Validation loss decreased (-0.361088 --> -0.652758).  Saving model ...
Epoch: 4 cost time: 0.7647228240966797
Epoch: 4, Steps: 7 | Train Loss: 1.837 Vali Loss: 1.661 Vali Acc: 0.764 Test Loss: 1.661 Test Acc: 0.764
Validation loss decreased (-0.652758 --> -0.763872).  Saving model ...
Epoch: 5 cost time: 0.658196210861206
Epoch: 5, Steps: 7 | Train Loss: 1.397 Vali Loss: 1.228 Vali Acc: 0.833 Test Loss: 1.228 Test Acc: 0.833
Validation loss decreased (-0.763872 --> -0.833321).  Saving model ...
Epoch: 6 cost time: 0.6034698486328125
Epoch: 6, Steps: 7 | Train Loss: 0.948 Vali Loss: 0.839 Vali Acc: 0.806 Test Loss: 0.839 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6697976589202881
Epoch: 7, Steps: 7 | Train Loss: 0.522 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861105).  Saving model ...
Epoch: 8 cost time: 0.5102248191833496
Epoch: 8, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.6784980297088623
Epoch: 9, Steps: 7 | Train Loss: 0.102 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.5626673698425293
Epoch: 10, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.5745019912719727
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.321 Vali Acc: 0.931 Test Loss: 0.321 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.5863006114959717
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7453677654266357
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6651139259338379
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6345250606536865
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6842172145843506
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5784773826599121
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6555831432342529
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5890052318572998
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6754128932952881
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.6709740161895752
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.764885425567627
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.6447005271911621
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.931 Test Loss: 0.258 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7254343032836914
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6233010292053223
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.5574309825897217
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.7548880577087402
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.64200758934021
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6136665344238281
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.746955394744873
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6872212886810303
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6432721614837646
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5864005088806152
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6347758769989014
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6759154796600342
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5744552612304688
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5984876155853271
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.698753833770752
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6581485271453857
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7177712917327881
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7066202163696289
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7050528526306152
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6339499950408936
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6209383010864258
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 30822924
model size : 132.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2999227046966553
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.477 Vali Acc: 0.139 Test Loss: 2.477 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.7930817604064941
Epoch: 2, Steps: 7 | Train Loss: 2.300 Vali Loss: 2.039 Vali Acc: 0.514 Test Loss: 2.039 Test Acc: 0.514
Validation loss decreased (-0.138864 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 0.7995560169219971
Epoch: 3, Steps: 7 | Train Loss: 1.759 Vali Loss: 1.418 Vali Acc: 0.708 Test Loss: 1.418 Test Acc: 0.708
Validation loss decreased (-0.513868 --> -0.708319).  Saving model ...
Epoch: 4 cost time: 0.8330461978912354
Epoch: 4, Steps: 7 | Train Loss: 1.020 Vali Loss: 0.782 Vali Acc: 0.819 Test Loss: 0.782 Test Acc: 0.819
Validation loss decreased (-0.708319 --> -0.819437).  Saving model ...
Epoch: 5 cost time: 0.9223611354827881
Epoch: 5, Steps: 7 | Train Loss: 0.403 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
Validation loss decreased (-0.819437 --> -0.861106).  Saving model ...
Epoch: 6 cost time: 0.7073333263397217
Epoch: 6, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.9690554141998291
Epoch: 7, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.6305019855499268
Epoch: 8, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.339 Vali Acc: 0.903 Test Loss: 0.339 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.9041357040405273
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 1.0380983352661133
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6641690731048584
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 1.0813944339752197
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.902775 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.863915205001831
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9670529365539551
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7471790313720703
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9848809242248535
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8850390911102295
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.010958194732666
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8089096546173096
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.901278018951416
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.851057767868042
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9049465656280518
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 31254540
model size : 133.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1917197704315186
Epoch: 1, Steps: 7 | Train Loss: 2.557 Vali Loss: 2.424 Vali Acc: 0.167 Test Loss: 2.424 Test Acc: 0.167
Validation loss decreased (inf --> -0.166642).  Saving model ...
Epoch: 2 cost time: 0.5643215179443359
Epoch: 2, Steps: 7 | Train Loss: 2.362 Vali Loss: 2.112 Vali Acc: 0.528 Test Loss: 2.112 Test Acc: 0.528
Validation loss decreased (-0.166642 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.9438152313232422
Epoch: 3, Steps: 7 | Train Loss: 1.937 Vali Loss: 1.620 Vali Acc: 0.806 Test Loss: 1.620 Test Acc: 0.806
Validation loss decreased (-0.527757 --> -0.805539).  Saving model ...
Epoch: 4 cost time: 0.9343366622924805
Epoch: 4, Steps: 7 | Train Loss: 1.450 Vali Loss: 1.046 Vali Acc: 0.792 Test Loss: 1.046 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7454068660736084
Epoch: 5, Steps: 7 | Train Loss: 0.871 Vali Loss: 0.709 Vali Acc: 0.806 Test Loss: 0.709 Test Acc: 0.806
Validation loss decreased (-0.805539 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 0.8026912212371826
Epoch: 6, Steps: 7 | Train Loss: 0.447 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
Validation loss decreased (-0.805548 --> -0.819439).  Saving model ...
Epoch: 7 cost time: 0.9172554016113281
Epoch: 7, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.819439 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.7993888854980469
Epoch: 8, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7440125942230225
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9209108352661133
Epoch: 10, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.8832271099090576
Epoch: 11, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7727417945861816
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6125955581665039
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9423177242279053
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9289782047271729
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7362854480743408
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.983544111251831
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7499415874481201
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8372094631195068
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6379449367523193
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7673985958099365
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8657467365264893
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6212396621704102
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8841040134429932
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6801321506500244
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.917 Test Loss: 0.311 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7344205379486084
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 31061004
model size : 133.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.226827383041382
Epoch: 1, Steps: 7 | Train Loss: 2.598 Vali Loss: 2.491 Vali Acc: 0.056 Test Loss: 2.491 Test Acc: 0.056
Validation loss decreased (inf --> -0.055531).  Saving model ...
Epoch: 2 cost time: 0.6428401470184326
Epoch: 2, Steps: 7 | Train Loss: 2.411 Vali Loss: 2.281 Vali Acc: 0.264 Test Loss: 2.281 Test Acc: 0.264
Validation loss decreased (-0.055531 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.6536989212036133
Epoch: 3, Steps: 7 | Train Loss: 2.138 Vali Loss: 1.997 Vali Acc: 0.542 Test Loss: 1.997 Test Acc: 0.542
Validation loss decreased (-0.263866 --> -0.541647).  Saving model ...
Epoch: 4 cost time: 0.7325129508972168
Epoch: 4, Steps: 7 | Train Loss: 1.822 Vali Loss: 1.642 Vali Acc: 0.694 Test Loss: 1.642 Test Acc: 0.694
Validation loss decreased (-0.541647 --> -0.694428).  Saving model ...
Epoch: 5 cost time: 0.6680569648742676
Epoch: 5, Steps: 7 | Train Loss: 1.407 Vali Loss: 1.225 Vali Acc: 0.764 Test Loss: 1.225 Test Acc: 0.764
Validation loss decreased (-0.694428 --> -0.763877).  Saving model ...
Epoch: 6 cost time: 0.5548450946807861
Epoch: 6, Steps: 7 | Train Loss: 0.909 Vali Loss: 0.838 Vali Acc: 0.875 Test Loss: 0.838 Test Acc: 0.875
Validation loss decreased (-0.763877 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.7013599872589111
Epoch: 7, Steps: 7 | Train Loss: 0.528 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.5799229145050049
Epoch: 8, Steps: 7 | Train Loss: 0.250 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 0.5690116882324219
Epoch: 9, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.7036135196685791
Epoch: 10, Steps: 7 | Train Loss: 0.050 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.686988115310669
Epoch: 11, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.6984939575195312
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6417450904846191
Epoch: 13, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5991835594177246
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6249971389770508
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.6858804225921631
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.5499331951141357
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.903 Test Loss: 0.240 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.627305269241333
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.5582389831542969
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4388303756713867
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5632648468017578
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.47568821907043457
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5620453357696533
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5483229160308838
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4468703269958496
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4311368465423584
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6452107429504395
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5931193828582764
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 30964236
model size : 132.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps133_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.164144515991211
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.360 Vali Acc: 0.292 Test Loss: 2.360 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 1.1213340759277344
Epoch: 2, Steps: 7 | Train Loss: 2.222 Vali Loss: 1.968 Vali Acc: 0.528 Test Loss: 1.968 Test Acc: 0.528
Validation loss decreased (-0.291643 --> -0.527758).  Saving model ...
Epoch: 3 cost time: 0.8678483963012695
Epoch: 3, Steps: 7 | Train Loss: 1.846 Vali Loss: 1.448 Vali Acc: 0.778 Test Loss: 1.448 Test Acc: 0.778
Validation loss decreased (-0.527758 --> -0.777763).  Saving model ...
Epoch: 4 cost time: 0.9346873760223389
Epoch: 4, Steps: 7 | Train Loss: 1.188 Vali Loss: 0.795 Vali Acc: 0.833 Test Loss: 0.795 Test Acc: 0.833
Validation loss decreased (-0.777763 --> -0.833325).  Saving model ...
Epoch: 5 cost time: 0.9289772510528564
Epoch: 5, Steps: 7 | Train Loss: 0.505 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
Validation loss decreased (-0.833325 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.785402774810791
Epoch: 6, Steps: 7 | Train Loss: 0.174 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.7690408229827881
Epoch: 7, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.9167795181274414
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9555196762084961
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.8895854949951172
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.8512575626373291
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8922629356384277
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 0.6231963634490967
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8059806823730469
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9659547805786133
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9082989692687988
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7304880619049072
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9848387241363525
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0996453762054443
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0169882774353027
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8786561489105225
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.915236234664917
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps133_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 31391244
model size : 134.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps133_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4534294605255127
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.443 Vali Acc: 0.097 Test Loss: 2.443 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 1.0265390872955322
Epoch: 2, Steps: 7 | Train Loss: 2.376 Vali Loss: 2.158 Vali Acc: 0.417 Test Loss: 2.158 Test Acc: 0.417
Validation loss decreased (-0.097198 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.6742823123931885
Epoch: 3, Steps: 7 | Train Loss: 2.055 Vali Loss: 1.849 Vali Acc: 0.583 Test Loss: 1.849 Test Acc: 0.583
Validation loss decreased (-0.416645 --> -0.583315).  Saving model ...
Epoch: 4 cost time: 0.9670910835266113
Epoch: 4, Steps: 7 | Train Loss: 1.657 Vali Loss: 1.379 Vali Acc: 0.806 Test Loss: 1.379 Test Acc: 0.806
Validation loss decreased (-0.583315 --> -0.805542).  Saving model ...
Epoch: 5 cost time: 0.7997424602508545
Epoch: 5, Steps: 7 | Train Loss: 1.061 Vali Loss: 0.811 Vali Acc: 0.861 Test Loss: 0.811 Test Acc: 0.861
Validation loss decreased (-0.805542 --> -0.861103).  Saving model ...
Epoch: 6 cost time: 1.019439458847046
Epoch: 6, Steps: 7 | Train Loss: 0.508 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8614938259124756
Epoch: 7, Steps: 7 | Train Loss: 0.243 Vali Loss: 0.408 Vali Acc: 0.847 Test Loss: 0.408 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8695826530456543
Epoch: 8, Steps: 7 | Train Loss: 0.083 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
Validation loss decreased (-0.861103 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.7084436416625977
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7338037490844727
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.6087019443511963
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 1.049408197402954
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.8819019794464111
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9193203449249268
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9503426551818848
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.102748155593872
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9255311489105225
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9822115898132324
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.01015305519104
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8318254947662354
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9819157123565674
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0154051780700684
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7683782577514648
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.088794469833374
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.917 Test Loss: 0.304 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1636583805084229
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps133_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 31219212
model size : 133.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps133_str133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.330793619155884
Epoch: 1, Steps: 7 | Train Loss: 2.619 Vali Loss: 2.480 Vali Acc: 0.097 Test Loss: 2.480 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6075038909912109
Epoch: 2, Steps: 7 | Train Loss: 2.406 Vali Loss: 2.226 Vali Acc: 0.486 Test Loss: 2.226 Test Acc: 0.486
Validation loss decreased (-0.097197 --> -0.486089).  Saving model ...
Epoch: 3 cost time: 0.7213394641876221
Epoch: 3, Steps: 7 | Train Loss: 2.105 Vali Loss: 1.982 Vali Acc: 0.569 Test Loss: 1.982 Test Acc: 0.569
Validation loss decreased (-0.486089 --> -0.569425).  Saving model ...
Epoch: 4 cost time: 0.5616447925567627
Epoch: 4, Steps: 7 | Train Loss: 1.798 Vali Loss: 1.670 Vali Acc: 0.722 Test Loss: 1.670 Test Acc: 0.722
Validation loss decreased (-0.569425 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 0.5749557018280029
Epoch: 5, Steps: 7 | Train Loss: 1.420 Vali Loss: 1.221 Vali Acc: 0.861 Test Loss: 1.221 Test Acc: 0.861
Validation loss decreased (-0.722206 --> -0.861099).  Saving model ...
Epoch: 6 cost time: 0.5958294868469238
Epoch: 6, Steps: 7 | Train Loss: 0.884 Vali Loss: 0.746 Vali Acc: 0.847 Test Loss: 0.746 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5757601261138916
Epoch: 7, Steps: 7 | Train Loss: 0.491 Vali Loss: 0.454 Vali Acc: 0.903 Test Loss: 0.454 Test Acc: 0.903
Validation loss decreased (-0.861099 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.7090606689453125
Epoch: 8, Steps: 7 | Train Loss: 0.226 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6250624656677246
Epoch: 9, Steps: 7 | Train Loss: 0.100 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.6376230716705322
Epoch: 10, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6359188556671143
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6592016220092773
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 0.689335823059082
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.916665 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 0.695652961730957
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.713085412979126
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7420611381530762
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.889 Test Loss: 0.226 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7145411968231201
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6621890068054199
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6155755519866943
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.944 Test Loss: 0.153 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.6032102108001709
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.944 Test Loss: 0.144 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.7109999656677246
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.692047119140625
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.931 Test Loss: 0.143 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7608060836791992
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.931 Test Loss: 0.145 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7509469985961914
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.931 Test Loss: 0.146 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6836578845977783
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.931 Test Loss: 0.147 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6842076778411865
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.931 Test Loss: 0.145 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6804723739624023
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.931 Test Loss: 0.148 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9176197052001953
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.931 Test Loss: 0.147 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7082762718200684
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.931 Test Loss: 0.147 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6502845287322998
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.931 Test Loss: 0.145 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8043117523193359
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.931 Test Loss: 0.145 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps133_str133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 31143948
model size : 133.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5877623558044434
Epoch: 1, Steps: 7 | Train Loss: 2.575 Vali Loss: 2.370 Vali Acc: 0.181 Test Loss: 2.370 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.785764217376709
Epoch: 2, Steps: 7 | Train Loss: 2.281 Vali Loss: 2.027 Vali Acc: 0.722 Test Loss: 2.027 Test Acc: 0.722
Validation loss decreased (-0.180532 --> -0.722202).  Saving model ...
Epoch: 3 cost time: 0.80419921875
Epoch: 3, Steps: 7 | Train Loss: 1.842 Vali Loss: 1.612 Vali Acc: 0.778 Test Loss: 1.612 Test Acc: 0.778
Validation loss decreased (-0.722202 --> -0.777762).  Saving model ...
Epoch: 4 cost time: 0.695704460144043
Epoch: 4, Steps: 7 | Train Loss: 1.263 Vali Loss: 1.003 Vali Acc: 0.833 Test Loss: 1.003 Test Acc: 0.833
Validation loss decreased (-0.777762 --> -0.833323).  Saving model ...
Epoch: 5 cost time: 0.8322432041168213
Epoch: 5, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9069910049438477
Epoch: 6, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 1.0150411128997803
Epoch: 7, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
Validation loss decreased (-0.833329 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.9172430038452148
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.7886340618133545
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.903 Test Loss: 0.281 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9213013648986816
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.903 Test Loss: 0.305 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.074753999710083
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.917 Test Loss: 0.310 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.8238108158111572
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 1.010934829711914
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.7274620532989502
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0255932807922363
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.9781374931335449
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.8497028350830078
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.9075026512145996
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.8459093570709229
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 1.0462253093719482
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.8611876964569092
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.9165394306182861
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.8048202991485596
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0034048557281494
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0254511833190918
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.787085771560669
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.9574480056762695
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.055842399597168
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.755098819732666
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.917 Test Loss: 0.239 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 1.099740982055664
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7799077033996582
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 32 cost time: 0.8835711479187012
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8414397239685059
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.7233536243438721
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.8855247497558594
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8626759052276611
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8420994281768799
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.9195013046264648
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9481680393218994
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8845696449279785
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8917675018310547
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.809762716293335
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.885878324508667
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9333860874176025
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7193789482116699
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.840979814529419
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8368420600891113
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 31583244
model size : 135.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4770145416259766
Epoch: 1, Steps: 7 | Train Loss: 2.628 Vali Loss: 2.488 Vali Acc: 0.069 Test Loss: 2.488 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.7420086860656738
Epoch: 2, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.251 Vali Acc: 0.431 Test Loss: 2.251 Test Acc: 0.431
Validation loss decreased (-0.069420 --> -0.430533).  Saving model ...
Epoch: 3 cost time: 0.8171737194061279
Epoch: 3, Steps: 7 | Train Loss: 2.085 Vali Loss: 1.921 Vali Acc: 0.639 Test Loss: 1.921 Test Acc: 0.639
Validation loss decreased (-0.430533 --> -0.638870).  Saving model ...
Epoch: 4 cost time: 0.6890075206756592
Epoch: 4, Steps: 7 | Train Loss: 1.627 Vali Loss: 1.454 Vali Acc: 0.806 Test Loss: 1.454 Test Acc: 0.806
Validation loss decreased (-0.638870 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.7461833953857422
Epoch: 5, Steps: 7 | Train Loss: 1.047 Vali Loss: 0.858 Vali Acc: 0.819 Test Loss: 0.858 Test Acc: 0.819
Validation loss decreased (-0.805541 --> -0.819436).  Saving model ...
Epoch: 6 cost time: 0.9786012172698975
Epoch: 6, Steps: 7 | Train Loss: 0.483 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
Validation loss decreased (-0.819436 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 0.7320652008056641
Epoch: 7, Steps: 7 | Train Loss: 0.204 Vali Loss: 0.407 Vali Acc: 0.861 Test Loss: 0.407 Test Acc: 0.861
Validation loss decreased (-0.847217 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.8212170600891113
Epoch: 8, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.381 Vali Acc: 0.847 Test Loss: 0.381 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7793524265289307
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.8078155517578125
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8873081207275391
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.903 Test Loss: 0.306 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7803215980529785
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8174381256103516
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.7292993068695068
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 1.0290157794952393
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9694705009460449
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 1.0907738208770752
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0465278625488281
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7947676181793213
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8439297676086426
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.917 Test Loss: 0.288 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1594727039337158
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8568570613861084
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.855304479598999
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 24 cost time: 0.8965260982513428
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.862903356552124
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9342436790466309
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8270010948181152
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7671248912811279
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8033287525177002
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9358062744140625
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9025313854217529
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9827604293823242
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7940208911895752
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9869778156280518
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 31432716
model size : 134.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.7052907943725586
Epoch: 1, Steps: 7 | Train Loss: 2.614 Vali Loss: 2.513 Vali Acc: 0.125 Test Loss: 2.513 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.8988852500915527
Epoch: 2, Steps: 7 | Train Loss: 2.452 Vali Loss: 2.258 Vali Acc: 0.375 Test Loss: 2.258 Test Acc: 0.375
Validation loss decreased (-0.124975 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.8083865642547607
Epoch: 3, Steps: 7 | Train Loss: 2.137 Vali Loss: 1.976 Vali Acc: 0.569 Test Loss: 1.976 Test Acc: 0.569
Validation loss decreased (-0.374977 --> -0.569425).  Saving model ...
Epoch: 4 cost time: 0.939185619354248
Epoch: 4, Steps: 7 | Train Loss: 1.759 Vali Loss: 1.605 Vali Acc: 0.722 Test Loss: 1.605 Test Acc: 0.722
Validation loss decreased (-0.569425 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 1.0085313320159912
Epoch: 5, Steps: 7 | Train Loss: 1.307 Vali Loss: 1.168 Vali Acc: 0.819 Test Loss: 1.168 Test Acc: 0.819
Validation loss decreased (-0.722206 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 0.9715209007263184
Epoch: 6, Steps: 7 | Train Loss: 0.845 Vali Loss: 0.807 Vali Acc: 0.847 Test Loss: 0.807 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 0.8496139049530029
Epoch: 7, Steps: 7 | Train Loss: 0.489 Vali Loss: 0.545 Vali Acc: 0.847 Test Loss: 0.545 Test Acc: 0.847
Validation loss decreased (-0.847214 --> -0.847217).  Saving model ...
Epoch: 8 cost time: 0.8117246627807617
Epoch: 8, Steps: 7 | Train Loss: 0.260 Vali Loss: 0.469 Vali Acc: 0.847 Test Loss: 0.469 Test Acc: 0.847
Validation loss decreased (-0.847217 --> -0.847218).  Saving model ...
Epoch: 9 cost time: 0.9508216381072998
Epoch: 9, Steps: 7 | Train Loss: 0.132 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8540241718292236
Epoch: 10, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.385 Vali Acc: 0.847 Test Loss: 0.385 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 11 cost time: 0.9829874038696289
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.347 Vali Acc: 0.847 Test Loss: 0.347 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847219).  Saving model ...
Epoch: 12 cost time: 0.8578286170959473
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
Validation loss decreased (-0.847219 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 0.8352456092834473
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.861108 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 0.6277275085449219
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.346 Vali Acc: 0.861 Test Loss: 0.346 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7385685443878174
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.327 Vali Acc: 0.861 Test Loss: 0.327 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7054040431976318
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.317 Vali Acc: 0.875 Test Loss: 0.317 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 17 cost time: 0.6843764781951904
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 18 cost time: 0.7504861354827881
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7434992790222168
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.875 Test Loss: 0.311 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 20 cost time: 0.7642903327941895
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 0.7382466793060303
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 22 cost time: 0.7281966209411621
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7610824108123779
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7516417503356934
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.874997 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.8213391304016113
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.7605886459350586
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 27 cost time: 0.7853186130523682
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 0.8008570671081543
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.662564754486084
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7379138469696045
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7898015975952148
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7773358821868896
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8328278064727783
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8060784339904785
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9194796085357666
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.808760404586792
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0374884605407715
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 31357452
model size : 134.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps171_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 3.036937952041626
Epoch: 1, Steps: 7 | Train Loss: 2.635 Vali Loss: 2.416 Vali Acc: 0.222 Test Loss: 2.416 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 0.9102587699890137
Epoch: 2, Steps: 7 | Train Loss: 2.325 Vali Loss: 2.081 Vali Acc: 0.431 Test Loss: 2.081 Test Acc: 0.431
Validation loss decreased (-0.222198 --> -0.430535).  Saving model ...
Epoch: 3 cost time: 0.9554929733276367
Epoch: 3, Steps: 7 | Train Loss: 1.873 Vali Loss: 1.613 Vali Acc: 0.750 Test Loss: 1.613 Test Acc: 0.750
Validation loss decreased (-0.430535 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 0.926227331161499
Epoch: 4, Steps: 7 | Train Loss: 1.208 Vali Loss: 0.980 Vali Acc: 0.792 Test Loss: 0.980 Test Acc: 0.792
Validation loss decreased (-0.749984 --> -0.791657).  Saving model ...
Epoch: 5 cost time: 0.9204683303833008
Epoch: 5, Steps: 7 | Train Loss: 0.608 Vali Loss: 0.630 Vali Acc: 0.819 Test Loss: 0.630 Test Acc: 0.819
Validation loss decreased (-0.791657 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 0.8512568473815918
Epoch: 6, Steps: 7 | Train Loss: 0.217 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.8435676097869873
Epoch: 7, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.7769346237182617
Epoch: 8, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.9007911682128906
Epoch: 9, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.8776543140411377
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7539262771606445
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.931 Test Loss: 0.292 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.7591750621795654
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.931 Test Loss: 0.291 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.6711225509643555
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8338305950164795
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7638294696807861
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7465767860412598
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.830291748046875
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0353283882141113
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.905411958694458
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8987128734588623
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8793504238128662
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7963416576385498
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps171_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 31830540
model size : 136.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps171_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.574968099594116
Epoch: 1, Steps: 7 | Train Loss: 2.654 Vali Loss: 2.483 Vali Acc: 0.083 Test Loss: 2.483 Test Acc: 0.083
Validation loss decreased (inf --> -0.083309).  Saving model ...
Epoch: 2 cost time: 0.6245510578155518
Epoch: 2, Steps: 7 | Train Loss: 2.394 Vali Loss: 2.225 Vali Acc: 0.472 Test Loss: 2.225 Test Acc: 0.472
Validation loss decreased (-0.083309 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 0.6710875034332275
Epoch: 3, Steps: 7 | Train Loss: 2.035 Vali Loss: 1.886 Vali Acc: 0.625 Test Loss: 1.886 Test Acc: 0.625
Validation loss decreased (-0.472200 --> -0.624981).  Saving model ...
Epoch: 4 cost time: 0.7938318252563477
Epoch: 4, Steps: 7 | Train Loss: 1.576 Vali Loss: 1.403 Vali Acc: 0.708 Test Loss: 1.403 Test Acc: 0.708
Validation loss decreased (-0.624981 --> -0.708319).  Saving model ...
Epoch: 5 cost time: 0.6379354000091553
Epoch: 5, Steps: 7 | Train Loss: 0.999 Vali Loss: 0.952 Vali Acc: 0.833 Test Loss: 0.952 Test Acc: 0.833
Validation loss decreased (-0.708319 --> -0.833324).  Saving model ...
Epoch: 6 cost time: 0.8491933345794678
Epoch: 6, Steps: 7 | Train Loss: 0.519 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.6290297508239746
Epoch: 7, Steps: 7 | Train Loss: 0.227 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
Validation loss decreased (-0.833328 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.7092232704162598
Epoch: 8, Steps: 7 | Train Loss: 0.084 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.7549901008605957
Epoch: 9, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6986246109008789
Epoch: 10, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.8566105365753174
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.7722320556640625
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8369112014770508
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.7415552139282227
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.7854301929473877
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.7501587867736816
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7583515644073486
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7421135902404785
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7366299629211426
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5906381607055664
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7233517169952393
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6675446033477783
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7100725173950195
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7396318912506104
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6659748554229736
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps171_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 31701516
model size : 135.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps171_str171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.059509515762329
Epoch: 1, Steps: 7 | Train Loss: 2.575 Vali Loss: 2.532 Vali Acc: 0.125 Test Loss: 2.532 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7138652801513672
Epoch: 2, Steps: 7 | Train Loss: 2.356 Vali Loss: 2.185 Vali Acc: 0.403 Test Loss: 2.185 Test Acc: 0.403
Validation loss decreased (-0.124975 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.7492399215698242
Epoch: 3, Steps: 7 | Train Loss: 2.019 Vali Loss: 1.812 Vali Acc: 0.639 Test Loss: 1.812 Test Acc: 0.639
Validation loss decreased (-0.402756 --> -0.638871).  Saving model ...
Epoch: 4 cost time: 0.6671750545501709
Epoch: 4, Steps: 7 | Train Loss: 1.653 Vali Loss: 1.494 Vali Acc: 0.750 Test Loss: 1.494 Test Acc: 0.750
Validation loss decreased (-0.638871 --> -0.749985).  Saving model ...
Epoch: 5 cost time: 0.663283109664917
Epoch: 5, Steps: 7 | Train Loss: 1.270 Vali Loss: 1.105 Vali Acc: 0.806 Test Loss: 1.105 Test Acc: 0.806
Validation loss decreased (-0.749985 --> -0.805545).  Saving model ...
Epoch: 6 cost time: 0.73868727684021
Epoch: 6, Steps: 7 | Train Loss: 0.765 Vali Loss: 0.762 Vali Acc: 0.847 Test Loss: 0.762 Test Acc: 0.847
Validation loss decreased (-0.805545 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 0.5962653160095215
Epoch: 7, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.531 Vali Acc: 0.847 Test Loss: 0.531 Test Acc: 0.847
Validation loss decreased (-0.847215 --> -0.847217).  Saving model ...
Epoch: 8 cost time: 0.8376047611236572
Epoch: 8, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.847217 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.77168869972229
Epoch: 9, Steps: 7 | Train Loss: 0.086 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.6692180633544922
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.7859785556793213
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.717491865158081
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.7527360916137695
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.5923373699188232
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6752502918243408
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.6322536468505859
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7909598350524902
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7742438316345215
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7675161361694336
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6882600784301758
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.903 Test Loss: 0.322 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.816713809967041
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7246015071868896
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7030630111694336
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8884086608886719
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7888081073760986
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.903 Test Loss: 0.313 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5524313449859619
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps171_str171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 31647756
model size : 135.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.264209270477295
Epoch: 1, Steps: 7 | Train Loss: 2.605 Vali Loss: 2.469 Vali Acc: 0.181 Test Loss: 2.469 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.9037861824035645
Epoch: 2, Steps: 7 | Train Loss: 2.285 Vali Loss: 1.993 Vali Acc: 0.528 Test Loss: 1.993 Test Acc: 0.528
Validation loss decreased (-0.180531 --> -0.527758).  Saving model ...
Epoch: 3 cost time: 1.1796314716339111
Epoch: 3, Steps: 7 | Train Loss: 1.795 Vali Loss: 1.518 Vali Acc: 0.667 Test Loss: 1.518 Test Acc: 0.667
Validation loss decreased (-0.527758 --> -0.666651).  Saving model ...
Epoch: 4 cost time: 0.8474471569061279
Epoch: 4, Steps: 7 | Train Loss: 1.216 Vali Loss: 0.995 Vali Acc: 0.736 Test Loss: 0.995 Test Acc: 0.736
Validation loss decreased (-0.666651 --> -0.736101).  Saving model ...
Epoch: 5 cost time: 0.8270337581634521
Epoch: 5, Steps: 7 | Train Loss: 0.573 Vali Loss: 0.616 Vali Acc: 0.847 Test Loss: 0.616 Test Acc: 0.847
Validation loss decreased (-0.736101 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.7992322444915771
Epoch: 6, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7104599475860596
Epoch: 7, Steps: 7 | Train Loss: 0.073 Vali Loss: 0.406 Vali Acc: 0.861 Test Loss: 0.406 Test Acc: 0.861
Validation loss decreased (-0.847216 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.768364429473877
Epoch: 8, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.8319435119628906
Epoch: 9, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8951339721679688
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7884271144866943
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8704257011413574
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.940549373626709
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6317274570465088
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.8555474281311035
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0132830142974854
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.9872965812683105
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.7572171688079834
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.9053432941436768
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.8915243148803711
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.7882299423217773
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8544533252716064
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8655149936676025
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 24 cost time: 0.7745881080627441
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 1.020423173904419
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 1.0058531761169434
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.9465951919555664
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.8990156650543213
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.917 Test Loss: 0.219 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.0157487392425537
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 0.8277177810668945
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 31 cost time: 0.8174872398376465
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 32 cost time: 0.972916841506958
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 33 cost time: 0.9084656238555908
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9238533973693848
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8753261566162109
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7723658084869385
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8600039482116699
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.790398120880127
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.931 Test Loss: 0.213 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8355441093444824
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7226946353912354
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7592730522155762
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8071293830871582
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.931 Test Loss: 0.216 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6921536922454834
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7887639999389648
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5962207317352295
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6043906211853027
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.610844612121582
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 32188428
model size : 137.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.415633201599121
Epoch: 1, Steps: 7 | Train Loss: 2.709 Vali Loss: 2.578 Vali Acc: 0.181 Test Loss: 2.578 Test Acc: 0.181
Validation loss decreased (inf --> -0.180530).  Saving model ...
Epoch: 2 cost time: 0.6414098739624023
Epoch: 2, Steps: 7 | Train Loss: 2.438 Vali Loss: 2.182 Vali Acc: 0.417 Test Loss: 2.182 Test Acc: 0.417
Validation loss decreased (-0.180530 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.6693441867828369
Epoch: 3, Steps: 7 | Train Loss: 2.031 Vali Loss: 1.828 Vali Acc: 0.708 Test Loss: 1.828 Test Acc: 0.708
Validation loss decreased (-0.416645 --> -0.708315).  Saving model ...
Epoch: 4 cost time: 0.806943416595459
Epoch: 4, Steps: 7 | Train Loss: 1.631 Vali Loss: 1.401 Vali Acc: 0.792 Test Loss: 1.401 Test Acc: 0.792
Validation loss decreased (-0.708315 --> -0.791653).  Saving model ...
Epoch: 5 cost time: 0.6511871814727783
Epoch: 5, Steps: 7 | Train Loss: 1.121 Vali Loss: 0.916 Vali Acc: 0.833 Test Loss: 0.916 Test Acc: 0.833
Validation loss decreased (-0.791653 --> -0.833324).  Saving model ...
Epoch: 6 cost time: 0.7703721523284912
Epoch: 6, Steps: 7 | Train Loss: 0.589 Vali Loss: 0.636 Vali Acc: 0.903 Test Loss: 0.636 Test Acc: 0.903
Validation loss decreased (-0.833324 --> -0.902771).  Saving model ...
Epoch: 7 cost time: 0.881493330001831
Epoch: 7, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.378 Vali Acc: 0.931 Test Loss: 0.378 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.8951826095581055
Epoch: 8, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7160987854003906
Epoch: 9, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6744632720947266
Epoch: 10, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7668633460998535
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 0.7825841903686523
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 0.6991631984710693
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 0.7724251747131348
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.61871337890625
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.931 Test Loss: 0.163 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8138494491577148
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.931 Test Loss: 0.164 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.782151460647583
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8559191226959229
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7311501502990723
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.931 Test Loss: 0.165 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9046411514282227
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.8524441719055176
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.7174651622772217
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.7077770233154297
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8191399574279785
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.786801815032959
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7505192756652832
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.7996890544891357
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 28 cost time: 0.6720011234283447
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5913078784942627
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6846134662628174
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7429640293121338
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.49027419090270996
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.931 Test Loss: 0.158 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6681272983551025
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6957342624664307
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7997231483459473
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.150 Vali Acc: 0.944 Test Loss: 0.150 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8042929172515869
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.944 Test Loss: 0.150 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6952683925628662
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.944 Test Loss: 0.150 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 32080908
model size : 137.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0252838134765625
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.430 Vali Acc: 0.069 Test Loss: 2.430 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.7270498275756836
Epoch: 2, Steps: 7 | Train Loss: 2.403 Vali Loss: 2.156 Vali Acc: 0.458 Test Loss: 2.156 Test Acc: 0.458
Validation loss decreased (-0.069420 --> -0.458312).  Saving model ...
Epoch: 3 cost time: 0.6739151477813721
Epoch: 3, Steps: 7 | Train Loss: 2.026 Vali Loss: 1.835 Vali Acc: 0.764 Test Loss: 1.835 Test Acc: 0.764
Validation loss decreased (-0.458312 --> -0.763871).  Saving model ...
Epoch: 4 cost time: 0.5976407527923584
Epoch: 4, Steps: 7 | Train Loss: 1.611 Vali Loss: 1.480 Vali Acc: 0.792 Test Loss: 1.480 Test Acc: 0.792
Validation loss decreased (-0.763871 --> -0.791652).  Saving model ...
Epoch: 5 cost time: 0.7410626411437988
Epoch: 5, Steps: 7 | Train Loss: 1.204 Vali Loss: 1.042 Vali Acc: 0.806 Test Loss: 1.042 Test Acc: 0.806
Validation loss decreased (-0.791652 --> -0.805545).  Saving model ...
Epoch: 6 cost time: 0.6995487213134766
Epoch: 6, Steps: 7 | Train Loss: 0.750 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
Validation loss decreased (-0.805545 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.645153284072876
Epoch: 7, Steps: 7 | Train Loss: 0.389 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5757179260253906
Epoch: 8, Steps: 7 | Train Loss: 0.193 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.874993 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.7340080738067627
Epoch: 9, Steps: 7 | Train Loss: 0.089 Vali Loss: 0.384 Vali Acc: 0.903 Test Loss: 0.384 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.6319389343261719
Epoch: 10, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6451656818389893
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6542096138000488
Epoch: 12, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.6741366386413574
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7069571018218994
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6923320293426514
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7052736282348633
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6986010074615479
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6113388538360596
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7536702156066895
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7541189193725586
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5963966846466064
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.599614143371582
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 32027148
model size : 136.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps240_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3025081157684326
Epoch: 1, Steps: 7 | Train Loss: 2.587 Vali Loss: 2.383 Vali Acc: 0.194 Test Loss: 2.383 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.7477989196777344
Epoch: 2, Steps: 7 | Train Loss: 2.286 Vali Loss: 1.972 Vali Acc: 0.667 Test Loss: 1.972 Test Acc: 0.667
Validation loss decreased (-0.194421 --> -0.666647).  Saving model ...
Epoch: 3 cost time: 0.6902272701263428
Epoch: 3, Steps: 7 | Train Loss: 1.802 Vali Loss: 1.446 Vali Acc: 0.750 Test Loss: 1.446 Test Acc: 0.750
Validation loss decreased (-0.666647 --> -0.749986).  Saving model ...
Epoch: 4 cost time: 0.8425049781799316
Epoch: 4, Steps: 7 | Train Loss: 1.230 Vali Loss: 0.894 Vali Acc: 0.847 Test Loss: 0.894 Test Acc: 0.847
Validation loss decreased (-0.749986 --> -0.847213).  Saving model ...
Epoch: 5 cost time: 0.8282589912414551
Epoch: 5, Steps: 7 | Train Loss: 0.602 Vali Loss: 0.532 Vali Acc: 0.847 Test Loss: 0.532 Test Acc: 0.847
Validation loss decreased (-0.847213 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 0.8648197650909424
Epoch: 6, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.8484983444213867
Epoch: 7, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.847813606262207
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.9605610370635986
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.8843097686767578
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.889 Test Loss: 0.212 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7661986351013184
Epoch: 11, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.903 Test Loss: 0.191 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9019005298614502
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.917 Test Loss: 0.185 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9519448280334473
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.730973482131958
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8094396591186523
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0162534713745117
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9304537773132324
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.903 Test Loss: 0.194 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8843650817871094
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8860924243927002
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps240_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 32698380
model size : 139.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9164073467254639
Epoch: 1, Steps: 7 | Train Loss: 2.624 Vali Loss: 2.523 Vali Acc: 0.069 Test Loss: 2.523 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.6534249782562256
Epoch: 2, Steps: 7 | Train Loss: 2.371 Vali Loss: 2.175 Vali Acc: 0.444 Test Loss: 2.175 Test Acc: 0.444
Validation loss decreased (-0.069419 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.6177611351013184
Epoch: 3, Steps: 7 | Train Loss: 1.958 Vali Loss: 1.776 Vali Acc: 0.750 Test Loss: 1.776 Test Acc: 0.750
Validation loss decreased (-0.444423 --> -0.749982).  Saving model ...
Epoch: 4 cost time: 0.6095352172851562
Epoch: 4, Steps: 7 | Train Loss: 1.446 Vali Loss: 1.176 Vali Acc: 0.833 Test Loss: 1.176 Test Acc: 0.833
Validation loss decreased (-0.749982 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 0.6173586845397949
Epoch: 5, Steps: 7 | Train Loss: 0.925 Vali Loss: 0.749 Vali Acc: 0.861 Test Loss: 0.749 Test Acc: 0.861
Validation loss decreased (-0.833322 --> -0.861104).  Saving model ...
Epoch: 6 cost time: 0.5203306674957275
Epoch: 6, Steps: 7 | Train Loss: 0.458 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888884).  Saving model ...
Epoch: 7 cost time: 0.4734506607055664
Epoch: 7, Steps: 7 | Train Loss: 0.185 Vali Loss: 0.421 Vali Acc: 0.917 Test Loss: 0.421 Test Acc: 0.917
Validation loss decreased (-0.888884 --> -0.916662).  Saving model ...
Epoch: 8 cost time: 0.6515679359436035
Epoch: 8, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5503900051116943
Epoch: 9, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.315 Vali Acc: 0.875 Test Loss: 0.315 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6764843463897705
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6890952587127686
Epoch: 11, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6561503410339355
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6784408092498779
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.282 Vali Acc: 0.875 Test Loss: 0.282 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6177358627319336
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6191625595092773
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5852086544036865
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6913120746612549
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 32612364
model size : 139.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps240_str240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2409820556640625
Epoch: 1, Steps: 7 | Train Loss: 2.604 Vali Loss: 2.507 Vali Acc: 0.125 Test Loss: 2.507 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.6019847393035889
Epoch: 2, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.213 Vali Acc: 0.347 Test Loss: 2.213 Test Acc: 0.347
Validation loss decreased (-0.124975 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.6675810813903809
Epoch: 3, Steps: 7 | Train Loss: 2.010 Vali Loss: 1.889 Vali Acc: 0.639 Test Loss: 1.889 Test Acc: 0.639
Validation loss decreased (-0.347200 --> -0.638870).  Saving model ...
Epoch: 4 cost time: 0.6997659206390381
Epoch: 4, Steps: 7 | Train Loss: 1.605 Vali Loss: 1.544 Vali Acc: 0.681 Test Loss: 1.544 Test Acc: 0.681
Validation loss decreased (-0.638870 --> -0.680540).  Saving model ...
Epoch: 5 cost time: 0.5940160751342773
Epoch: 5, Steps: 7 | Train Loss: 1.160 Vali Loss: 1.169 Vali Acc: 0.736 Test Loss: 1.169 Test Acc: 0.736
Validation loss decreased (-0.680540 --> -0.736099).  Saving model ...
Epoch: 6 cost time: 0.6814713478088379
Epoch: 6, Steps: 7 | Train Loss: 0.750 Vali Loss: 0.854 Vali Acc: 0.819 Test Loss: 0.854 Test Acc: 0.819
Validation loss decreased (-0.736099 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 0.5948364734649658
Epoch: 7, Steps: 7 | Train Loss: 0.443 Vali Loss: 0.721 Vali Acc: 0.806 Test Loss: 0.721 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5671000480651855
Epoch: 8, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.7131717205047607
Epoch: 9, Steps: 7 | Train Loss: 0.119 Vali Loss: 0.470 Vali Acc: 0.847 Test Loss: 0.470 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6050252914428711
Epoch: 10, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6860263347625732
Epoch: 11, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.719684362411499
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6439638137817383
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.435 Vali Acc: 0.847 Test Loss: 0.435 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6227681636810303
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.432 Vali Acc: 0.847 Test Loss: 0.432 Test Acc: 0.847
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6658651828765869
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.847 Test Loss: 0.418 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6157503128051758
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.399 Vali Acc: 0.847 Test Loss: 0.399 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7385902404785156
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.387 Vali Acc: 0.847 Test Loss: 0.387 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6882174015045166
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 0.6926381587982178
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.706545352935791
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.397 Vali Acc: 0.847 Test Loss: 0.397 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6263213157653809
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.847 Test Loss: 0.401 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6501178741455078
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.847 Test Loss: 0.403 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5491695404052734
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6496777534484863
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.861 Test Loss: 0.406 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.557075023651123
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.847 Test Loss: 0.408 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5717160701751709
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.847 Test Loss: 0.408 Test Acc: 0.847
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6689453125
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6910545825958252
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.403 Vali Acc: 0.847 Test Loss: 0.403 Test Acc: 0.847
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el4_dm768_df768_ps240_str240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8611111111111112
model parameter : 32569356
model size : 138.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.336036443710327
Epoch: 1, Steps: 7 | Train Loss: 2.626 Vali Loss: 2.329 Vali Acc: 0.319 Test Loss: 2.329 Test Acc: 0.319
Validation loss decreased (inf --> -0.319421).  Saving model ...
Epoch: 2 cost time: 1.2487766742706299
Epoch: 2, Steps: 7 | Train Loss: 2.128 Vali Loss: 1.687 Vali Acc: 0.597 Test Loss: 1.687 Test Acc: 0.597
Validation loss decreased (-0.319421 --> -0.597205).  Saving model ...
Epoch: 3 cost time: 1.112684726715088
Epoch: 3, Steps: 7 | Train Loss: 1.304 Vali Loss: 0.887 Vali Acc: 0.806 Test Loss: 0.887 Test Acc: 0.806
Validation loss decreased (-0.597205 --> -0.805547).  Saving model ...
Epoch: 4 cost time: 1.1578633785247803
Epoch: 4, Steps: 7 | Train Loss: 0.500 Vali Loss: 0.568 Vali Acc: 0.819 Test Loss: 0.568 Test Acc: 0.819
Validation loss decreased (-0.805547 --> -0.819439).  Saving model ...
Epoch: 5 cost time: 1.0291032791137695
Epoch: 5, Steps: 7 | Train Loss: 0.269 Vali Loss: 0.561 Vali Acc: 0.847 Test Loss: 0.561 Test Acc: 0.847
Validation loss decreased (-0.819439 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 1.0703485012054443
Epoch: 6, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.377 Vali Acc: 0.903 Test Loss: 0.377 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.0069425106048584
Epoch: 7, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.9841690063476562
Epoch: 8, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.9790499210357666
Epoch: 9, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0120723247528076
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.9497649669647217
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.917 Test Loss: 0.358 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1293542385101318
Epoch: 12, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9506688117980957
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1779487133026123
Epoch: 14, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 1.0944368839263916
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.931 Test Loss: 0.309 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.913262128829956
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6075563430786133
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.903 Test Loss: 0.386 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0988328456878662
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0802268981933594
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.917 Test Loss: 0.522 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9438354969024658
Epoch: 20, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.499 Vali Acc: 0.917 Test Loss: 0.499 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.230849027633667
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.889 Test Loss: 0.736 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.122241735458374
Epoch: 22, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1296815872192383
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0731241703033447
Epoch: 24, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.544 Vali Acc: 0.917 Test Loss: 0.544 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23816460
model size : 105.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4813945293426514
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.404 Vali Acc: 0.153 Test Loss: 2.404 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.9729983806610107
Epoch: 2, Steps: 7 | Train Loss: 2.321 Vali Loss: 2.080 Vali Acc: 0.472 Test Loss: 2.080 Test Acc: 0.472
Validation loss decreased (-0.152754 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 0.9054551124572754
Epoch: 3, Steps: 7 | Train Loss: 1.717 Vali Loss: 1.422 Vali Acc: 0.792 Test Loss: 1.422 Test Acc: 0.792
Validation loss decreased (-0.472201 --> -0.791652).  Saving model ...
Epoch: 4 cost time: 0.7066538333892822
Epoch: 4, Steps: 7 | Train Loss: 1.115 Vali Loss: 0.823 Vali Acc: 0.861 Test Loss: 0.823 Test Acc: 0.861
Validation loss decreased (-0.791652 --> -0.861103).  Saving model ...
Epoch: 5 cost time: 0.8570482730865479
Epoch: 5, Steps: 7 | Train Loss: 0.519 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
Validation loss decreased (-0.861103 --> -0.888884).  Saving model ...
Epoch: 6 cost time: 0.9976806640625
Epoch: 6, Steps: 7 | Train Loss: 0.241 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7391433715820312
Epoch: 7, Steps: 7 | Train Loss: 0.113 Vali Loss: 0.354 Vali Acc: 0.903 Test Loss: 0.354 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.8847544193267822
Epoch: 8, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.7273995876312256
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6910161972045898
Epoch: 10, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.8222594261169434
Epoch: 11, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.357 Vali Acc: 0.931 Test Loss: 0.357 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 12 cost time: 0.8840827941894531
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.903 Test Loss: 0.425 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.743133544921875
Epoch: 13, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.795112133026123
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8635046482086182
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8803846836090088
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0626776218414307
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0658822059631348
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7203872203826904
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7255110740661621
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.067211389541626
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23300364
model size : 103.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.5333356857299805
Epoch: 1, Steps: 7 | Train Loss: 2.643 Vali Loss: 2.528 Vali Acc: 0.111 Test Loss: 2.528 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5919761657714844
Epoch: 2, Steps: 7 | Train Loss: 2.403 Vali Loss: 2.213 Vali Acc: 0.278 Test Loss: 2.213 Test Acc: 0.278
Validation loss decreased (-0.111086 --> -0.277756).  Saving model ...
Epoch: 3 cost time: 0.72090744972229
Epoch: 3, Steps: 7 | Train Loss: 2.038 Vali Loss: 1.831 Vali Acc: 0.653 Test Loss: 1.831 Test Acc: 0.653
Validation loss decreased (-0.277756 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.9799561500549316
Epoch: 4, Steps: 7 | Train Loss: 1.544 Vali Loss: 1.370 Vali Acc: 0.778 Test Loss: 1.370 Test Acc: 0.778
Validation loss decreased (-0.652759 --> -0.777764).  Saving model ...
Epoch: 5 cost time: 0.5722217559814453
Epoch: 5, Steps: 7 | Train Loss: 1.060 Vali Loss: 0.899 Vali Acc: 0.806 Test Loss: 0.899 Test Acc: 0.806
Validation loss decreased (-0.777764 --> -0.805547).  Saving model ...
Epoch: 6 cost time: 0.7568707466125488
Epoch: 6, Steps: 7 | Train Loss: 0.620 Vali Loss: 0.597 Vali Acc: 0.847 Test Loss: 0.597 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847216).  Saving model ...
Epoch: 7 cost time: 0.8239257335662842
Epoch: 7, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
Validation loss decreased (-0.847216 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.9352095127105713
Epoch: 8, Steps: 7 | Train Loss: 0.118 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9086980819702148
Epoch: 9, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.8210422992706299
Epoch: 10, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.874996 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7231495380401611
Epoch: 11, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6917777061462402
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9230599403381348
Epoch: 13, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0033800601959229
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8284249305725098
Epoch: 15, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 1.060706377029419
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.8449056148529053
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9943275451660156
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.010756015777588
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6834456920623779
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8600437641143799
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8496546745300293
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 0.96197509765625
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 0.9205126762390137
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.9413967132568359
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.931 Test Loss: 0.180 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 0.6674659252166748
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 27 cost time: 0.7588722705841064
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 28 cost time: 0.7370302677154541
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.90936279296875
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7140631675720215
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6699566841125488
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.931 Test Loss: 0.175 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7174992561340332
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.772850751876831
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 34 cost time: 0.74582839012146
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.6699919700622559
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7149574756622314
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.68349289894104
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6480498313903809
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6815357208251953
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.686119556427002
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6262917518615723
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6429603099822998
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6669070720672607
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.931 Test Loss: 0.171 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 44 cost time: 0.6884286403656006
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 45 cost time: 0.7447659969329834
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7620546817779541
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6131174564361572
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7599244117736816
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8239943981170654
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.931 Test Loss: 0.172 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7525193691253662
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23042316
model size : 102.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2996349334716797
Epoch: 1, Steps: 7 | Train Loss: 2.573 Vali Loss: 2.358 Vali Acc: 0.153 Test Loss: 2.358 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 0.8817830085754395
Epoch: 2, Steps: 7 | Train Loss: 2.215 Vali Loss: 1.817 Vali Acc: 0.486 Test Loss: 1.817 Test Acc: 0.486
Validation loss decreased (-0.152754 --> -0.486093).  Saving model ...
Epoch: 3 cost time: 1.168323040008545
Epoch: 3, Steps: 7 | Train Loss: 1.477 Vali Loss: 1.189 Vali Acc: 0.778 Test Loss: 1.189 Test Acc: 0.778
Validation loss decreased (-0.486093 --> -0.777766).  Saving model ...
Epoch: 4 cost time: 0.9786219596862793
Epoch: 4, Steps: 7 | Train Loss: 0.763 Vali Loss: 0.663 Vali Acc: 0.861 Test Loss: 0.663 Test Acc: 0.861
Validation loss decreased (-0.777766 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 0.9775209426879883
Epoch: 5, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
Validation loss decreased (-0.861104 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 0.8671987056732178
Epoch: 6, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.334 Vali Acc: 0.903 Test Loss: 0.334 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.029665231704712
Epoch: 7, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.104278564453125
Epoch: 8, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.573 Vali Acc: 0.889 Test Loss: 0.573 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0534007549285889
Epoch: 9, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.429 Vali Acc: 0.903 Test Loss: 0.429 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1092209815979004
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.516 Vali Acc: 0.889 Test Loss: 0.516 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0584626197814941
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8822450637817383
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.889 Test Loss: 0.582 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0339717864990234
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 14 cost time: 1.100046157836914
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 1.1342792510986328
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.959568977355957
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1711721420288086
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.931 Test Loss: 0.355 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 18 cost time: 0.9357669353485107
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.931 Test Loss: 0.363 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.949892520904541
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.931 Test Loss: 0.368 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0474531650543213
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.931 Test Loss: 0.370 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.06809401512146
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.931 Test Loss: 0.373 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.206465244293213
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.931 Test Loss: 0.374 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0666615962982178
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.931 Test Loss: 0.377 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9887852668762207
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8284432888031006
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.917 Test Loss: 0.383 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.948148250579834
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.917 Test Loss: 0.393 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9591419696807861
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23768844
model size : 105.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2574214935302734
Epoch: 1, Steps: 7 | Train Loss: 2.671 Vali Loss: 2.452 Vali Acc: 0.097 Test Loss: 2.452 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.8067517280578613
Epoch: 2, Steps: 7 | Train Loss: 2.348 Vali Loss: 2.078 Vali Acc: 0.306 Test Loss: 2.078 Test Acc: 0.306
Validation loss decreased (-0.097198 --> -0.305535).  Saving model ...
Epoch: 3 cost time: 0.7375702857971191
Epoch: 3, Steps: 7 | Train Loss: 1.918 Vali Loss: 1.621 Vali Acc: 0.708 Test Loss: 1.621 Test Acc: 0.708
Validation loss decreased (-0.305535 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 0.864736795425415
Epoch: 4, Steps: 7 | Train Loss: 1.370 Vali Loss: 1.204 Vali Acc: 0.792 Test Loss: 1.204 Test Acc: 0.792
Validation loss decreased (-0.708317 --> -0.791655).  Saving model ...
Epoch: 5 cost time: 0.872412919998169
Epoch: 5, Steps: 7 | Train Loss: 0.684 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.791655 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 0.8729772567749023
Epoch: 6, Steps: 7 | Train Loss: 0.305 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.7079000473022461
Epoch: 7, Steps: 7 | Train Loss: 0.111 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.6389815807342529
Epoch: 8, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.493 Vali Acc: 0.903 Test Loss: 0.493 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6057529449462891
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.750 Vali Acc: 0.889 Test Loss: 0.750 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7757225036621094
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6423826217651367
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6605856418609619
Epoch: 12, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7694110870361328
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 0.8049945831298828
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.344 Vali Acc: 0.931 Test Loss: 0.344 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 15 cost time: 0.7426431179046631
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7673208713531494
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6970188617706299
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8552029132843018
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7456989288330078
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9359598159790039
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9908797740936279
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.917 Test Loss: 0.325 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7293601036071777
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7633123397827148
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6504058837890625
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.931 Test Loss: 0.314 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 25 cost time: 0.8687148094177246
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 26 cost time: 0.7673242092132568
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.931 Test Loss: 0.308 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 27 cost time: 0.8141577243804932
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 28 cost time: 0.8528025150299072
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.931 Test Loss: 0.305 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.8062233924865723
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 30 cost time: 0.8866546154022217
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6120033264160156
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7404882907867432
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8932032585144043
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.931 Test Loss: 0.311 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7991607189178467
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7832052707672119
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7209644317626953
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7715892791748047
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.931 Test Loss: 0.313 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8582353591918945
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.791752815246582
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.931 Test Loss: 0.310 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23306508
model size : 103.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0874462127685547
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.496 Vali Acc: 0.083 Test Loss: 2.496 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.5859277248382568
Epoch: 2, Steps: 7 | Train Loss: 2.446 Vali Loss: 2.279 Vali Acc: 0.250 Test Loss: 2.279 Test Acc: 0.250
Validation loss decreased (-0.083308 --> -0.249977).  Saving model ...
Epoch: 3 cost time: 0.6899521350860596
Epoch: 3, Steps: 7 | Train Loss: 2.101 Vali Loss: 1.975 Vali Acc: 0.500 Test Loss: 1.975 Test Acc: 0.500
Validation loss decreased (-0.249977 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 0.5690670013427734
Epoch: 4, Steps: 7 | Train Loss: 1.635 Vali Loss: 1.524 Vali Acc: 0.722 Test Loss: 1.524 Test Acc: 0.722
Validation loss decreased (-0.499980 --> -0.722207).  Saving model ...
Epoch: 5 cost time: 0.45804738998413086
Epoch: 5, Steps: 7 | Train Loss: 1.165 Vali Loss: 1.035 Vali Acc: 0.764 Test Loss: 1.035 Test Acc: 0.764
Validation loss decreased (-0.722207 --> -0.763879).  Saving model ...
Epoch: 6 cost time: 0.6715288162231445
Epoch: 6, Steps: 7 | Train Loss: 0.779 Vali Loss: 0.677 Vali Acc: 0.847 Test Loss: 0.677 Test Acc: 0.847
Validation loss decreased (-0.763879 --> -0.847215).  Saving model ...
Epoch: 7 cost time: 0.6199672222137451
Epoch: 7, Steps: 7 | Train Loss: 0.371 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
Validation loss decreased (-0.847215 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.561068058013916
Epoch: 8, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.485 Vali Acc: 0.847 Test Loss: 0.485 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.904918909072876
Epoch: 9, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902774).  Saving model ...
Epoch: 10 cost time: 0.5780587196350098
Epoch: 10, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8854401111602783
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7508730888366699
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.725273847579956
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9036831855773926
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8585193157196045
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8130202293395996
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.322 Vali Acc: 0.861 Test Loss: 0.322 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5646305084228516
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.903 Test Loss: 0.315 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 18 cost time: 0.548943042755127
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6571128368377686
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 20 cost time: 0.6227047443389893
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.714958906173706
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8116354942321777
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6953535079956055
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8316495418548584
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.713446855545044
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6032619476318359
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8070480823516846
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8076517581939697
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.700878381729126
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 23059212
model size : 102.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3788015842437744
Epoch: 1, Steps: 7 | Train Loss: 2.673 Vali Loss: 2.411 Vali Acc: 0.167 Test Loss: 2.411 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 1.0995519161224365
Epoch: 2, Steps: 7 | Train Loss: 2.299 Vali Loss: 2.030 Vali Acc: 0.528 Test Loss: 2.030 Test Acc: 0.528
Validation loss decreased (-0.166643 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.9786243438720703
Epoch: 3, Steps: 7 | Train Loss: 1.611 Vali Loss: 1.372 Vali Acc: 0.583 Test Loss: 1.372 Test Acc: 0.583
Validation loss decreased (-0.527757 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 1.09084153175354
Epoch: 4, Steps: 7 | Train Loss: 0.870 Vali Loss: 0.749 Vali Acc: 0.806 Test Loss: 0.749 Test Acc: 0.806
Validation loss decreased (-0.583320 --> -0.805548).  Saving model ...
Epoch: 5 cost time: 0.6896700859069824
Epoch: 5, Steps: 7 | Train Loss: 0.320 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
Validation loss decreased (-0.805548 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.0857696533203125
Epoch: 6, Steps: 7 | Train Loss: 0.068 Vali Loss: 0.336 Vali Acc: 0.903 Test Loss: 0.336 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.9353997707366943
Epoch: 7, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 1.0667970180511475
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9022331237792969
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.889 Test Loss: 0.621 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1110880374908447
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.903 Test Loss: 0.474 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0545077323913574
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.889 Test Loss: 0.713 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9919116497039795
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.917 Test Loss: 0.364 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 13 cost time: 1.122985601425171
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 1.0157911777496338
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.1326868534088135
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 1.093139886856079
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.8279221057891846
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1076841354370117
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9003055095672607
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7334389686584473
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.90932297706604
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8567783832550049
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7960147857666016
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8228576183319092
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8208911418914795
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7742352485656738
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23735052
model size : 105.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2394981384277344
Epoch: 1, Steps: 7 | Train Loss: 2.599 Vali Loss: 2.388 Vali Acc: 0.181 Test Loss: 2.388 Test Acc: 0.181
Validation loss decreased (inf --> -0.180532).  Saving model ...
Epoch: 2 cost time: 0.8986225128173828
Epoch: 2, Steps: 7 | Train Loss: 2.294 Vali Loss: 2.105 Vali Acc: 0.417 Test Loss: 2.105 Test Acc: 0.417
Validation loss decreased (-0.180532 --> -0.416646).  Saving model ...
Epoch: 3 cost time: 0.9571883678436279
Epoch: 3, Steps: 7 | Train Loss: 1.898 Vali Loss: 1.622 Vali Acc: 0.694 Test Loss: 1.622 Test Acc: 0.694
Validation loss decreased (-0.416646 --> -0.694428).  Saving model ...
Epoch: 4 cost time: 0.9338974952697754
Epoch: 4, Steps: 7 | Train Loss: 1.267 Vali Loss: 1.089 Vali Acc: 0.792 Test Loss: 1.089 Test Acc: 0.792
Validation loss decreased (-0.694428 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 0.6561586856842041
Epoch: 5, Steps: 7 | Train Loss: 0.682 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.791656 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 0.9744031429290771
Epoch: 6, Steps: 7 | Train Loss: 0.320 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.981626033782959
Epoch: 7, Steps: 7 | Train Loss: 0.133 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7937452793121338
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 1.0379571914672852
Epoch: 9, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.7674887180328369
Epoch: 10, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.7906627655029297
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.958275556564331
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.224 Vali Acc: 0.931 Test Loss: 0.224 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.7993974685668945
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7382562160491943
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7260653972625732
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.903 Test Loss: 0.193 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5560307502746582
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8121554851531982
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8778030872344971
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.917 Test Loss: 0.180 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8131687641143799
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.917 Test Loss: 0.168 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7421450614929199
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.917 Test Loss: 0.163 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9809985160827637
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9093170166015625
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.917 Test Loss: 0.161 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23315724
model size : 103.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8984885215759277
Epoch: 1, Steps: 7 | Train Loss: 2.677 Vali Loss: 2.575 Vali Acc: 0.097 Test Loss: 2.575 Test Acc: 0.097
Validation loss decreased (inf --> -0.097196).  Saving model ...
Epoch: 2 cost time: 0.7020795345306396
Epoch: 2, Steps: 7 | Train Loss: 2.416 Vali Loss: 2.245 Vali Acc: 0.264 Test Loss: 2.245 Test Acc: 0.264
Validation loss decreased (-0.097196 --> -0.263866).  Saving model ...
Epoch: 3 cost time: 0.6425368785858154
Epoch: 3, Steps: 7 | Train Loss: 2.098 Vali Loss: 1.949 Vali Acc: 0.500 Test Loss: 1.949 Test Acc: 0.500
Validation loss decreased (-0.263866 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 0.7814018726348877
Epoch: 4, Steps: 7 | Train Loss: 1.694 Vali Loss: 1.650 Vali Acc: 0.722 Test Loss: 1.650 Test Acc: 0.722
Validation loss decreased (-0.499981 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 0.6717426776885986
Epoch: 5, Steps: 7 | Train Loss: 1.350 Vali Loss: 1.266 Vali Acc: 0.819 Test Loss: 1.266 Test Acc: 0.819
Validation loss decreased (-0.722206 --> -0.819432).  Saving model ...
Epoch: 6 cost time: 0.6735570430755615
Epoch: 6, Steps: 7 | Train Loss: 0.853 Vali Loss: 0.766 Vali Acc: 0.875 Test Loss: 0.766 Test Acc: 0.875
Validation loss decreased (-0.819432 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.6956090927124023
Epoch: 7, Steps: 7 | Train Loss: 0.465 Vali Loss: 0.463 Vali Acc: 0.903 Test Loss: 0.463 Test Acc: 0.903
Validation loss decreased (-0.874992 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.8165321350097656
Epoch: 8, Steps: 7 | Train Loss: 0.237 Vali Loss: 0.387 Vali Acc: 0.861 Test Loss: 0.387 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7763798236846924
Epoch: 9, Steps: 7 | Train Loss: 0.115 Vali Loss: 0.335 Vali Acc: 0.931 Test Loss: 0.335 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.8310732841491699
Epoch: 10, Steps: 7 | Train Loss: 0.042 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7303600311279297
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.903 Test Loss: 0.292 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7346985340118408
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8537116050720215
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.931 Test Loss: 0.267 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.4926872253417969
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.931 Test Loss: 0.268 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7264611721038818
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6120815277099609
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.931 Test Loss: 0.284 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8067550659179688
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.931 Test Loss: 0.288 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7661128044128418
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5539352893829346
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.672978401184082
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6490142345428467
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.271 Vali Acc: 0.931 Test Loss: 0.271 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7185959815979004
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7699744701385498
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23089932
model size : 102.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4233741760253906
Epoch: 1, Steps: 7 | Train Loss: 2.683 Vali Loss: 2.393 Vali Acc: 0.208 Test Loss: 2.393 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 1.1107661724090576
Epoch: 2, Steps: 7 | Train Loss: 2.368 Vali Loss: 1.935 Vali Acc: 0.486 Test Loss: 1.935 Test Acc: 0.486
Validation loss decreased (-0.208309 --> -0.486092).  Saving model ...
Epoch: 3 cost time: 1.1114180088043213
Epoch: 3, Steps: 7 | Train Loss: 1.588 Vali Loss: 1.360 Vali Acc: 0.708 Test Loss: 1.360 Test Acc: 0.708
Validation loss decreased (-0.486092 --> -0.708320).  Saving model ...
Epoch: 4 cost time: 0.8097691535949707
Epoch: 4, Steps: 7 | Train Loss: 0.829 Vali Loss: 0.721 Vali Acc: 0.819 Test Loss: 0.721 Test Acc: 0.819
Validation loss decreased (-0.708320 --> -0.819437).  Saving model ...
Epoch: 5 cost time: 0.995070219039917
Epoch: 5, Steps: 7 | Train Loss: 0.276 Vali Loss: 0.411 Vali Acc: 0.847 Test Loss: 0.411 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847218).  Saving model ...
Epoch: 6 cost time: 1.1251952648162842
Epoch: 6, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 7 cost time: 0.9506716728210449
Epoch: 7, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.025831937789917
Epoch: 8, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.861107 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.0119588375091553
Epoch: 9, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0476512908935547
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.903 Test Loss: 0.535 Test Acc: 0.903
Validation loss decreased (-0.874994 --> -0.902772).  Saving model ...
Epoch: 11 cost time: 0.8879909515380859
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.903 Test Loss: 0.512 Test Acc: 0.903
Validation loss decreased (-0.902772 --> -0.902773).  Saving model ...
Epoch: 12 cost time: 0.9412684440612793
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.903 Test Loss: 0.512 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9237966537475586
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.903 Test Loss: 0.526 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9531242847442627
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.889 Test Loss: 0.539 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9039483070373535
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9216451644897461
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.953202486038208
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0108754634857178
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9704952239990234
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.059546947479248
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0951242446899414
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 23762700
model size : 105.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3163363933563232
Epoch: 1, Steps: 7 | Train Loss: 2.636 Vali Loss: 2.492 Vali Acc: 0.125 Test Loss: 2.492 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.901392936706543
Epoch: 2, Steps: 7 | Train Loss: 2.375 Vali Loss: 2.145 Vali Acc: 0.458 Test Loss: 2.145 Test Acc: 0.458
Validation loss decreased (-0.124975 --> -0.458312).  Saving model ...
Epoch: 3 cost time: 0.943169355392456
Epoch: 3, Steps: 7 | Train Loss: 1.869 Vali Loss: 1.632 Vali Acc: 0.708 Test Loss: 1.632 Test Acc: 0.708
Validation loss decreased (-0.458312 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 0.8957309722900391
Epoch: 4, Steps: 7 | Train Loss: 1.283 Vali Loss: 1.131 Vali Acc: 0.819 Test Loss: 1.131 Test Acc: 0.819
Validation loss decreased (-0.708317 --> -0.819433).  Saving model ...
Epoch: 5 cost time: 0.7736115455627441
Epoch: 5, Steps: 7 | Train Loss: 0.656 Vali Loss: 0.603 Vali Acc: 0.847 Test Loss: 0.603 Test Acc: 0.847
Validation loss decreased (-0.819433 --> -0.847216).  Saving model ...
Epoch: 6 cost time: 0.8152110576629639
Epoch: 6, Steps: 7 | Train Loss: 0.236 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
Validation loss decreased (-0.847216 --> -0.847217).  Saving model ...
Epoch: 7 cost time: 0.9790122509002686
Epoch: 7, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
Validation loss decreased (-0.847217 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.8890905380249023
Epoch: 8, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.8967137336730957
Epoch: 9, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.493 Vali Acc: 0.861 Test Loss: 0.493 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9677190780639648
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8359601497650146
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8220500946044922
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7177202701568604
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.903 Test Loss: 0.309 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.777111291885376
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9785881042480469
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8803648948669434
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.308 Vali Acc: 0.903 Test Loss: 0.308 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9132065773010254
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.312 Vali Acc: 0.903 Test Loss: 0.312 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7002911567687988
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 23321868
model size : 103.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.378408432006836
Epoch: 1, Steps: 7 | Train Loss: 2.693 Vali Loss: 2.488 Vali Acc: 0.125 Test Loss: 2.488 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.7832164764404297
Epoch: 2, Steps: 7 | Train Loss: 2.454 Vali Loss: 2.252 Vali Acc: 0.417 Test Loss: 2.252 Test Acc: 0.417
Validation loss decreased (-0.124975 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 0.8122696876525879
Epoch: 3, Steps: 7 | Train Loss: 2.124 Vali Loss: 1.983 Vali Acc: 0.514 Test Loss: 1.983 Test Acc: 0.514
Validation loss decreased (-0.416644 --> -0.513869).  Saving model ...
Epoch: 4 cost time: 0.7763721942901611
Epoch: 4, Steps: 7 | Train Loss: 1.767 Vali Loss: 1.602 Vali Acc: 0.819 Test Loss: 1.602 Test Acc: 0.819
Validation loss decreased (-0.513869 --> -0.819428).  Saving model ...
Epoch: 5 cost time: 0.9439036846160889
Epoch: 5, Steps: 7 | Train Loss: 1.265 Vali Loss: 1.195 Vali Acc: 0.833 Test Loss: 1.195 Test Acc: 0.833
Validation loss decreased (-0.819428 --> -0.833321).  Saving model ...
Epoch: 6 cost time: 0.7027554512023926
Epoch: 6, Steps: 7 | Train Loss: 0.799 Vali Loss: 0.725 Vali Acc: 0.861 Test Loss: 0.725 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.7943542003631592
Epoch: 7, Steps: 7 | Train Loss: 0.401 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
Validation loss decreased (-0.861104 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 0.931027889251709
Epoch: 8, Steps: 7 | Train Loss: 0.189 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.9930193424224854
Epoch: 9, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.420 Vali Acc: 0.847 Test Loss: 0.420 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8743531703948975
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7133326530456543
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.389 Vali Acc: 0.875 Test Loss: 0.389 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6708002090454102
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.813244104385376
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8779280185699463
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 0.7501575946807861
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8639731407165527
Epoch: 16, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.399 Vali Acc: 0.875 Test Loss: 0.399 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8703391551971436
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8779397010803223
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6917128562927246
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8037991523742676
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.861 Test Loss: 0.370 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.893507719039917
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7635881900787354
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9072997570037842
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.982893705368042
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 23106828
model size : 102.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps57_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4047064781188965
Epoch: 1, Steps: 7 | Train Loss: 2.617 Vali Loss: 2.399 Vali Acc: 0.208 Test Loss: 2.399 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.8489947319030762
Epoch: 2, Steps: 7 | Train Loss: 2.295 Vali Loss: 1.955 Vali Acc: 0.528 Test Loss: 1.955 Test Acc: 0.528
Validation loss decreased (-0.208309 --> -0.527758).  Saving model ...
Epoch: 3 cost time: 1.1183037757873535
Epoch: 3, Steps: 7 | Train Loss: 1.605 Vali Loss: 1.331 Vali Acc: 0.819 Test Loss: 1.331 Test Acc: 0.819
Validation loss decreased (-0.527758 --> -0.819431).  Saving model ...
Epoch: 4 cost time: 1.066410779953003
Epoch: 4, Steps: 7 | Train Loss: 0.886 Vali Loss: 0.643 Vali Acc: 0.833 Test Loss: 0.643 Test Acc: 0.833
Validation loss decreased (-0.819431 --> -0.833327).  Saving model ...
Epoch: 5 cost time: 0.7412354946136475
Epoch: 5, Steps: 7 | Train Loss: 0.320 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
Validation loss decreased (-0.833327 --> -0.888885).  Saving model ...
Epoch: 6 cost time: 1.0816094875335693
Epoch: 6, Steps: 7 | Train Loss: 0.095 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0787906646728516
Epoch: 7, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.8358194828033447
Epoch: 8, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0966613292694092
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.447 Vali Acc: 0.917 Test Loss: 0.447 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.046781301498413
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.351 Vali Acc: 0.931 Test Loss: 0.351 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 1.062455654144287
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0573301315307617
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0385441780090332
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.315 Vali Acc: 0.931 Test Loss: 0.315 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930552).  Saving model ...
Epoch: 14 cost time: 1.1348316669464111
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.931 Test Loss: 0.294 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.0454018115997314
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8856909275054932
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0839424133300781
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.917 Test Loss: 0.282 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9991812705993652
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.952960729598999
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9489891529083252
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0041165351867676
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7056224346160889
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 23 cost time: 0.8664438724517822
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8570375442504883
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.965162992477417
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 26 cost time: 0.8302099704742432
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.8493881225585938
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8671884536743164
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 29 cost time: 0.8479890823364258
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.8901212215423584
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9243488311767578
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8226141929626465
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.9324355125427246
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.769420862197876
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6963624954223633
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6881906986236572
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8787579536437988
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8891208171844482
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 1.0044488906860352
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9432284832000732
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9828498363494873
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9620862007141113
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7150514125823975
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7507827281951904
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8927273750305176
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.093212604522705
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9005622863769531
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8790490627288818
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps57_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23736588
model size : 105.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps57_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3982203006744385
Epoch: 1, Steps: 7 | Train Loss: 2.646 Vali Loss: 2.486 Vali Acc: 0.181 Test Loss: 2.486 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.906010627746582
Epoch: 2, Steps: 7 | Train Loss: 2.301 Vali Loss: 2.130 Vali Acc: 0.403 Test Loss: 2.130 Test Acc: 0.403
Validation loss decreased (-0.180531 --> -0.402756).  Saving model ...
Epoch: 3 cost time: 0.9703795909881592
Epoch: 3, Steps: 7 | Train Loss: 1.889 Vali Loss: 1.666 Vali Acc: 0.667 Test Loss: 1.666 Test Acc: 0.667
Validation loss decreased (-0.402756 --> -0.666650).  Saving model ...
Epoch: 4 cost time: 0.8220903873443604
Epoch: 4, Steps: 7 | Train Loss: 1.359 Vali Loss: 1.109 Vali Acc: 0.792 Test Loss: 1.109 Test Acc: 0.792
Validation loss decreased (-0.666650 --> -0.791656).  Saving model ...
Epoch: 5 cost time: 0.7400143146514893
Epoch: 5, Steps: 7 | Train Loss: 0.767 Vali Loss: 0.694 Vali Acc: 0.819 Test Loss: 0.694 Test Acc: 0.819
Validation loss decreased (-0.791656 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 0.7391984462738037
Epoch: 6, Steps: 7 | Train Loss: 0.346 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 0.9962091445922852
Epoch: 7, Steps: 7 | Train Loss: 0.170 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.8196892738342285
Epoch: 8, Steps: 7 | Train Loss: 0.078 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 1.0148706436157227
Epoch: 9, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.9250123500823975
Epoch: 10, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.9417951107025146
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9637086391448975
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.246 Vali Acc: 0.903 Test Loss: 0.246 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8189561367034912
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6797912120819092
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.903 Test Loss: 0.211 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.992595911026001
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 0.9269688129425049
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 1.0715694427490234
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.732550859451294
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8748927116394043
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7801845073699951
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7972521781921387
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7651307582855225
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6715025901794434
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0131783485412598
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8328166007995605
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0358097553253174
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9607048034667969
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps57_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23338764
model size : 103.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps57_str57_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2330517768859863
Epoch: 1, Steps: 7 | Train Loss: 2.683 Vali Loss: 2.554 Vali Acc: 0.028 Test Loss: 2.554 Test Acc: 0.028
Validation loss decreased (inf --> -0.027752).  Saving model ...
Epoch: 2 cost time: 0.6046631336212158
Epoch: 2, Steps: 7 | Train Loss: 2.427 Vali Loss: 2.226 Vali Acc: 0.319 Test Loss: 2.226 Test Acc: 0.319
Validation loss decreased (-0.027752 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 0.8617284297943115
Epoch: 3, Steps: 7 | Train Loss: 2.137 Vali Loss: 1.890 Vali Acc: 0.472 Test Loss: 1.890 Test Acc: 0.472
Validation loss decreased (-0.319422 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 0.9213724136352539
Epoch: 4, Steps: 7 | Train Loss: 1.753 Vali Loss: 1.506 Vali Acc: 0.708 Test Loss: 1.506 Test Acc: 0.708
Validation loss decreased (-0.472203 --> -0.708318).  Saving model ...
Epoch: 5 cost time: 0.6574411392211914
Epoch: 5, Steps: 7 | Train Loss: 1.265 Vali Loss: 1.019 Vali Acc: 0.778 Test Loss: 1.019 Test Acc: 0.778
Validation loss decreased (-0.708318 --> -0.777768).  Saving model ...
Epoch: 6 cost time: 0.6780309677124023
Epoch: 6, Steps: 7 | Train Loss: 0.785 Vali Loss: 0.619 Vali Acc: 0.903 Test Loss: 0.619 Test Acc: 0.903
Validation loss decreased (-0.777768 --> -0.902772).  Saving model ...
Epoch: 7 cost time: 0.7706832885742188
Epoch: 7, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.412 Vali Acc: 0.917 Test Loss: 0.412 Test Acc: 0.917
Validation loss decreased (-0.902772 --> -0.916663).  Saving model ...
Epoch: 8 cost time: 0.6584358215332031
Epoch: 8, Steps: 7 | Train Loss: 0.171 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.676074743270874
Epoch: 9, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7127101421356201
Epoch: 10, Steps: 7 | Train Loss: 0.028 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6398663520812988
Epoch: 11, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7216687202453613
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6469576358795166
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6125748157501221
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.903 Test Loss: 0.241 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6111085414886475
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.529353141784668
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.6289725303649902
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 0.7766001224517822
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.744464635848999
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5711278915405273
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.741215705871582
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7674329280853271
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5377631187438965
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.903 Test Loss: 0.220 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6787681579589844
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7198238372802734
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7795131206512451
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.903 Test Loss: 0.218 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.800612211227417
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.903 Test Loss: 0.213 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps57_str57_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 23134476
model size : 102.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.574587345123291
Epoch: 1, Steps: 7 | Train Loss: 2.550 Vali Loss: 2.335 Vali Acc: 0.292 Test Loss: 2.335 Test Acc: 0.292
Validation loss decreased (inf --> -0.291643).  Saving model ...
Epoch: 2 cost time: 0.8449909687042236
Epoch: 2, Steps: 7 | Train Loss: 2.132 Vali Loss: 1.821 Vali Acc: 0.667 Test Loss: 1.821 Test Acc: 0.667
Validation loss decreased (-0.291643 --> -0.666648).  Saving model ...
Epoch: 3 cost time: 0.9182922840118408
Epoch: 3, Steps: 7 | Train Loss: 1.544 Vali Loss: 1.239 Vali Acc: 0.764 Test Loss: 1.239 Test Acc: 0.764
Validation loss decreased (-0.666648 --> -0.763876).  Saving model ...
Epoch: 4 cost time: 0.7788333892822266
Epoch: 4, Steps: 7 | Train Loss: 0.850 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.763876 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 0.9839668273925781
Epoch: 5, Steps: 7 | Train Loss: 0.290 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 0.9745988845825195
Epoch: 6, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.345 Vali Acc: 0.889 Test Loss: 0.345 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.7641057968139648
Epoch: 7, Steps: 7 | Train Loss: 0.087 Vali Loss: 0.611 Vali Acc: 0.889 Test Loss: 0.611 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8403763771057129
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7437505722045898
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.903 Test Loss: 0.458 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 10 cost time: 0.7072405815124512
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.931 Test Loss: 0.334 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 11 cost time: 0.7596704959869385
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.8078961372375488
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8128695487976074
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9643831253051758
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.8891685009002686
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7942492961883545
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9507567882537842
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.947373628616333
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8494167327880859
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9757335186004639
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8362736701965332
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7281169891357422
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8860232830047607
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7765481472015381
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 23767308
model size : 105.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.318431854248047
Epoch: 1, Steps: 7 | Train Loss: 2.606 Vali Loss: 2.417 Vali Acc: 0.167 Test Loss: 2.417 Test Acc: 0.167
Validation loss decreased (inf --> -0.166643).  Saving model ...
Epoch: 2 cost time: 0.6527447700500488
Epoch: 2, Steps: 7 | Train Loss: 2.307 Vali Loss: 2.121 Vali Acc: 0.486 Test Loss: 2.121 Test Acc: 0.486
Validation loss decreased (-0.166643 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 0.8231692314147949
Epoch: 3, Steps: 7 | Train Loss: 1.909 Vali Loss: 1.647 Vali Acc: 0.750 Test Loss: 1.647 Test Acc: 0.750
Validation loss decreased (-0.486090 --> -0.749984).  Saving model ...
Epoch: 4 cost time: 0.5842146873474121
Epoch: 4, Steps: 7 | Train Loss: 1.333 Vali Loss: 1.086 Vali Acc: 0.833 Test Loss: 1.086 Test Acc: 0.833
Validation loss decreased (-0.749984 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 0.6700928211212158
Epoch: 5, Steps: 7 | Train Loss: 0.787 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.7673301696777344
Epoch: 6, Steps: 7 | Train Loss: 0.360 Vali Loss: 0.464 Vali Acc: 0.847 Test Loss: 0.464 Test Acc: 0.847
Validation loss decreased (-0.833327 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.625119686126709
Epoch: 7, Steps: 7 | Train Loss: 0.106 Vali Loss: 0.358 Vali Acc: 0.903 Test Loss: 0.358 Test Acc: 0.903
Validation loss decreased (-0.847218 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.7261314392089844
Epoch: 8, Steps: 7 | Train Loss: 0.045 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.8192660808563232
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.8791406154632568
Epoch: 10, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7861568927764893
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 12 cost time: 0.8115849494934082
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.285 Vali Acc: 0.931 Test Loss: 0.285 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.888331413269043
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7274928092956543
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.958 Test Loss: 0.266 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7393362522125244
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9091963768005371
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7912125587463379
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6324870586395264
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9058008193969727
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8933262825012207
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7698848247528076
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 23358732
model size : 103.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3474280834198
Epoch: 1, Steps: 7 | Train Loss: 2.612 Vali Loss: 2.493 Vali Acc: 0.139 Test Loss: 2.493 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.7621803283691406
Epoch: 2, Steps: 7 | Train Loss: 2.329 Vali Loss: 2.201 Vali Acc: 0.292 Test Loss: 2.201 Test Acc: 0.292
Validation loss decreased (-0.138864 --> -0.291645).  Saving model ...
Epoch: 3 cost time: 0.6716892719268799
Epoch: 3, Steps: 7 | Train Loss: 2.065 Vali Loss: 1.884 Vali Acc: 0.708 Test Loss: 1.884 Test Acc: 0.708
Validation loss decreased (-0.291645 --> -0.708314).  Saving model ...
Epoch: 4 cost time: 0.6121232509613037
Epoch: 4, Steps: 7 | Train Loss: 1.669 Vali Loss: 1.504 Vali Acc: 0.764 Test Loss: 1.504 Test Acc: 0.764
Validation loss decreased (-0.708314 --> -0.763874).  Saving model ...
Epoch: 5 cost time: 0.6259052753448486
Epoch: 5, Steps: 7 | Train Loss: 1.243 Vali Loss: 1.101 Vali Acc: 0.819 Test Loss: 1.101 Test Acc: 0.819
Validation loss decreased (-0.763874 --> -0.819433).  Saving model ...
Epoch: 6 cost time: 0.7424678802490234
Epoch: 6, Steps: 7 | Train Loss: 0.849 Vali Loss: 0.713 Vali Acc: 0.861 Test Loss: 0.713 Test Acc: 0.861
Validation loss decreased (-0.819433 --> -0.861104).  Saving model ...
Epoch: 7 cost time: 0.6338667869567871
Epoch: 7, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.466 Vali Acc: 0.903 Test Loss: 0.466 Test Acc: 0.903
Validation loss decreased (-0.861104 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.6642897129058838
Epoch: 8, Steps: 7 | Train Loss: 0.215 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5292375087738037
Epoch: 9, Steps: 7 | Train Loss: 0.091 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5813503265380859
Epoch: 10, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6564645767211914
Epoch: 11, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.6867992877960205
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.6509277820587158
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6361923217773438
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6412353515625
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 0.5071628093719482
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4728517532348633
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6882119178771973
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6914968490600586
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7935292720794678
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7630031108856201
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.7864315509796143
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.8163495063781738
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7850019931793213
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7850542068481445
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7544612884521484
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6921741962432861
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8666274547576904
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7436575889587402
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5752542018890381
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8224105834960938
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6707408428192139
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23154444
model size : 102.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps63_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4860947132110596
Epoch: 1, Steps: 7 | Train Loss: 2.648 Vali Loss: 2.385 Vali Acc: 0.153 Test Loss: 2.385 Test Acc: 0.153
Validation loss decreased (inf --> -0.152754).  Saving model ...
Epoch: 2 cost time: 1.0105140209197998
Epoch: 2, Steps: 7 | Train Loss: 2.239 Vali Loss: 1.872 Vali Acc: 0.556 Test Loss: 1.872 Test Acc: 0.556
Validation loss decreased (-0.152754 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 0.9389402866363525
Epoch: 3, Steps: 7 | Train Loss: 1.536 Vali Loss: 1.212 Vali Acc: 0.833 Test Loss: 1.212 Test Acc: 0.833
Validation loss decreased (-0.555537 --> -0.833321).  Saving model ...
Epoch: 4 cost time: 0.9993674755096436
Epoch: 4, Steps: 7 | Train Loss: 0.740 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861105).  Saving model ...
Epoch: 5 cost time: 1.0162794589996338
Epoch: 5, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
Validation loss decreased (-0.861105 --> -0.902773).  Saving model ...
Epoch: 6 cost time: 0.8643276691436768
Epoch: 6, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.375 Vali Acc: 0.931 Test Loss: 0.375 Test Acc: 0.931
Validation loss decreased (-0.902773 --> -0.930552).  Saving model ...
Epoch: 7 cost time: 1.0816550254821777
Epoch: 7, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7468094825744629
Epoch: 8, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.440 Vali Acc: 0.931 Test Loss: 0.440 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0452358722686768
Epoch: 9, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930554).  Saving model ...
Epoch: 10 cost time: 0.921884298324585
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.930554 --> -0.972221).  Saving model ...
Epoch: 11 cost time: 1.1435506343841553
Epoch: 11, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 12 cost time: 1.0233409404754639
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 13 cost time: 0.7546229362487793
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 14 cost time: 0.9179565906524658
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 15 cost time: 0.8197073936462402
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8495147228240967
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7141351699829102
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7729401588439941
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6675577163696289
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.958 Test Loss: 0.101 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7862191200256348
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.958 Test Loss: 0.103 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7393643856048584
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.958 Test Loss: 0.104 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8235287666320801
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8468856811523438
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8597593307495117
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps63_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 23755020
model size : 105.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps63_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0798776149749756
Epoch: 1, Steps: 7 | Train Loss: 2.571 Vali Loss: 2.427 Vali Acc: 0.194 Test Loss: 2.427 Test Acc: 0.194
Validation loss decreased (inf --> -0.194420).  Saving model ...
Epoch: 2 cost time: 0.6165127754211426
Epoch: 2, Steps: 7 | Train Loss: 2.286 Vali Loss: 2.099 Vali Acc: 0.472 Test Loss: 2.099 Test Acc: 0.472
Validation loss decreased (-0.194420 --> -0.472201).  Saving model ...
Epoch: 3 cost time: 0.8091697692871094
Epoch: 3, Steps: 7 | Train Loss: 1.764 Vali Loss: 1.513 Vali Acc: 0.806 Test Loss: 1.513 Test Acc: 0.806
Validation loss decreased (-0.472201 --> -0.805540).  Saving model ...
Epoch: 4 cost time: 0.6172373294830322
Epoch: 4, Steps: 7 | Train Loss: 1.120 Vali Loss: 0.935 Vali Acc: 0.819 Test Loss: 0.935 Test Acc: 0.819
Validation loss decreased (-0.805540 --> -0.819435).  Saving model ...
Epoch: 5 cost time: 0.8143830299377441
Epoch: 5, Steps: 7 | Train Loss: 0.549 Vali Loss: 0.596 Vali Acc: 0.806 Test Loss: 0.596 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.737858772277832
Epoch: 6, Steps: 7 | Train Loss: 0.209 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
Validation loss decreased (-0.819435 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 0.8133642673492432
Epoch: 7, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.889 Test Loss: 0.288 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.7221527099609375
Epoch: 8, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.6291415691375732
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6561181545257568
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6872448921203613
Epoch: 11, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.8271443843841553
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.903954029083252
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7324514389038086
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9405200481414795
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.996889591217041
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6825389862060547
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.903 Test Loss: 0.214 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0001566410064697
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.903 Test Loss: 0.210 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8526999950408936
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8354294300079346
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.903 Test Loss: 0.209 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8461434841156006
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps63_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23378700
model size : 103.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps63_str63_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8485372066497803
Epoch: 1, Steps: 7 | Train Loss: 2.579 Vali Loss: 2.476 Vali Acc: 0.153 Test Loss: 2.476 Test Acc: 0.153
Validation loss decreased (inf --> -0.152753).  Saving model ...
Epoch: 2 cost time: 0.6088595390319824
Epoch: 2, Steps: 7 | Train Loss: 2.519 Vali Loss: 2.256 Vali Acc: 0.431 Test Loss: 2.256 Test Acc: 0.431
Validation loss decreased (-0.152753 --> -0.430533).  Saving model ...
Epoch: 3 cost time: 0.6327176094055176
Epoch: 3, Steps: 7 | Train Loss: 2.111 Vali Loss: 1.993 Vali Acc: 0.597 Test Loss: 1.993 Test Acc: 0.597
Validation loss decreased (-0.430533 --> -0.597202).  Saving model ...
Epoch: 4 cost time: 0.6269822120666504
Epoch: 4, Steps: 7 | Train Loss: 1.717 Vali Loss: 1.622 Vali Acc: 0.806 Test Loss: 1.622 Test Acc: 0.806
Validation loss decreased (-0.597202 --> -0.805539).  Saving model ...
Epoch: 5 cost time: 0.6359202861785889
Epoch: 5, Steps: 7 | Train Loss: 1.278 Vali Loss: 1.092 Vali Acc: 0.861 Test Loss: 1.092 Test Acc: 0.861
Validation loss decreased (-0.805539 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 0.6361684799194336
Epoch: 6, Steps: 7 | Train Loss: 0.805 Vali Loss: 0.720 Vali Acc: 0.847 Test Loss: 0.720 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49207305908203125
Epoch: 7, Steps: 7 | Train Loss: 0.351 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
Validation loss decreased (-0.861100 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.7885165214538574
Epoch: 8, Steps: 7 | Train Loss: 0.152 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (-0.888884 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.8524537086486816
Epoch: 9, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7472290992736816
Epoch: 10, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6097750663757324
Epoch: 11, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9160101413726807
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.577195405960083
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.903 Test Loss: 0.270 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6975095272064209
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5906939506530762
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.9018878936767578
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8169906139373779
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.931 Test Loss: 0.238 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.796208381652832
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7203686237335205
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8198113441467285
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8822264671325684
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7733545303344727
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8458108901977539
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8648462295532227
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9005782604217529
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps63_str63_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23195916
model size : 103.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3119544982910156
Epoch: 1, Steps: 7 | Train Loss: 2.597 Vali Loss: 2.416 Vali Acc: 0.222 Test Loss: 2.416 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 1.0335981845855713
Epoch: 2, Steps: 7 | Train Loss: 2.245 Vali Loss: 1.973 Vali Acc: 0.611 Test Loss: 1.973 Test Acc: 0.611
Validation loss decreased (-0.222198 --> -0.611091).  Saving model ...
Epoch: 3 cost time: 0.9409809112548828
Epoch: 3, Steps: 7 | Train Loss: 1.621 Vali Loss: 1.351 Vali Acc: 0.722 Test Loss: 1.351 Test Acc: 0.722
Validation loss decreased (-0.611091 --> -0.722209).  Saving model ...
Epoch: 4 cost time: 1.0095539093017578
Epoch: 4, Steps: 7 | Train Loss: 0.902 Vali Loss: 0.767 Vali Acc: 0.889 Test Loss: 0.767 Test Acc: 0.889
Validation loss decreased (-0.722209 --> -0.888881).  Saving model ...
Epoch: 5 cost time: 0.9074013233184814
Epoch: 5, Steps: 7 | Train Loss: 0.354 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0702764987945557
Epoch: 6, Steps: 7 | Train Loss: 0.123 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.96142578125
Epoch: 7, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.431 Vali Acc: 0.903 Test Loss: 0.431 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.9309632778167725
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0615122318267822
Epoch: 9, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.847 Test Loss: 0.624 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1671466827392578
Epoch: 10, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1377313137054443
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.903 Test Loss: 0.359 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.9973647594451904
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2062089443206787
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1028661727905273
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 15 cost time: 0.9805686473846436
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1105866432189941
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9307420253753662
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0570015907287598
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0963530540466309
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9321095943450928
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.917 Test Loss: 0.347 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0922603607177734
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.917 Test Loss: 0.344 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9553842544555664
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6369855403900146
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.917 Test Loss: 0.336 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8637988567352295
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 25 cost time: 0.7429819107055664
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 26 cost time: 0.8514859676361084
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8143932819366455
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6812868118286133
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9957666397094727
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9447104930877686
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9477212429046631
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9458560943603516
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6888973712921143
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9830198287963867
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.917 Test Loss: 0.338 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9585530757904053
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.917 Test Loss: 0.337 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 23767308
model size : 105.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0152368545532227
Epoch: 1, Steps: 7 | Train Loss: 2.601 Vali Loss: 2.479 Vali Acc: 0.236 Test Loss: 2.479 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 0.5895805358886719
Epoch: 2, Steps: 7 | Train Loss: 2.270 Vali Loss: 2.067 Vali Acc: 0.458 Test Loss: 2.067 Test Acc: 0.458
Validation loss decreased (-0.236086 --> -0.458313).  Saving model ...
Epoch: 3 cost time: 0.8740463256835938
Epoch: 3, Steps: 7 | Train Loss: 1.857 Vali Loss: 1.628 Vali Acc: 0.694 Test Loss: 1.628 Test Acc: 0.694
Validation loss decreased (-0.458313 --> -0.694428).  Saving model ...
Epoch: 4 cost time: 0.6661534309387207
Epoch: 4, Steps: 7 | Train Loss: 1.331 Vali Loss: 1.210 Vali Acc: 0.736 Test Loss: 1.210 Test Acc: 0.736
Validation loss decreased (-0.694428 --> -0.736099).  Saving model ...
Epoch: 5 cost time: 0.8436939716339111
Epoch: 5, Steps: 7 | Train Loss: 0.796 Vali Loss: 0.722 Vali Acc: 0.819 Test Loss: 0.722 Test Acc: 0.819
Validation loss decreased (-0.736099 --> -0.819437).  Saving model ...
Epoch: 6 cost time: 0.7879102230072021
Epoch: 6, Steps: 7 | Train Loss: 0.355 Vali Loss: 0.422 Vali Acc: 0.847 Test Loss: 0.422 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.7276628017425537
Epoch: 7, Steps: 7 | Train Loss: 0.130 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
Validation loss decreased (-0.847218 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.8392021656036377
Epoch: 8, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.6352596282958984
Epoch: 9, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8462722301483154
Epoch: 10, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7390282154083252
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.903 Test Loss: 0.301 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6924068927764893
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5899138450622559
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6782939434051514
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7960467338562012
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.931 Test Loss: 0.214 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.8856112957000732
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.755469799041748
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 0.8262100219726562
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 0.6568257808685303
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.917 Test Loss: 0.202 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7010180950164795
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7848606109619141
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.728154182434082
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7329287528991699
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6461870670318604
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5844144821166992
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5388586521148682
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8969776630401611
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7523050308227539
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23412492
model size : 103.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9688315391540527
Epoch: 1, Steps: 7 | Train Loss: 2.665 Vali Loss: 2.512 Vali Acc: 0.097 Test Loss: 2.512 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.7788064479827881
Epoch: 2, Steps: 7 | Train Loss: 2.418 Vali Loss: 2.238 Vali Acc: 0.403 Test Loss: 2.238 Test Acc: 0.403
Validation loss decreased (-0.097197 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.58573317527771
Epoch: 3, Steps: 7 | Train Loss: 2.105 Vali Loss: 1.987 Vali Acc: 0.556 Test Loss: 1.987 Test Acc: 0.556
Validation loss decreased (-0.402755 --> -0.555536).  Saving model ...
Epoch: 4 cost time: 0.779167890548706
Epoch: 4, Steps: 7 | Train Loss: 1.771 Vali Loss: 1.629 Vali Acc: 0.861 Test Loss: 1.629 Test Acc: 0.861
Validation loss decreased (-0.555536 --> -0.861095).  Saving model ...
Epoch: 5 cost time: 0.6993930339813232
Epoch: 5, Steps: 7 | Train Loss: 1.357 Vali Loss: 1.180 Vali Acc: 0.917 Test Loss: 1.180 Test Acc: 0.917
Validation loss decreased (-0.861095 --> -0.916655).  Saving model ...
Epoch: 6 cost time: 0.8868951797485352
Epoch: 6, Steps: 7 | Train Loss: 0.873 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8809859752655029
Epoch: 7, Steps: 7 | Train Loss: 0.461 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7353730201721191
Epoch: 8, Steps: 7 | Train Loss: 0.205 Vali Loss: 0.327 Vali Acc: 0.931 Test Loss: 0.327 Test Acc: 0.931
Validation loss decreased (-0.916655 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.5676229000091553
Epoch: 9, Steps: 7 | Train Loss: 0.080 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6498770713806152
Epoch: 10, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.6658599376678467
Epoch: 11, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7396502494812012
Epoch: 12, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
Validation loss decreased (-0.930553 --> -0.958331).  Saving model ...
Epoch: 13 cost time: 0.6301817893981934
Epoch: 13, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.6823940277099609
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.6716148853302002
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.6894595623016357
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5922529697418213
Epoch: 17, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 18 cost time: 0.6357135772705078
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.972 Test Loss: 0.186 Test Acc: 0.972
Validation loss decreased (-0.958331 --> -0.972220).  Saving model ...
Epoch: 19 cost time: 0.8353524208068848
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 20 cost time: 0.7013750076293945
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 21 cost time: 0.8944528102874756
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972221).  Saving model ...
Epoch: 22 cost time: 0.7367880344390869
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.784508228302002
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8286213874816895
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6958732604980469
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 0.6032016277313232
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 27 cost time: 0.622351884841919
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4942624568939209
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.753298282623291
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5933892726898193
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6843655109405518
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7946574687957764
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6401820182800293
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8454785346984863
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.734734296798706
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7348325252532959
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.972221 --> -0.972221).  Saving model ...
Epoch: 37 cost time: 0.7627110481262207
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7404108047485352
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8375759124755859
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6645872592926025
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6128835678100586
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7931854724884033
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6209135055541992
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8304193019866943
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7392048835754395
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7461647987365723
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9722222222222222
model parameter : 23229708
model size : 103.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps71_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3735437393188477
Epoch: 1, Steps: 7 | Train Loss: 2.605 Vali Loss: 2.341 Vali Acc: 0.306 Test Loss: 2.341 Test Acc: 0.306
Validation loss decreased (inf --> -0.305532).  Saving model ...
Epoch: 2 cost time: 0.8865530490875244
Epoch: 2, Steps: 7 | Train Loss: 2.218 Vali Loss: 1.896 Vali Acc: 0.528 Test Loss: 1.896 Test Acc: 0.528
Validation loss decreased (-0.305532 --> -0.527759).  Saving model ...
Epoch: 3 cost time: 0.8297746181488037
Epoch: 3, Steps: 7 | Train Loss: 1.643 Vali Loss: 1.295 Vali Acc: 0.792 Test Loss: 1.295 Test Acc: 0.792
Validation loss decreased (-0.527759 --> -0.791654).  Saving model ...
Epoch: 4 cost time: 0.8694138526916504
Epoch: 4, Steps: 7 | Train Loss: 0.888 Vali Loss: 0.697 Vali Acc: 0.833 Test Loss: 0.697 Test Acc: 0.833
Validation loss decreased (-0.791654 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 0.8854691982269287
Epoch: 5, Steps: 7 | Train Loss: 0.357 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.833326 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.7750627994537354
Epoch: 6, Steps: 7 | Train Loss: 0.137 Vali Loss: 0.303 Vali Acc: 0.903 Test Loss: 0.303 Test Acc: 0.903
Validation loss decreased (-0.874995 --> -0.902775).  Saving model ...
Epoch: 7 cost time: 0.782008171081543
Epoch: 7, Steps: 7 | Train Loss: 0.025 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7359805107116699
Epoch: 8, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 1.0748636722564697
Epoch: 9, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0434238910675049
Epoch: 10, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9781625270843506
Epoch: 11, Steps: 7 | Train Loss: 0.066 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 1.0184056758880615
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.70308518409729
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.803417444229126
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.931 Test Loss: 0.290 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.033203363418579
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 1.0593163967132568
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.8382973670959473
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 1.0936288833618164
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9424123764038086
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8649072647094727
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8147494792938232
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8920314311981201
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.163240671157837
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9122605323791504
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9329483509063721
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.138770580291748
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7994482517242432
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps71_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23779596
model size : 105.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps71_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.504335880279541
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.405 Vali Acc: 0.139 Test Loss: 2.405 Test Acc: 0.139
Validation loss decreased (inf --> -0.138865).  Saving model ...
Epoch: 2 cost time: 0.6549122333526611
Epoch: 2, Steps: 7 | Train Loss: 2.266 Vali Loss: 2.075 Vali Acc: 0.514 Test Loss: 2.075 Test Acc: 0.514
Validation loss decreased (-0.138865 --> -0.513868).  Saving model ...
Epoch: 3 cost time: 0.8052330017089844
Epoch: 3, Steps: 7 | Train Loss: 1.838 Vali Loss: 1.641 Vali Acc: 0.708 Test Loss: 1.641 Test Acc: 0.708
Validation loss decreased (-0.513868 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 0.7602074146270752
Epoch: 4, Steps: 7 | Train Loss: 1.338 Vali Loss: 1.123 Vali Acc: 0.833 Test Loss: 1.123 Test Acc: 0.833
Validation loss decreased (-0.708317 --> -0.833322).  Saving model ...
Epoch: 5 cost time: 0.7418291568756104
Epoch: 5, Steps: 7 | Train Loss: 0.776 Vali Loss: 0.704 Vali Acc: 0.889 Test Loss: 0.704 Test Acc: 0.889
Validation loss decreased (-0.833322 --> -0.888882).  Saving model ...
Epoch: 6 cost time: 0.6142833232879639
Epoch: 6, Steps: 7 | Train Loss: 0.376 Vali Loss: 0.448 Vali Acc: 0.847 Test Loss: 0.448 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.773139238357544
Epoch: 7, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
Validation loss decreased (-0.888882 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.7902801036834717
Epoch: 8, Steps: 7 | Train Loss: 0.043 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.608475923538208
Epoch: 9, Steps: 7 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.903 Test Loss: 0.269 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.6642208099365234
Epoch: 10, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.5924937725067139
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7880852222442627
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 0.6994063854217529
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7048346996307373
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.931 Test Loss: 0.174 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 0.8394935131072998
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.7093071937561035
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7879860401153564
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8108141422271729
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7800452709197998
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7261297702789307
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7210588455200195
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.697869062423706
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.931 Test Loss: 0.184 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7073385715484619
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6651737689971924
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7216179370880127
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.931 Test Loss: 0.178 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps71_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23446284
model size : 104.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps71_str71_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3102171421051025
Epoch: 1, Steps: 7 | Train Loss: 2.617 Vali Loss: 2.429 Vali Acc: 0.181 Test Loss: 2.429 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.5888485908508301
Epoch: 2, Steps: 7 | Train Loss: 2.362 Vali Loss: 2.202 Vali Acc: 0.361 Test Loss: 2.202 Test Acc: 0.361
Validation loss decreased (-0.180531 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.7875912189483643
Epoch: 3, Steps: 7 | Train Loss: 2.128 Vali Loss: 1.948 Vali Acc: 0.681 Test Loss: 1.948 Test Acc: 0.681
Validation loss decreased (-0.361089 --> -0.680536).  Saving model ...
Epoch: 4 cost time: 0.8264472484588623
Epoch: 4, Steps: 7 | Train Loss: 1.784 Vali Loss: 1.660 Vali Acc: 0.722 Test Loss: 1.660 Test Acc: 0.722
Validation loss decreased (-0.680536 --> -0.722206).  Saving model ...
Epoch: 5 cost time: 0.5110673904418945
Epoch: 5, Steps: 7 | Train Loss: 1.411 Vali Loss: 1.265 Vali Acc: 0.778 Test Loss: 1.265 Test Acc: 0.778
Validation loss decreased (-0.722206 --> -0.777765).  Saving model ...
Epoch: 6 cost time: 0.5611698627471924
Epoch: 6, Steps: 7 | Train Loss: 0.988 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
Validation loss decreased (-0.777765 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 0.4863123893737793
Epoch: 7, Steps: 7 | Train Loss: 0.515 Vali Loss: 0.560 Vali Acc: 0.889 Test Loss: 0.560 Test Acc: 0.889
Validation loss decreased (-0.819436 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.6410458087921143
Epoch: 8, Steps: 7 | Train Loss: 0.235 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
Validation loss decreased (-0.888883 --> -0.930552).  Saving model ...
Epoch: 9 cost time: 0.616884708404541
Epoch: 9, Steps: 7 | Train Loss: 0.092 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5641448497772217
Epoch: 10, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.930552 --> -0.944441).  Saving model ...
Epoch: 11 cost time: 0.5876142978668213
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 12 cost time: 0.5381073951721191
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 0.7556214332580566
Epoch: 13, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.944443 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 0.7752106189727783
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5708928108215332
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7936203479766846
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6216483116149902
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6032905578613281
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7709453105926514
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7772588729858398
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.958 Test Loss: 0.202 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6196467876434326
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.71437668800354
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.788759708404541
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.958 Test Loss: 0.205 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps71_str71_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 23274252
model size : 103.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.446638584136963
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.432 Vali Acc: 0.181 Test Loss: 2.432 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.7389023303985596
Epoch: 2, Steps: 7 | Train Loss: 2.280 Vali Loss: 1.946 Vali Acc: 0.639 Test Loss: 1.946 Test Acc: 0.639
Validation loss decreased (-0.180531 --> -0.638869).  Saving model ...
Epoch: 3 cost time: 0.7186131477355957
Epoch: 3, Steps: 7 | Train Loss: 1.683 Vali Loss: 1.426 Vali Acc: 0.681 Test Loss: 1.426 Test Acc: 0.681
Validation loss decreased (-0.638869 --> -0.680541).  Saving model ...
Epoch: 4 cost time: 0.6675388813018799
Epoch: 4, Steps: 7 | Train Loss: 0.941 Vali Loss: 0.765 Vali Acc: 0.847 Test Loss: 0.765 Test Acc: 0.847
Validation loss decreased (-0.680541 --> -0.847215).  Saving model ...
Epoch: 5 cost time: 0.8117411136627197
Epoch: 5, Steps: 7 | Train Loss: 0.351 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
Validation loss decreased (-0.847215 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.6004900932312012
Epoch: 6, Steps: 7 | Train Loss: 0.142 Vali Loss: 0.433 Vali Acc: 0.847 Test Loss: 0.433 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6594834327697754
Epoch: 7, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.220 Vali Acc: 0.889 Test Loss: 0.220 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888887).  Saving model ...
Epoch: 8 cost time: 0.6536529064178467
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.888887 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.812366247177124
Epoch: 9, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6756556034088135
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6444559097290039
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6811432838439941
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5954527854919434
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 0.6469922065734863
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
Validation loss decreased (-0.916665 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 0.6702456474304199
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9597675800323486
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7202565670013428
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9222862720489502
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.903 Test Loss: 0.242 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6689457893371582
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.903 Test Loss: 0.252 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.676703929901123
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0789687633514404
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0087785720825195
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.263 Vali Acc: 0.903 Test Loss: 0.263 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.168363094329834
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9800083637237549
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23802636
model size : 105.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.010756492614746
Epoch: 1, Steps: 7 | Train Loss: 2.551 Vali Loss: 2.444 Vali Acc: 0.181 Test Loss: 2.444 Test Acc: 0.181
Validation loss decreased (inf --> -0.180531).  Saving model ...
Epoch: 2 cost time: 0.7755696773529053
Epoch: 2, Steps: 7 | Train Loss: 2.308 Vali Loss: 2.111 Vali Acc: 0.486 Test Loss: 2.111 Test Acc: 0.486
Validation loss decreased (-0.180531 --> -0.486090).  Saving model ...
Epoch: 3 cost time: 0.6552562713623047
Epoch: 3, Steps: 7 | Train Loss: 1.882 Vali Loss: 1.705 Vali Acc: 0.806 Test Loss: 1.705 Test Acc: 0.806
Validation loss decreased (-0.486090 --> -0.805539).  Saving model ...
Epoch: 4 cost time: 0.6594316959381104
Epoch: 4, Steps: 7 | Train Loss: 1.438 Vali Loss: 1.226 Vali Acc: 0.778 Test Loss: 1.226 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8214740753173828
Epoch: 5, Steps: 7 | Train Loss: 0.839 Vali Loss: 0.696 Vali Acc: 0.903 Test Loss: 0.696 Test Acc: 0.903
Validation loss decreased (-0.805539 --> -0.902771).  Saving model ...
Epoch: 6 cost time: 0.6084115505218506
Epoch: 6, Steps: 7 | Train Loss: 0.411 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8354828357696533
Epoch: 7, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.318 Vali Acc: 0.931 Test Loss: 0.318 Test Acc: 0.931
Validation loss decreased (-0.902771 --> -0.930552).  Saving model ...
Epoch: 8 cost time: 0.8297891616821289
Epoch: 8, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7511980533599854
Epoch: 9, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6865792274475098
Epoch: 10, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.360 Vali Acc: 0.861 Test Loss: 0.360 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8018288612365723
Epoch: 11, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7628700733184814
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.903 Test Loss: 0.219 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7276935577392578
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.903 Test Loss: 0.229 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8189828395843506
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.700843095779419
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.903 Test Loss: 0.237 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6670398712158203
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8158588409423828
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23480076
model size : 104.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1490848064422607
Epoch: 1, Steps: 7 | Train Loss: 2.620 Vali Loss: 2.513 Vali Acc: 0.069 Test Loss: 2.513 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.6208846569061279
Epoch: 2, Steps: 7 | Train Loss: 2.398 Vali Loss: 2.312 Vali Acc: 0.319 Test Loss: 2.312 Test Acc: 0.319
Validation loss decreased (-0.069419 --> -0.319421).  Saving model ...
Epoch: 3 cost time: 0.7021441459655762
Epoch: 3, Steps: 7 | Train Loss: 2.163 Vali Loss: 2.040 Vali Acc: 0.639 Test Loss: 2.040 Test Acc: 0.639
Validation loss decreased (-0.319421 --> -0.638868).  Saving model ...
Epoch: 4 cost time: 0.6881630420684814
Epoch: 4, Steps: 7 | Train Loss: 1.794 Vali Loss: 1.710 Vali Acc: 0.722 Test Loss: 1.710 Test Acc: 0.722
Validation loss decreased (-0.638868 --> -0.722205).  Saving model ...
Epoch: 5 cost time: 0.6236083507537842
Epoch: 5, Steps: 7 | Train Loss: 1.437 Vali Loss: 1.291 Vali Acc: 0.764 Test Loss: 1.291 Test Acc: 0.764
Validation loss decreased (-0.722205 --> -0.763876).  Saving model ...
Epoch: 6 cost time: 0.5493366718292236
Epoch: 6, Steps: 7 | Train Loss: 0.984 Vali Loss: 0.913 Vali Acc: 0.806 Test Loss: 0.913 Test Acc: 0.806
Validation loss decreased (-0.763876 --> -0.805546).  Saving model ...
Epoch: 7 cost time: 0.6339554786682129
Epoch: 7, Steps: 7 | Train Loss: 0.615 Vali Loss: 0.576 Vali Acc: 0.889 Test Loss: 0.576 Test Acc: 0.889
Validation loss decreased (-0.805546 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.566824197769165
Epoch: 8, Steps: 7 | Train Loss: 0.329 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6009223461151123
Epoch: 9, Steps: 7 | Train Loss: 0.135 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7136502265930176
Epoch: 10, Steps: 7 | Train Loss: 0.060 Vali Loss: 0.303 Vali Acc: 0.931 Test Loss: 0.303 Test Acc: 0.931
Validation loss decreased (-0.888883 --> -0.930553).  Saving model ...
Epoch: 11 cost time: 0.5924773216247559
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5708823204040527
Epoch: 12, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6722695827484131
Epoch: 13, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6644856929779053
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6921548843383789
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.903 Test Loss: 0.278 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6504411697387695
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.542771577835083
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5892841815948486
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5984311103820801
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6299474239349365
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23318796
model size : 103.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.242426872253418
Epoch: 1, Steps: 7 | Train Loss: 2.692 Vali Loss: 2.403 Vali Acc: 0.208 Test Loss: 2.403 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.8343875408172607
Epoch: 2, Steps: 7 | Train Loss: 2.277 Vali Loss: 2.013 Vali Acc: 0.597 Test Loss: 2.013 Test Acc: 0.597
Validation loss decreased (-0.208309 --> -0.597202).  Saving model ...
Epoch: 3 cost time: 0.8142688274383545
Epoch: 3, Steps: 7 | Train Loss: 1.689 Vali Loss: 1.509 Vali Acc: 0.625 Test Loss: 1.509 Test Acc: 0.625
Validation loss decreased (-0.597202 --> -0.624985).  Saving model ...
Epoch: 4 cost time: 0.9160785675048828
Epoch: 4, Steps: 7 | Train Loss: 1.051 Vali Loss: 0.860 Vali Acc: 0.806 Test Loss: 0.860 Test Acc: 0.806
Validation loss decreased (-0.624985 --> -0.805547).  Saving model ...
Epoch: 5 cost time: 0.9247076511383057
Epoch: 5, Steps: 7 | Train Loss: 0.459 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 1.0473833084106445
Epoch: 6, Steps: 7 | Train Loss: 0.182 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.847217 --> -0.916663).  Saving model ...
Epoch: 7 cost time: 0.9015076160430908
Epoch: 7, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9436750411987305
Epoch: 8, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.9676487445831299
Epoch: 9, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8067777156829834
Epoch: 10, Steps: 7 | Train Loss: 0.031 Vali Loss: 0.404 Vali Acc: 0.917 Test Loss: 0.404 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9796009063720703
Epoch: 11, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6996102333068848
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8857541084289551
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7356123924255371
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.7595269680023193
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6681318283081055
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9141707420349121
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.945725679397583
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7081456184387207
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7762231826782227
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.818263053894043
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7413501739501953
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9376380443572998
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8630702495574951
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23828748
model size : 105.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.159398078918457
Epoch: 1, Steps: 7 | Train Loss: 2.544 Vali Loss: 2.386 Vali Acc: 0.194 Test Loss: 2.386 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.8705840110778809
Epoch: 2, Steps: 7 | Train Loss: 2.235 Vali Loss: 2.077 Vali Acc: 0.597 Test Loss: 2.077 Test Acc: 0.597
Validation loss decreased (-0.194421 --> -0.597201).  Saving model ...
Epoch: 3 cost time: 0.8453850746154785
Epoch: 3, Steps: 7 | Train Loss: 1.901 Vali Loss: 1.687 Vali Acc: 0.722 Test Loss: 1.687 Test Acc: 0.722
Validation loss decreased (-0.597201 --> -0.722205).  Saving model ...
Epoch: 4 cost time: 0.9698150157928467
Epoch: 4, Steps: 7 | Train Loss: 1.328 Vali Loss: 1.181 Vali Acc: 0.819 Test Loss: 1.181 Test Acc: 0.819
Validation loss decreased (-0.722205 --> -0.819433).  Saving model ...
Epoch: 5 cost time: 0.7855010032653809
Epoch: 5, Steps: 7 | Train Loss: 0.861 Vali Loss: 0.720 Vali Acc: 0.875 Test Loss: 0.720 Test Acc: 0.875
Validation loss decreased (-0.819433 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.7592427730560303
Epoch: 6, Steps: 7 | Train Loss: 0.394 Vali Loss: 0.406 Vali Acc: 0.903 Test Loss: 0.406 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.6895549297332764
Epoch: 7, Steps: 7 | Train Loss: 0.150 Vali Loss: 0.382 Vali Acc: 0.903 Test Loss: 0.382 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.7516212463378906
Epoch: 8, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8983092308044434
Epoch: 9, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.902774 --> -0.944442).  Saving model ...
Epoch: 10 cost time: 0.7355484962463379
Epoch: 10, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.6440260410308838
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.705883264541626
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7846319675445557
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.747666597366333
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7520880699157715
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7581639289855957
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7349865436553955
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.645301342010498
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6087527275085449
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6744425296783447
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23527692
model size : 104.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.153517246246338
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.445 Vali Acc: 0.125 Test Loss: 2.445 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.5819437503814697
Epoch: 2, Steps: 7 | Train Loss: 2.337 Vali Loss: 2.244 Vali Acc: 0.347 Test Loss: 2.244 Test Acc: 0.347
Validation loss decreased (-0.124976 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.6978867053985596
Epoch: 3, Steps: 7 | Train Loss: 2.081 Vali Loss: 2.017 Vali Acc: 0.556 Test Loss: 2.017 Test Acc: 0.556
Validation loss decreased (-0.347200 --> -0.555535).  Saving model ...
Epoch: 4 cost time: 0.7152447700500488
Epoch: 4, Steps: 7 | Train Loss: 1.772 Vali Loss: 1.711 Vali Acc: 0.736 Test Loss: 1.711 Test Acc: 0.736
Validation loss decreased (-0.555535 --> -0.736094).  Saving model ...
Epoch: 5 cost time: 0.7329285144805908
Epoch: 5, Steps: 7 | Train Loss: 1.455 Vali Loss: 1.299 Vali Acc: 0.750 Test Loss: 1.299 Test Acc: 0.750
Validation loss decreased (-0.736094 --> -0.749987).  Saving model ...
Epoch: 6 cost time: 0.765474796295166
Epoch: 6, Steps: 7 | Train Loss: 0.995 Vali Loss: 0.869 Vali Acc: 0.847 Test Loss: 0.869 Test Acc: 0.847
Validation loss decreased (-0.749987 --> -0.847214).  Saving model ...
Epoch: 7 cost time: 0.758568286895752
Epoch: 7, Steps: 7 | Train Loss: 0.626 Vali Loss: 0.566 Vali Acc: 0.889 Test Loss: 0.566 Test Acc: 0.889
Validation loss decreased (-0.847214 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.6729021072387695
Epoch: 8, Steps: 7 | Train Loss: 0.311 Vali Loss: 0.411 Vali Acc: 0.903 Test Loss: 0.411 Test Acc: 0.903
Validation loss decreased (-0.888883 --> -0.902774).  Saving model ...
Epoch: 9 cost time: 0.7166426181793213
Epoch: 9, Steps: 7 | Train Loss: 0.144 Vali Loss: 0.359 Vali Acc: 0.917 Test Loss: 0.359 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.636638879776001
Epoch: 10, Steps: 7 | Train Loss: 0.055 Vali Loss: 0.308 Vali Acc: 0.861 Test Loss: 0.308 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6780374050140381
Epoch: 11, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6382155418395996
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.7022757530212402
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7386519908905029
Epoch: 14, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.6899902820587158
Epoch: 15, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7556962966918945
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6988406181335449
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.7494487762451172
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 19 cost time: 0.674673318862915
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 20 cost time: 0.7320418357849121
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6558375358581543
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 22 cost time: 0.6693365573883057
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 0.679398775100708
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 0.6600635051727295
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.6555130481719971
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.931 Test Loss: 0.186 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6602368354797363
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6449949741363525
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6349871158599854
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6228134632110596
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6683800220489502
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6045317649841309
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6485376358032227
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6163027286529541
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.645348072052002
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.931 Test Loss: 0.185 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23377164
model size : 103.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps86_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.1428909301757812
Epoch: 1, Steps: 7 | Train Loss: 2.641 Vali Loss: 2.491 Vali Acc: 0.125 Test Loss: 2.491 Test Acc: 0.125
Validation loss decreased (inf --> -0.124975).  Saving model ...
Epoch: 2 cost time: 0.8158495426177979
Epoch: 2, Steps: 7 | Train Loss: 2.303 Vali Loss: 2.015 Vali Acc: 0.556 Test Loss: 2.015 Test Acc: 0.556
Validation loss decreased (-0.124975 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 0.8772165775299072
Epoch: 3, Steps: 7 | Train Loss: 1.670 Vali Loss: 1.384 Vali Acc: 0.806 Test Loss: 1.384 Test Acc: 0.806
Validation loss decreased (-0.555535 --> -0.805542).  Saving model ...
Epoch: 4 cost time: 0.8956069946289062
Epoch: 4, Steps: 7 | Train Loss: 0.887 Vali Loss: 0.689 Vali Acc: 0.861 Test Loss: 0.689 Test Acc: 0.861
Validation loss decreased (-0.805542 --> -0.861104).  Saving model ...
Epoch: 5 cost time: 1.000382423400879
Epoch: 5, Steps: 7 | Train Loss: 0.303 Vali Loss: 0.385 Vali Acc: 0.903 Test Loss: 0.385 Test Acc: 0.903
Validation loss decreased (-0.861104 --> -0.902774).  Saving model ...
Epoch: 6 cost time: 0.7758171558380127
Epoch: 6, Steps: 7 | Train Loss: 0.076 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.79380202293396
Epoch: 7, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.9078507423400879
Epoch: 8, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.917 Test Loss: 0.326 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.7357046604156494
Epoch: 9, Steps: 7 | Train Loss: 0.027 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7691881656646729
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.950690507888794
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7946100234985352
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7332394123077393
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.8222901821136475
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 1.0995335578918457
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.931 Test Loss: 0.217 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8850951194763184
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.894810676574707
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9528429508209229
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8591547012329102
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9608967304229736
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9829421043395996
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8744323253631592
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9684154987335205
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5778501033782959
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps86_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23857932
model size : 105.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps86_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2252795696258545
Epoch: 1, Steps: 7 | Train Loss: 2.698 Vali Loss: 2.492 Vali Acc: 0.069 Test Loss: 2.492 Test Acc: 0.069
Validation loss decreased (inf --> -0.069420).  Saving model ...
Epoch: 2 cost time: 0.7293205261230469
Epoch: 2, Steps: 7 | Train Loss: 2.383 Vali Loss: 2.194 Vali Acc: 0.361 Test Loss: 2.194 Test Acc: 0.361
Validation loss decreased (-0.069420 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.7335226535797119
Epoch: 3, Steps: 7 | Train Loss: 2.034 Vali Loss: 1.830 Vali Acc: 0.611 Test Loss: 1.830 Test Acc: 0.611
Validation loss decreased (-0.361089 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 0.8919453620910645
Epoch: 4, Steps: 7 | Train Loss: 1.506 Vali Loss: 1.289 Vali Acc: 0.750 Test Loss: 1.289 Test Acc: 0.750
Validation loss decreased (-0.611093 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 0.749018669128418
Epoch: 5, Steps: 7 | Train Loss: 0.825 Vali Loss: 0.718 Vali Acc: 0.806 Test Loss: 0.718 Test Acc: 0.806
Validation loss decreased (-0.749987 --> -0.805548).  Saving model ...
Epoch: 6 cost time: 0.8092756271362305
Epoch: 6, Steps: 7 | Train Loss: 0.340 Vali Loss: 0.412 Vali Acc: 0.903 Test Loss: 0.412 Test Acc: 0.903
Validation loss decreased (-0.805548 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.697739839553833
Epoch: 7, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.6482081413269043
Epoch: 8, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.221 Vali Acc: 0.931 Test Loss: 0.221 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.7832164764404297
Epoch: 9, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7162055969238281
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6983487606048584
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7453911304473877
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7441666126251221
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.7078816890716553
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 15 cost time: 0.7827181816101074
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 0.7172844409942627
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.7529988288879395
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7428369522094727
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6699011325836182
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7489454746246338
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7324450016021729
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5401360988616943
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 23 cost time: 0.7350952625274658
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 0.793628454208374
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.9002187252044678
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 26 cost time: 0.5923230648040771
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5959537029266357
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7243533134460449
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.931 Test Loss: 0.194 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6758558750152588
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.931 Test Loss: 0.196 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6928114891052246
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.931 Test Loss: 0.195 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6547605991363525
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.931 Test Loss: 0.193 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6554186344146729
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6573739051818848
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6624839305877686
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 35 cost time: 0.8202934265136719
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.673262357711792
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 37 cost time: 0.7367382049560547
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 38 cost time: 0.8366339206695557
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.931 Test Loss: 0.187 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7208681106567383
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7388601303100586
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7635188102722168
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8769612312316895
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8447158336639404
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6912529468536377
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6824929714202881
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.931 Test Loss: 0.190 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6761503219604492
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.931 Test Loss: 0.189 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6850206851959229
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.8220267295837402
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.7894458770751953
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.8504040241241455
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps86_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 23589132
model size : 104.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps86_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.996250867843628
Epoch: 1, Steps: 7 | Train Loss: 2.639 Vali Loss: 2.509 Vali Acc: 0.083 Test Loss: 2.509 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.46455979347229004
Epoch: 2, Steps: 7 | Train Loss: 2.486 Vali Loss: 2.303 Vali Acc: 0.347 Test Loss: 2.303 Test Acc: 0.347
Validation loss decreased (-0.083308 --> -0.347199).  Saving model ...
Epoch: 3 cost time: 0.5240285396575928
Epoch: 3, Steps: 7 | Train Loss: 2.153 Vali Loss: 2.021 Vali Acc: 0.625 Test Loss: 2.021 Test Acc: 0.625
Validation loss decreased (-0.347199 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 0.6839051246643066
Epoch: 4, Steps: 7 | Train Loss: 1.813 Vali Loss: 1.662 Vali Acc: 0.792 Test Loss: 1.662 Test Acc: 0.792
Validation loss decreased (-0.624980 --> -0.791650).  Saving model ...
Epoch: 5 cost time: 0.5020294189453125
Epoch: 5, Steps: 7 | Train Loss: 1.347 Vali Loss: 1.145 Vali Acc: 0.861 Test Loss: 1.145 Test Acc: 0.861
Validation loss decreased (-0.791650 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 0.6824426651000977
Epoch: 6, Steps: 7 | Train Loss: 0.814 Vali Loss: 0.769 Vali Acc: 0.861 Test Loss: 0.769 Test Acc: 0.861
Validation loss decreased (-0.861100 --> -0.861103).  Saving model ...
Epoch: 7 cost time: 0.6106400489807129
Epoch: 7, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.502 Vali Acc: 0.903 Test Loss: 0.502 Test Acc: 0.903
Validation loss decreased (-0.861103 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.6714177131652832
Epoch: 8, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.415 Vali Acc: 0.917 Test Loss: 0.415 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.5617129802703857
Epoch: 9, Steps: 7 | Train Loss: 0.075 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6874163150787354
Epoch: 10, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.317 Vali Acc: 0.903 Test Loss: 0.317 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6784238815307617
Epoch: 11, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6710827350616455
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.5813250541687012
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6426265239715576
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6534924507141113
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5869555473327637
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5290002822875977
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.903 Test Loss: 0.276 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7135930061340332
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.903 Test Loss: 0.277 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6498358249664307
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.917 Test Loss: 0.277 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6465737819671631
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.917 Test Loss: 0.278 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6009562015533447
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5637869834899902
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps86_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23449356
model size : 104.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps93_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4989731311798096
Epoch: 1, Steps: 7 | Train Loss: 2.623 Vali Loss: 2.449 Vali Acc: 0.139 Test Loss: 2.449 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.6523587703704834
Epoch: 2, Steps: 7 | Train Loss: 2.283 Vali Loss: 2.050 Vali Acc: 0.500 Test Loss: 2.050 Test Acc: 0.500
Validation loss decreased (-0.138864 --> -0.499980).  Saving model ...
Epoch: 3 cost time: 0.9653129577636719
Epoch: 3, Steps: 7 | Train Loss: 1.705 Vali Loss: 1.405 Vali Acc: 0.736 Test Loss: 1.405 Test Acc: 0.736
Validation loss decreased (-0.499980 --> -0.736097).  Saving model ...
Epoch: 4 cost time: 0.6939640045166016
Epoch: 4, Steps: 7 | Train Loss: 1.009 Vali Loss: 0.776 Vali Acc: 0.806 Test Loss: 0.776 Test Acc: 0.806
Validation loss decreased (-0.736097 --> -0.805548).  Saving model ...
Epoch: 5 cost time: 0.7260031700134277
Epoch: 5, Steps: 7 | Train Loss: 0.405 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 0.805983304977417
Epoch: 6, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861108).  Saving model ...
Epoch: 7 cost time: 0.810060977935791
Epoch: 7, Steps: 7 | Train Loss: 0.046 Vali Loss: 0.331 Vali Acc: 0.889 Test Loss: 0.331 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.7129449844360352
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7898354530334473
Epoch: 9, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7689661979675293
Epoch: 10, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6864821910858154
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.7599875926971436
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7636492252349854
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6357662677764893
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6091251373291016
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.889 Test Loss: 0.364 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9906504154205322
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7758662700653076
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7725839614868164
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.889 Test Loss: 0.348 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7909433841705322
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8407077789306641
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9306588172912598
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps93_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.8888888888888888
model parameter : 23911692
model size : 105.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps93_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8720741271972656
Epoch: 1, Steps: 7 | Train Loss: 2.727 Vali Loss: 2.569 Vali Acc: 0.083 Test Loss: 2.569 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.8055822849273682
Epoch: 2, Steps: 7 | Train Loss: 2.386 Vali Loss: 2.217 Vali Acc: 0.431 Test Loss: 2.217 Test Acc: 0.431
Validation loss decreased (-0.083308 --> -0.430533).  Saving model ...
Epoch: 3 cost time: 0.7678313255310059
Epoch: 3, Steps: 7 | Train Loss: 1.964 Vali Loss: 1.813 Vali Acc: 0.625 Test Loss: 1.813 Test Acc: 0.625
Validation loss decreased (-0.430533 --> -0.624982).  Saving model ...
Epoch: 4 cost time: 0.9024214744567871
Epoch: 4, Steps: 7 | Train Loss: 1.463 Vali Loss: 1.279 Vali Acc: 0.736 Test Loss: 1.279 Test Acc: 0.736
Validation loss decreased (-0.624982 --> -0.736098).  Saving model ...
Epoch: 5 cost time: 0.7381844520568848
Epoch: 5, Steps: 7 | Train Loss: 0.923 Vali Loss: 0.661 Vali Acc: 0.819 Test Loss: 0.661 Test Acc: 0.819
Validation loss decreased (-0.736098 --> -0.819438).  Saving model ...
Epoch: 6 cost time: 0.9921672344207764
Epoch: 6, Steps: 7 | Train Loss: 0.414 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.819438 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.7604508399963379
Epoch: 7, Steps: 7 | Train Loss: 0.184 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 8 cost time: 0.8823051452636719
Epoch: 8, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6813743114471436
Epoch: 9, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6128702163696289
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 0.8543972969055176
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.903 Test Loss: 0.283 Test Acc: 0.903
Validation loss decreased (-0.874997 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.6376166343688965
Epoch: 12, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7562475204467773
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6593794822692871
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8485748767852783
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8947362899780273
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6896851062774658
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.598501443862915
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8129689693450928
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7298610210418701
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7463371753692627
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps93_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 23664396
model size : 104.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps93_str93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.955603837966919
Epoch: 1, Steps: 7 | Train Loss: 2.674 Vali Loss: 2.523 Vali Acc: 0.111 Test Loss: 2.523 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.6206045150756836
Epoch: 2, Steps: 7 | Train Loss: 2.480 Vali Loss: 2.263 Vali Acc: 0.347 Test Loss: 2.263 Test Acc: 0.347
Validation loss decreased (-0.111086 --> -0.347200).  Saving model ...
Epoch: 3 cost time: 0.6813995838165283
Epoch: 3, Steps: 7 | Train Loss: 2.213 Vali Loss: 1.989 Vali Acc: 0.625 Test Loss: 1.989 Test Acc: 0.625
Validation loss decreased (-0.347200 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 0.6556093692779541
Epoch: 4, Steps: 7 | Train Loss: 1.831 Vali Loss: 1.684 Vali Acc: 0.694 Test Loss: 1.684 Test Acc: 0.694
Validation loss decreased (-0.624980 --> -0.694428).  Saving model ...
Epoch: 5 cost time: 0.692495584487915
Epoch: 5, Steps: 7 | Train Loss: 1.521 Vali Loss: 1.315 Vali Acc: 0.764 Test Loss: 1.315 Test Acc: 0.764
Validation loss decreased (-0.694428 --> -0.763876).  Saving model ...
Epoch: 6 cost time: 0.6723971366882324
Epoch: 6, Steps: 7 | Train Loss: 1.065 Vali Loss: 0.916 Vali Acc: 0.819 Test Loss: 0.916 Test Acc: 0.819
Validation loss decreased (-0.763876 --> -0.819435).  Saving model ...
Epoch: 7 cost time: 0.6891055107116699
Epoch: 7, Steps: 7 | Train Loss: 0.660 Vali Loss: 0.605 Vali Acc: 0.847 Test Loss: 0.605 Test Acc: 0.847
Validation loss decreased (-0.819435 --> -0.847216).  Saving model ...
Epoch: 8 cost time: 0.6525483131408691
Epoch: 8, Steps: 7 | Train Loss: 0.309 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
Validation loss decreased (-0.847216 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.6746621131896973
Epoch: 9, Steps: 7 | Train Loss: 0.159 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.6625521183013916
Epoch: 10, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6303787231445312
Epoch: 11, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6679599285125732
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.374 Vali Acc: 0.903 Test Loss: 0.374 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 13 cost time: 0.6292068958282471
Epoch: 13, Steps: 7 | Train Loss: 0.011 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5741071701049805
Epoch: 14, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5930385589599609
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.5636160373687744
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.903 Test Loss: 0.271 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.5834810733795166
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.567610502243042
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6597809791564941
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6572091579437256
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5260052680969238
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6440083980560303
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5145750045776367
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.903 Test Loss: 0.285 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6255590915679932
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.284 Vali Acc: 0.903 Test Loss: 0.284 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6335270404815674
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6040821075439453
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.903 Test Loss: 0.279 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps93_str93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 23535372
model size : 104.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.548431873321533
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.457 Vali Acc: 0.111 Test Loss: 2.457 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 1.008913516998291
Epoch: 2, Steps: 7 | Train Loss: 2.286 Vali Loss: 2.032 Vali Acc: 0.569 Test Loss: 2.032 Test Acc: 0.569
Validation loss decreased (-0.111087 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 0.9386627674102783
Epoch: 3, Steps: 7 | Train Loss: 1.715 Vali Loss: 1.540 Vali Acc: 0.792 Test Loss: 1.540 Test Acc: 0.792
Validation loss decreased (-0.569424 --> -0.791651).  Saving model ...
Epoch: 4 cost time: 0.7724182605743408
Epoch: 4, Steps: 7 | Train Loss: 1.018 Vali Loss: 0.842 Vali Acc: 0.819 Test Loss: 0.842 Test Acc: 0.819
Validation loss decreased (-0.791651 --> -0.819436).  Saving model ...
Epoch: 5 cost time: 1.0098412036895752
Epoch: 5, Steps: 7 | Train Loss: 0.463 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
Validation loss decreased (-0.819436 --> -0.861107).  Saving model ...
Epoch: 6 cost time: 0.8872883319854736
Epoch: 6, Steps: 7 | Train Loss: 0.140 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.861107 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 1.0403285026550293
Epoch: 7, Steps: 7 | Train Loss: 0.049 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 8 cost time: 0.5963373184204102
Epoch: 8, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 9 cost time: 0.6260085105895996
Epoch: 9, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.931 Test Loss: 0.181 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0120751857757568
Epoch: 10, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.903 Test Loss: 0.187 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6107785701751709
Epoch: 11, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.688899040222168
Epoch: 12, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5897395610809326
Epoch: 13, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6932556629180908
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8679022789001465
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 16 cost time: 0.7764999866485596
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.931 Test Loss: 0.173 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 17 cost time: 0.839531421661377
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 18 cost time: 0.9015121459960938
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.917 Test Loss: 0.172 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0383803844451904
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.917 Test Loss: 0.174 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9640281200408936
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.903 Test Loss: 0.176 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7719244956970215
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.903 Test Loss: 0.176 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9719512462615967
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7086067199707031
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.917 Test Loss: 0.175 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7776334285736084
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7175559997558594
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.917 Test Loss: 0.177 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6759448051452637
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.931 Test Loss: 0.177 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9567093849182129
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23976204
model size : 106.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0433335304260254
Epoch: 1, Steps: 7 | Train Loss: 2.627 Vali Loss: 2.467 Vali Acc: 0.236 Test Loss: 2.467 Test Acc: 0.236
Validation loss decreased (inf --> -0.236086).  Saving model ...
Epoch: 2 cost time: 0.5956943035125732
Epoch: 2, Steps: 7 | Train Loss: 2.357 Vali Loss: 2.152 Vali Acc: 0.361 Test Loss: 2.152 Test Acc: 0.361
Validation loss decreased (-0.236086 --> -0.361090).  Saving model ...
Epoch: 3 cost time: 0.7521681785583496
Epoch: 3, Steps: 7 | Train Loss: 1.932 Vali Loss: 1.770 Vali Acc: 0.722 Test Loss: 1.770 Test Acc: 0.722
Validation loss decreased (-0.361090 --> -0.722205).  Saving model ...
Epoch: 4 cost time: 0.818572998046875
Epoch: 4, Steps: 7 | Train Loss: 1.479 Vali Loss: 1.323 Vali Acc: 0.819 Test Loss: 1.323 Test Acc: 0.819
Validation loss decreased (-0.722205 --> -0.819431).  Saving model ...
Epoch: 5 cost time: 0.6211936473846436
Epoch: 5, Steps: 7 | Train Loss: 1.024 Vali Loss: 0.821 Vali Acc: 0.847 Test Loss: 0.821 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847214).  Saving model ...
Epoch: 6 cost time: 0.7344372272491455
Epoch: 6, Steps: 7 | Train Loss: 0.529 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
Validation loss decreased (-0.847214 --> -0.902773).  Saving model ...
Epoch: 7 cost time: 0.6612467765808105
Epoch: 7, Steps: 7 | Train Loss: 0.225 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.902773 --> -0.902774).  Saving model ...
Epoch: 8 cost time: 0.6518239974975586
Epoch: 8, Steps: 7 | Train Loss: 0.082 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.902774 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.7020506858825684
Epoch: 9, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8018276691436768
Epoch: 10, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8324787616729736
Epoch: 11, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.903 Test Loss: 0.249 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7303109169006348
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5230028629302979
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.940227746963501
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.903 Test Loss: 0.244 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7611713409423828
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.903 Test Loss: 0.239 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6456491947174072
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.806039571762085
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6844809055328369
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.889 Test Loss: 0.218 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23739660
model size : 105.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0154480934143066
Epoch: 1, Steps: 7 | Train Loss: 2.629 Vali Loss: 2.560 Vali Acc: 0.097 Test Loss: 2.560 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5931611061096191
Epoch: 2, Steps: 7 | Train Loss: 2.425 Vali Loss: 2.319 Vali Acc: 0.375 Test Loss: 2.319 Test Acc: 0.375
Validation loss decreased (-0.097197 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.6355764865875244
Epoch: 3, Steps: 7 | Train Loss: 2.135 Vali Loss: 2.033 Vali Acc: 0.625 Test Loss: 2.033 Test Acc: 0.625
Validation loss decreased (-0.374977 --> -0.624980).  Saving model ...
Epoch: 4 cost time: 0.6834523677825928
Epoch: 4, Steps: 7 | Train Loss: 1.808 Vali Loss: 1.669 Vali Acc: 0.764 Test Loss: 1.669 Test Acc: 0.764
Validation loss decreased (-0.624980 --> -0.763872).  Saving model ...
Epoch: 5 cost time: 0.5889945030212402
Epoch: 5, Steps: 7 | Train Loss: 1.400 Vali Loss: 1.267 Vali Acc: 0.806 Test Loss: 1.267 Test Acc: 0.806
Validation loss decreased (-0.763872 --> -0.805543).  Saving model ...
Epoch: 6 cost time: 0.6232588291168213
Epoch: 6, Steps: 7 | Train Loss: 0.988 Vali Loss: 0.891 Vali Acc: 0.819 Test Loss: 0.891 Test Acc: 0.819
Validation loss decreased (-0.805543 --> -0.819436).  Saving model ...
Epoch: 7 cost time: 0.6486647129058838
Epoch: 7, Steps: 7 | Train Loss: 0.551 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.819436 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.5774927139282227
Epoch: 8, Steps: 7 | Train Loss: 0.286 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 0.615032434463501
Epoch: 9, Steps: 7 | Train Loss: 0.121 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.7517764568328857
Epoch: 10, Steps: 7 | Train Loss: 0.059 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 11 cost time: 0.5939404964447021
Epoch: 11, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6089189052581787
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.245 Vali Acc: 0.903 Test Loss: 0.245 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7015926837921143
Epoch: 13, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6022324562072754
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.273 Vali Acc: 0.903 Test Loss: 0.273 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5901758670806885
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6057360172271729
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7141902446746826
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.931 Test Loss: 0.242 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.6180517673492432
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.931 Test Loss: 0.237 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.5646851062774658
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5547375679016113
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.917 Test Loss: 0.227 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5601048469543457
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6567602157592773
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6405737400054932
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5195436477661133
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.535548210144043
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5924220085144043
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.6220340728759766
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 28 cost time: 0.7573189735412598
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6783711910247803
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6120038032531738
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 31 cost time: 0.5577914714813232
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 32 cost time: 0.6822333335876465
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.6966497898101807
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6635732650756836
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6991426944732666
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.931 Test Loss: 0.233 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6673457622528076
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5898125171661377
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6322698593139648
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 39 cost time: 0.7376585006713867
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6426804065704346
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6767332553863525
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6469545364379883
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5958025455474854
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6547298431396484
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 45 cost time: 0.747039794921875
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.6586968898773193
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 47 cost time: 0.757148265838623
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7325339317321777
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7396762371063232
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.7799947261810303
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23621388
model size : 104.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps109_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.4814393520355225
Epoch: 1, Steps: 7 | Train Loss: 2.556 Vali Loss: 2.425 Vali Acc: 0.208 Test Loss: 2.425 Test Acc: 0.208
Validation loss decreased (inf --> -0.208309).  Saving model ...
Epoch: 2 cost time: 0.7130129337310791
Epoch: 2, Steps: 7 | Train Loss: 2.254 Vali Loss: 1.974 Vali Acc: 0.444 Test Loss: 1.974 Test Acc: 0.444
Validation loss decreased (-0.208309 --> -0.444425).  Saving model ...
Epoch: 3 cost time: 0.5571553707122803
Epoch: 3, Steps: 7 | Train Loss: 1.725 Vali Loss: 1.461 Vali Acc: 0.681 Test Loss: 1.461 Test Acc: 0.681
Validation loss decreased (-0.444425 --> -0.680541).  Saving model ...
Epoch: 4 cost time: 0.713524341583252
Epoch: 4, Steps: 7 | Train Loss: 1.041 Vali Loss: 0.882 Vali Acc: 0.806 Test Loss: 0.882 Test Acc: 0.806
Validation loss decreased (-0.680541 --> -0.805547).  Saving model ...
Epoch: 5 cost time: 0.7196409702301025
Epoch: 5, Steps: 7 | Train Loss: 0.473 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
Validation loss decreased (-0.805547 --> -0.847217).  Saving model ...
Epoch: 6 cost time: 0.6041948795318604
Epoch: 6, Steps: 7 | Train Loss: 0.175 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.847217 --> -0.902774).  Saving model ...
Epoch: 7 cost time: 0.7460067272186279
Epoch: 7, Steps: 7 | Train Loss: 0.048 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5676534175872803
Epoch: 8, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.353 Vali Acc: 0.917 Test Loss: 0.353 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.8457882404327393
Epoch: 9, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8533022403717041
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6507382392883301
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.903 Test Loss: 0.208 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7321984767913818
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.931 Test Loss: 0.198 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 0.9431147575378418
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 0.6393077373504639
Epoch: 14, Steps: 7 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8539481163024902
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8962280750274658
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.917 Test Loss: 0.287 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7539446353912354
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7385635375976562
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9290518760681152
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7845001220703125
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6360902786254883
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7162940502166748
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8576877117156982
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps109_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 24046860
model size : 106.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps109_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0096864700317383
Epoch: 1, Steps: 7 | Train Loss: 2.536 Vali Loss: 2.475 Vali Acc: 0.139 Test Loss: 2.475 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.6716899871826172
Epoch: 2, Steps: 7 | Train Loss: 2.346 Vali Loss: 2.149 Vali Acc: 0.444 Test Loss: 2.149 Test Acc: 0.444
Validation loss decreased (-0.138864 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 0.7591509819030762
Epoch: 3, Steps: 7 | Train Loss: 1.953 Vali Loss: 1.771 Vali Acc: 0.611 Test Loss: 1.771 Test Acc: 0.611
Validation loss decreased (-0.444423 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 0.6232669353485107
Epoch: 4, Steps: 7 | Train Loss: 1.550 Vali Loss: 1.317 Vali Acc: 0.819 Test Loss: 1.317 Test Acc: 0.819
Validation loss decreased (-0.611093 --> -0.819431).  Saving model ...
Epoch: 5 cost time: 0.7662129402160645
Epoch: 5, Steps: 7 | Train Loss: 1.039 Vali Loss: 0.867 Vali Acc: 0.847 Test Loss: 0.867 Test Acc: 0.847
Validation loss decreased (-0.819431 --> -0.847214).  Saving model ...
Epoch: 6 cost time: 0.4391288757324219
Epoch: 6, Steps: 7 | Train Loss: 0.630 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
Validation loss decreased (-0.847214 --> -0.861106).  Saving model ...
Epoch: 7 cost time: 0.5952517986297607
Epoch: 7, Steps: 7 | Train Loss: 0.299 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.6813976764678955
Epoch: 8, Steps: 7 | Train Loss: 0.105 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.6917815208435059
Epoch: 9, Steps: 7 | Train Loss: 0.047 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.5779199600219727
Epoch: 10, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.274 Vali Acc: 0.875 Test Loss: 0.274 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4729335308074951
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.610715389251709
Epoch: 12, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5410020351409912
Epoch: 13, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6077103614807129
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.6420392990112305
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.5687613487243652
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.903 Test Loss: 0.222 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 17 cost time: 0.5232796669006348
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7921974658966064
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6441774368286133
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.903 Test Loss: 0.223 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5179548263549805
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
Validation loss decreased (-0.902776 --> -0.902776).  Saving model ...
Epoch: 21 cost time: 0.8124382495880127
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.903 Test Loss: 0.221 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5350704193115234
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7068538665771484
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7805044651031494
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.903 Test Loss: 0.232 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8625330924987793
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5958981513977051
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5324888229370117
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.903 Test Loss: 0.224 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6698107719421387
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.903 Test Loss: 0.225 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6536915302276611
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.903 Test Loss: 0.227 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5549044609069824
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.903 Test Loss: 0.228 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps109_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 23842572
model size : 105.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps109_str109_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9224433898925781
Epoch: 1, Steps: 7 | Train Loss: 2.651 Vali Loss: 2.541 Vali Acc: 0.097 Test Loss: 2.541 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5552549362182617
Epoch: 2, Steps: 7 | Train Loss: 2.462 Vali Loss: 2.275 Vali Acc: 0.333 Test Loss: 2.275 Test Acc: 0.333
Validation loss decreased (-0.097197 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 0.4952569007873535
Epoch: 3, Steps: 7 | Train Loss: 2.169 Vali Loss: 2.014 Vali Acc: 0.611 Test Loss: 2.014 Test Acc: 0.611
Validation loss decreased (-0.333311 --> -0.611091).  Saving model ...
Epoch: 4 cost time: 0.6123828887939453
Epoch: 4, Steps: 7 | Train Loss: 1.841 Vali Loss: 1.689 Vali Acc: 0.778 Test Loss: 1.689 Test Acc: 0.778
Validation loss decreased (-0.611091 --> -0.777761).  Saving model ...
Epoch: 5 cost time: 0.5523233413696289
Epoch: 5, Steps: 7 | Train Loss: 1.359 Vali Loss: 1.295 Vali Acc: 0.806 Test Loss: 1.295 Test Acc: 0.806
Validation loss decreased (-0.777761 --> -0.805543).  Saving model ...
Epoch: 6 cost time: 0.47972631454467773
Epoch: 6, Steps: 7 | Train Loss: 1.034 Vali Loss: 0.917 Vali Acc: 0.861 Test Loss: 0.917 Test Acc: 0.861
Validation loss decreased (-0.805543 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 0.5313472747802734
Epoch: 7, Steps: 7 | Train Loss: 0.600 Vali Loss: 0.621 Vali Acc: 0.847 Test Loss: 0.621 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5026319026947021
Epoch: 8, Steps: 7 | Train Loss: 0.337 Vali Loss: 0.478 Vali Acc: 0.847 Test Loss: 0.478 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5593268871307373
Epoch: 9, Steps: 7 | Train Loss: 0.141 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.5431065559387207
Epoch: 10, Steps: 7 | Train Loss: 0.064 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 11 cost time: 0.6074016094207764
Epoch: 11, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.917 Test Loss: 0.292 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.569624662399292
Epoch: 12, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.635756254196167
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.5786914825439453
Epoch: 14, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.4901268482208252
Epoch: 15, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.491762638092041
Epoch: 16, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5776011943817139
Epoch: 17, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.596886157989502
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.917 Test Loss: 0.217 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5051600933074951
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.5365493297576904
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5654211044311523
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49317336082458496
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.480072021484375
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5317914485931396
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.931 Test Loss: 0.218 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 25 cost time: 0.6027843952178955
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5617895126342773
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6974902153015137
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5976216793060303
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.917 Test Loss: 0.205 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5522341728210449
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 30 cost time: 0.6434848308563232
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6620686054229736
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4565861225128174
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6300315856933594
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6114230155944824
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.931 Test Loss: 0.204 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4681413173675537
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4899144172668457
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.931 Test Loss: 0.205 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.4988868236541748
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.931 Test Loss: 0.207 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5038855075836182
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.931 Test Loss: 0.210 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5678393840789795
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps109_str109_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23735052
model size : 105.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps120_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.150463581085205
Epoch: 1, Steps: 7 | Train Loss: 2.663 Vali Loss: 2.492 Vali Acc: 0.097 Test Loss: 2.492 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.668816328048706
Epoch: 2, Steps: 7 | Train Loss: 2.245 Vali Loss: 2.059 Vali Acc: 0.528 Test Loss: 2.059 Test Acc: 0.528
Validation loss decreased (-0.097197 --> -0.527757).  Saving model ...
Epoch: 3 cost time: 0.9441304206848145
Epoch: 3, Steps: 7 | Train Loss: 1.760 Vali Loss: 1.464 Vali Acc: 0.736 Test Loss: 1.464 Test Acc: 0.736
Validation loss decreased (-0.527757 --> -0.736096).  Saving model ...
Epoch: 4 cost time: 0.6829934120178223
Epoch: 4, Steps: 7 | Train Loss: 1.065 Vali Loss: 0.781 Vali Acc: 0.833 Test Loss: 0.781 Test Acc: 0.833
Validation loss decreased (-0.736096 --> -0.833326).  Saving model ...
Epoch: 5 cost time: 0.85086989402771
Epoch: 5, Steps: 7 | Train Loss: 0.492 Vali Loss: 0.595 Vali Acc: 0.806 Test Loss: 0.595 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7215869426727295
Epoch: 6, Steps: 7 | Train Loss: 0.211 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
Validation loss decreased (-0.833326 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.6334073543548584
Epoch: 7, Steps: 7 | Train Loss: 0.062 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5953974723815918
Epoch: 8, Steps: 7 | Train Loss: 0.035 Vali Loss: 0.380 Vali Acc: 0.847 Test Loss: 0.380 Test Acc: 0.847
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6487247943878174
Epoch: 9, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.903 Test Loss: 0.298 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.6088497638702393
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.9442968368530273
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.9148344993591309
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6767394542694092
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.903 Test Loss: 0.321 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8345487117767334
Epoch: 14, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9487543106079102
Epoch: 15, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8863449096679688
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.889 Test Loss: 0.365 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6627705097198486
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.903 Test Loss: 0.353 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9585027694702148
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.340 Vali Acc: 0.903 Test Loss: 0.340 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.882659912109375
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.903 Test Loss: 0.332 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7210268974304199
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.903 Test Loss: 0.331 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9118139743804932
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.903 Test Loss: 0.328 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps120_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 24166668
model size : 106.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps120_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3978731632232666
Epoch: 1, Steps: 7 | Train Loss: 2.591 Vali Loss: 2.426 Vali Acc: 0.111 Test Loss: 2.426 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.661280632019043
Epoch: 2, Steps: 7 | Train Loss: 2.324 Vali Loss: 2.117 Vali Acc: 0.597 Test Loss: 2.117 Test Acc: 0.597
Validation loss decreased (-0.111087 --> -0.597201).  Saving model ...
Epoch: 3 cost time: 0.7947776317596436
Epoch: 3, Steps: 7 | Train Loss: 1.923 Vali Loss: 1.644 Vali Acc: 0.806 Test Loss: 1.644 Test Acc: 0.806
Validation loss decreased (-0.597201 --> -0.805539).  Saving model ...
Epoch: 4 cost time: 0.6107456684112549
Epoch: 4, Steps: 7 | Train Loss: 1.512 Vali Loss: 1.077 Vali Acc: 0.833 Test Loss: 1.077 Test Acc: 0.833
Validation loss decreased (-0.805539 --> -0.833323).  Saving model ...
Epoch: 5 cost time: 0.8870487213134766
Epoch: 5, Steps: 7 | Train Loss: 0.975 Vali Loss: 0.735 Vali Acc: 0.806 Test Loss: 0.735 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5798494815826416
Epoch: 6, Steps: 7 | Train Loss: 0.498 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.7936511039733887
Epoch: 7, Steps: 7 | Train Loss: 0.238 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.833328 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.7797539234161377
Epoch: 8, Steps: 7 | Train Loss: 0.125 Vali Loss: 0.358 Vali Acc: 0.889 Test Loss: 0.358 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.7783691883087158
Epoch: 9, Steps: 7 | Train Loss: 0.044 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916663).  Saving model ...
Epoch: 10 cost time: 0.6857659816741943
Epoch: 10, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8760085105895996
Epoch: 11, Steps: 7 | Train Loss: 0.022 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6011826992034912
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.903 Test Loss: 0.238 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.587414026260376
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.849747896194458
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7069156169891357
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6609084606170654
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.917 Test Loss: 0.233 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.8878486156463623
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6760246753692627
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.931 Test Loss: 0.243 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.6482117176055908
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7116050720214844
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6304912567138672
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.931 Test Loss: 0.256 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5029425621032715
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.43703484535217285
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.931 Test Loss: 0.250 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.608910322189331
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6235344409942627
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5893149375915527
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6267044544219971
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6015698909759521
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.931 Test Loss: 0.253 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps120_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23973132
model size : 106.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps120_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9665966033935547
Epoch: 1, Steps: 7 | Train Loss: 2.594 Vali Loss: 2.498 Vali Acc: 0.028 Test Loss: 2.498 Test Acc: 0.028
Validation loss decreased (inf --> -0.027753).  Saving model ...
Epoch: 2 cost time: 0.6149570941925049
Epoch: 2, Steps: 7 | Train Loss: 2.400 Vali Loss: 2.299 Vali Acc: 0.278 Test Loss: 2.299 Test Acc: 0.278
Validation loss decreased (-0.027753 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 0.5991945266723633
Epoch: 3, Steps: 7 | Train Loss: 2.140 Vali Loss: 2.036 Vali Acc: 0.542 Test Loss: 2.036 Test Acc: 0.542
Validation loss decreased (-0.277755 --> -0.541646).  Saving model ...
Epoch: 4 cost time: 0.5963714122772217
Epoch: 4, Steps: 7 | Train Loss: 1.816 Vali Loss: 1.711 Vali Acc: 0.694 Test Loss: 1.711 Test Acc: 0.694
Validation loss decreased (-0.541646 --> -0.694427).  Saving model ...
Epoch: 5 cost time: 0.5817406177520752
Epoch: 5, Steps: 7 | Train Loss: 1.380 Vali Loss: 1.280 Vali Acc: 0.819 Test Loss: 1.280 Test Acc: 0.819
Validation loss decreased (-0.694427 --> -0.819432).  Saving model ...
Epoch: 6 cost time: 0.5082731246948242
Epoch: 6, Steps: 7 | Train Loss: 1.001 Vali Loss: 0.878 Vali Acc: 0.806 Test Loss: 0.878 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5696475505828857
Epoch: 7, Steps: 7 | Train Loss: 0.647 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.819432 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 0.5964980125427246
Epoch: 8, Steps: 7 | Train Loss: 0.335 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5381674766540527
Epoch: 9, Steps: 7 | Train Loss: 0.169 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861107).  Saving model ...
Epoch: 10 cost time: 0.628765344619751
Epoch: 10, Steps: 7 | Train Loss: 0.077 Vali Loss: 0.395 Vali Acc: 0.847 Test Loss: 0.395 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5960960388183594
Epoch: 11, Steps: 7 | Train Loss: 0.041 Vali Loss: 0.335 Vali Acc: 0.861 Test Loss: 0.335 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 0.6111965179443359
Epoch: 12, Steps: 7 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5559468269348145
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.889 Test Loss: 0.300 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5379621982574463
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.295 Vali Acc: 0.903 Test Loss: 0.295 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.5710134506225586
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.289 Vali Acc: 0.903 Test Loss: 0.289 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.5530438423156738
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.6046197414398193
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.917 Test Loss: 0.270 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 0.6393754482269287
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.6638190746307373
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.931 Test Loss: 0.261 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.6824309825897217
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5731918811798096
Epoch: 21, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6351258754730225
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.600142240524292
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6216135025024414
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5501449108123779
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5618245601654053
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6335318088531494
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.917 Test Loss: 0.263 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6242315769195557
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6267654895782471
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps120_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 23876364
model size : 105.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps133_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.3435487747192383
Epoch: 1, Steps: 7 | Train Loss: 2.617 Vali Loss: 2.355 Vali Acc: 0.250 Test Loss: 2.355 Test Acc: 0.250
Validation loss decreased (inf --> -0.249976).  Saving model ...
Epoch: 2 cost time: 0.9133379459381104
Epoch: 2, Steps: 7 | Train Loss: 2.209 Vali Loss: 1.978 Vali Acc: 0.569 Test Loss: 1.978 Test Acc: 0.569
Validation loss decreased (-0.249976 --> -0.569425).  Saving model ...
Epoch: 3 cost time: 0.9849932193756104
Epoch: 3, Steps: 7 | Train Loss: 1.798 Vali Loss: 1.484 Vali Acc: 0.764 Test Loss: 1.484 Test Acc: 0.764
Validation loss decreased (-0.569425 --> -0.763874).  Saving model ...
Epoch: 4 cost time: 0.9604747295379639
Epoch: 4, Steps: 7 | Train Loss: 1.240 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
Validation loss decreased (-0.763874 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 0.7882492542266846
Epoch: 5, Steps: 7 | Train Loss: 0.639 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
Validation loss decreased (-0.833324 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 0.9583075046539307
Epoch: 6, Steps: 7 | Train Loss: 0.246 Vali Loss: 0.381 Vali Acc: 0.889 Test Loss: 0.381 Test Acc: 0.889
Validation loss decreased (-0.874995 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.9885604381561279
Epoch: 7, Steps: 7 | Train Loss: 0.070 Vali Loss: 0.300 Vali Acc: 0.903 Test Loss: 0.300 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.8262689113616943
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.361 Vali Acc: 0.889 Test Loss: 0.361 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9343717098236084
Epoch: 9, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.290 Vali Acc: 0.917 Test Loss: 0.290 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.8227269649505615
Epoch: 10, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.7787742614746094
Epoch: 11, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 12 cost time: 0.7740683555603027
Epoch: 12, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.931 Test Loss: 0.182 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 0.68155837059021
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.931 Test Loss: 0.188 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7870357036590576
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.930554 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.7856168746948242
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8061892986297607
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.7864036560058594
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.931 Test Loss: 0.192 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7666220664978027
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.931 Test Loss: 0.197 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7613246440887451
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.931 Test Loss: 0.199 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6789858341217041
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9056661128997803
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.931 Test Loss: 0.203 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.000974416732788
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8188345432281494
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9677457809448242
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8615067005157471
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8735229969024658
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps133_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 24303372
model size : 107.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps133_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2050578594207764
Epoch: 1, Steps: 7 | Train Loss: 2.603 Vali Loss: 2.448 Vali Acc: 0.111 Test Loss: 2.448 Test Acc: 0.111
Validation loss decreased (inf --> -0.111087).  Saving model ...
Epoch: 2 cost time: 0.7550959587097168
Epoch: 2, Steps: 7 | Train Loss: 2.394 Vali Loss: 2.166 Vali Acc: 0.417 Test Loss: 2.166 Test Acc: 0.417
Validation loss decreased (-0.111087 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.6620438098907471
Epoch: 3, Steps: 7 | Train Loss: 2.074 Vali Loss: 1.867 Vali Acc: 0.625 Test Loss: 1.867 Test Acc: 0.625
Validation loss decreased (-0.416645 --> -0.624981).  Saving model ...
Epoch: 4 cost time: 0.6806797981262207
Epoch: 4, Steps: 7 | Train Loss: 1.661 Vali Loss: 1.494 Vali Acc: 0.806 Test Loss: 1.494 Test Acc: 0.806
Validation loss decreased (-0.624981 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.7185747623443604
Epoch: 5, Steps: 7 | Train Loss: 1.154 Vali Loss: 0.865 Vali Acc: 0.875 Test Loss: 0.865 Test Acc: 0.875
Validation loss decreased (-0.805541 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 0.7489395141601562
Epoch: 6, Steps: 7 | Train Loss: 0.612 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6725482940673828
Epoch: 7, Steps: 7 | Train Loss: 0.288 Vali Loss: 0.437 Vali Acc: 0.861 Test Loss: 0.437 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7163195610046387
Epoch: 8, Steps: 7 | Train Loss: 0.116 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
Validation loss decreased (-0.874991 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.7413194179534912
Epoch: 9, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
Validation loss decreased (-0.888885 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.9000673294067383
Epoch: 10, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.916664 --> -0.958331).  Saving model ...
Epoch: 11 cost time: 0.7629966735839844
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.507220983505249
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.931 Test Loss: 0.183 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8147447109222412
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.931 Test Loss: 0.176 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7975826263427734
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7870571613311768
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9044821262359619
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8975565433502197
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7388079166412354
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7562322616577148
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.931 Test Loss: 0.170 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.872429609298706
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.931 Test Loss: 0.169 Test Acc: 0.931
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps133_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 24131340
model size : 106.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps133_str133_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9502379894256592
Epoch: 1, Steps: 7 | Train Loss: 2.607 Vali Loss: 2.494 Vali Acc: 0.097 Test Loss: 2.494 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.6388823986053467
Epoch: 2, Steps: 7 | Train Loss: 2.401 Vali Loss: 2.241 Vali Acc: 0.375 Test Loss: 2.241 Test Acc: 0.375
Validation loss decreased (-0.097197 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.6107962131500244
Epoch: 3, Steps: 7 | Train Loss: 2.118 Vali Loss: 1.999 Vali Acc: 0.556 Test Loss: 1.999 Test Acc: 0.556
Validation loss decreased (-0.374978 --> -0.555536).  Saving model ...
Epoch: 4 cost time: 0.6379356384277344
Epoch: 4, Steps: 7 | Train Loss: 1.772 Vali Loss: 1.703 Vali Acc: 0.722 Test Loss: 1.703 Test Acc: 0.722
Validation loss decreased (-0.555536 --> -0.722205).  Saving model ...
Epoch: 5 cost time: 0.6354007720947266
Epoch: 5, Steps: 7 | Train Loss: 1.459 Vali Loss: 1.306 Vali Acc: 0.861 Test Loss: 1.306 Test Acc: 0.861
Validation loss decreased (-0.722205 --> -0.861098).  Saving model ...
Epoch: 6 cost time: 0.6904573440551758
Epoch: 6, Steps: 7 | Train Loss: 0.957 Vali Loss: 0.886 Vali Acc: 0.861 Test Loss: 0.886 Test Acc: 0.861
Validation loss decreased (-0.861098 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 0.6591775417327881
Epoch: 7, Steps: 7 | Train Loss: 0.600 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
Validation loss decreased (-0.861102 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.5763547420501709
Epoch: 8, Steps: 7 | Train Loss: 0.282 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 9 cost time: 0.6351950168609619
Epoch: 9, Steps: 7 | Train Loss: 0.131 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902775).  Saving model ...
Epoch: 10 cost time: 0.5662930011749268
Epoch: 10, Steps: 7 | Train Loss: 0.065 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.5759530067443848
Epoch: 11, Steps: 7 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6128442287445068
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930554).  Saving model ...
Epoch: 13 cost time: 0.6286830902099609
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.930554 --> -0.958332).  Saving model ...
Epoch: 14 cost time: 0.5938031673431396
Epoch: 14, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 15 cost time: 0.5211586952209473
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6485681533813477
Epoch: 16, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6267967224121094
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6252357959747314
Epoch: 18, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6463437080383301
Epoch: 19, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.623002290725708
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6014602184295654
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5881578922271729
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 0.6497707366943359
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6404242515563965
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6664073467254639
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6980805397033691
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6583635807037354
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6325681209564209
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 29 cost time: 0.574408769607544
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.958 Test Loss: 0.151 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.6726887226104736
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.605492115020752
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5057275295257568
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.6351006031036377
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.6620595455169678
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 35 cost time: 0.6151547431945801
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6056623458862305
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6282942295074463
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6680381298065186
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6138410568237305
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7001874446868896
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 41 cost time: 0.6203088760375977
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 42 cost time: 0.6824195384979248
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6750187873840332
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5762302875518799
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6321532726287842
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 46 cost time: 0.5945122241973877
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 47 cost time: 0.6037960052490234
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 48 cost time: 0.5931837558746338
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.958 Test Loss: 0.137 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6377036571502686
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6987359523773193
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps133_str133_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 24056076
model size : 106.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.450700521469116
Epoch: 1, Steps: 7 | Train Loss: 2.581 Vali Loss: 2.376 Vali Acc: 0.125 Test Loss: 2.376 Test Acc: 0.125
Validation loss decreased (inf --> -0.124976).  Saving model ...
Epoch: 2 cost time: 0.7786352634429932
Epoch: 2, Steps: 7 | Train Loss: 2.327 Vali Loss: 2.046 Vali Acc: 0.639 Test Loss: 2.046 Test Acc: 0.639
Validation loss decreased (-0.124976 --> -0.638868).  Saving model ...
Epoch: 3 cost time: 0.8743393421173096
Epoch: 3, Steps: 7 | Train Loss: 1.884 Vali Loss: 1.671 Vali Acc: 0.750 Test Loss: 1.671 Test Acc: 0.750
Validation loss decreased (-0.638868 --> -0.749983).  Saving model ...
Epoch: 4 cost time: 0.779266357421875
Epoch: 4, Steps: 7 | Train Loss: 1.353 Vali Loss: 1.172 Vali Acc: 0.806 Test Loss: 1.172 Test Acc: 0.806
Validation loss decreased (-0.749983 --> -0.805544).  Saving model ...
Epoch: 5 cost time: 0.8125922679901123
Epoch: 5, Steps: 7 | Train Loss: 0.753 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
Validation loss decreased (-0.805544 --> -0.861105).  Saving model ...
Epoch: 6 cost time: 0.7711772918701172
Epoch: 6, Steps: 7 | Train Loss: 0.301 Vali Loss: 0.385 Vali Acc: 0.875 Test Loss: 0.385 Test Acc: 0.875
Validation loss decreased (-0.861105 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.7991454601287842
Epoch: 7, Steps: 7 | Train Loss: 0.114 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888886).  Saving model ...
Epoch: 8 cost time: 0.7116227149963379
Epoch: 8, Steps: 7 | Train Loss: 0.036 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7164051532745361
Epoch: 9, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5655207633972168
Epoch: 10, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6719455718994141
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7576839923858643
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8956000804901123
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.875952959060669
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9874794483184814
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.7459859848022461
Epoch: 16, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 17 cost time: 0.7807867527008057
Epoch: 17, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7797262668609619
Epoch: 18, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.903 Test Loss: 0.275 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8375334739685059
Epoch: 19, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.759117603302002
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 21 cost time: 0.9834260940551758
Epoch: 21, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 0.7281537055969238
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 1.0136494636535645
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9662690162658691
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9285943508148193
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.9958102703094482
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.9650468826293945
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 1.0144426822662354
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.7345860004425049
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.265 Vali Acc: 0.903 Test Loss: 0.265 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7167198657989502
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.264 Vali Acc: 0.903 Test Loss: 0.264 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8692371845245361
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.262 Vali Acc: 0.903 Test Loss: 0.262 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8179888725280762
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5558927059173584
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8065447807312012
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7162771224975586
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.261 Vali Acc: 0.903 Test Loss: 0.261 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7455809116363525
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.8613076210021973
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 38 cost time: 0.7586734294891357
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.845595121383667
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 40 cost time: 0.7501227855682373
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.257 Vali Acc: 0.903 Test Loss: 0.257 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8864729404449463
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8736119270324707
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9102823734283447
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 44 cost time: 0.9897763729095459
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 45 cost time: 0.7013115882873535
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9746785163879395
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9367985725402832
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6715521812438965
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 49 cost time: 0.7041764259338379
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 50 cost time: 0.8147835731506348
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 24495372
model size : 108.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0608937740325928
Epoch: 1, Steps: 7 | Train Loss: 2.595 Vali Loss: 2.497 Vali Acc: 0.097 Test Loss: 2.497 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5789177417755127
Epoch: 2, Steps: 7 | Train Loss: 2.440 Vali Loss: 2.263 Vali Acc: 0.403 Test Loss: 2.263 Test Acc: 0.403
Validation loss decreased (-0.097197 --> -0.402755).  Saving model ...
Epoch: 3 cost time: 0.638662576675415
Epoch: 3, Steps: 7 | Train Loss: 2.092 Vali Loss: 1.931 Vali Acc: 0.653 Test Loss: 1.931 Test Acc: 0.653
Validation loss decreased (-0.402755 --> -0.652758).  Saving model ...
Epoch: 4 cost time: 0.7095804214477539
Epoch: 4, Steps: 7 | Train Loss: 1.639 Vali Loss: 1.500 Vali Acc: 0.861 Test Loss: 1.500 Test Acc: 0.861
Validation loss decreased (-0.652758 --> -0.861096).  Saving model ...
Epoch: 5 cost time: 0.7131407260894775
Epoch: 5, Steps: 7 | Train Loss: 1.126 Vali Loss: 0.994 Vali Acc: 0.889 Test Loss: 0.994 Test Acc: 0.889
Validation loss decreased (-0.861096 --> -0.888879).  Saving model ...
Epoch: 6 cost time: 0.590463399887085
Epoch: 6, Steps: 7 | Train Loss: 0.632 Vali Loss: 0.593 Vali Acc: 0.889 Test Loss: 0.593 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888883).  Saving model ...
Epoch: 7 cost time: 0.6653294563293457
Epoch: 7, Steps: 7 | Train Loss: 0.310 Vali Loss: 0.419 Vali Acc: 0.847 Test Loss: 0.419 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7256410121917725
Epoch: 8, Steps: 7 | Train Loss: 0.153 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5989930629730225
Epoch: 9, Steps: 7 | Train Loss: 0.074 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.6263391971588135
Epoch: 10, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.374 Vali Acc: 0.847 Test Loss: 0.374 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6451919078826904
Epoch: 11, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.368 Vali Acc: 0.903 Test Loss: 0.368 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.6167356967926025
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.902774 --> -0.916664).  Saving model ...
Epoch: 13 cost time: 0.6649620532989502
Epoch: 13, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.903 Test Loss: 0.282 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5297892093658447
Epoch: 14, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.647517204284668
Epoch: 15, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.875 Test Loss: 0.288 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7443463802337646
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7665581703186035
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6469912528991699
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6513924598693848
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 20 cost time: 0.7020084857940674
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 21 cost time: 0.583052396774292
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 22 cost time: 0.797576904296875
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6015727519989014
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.931 Test Loss: 0.281 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6643276214599609
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7208061218261719
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.279 Vali Acc: 0.931 Test Loss: 0.279 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7410223484039307
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 27 cost time: 0.715545654296875
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6880884170532227
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5728192329406738
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6132991313934326
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6742575168609619
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.931 Test Loss: 0.280 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6866357326507568
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 33 cost time: 0.545665979385376
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6547942161560059
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6330361366271973
Epoch: 35, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6193733215332031
Epoch: 36, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 37 cost time: 0.6452333927154541
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 38 cost time: 0.6541519165039062
Epoch: 38, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6383392810821533
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6289253234863281
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.931 Test Loss: 0.275 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6056327819824219
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6231138706207275
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6330451965332031
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5534417629241943
Epoch: 44, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5812208652496338
Epoch: 45, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 46 cost time: 0.6510717868804932
Epoch: 46, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.931 Test Loss: 0.273 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.61507248878479
Epoch: 47, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.628577470779419
Epoch: 48, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.931 Test Loss: 0.276 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5692605972290039
Epoch: 49, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6185541152954102
Epoch: 50, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.931 Test Loss: 0.278 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 24344844
model size : 107.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0212011337280273
Epoch: 1, Steps: 7 | Train Loss: 2.623 Vali Loss: 2.519 Vali Acc: 0.083 Test Loss: 2.519 Test Acc: 0.083
Validation loss decreased (inf --> -0.083308).  Saving model ...
Epoch: 2 cost time: 0.5846829414367676
Epoch: 2, Steps: 7 | Train Loss: 2.450 Vali Loss: 2.276 Vali Acc: 0.375 Test Loss: 2.276 Test Acc: 0.375
Validation loss decreased (-0.083308 --> -0.374977).  Saving model ...
Epoch: 3 cost time: 0.5556459426879883
Epoch: 3, Steps: 7 | Train Loss: 2.179 Vali Loss: 2.002 Vali Acc: 0.500 Test Loss: 2.002 Test Acc: 0.500
Validation loss decreased (-0.374977 --> -0.499980).  Saving model ...
Epoch: 4 cost time: 0.5299391746520996
Epoch: 4, Steps: 7 | Train Loss: 1.793 Vali Loss: 1.669 Vali Acc: 0.750 Test Loss: 1.669 Test Acc: 0.750
Validation loss decreased (-0.499980 --> -0.749983).  Saving model ...
Epoch: 5 cost time: 0.6222884654998779
Epoch: 5, Steps: 7 | Train Loss: 1.397 Vali Loss: 1.243 Vali Acc: 0.833 Test Loss: 1.243 Test Acc: 0.833
Validation loss decreased (-0.749983 --> -0.833321).  Saving model ...
Epoch: 6 cost time: 0.5473864078521729
Epoch: 6, Steps: 7 | Train Loss: 0.951 Vali Loss: 0.877 Vali Acc: 0.861 Test Loss: 0.877 Test Acc: 0.861
Validation loss decreased (-0.833321 --> -0.861102).  Saving model ...
Epoch: 7 cost time: 0.6204464435577393
Epoch: 7, Steps: 7 | Train Loss: 0.596 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.861102 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.5659382343292236
Epoch: 8, Steps: 7 | Train Loss: 0.358 Vali Loss: 0.512 Vali Acc: 0.833 Test Loss: 0.512 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5602760314941406
Epoch: 9, Steps: 7 | Train Loss: 0.166 Vali Loss: 0.436 Vali Acc: 0.819 Test Loss: 0.436 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5419766902923584
Epoch: 10, Steps: 7 | Train Loss: 0.094 Vali Loss: 0.359 Vali Acc: 0.833 Test Loss: 0.359 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5057227611541748
Epoch: 11, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.347 Vali Acc: 0.847 Test Loss: 0.347 Test Acc: 0.847
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5914556980133057
Epoch: 12, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6065285205841064
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.49853062629699707
Epoch: 14, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5253486633300781
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.861 Test Loss: 0.297 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5754795074462891
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5758697986602783
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.875
model parameter : 24269580
model size : 107.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps171_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.2085442543029785
Epoch: 1, Steps: 7 | Train Loss: 2.628 Vali Loss: 2.422 Vali Acc: 0.236 Test Loss: 2.422 Test Acc: 0.236
Validation loss decreased (inf --> -0.236087).  Saving model ...
Epoch: 2 cost time: 0.7460546493530273
Epoch: 2, Steps: 7 | Train Loss: 2.324 Vali Loss: 2.069 Vali Acc: 0.472 Test Loss: 2.069 Test Acc: 0.472
Validation loss decreased (-0.236087 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 0.8456363677978516
Epoch: 3, Steps: 7 | Train Loss: 1.909 Vali Loss: 1.626 Vali Acc: 0.708 Test Loss: 1.626 Test Acc: 0.708
Validation loss decreased (-0.472202 --> -0.708317).  Saving model ...
Epoch: 4 cost time: 0.7464566230773926
Epoch: 4, Steps: 7 | Train Loss: 1.254 Vali Loss: 1.070 Vali Acc: 0.819 Test Loss: 1.070 Test Acc: 0.819
Validation loss decreased (-0.708317 --> -0.819434).  Saving model ...
Epoch: 5 cost time: 0.7711832523345947
Epoch: 5, Steps: 7 | Train Loss: 0.697 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6312806606292725
Epoch: 6, Steps: 7 | Train Loss: 0.279 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833328).  Saving model ...
Epoch: 7 cost time: 0.8347280025482178
Epoch: 7, Steps: 7 | Train Loss: 0.103 Vali Loss: 0.417 Vali Acc: 0.875 Test Loss: 0.417 Test Acc: 0.875
Validation loss decreased (-0.833328 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 0.5938208103179932
Epoch: 8, Steps: 7 | Train Loss: 0.034 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.834808349609375
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 0.8770182132720947
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.6706664562225342
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.348 Vali Acc: 0.903 Test Loss: 0.348 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 12 cost time: 0.7880125045776367
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.903 Test Loss: 0.304 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902775).  Saving model ...
Epoch: 13 cost time: 0.8566200733184814
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.903 Test Loss: 0.302 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 14 cost time: 0.751103401184082
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.917 Test Loss: 0.299 Test Acc: 0.917
Validation loss decreased (-0.902775 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.9202148914337158
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.6860685348510742
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.903 Test Loss: 0.294 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8744497299194336
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.903 Test Loss: 0.286 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.82798171043396
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6901264190673828
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.903 Test Loss: 0.280 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6932244300842285
Epoch: 20, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6465227603912354
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6757712364196777
Epoch: 22, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8483805656433105
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.288 Vali Acc: 0.903 Test Loss: 0.288 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6778550148010254
Epoch: 24, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5898778438568115
Epoch: 25, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.293 Vali Acc: 0.903 Test Loss: 0.293 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps171_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 24742668
model size : 109.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps171_str86_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9210386276245117
Epoch: 1, Steps: 7 | Train Loss: 2.681 Vali Loss: 2.492 Vali Acc: 0.097 Test Loss: 2.492 Test Acc: 0.097
Validation loss decreased (inf --> -0.097197).  Saving model ...
Epoch: 2 cost time: 0.5179078578948975
Epoch: 2, Steps: 7 | Train Loss: 2.370 Vali Loss: 2.236 Vali Acc: 0.472 Test Loss: 2.236 Test Acc: 0.472
Validation loss decreased (-0.097197 --> -0.472200).  Saving model ...
Epoch: 3 cost time: 0.6146764755249023
Epoch: 3, Steps: 7 | Train Loss: 2.019 Vali Loss: 1.886 Vali Acc: 0.583 Test Loss: 1.886 Test Acc: 0.583
Validation loss decreased (-0.472200 --> -0.583314).  Saving model ...
Epoch: 4 cost time: 0.5672013759613037
Epoch: 4, Steps: 7 | Train Loss: 1.568 Vali Loss: 1.446 Vali Acc: 0.722 Test Loss: 1.446 Test Acc: 0.722
Validation loss decreased (-0.583314 --> -0.722208).  Saving model ...
Epoch: 5 cost time: 0.7762625217437744
Epoch: 5, Steps: 7 | Train Loss: 1.042 Vali Loss: 0.993 Vali Acc: 0.806 Test Loss: 0.993 Test Acc: 0.806
Validation loss decreased (-0.722208 --> -0.805546).  Saving model ...
Epoch: 6 cost time: 0.6098074913024902
Epoch: 6, Steps: 7 | Train Loss: 0.550 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.805546 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 0.6668972969055176
Epoch: 7, Steps: 7 | Train Loss: 0.233 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.874994 --> -0.888885).  Saving model ...
Epoch: 8 cost time: 0.6042385101318359
Epoch: 8, Steps: 7 | Train Loss: 0.101 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.888885 --> -0.930553).  Saving model ...
Epoch: 9 cost time: 0.6143693923950195
Epoch: 9, Steps: 7 | Train Loss: 0.038 Vali Loss: 0.297 Vali Acc: 0.903 Test Loss: 0.297 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5711450576782227
Epoch: 10, Steps: 7 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 11 cost time: 0.5685255527496338
Epoch: 11, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5258505344390869
Epoch: 12, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.931 Test Loss: 0.206 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.517221212387085
Epoch: 13, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.944442 --> -0.958331).  Saving model ...
Epoch: 14 cost time: 0.6037459373474121
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 15 cost time: 0.6088309288024902
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958331).  Saving model ...
Epoch: 16 cost time: 0.5223946571350098
Epoch: 16, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.958331 --> -0.958332).  Saving model ...
Epoch: 17 cost time: 0.6161370277404785
Epoch: 17, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 18 cost time: 0.5936570167541504
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4501523971557617
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5952527523040771
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 21 cost time: 0.6665647029876709
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 22 cost time: 0.7631626129150391
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 23 cost time: 0.572704553604126
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 24 cost time: 0.6829888820648193
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 25 cost time: 0.6119298934936523
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 26 cost time: 0.7167792320251465
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 27 cost time: 0.5958032608032227
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5477199554443359
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6494734287261963
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 30 cost time: 0.6518259048461914
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 31 cost time: 0.7038156986236572
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 32 cost time: 0.6020495891571045
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 33 cost time: 0.7000439167022705
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.958332 --> -0.958332).  Saving model ...
Epoch: 34 cost time: 0.5889196395874023
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5657694339752197
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6494014263153076
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6420176029205322
Epoch: 37, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6049797534942627
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5243053436279297
Epoch: 39, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5114681720733643
Epoch: 40, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5139174461364746
Epoch: 41, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5687077045440674
Epoch: 42, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6782541275024414
Epoch: 43, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps171_str86_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9583333333333334
model parameter : 24613644
model size : 108.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps171_str171_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8931522369384766
Epoch: 1, Steps: 7 | Train Loss: 2.600 Vali Loss: 2.540 Vali Acc: 0.153 Test Loss: 2.540 Test Acc: 0.153
Validation loss decreased (inf --> -0.152752).  Saving model ...
Epoch: 2 cost time: 0.49073147773742676
Epoch: 2, Steps: 7 | Train Loss: 2.378 Vali Loss: 2.210 Vali Acc: 0.375 Test Loss: 2.210 Test Acc: 0.375
Validation loss decreased (-0.152752 --> -0.374978).  Saving model ...
Epoch: 3 cost time: 0.60056471824646
Epoch: 3, Steps: 7 | Train Loss: 2.008 Vali Loss: 1.857 Vali Acc: 0.611 Test Loss: 1.857 Test Acc: 0.611
Validation loss decreased (-0.374978 --> -0.611093).  Saving model ...
Epoch: 4 cost time: 0.5774335861206055
Epoch: 4, Steps: 7 | Train Loss: 1.684 Vali Loss: 1.562 Vali Acc: 0.750 Test Loss: 1.562 Test Acc: 0.750
Validation loss decreased (-0.611093 --> -0.749984).  Saving model ...
Epoch: 5 cost time: 0.6445071697235107
Epoch: 5, Steps: 7 | Train Loss: 1.382 Vali Loss: 1.222 Vali Acc: 0.847 Test Loss: 1.222 Test Acc: 0.847
Validation loss decreased (-0.749984 --> -0.847210).  Saving model ...
Epoch: 6 cost time: 0.6355359554290771
Epoch: 6, Steps: 7 | Train Loss: 0.917 Vali Loss: 0.900 Vali Acc: 0.806 Test Loss: 0.900 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5294864177703857
Epoch: 7, Steps: 7 | Train Loss: 0.552 Vali Loss: 0.648 Vali Acc: 0.833 Test Loss: 0.648 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5236837863922119
Epoch: 8, Steps: 7 | Train Loss: 0.281 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.847210 --> -0.861106).  Saving model ...
Epoch: 9 cost time: 0.6036059856414795
Epoch: 9, Steps: 7 | Train Loss: 0.148 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
Validation loss decreased (-0.861106 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 0.609095573425293
Epoch: 10, Steps: 7 | Train Loss: 0.061 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
Validation loss decreased (-0.874995 --> -0.916663).  Saving model ...
Epoch: 11 cost time: 0.5836308002471924
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.319 Vali Acc: 0.903 Test Loss: 0.319 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5767264366149902
Epoch: 12, Steps: 7 | Train Loss: 0.019 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.554009199142456
Epoch: 13, Steps: 7 | Train Loss: 0.013 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6170246601104736
Epoch: 14, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.635352611541748
Epoch: 15, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.347 Vali Acc: 0.861 Test Loss: 0.347 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5853605270385742
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5923545360565186
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.875 Test Loss: 0.348 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.552173376083374
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6533870697021484
Epoch: 19, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5814392566680908
Epoch: 20, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps171_str171_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9166666666666666
model parameter : 24559884
model size : 108.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps200_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9217205047607422
Epoch: 1, Steps: 7 | Train Loss: 2.635 Vali Loss: 2.470 Vali Acc: 0.139 Test Loss: 2.470 Test Acc: 0.139
Validation loss decreased (inf --> -0.138864).  Saving model ...
Epoch: 2 cost time: 0.523353099822998
Epoch: 2, Steps: 7 | Train Loss: 2.306 Vali Loss: 2.030 Vali Acc: 0.569 Test Loss: 2.030 Test Acc: 0.569
Validation loss decreased (-0.138864 --> -0.569424).  Saving model ...
Epoch: 3 cost time: 0.6447165012359619
Epoch: 3, Steps: 7 | Train Loss: 1.784 Vali Loss: 1.555 Vali Acc: 0.667 Test Loss: 1.555 Test Acc: 0.667
Validation loss decreased (-0.569424 --> -0.666651).  Saving model ...
Epoch: 4 cost time: 0.7000784873962402
Epoch: 4, Steps: 7 | Train Loss: 1.248 Vali Loss: 1.088 Vali Acc: 0.694 Test Loss: 1.088 Test Acc: 0.694
Validation loss decreased (-0.666651 --> -0.694434).  Saving model ...
Epoch: 5 cost time: 0.6794455051422119
Epoch: 5, Steps: 7 | Train Loss: 0.647 Vali Loss: 0.699 Vali Acc: 0.819 Test Loss: 0.699 Test Acc: 0.819
Validation loss decreased (-0.694434 --> -0.819437).  Saving model ...
Epoch: 6 cost time: 0.6451187133789062
Epoch: 6, Steps: 7 | Train Loss: 0.287 Vali Loss: 0.450 Vali Acc: 0.847 Test Loss: 0.450 Test Acc: 0.847
Validation loss decreased (-0.819437 --> -0.847218).  Saving model ...
Epoch: 7 cost time: 0.6068167686462402
Epoch: 7, Steps: 7 | Train Loss: 0.097 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
Validation loss decreased (-0.847218 --> -0.861107).  Saving model ...
Epoch: 8 cost time: 0.6781268119812012
Epoch: 8, Steps: 7 | Train Loss: 0.033 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.861107 --> -0.916664).  Saving model ...
Epoch: 9 cost time: 0.6484978199005127
Epoch: 9, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 10 cost time: 0.6550817489624023
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 11 cost time: 0.6507837772369385
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 0.6960036754608154
Epoch: 12, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.903 Test Loss: 0.226 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5888588428497314
Epoch: 13, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6732172966003418
Epoch: 14, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.931 Test Loss: 0.223 Test Acc: 0.931
Validation loss decreased (-0.916664 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.7815022468566895
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8532397747039795
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.931 Test Loss: 0.215 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 17 cost time: 0.7592649459838867
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.931 Test Loss: 0.212 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 18 cost time: 0.8392689228057861
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 19 cost time: 0.8007736206054688
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.931 Test Loss: 0.209 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7005622386932373
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6550962924957275
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7399225234985352
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6485352516174316
Epoch: 23, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.931 Test Loss: 0.201 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930554).  Saving model ...
Epoch: 24 cost time: 0.7225058078765869
Epoch: 24, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.931 Test Loss: 0.200 Test Acc: 0.931
Validation loss decreased (-0.930554 --> -0.930554).  Saving model ...
Epoch: 25 cost time: 0.7278783321380615
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6344103813171387
Epoch: 26, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7782654762268066
Epoch: 27, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7283220291137695
Epoch: 28, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7676999568939209
Epoch: 29, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8382866382598877
Epoch: 30, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7090539932250977
Epoch: 31, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6400210857391357
Epoch: 32, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8636496067047119
Epoch: 33, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8038527965545654
Epoch: 34, Steps: 7 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps200_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 25100556
model size : 110.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps200_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.958904504776001
Epoch: 1, Steps: 7 | Train Loss: 2.695 Vali Loss: 2.596 Vali Acc: 0.167 Test Loss: 2.596 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 0.6487014293670654
Epoch: 2, Steps: 7 | Train Loss: 2.452 Vali Loss: 2.214 Vali Acc: 0.417 Test Loss: 2.214 Test Acc: 0.417
Validation loss decreased (-0.166641 --> -0.416645).  Saving model ...
Epoch: 3 cost time: 0.5376079082489014
Epoch: 3, Steps: 7 | Train Loss: 2.007 Vali Loss: 1.868 Vali Acc: 0.667 Test Loss: 1.868 Test Acc: 0.667
Validation loss decreased (-0.416645 --> -0.666648).  Saving model ...
Epoch: 4 cost time: 0.7149732112884521
Epoch: 4, Steps: 7 | Train Loss: 1.649 Vali Loss: 1.443 Vali Acc: 0.806 Test Loss: 1.443 Test Acc: 0.806
Validation loss decreased (-0.666648 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.5495138168334961
Epoch: 5, Steps: 7 | Train Loss: 1.175 Vali Loss: 1.016 Vali Acc: 0.819 Test Loss: 1.016 Test Acc: 0.819
Validation loss decreased (-0.805541 --> -0.819434).  Saving model ...
Epoch: 6 cost time: 0.6761634349822998
Epoch: 6, Steps: 7 | Train Loss: 0.712 Vali Loss: 0.691 Vali Acc: 0.833 Test Loss: 0.691 Test Acc: 0.833
Validation loss decreased (-0.819434 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 0.5784287452697754
Epoch: 7, Steps: 7 | Train Loss: 0.336 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861106).  Saving model ...
Epoch: 8 cost time: 0.5981667041778564
Epoch: 8, Steps: 7 | Train Loss: 0.163 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861107).  Saving model ...
Epoch: 9 cost time: 0.5681900978088379
Epoch: 9, Steps: 7 | Train Loss: 0.063 Vali Loss: 0.354 Vali Acc: 0.861 Test Loss: 0.354 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 0.5827174186706543
Epoch: 10, Steps: 7 | Train Loss: 0.032 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.5928993225097656
Epoch: 11, Steps: 7 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 12 cost time: 0.6070072650909424
Epoch: 12, Steps: 7 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.903 Test Loss: 0.217 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902776).  Saving model ...
Epoch: 13 cost time: 0.6307153701782227
Epoch: 13, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.931 Test Loss: 0.202 Test Acc: 0.931
Validation loss decreased (-0.902776 --> -0.930554).  Saving model ...
Epoch: 14 cost time: 0.5913271903991699
Epoch: 14, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5181117057800293
Epoch: 15, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5933587551116943
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.903 Test Loss: 0.207 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5448229312896729
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.903 Test Loss: 0.200 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.608144998550415
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6803386211395264
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.917 Test Loss: 0.195 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5457708835601807
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.903 Test Loss: 0.195 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5793013572692871
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.917 Test Loss: 0.192 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7061285972595215
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.903 Test Loss: 0.191 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.730506181716919
Epoch: 23, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.903 Test Loss: 0.192 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps200_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 24993036
model size : 110.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps200_str200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9949274063110352
Epoch: 1, Steps: 7 | Train Loss: 2.586 Vali Loss: 2.431 Vali Acc: 0.097 Test Loss: 2.431 Test Acc: 0.097
Validation loss decreased (inf --> -0.097198).  Saving model ...
Epoch: 2 cost time: 0.5667130947113037
Epoch: 2, Steps: 7 | Train Loss: 2.378 Vali Loss: 2.155 Vali Acc: 0.458 Test Loss: 2.155 Test Acc: 0.458
Validation loss decreased (-0.097198 --> -0.458312).  Saving model ...
Epoch: 3 cost time: 0.5737345218658447
Epoch: 3, Steps: 7 | Train Loss: 2.015 Vali Loss: 1.840 Vali Acc: 0.764 Test Loss: 1.840 Test Acc: 0.764
Validation loss decreased (-0.458312 --> -0.763870).  Saving model ...
Epoch: 4 cost time: 0.5137951374053955
Epoch: 4, Steps: 7 | Train Loss: 1.632 Vali Loss: 1.484 Vali Acc: 0.806 Test Loss: 1.484 Test Acc: 0.806
Validation loss decreased (-0.763870 --> -0.805541).  Saving model ...
Epoch: 5 cost time: 0.5664403438568115
Epoch: 5, Steps: 7 | Train Loss: 1.219 Vali Loss: 1.092 Vali Acc: 0.861 Test Loss: 1.092 Test Acc: 0.861
Validation loss decreased (-0.805541 --> -0.861100).  Saving model ...
Epoch: 6 cost time: 0.5908896923065186
Epoch: 6, Steps: 7 | Train Loss: 0.825 Vali Loss: 0.734 Vali Acc: 0.875 Test Loss: 0.734 Test Acc: 0.875
Validation loss decreased (-0.861100 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.5329744815826416
Epoch: 7, Steps: 7 | Train Loss: 0.478 Vali Loss: 0.514 Vali Acc: 0.903 Test Loss: 0.514 Test Acc: 0.903
Validation loss decreased (-0.874993 --> -0.902773).  Saving model ...
Epoch: 8 cost time: 0.6226725578308105
Epoch: 8, Steps: 7 | Train Loss: 0.256 Vali Loss: 0.414 Vali Acc: 0.917 Test Loss: 0.414 Test Acc: 0.917
Validation loss decreased (-0.902773 --> -0.916663).  Saving model ...
Epoch: 9 cost time: 0.5408968925476074
Epoch: 9, Steps: 7 | Train Loss: 0.120 Vali Loss: 0.331 Vali Acc: 0.931 Test Loss: 0.331 Test Acc: 0.931
Validation loss decreased (-0.916663 --> -0.930552).  Saving model ...
Epoch: 10 cost time: 0.5692765712738037
Epoch: 10, Steps: 7 | Train Loss: 0.057 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6105811595916748
Epoch: 11, Steps: 7 | Train Loss: 0.029 Vali Loss: 0.282 Vali Acc: 0.931 Test Loss: 0.282 Test Acc: 0.931
Validation loss decreased (-0.930552 --> -0.930553).  Saving model ...
Epoch: 12 cost time: 0.6308302879333496
Epoch: 12, Steps: 7 | Train Loss: 0.017 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5626609325408936
Epoch: 13, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.252 Vali Acc: 0.931 Test Loss: 0.252 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 14 cost time: 0.6406524181365967
Epoch: 14, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.236 Vali Acc: 0.931 Test Loss: 0.236 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 15 cost time: 0.5880560874938965
Epoch: 15, Steps: 7 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.931 Test Loss: 0.230 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 16 cost time: 0.5938358306884766
Epoch: 16, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.930553 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5711038112640381
Epoch: 17, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.931 Test Loss: 0.228 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6017286777496338
Epoch: 18, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5235621929168701
Epoch: 19, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3996596336364746
Epoch: 20, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5350637435913086
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5145094394683838
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4660506248474121
Epoch: 23, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.917 Test Loss: 0.234 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.46763014793395996
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4813871383666992
Epoch: 25, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.903 Test Loss: 0.233 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5207457542419434
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.903 Test Loss: 0.231 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps200_str200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9444444444444444
model parameter : 24939276
model size : 109.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps240_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 2.0427651405334473
Epoch: 1, Steps: 7 | Train Loss: 2.596 Vali Loss: 2.388 Vali Acc: 0.194 Test Loss: 2.388 Test Acc: 0.194
Validation loss decreased (inf --> -0.194421).  Saving model ...
Epoch: 2 cost time: 0.6698207855224609
Epoch: 2, Steps: 7 | Train Loss: 2.278 Vali Loss: 1.978 Vali Acc: 0.611 Test Loss: 1.978 Test Acc: 0.611
Validation loss decreased (-0.194421 --> -0.611091).  Saving model ...
Epoch: 3 cost time: 0.7730090618133545
Epoch: 3, Steps: 7 | Train Loss: 1.846 Vali Loss: 1.444 Vali Acc: 0.806 Test Loss: 1.444 Test Acc: 0.806
Validation loss decreased (-0.611091 --> -0.805541).  Saving model ...
Epoch: 4 cost time: 0.6954240798950195
Epoch: 4, Steps: 7 | Train Loss: 1.231 Vali Loss: 0.879 Vali Acc: 0.875 Test Loss: 0.879 Test Acc: 0.875
Validation loss decreased (-0.805541 --> -0.874991).  Saving model ...
Epoch: 5 cost time: 0.689936637878418
Epoch: 5, Steps: 7 | Train Loss: 0.661 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 0.8585824966430664
Epoch: 6, Steps: 7 | Train Loss: 0.267 Vali Loss: 0.429 Vali Acc: 0.875 Test Loss: 0.429 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 0.6289792060852051
Epoch: 7, Steps: 7 | Train Loss: 0.079 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.874996 --> -0.902775).  Saving model ...
Epoch: 8 cost time: 0.5873608589172363
Epoch: 8, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 9 cost time: 0.4602930545806885
Epoch: 9, Steps: 7 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
Validation loss decreased (-0.902775 --> -0.930553).  Saving model ...
Epoch: 10 cost time: 0.6184296607971191
Epoch: 10, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5802733898162842
Epoch: 11, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7523722648620605
Epoch: 12, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.931 Test Loss: 0.208 Test Acc: 0.931
Validation loss decreased (-0.930553 --> -0.930553).  Saving model ...
Epoch: 13 cost time: 0.6813619136810303
Epoch: 13, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6484580039978027
Epoch: 14, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6999008655548096
Epoch: 15, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6856257915496826
Epoch: 16, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6477515697479248
Epoch: 17, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6531455516815186
Epoch: 18, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6786074638366699
Epoch: 19, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8230376243591309
Epoch: 20, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7718908786773682
Epoch: 21, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5918736457824707
Epoch: 22, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps240_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9305555555555556
model parameter : 25610508
model size : 112.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps240_str120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.8762331008911133
Epoch: 1, Steps: 7 | Train Loss: 2.621 Vali Loss: 2.537 Vali Acc: 0.069 Test Loss: 2.537 Test Acc: 0.069
Validation loss decreased (inf --> -0.069419).  Saving model ...
Epoch: 2 cost time: 0.6194722652435303
Epoch: 2, Steps: 7 | Train Loss: 2.429 Vali Loss: 2.195 Vali Acc: 0.361 Test Loss: 2.195 Test Acc: 0.361
Validation loss decreased (-0.069419 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 0.6096196174621582
Epoch: 3, Steps: 7 | Train Loss: 1.941 Vali Loss: 1.815 Vali Acc: 0.694 Test Loss: 1.815 Test Acc: 0.694
Validation loss decreased (-0.361089 --> -0.694426).  Saving model ...
Epoch: 4 cost time: 0.6644904613494873
Epoch: 4, Steps: 7 | Train Loss: 1.546 Vali Loss: 1.311 Vali Acc: 0.778 Test Loss: 1.311 Test Acc: 0.778
Validation loss decreased (-0.694426 --> -0.777765).  Saving model ...
Epoch: 5 cost time: 0.6596307754516602
Epoch: 5, Steps: 7 | Train Loss: 1.030 Vali Loss: 0.836 Vali Acc: 0.889 Test Loss: 0.836 Test Acc: 0.889
Validation loss decreased (-0.777765 --> -0.888881).  Saving model ...
Epoch: 6 cost time: 0.7090911865234375
Epoch: 6, Steps: 7 | Train Loss: 0.536 Vali Loss: 0.581 Vali Acc: 0.847 Test Loss: 0.581 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.691657543182373
Epoch: 7, Steps: 7 | Train Loss: 0.228 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6040277481079102
Epoch: 8, Steps: 7 | Train Loss: 0.090 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6253502368927002
Epoch: 9, Steps: 7 | Train Loss: 0.040 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.636763334274292
Epoch: 10, Steps: 7 | Train Loss: 0.020 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.6573071479797363
Epoch: 11, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 0.6439566612243652
Epoch: 12, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.875 Test Loss: 0.272 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.659588098526001
Epoch: 13, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6538863182067871
Epoch: 14, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.903 Test Loss: 0.256 Test Acc: 0.903
Validation loss decreased (-0.888886 --> -0.902775).  Saving model ...
Epoch: 15 cost time: 0.619987964630127
Epoch: 15, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 16 cost time: 0.679835319519043
Epoch: 16, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.903 Test Loss: 0.255 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6427569389343262
Epoch: 17, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.903 Test Loss: 0.259 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.566791296005249
Epoch: 18, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5223193168640137
Epoch: 19, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.903 Test Loss: 0.260 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5617008209228516
Epoch: 20, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.903 Test Loss: 0.258 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.505542516708374
Epoch: 21, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5444338321685791
Epoch: 22, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 23 cost time: 0.5965096950531006
Epoch: 23, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
Validation loss decreased (-0.902775 --> -0.902775).  Saving model ...
Epoch: 24 cost time: 0.6055083274841309
Epoch: 24, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5285296440124512
Epoch: 25, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5718328952789307
Epoch: 26, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6286778450012207
Epoch: 27, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5933341979980469
Epoch: 28, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.889 Test Loss: 0.252 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.584632158279419
Epoch: 29, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5500438213348389
Epoch: 30, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.248 Vali Acc: 0.903 Test Loss: 0.248 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5666630268096924
Epoch: 31, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.903 Test Loss: 0.250 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5713059902191162
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.903 Test Loss: 0.251 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5632660388946533
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.903 Test Loss: 0.253 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps240_str120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 25524492
model size : 112.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Cricket         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Cricket
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

108
72
>>>>>>>start training : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps240_str240_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
108
72
72
Epoch: 1 cost time: 1.9592342376708984
Epoch: 1, Steps: 7 | Train Loss: 2.653 Vali Loss: 2.519 Vali Acc: 0.111 Test Loss: 2.519 Test Acc: 0.111
Validation loss decreased (inf --> -0.111086).  Saving model ...
Epoch: 2 cost time: 0.5396709442138672
Epoch: 2, Steps: 7 | Train Loss: 2.375 Vali Loss: 2.232 Vali Acc: 0.319 Test Loss: 2.232 Test Acc: 0.319
Validation loss decreased (-0.111086 --> -0.319422).  Saving model ...
Epoch: 3 cost time: 0.6156253814697266
Epoch: 3, Steps: 7 | Train Loss: 1.976 Vali Loss: 1.908 Vali Acc: 0.653 Test Loss: 1.908 Test Acc: 0.653
Validation loss decreased (-0.319422 --> -0.652759).  Saving model ...
Epoch: 4 cost time: 0.5442211627960205
Epoch: 4, Steps: 7 | Train Loss: 1.573 Vali Loss: 1.582 Vali Acc: 0.694 Test Loss: 1.582 Test Acc: 0.694
Validation loss decreased (-0.652759 --> -0.694429).  Saving model ...
Epoch: 5 cost time: 0.5431969165802002
Epoch: 5, Steps: 7 | Train Loss: 1.240 Vali Loss: 1.223 Vali Acc: 0.736 Test Loss: 1.223 Test Acc: 0.736
Validation loss decreased (-0.694429 --> -0.736099).  Saving model ...
Epoch: 6 cost time: 0.5597012042999268
Epoch: 6, Steps: 7 | Train Loss: 0.851 Vali Loss: 0.881 Vali Acc: 0.792 Test Loss: 0.881 Test Acc: 0.792
Validation loss decreased (-0.736099 --> -0.791658).  Saving model ...
Epoch: 7 cost time: 0.5953855514526367
Epoch: 7, Steps: 7 | Train Loss: 0.516 Vali Loss: 0.707 Vali Acc: 0.792 Test Loss: 0.707 Test Acc: 0.792
Validation loss decreased (-0.791658 --> -0.791660).  Saving model ...
Epoch: 8 cost time: 0.5955967903137207
Epoch: 8, Steps: 7 | Train Loss: 0.280 Vali Loss: 0.566 Vali Acc: 0.792 Test Loss: 0.566 Test Acc: 0.792
Validation loss decreased (-0.791660 --> -0.791661).  Saving model ...
Epoch: 9 cost time: 0.51698899269104
Epoch: 9, Steps: 7 | Train Loss: 0.151 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
Validation loss decreased (-0.791661 --> -0.819439).  Saving model ...
Epoch: 10 cost time: 0.6191837787628174
Epoch: 10, Steps: 7 | Train Loss: 0.071 Vali Loss: 0.453 Vali Acc: 0.847 Test Loss: 0.453 Test Acc: 0.847
Validation loss decreased (-0.819439 --> -0.847218).  Saving model ...
Epoch: 11 cost time: 0.46525096893310547
Epoch: 11, Steps: 7 | Train Loss: 0.039 Vali Loss: 0.435 Vali Acc: 0.847 Test Loss: 0.435 Test Acc: 0.847
Validation loss decreased (-0.847218 --> -0.847218).  Saving model ...
Epoch: 12 cost time: 0.5741825103759766
Epoch: 12, Steps: 7 | Train Loss: 0.023 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.847218 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 0.5247440338134766
Epoch: 13, Steps: 7 | Train Loss: 0.016 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6066622734069824
Epoch: 14, Steps: 7 | Train Loss: 0.014 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5437076091766357
Epoch: 15, Steps: 7 | Train Loss: 0.010 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5594208240509033
Epoch: 16, Steps: 7 | Train Loss: 0.008 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7313625812530518
Epoch: 17, Steps: 7 | Train Loss: 0.006 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6167285442352295
Epoch: 18, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 0.5283505916595459
Epoch: 19, Steps: 7 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6406388282775879
Epoch: 20, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 0.5662350654602051
Epoch: 21, Steps: 7 | Train Loss: 0.004 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 0.7397305965423584
Epoch: 22, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 0.5425925254821777
Epoch: 23, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.874996 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.6862902641296387
Epoch: 24, Steps: 7 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 0.6718275547027588
Epoch: 25, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5633134841918945
Epoch: 26, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.602074384689331
Epoch: 27, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5603139400482178
Epoch: 28, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.903 Test Loss: 0.372 Test Acc: 0.903
Validation loss decreased (-0.888885 --> -0.902774).  Saving model ...
Epoch: 29 cost time: 0.6339728832244873
Epoch: 29, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5458810329437256
Epoch: 30, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6048500537872314
Epoch: 31, Steps: 7 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5092198848724365
Epoch: 32, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5911202430725098
Epoch: 33, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.875 Test Loss: 0.386 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5128250122070312
Epoch: 34, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6081395149230957
Epoch: 35, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.903 Test Loss: 0.375 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5483188629150391
Epoch: 36, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.369 Vali Acc: 0.903 Test Loss: 0.369 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 37 cost time: 0.5231232643127441
Epoch: 37, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 38 cost time: 0.5754420757293701
Epoch: 38, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 39 cost time: 0.5104632377624512
Epoch: 39, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.522313117980957
Epoch: 40, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.365 Vali Acc: 0.903 Test Loss: 0.365 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 41 cost time: 0.6478395462036133
Epoch: 41, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 42 cost time: 0.5543389320373535
Epoch: 42, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.364 Vali Acc: 0.903 Test Loss: 0.364 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 43 cost time: 0.6227538585662842
Epoch: 43, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.363 Vali Acc: 0.903 Test Loss: 0.363 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 44 cost time: 0.6366152763366699
Epoch: 44, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 45 cost time: 0.57932448387146
Epoch: 45, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.903 Test Loss: 0.357 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 46 cost time: 0.6861283779144287
Epoch: 46, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
Validation loss decreased (-0.902774 --> -0.902774).  Saving model ...
Epoch: 47 cost time: 0.5735361576080322
Epoch: 47, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5266714096069336
Epoch: 48, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.903 Test Loss: 0.360 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5704505443572998
Epoch: 49, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6498322486877441
Epoch: 50, Steps: 7 | Train Loss: 0.001 Vali Loss: 0.367 Vali Acc: 0.903 Test Loss: 0.367 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Cricket_GPT4TS_UEA_ftM_sl1197_ll0_pl0_el3_dm768_df768_ps240_str240_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
72
test shape: torch.Size([72, 12]) torch.Size([72, 1])
accuracy:0.9027777777777778
model parameter : 25481484
model size : 111.87MB
